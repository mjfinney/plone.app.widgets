var requirejs,require,define;!function(global){function commentReplace(match,multi,multiText,singlePrefix){return singlePrefix||""}function isFunction(it){return"[object Function]"===ostring.call(it)}function isArray(it){return"[object Array]"===ostring.call(it)}function each(ary,func){if(ary){var i;for(i=0;i<ary.length&&(!ary[i]||!func(ary[i],i,ary));i+=1);}}function eachReverse(ary,func){if(ary){var i;for(i=ary.length-1;i>-1&&(!ary[i]||!func(ary[i],i,ary));i-=1);}}function hasProp(obj,prop){return hasOwn.call(obj,prop)}function getOwn(obj,prop){return hasProp(obj,prop)&&obj[prop]}function eachProp(obj,func){var prop;for(prop in obj)if(hasProp(obj,prop)&&func(obj[prop],prop))break}function mixin(target,source,force,deepStringMixin){return source&&eachProp(source,function(value,prop){!force&&hasProp(target,prop)||(!deepStringMixin||"object"!=typeof value||!value||isArray(value)||isFunction(value)||value instanceof RegExp?target[prop]=value:(target[prop]||(target[prop]={}),mixin(target[prop],value,force,deepStringMixin)))}),target}function bind(obj,fn){return function(){return fn.apply(obj,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(err){throw err}function getGlobal(value){if(!value)return value;var g=global;return each(value.split("."),function(part){g=g[part]}),g}function makeError(id,msg,err,requireModules){var e=new Error(msg+"\nhttp://requirejs.org/docs/errors.html#"+id);return e.requireType=id,e.requireModules=requireModules,err&&(e.originalError=err),e}function newContext(contextName){function trimDots(ary){var i,part;for(i=0;i<ary.length;i++)if(part=ary[i],"."===part)ary.splice(i,1),i-=1;else if(".."===part){if(0===i||1===i&&".."===ary[2]||".."===ary[i-1])continue;i>0&&(ary.splice(i-1,2),i-=2)}}function normalize(name,baseName,applyMap){var pkgMain,mapValue,nameParts,i,j,nameSegment,lastIndex,foundMap,foundI,foundStarMap,starI,normalizedBaseParts,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"];if(name&&(name=name.split("/"),lastIndex=name.length-1,config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])&&(name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")),"."===name[0].charAt(0)&&baseParts&&(normalizedBaseParts=baseParts.slice(0,baseParts.length-1),name=normalizedBaseParts.concat(name)),trimDots(name),name=name.join("/")),applyMap&&map&&(baseParts||starMap)){nameParts=name.split("/");outerLoop:for(i=nameParts.length;i>0;i-=1){if(nameSegment=nameParts.slice(0,i).join("/"),baseParts)for(j=baseParts.length;j>0;j-=1)if(mapValue=getOwn(map,baseParts.slice(0,j).join("/")),mapValue&&(mapValue=getOwn(mapValue,nameSegment))){foundMap=mapValue,foundI=i;break outerLoop}!foundStarMap&&starMap&&getOwn(starMap,nameSegment)&&(foundStarMap=getOwn(starMap,nameSegment),starI=i)}!foundMap&&foundStarMap&&(foundMap=foundStarMap,foundI=starI),foundMap&&(nameParts.splice(0,foundI,foundMap),name=nameParts.join("/"))}return pkgMain=getOwn(config.pkgs,name),pkgMain?pkgMain:name}function removeScript(name){isBrowser&&each(scripts(),function(scriptNode){if(scriptNode.getAttribute("data-requiremodule")===name&&scriptNode.getAttribute("data-requirecontext")===context.contextName)return scriptNode.parentNode.removeChild(scriptNode),!0})}function hasPathFallback(id){var pathConfig=getOwn(config.paths,id);if(pathConfig&&isArray(pathConfig)&&pathConfig.length>1)return pathConfig.shift(),context.require.undef(id),context.makeRequire(null,{skipMap:!0})([id]),!0}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;return index>-1&&(prefix=name.substring(0,index),name=name.substring(index+1,name.length)),[prefix,name]}function makeModuleMap(name,parentModuleMap,isNormalized,applyMap){var url,pluginModule,suffix,nameParts,prefix=null,parentName=parentModuleMap?parentModuleMap.name:null,originalName=name,isDefine=!0,normalizedName="";return name||(isDefine=!1,name="_@r"+(requireCounter+=1)),nameParts=splitPrefix(name),prefix=nameParts[0],name=nameParts[1],prefix&&(prefix=normalize(prefix,parentName,applyMap),pluginModule=getOwn(defined,prefix)),name&&(prefix?normalizedName=pluginModule&&pluginModule.normalize?pluginModule.normalize(name,function(name){return normalize(name,parentName,applyMap)}):name.indexOf("!")===-1?normalize(name,parentName,applyMap):name:(normalizedName=normalize(name,parentName,applyMap),nameParts=splitPrefix(normalizedName),prefix=nameParts[0],normalizedName=nameParts[1],isNormalized=!0,url=context.nameToUrl(normalizedName))),suffix=!prefix||pluginModule||isNormalized?"":"_unnormalized"+(unnormalizedCounter+=1),{prefix:prefix,name:normalizedName,parentMap:parentModuleMap,unnormalized:!!suffix,url:url,originalName:originalName,isDefine:isDefine,id:(prefix?prefix+"!"+normalizedName:normalizedName)+suffix}}function getModule(depMap){var id=depMap.id,mod=getOwn(registry,id);return mod||(mod=registry[id]=new context.Module(depMap)),mod}function on(depMap,name,fn){var id=depMap.id,mod=getOwn(registry,id);!hasProp(defined,id)||mod&&!mod.defineEmitComplete?(mod=getModule(depMap),mod.error&&"error"===name?fn(mod.error):mod.on(name,fn)):"defined"===name&&fn(defined[id])}function onError(err,errback){var ids=err.requireModules,notified=!1;errback?errback(err):(each(ids,function(id){var mod=getOwn(registry,id);mod&&(mod.error=err,mod.events.error&&(notified=!0,mod.emit("error",err)))}),notified||req.onError(err))}function takeGlobalQueue(){globalDefQueue.length&&(each(globalDefQueue,function(queueItem){var id=queueItem[0];"string"==typeof id&&(context.defQueueMap[id]=!0),defQueue.push(queueItem)}),globalDefQueue=[])}function cleanRegistry(id){delete registry[id],delete enabledRegistry[id]}function breakCycle(mod,traced,processed){var id=mod.map.id;mod.error?mod.emit("error",mod.error):(traced[id]=!0,each(mod.depMaps,function(depMap,i){var depId=depMap.id,dep=getOwn(registry,depId);!dep||mod.depMatched[i]||processed[depId]||(getOwn(traced,depId)?(mod.defineDep(i,defined[depId]),mod.check()):breakCycle(dep,traced,processed))}),processed[id]=!0)}function checkLoaded(){var err,usingPathFallback,waitInterval=1e3*config.waitSeconds,expired=waitInterval&&context.startTime+waitInterval<(new Date).getTime(),noLoads=[],reqCalls=[],stillLoading=!1,needCycleCheck=!0;if(!inCheckLoaded){if(inCheckLoaded=!0,eachProp(enabledRegistry,function(mod){var map=mod.map,modId=map.id;if(mod.enabled&&(map.isDefine||reqCalls.push(mod),!mod.error))if(!mod.inited&&expired)hasPathFallback(modId)?(usingPathFallback=!0,stillLoading=!0):(noLoads.push(modId),removeScript(modId));else if(!mod.inited&&mod.fetched&&map.isDefine&&(stillLoading=!0,!map.prefix))return needCycleCheck=!1}),expired&&noLoads.length)return err=makeError("timeout","Load timeout for modules: "+noLoads,null,noLoads),err.contextName=context.contextName,onError(err);needCycleCheck&&each(reqCalls,function(mod){breakCycle(mod,{},{})}),expired&&!usingPathFallback||!stillLoading||!isBrowser&&!isWebWorker||checkLoadedTimeoutId||(checkLoadedTimeoutId=setTimeout(function(){checkLoadedTimeoutId=0,checkLoaded()},50)),inCheckLoaded=!1}}function callGetModule(args){hasProp(defined,args[0])||getModule(makeModuleMap(args[0],null,!0)).init(args[1],args[2])}function removeListener(node,func,name,ieName){node.detachEvent&&!isOpera?ieName&&node.detachEvent(ieName,func):node.removeEventListener(name,func,!1)}function getScriptData(evt){var node=evt.currentTarget||evt.srcElement;return removeListener(node,context.onScriptLoad,"load","onreadystatechange"),removeListener(node,context.onScriptError,"error"),{node:node,id:node&&node.getAttribute("data-requiremodule")}}function intakeDefines(){var args;for(takeGlobalQueue();defQueue.length;){if(args=defQueue.shift(),null===args[0])return onError(makeError("mismatch","Mismatched anonymous define() module: "+args[args.length-1]));callGetModule(args)}context.defQueueMap={}}var inCheckLoaded,Module,context,handlers,checkLoadedTimeoutId,config={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},registry={},enabledRegistry={},undefEvents={},defQueue=[],defined={},urlFetched={},bundlesMap={},requireCounter=1,unnormalizedCounter=1;return handlers={require:function(mod){return mod.require?mod.require:mod.require=context.makeRequire(mod.map)},exports:function(mod){if(mod.usingExports=!0,mod.map.isDefine)return mod.exports?defined[mod.map.id]=mod.exports:mod.exports=defined[mod.map.id]={}},module:function(mod){return mod.module?mod.module:mod.module={id:mod.map.id,uri:mod.map.url,config:function(){return getOwn(config.config,mod.map.id)||{}},exports:mod.exports||(mod.exports={})}}},Module=function(map){this.events=getOwn(undefEvents,map.id)||{},this.map=map,this.shim=getOwn(config.shim,map.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},Module.prototype={init:function(depMaps,factory,errback,options){options=options||{},this.inited||(this.factory=factory,errback?this.on("error",errback):this.events.error&&(errback=bind(this,function(err){this.emit("error",err)})),this.depMaps=depMaps&&depMaps.slice(0),this.errback=errback,this.inited=!0,this.ignore=options.ignore,options.enabled||this.enabled?this.enable():this.check())},defineDep:function(i,depExports){this.depMatched[i]||(this.depMatched[i]=!0,this.depCount-=1,this.depExports[i]=depExports)},fetch:function(){if(!this.fetched){this.fetched=!0,context.startTime=(new Date).getTime();var map=this.map;return this.shim?void context.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return map.prefix?this.callPlugin():this.load()})):map.prefix?this.callPlugin():this.load()}},load:function(){var url=this.map.url;urlFetched[url]||(urlFetched[url]=!0,context.load(this.map.id,url))},check:function(){if(this.enabled&&!this.enabling){var err,cjsModule,id=this.map.id,depExports=this.depExports,exports=this.exports,factory=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(factory)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{exports=context.execCb(id,factory,depExports,exports)}catch(e){err=e}else exports=context.execCb(id,factory,depExports,exports);if(this.map.isDefine&&void 0===exports&&(cjsModule=this.module,cjsModule?exports=cjsModule.exports:this.usingExports&&(exports=this.exports)),err)return err.requireMap=this.map,err.requireModules=this.map.isDefine?[this.map.id]:null,err.requireType=this.map.isDefine?"define":"require",onError(this.error=err)}else exports=factory;if(this.exports=exports,this.map.isDefine&&!this.ignore&&(defined[id]=exports,req.onResourceLoad)){var resLoadMaps=[];each(this.depMaps,function(depMap){resLoadMaps.push(depMap.normalizedMap||depMap)}),req.onResourceLoad(context,this.map,resLoadMaps)}cleanRegistry(id),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(context.defQueueMap,id)||this.fetch()}},callPlugin:function(){var map=this.map,id=map.id,pluginMap=makeModuleMap(map.prefix);this.depMaps.push(pluginMap),on(pluginMap,"defined",bind(this,function(plugin){var load,normalizedMap,normalizedMod,bundleId=getOwn(bundlesMap,this.map.id),name=this.map.name,parentName=this.map.parentMap?this.map.parentMap.name:null,localRequire=context.makeRequire(map.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(plugin.normalize&&(name=plugin.normalize(name,function(name){return normalize(name,parentName,!0)})||""),normalizedMap=makeModuleMap(map.prefix+"!"+name,this.map.parentMap),on(normalizedMap,"defined",bind(this,function(value){this.map.normalizedMap=normalizedMap,this.init([],function(){return value},null,{enabled:!0,ignore:!0})})),normalizedMod=getOwn(registry,normalizedMap.id),void(normalizedMod&&(this.depMaps.push(normalizedMap),this.events.error&&normalizedMod.on("error",bind(this,function(err){this.emit("error",err)})),normalizedMod.enable()))):bundleId?(this.map.url=context.nameToUrl(bundleId),void this.load()):(load=bind(this,function(value){this.init([],function(){return value},null,{enabled:!0})}),load.error=bind(this,function(err){this.inited=!0,this.error=err,err.requireModules=[id],eachProp(registry,function(mod){0===mod.map.id.indexOf(id+"_unnormalized")&&cleanRegistry(mod.map.id)}),onError(err)}),load.fromText=bind(this,function(text,textAlt){var moduleName=map.name,moduleMap=makeModuleMap(moduleName),hasInteractive=useInteractive;textAlt&&(text=textAlt),hasInteractive&&(useInteractive=!1),getModule(moduleMap),hasProp(config.config,id)&&(config.config[moduleName]=config.config[id]);try{req.exec(text)}catch(e){return onError(makeError("fromtexteval","fromText eval for "+id+" failed: "+e,e,[id]))}hasInteractive&&(useInteractive=!0),this.depMaps.push(moduleMap),context.completeLoad(moduleName),localRequire([moduleName],load)}),void plugin.load(map.name,localRequire,load,config))})),context.enable(pluginMap,this),this.pluginMaps[pluginMap.id]=pluginMap},enable:function(){enabledRegistry[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(depMap,i){var id,mod,handler;if("string"==typeof depMap){if(depMap=makeModuleMap(depMap,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[i]=depMap,handler=getOwn(handlers,depMap.id))return void(this.depExports[i]=handler(this));this.depCount+=1,on(depMap,"defined",bind(this,function(depExports){this.undefed||(this.defineDep(i,depExports),this.check())})),this.errback?on(depMap,"error",bind(this,this.errback)):this.events.error&&on(depMap,"error",bind(this,function(err){this.emit("error",err)}))}id=depMap.id,mod=registry[id],hasProp(handlers,id)||!mod||mod.enabled||context.enable(depMap,this)})),eachProp(this.pluginMaps,bind(this,function(pluginMap){var mod=getOwn(registry,pluginMap.id);mod&&!mod.enabled&&context.enable(pluginMap,this)})),this.enabling=!1,this.check()},on:function(name,cb){var cbs=this.events[name];cbs||(cbs=this.events[name]=[]),cbs.push(cb)},emit:function(name,evt){each(this.events[name],function(cb){cb(evt)}),"error"===name&&delete this.events[name]}},context={config:config,contextName:contextName,registry:registry,defined:defined,urlFetched:urlFetched,defQueue:defQueue,defQueueMap:{},Module:Module,makeModuleMap:makeModuleMap,nextTick:req.nextTick,onError:onError,configure:function(cfg){if(cfg.baseUrl&&"/"!==cfg.baseUrl.charAt(cfg.baseUrl.length-1)&&(cfg.baseUrl+="/"),"string"==typeof cfg.urlArgs){var urlArgs=cfg.urlArgs;cfg.urlArgs=function(id,url){return(url.indexOf("?")===-1?"?":"&")+urlArgs}}var shim=config.shim,objs={paths:!0,bundles:!0,config:!0,map:!0};eachProp(cfg,function(value,prop){objs[prop]?(config[prop]||(config[prop]={}),mixin(config[prop],value,!0,!0)):config[prop]=value}),cfg.bundles&&eachProp(cfg.bundles,function(value,prop){each(value,function(v){v!==prop&&(bundlesMap[v]=prop)})}),cfg.shim&&(eachProp(cfg.shim,function(value,id){isArray(value)&&(value={deps:value}),!value.exports&&!value.init||value.exportsFn||(value.exportsFn=context.makeShimExports(value)),shim[id]=value}),config.shim=shim),cfg.packages&&each(cfg.packages,function(pkgObj){var location,name;pkgObj="string"==typeof pkgObj?{name:pkgObj}:pkgObj,name=pkgObj.name,location=pkgObj.location,location&&(config.paths[name]=pkgObj.location),config.pkgs[name]=pkgObj.name+"/"+(pkgObj.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(registry,function(mod,id){mod.inited||mod.map.unnormalized||(mod.map=makeModuleMap(id,null,!0))}),(cfg.deps||cfg.callback)&&context.require(cfg.deps||[],cfg.callback)},makeShimExports:function(value){function fn(){var ret;return value.init&&(ret=value.init.apply(global,arguments)),ret||value.exports&&getGlobal(value.exports)}return fn},makeRequire:function(relMap,options){function localRequire(deps,callback,errback){var id,map,requireMod;return options.enableBuildCallback&&callback&&isFunction(callback)&&(callback.__requireJsBuild=!0),"string"==typeof deps?isFunction(callback)?onError(makeError("requireargs","Invalid require call"),errback):relMap&&hasProp(handlers,deps)?handlers[deps](registry[relMap.id]):req.get?req.get(context,deps,relMap,localRequire):(map=makeModuleMap(deps,relMap,!1,!0),id=map.id,hasProp(defined,id)?defined[id]:onError(makeError("notloaded",'Module name "'+id+'" has not been loaded yet for context: '+contextName+(relMap?"":". Use require([])")))):(intakeDefines(),context.nextTick(function(){intakeDefines(),requireMod=getModule(makeModuleMap(null,relMap)),requireMod.skipMap=options.skipMap,requireMod.init(deps,callback,errback,{enabled:!0}),checkLoaded()}),localRequire)}return options=options||{},mixin(localRequire,{isBrowser:isBrowser,toUrl:function(moduleNamePlusExt){var ext,index=moduleNamePlusExt.lastIndexOf("."),segment=moduleNamePlusExt.split("/")[0],isRelative="."===segment||".."===segment;return index!==-1&&(!isRelative||index>1)&&(ext=moduleNamePlusExt.substring(index,moduleNamePlusExt.length),moduleNamePlusExt=moduleNamePlusExt.substring(0,index)),context.nameToUrl(normalize(moduleNamePlusExt,relMap&&relMap.id,!0),ext,!0)},defined:function(id){return hasProp(defined,makeModuleMap(id,relMap,!1,!0).id)},specified:function(id){return id=makeModuleMap(id,relMap,!1,!0).id,hasProp(defined,id)||hasProp(registry,id)}}),relMap||(localRequire.undef=function(id){takeGlobalQueue();var map=makeModuleMap(id,relMap,!0),mod=getOwn(registry,id);mod.undefed=!0,removeScript(id),delete defined[id],delete urlFetched[map.url],delete undefEvents[id],eachReverse(defQueue,function(args,i){args[0]===id&&defQueue.splice(i,1)}),delete context.defQueueMap[id],mod&&(mod.events.defined&&(undefEvents[id]=mod.events),cleanRegistry(id))}),localRequire},enable:function(depMap){var mod=getOwn(registry,depMap.id);mod&&getModule(depMap).enable()},completeLoad:function(moduleName){var found,args,mod,shim=getOwn(config.shim,moduleName)||{},shExports=shim.exports;for(takeGlobalQueue();defQueue.length;){if(args=defQueue.shift(),null===args[0]){if(args[0]=moduleName,found)break;found=!0}else args[0]===moduleName&&(found=!0);callGetModule(args)}if(context.defQueueMap={},mod=getOwn(registry,moduleName),!found&&!hasProp(defined,moduleName)&&mod&&!mod.inited){if(!(!config.enforceDefine||shExports&&getGlobal(shExports)))return hasPathFallback(moduleName)?void 0:onError(makeError("nodefine","No define call for "+moduleName,null,[moduleName]));callGetModule([moduleName,shim.deps||[],shim.exportsFn])}checkLoaded()},nameToUrl:function(moduleName,ext,skipExt){var paths,syms,i,parentModule,url,parentPath,bundleId,pkgMain=getOwn(config.pkgs,moduleName);if(pkgMain&&(moduleName=pkgMain),bundleId=getOwn(bundlesMap,moduleName))return context.nameToUrl(bundleId,ext,skipExt);if(req.jsExtRegExp.test(moduleName))url=moduleName+(ext||"");else{for(paths=config.paths,syms=moduleName.split("/"),i=syms.length;i>0;i-=1)if(parentModule=syms.slice(0,i).join("/"),parentPath=getOwn(paths,parentModule)){isArray(parentPath)&&(parentPath=parentPath[0]),syms.splice(0,i,parentPath);break}url=syms.join("/"),url+=ext||(/^data\:|^blob\:|\?/.test(url)||skipExt?"":".js"),url=("/"===url.charAt(0)||url.match(/^[\w\+\.\-]+:/)?"":config.baseUrl)+url}return config.urlArgs&&!/^blob\:/.test(url)?url+config.urlArgs(moduleName,url):url},load:function(id,url){req.load(context,id,url)},execCb:function(name,callback,args,exports){return callback.apply(exports,args)},onScriptLoad:function(evt){if("load"===evt.type||readyRegExp.test((evt.currentTarget||evt.srcElement).readyState)){interactiveScript=null;var data=getScriptData(evt);context.completeLoad(data.id)}},onScriptError:function(evt){var data=getScriptData(evt);if(!hasPathFallback(data.id)){var parents=[];return eachProp(registry,function(value,key){0!==key.indexOf("_@r")&&each(value.depMaps,function(depMap){if(depMap.id===data.id)return parents.push(key),!0})}),onError(makeError("scripterror",'Script error for "'+data.id+(parents.length?'", needed by: '+parents.join(", "):'"'),evt,[data.id]))}}},context.require=context.makeRequire(),context}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(script){if("interactive"===script.readyState)return interactiveScript=script}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.2.0",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(deps,callback,errback,optional){var context,config,contextName=defContextName;return isArray(deps)||"string"==typeof deps||(config=deps,isArray(callback)?(deps=callback,callback=errback,errback=optional):deps=[]),config&&config.context&&(contextName=config.context),context=getOwn(contexts,contextName),context||(context=contexts[contextName]=req.s.newContext(contextName)),config&&context.configure(config),context.require(deps,callback,errback)},req.config=function(config){return req(config)},req.nextTick="undefined"!=typeof setTimeout?function(fn){setTimeout(fn,4)}:function(fn){fn()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(prop){req[prop]=function(){var ctx=contexts[defContextName];return ctx.require[prop].apply(ctx,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(config,moduleName,url){var node=config.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return node.type=config.scriptType||"text/javascript",node.charset="utf-8",node.async=!0,node},req.load=function(context,moduleName,url){var node,config=context&&context.config||{};if(isBrowser)return node=req.createNode(config,moduleName,url),node.setAttribute("data-requirecontext",context.contextName),node.setAttribute("data-requiremodule",moduleName),!node.attachEvent||node.attachEvent.toString&&node.attachEvent.toString().indexOf("[native code")<0||isOpera?(node.addEventListener("load",context.onScriptLoad,!1),node.addEventListener("error",context.onScriptError,!1)):(useInteractive=!0,node.attachEvent("onreadystatechange",context.onScriptLoad)),node.src=url,config.onNodeCreated&&config.onNodeCreated(node,config,moduleName,url),currentlyAddingScript=node,baseElement?head.insertBefore(node,baseElement):head.appendChild(node),currentlyAddingScript=null,node;if(isWebWorker)try{setTimeout(function(){},0),importScripts(url),context.completeLoad(moduleName)}catch(e){context.onError(makeError("importscripts","importScripts failed for "+moduleName+" at "+url,e,[moduleName]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(script){if(head||(head=script.parentNode),dataMain=script.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||mainScript.indexOf("!")!==-1||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(name,deps,callback){var node,context;"string"!=typeof name&&(callback=deps,deps=name,name=null),isArray(deps)||(callback=deps,deps=null),!deps&&isFunction(callback)&&(deps=[],callback.length&&(callback.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(match,dep){deps.push(dep)}),deps=(1===callback.length?["require"]:["require","exports","module"]).concat(deps))),useInteractive&&(node=currentlyAddingScript||getInteractiveScript(),node&&(name||(name=node.getAttribute("data-requiremodule")),context=contexts[node.getAttribute("data-requirecontext")])),context?(context.defQueue.push([name,deps,callback]),context.defQueueMap[name]=!0):globalDefQueue.push([name,deps,callback])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("node_modules/requirejs/require.js",function(){}),function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function isArraylike(obj){var length="length"in obj&&obj.length,type=jQuery.type(obj);return"function"!==type&&!jQuery.isWindow(obj)&&(!(1!==obj.nodeType||!length)||("array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj))}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return jQuery.inArray(elem,qualifier)>=0!==not})}function sibling(cur,dir){do cur=cur[dir];while(cur&&1!==cur.nodeType);return cur}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function detach(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1)):(document.detachEvent("onreadystatechange",completed),window.detachEvent("onload",completed))}function completed(){(document.addEventListener||"load"===event.type||"complete"===document.readyState)&&(detach(),jQuery.ready())}function dataAttr(elem,key,data){if(void 0===data&&1===elem.nodeType){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();if(data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data||"false"!==data&&("null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data)}catch(e){}jQuery.data(elem,key,data)}else data=void 0}return data}function isEmptyDataObject(obj){var name;for(name in obj)if(("data"!==name||!jQuery.isEmptyObject(obj[name]))&&"toJSON"!==name)return!1;return!0}function internalData(elem,name,data,pvt){if(jQuery.acceptData(elem)){var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if(id&&cache[id]&&(pvt||cache[id].data)||void 0!==data||"string"!=typeof name)return id||(id=isNode?elem[internalKey]=deletedIds.pop()||jQuery.guid++:internalKey),cache[id]||(cache[id]=isNode?{}:{toJSON:jQuery.noop}),"object"!=typeof name&&"function"!=typeof name||(pvt?cache[id]=jQuery.extend(cache[id],name):cache[id].data=jQuery.extend(cache[id].data,name)),thisCache=cache[id],pvt||(thisCache.data||(thisCache.data={}),thisCache=thisCache.data),void 0!==data&&(thisCache[jQuery.camelCase(name)]=data),"string"==typeof name?(ret=thisCache[name],null==ret&&(ret=thisCache[jQuery.camelCase(name)])):ret=thisCache,ret}}function internalRemoveData(elem,name,pvt){if(jQuery.acceptData(elem)){var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(cache[id]){if(name&&(thisCache=pvt?cache[id]:cache[id].data)){jQuery.isArray(name)?name=name.concat(jQuery.map(name,jQuery.camelCase)):name in thisCache?name=[name]:(name=jQuery.camelCase(name),name=name in thisCache?[name]:name.split(" ")),i=name.length;for(;i--;)delete thisCache[name[i]];if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache))return}(pvt||(delete cache[id].data,isEmptyDataObject(cache[id])))&&(isNode?jQuery.cleanData([elem],!0):support.deleteExpando||cache!=cache.window?delete cache[id]:cache[id]=null)}}}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement)for(;list.length;)safeFrag.createElement(list.pop());return safeFrag}function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==strundefined?context.querySelectorAll(tag||"*"):void 0;if(!found)for(found=[],elems=context.childNodes||context;null!=(elem=elems[i]);i++)!tag||jQuery.nodeName(elem,tag)?found.push(elem):jQuery.merge(found,getAll(elem,tag));return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){rcheckableType.test(elem.type)&&(elem.defaultChecked=elem.checked)}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==jQuery.find.attr(elem,"type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var elem,i=0;null!=(elem=elems[i]);i++)jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){if(1===dest.nodeType&&jQuery.hasData(src)){var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle,curData.events={};for(type in events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i])}curData.data&&(curData.data=jQuery.extend({},curData.data))}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(1===dest.nodeType){if(nodeName=dest.nodeName.toLowerCase(),!support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events)jQuery.removeEvent(dest,e,data.handle);dest.removeAttribute(jQuery.expando)}"script"===nodeName&&dest.text!==src.text?(disableScript(dest).text=src.text,restoreScript(dest)):"object"===nodeName?(dest.parentNode&&(dest.outerHTML=src.outerHTML),support.html5Clone&&src.innerHTML&&!jQuery.trim(dest.innerHTML)&&(dest.innerHTML=src.innerHTML)):"input"===nodeName&&rcheckableType.test(src.type)?(dest.defaultChecked=dest.checked=src.checked,dest.value!==src.value&&(dest.value=src.value)):"option"===nodeName?dest.defaultSelected=dest.selected=src.defaultSelected:"input"!==nodeName&&"textarea"!==nodeName||(dest.defaultValue=src.defaultValue)}}function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");return elem.detach(),display}function defaultDisplay(nodeName){
var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement),doc=(iframe[0].contentWindow||iframe[0].contentDocument).document,doc.write(),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function addGetHookIf(conditionFn,hookFn){return{get:function(){var condition=conditionFn();if(null!=condition)return condition?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(style,name){if(name in style)return name;for(var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;index<length;index++)elem=elements[index],elem.style&&(values[index]=jQuery._data(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName)))):(hidden=isHidden(elem),(display&&"none"!==display||!hidden)&&jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;index<length;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;i<4;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(val<=0||null==val){if(val=curCSS(elem,name,styles),(val<0||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){return setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,attrs={height:type},i=0;for(includeWidth=includeWidth?1:0;i<4;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],display=jQuery.css(elem,"display"),checkDisplay="none"===display?jQuery._data(elem,"olddisplay")||defaultDisplay(elem.nodeName):display,"inline"===checkDisplay&&"none"===jQuery.css(elem,"float")&&(support.inlineBlockNeedsLayout&&"inline"!==defaultDisplay(elem.nodeName)?style.zoom=1:style.display="inline-block")),opts.overflow&&(style.overflow="hidden",support.shrinkWrapBlocks()||anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else display=void 0;if(jQuery.isEmptyObject(orig))"inline"===("none"===display?defaultDisplay(elem.nodeName):display)&&(style.display=display);else{dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=jQuery._data(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;index<length;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),percent<1&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;index<length;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);index<length;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType.charAt(0)?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}if(finalDataType)return finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType&&(elem.defaultView||elem.parentWindow)}var deletedIds=[],slice=deletedIds.slice,concat=deletedIds.concat,push=deletedIds.push,indexOf=deletedIds.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,support={},version="1.11.3",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?num<0?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:deletedIds.sort,splice:deletedIds.splice},jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);i<length;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray||function(obj){return"array"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj==obj.window},isNumeric:function(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)+1>=0},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},isPlainObject:function(obj){var key;if(!obj||"object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(support.ownLast)for(key in obj)return hasOwn.call(obj,key);for(key in obj);return void 0===key||hasOwn.call(obj,key)},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(data){data&&jQuery.trim(data)&&(window.execScript||function(data){window.eval.call(window,data)})(data)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;i<length&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;i<length&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){var len;if(arr){if(indexOf)return indexOf.call(arr,elem,i);for(len=arr.length,i=i?i<0?Math.max(0,len+i):i:0;i<len;i++)if(i in arr&&arr[i]===elem)return i}return-1},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;j<len;)first[i++]=second[j++];if(len!==len)for(;void 0!==second[j];)first[i++]=second[j++];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;i<length;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;i<length;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;if("string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn))return args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy},now:function(){return+new Date},support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],nodeType=context.nodeType,"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&documentIsHTML){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=1!==nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&"undefined"!=typeof context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;i<len;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},unloadHandler=function(){setDocument()};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return!!documentElement&&"HTML"!==documentElement.nodeName},setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,parent=doc.defaultView,parent&&parent!==parent.top&&(parent.addEventListener?parent.addEventListener("unload",unloadHandler,!1):parent.attachEvent&&parent.attachEvent("onunload",unloadHandler)),documentIsHTML=!isXML(doc),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(doc.getElementsByClassName),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node="undefined"!=typeof elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return"undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\f]' msallowcapture=''><option selected=''></option></select>",div.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),div.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){
support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||"undefined"!=typeof elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML)return elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){if(!isXML&&"input"===elem.nodeName.toLowerCase())return elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;if(!isXML)return elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;i<len;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,document=window.document,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}if(elem=document.getElementById(match[2]),elem&&elem.parentNode){if(elem.id!==match[2])return rootjQuery.find(selector);this.length=1,this[0]=elem}return this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?"undefined"!=typeof rootjQuery.ready?rootjQuery.ready(selector):selector(jQuery):(void 0!==selector.selector&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(elem,dir,until){for(var matched=[],cur=elem[dir];cur&&9!==cur.nodeType&&(void 0===until||1!==cur.nodeType||!jQuery(cur).is(until));)1===cur.nodeType&&matched.push(cur),cur=cur[dir];return matched},sibling:function(n,elem){for(var r=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&r.push(n);return r}}),jQuery.fn.extend({has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;i<len;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){return elem?"string"==typeof elem?jQuery.inArray(this[0],jQuery(elem)):jQuery.inArray(elem.jquery?elem[0]:elem,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(ret=jQuery.filter(selector,ret)),this.length>1&&(guaranteedUnique[name]||(ret=jQuery.unique(ret)),rparentsprev.test(name)&&(ret=ret.reverse())),this.pushStack(ret)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingIndex<firingLength;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(index<=firingLength&&firingLength--,index<=firingIndex&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=void 0,this},disabled:function(){return!list},lock:function(){return stack=void 0,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);i<length;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){return jQuery.ready.promise().done(fn),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){if(wait===!0?!--jQuery.readyWait:!jQuery.isReady){if(!document.body)return setTimeout(jQuery.ready);jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.triggerHandler&&(jQuery(document).triggerHandler("ready"),jQuery(document).off("ready")))}}}),jQuery.ready.promise=function(obj){if(!readyList)if(readyList=jQuery.Deferred(),"complete"===document.readyState)setTimeout(jQuery.ready);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1);else{document.attachEvent("onreadystatechange",completed),window.attachEvent("onload",completed);var top=!1;try{top=null==window.frameElement&&document.documentElement}catch(e){}top&&top.doScroll&&!function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach(),jQuery.ready()}}()}return readyList.promise(obj)};var i,strundefined="undefined";for(i in jQuery(support))break;support.ownLast="0"!==i,support.inlineBlockNeedsLayout=!1,jQuery(function(){var val,div,body,container;body=document.getElementsByTagName("body")[0],body&&body.style&&(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),typeof div.style.zoom!==strundefined&&(div.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",support.inlineBlockNeedsLayout=val=3===div.offsetWidth,val&&(body.style.zoom=1)),body.removeChild(container))}),function(){var div=document.createElement("div");if(null==support.deleteExpando){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}div=null}(),jQuery.acceptData=function(elem){var noData=jQuery.noData[(elem.nodeName+" ").toLowerCase()],nodeType=+elem.nodeType||1;return(1===nodeType||9===nodeType)&&(!noData||noData!==!0&&elem.getAttribute("classid")===noData)};var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){return elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando],!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,!0)},_removeData:function(elem,name){return internalRemoveData(elem,name,!0)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=jQuery.data(elem),1===elem.nodeType&&!jQuery._data(elem,"parsedAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));jQuery._data(elem,"parsedAttrs",!0)}return data}return"object"==typeof key?this.each(function(){jQuery.data(this,key)}):arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):void 0},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;if(elem)return type=(type||"fx")+"queue",queue=jQuery._data(elem,type),data&&(!queue||jQuery.isArray(data)?queue=jQuery._data(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue"),jQuery._removeData(elem,key)})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=jQuery._data(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;i<length;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},rcheckableType=/^(?:checkbox|radio)$/i;!function(){var input=document.createElement("input"),div=document.createElement("div"),fragment=document.createDocumentFragment();if(div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",support.leadingWhitespace=3===div.firstChild.nodeType,support.tbody=!div.getElementsByTagName("tbody").length,support.htmlSerialize=!!div.getElementsByTagName("link").length,support.html5Clone="<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML,input.type="checkbox",input.checked=!0,fragment.appendChild(input),support.appendChecked=input.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue,fragment.appendChild(div),div.innerHTML="<input type='radio' checked='checked' name='t'/>",support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,support.noCloneEvent=!0,div.attachEvent&&(div.attachEvent("onclick",function(){support.noCloneEvent=!1}),div.cloneNode(!0).click()),null==support.deleteExpando){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}}(),function(){var i,eventName,div=document.createElement("div");for(i in{submit:!0,change:!0,focusin:!0})eventName="on"+i,(support[i+"Bubbles"]=eventName in window)||(div.setAttribute(eventName,"t"),support[i+"Bubbles"]=div.attributes[eventName].expando===!1);div=null}();var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);
if(elemData){for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery===strundefined||e&&jQuery.event.triggered===e.type?void 0:jQuery.event.dispatch.apply(eventHandle.elem,arguments)},eventHandle.elem=elem),types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||(elem.addEventListener?elem.addEventListener(type,eventHandle,!1):elem.attachEvent&&elem.attachEvent("on"+type,eventHandle))),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0);elem=null}},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,jQuery._removeData(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&jQuery.acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());if(event.type=type,!onlyHandlers&&!event.isDefaultPrevented()&&(!special._default||special._default.apply(eventPath.pop(),data)===!1)&&jQuery.acceptData(elem)&&ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)}return event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)event.namespace_re&&!event.namespace_re.test(handleObj.namespace)||(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!=this;cur=cur.parentNode||this)if(1===cur.nodeType&&(cur.disabled!==!0||"click"!==event.type)){for(matches=[],i=0;i<delegateCount;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=originalEvent.srcElement||document),3===event.target.nodeType&&(event.target=event.target.parentNode),event.metaKey=!!event.metaKey,fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),!event.relatedTarget&&fromElement&&(event.relatedTarget=fromElement===event.target?original.toElement:fromElement),event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0),event}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(jQuery.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)}:function(elem,type,handle){var name="on"+type;elem.detachEvent&&(typeof elem[name]===strundefined&&(elem[name]=null),elem.detachEvent(name,handle))},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.returnValue===!1?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||jQuery.contains(target,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),support.submitBubbles||(jQuery.event.special.submit={setup:function(){return!jQuery.nodeName(this,"form")&&void jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:void 0;form&&!jQuery._data(form,"submitBubbles")&&(jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=!0}),jQuery._data(form,"submitBubbles",!0))})},postDispatch:function(event){event._submit_bubble&&(delete event._submit_bubble,this.parentNode&&!event.isTrigger&&jQuery.event.simulate("submit",this.parentNode,event,!0))},teardown:function(){return!jQuery.nodeName(this,"form")&&void jQuery.event.remove(this,"._submit")}}),support.changeBubbles||(jQuery.event.special.change={setup:function(){return rformElems.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(jQuery.event.add(this,"propertychange._change",function(event){"checked"===event.originalEvent.propertyName&&(this._just_changed=!0)}),jQuery.event.add(this,"click._change",function(event){this._just_changed&&!event.isTrigger&&(this._just_changed=!1),jQuery.event.simulate("change",this,event,!0)})),!1):void jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")&&(jQuery.event.add(elem,"change._change",function(event){!this.parentNode||event.isSimulated||event.isTrigger||jQuery.event.simulate("change",this.parentNode,event,!0)}),jQuery._data(elem,"changeBubbles",!0))})},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||"radio"!==elem.type&&"checkbox"!==elem.type)return event.handleObj.handler.apply(this,arguments)},teardown:function(){return jQuery.event.remove(this,"._change"),!rformElems.test(this.nodeName)}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix);attaches||doc.addEventListener(orig,handler,!0),jQuery._data(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix)-1;attaches?jQuery._data(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),jQuery._removeData(doc,fix))}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return selector!==!1&&"function"!=typeof selector||(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem)return jQuery.event.trigger(type,data,elem,!0)}});var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")?clone=elem.cloneNode(!0):(fragmentDiv.innerHTML=elem.outerHTML,fragmentDiv.removeChild(clone=fragmentDiv.firstChild)),!(support.noCloneEvent&&support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0;null!=(node=srcElements[i]);++i)destElements[i]&&fixCloneNodeIssues(node,destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0;null!=(node=srcElements[i]);i++)cloneCopyEvent(node,destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),destElements=srcElements=node=null,clone},buildFragment:function(elems,context,scripts,selection){for(var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;i<l;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||safe.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;if(!support.leadingWhitespace&&rleadingWhitespace.test(elem)&&nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0])),!support.tbody)for(elem="table"!==tag||rtbody.test(elem)?"<table>"!==wrap[1]||rtbody.test(elem)?0:tmp:tmp.firstChild,j=elem&&elem.childNodes.length;j--;)jQuery.nodeName(tbody=elem.childNodes[j],"tbody")&&!tbody.childNodes.length&&elem.removeChild(tbody);for(jQuery.merge(nodes,tmp.childNodes),tmp.textContent="";tmp.firstChild;)tmp.removeChild(tmp.firstChild);tmp=safe.lastChild}else nodes.push(context.createTextNode(elem));for(tmp&&safe.removeChild(tmp),support.appendChecked||jQuery.grep(getAll(nodes,"input"),fixDefaultChecked),i=0;elem=nodes[i++];)if((!selection||jQuery.inArray(elem,selection)===-1)&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(safe.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return tmp=null,safe},cleanData:function(elems,acceptData){for(var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=support.deleteExpando,special=jQuery.event.special;null!=(elem=elems[i]);i++)if((acceptData||jQuery.acceptData(elem))&&(id=elem[internalKey],data=id&&cache[id])){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);cache[id]&&(delete cache[id],deleteExpando?delete elem[internalKey]:typeof elem.removeAttribute!==strundefined?elem.removeAttribute(internalKey):elem[internalKey]=null,deletedIds.push(id))}}}),jQuery.fn.extend({text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++){for(1===elem.nodeType&&jQuery.cleanData(getAll(elem,!1));elem.firstChild;)elem.removeChild(elem.firstChild);elem.options&&jQuery.nodeName(elem,"select")&&(elem.options.length=0)}return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null!=dataAndEvents&&dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value)return 1===elem.nodeType?elem.innerHTML.replace(rinlinejQuery,""):void 0;if("string"==typeof value&&!rnoInnerhtml.test(value)&&(support.htmlSerialize||!rnoshimcache.test(value))&&(support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];return this.domManip(arguments,function(elem){arg=this.parentNode,jQuery.cleanData(getAll(this)),arg&&arg.replaceChild(elem,this)}),arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback){args=concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;i<l;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;i<hasScripts;i++)node=scripts[i],rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,"")));fragment=first=null}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;i<=last;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var iframe,elemdisplay={};!function(){var shrinkWrapBlocksVal;support.shrinkWrapBlocks=function(){if(null!=shrinkWrapBlocksVal)return shrinkWrapBlocksVal;shrinkWrapBlocksVal=!1;var div,body,container;return body=document.getElementsByTagName("body")[0],body&&body.style?(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),typeof div.style.zoom!==strundefined&&(div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",div.appendChild(document.createElement("div")).style.width="5px",shrinkWrapBlocksVal=3!==div.offsetWidth),body.removeChild(container),shrinkWrapBlocksVal):void 0}}();var getStyles,curCSS,rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),rposition=/^(top|right|bottom|left)$/;window.getComputedStyle?(getStyles=function(elem){return elem.ownerDocument.defaultView.opener?elem.ownerDocument.defaultView.getComputedStyle(elem,null):window.getComputedStyle(elem,null)},curCSS=function(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:void 0,computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0===ret?ret:ret+""}):document.documentElement.currentStyle&&(getStyles=function(elem){return elem.currentStyle},curCSS=function(elem,name,computed){var left,rs,rsLeft,ret,style=elem.style;return computed=computed||getStyles(elem),ret=computed?computed[name]:void 0,null==ret&&style&&style[name]&&(ret=style[name]),rnumnonpx.test(ret)&&!rposition.test(name)&&(left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rsLeft&&(rs.left=elem.currentStyle.left),style.left="fontSize"===name?"1em":ret,ret=style.pixelLeft+"px",style.left=left,rsLeft&&(rs.left=rsLeft)),void 0===ret?ret:ret+""||"auto"}),function(){function computeStyleTests(){var div,body,container,contents;body=document.getElementsByTagName("body")[0],body&&body.style&&(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",pixelPositionVal=boxSizingReliableVal=!1,reliableMarginRightVal=!0,window.getComputedStyle&&(pixelPositionVal="1%"!==(window.getComputedStyle(div,null)||{}).top,boxSizingReliableVal="4px"===(window.getComputedStyle(div,null)||{width:"4px"}).width,contents=div.appendChild(document.createElement("div")),contents.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",contents.style.marginRight=contents.style.width="0",div.style.width="1px",reliableMarginRightVal=!parseFloat((window.getComputedStyle(contents,null)||{}).marginRight),div.removeChild(contents)),div.innerHTML="<table><tr><td></td><td>t</td></tr></table>",contents=div.getElementsByTagName("td"),contents[0].style.cssText="margin:0;border:0;padding:0;display:none",reliableHiddenOffsetsVal=0===contents[0].offsetHeight,reliableHiddenOffsetsVal&&(contents[0].style.display="",contents[1].style.display="none",reliableHiddenOffsetsVal=0===contents[0].offsetHeight),body.removeChild(container))}var div,style,a,pixelPositionVal,boxSizingReliableVal,reliableHiddenOffsetsVal,reliableMarginRightVal;div=document.createElement("div"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=div.getElementsByTagName("a")[0],style=a&&a.style,style&&(style.cssText="float:left;opacity:.5",support.opacity="0.5"===style.opacity,support.cssFloat=!!style.cssFloat,div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,support.boxSizing=""===style.boxSizing||""===style.MozBoxSizing||""===style.WebkitBoxSizing,jQuery.extend(support,{reliableHiddenOffsets:function(){return null==reliableHiddenOffsetsVal&&computeStyleTests(),reliableHiddenOffsetsVal},boxSizingReliable:function(){return null==boxSizingReliableVal&&computeStyleTests(),boxSizingReliableVal},pixelPosition:function(){return null==pixelPositionVal&&computeStyleTests(),pixelPositionVal},reliableMarginRight:function(){return null==reliableMarginRightVal&&computeStyleTests(),reliableMarginRightVal}}))}(),jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret};var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;if(name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];if(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),null!=value&&value===value&&("number"!==type||jQuery.cssNumber[origName]||(value+="px"),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),!(hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra)))))try{style[name]=value}catch(e){}}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed)return rdisplayswap.test(jQuery.css(elem,"display"))&&0===elem.offsetWidth?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra)},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),support.opacity||(jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+100*value+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1,(value>=1||""===value)&&""===jQuery.trim(filter.replace(ralpha,""))&&style.removeAttribute&&(style.removeAttribute("filter"),
""===value||currentStyle&&!currentStyle.filter)||(style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity)}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed)return jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"])}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];i<4;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;index<length;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,null!=opt.queue&&opt.queue!==!0||(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||jQuery._data(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));!dequeue&&gotoEnd||jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;index<length;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},function(){var input,div,select,a,opt;div=document.createElement("div"),div.setAttribute("className","t"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=div.getElementsByTagName("a")[0],select=document.createElement("select"),opt=select.appendChild(document.createElement("option")),input=div.getElementsByTagName("input")[0],a.style.cssText="top:1px",support.getSetAttribute="t"!==div.className,support.style=/top/.test(a.getAttribute("style")),support.hrefNormalized="/a"===a.getAttribute("href"),support.checkOn=!!input.value,support.optSelected=opt.selected,support.enctype=!!document.createElement("form").enctype,select.disabled=!0,support.optDisabled=!opt.disabled,input=document.createElement("input"),input.setAttribute("value",""),support.input=""===input.getAttribute("value"),input.value="t",input.setAttribute("type","radio"),support.radioValue="t"===input.value}();var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:jQuery.trim(jQuery.text(elem))}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;i<max;i++)if(option=options[i],(option.selected||i===index)&&(support.optDisabled?!option.disabled:null===option.getAttribute("disabled"))&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)if(option=options[i],jQuery.inArray(jQuery.valHooks.option.get(option),values)>=0)try{option.selected=optionSet=!0}catch(_){option.scrollHeight}else option.selected=!1;return optionSet||(elem.selectedIndex=-1),options}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value))return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=support.getSetAttribute,getSetInput=support.input;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),void 0===value?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret):null!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):void jQuery.removeAttr(elem,name))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)?getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem[propName]=!1:elem[jQuery.camelCase("default-"+name)]=elem[propName]=!1:jQuery.attr(elem,name,""),elem.removeAttribute(getSetAttribute?name:propName)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name):elem[jQuery.camelCase("default-"+name)]=elem[name]=!0,name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var ret,handle;return isXML||(handle=attrHandle[name],attrHandle[name]=ret,ret=null!=getter(elem,name,isXML)?name.toLowerCase():null,attrHandle[name]=handle),ret}:function(elem,name,isXML){if(!isXML)return elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}}),getSetInput&&getSetAttribute||(jQuery.attrHooks.value={set:function(elem,value,name){return jQuery.nodeName(elem,"input")?void(elem.defaultValue=value):nodeHook&&nodeHook.set(elem,value,name)}}),getSetAttribute||(nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(ret||elem.setAttributeNode(ret=elem.ownerDocument.createAttribute(name)),ret.value=value+="","value"===name||value===elem.getAttribute(name))return value}},attrHandle.id=attrHandle.name=attrHandle.coords=function(elem,name,isXML){var ret;if(!isXML)return(ret=elem.getAttributeNode(name))&&""!==ret.value?ret.value:null},jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);if(ret&&ret.specified)return ret.value},set:nodeHook.set},jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,""!==value&&value,name)}},jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){if(""===value)return elem.setAttribute(name,"auto"),value}}})),support.style||(jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||void 0},set:function(elem,value){return elem.style.cssText=value+""}});var rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return name=jQuery.propFix[name]||name,this.each(function(){try{this[name]=void 0,delete this[name]}catch(e){}})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}}),support.hrefNormalized||jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex),null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),support.enctype||(jQuery.propFix.enctype="encoding");var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed="string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];i<len;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=jQuery.trim(cur),elem.className!==finalValue&&(elem.className=finalValue)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=0===arguments.length||"string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];i<len;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");finalValue=value?jQuery.trim(cur):"",elem.className!==finalValue&&(elem.className=finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}):this.each(function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else type!==strundefined&&"boolean"!==type||(this.className&&jQuery._data(this,"__className__",this.className),this.className=this.className||value===!1?"":jQuery._data(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;i<l;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1}}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now(),rquery=/\?/,rvalidtokens=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;jQuery.parseJSON=function(data){if(window.JSON&&window.JSON.parse)return window.JSON.parse(data+"");var requireNonComma,depth=null,str=jQuery.trim(data+"");return str&&!jQuery.trim(str.replace(rvalidtokens,function(token,comma,open,close){return requireNonComma&&comma&&(depth=0),0===depth?token:(requireNonComma=open||comma,depth+=!close-!open,"")}))?Function("return "+str)():jQuery.error("Invalid JSON: "+data)},jQuery.parseXML=function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{window.DOMParser?(tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")):(xml=new ActiveXObject("Microsoft.XMLDOM"),xml.async="false",xml.loadXML(data))}catch(e){xml=void 0}return xml&&xml.documentElement&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&status<300||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,!status&&statusText||(statusText="error",status<0&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(state<2)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=jQuery.event&&s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(state<2))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstChild&&1===elem.firstChild.nodeType;)elem=elem.firstChild;return elem}).append(this)}return this},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||!support.reliableHiddenOffsets()&&"none"===(elem.style&&elem.style.display||jQuery.css(elem,"display"))},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=void 0!==window.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&createStandardXHR()||createActiveXHR()}:createStandardXHR;var xhrId=0,xhrCallbacks={},xhrSupported=jQuery.ajaxSettings.xhr();window.attachEvent&&window.attachEvent("onunload",function(){for(var key in xhrCallbacks)xhrCallbacks[key](void 0,!0)}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,xhrSupported=support.ajax=!!xhrSupported,xhrSupported&&jQuery.ajaxTransport(function(options){if(!options.crossDomain||support.cors){var callback;return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)void 0!==headers[i]&&xhr.setRequestHeader(i,headers[i]+"");xhr.send(options.hasContent&&options.data||null),callback=function(_,isAbort){var status,statusText,responses;if(callback&&(isAbort||4===xhr.readyState))if(delete xhrCallbacks[id],callback=void 0,xhr.onreadystatechange=jQuery.noop,isAbort)4!==xhr.readyState&&xhr.abort();else{responses={},status=xhr.status,"string"==typeof xhr.responseText&&(responses.text=xhr.responseText);try{statusText=xhr.statusText}catch(e){statusText=""}status||!options.isLocal||options.crossDomain?1223===status&&(status=204):status=responses.text?200:404}responses&&complete(status,statusText,responses,xhr.getAllResponseHeaders())},options.async?4===xhr.readyState?setTimeout(callback):xhr.onreadystatechange=xhrCallbacks[id]=callback:callback()},abort:function(){callback&&callback(void 0,!0)}}}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET",
s.global=!1)}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script"),script.async=!0,s.scriptCharset&&(script.charset=s.scriptCharset),script.src=s.url,script.onload=script.onreadystatechange=function(_,isAbort){(isAbort||!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,script.parentNode&&script.parentNode.removeChild(script),script=null,isAbort||callback(200,"success"))},head.insertBefore(script,head.firstChild)},abort:function(){script&&script.onload(void 0,!0)}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||"jsonp"===s.dataTypes[0])return callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"}),jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,response,type,self=this,off=url.indexOf(" ");return off>=0&&(selector=jQuery.trim(url.slice(off,url.length)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):box},position:function(){if(this[0]){var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);return void 0===val?win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]:void(win?win.scrollTo(top?jQuery(win).scrollLeft():val,top?val:jQuery(win).scrollTop()):elem[method]=val)},method,val,arguments.length,null)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed)return computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery}),function(){function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;return arguments.length<3&&(memo=obj[keys?keys[index]:index],index+=dir),iterator(obj,iteratee,memo,keys,index,length)}}function createPredicateIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);for(var length=getLength(array),index=dir>0?0:length-1;index>=0&&index<length;index+=dir)if(predicate(array[index],index,array))return index;return-1}}function createIndexFinder(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if("number"==typeof idx)dir>0?i=idx>=0?idx:Math.max(idx+length,i):length=idx>=0?Math.min(idx+1,length):idx+length+1;else if(sortedIndex&&idx&&length)return idx=sortedIndex(array,item),array[idx]===item?idx:-1;if(item!==item)return idx=predicateFind(slice.call(array,i,length),_.isNaN),idx>=0?idx+i:-1;for(idx=dir>0?i:length-1;idx>=0&&idx<length;idx+=dir)if(array[idx]===item)return idx;return-1}}function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length,constructor=obj.constructor,proto=_.isFunction(constructor)&&constructor.prototype||ObjProto,prop="constructor";for(_.has(obj,prop)&&!_.contains(keys,prop)&&keys.push(prop);nonEnumIdx--;)prop=nonEnumerableProps[nonEnumIdx],prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)&&keys.push(prop)}var root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create,Ctor=function(){},_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.8.3";var optimizeCb=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}},cb=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?optimizeCb(value,context,argCount):_.isObject(value)?_.matcher(value):_.property(value)};_.iteratee=function(value,context){return cb(value,context,1/0)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(length<2||null==obj)return obj;for(var index=1;index<length;index++)for(var source=arguments[index],keys=keysFunc(source),l=keys.length,i=0;i<l;i++){var key=keys[i];undefinedOnly&&void 0!==obj[key]||(obj[key]=source[key])}return obj}},baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;return Ctor.prototype=null,result},property=function(key){return function(obj){return null==obj?void 0:obj[key]}},MAX_ARRAY_INDEX=Math.pow(2,53)-1,getLength=property("length"),isArrayLike=function(collection){var length=getLength(collection);return"number"==typeof length&&length>=0&&length<=MAX_ARRAY_INDEX};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj))for(i=0,length=obj.length;i<length;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results},_.reduce=_.foldl=_.inject=createReduce(1),_.reduceRight=_.foldr=createReduce(-1),_.find=_.detect=function(obj,predicate,context){var key;if(key=isArrayLike(obj)?_.findIndex(obj,predicate,context):_.findKey(obj,predicate,context),void 0!==key&&key!==-1)return obj[key]},_.filter=_.select=function(obj,predicate,context){var results=[];return predicate=cb(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)},_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return!1}return!0},_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return!0}return!1},_.contains=_.includes=_.include=function(obj,item,fromIndex,guard){return isArrayLike(obj)||(obj=_.values(obj)),("number"!=typeof fromIndex||guard)&&(fromIndex=0),_.indexOf(obj,item,fromIndex)>=0},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return null==func?func:func.apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))},_.max=function(obj,iteratee,context){var value,computed,result=-(1/0),lastComputed=-(1/0);if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++)value=obj[i],value>result&&(result=value)}else iteratee=cb(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed>lastComputed||computed===-(1/0)&&result===-(1/0))&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++)value=obj[i],value<result&&(result=value)}else iteratee=cb(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed<lastComputed||computed===1/0&&result===1/0)&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){for(var rand,set=isArrayLike(obj)?obj:_.values(obj),length=set.length,shuffled=Array(length),index=0;index<length;index++)rand=_.random(0,index),rand!==index&&(shuffled[index]=shuffled[rand]),shuffled[rand]=set[index];return shuffled},_.sample=function(obj,n,guard){return null==n||guard?(isArrayLike(obj)||(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iteratee,context){return iteratee=cb(iteratee,context),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(a<b||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};return iteratee=cb(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1}),_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):isArrayLike(obj)?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:isArrayLike(obj)?obj.length:_.keys(obj).length},_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];return _.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)}),[pass,fail]},_.first=_.head=_.take=function(array,n,guard){if(null!=array)return null==n||guard?array[0]:_.initial(array,array.length-n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){if(null!=array)return null==n||guard?array[array.length-1]:_.rest(array,Math.max(0,array.length-n))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,startIndex){for(var output=[],idx=0,i=startIndex||0,length=getLength(input);i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){shallow||(value=flatten(value,shallow,strict));var j=0,len=value.length;for(output.length+=len;j<len;)output[idx++]=value[j++]}else strict||(output[idx++]=value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1)},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iteratee,context){_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=cb(iteratee,context));for(var result=[],seen=[],i=0,length=getLength(array);i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;isSorted?(i&&seen===computed||result.push(value),seen=computed):iteratee?_.contains(seen,computed)||(seen.push(computed),result.push(value)):_.contains(result,value)||result.push(value)}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0))},_.intersection=function(array){for(var result=[],argsLength=arguments.length,i=0,length=getLength(array);i<length;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;j<argsLength&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(arguments,!0,!0,1);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(array){for(var length=array&&_.max(array,getLength).length||0,result=Array(length),index=0;index<length;index++)result[index]=_.pluck(array,index);return result},_.object=function(list,values){for(var result={},i=0,length=getLength(list);i<length;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.findIndex=createPredicateIndexFinder(1),_.findLastIndex=createPredicateIndexFinder(-1),_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);for(var value=iteratee(obj),low=0,high=getLength(array);low<high;){var mid=Math.floor((low+high)/2);iteratee(array[mid])<value?low=mid+1:high=mid}return low},_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex),_.lastIndexOf=createIndexFinder(-1,_.findLastIndex),_.range=function(start,stop,step){null==stop&&(stop=start||0,start=0),step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;idx<length;idx++,start+=step)range[idx]=start;return range};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype),result=sourceFunc.apply(self,args);return _.isObject(result)?result:self};_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");var args=slice.call(arguments,2),bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)))};return bound},_.partial=function(func){var boundArgs=slice.call(arguments,1),bound=function(){for(var position=0,length=boundArgs.length,args=Array(length),i=0;i<length;i++)args[i]=boundArgs[i]===_?arguments[position++]:boundArgs[i];for(;position<arguments.length;)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound},_.bindAll=function(obj){var i,key,length=arguments.length;if(length<=1)throw new Error("bindAll must be passed function names");for(i=1;i<length;i++)key=arguments[i],obj[key]=_.bind(obj[key],obj);return obj},_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=""+(hasher?hasher.apply(this,arguments):key);return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=_.partial(_.delay,_,1),_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0||remaining>wait?(timeout&&(clearTimeout(timeout),timeout=null),previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;last<wait&&last>=0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){if(--times<1)return func.apply(this,arguments)}},_.before=function(times,func){var memo;return function(){return--times>0&&(memo=func.apply(this,arguments)),times<=1&&(func=null),memo}},_.once=_.partial(_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;i<length;i++)values[i]=obj[keys[i]];return values},_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var currentKey,keys=_.keys(obj),length=keys.length,results={},index=0;index<length;index++)currentKey=keys[index],results[currentKey]=iteratee(obj[currentKey],currentKey,obj);return results},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;i<length;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;i<length;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=createAssigner(_.allKeys),_.extendOwn=_.assign=createAssigner(_.keys),_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);for(var key,keys=_.keys(obj),i=0,length=keys.length;i<length;i++)if(key=keys[i],predicate(obj[key],key,obj))return key},_.pick=function(object,oiteratee,context){var iteratee,keys,result={},obj=object;if(null==obj)return result;_.isFunction(oiteratee)?(keys=_.allKeys(obj),iteratee=optimizeCb(oiteratee,context)):(keys=flatten(arguments,!1,!1,1),iteratee=function(value,key,obj){return key in obj},obj=Object(obj));for(var i=0,length=keys.length;i<length;i++){var key=keys[i],value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}return result},_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(flatten(arguments,!1,!1,1),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)},_.defaults=createAssigner(_.allKeys,!0),_.create=function(prototype,props){var result=baseCreate(prototype);return props&&_.extendOwn(result,props),result},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj},_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(null==object)return!length;for(var obj=Object(object),i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return!1}return!0};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var areArrays="[object Array]"===className;if(!areArrays){if("object"!=typeof a||"object"!=typeof b)return!1;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1}aStack=aStack||[],bStack=bStack||[];for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;if(aStack.push(a),bStack.push(b),areArrays){if(length=a.length,length!==b.length)return!1;for(;length--;)if(!eq(a[length],b[length],aStack,bStack))return!1}else{var key,keys=_.keys(a);if(length=keys.length,_.keys(b).length!==length)return!1;for(;length--;)if(key=keys[length],!_.has(b,key)||!eq(a[key],b[key],aStack,bStack))return!1}return aStack.pop(),bStack.pop(),!0};_.isEqual=function(a,b){return eq(a,b)},_.isEmpty=function(obj){return null==obj||(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))?0===obj.length:0===_.keys(obj).length)},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=property,_.propertyOf=function(obj){return null==obj?function(){}:function(key){return obj[key]}},_.matcher=_.matches=function(attrs){return attrs=_.extendOwn({},attrs),function(obj){return _.isMatch(obj,attrs)}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,property,fallback){var value=null==object?void 0:object[property];return void 0===value&&(value=fallback),_.isFunction(value)?value.call(object):value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var result=function(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],result(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,
_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),function(){function IEConsoleWriter(){}function ConsoleWriter(){}function Logger(name,parent){this._loggers={},this.name=name||"",this._parent=parent||null,parent||(this._enabled=!0,this._level=Level.WARN)}function getWriter(){return writer}function setWriter(w){writer=w}Function.prototype.bind||(Function.prototype.bind=function(oThis){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply(this instanceof fNOP&&oThis?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)))};return fNOP.prototype=this.prototype,fBound.prototype=new fNOP,fBound});var root,writer,Level={DEBUG:10,INFO:20,WARN:30,ERROR:40,FATAL:50};IEConsoleWriter.prototype={output:function(log_name,level,messages){if("undefined"!=typeof window.console&&"undefined"!=typeof console.log){log_name&&messages.unshift(log_name+":");var message=messages.join(" ");if(void 0===typeof console.info){var level_name;level_name=level<=Level.DEBUG?"DEBUG":level<=Level.INFO?"INFO":level<=Level.WARN?"WARN":level<=Level.ERROR?"ERROR":"FATAL",console.log("["+level_name+"] "+message)}else level<=Level.DEBUG?(message="[DEBUG] "+message,console.log(message)):level<=Level.INFO?console.info(message):level<=Level.WARN?console.warn(message):console.error(message)}}},ConsoleWriter.prototype={output:function(log_name,level,messages){log_name&&messages.unshift(log_name+":"),level<=Level.DEBUG?(messages.unshift("[DEBUG]"),console.log.apply(console,messages)):level<=Level.INFO?console.info.apply(console,messages):level<=Level.WARN?console.warn.apply(console,messages):console.error.apply(console,messages)}},Logger.prototype={getLogger:function(name){for(var path=name.split("."),root=this,route=this.name?[this.name]:[];path.length;){var entry=path.shift();route.push(entry),entry in root._loggers||(root._loggers[entry]=new Logger(route.join("."),root)),root=root._loggers[entry]}return root},_getFlag:function(flag){var context=this;for(flag="_"+flag;null!==context;){if(void 0!==context[flag])return context[flag];context=context._parent}return null},setEnabled:function(state){this._enabled=!!state},isEnabled:function(){this._getFlag("enabled")},setLevel:function(level){"number"==typeof level?this._level=level:"string"==typeof level&&(level=level.toUpperCase(),level in Level&&(this._level=Level[level]))},getLevel:function(){return this._getFlag("level")},log:function(level,messages){!messages.length||!this._getFlag("enabled")||level<this._getFlag("level")||(messages=Array.prototype.slice.call(messages),writer.output(this.name,level,messages))},debug:function(){this.log(Level.DEBUG,arguments)},info:function(){this.log(Level.INFO,arguments)},warn:function(){this.log(Level.WARN,arguments)},error:function(){this.log(Level.ERROR,arguments)},fatal:function(){this.log(Level.FATAL,arguments)}},setWriter(window.console&&window.console.log&&"function"==typeof window.console.log.apply?new ConsoleWriter:new IEConsoleWriter),root=new Logger;for(var match,logconfig=/loglevel(|-[^=]+)=([^&]+)/g;null!==(match=logconfig.exec(window.location.search));){var logger=""===match[1]?root:root.getLogger(match[1].slice(1));logger.setLevel(match[2].toUpperCase())}var api={Level:Level,getLogger:root.getLogger.bind(root),setEnabled:root.setEnabled.bind(root),isEnabled:root.isEnabled.bind(root),setLevel:root.setLevel.bind(root),getLevel:root.getLevel.bind(root),debug:root.debug.bind(root),info:root.info.bind(root),warn:root.warn.bind(root),error:root.error.bind(root),fatal:root.fatal.bind(root),getWriter:getWriter,setWriter:setWriter};"function"==typeof define?define("logging",[],function(){return api}):window.logging=api}(),define("pat-logger",["logging"],function(logging){var log=logging.getLogger("patterns");return log}),function(factory){"function"==typeof define&&define.amd?define("jquery.browser",["jquery"],function($){return factory($)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=factory(require("jquery")):factory(window.jQuery)}(function(jQuery){"use strict";function uaMatch(ua){void 0===ua&&(ua=window.navigator.userAgent),ua=ua.toLowerCase();var match=/(edge)\/([\w.]+)/.exec(ua)||/(opr)[\/]([\w.]+)/.exec(ua)||/(chrome)[ \/]([\w.]+)/.exec(ua)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[],platform_match=/(ipad)/.exec(ua)||/(ipod)/.exec(ua)||/(iphone)/.exec(ua)||/(kindle)/.exec(ua)||/(silk)/.exec(ua)||/(android)/.exec(ua)||/(windows phone)/.exec(ua)||/(win)/.exec(ua)||/(mac)/.exec(ua)||/(linux)/.exec(ua)||/(cros)/.exec(ua)||/(playbook)/.exec(ua)||/(bb)/.exec(ua)||/(blackberry)/.exec(ua)||[],browser={},matched={browser:match[5]||match[3]||match[1]||"",version:match[2]||match[4]||"0",versionNumber:match[4]||match[2]||"0",platform:platform_match[0]||""};if(matched.browser&&(browser[matched.browser]=!0,browser.version=matched.version,browser.versionNumber=parseInt(matched.versionNumber,10)),matched.platform&&(browser[matched.platform]=!0),(browser.android||browser.bb||browser.blackberry||browser.ipad||browser.iphone||browser.ipod||browser.kindle||browser.playbook||browser.silk||browser["windows phone"])&&(browser.mobile=!0),(browser.cros||browser.mac||browser.linux||browser.win)&&(browser.desktop=!0),(browser.chrome||browser.opr||browser.safari)&&(browser.webkit=!0),browser.rv||browser.edge){var ie="msie";matched.browser=ie,browser[ie]=!0}if(browser.safari&&browser.blackberry){var blackberry="blackberry";matched.browser=blackberry,browser[blackberry]=!0}if(browser.safari&&browser.playbook){var playbook="playbook";matched.browser=playbook,browser[playbook]=!0}if(browser.bb){var bb="blackberry";matched.browser=bb,browser[bb]=!0}if(browser.opr){var opera="opera";matched.browser=opera,browser[opera]=!0}if(browser.safari&&browser.android){var android="android";matched.browser=android,browser[android]=!0}if(browser.safari&&browser.kindle){var kindle="kindle";matched.browser=kindle,browser[kindle]=!0}if(browser.safari&&browser.silk){var silk="silk";matched.browser=silk,browser[silk]=!0}return browser.name=matched.browser,browser.platform=matched.platform,browser}return window.jQBrowser=uaMatch(window.navigator.userAgent),window.jQBrowser.uaMatch=uaMatch,jQuery&&(jQuery.browser=window.jQBrowser),window.jQBrowser}),define("pat-utils",["jquery","jquery.browser","underscore"],function($){function debounce(func,wait){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,func.apply(context,args)};clearTimeout(timeout),timeout=setTimeout(later,wait)}}function isObject(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj}function extend(obj){if(!isObject(obj))return obj;for(var source,prop,i=1,length=arguments.length;i<length;i++){source=arguments[i];for(prop in source)hasOwnProperty.call(source,prop)&&(obj[prop]=source[prop])}return obj}function rebaseURL(base,url){return url.indexOf("://")!==-1||"/"===url[0]?url:base.slice(0,base.lastIndexOf("/")+1)+url}function findLabel(input){for(var $label,label=input.parentNode;label&&11!==label.nodeType;label=label.parentNode)if("LABEL"===label.tagName)return label;return input.id&&($label=$('label[for="'+input.id+'"]')),$label&&0===$label.length&&input.form&&($label=$('label[for="'+input.name+'"]',input.form)),$label&&$label.length?$label[0]:null}function elementInViewport(el){var rect=el.getBoundingClientRect(),docEl=document.documentElement,vWidth=window.innerWidth||docEl.clientWidth,vHeight=window.innerHeight||docEl.clientHeight;return!(rect.right<0||rect.bottom<0||rect.left>vWidth||rect.top>vHeight)}function escapeRegExp(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function removeWildcardClass($targets,classes){if(classes.indexOf("*")===-1)$targets.removeClass(classes);else{var matcher=classes.replace(/[\-\[\]{}()+?.,\\\^$|#\s]/g,"\\$&");matcher=matcher.replace(/[*]/g,".*"),matcher=new RegExp("^"+matcher+"$"),$targets.filter("[class]").each(function(){for(var $this=$(this),classes=$this.attr("class").split(/\s+/),ok=[],i=0;i<classes.length;i++)matcher.test(classes[i])||ok.push(classes[i]);ok.length?$this.attr("class",ok.join(" ")):$this.removeAttr("class")})}}function hideOrShow($slave,visible,options,pattern_name){var duration="css"===options.transition||"none"===options.transition?null:options.effect.duration;$slave.removeClass("visible hidden in-progress");var onComplete=function(){$slave.removeClass("in-progress").addClass(visible?"visible":"hidden").trigger("pat-update",{pattern:pattern_name,transition:"complete"})};if(duration){var t=transitions[options.transition];$slave.addClass("in-progress").trigger("pat-update",{pattern:pattern_name,transition:"start"}),$slave[visible?t.show:t.hide]({duration:duration,easing:options.effect.easing,complete:onComplete})}else"css"!==options.transition&&$slave[visible?"show":"hide"](),onComplete()}function addURLQueryParameter(fullURL,param,value){var val=new RegExp("(\\?|\\&)"+param+"=.*?(?=(&|$))"),parts=fullURL.toString().split("#"),url=parts[0],hash=parts[1],qstring=/\?.+$/,newURL=url;return newURL=val.test(url)?url.replace(val,"$1"+param+"="+value):qstring.test(url)?url+"&"+param+"="+value:url+"?"+param+"="+value,hash&&(newURL+="#"+hash),newURL}function removeDuplicateObjects(objs){var comparator=function(v,k){return this[k]===v};return _.reduce(objs,function(list,next_obj){var is_duplicate=!1;return _.each(list,function(obj){is_duplicate=_.keys(obj).length===_.keys(next_obj).length&&!_.chain(obj).omit(comparator.bind(next_obj)).keys().value().length}),is_duplicate||list.push(next_obj),list},[])}function mergeStack(stack,length){for(var results=[],i=0;i<length;i++)results.push({});return _.each(stack,function(frame){for(var frame_length=frame.length-1,x=0;x<length;x++)results[x]=$.extend(results[x]||{},frame[x>frame_length?frame_length:x])}),results}$.fn.safeClone=function(){var $clone=this.clone();return void 0!==$.browser.msie&&$clone.findInclusive(":input[placeholder]").each(function(i,item){var $item=$(item);$item.attr("placeholder")===$item.val()&&$item.val("")}),$clone},Array.prototype.forEach||(Array.prototype.forEach=function(callback,thisArg){var T,k;if(null===this)throw new TypeError(" this is null or not defined");var O=Object(this),len=O.length>>>0;if("function"!=typeof callback)throw new TypeError(callback+" is not a function");for(arguments.length>1&&(T=thisArg),k=0;k<len;){var kValue;k in O&&(kValue=O[k],callback.call(T,kValue,k,O)),k++}});var singleBoundJQueryPlugin=function(pattern,method,options){var $this=this;return $this.each(function(){var pat,$el=$(this);if(pat=pattern.init($el,options),method){if(void 0===pat[method])return $.error("Method "+method+" does not exist on jQuery."+pattern.name),!1;if("_"===method.charAt(0))return $.error("Method "+method+" is private on jQuery."+pattern.name),!1;pat[method].apply(pat,[options])}}),$this},pluralBoundJQueryPlugin=function(pattern,method,options){var $this=this;if(method){if(pattern[method])return pattern[method].apply($this,[$this].concat([options]));$.error("Method "+method+" does not exist on jQuery."+pattern.name)}else pattern.init.apply($this,[$this].concat([options]));return $this},jqueryPlugin=function(pattern){return function(method,options){var $this=this;return 0===$this.length?$this:("object"==typeof method&&(options=method,method=void 0),"function"==typeof pattern?singleBoundJQueryPlugin.call(this,pattern,method,options):pluralBoundJQueryPlugin.call(this,pattern,method,options))}},transitions={none:{hide:"hide",show:"show"},fade:{hide:"fadeOut",show:"fadeIn"},slide:{hide:"slideUp",show:"slideDown"}};isElementInViewport=function(el,partial,offset){if(el===[])return!1;el instanceof $&&(el=el[0]);var rec=el.getBoundingClientRect(),rec_values=[rec.top,rec.bottom,rec.left,rec.right];return!_.every(rec_values,function(v){if(0===v)return!0})&&(partial?(void 0===offset&&(offset=0),rec.top<=0+offset&&rec.bottom>=0+offset):rec.top>=0&&rec.left>=0&&rec.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rec.right<=(window.innerWidth||document.documentElement.clientWidth))};var utils={jqueryPlugin:jqueryPlugin,debounce:debounce,escapeRegExp:escapeRegExp,isObject:isObject,extend:extend,rebaseURL:rebaseURL,findLabel:findLabel,elementInViewport:elementInViewport,removeWildcardClass:removeWildcardClass,hideOrShow:hideOrShow,addURLQueryParameter:addURLQueryParameter,removeDuplicateObjects:removeDuplicateObjects,mergeStack:mergeStack,isElementInViewport:isElementInViewport};return utils}),define("pat-compat",[],function(){Array.prototype.every||(Array.prototype.every=function(fun){"use strict";if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var thisp=arguments[1],i=0;i<len;i++)if(i in t&&!fun.call(thisp,t[i],i,t))return!1;return!0}),Array.prototype.filter||(Array.prototype.filter=function(fun){"use strict";if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var res=[],thisp=arguments[1],i=0;i<len;i++)if(i in t){var val=t[i];fun.call(thisp,val,i,t)&&res.push(val)}return res}),Array.prototype.forEach||(Array.prototype.forEach=function(callback,thisArg){var T,k;if(null===this)throw new TypeError(" this is null or not defined");var O=Object(this),len=O.length>>>0;if("[object Function]"!=={}.toString.call(callback))throw new TypeError(callback+" is not a function");for(thisArg&&(T=thisArg),k=0;k<len;){var kValue;k in O&&(kValue=O[k],callback.call(T,kValue,k,O)),k++}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){"use strict";if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=0;if(arguments.length>0&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=len)return-1;for(var k=n>=0?n:Math.max(len-Math.abs(n),0);k<len;k++)if(k in t&&t[k]===searchElement)return k;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(searchElement){"use strict";if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=len;arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))));for(var k=n>=0?Math.min(n,len-1):len-Math.abs(n);k>=0;k--)if(k in t&&t[k]===searchElement)return k;return-1}),Array.prototype.map||(Array.prototype.map=function(callback,thisArg){var T,A,k;if(null===this)throw new TypeError(" this is null or not defined");var O=Object(this),len=O.length>>>0;if("[object Function]"!=={}.toString.call(callback))throw new TypeError(callback+" is not a function");for(thisArg&&(T=thisArg),A=new Array(len),k=0;k<len;){var kValue,mappedValue;k in O&&(kValue=O[k],mappedValue=callback.call(T,kValue,k,O),A[k]=mappedValue),k++}return A}),Array.prototype.reduce||(Array.prototype.reduce=function(accumulator){if(null===this||void 0===this)throw new TypeError("Object is null or undefined");var curr,i=0,l=this.length>>0;if("function"!=typeof accumulator)throw new TypeError("First argument is not callable");if(arguments.length<2){if(0===l)throw new TypeError("Array length is 0 and no second argument");curr=this[0],i=1}else curr=arguments[1];for(;i<l;)i in this&&(curr=accumulator.call(void 0,curr,this[i],i,this)),++i;return curr}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(callbackfn){"use strict";if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if("function"!=typeof callbackfn)throw new TypeError;if(0===len&&1===arguments.length)throw new TypeError;var accumulator,k=len-1;if(arguments.length>=2)accumulator=arguments[1];else for(;;){if(k in this){accumulator=this[k--];break}if(--k<0)throw new TypeError}for(;k>=0;)k in t&&(accumulator=callbackfn.call(void 0,accumulator,t[k],k,t)),k--;return accumulator}),Array.prototype.some||(Array.prototype.some=function(fun){"use strict";if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var thisp=arguments[1],i=0;i<len;i++)if(i in t&&fun.call(thisp,t[i],i,t))return!0;return!1}),Array.isArray||(Array.isArray=function(arg){return"[object Array]"===Object.prototype.toString.call(arg)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Function.prototype.bind||(Function.prototype.bind=function(oThis){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply(this instanceof fNOP&&oThis?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)))};return fNOP.prototype=this.prototype,fBound.prototype=new fNOP,fBound}),Object.keys||(Object.keys=function(){var _hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;return function(obj){if("object"!=typeof obj&&"function"!=typeof obj||null===obj)throw new TypeError("Object.keys called on non-object");var result=[];for(var prop in obj)_hasOwnProperty.call(obj,prop)&&result.push(prop);if(hasDontEnumBug)for(var i=0;i<dontEnumsLength;i++)_hasOwnProperty.call(obj,dontEnums[i])&&result.push(dontEnums[i]);return result}}())}),define("pat-jquery-ext",["jquery"],function($){var methods={init:function(options){var settings={time:3,initialTime:8,exceptionAreas:[]};return this.each(function(){var $this=$(this),data=$this.data("timeout");data||(options&&$.extend(settings,options),$this.data("timeout",{lastEvent:new Date,trueTime:settings.time,time:settings.initialTime,untouched:!0,inExceptionArea:!1}),$this.bind("mouseover.timeout",methods.mouseMoved),$this.bind("mouseenter.timeout",methods.mouseMoved),$(settings.exceptionAreas).each(function(){$this.find(this).live("mouseover.timeout",{parent:$this},methods.enteredException).live("mouseleave.timeout",{parent:$this},methods.leftException)}),settings.initialTime>0?$this.timeout("startTimer"):$this.addClass("timeout"))})},enteredException:function(event){var data=event.data.parent.data("timeout");data.inExceptionArea=!0,event.data.parent.data("timeout",data),event.data.parent.trigger("mouseover")},leftException:function(event){var data=event.data.parent.data("timeout");data.inExceptionArea=!1,event.data.parent.data("timeout",data)},destroy:function(){return this.each(function(){var $this=$(this),data=$this.data("timeout");$(window).unbind(".timeout"),data.timeout.remove(),$this.removeData("timeout")})},mouseMoved:function(){var $this=$(this),data=$this.data("timeout");$this.hasClass("timeout")?($this.removeClass("timeout"),$this.timeout("startTimer")):data.untouched&&(data.untouched=!1,data.time=data.trueTime),data.lastEvent=new Date,$this.data("timeout",data)},startTimer:function(){var $this=$(this),data=$this.data("timeout"),fn=function(){var data=$this.data("timeout");if(data&&data.lastEvent)if(data.inExceptionArea)setTimeout(fn,Math.floor(1e3*data.time));else{var now=new Date,diff=Math.floor(1e3*data.time)-(now-data.lastEvent);diff>0?setTimeout(fn,diff+100):$this.addClass("timeout")}};setTimeout(fn,Math.floor(1e3*data.time))}};$.fn.timeout=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist on jQuery.timeout"):methods.init.apply(this,arguments)},$.extend($.expr[":"],{scrollable:function(element){var vertically_scrollable,horizontally_scrollable;return"scroll"===$(element).css("overflow")||"scroll"===$(element).css("overflowX")||"scroll"===$(element).css("overflowY")||((vertically_scrollable=element.clientHeight<element.scrollHeight&&($.inArray($(element).css("overflowY"),["scroll","auto"])!==-1||$.inArray($(element).css("overflow"),["scroll","auto"])!==-1))||(horizontally_scrollable=element.clientWidth<element.scrollWidth&&($.inArray($(element).css("overflowX"),["scroll","auto"])!==-1||$.inArray($(element).css("overflow"),["scroll","auto"])!==-1)))}}),$.fn.makeVisibleInScroll=function(parent_id){var absoluteParent=null;return"string"==typeof parent_id?absoluteParent=$("#"+parent_id):parent_id&&(absoluteParent=$(parent_id)),this.each(function(){var parent,$this=$(this);absoluteParent?parent=absoluteParent:(parent=$this.parents(":scrollable"),parent=$(parent.length>0?parent[0]:window));var elemTop=$this.position().top,elemBottom=$this.height()+elemTop,viewTop=parent.scrollTop(),viewBottom=parent.height()+viewTop;elemTop<viewTop?parent.scrollTop(elemTop):elemBottom>viewBottom-parent.height()/2&&parent.scrollTop(elemTop-(parent.height()-$this.height())/2)})},$.fn.setPositionAbsolute=function(element,offsettop,offsetleft){return this.each(function(){var $this=$(this),thiswidth=$(this).width(),pos=element.offset(),width=element.width(),height=element.height(),setleft=pos.left+width-thiswidth+offsetleft,settop=pos.top+height+offsettop;$this.css({"z-index":1,position:"absolute",marginLeft:0,marginTop:0,left:setleft+"px",top:settop+"px",width:thiswidth}),$this.remove().appendTo("body").show()})},$.fn.positionAncestor=function(selector){var left=0,top=0;return this.each(function(){var $ancestor=$(this).closest(selector);if($ancestor.length&&"static"!==$ancestor.css("position")){var $child=$(this),childMarginEdgeLeft=$child.offset().left-parseInt($child.css("marginLeft"),10),childMarginEdgeTop=$child.offset().top-parseInt($child.css("marginTop"),10),ancestorPaddingEdgeLeft=$ancestor.offset().left+parseInt($ancestor.css("borderLeftWidth"),10),ancestorPaddingEdgeTop=$ancestor.offset().top+parseInt($ancestor.css("borderTopWidth"),10);return left=childMarginEdgeLeft-ancestorPaddingEdgeLeft,top=childMarginEdgeTop-ancestorPaddingEdgeTop,!1}}),{left:left,top:top}},String.prototype.startsWith=function(str){return null!==this.match("^"+str)},String.prototype.endsWith=function(str){return null!==this.match(str+"$")},$.simplePlaceholder={placeholder_class:null,hide_placeholder:function(){var $this=$(this);$this.val()===$this.attr("placeholder")&&$this.val("").removeClass($.simplePlaceholder.placeholder_class)},show_placeholder:function(){var $this=$(this);""===$this.val()&&$this.val($this.attr("placeholder")).addClass($.simplePlaceholder.placeholder_class)},prevent_placeholder_submit:function(){return $(this).find(".simple-placeholder").each(function(){var $this=$(this);$this.val()===$this.attr("placeholder")&&$this.val("")}),!0}},$.fn.simplePlaceholder=function(options){if(void 0===document.createElement("input").placeholder){var config={placeholder_class:"placeholding"};options&&$.extend(config,options),$.simplePlaceholder.placeholder_class=config.placeholder_class,this.each(function(){var $this=$(this);$this.focus($.simplePlaceholder.hide_placeholder),$this.blur($.simplePlaceholder.show_placeholder),""===$this.val()&&($this.val($this.attr("placeholder")),$this.addClass($.simplePlaceholder.placeholder_class)),$this.addClass("simple-placeholder"),$(this.form).submit($.simplePlaceholder.prevent_placeholder_submit)})}return this},$.fn.findInclusive=function(selector){return this.find("*").addBack().filter(selector)},$.fn.slideIn=function(speed,easing,callback){return this.animate({width:"show"},speed,easing,callback)},$.fn.slideOut=function(speed,easing,callback){return this.animate({width:"hide"},speed,easing,callback)},$.expr[":"].Contains=function(a,i,m){return $(a).text().toUpperCase().indexOf(m[3].toUpperCase())>=0},$.fn.scopedFind=function(selector){return selector.startsWith("#")?$(selector):this.find(selector)}}),define("pat-registry",["jquery","underscore","pat-logger","pat-utils","pat-compat","pat-jquery-ext"],function($,_,logger,utils){for(var match,log=logger.getLogger("registry"),disable_re=/patterns-disable=([^&]+)/g,dont_catch_re=/patterns-dont-catch/g,dont_catch=!1,disabled={};null!==(match=disable_re.exec(window.location.search));)disabled[match[1]]=!0,log.info("Pattern disabled via url config:",match[1]);for(;null!==(match=dont_catch_re.exec(window.location.search));)dont_catch=!0,log.info("I will not catch init exceptions");var registry={patterns:{},initialized:!1,init:function(){$(document).ready(function(){log.info("loaded: "+Object.keys(registry.patterns).sort().join(", ")),registry.scan(document.body),registry.initialized=!0,log.info("finished initial scan.")})},clear:function(){this.patterns={}},transformPattern:function(name,content){if(disabled[name])return void log.debug("Skipping disabled pattern:",name);var pattern=registry.patterns[name];if(pattern.transform)try{pattern.transform($(content))}catch(e){if(dont_catch)throw e;log.error("Transform error for pattern"+name,e)}},initPattern:function(name,el,trigger){var $el=$(el),pattern=registry.patterns[name];if(pattern.init&&(plog=logger.getLogger("pat."+name),$el.is(pattern.trigger))){plog.debug("Initialising:",$el);try{pattern.init($el,null,trigger),plog.debug("done.")}catch(e){if(dont_catch)throw e;plog.error("Caught error:",e)}}},orderPatterns:function(patterns){return _.contains(patterns,"validation")&&_.contains(patterns,"inject")&&(patterns.splice(patterns.indexOf("validation"),1),patterns.unshift("validation")),patterns},scan:function(content,patterns,trigger){var $match,selectors=[];patterns=this.orderPatterns(patterns||Object.keys(registry.patterns)),patterns.forEach(_.partial(this.transformPattern,_,content)),patterns=_.each(patterns,function(name){var pattern=registry.patterns[name];pattern.trigger&&selectors.unshift(pattern.trigger)}),$match=$(content).findInclusive(selectors.join(",")),$match=$match.filter(function(){return 0===$(this).parents("pre").length}),$match=$match.filter(":not(.cant-touch-this)"),$match.toArray().reduceRight(function(acc,el){patterns.forEach(_.partial(this.initPattern,_,el,trigger))}.bind(this),null),$("body").addClass("patterns-loaded")},register:function(pattern,name){var plugin_name;return(name=name||pattern.name)?registry.patterns[name]?(log.error("Already have a pattern called: "+name),!1):(registry.patterns[name]=pattern,pattern.jquery_plugin&&(plugin_name=("pat-"+name).replace(/-([a-zA-Z])/g,function(match,p1){return p1.toUpperCase()}),$.fn[plugin_name]=utils.jqueryPlugin(pattern),$.fn[plugin_name.replace(/^pat/,"pattern")]=$.fn[plugin_name]),log.debug("Registered pattern:",name,pattern),registry.initialized&&registry.scan(document.body,[name]),!0):(log.error("Pattern lacks a name:",pattern),!1)}};return registry}),define("pat-mockup-parser",["jquery"],function($){"use strict";var parser={getOptions:function getOptions($el,patternName,options){options=options||{},0===$el.length||$.nodeName($el[0],"body")||(options=getOptions($el.parent(),patternName,options));var elOptions={};if(0!==$el.length&&(elOptions=$el.data("pat-"+patternName),elOptions&&"string"==typeof elOptions)){var tmpOptions={};$.each(elOptions.split(";"),function(i,item){item=item.split(":"),item.reverse();var key=item.pop();key=key.replace(/^\s+|\s+$/g,""),item.reverse();var value=item.join(":");value=value.replace(/^\s+|\s+$/g,""),tmpOptions[key]=value}),elOptions=tmpOptions}return $.extend(!0,{},options,elOptions)}};return parser}),define("pat-base",["jquery","pat-registry","pat-mockup-parser","pat-logger"],function($,Registry,mockupParser,logger){"use strict";var log=logger.getLogger("Patternslib Base"),initBasePattern=function($el,options,trigger){var name=this.prototype.name,log=logger.getLogger("pat."+name),pattern=$el.data("pattern-"+name);if(void 0===pattern&&Registry.patterns[name]){try{options="mockup"===this.prototype.parser?mockupParser.getOptions($el,name,options):options,pattern=new Registry.patterns[name]($el,options,trigger)}catch(e){log.error("Failed while initializing '"+name+"' pattern.",e)}$el.data("pattern-"+name,pattern)}return pattern},Base=function($el,options,trigger){this.$el=$el,this.options=$.extend(!0,{},this.defaults||{},options||{}),this.init($el,options,trigger),this.emit("init")};return Base.prototype={constructor:Base,on:function(eventName,eventCallback){this.$el.on(eventName+"."+this.name+".patterns",eventCallback)},emit:function(eventName,args){void 0===args&&(args=[]),this.$el.trigger(eventName+"."+this.name+".patterns",args)}},Base.extend=function(patternProps){var child,parent=this;if(!patternProps)throw new Error("Pattern configuration properties required when calling Base.extend");child=patternProps.hasOwnProperty("constructor")?patternProps.constructor:function(){parent.apply(this,arguments)},child.extend=Base.extend,child.init=initBasePattern,child.jquery_plugin=!0,child.trigger=patternProps.trigger;var Surrogate=function(){this.constructor=child};return Surrogate.prototype=parent.prototype,child.prototype=new Surrogate,$.extend(!0,child.prototype,patternProps),child.__super__=parent.prototype,patternProps.name?patternProps.trigger?Registry.register(child,patternProps.name):log.warn("The pattern '"+patternProps.name+"' does not have a trigger attribute, it will not be registered."):log.warn("This pattern without a name attribute will not be registered!"),child},Base}),define("mockup-utils",["jquery"],function($){"use strict";var QueryHelper=function(options){var self=this,defaults={pattern:null,vocabularyUrl:null,searchParam:"SearchableText",pathOperator:"plone.app.querystring.operation.string.path",attributes:["UID","Title","Description","getURL","portal_type"],batchSize:10,baseCriteria:[],sort_on:"is_folderish",sort_order:"reverse",pathDepth:1};return self.options=$.extend({},defaults,options),self.pattern=self.options.pattern,void 0!==self.pattern&&null!==self.pattern||(self.pattern={browsing:!1,basePath:"/"}),self.options.url&&!self.options.vocabularyUrl?self.options.vocabularyUrl=self.options.url:self.pattern.vocabularyUrl&&(self.options.vocabularyUrl=self.pattern.vocabularyUrl),self.valid=Boolean(self.options.vocabularyUrl),self.getBatch=function(page){return{page:page?page:1,size:self.options.batchSize}},self.getCurrentPath=function(){var currentPath,pattern=self.pattern;currentPath=self.currentPath?self.currentPath:pattern.currentPath,"function"==typeof currentPath&&(currentPath=currentPath());var path=currentPath;return path||(path=pattern.basePath?pattern.basePath:pattern.options.basePath?pattern.options.basePath:"/"),path},self.getCriterias=function(term,searchOptions){void 0===searchOptions&&(searchOptions={}),searchOptions=$.extend({},{useBaseCriteria:!0,additionalCriterias:[]},searchOptions);var criterias=[];return searchOptions.useBaseCriteria&&(criterias=self.options.baseCriteria.slice(0)),term&&(term+="*",criterias.push({i:self.options.searchParam,o:"plone.app.querystring.operation.string.contains",v:term})),searchOptions.searchPath?criterias.push({i:"path",o:self.options.pathOperator,v:searchOptions.searchPath+"::"+self.options.pathDepth}):self.pattern.browsing&&criterias.push({i:"path",o:self.options.pathOperator,v:self.getCurrentPath()+"::"+self.options.pathDepth}),criterias=criterias.concat(searchOptions.additionalCriterias)},self.getQueryData=function(term,page){var data={query:JSON.stringify({criteria:self.getCriterias(term),sort_on:self.options.sort_on,sort_order:self.options.sort_order}),attributes:JSON.stringify(self.options.attributes)};return page&&(data.batch=JSON.stringify(self.getBatch(page))),
data},self.getUrl=function(){var url=self.options.vocabularyUrl;return url+=url.indexOf("?")===-1?"?":"&",url+$.param(self.getQueryData())},self.selectAjax=function(){return{url:self.options.vocabularyUrl,dataType:"JSON",quietMillis:100,data:function(term,page){return self.getQueryData(term,page)},results:function(data,page){var more=10*page<data.total;return{results:data.results,more:more}}}},self.search=function(term,operation,value,callback,useBaseCriteria,type){void 0===useBaseCriteria&&(useBaseCriteria=!0),void 0===type&&(type="GET");var criteria=[];useBaseCriteria&&(criteria=self.options.baseCriteria.slice(0)),criteria.push({i:term,o:operation,v:value});var data={query:JSON.stringify({criteria:criteria}),attributes:JSON.stringify(self.options.attributes)};$.ajax({url:self.options.vocabularyUrl,dataType:"JSON",data:data,type:type,success:callback})},self},Loading=function(options){var self=this;self.className="plone-loader";var defaults={backdrop:null,zIndex:10005};return options||(options={}),self.options=$.extend({},defaults,options),self.init=function(){self.$el=$("."+self.className),0===self.$el.length&&(self.$el=$("<div><div></div></div>"),self.$el.addClass(self.className).hide().appendTo("body"))},self.show=function(closable){self.init(),self.$el.show();var zIndex=self.options.zIndex;"function"==typeof zIndex?zIndex=Math.max(zIndex(),10005):(zIndex=10005,$(".plone-modal-wrapper,.plone-modal-backdrop").each(function(){zIndex=Math.max(zIndex,$(this).css("zIndex")||10005)}),zIndex+=1),self.$el.css("zIndex",zIndex),void 0===closable&&(closable=!0),self.options.backdrop&&(self.options.backdrop.closeOnClick=closable,self.options.backdrop.closeOnEsc=closable,self.options.backdrop.init(),self.options.backdrop.show())},self.hide=function(){self.init(),self.$el.hide()},self},getAuthenticator=function(){var $el=$('input[name="_authenticator"]');return 0===$el.length?($el=$('a[href*="_authenticator"]'),$el.length>0?$el.attr("href").split("_authenticator=")[1]:""):$el.val()},generateId=function(prefix){return void 0===prefix&&(prefix="id"),prefix+Math.floor(65536*(1+Math.random())).toString(16).substring(1)},setId=function($el,prefix){void 0===prefix&&(prefix="id");var id=$el.attr("id");return id=void 0===id?generateId(prefix):id.replace(/\./g,"-"),$el.attr("id",id),id},getWindow=function(){var win=window;return win.parent!==window&&(win=win.parent),win},parseBodyTag=function(txt){return $(/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(txt)[0].replace("<body","<div").replace("</body>","</div>")).eq(0).html()},featureSupport={dragAndDrop:function(){return"draggable"in document.createElement("span")},fileApi:function(){return"undefined"!=typeof FileReader},history:function(){return!(!window.history||!window.history.pushState)}},bool=function(val){return"string"==typeof val&&(val=$.trim(val).toLowerCase()),["false",!1,"0",0,"",void 0,null].indexOf(val)===-1},escapeHTML=function(val){return $("<div/>").text(val).html()},removeHTML=function(val){return val.replace(/<[^>]+>/gi,"")};return{bool:bool,escapeHTML:escapeHTML,removeHTML:removeHTML,featureSupport:featureSupport,generateId:generateId,getAuthenticator:getAuthenticator,getWindow:getWindow,Loading:Loading,loading:new Loading,parseBodyTag:parseBodyTag,QueryHelper:QueryHelper,setId:setId}}),function(root){define("select2",["jquery"],function(){return function(){!function($){"undefined"==typeof $.fn.each2&&$.extend($.fn,{each2:function(c){for(var j=$([0]),i=-1,l=this.length;++i<l&&(j.context=j[0]=this[i])&&c.call(j[0],i,j)!==!1;);return this}})}(jQuery),function($,undefined){"use strict";function reinsertElement(element){var placeholder=$(document.createTextNode(""));element.before(placeholder),placeholder.before(element),placeholder.remove()}function stripDiacritics(str){function match(a){return DIACRITICS[a]||a}return str.replace(/[^\u0000-\u007E]/g,match)}function indexOf(value,array){for(var i=0,l=array.length;i<l;i+=1)if(equal(value,array[i]))return i;return-1}function measureScrollbar(){var $template=$(MEASURE_SCROLLBAR_TEMPLATE);$template.appendTo(document.body);var dim={width:$template.width()-$template[0].clientWidth,height:$template.height()-$template[0].clientHeight};return $template.remove(),dim}function equal(a,b){return a===b||a!==undefined&&b!==undefined&&(null!==a&&null!==b&&(a.constructor===String?a+""==b+"":b.constructor===String&&b+""==a+""))}function splitVal(string,separator,transform){var val,i,l;if(null===string||string.length<1)return[];for(val=string.split(separator),i=0,l=val.length;i<l;i+=1)val[i]=transform(val[i]);return val}function getSideBorderPadding(element){return element.outerWidth(!1)-element.width()}function installKeyUpChangeEvent(element){var key="keyup-change-value";element.on("keydown",function(){$.data(element,key)===undefined&&$.data(element,key,element.val())}),element.on("keyup",function(){var val=$.data(element,key);val!==undefined&&element.val()!==val&&($.removeData(element,key),element.trigger("keyup-change"))})}function installFilteredMouseMove(element){element.on("mousemove",function(e){var lastpos=lastMousePosition;lastpos!==undefined&&lastpos.x===e.pageX&&lastpos.y===e.pageY||$(e.target).trigger("mousemove-filtered",e)})}function debounce(quietMillis,fn,ctx){ctx=ctx||undefined;var timeout;return function(){var args=arguments;window.clearTimeout(timeout),timeout=window.setTimeout(function(){fn.apply(ctx,args)},quietMillis)}}function installDebouncedScroll(threshold,element){var notify=debounce(threshold,function(e){element.trigger("scroll-debounced",e)});element.on("scroll",function(e){indexOf(e.target,element.get())>=0&&notify(e)})}function focus($el){$el[0]!==document.activeElement&&window.setTimeout(function(){var range,el=$el[0],pos=$el.val().length;$el.focus();var isVisible=el.offsetWidth>0||el.offsetHeight>0;isVisible&&el===document.activeElement&&(el.setSelectionRange?el.setSelectionRange(pos,pos):el.createTextRange&&(range=el.createTextRange(),range.collapse(!1),range.select()))},0)}function getCursorInfo(el){el=$(el)[0];var offset=0,length=0;if("selectionStart"in el)offset=el.selectionStart,length=el.selectionEnd-offset;else if("selection"in document){el.focus();var sel=document.selection.createRange();length=document.selection.createRange().text.length,sel.moveStart("character",-el.value.length),offset=sel.text.length-length}return{offset:offset,length:length}}function killEvent(event){event.preventDefault(),event.stopPropagation()}function killEventImmediately(event){event.preventDefault(),event.stopImmediatePropagation()}function measureTextWidth(e){if(!sizer){var style=e[0].currentStyle||window.getComputedStyle(e[0],null);sizer=$(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:style.fontSize,fontFamily:style.fontFamily,fontStyle:style.fontStyle,fontWeight:style.fontWeight,letterSpacing:style.letterSpacing,textTransform:style.textTransform,whiteSpace:"nowrap"}),sizer.attr("class","select2-sizer"),$(document.body).append(sizer)}return sizer.text(e.val()),sizer.width()}function syncCssClasses(dest,src,adapter){var classes,adapted,replacements=[];classes=$.trim(dest.attr("class")),classes&&(classes=""+classes,$(classes.split(/\s+/)).each2(function(){0===this.indexOf("select2-")&&replacements.push(this)})),classes=$.trim(src.attr("class")),classes&&(classes=""+classes,$(classes.split(/\s+/)).each2(function(){0!==this.indexOf("select2-")&&(adapted=adapter(this),adapted&&replacements.push(adapted))})),dest.attr("class",replacements.join(" "))}function markMatch(text,term,markup,escapeMarkup){var match=stripDiacritics(text.toUpperCase()).indexOf(stripDiacritics(term.toUpperCase())),tl=term.length;return match<0?void markup.push(escapeMarkup(text)):(markup.push(escapeMarkup(text.substring(0,match))),markup.push("<span class='select2-match'>"),markup.push(escapeMarkup(text.substring(match,match+tl))),markup.push("</span>"),void markup.push(escapeMarkup(text.substring(match+tl,text.length))))}function defaultEscapeMarkup(markup){var replace_map={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(markup).replace(/[&<>"'\/\\]/g,function(match){return replace_map[match]})}function ajax(options){var timeout,handler=null,quietMillis=options.quietMillis||100,ajaxUrl=options.url,self=this;return function(query){window.clearTimeout(timeout),timeout=window.setTimeout(function(){var data=options.data,url=ajaxUrl,transport=options.transport||$.fn.select2.ajaxDefaults.transport,deprecated={type:options.type||"GET",cache:options.cache||!1,jsonpCallback:options.jsonpCallback||undefined,dataType:options.dataType||"json"},params=$.extend({},$.fn.select2.ajaxDefaults.params,deprecated);data=data?data.call(self,query.term,query.page,query.context):null,url="function"==typeof url?url.call(self,query.term,query.page,query.context):url,handler&&"function"==typeof handler.abort&&handler.abort(),options.params&&($.isFunction(options.params)?$.extend(params,options.params.call(self)):$.extend(params,options.params)),$.extend(params,{url:url,dataType:options.dataType,data:data,success:function(data){var results=options.results(data,query.page,query);query.callback(results)},error:function(jqXHR,textStatus,errorThrown){var results={hasError:!0,jqXHR:jqXHR,textStatus:textStatus,errorThrown:errorThrown};query.callback(results)}}),handler=transport.call(self,params)},quietMillis)}}function local(options){var dataText,tmp,data=options,text=function(item){return""+item.text};$.isArray(data)&&(tmp=data,data={results:tmp}),$.isFunction(data)===!1&&(tmp=data,data=function(){return tmp});var dataItem=data();return dataItem.text&&(text=dataItem.text,$.isFunction(text)||(dataText=dataItem.text,text=function(item){return item[dataText]})),function(query){var process,t=query.term,filtered={results:[]};return""===t?void query.callback(data()):(process=function(datum,collection){var group,attr;if(datum=datum[0],datum.children){group={};for(attr in datum)datum.hasOwnProperty(attr)&&(group[attr]=datum[attr]);group.children=[],$(datum.children).each2(function(i,childDatum){process(childDatum,group.children)}),(group.children.length||query.matcher(t,text(group),datum))&&collection.push(group)}else query.matcher(t,text(datum),datum)&&collection.push(datum)},$(data().results).each2(function(i,datum){process(datum,filtered.results)}),void query.callback(filtered))}}function tags(data){var isFunc=$.isFunction(data);return function(query){var t=query.term,filtered={results:[]},result=isFunc?data(query):data;$.isArray(result)&&($(result).each(function(){var isObject=this.text!==undefined,text=isObject?this.text:this;(""===t||query.matcher(t,text))&&filtered.results.push(isObject?this:{id:this,text:this})}),query.callback(filtered))}}function checkFormatter(formatter,formatterName){if($.isFunction(formatter))return!0;if(!formatter)return!1;if("string"==typeof formatter)return!0;throw new Error(formatterName+" must be a string, function, or falsy value")}function evaluate(val,context){if($.isFunction(val)){var args=Array.prototype.slice.call(arguments,2);return val.apply(context,args)}return val}function countResults(results){var count=0;return $.each(results,function(i,item){item.children?count+=countResults(item.children):count++}),count}function defaultTokenizer(input,selection,selectCallback,opts){var token,index,i,l,separator,original=input,dupe=!1;if(!opts.createSearchChoice||!opts.tokenSeparators||opts.tokenSeparators.length<1)return undefined;for(;;){for(index=-1,i=0,l=opts.tokenSeparators.length;i<l&&(separator=opts.tokenSeparators[i],index=input.indexOf(separator),!(index>=0));i++);if(index<0)break;if(token=input.substring(0,index),input=input.substring(index+separator.length),token.length>0&&(token=opts.createSearchChoice.call(this,token,selection),token!==undefined&&null!==token&&opts.id(token)!==undefined&&null!==opts.id(token))){for(dupe=!1,i=0,l=selection.length;i<l;i++)if(equal(opts.id(token),opts.id(selection[i]))){dupe=!0;break}dupe||selectCallback(token)}}return original!==input?input:void 0}function cleanupJQueryElements(){var self=this;$.each(arguments,function(i,element){self[element].remove(),self[element]=null})}function clazz(SuperClass,methods){var constructor=function(){};return constructor.prototype=new SuperClass,constructor.prototype.constructor=constructor,constructor.prototype.parent=SuperClass.prototype,constructor.prototype=$.extend(constructor.prototype,methods),constructor}if(window.Select2===undefined){var AbstractSelect2,SingleSelect2,MultiSelect2,nextUid,sizer,$document,scrollBarDimensions,lastMousePosition={x:0,y:0},KEY={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(k){switch(k=k.which?k.which:k){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:return!0}return!1},isControl:function(e){var k=e.which;switch(k){case KEY.SHIFT:case KEY.CTRL:case KEY.ALT:return!0}return!!e.metaKey},isFunctionKey:function(k){return k=k.which?k.which:k,k>=112&&k<=123}},MEASURE_SCROLLBAR_TEMPLATE="<div class='select2-measure-scrollbar'></div>",DIACRITICS={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};$document=$(document),nextUid=function(){var counter=1;return function(){return counter++}}(),AbstractSelect2=clazz(Object,{bind:function(func){var self=this;return function(){func.apply(self,arguments)}},init:function(opts){var results,search,resultsSelector=".select2-results";this.opts=opts=this.prepareOpts(opts),this.id=opts.id,opts.element.data("select2")!==undefined&&null!==opts.element.data("select2")&&opts.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=$(".select2-hidden-accessible"),0==this.liveRegion.length&&(this.liveRegion=$("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)),this.containerId="s2id_"+(opts.element.attr("id")||"autogen"+nextUid()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",opts.element.attr("title")),this.body=$(document.body),syncCssClasses(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",opts.element.attr("style")),this.container.css(evaluate(opts.containerCss,this.opts.element)),this.container.addClass(evaluate(opts.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",killEvent),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),syncCssClasses(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(evaluate(opts.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",killEvent),this.results=results=this.container.find(resultsSelector),this.search=search=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",killEvent),installFilteredMouseMove(this.results),this.dropdown.on("mousemove-filtered",resultsSelector,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",resultsSelector,this.bind(function(event){this._touchEvent=!0,this.highlightUnderEvent(event)})),this.dropdown.on("touchmove",resultsSelector,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",resultsSelector,this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(event){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),installDebouncedScroll(80,this.results),this.dropdown.on("scroll-debounced",resultsSelector,this.bind(this.loadMoreIfNeeded)),$(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),$(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),$.fn.mousewheel&&results.mousewheel(function(e,delta,deltaX,deltaY){var top=results.scrollTop();deltaY>0&&top-deltaY<=0?(results.scrollTop(0),killEvent(e)):deltaY<0&&results.get(0).scrollHeight-results.scrollTop()+deltaY<=results.height()&&(results.scrollTop(results.get(0).scrollHeight-results.height()),killEvent(e))}),installKeyUpChangeEvent(search),search.on("keyup-change input paste",this.bind(this.updateResults)),search.on("focus",function(){search.addClass("select2-focused")}),search.on("blur",function(){search.removeClass("select2-focused")}),this.dropdown.on("mouseup",resultsSelector,this.bind(function(e){$(e.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(e),this.selectHighlighted(e))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){e.stopPropagation()}),this.lastSearchTerm=undefined,$.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==opts.maximumInputLength&&this.search.attr("maxlength",opts.maximumInputLength);var disabled=opts.element.prop("disabled");disabled===undefined&&(disabled=!1),this.enable(!disabled);var readonly=opts.element.prop("readonly");readonly===undefined&&(readonly=!1),this.readonly(readonly),scrollBarDimensions=scrollBarDimensions||measureScrollbar(),this.autofocus=opts.element.prop("autofocus"),opts.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",opts.searchInputPlaceholder)},destroy:function(){var element=this.opts.element,select2=element.data("select2"),self=this;this.close(),element.length&&element[0].detachEvent&&self._sync&&element.each(function(){self._sync&&this.detachEvent("onpropertychange",self._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,select2!==undefined&&(select2.container.remove(),select2.liveRegion.remove(),select2.dropdown.remove(),element.removeData("select2").off(".select2"),element.is("input[type='hidden']")?element.css("display",""):(element.show().prop("autofocus",this.autofocus||!1),this.elementTabIndex?element.attr({tabindex:this.elementTabIndex}):element.removeAttr("tabindex"),element.show())),cleanupJQueryElements.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(element){return element.is("option")?{id:element.prop("value"),text:element.text(),element:element.get(),css:element.attr("class"),disabled:element.prop("disabled"),locked:equal(element.attr("locked"),"locked")||equal(element.data("locked"),!0)}:element.is("optgroup")?{text:element.attr("label"),children:[],element:element.get(),css:element.attr("class")}:void 0},prepareOpts:function(opts){var element,select,idKey,ajaxUrl,self=this;if(element=opts.element,"select"===element.get(0).tagName.toLowerCase()&&(this.select=select=opts.element),select&&$.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in opts)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),opts.debug=opts.debug||$.fn.select2.defaults.debug,opts.debug&&console&&console.warn&&(null!=opts.id&&console.warn("Select2: The `id` option has been removed in Select2 4.0.0, consider renaming your `id` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),null!=opts.text&&console.warn("Select2: The `text` option has been removed in Select2 4.0.0, consider renaming your `text` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),null!=opts.sortResults&&console.warn("Select2: the `sortResults` option has been renamed to `sorter` in Select2 4.0.0. "),null!=opts.selectOnBlur&&console.warn("Select2: The `selectOnBlur` option has been renamed to `selectOnClose` in Select2 4.0.0."),null!=opts.ajax&&null!=opts.ajax.results&&console.warn("Select2: The `ajax.results` option has been renamed to `ajax.processResults` in Select2 4.0.0."),null!=opts.formatNoResults&&console.warn("Select2: The `formatNoResults` option has been renamed to `language.noResults` in Select2 4.0.0."),null!=opts.formatSearching&&console.warn("Select2: The `formatSearching` option has been renamed to `language.searching` in Select2 4.0.0."),null!=opts.formatInputTooShort&&console.warn("Select2: The `formatInputTooShort` option has been renamed to `language.inputTooShort` in Select2 4.0.0."),null!=opts.formatInputTooLong&&console.warn("Select2: The `formatInputTooLong` option has been renamed to `language.inputTooLong` in Select2 4.0.0."),null!=opts.formatLoading&&console.warn("Select2: The `formatLoading` option has been renamed to `language.loadingMore` in Select2 4.0.0."),null!=opts.formatSelectionTooBig&&console.warn("Select2: The `formatSelectionTooBig` option has been renamed to `language.maximumSelected` in Select2 4.0.0."),opts.element.data("select2Tags")&&console.warn("Select2: The `data-select2-tags` attribute has been renamed to `data-tags` in Select2 4.0.0.")),null!=opts.element.data("tags")){var elemTags=opts.element.data("tags");$.isArray(elemTags)||(elemTags=[]),opts.element.data("select2Tags",elemTags)}if(null!=opts.sorter&&(opts.sortResults=opts.sorter),null!=opts.selectOnClose&&(opts.selectOnBlur=opts.selectOnClose),null!=opts.ajax&&$.isFunction(opts.ajax.processResults)&&(opts.ajax.results=opts.ajax.processResults),null!=opts.language){var lang=opts.language;$.isFunction(lang.noMatches)&&(opts.formatNoMatches=lang.noMatches),$.isFunction(lang.searching)&&(opts.formatSearching=lang.searching),$.isFunction(lang.inputTooShort)&&(opts.formatInputTooShort=lang.inputTooShort),$.isFunction(lang.inputTooLong)&&(opts.formatInputTooLong=lang.inputTooLong),$.isFunction(lang.loadingMore)&&(opts.formatLoading=lang.loadingMore),$.isFunction(lang.maximumSelected)&&(opts.formatSelectionTooBig=lang.maximumSelected)}if(opts=$.extend({},{populateResults:function(container,results,query){var populate,id=this.opts.id,liveRegion=this.liveRegion;(populate=function(results,container,depth){var i,l,result,selectable,disabled,compound,node,label,innerContainer,formatted;results=opts.sortResults(results,container,query);var nodes=[];for(i=0,l=results.length;i<l;i+=1)result=results[i],disabled=result.disabled===!0,selectable=!disabled&&id(result)!==undefined,compound=result.children&&result.children.length>0,node=$("<li></li>"),node.addClass("select2-results-dept-"+depth),node.addClass("select2-result"),node.addClass(selectable?"select2-result-selectable":"select2-result-unselectable"),disabled&&node.addClass("select2-disabled"),compound&&node.addClass("select2-result-with-children"),node.addClass(self.opts.formatResultCssClass(result)),node.attr("role","presentation"),label=$(document.createElement("div")),label.addClass("select2-result-label"),label.attr("id","select2-result-label-"+nextUid()),label.attr("role","option"),formatted=opts.formatResult(result,label,query,self.opts.escapeMarkup),formatted!==undefined&&(label.html(formatted),node.append(label)),compound&&(innerContainer=$("<ul></ul>"),innerContainer.addClass("select2-result-sub"),populate(result.children,innerContainer,depth+1),node.append(innerContainer)),node.data("select2-data",result),nodes.push(node[0]);container.append(nodes),liveRegion.text(opts.formatMatches(results.length))})(results,container,0)}},$.fn.select2.defaults,opts),"function"!=typeof opts.id&&(idKey=opts.id,opts.id=function(e){return e[idKey]}),$.isArray(opts.element.data("select2Tags"))){if("tags"in opts)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+opts.element.attr("id");opts.tags=opts.element.data("select2Tags")}if(select?(opts.query=this.bind(function(query){var children,placeholderOption,process,data={results:[],more:!1},term=query.term;process=function(element,collection){var group;element.is("option")?query.matcher(term,element.text(),element)&&collection.push(self.optionToData(element)):element.is("optgroup")&&(group=self.optionToData(element),element.children().each2(function(i,elm){process(elm,group.children)}),group.children.length>0&&collection.push(group))},children=element.children(),this.getPlaceholder()!==undefined&&children.length>0&&(placeholderOption=this.getPlaceholderOption(),placeholderOption&&(children=children.not(placeholderOption))),children.each2(function(i,elm){process(elm,data.results)}),query.callback(data)}),opts.id=function(e){return e.id}):"query"in opts||("ajax"in opts?(ajaxUrl=opts.element.data("ajax-url"),ajaxUrl&&ajaxUrl.length>0&&(opts.ajax.url=ajaxUrl),opts.query=ajax.call(opts.element,opts.ajax)):"data"in opts?opts.query=local(opts.data):"tags"in opts&&(opts.query=tags(opts.tags),opts.createSearchChoice===undefined&&(opts.createSearchChoice=function(term){return{id:$.trim(term),text:$.trim(term)}}),opts.initSelection===undefined&&(opts.initSelection=function(element,callback){var data=[];$(splitVal(element.val(),opts.separator,opts.transformVal)).each(function(){var obj={id:this,text:this},tags=opts.tags;$.isFunction(tags)&&(tags=tags()),
$(tags).each(function(){if(equal(this.id,obj.id))return obj=this,!1}),data.push(obj)}),callback(data)}))),"function"!=typeof opts.query)throw"query function not defined for Select2 "+opts.element.attr("id");if("top"===opts.createSearchChoicePosition)opts.createSearchChoicePosition=function(list,item){list.unshift(item)};else if("bottom"===opts.createSearchChoicePosition)opts.createSearchChoicePosition=function(list,item){list.push(item)};else if("function"!=typeof opts.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return opts},monitorSource:function(){var observer,el=this.opts.element,self=this;el.on("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),this._sync=this.bind(function(){var disabled=el.prop("disabled");disabled===undefined&&(disabled=!1),this.enable(!disabled);var readonly=el.prop("readonly");readonly===undefined&&(readonly=!1),this.readonly(readonly),this.container&&(syncCssClasses(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(evaluate(this.opts.containerCssClass,this.opts.element))),this.dropdown&&(syncCssClasses(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(evaluate(this.opts.dropdownCssClass,this.opts.element)))}),el.length&&el[0].attachEvent&&el.each(function(){this.attachEvent("onpropertychange",self._sync)}),observer=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,observer!==undefined&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new observer(function(mutations){$.each(mutations,self._sync)}),this.propertyObserver.observe(el.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(data){var evt=$.Event("select2-selecting",{val:this.id(data),object:data,choice:data});return this.opts.element.trigger(evt),!evt.isDefaultPrevented()},triggerChange:function(details){details=details||{},details=$.extend({},details,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(details),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var enabled=this._enabled&&!this._readonly,disabled=!enabled;return enabled!==this.enabledInterface&&(this.container.toggleClass("select2-container-disabled",disabled),this.close(),this.enabledInterface=enabled,!0)},enable:function(enabled){enabled===undefined&&(enabled=!0),this._enabled!==enabled&&(this._enabled=enabled,this.opts.element.prop("disabled",!enabled),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(enabled){enabled===undefined&&(enabled=!1),this._readonly!==enabled&&(this._readonly=enabled,this.opts.element.prop("readonly",enabled),this.enableInterface())},opened:function(){return!!this.container&&this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var bodyOffset,above,changeDirection,css,resultsListNode,$dropdown=this.dropdown,container=this.container,offset=container.offset(),height=container.outerHeight(!1),width=container.outerWidth(!1),dropHeight=$dropdown.outerHeight(!1),$window=$(window),windowWidth=$window.width(),windowHeight=$window.height(),viewPortRight=$window.scrollLeft()+windowWidth,viewportBottom=$window.scrollTop()+windowHeight,dropTop=offset.top+height,dropLeft=offset.left,enoughRoomBelow=dropTop+dropHeight<=viewportBottom,enoughRoomAbove=offset.top-dropHeight>=$window.scrollTop(),dropWidth=$dropdown.outerWidth(!1),enoughRoomOnRight=function(){return dropLeft+dropWidth<=viewPortRight},enoughRoomOnLeft=function(){return offset.left+viewPortRight+container.outerWidth(!1)>dropWidth},aboveNow=$dropdown.hasClass("select2-drop-above");aboveNow?(above=!0,!enoughRoomAbove&&enoughRoomBelow&&(changeDirection=!0,above=!1)):(above=!1,!enoughRoomBelow&&enoughRoomAbove&&(changeDirection=!0,above=!0)),changeDirection&&($dropdown.hide(),offset=this.container.offset(),height=this.container.outerHeight(!1),width=this.container.outerWidth(!1),dropHeight=$dropdown.outerHeight(!1),viewPortRight=$window.scrollLeft()+windowWidth,viewportBottom=$window.scrollTop()+windowHeight,dropTop=offset.top+height,dropLeft=offset.left,dropWidth=$dropdown.outerWidth(!1),$dropdown.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(resultsListNode=$(".select2-results",$dropdown)[0],$dropdown.addClass("select2-drop-auto-width"),$dropdown.css("width",""),dropWidth=$dropdown.outerWidth(!1)+(resultsListNode.scrollHeight===resultsListNode.clientHeight?0:scrollBarDimensions.width),dropWidth>width?width=dropWidth:dropWidth=width,dropHeight=$dropdown.outerHeight(!1)):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(bodyOffset=this.body.offset(),dropTop-=bodyOffset.top,dropLeft-=bodyOffset.left),!enoughRoomOnRight()&&enoughRoomOnLeft()&&(dropLeft=offset.left+this.container.outerWidth(!1)-dropWidth),css={left:dropLeft,width:width},above?(this.container.addClass("select2-drop-above"),$dropdown.addClass("select2-drop-above"),dropHeight=$dropdown.outerHeight(!1),css.top=offset.top-dropHeight,css.bottom="auto"):(css.top=dropTop,css.bottom="auto",this.container.removeClass("select2-drop-above"),$dropdown.removeClass("select2-drop-above")),css=$.extend(css,evaluate(this.opts.dropdownCss,this.opts.element)),$dropdown.css(css)},shouldOpen:function(){var event;return!this.opened()&&(this._enabled!==!1&&this._readonly!==!0&&(event=$.Event("select2-opening"),this.opts.element.trigger(event),!event.isDefaultPrevented()))},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(this.opening(),$document.on("mousemove.select2Event",function(e){lastMousePosition.x=e.pageX,lastMousePosition.y=e.pageY}),!0)},opening:function(){var mask,cid=this.containerEventName,scroll="scroll."+cid,resize="resize."+cid,orient="orientationchange."+cid;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),mask=$("#select2-drop-mask"),0===mask.length&&(mask=$(document.createElement("div")),mask.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),mask.hide(),mask.appendTo(this.body),mask.on("mousedown touchstart click",function(e){reinsertElement(mask);var self,dropdown=$("#select2-drop");dropdown.length>0&&(self=dropdown.data("select2"),self.opts.selectOnBlur&&self.selectHighlighted({noFocus:!0}),self.close(),e.preventDefault(),e.stopPropagation())})),this.dropdown.prev()[0]!==mask[0]&&this.dropdown.before(mask),$("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),mask.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var that=this;this.container.parents().add(window).each(function(){$(this).on(resize+" "+scroll+" "+orient,function(e){that.opened()&&that.positionDropdown()})})},close:function(){if(this.opened()){var cid=this.containerEventName,scroll="scroll."+cid,resize="resize."+cid,orient="orientationchange."+cid;this.container.parents().add(window).each(function(){$(this).off(scroll).off(resize).off(orient)}),this.clearDropdownAlignmentPreference(),$("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),$document.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.search.removeAttr("aria-activedescendant"),this.opts.element.trigger($.Event("select2-close"))}},externalSearch:function(term){this.open(),this.search.val(term),this.updateResults(!1)},clearSearch:function(){},prefillNextSearchTerm:function(){if(""!==this.search.val())return!1;var nextSearchTerm=this.opts.nextSearchTerm(this.data(),this.lastSearchTerm);return nextSearchTerm!==undefined&&(this.search.val(nextSearchTerm),this.search.select(),!0)},getMaximumSelectionSize:function(){return evaluate(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var children,index,child,hb,rb,y,more,topOffset,results=this.results;if(index=this.highlight(),!(index<0)){if(0==index)return void results.scrollTop(0);children=this.findHighlightableChoices().find(".select2-result-label"),child=$(children[index]),topOffset=(child.offset()||{}).top||0,hb=topOffset+child.outerHeight(!0),index===children.length-1&&(more=results.find("li.select2-more-results"),more.length>0&&(hb=more.offset().top+more.outerHeight(!0))),rb=results.offset().top+results.outerHeight(!1),hb>rb&&results.scrollTop(results.scrollTop()+(hb-rb)),y=topOffset-results.offset().top,y<0&&"none"!=child.css("display")&&results.scrollTop(results.scrollTop()+y)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(delta){for(var choices=this.findHighlightableChoices(),index=this.highlight();index>-1&&index<choices.length;){index+=delta;var choice=$(choices[index]);if(choice.hasClass("select2-result-selectable")&&!choice.hasClass("select2-disabled")&&!choice.hasClass("select2-selected")){this.highlight(index);break}}},highlight:function(index){var choice,data,choices=this.findHighlightableChoices();return 0===arguments.length?indexOf(choices.filter(".select2-highlighted")[0],choices.get()):(index>=choices.length&&(index=choices.length-1),index<0&&(index=0),this.removeHighlight(),choice=$(choices[index]),choice.addClass("select2-highlighted"),this.search.attr("aria-activedescendant",choice.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(choice.text()),data=choice.data("select2-data"),void(data&&this.opts.element.trigger({type:"select2-highlight",val:this.id(data),choice:data})))},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(event){var el=$(event.target).closest(".select2-result-selectable");if(el.length>0&&!el.is(".select2-highlighted")){var choices=this.findHighlightableChoices();this.highlight(choices.index(el))}else 0==el.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var below,results=this.results,more=results.find("li.select2-more-results"),page=this.resultsPage+1,self=this,term=this.search.val(),context=this.context;0!==more.length&&(below=more.offset().top-results.offset().top-results.height(),below<=this.opts.loadMorePadding&&(more.addClass("select2-active"),this.opts.query({element:this.opts.element,term:term,page:page,context:context,matcher:this.opts.matcher,callback:this.bind(function(data){self.opened()&&(self.opts.populateResults.call(this,results,data.results,{term:term,page:page,context:context}),self.postprocessResults(data,!1,!1),data.more===!0?(more.detach().appendTo(results).html(self.opts.escapeMarkup(evaluate(self.opts.formatLoadMore,self.opts.element,page+1))),window.setTimeout(function(){self.loadMoreIfNeeded()},10)):more.remove(),self.positionDropdown(),self.resultsPage=page,self.context=data.context,this.opts.element.trigger({type:"select2-loaded",items:data}))})})))},tokenize:function(){},updateResults:function(initial){function postRender(){search.removeClass("select2-active"),self.positionDropdown(),results.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?self.liveRegion.text(results.text()):self.liveRegion.text(self.opts.formatMatches(results.find('.select2-result-selectable:not(".select2-selected")').length))}function render(html){results.html(html),postRender()}var data,input,queryNumber,search=this.search,results=this.results,opts=this.opts,self=this,term=search.val(),lastTerm=$.data(this.container,"select2-last-term");if((initial===!0||!lastTerm||!equal(term,lastTerm))&&($.data(this.container,"select2-last-term",term),initial===!0||this.showSearchInput!==!1&&this.opened())){queryNumber=++this.queryCount;var maxSelSize=this.getMaximumSelectionSize();if(maxSelSize>=1&&(data=this.data(),$.isArray(data)&&data.length>=maxSelSize&&checkFormatter(opts.formatSelectionTooBig,"formatSelectionTooBig")))return void render("<li class='select2-selection-limit'>"+evaluate(opts.formatSelectionTooBig,opts.element,maxSelSize)+"</li>");if(search.val().length<opts.minimumInputLength)return render(checkFormatter(opts.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+evaluate(opts.formatInputTooShort,opts.element,search.val(),opts.minimumInputLength)+"</li>":""),void(initial&&this.showSearch&&this.showSearch(!0));if(opts.maximumInputLength&&search.val().length>opts.maximumInputLength)return void render(checkFormatter(opts.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+evaluate(opts.formatInputTooLong,opts.element,search.val(),opts.maximumInputLength)+"</li>":"");opts.formatSearching&&0===this.findHighlightableChoices().length&&render("<li class='select2-searching'>"+evaluate(opts.formatSearching,opts.element)+"</li>"),search.addClass("select2-active"),this.removeHighlight(),input=this.tokenize(),input!=undefined&&null!=input&&search.val(input),this.resultsPage=1,opts.query({element:opts.element,term:search.val(),page:this.resultsPage,context:null,matcher:opts.matcher,callback:this.bind(function(data){var def;if(queryNumber==this.queryCount){if(!this.opened())return void this.search.removeClass("select2-active");if(data.hasError!==undefined&&checkFormatter(opts.formatAjaxError,"formatAjaxError"))return void render("<li class='select2-ajax-error'>"+evaluate(opts.formatAjaxError,opts.element,data.jqXHR,data.textStatus,data.errorThrown)+"</li>");if(this.context=data.context===undefined?null:data.context,this.opts.createSearchChoice&&""!==search.val()&&(def=this.opts.createSearchChoice.call(self,search.val(),data.results),def!==undefined&&null!==def&&self.id(def)!==undefined&&null!==self.id(def)&&0===$(data.results).filter(function(){return equal(self.id(this),self.id(def))}).length&&this.opts.createSearchChoicePosition(data.results,def)),0===data.results.length&&checkFormatter(opts.formatNoMatches,"formatNoMatches"))return render("<li class='select2-no-results'>"+evaluate(opts.formatNoMatches,opts.element,search.val())+"</li>"),void(this.showSearch&&this.showSearch(search.val()));results.empty(),self.opts.populateResults.call(this,results,data.results,{term:search.val(),page:this.resultsPage,context:null}),data.more===!0&&checkFormatter(opts.formatLoadMore,"formatLoadMore")&&(results.append("<li class='select2-more-results'>"+opts.escapeMarkup(evaluate(opts.formatLoadMore,opts.element,this.resultsPage))+"</li>"),window.setTimeout(function(){self.loadMoreIfNeeded()},10)),this.postprocessResults(data,initial),postRender(),this.opts.element.trigger({type:"select2-loaded",items:data})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){focus(this.search)},selectHighlighted:function(options){if(this._touchMoved)return void this.clearTouchMoved();var index=this.highlight(),highlighted=this.results.find(".select2-highlighted"),data=highlighted.closest(".select2-result").data("select2-data");data?(this.highlight(index),this.onSelect(data,options)):options&&options.noFocus&&this.close()},getPlaceholder:function(){var placeholderOption;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((placeholderOption=this.getPlaceholderOption())!==undefined?placeholderOption.text():undefined)},getPlaceholderOption:function(){if(this.select){var firstOption=this.select.children("option").first();if(this.opts.placeholderOption!==undefined)return"first"===this.opts.placeholderOption&&firstOption||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===$.trim(firstOption.text())&&""===firstOption.val())return firstOption}},initContainerWidth:function(){function resolveContainerWidth(){var style,attrs,matches,i,l,attr;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(style=this.opts.element.attr("style"),"string"==typeof style)for(attrs=style.split(";"),i=0,l=attrs.length;i<l;i+=1)if(attr=attrs[i].replace(/\s/g,""),matches=attr.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==matches&&matches.length>=1)return matches[1];return"resolve"===this.opts.width?(style=this.opts.element.css("width"),style.indexOf("%")>0?style:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return $.isFunction(this.opts.width)?this.opts.width():this.opts.width}var width=resolveContainerWidth.call(this);null!==width&&this.container.css("width",width)}}),SingleSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""));return container},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var el,range,len;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),el=this.search.get(0),el.createTextRange?(range=el.createTextRange(),range.collapse(!1),range.select()):el.setSelectionRange&&(len=this.search.val().length,el.setSelectionRange(len,len))),this.prefillNextSearchTerm(),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger($.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){$("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),cleanupJQueryElements.call(this,"selection","focusser")},initContainer:function(){var selection,elementLabel,container=this.container,dropdown=this.dropdown,idSuffix=nextUid();this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=selection=container.find(".select2-choice"),this.focusser=container.find(".select2-focusser"),selection.find(".select2-chosen").attr("id","select2-chosen-"+idSuffix),this.focusser.attr("aria-labelledby","select2-chosen-"+idSuffix),this.results.attr("id","select2-results-"+idSuffix),this.search.attr("aria-owns","select2-results-"+idSuffix),this.focusser.attr("id","s2id_autogen"+idSuffix),elementLabel=$("label[for='"+this.opts.element.attr("id")+"']"),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.focusser.prev().text(elementLabel.text()).attr("for",this.focusser.attr("id"));var originalTitle=this.opts.element.attr("title");this.opts.element.attr("title",originalTitle||elementLabel.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text($("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&229!=e.keyCode){if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN)return void killEvent(e);switch(e.which){case KEY.UP:case KEY.DOWN:return this.moveHighlight(e.which===KEY.UP?-1:1),void killEvent(e);case KEY.ENTER:return this.selectHighlighted(),void killEvent(e);case KEY.TAB:return void this.selectHighlighted({noFocus:!0});case KEY.ESC:return this.cancel(e),void killEvent(e)}}})),this.search.on("blur",this.bind(function(e){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.results&&this.results.length>1&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==KEY.TAB&&!KEY.isControl(e)&&!KEY.isFunctionKey(e)&&e.which!==KEY.ESC){if(this.opts.openOnEnter===!1&&e.which===KEY.ENTER)return void killEvent(e);if(e.which==KEY.DOWN||e.which==KEY.UP||e.which==KEY.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void killEvent(e)}return e.which==KEY.DELETE||e.which==KEY.BACKSPACE?(this.opts.allowClear&&this.clear(),void killEvent(e)):void 0}})),installKeyUpChangeEvent(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),selection.on("mousedown touchstart","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),killEventImmediately(e),this.close(),this.selection&&this.selection.focus())})),selection.on("mousedown touchstart",this.bind(function(e){reinsertElement(selection),this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),killEvent(e)})),dropdown.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),selection.on("focus",this.bind(function(e){killEvent(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger($.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.hide(),this.setPlaceholder()},clear:function(triggerChange){var data=this.selection.data("select2-data");if(data){var evt=$.Event("select2-clearing");if(this.opts.element.trigger(evt),evt.isDefaultPrevented())return;var placeholderOption=this.getPlaceholderOption();this.opts.element.val(placeholderOption?placeholderOption.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),triggerChange!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(data),choice:data}),this.triggerChange({removed:data}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var self=this;this.opts.initSelection.call(null,this.opts.element,function(selected){selected!==undefined&&null!==selected&&(self.updateSelection(selected),self.close(),self.setPlaceholder(),self.lastSearchTerm=self.search.val())})}},isPlaceholderOptionSelected:function(){var placeholderOption;return this.getPlaceholder()!==undefined&&((placeholderOption=this.getPlaceholderOption())!==undefined&&placeholderOption.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===undefined||null===this.opts.element.val())},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments),self=this;return"select"===opts.element.get(0).tagName.toLowerCase()?opts.initSelection=function(element,callback){var selected=element.find("option").filter(function(){return this.selected&&!this.disabled});callback(self.optionToData(selected))}:"data"in opts&&(opts.initSelection=opts.initSelection||function(element,callback){var id=element.val(),match=null;opts.query({matcher:function(term,text,el){var is_match=equal(id,opts.id(el));return is_match&&(match=el),is_match},callback:$.isFunction(callback)?function(){callback(match)}:$.noop})}),opts},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===undefined?undefined:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var placeholder=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&placeholder!==undefined){if(this.select&&this.getPlaceholderOption()===undefined)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(placeholder)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(data,initial,noHighlightUpdate){var selected=0,self=this;if(this.findHighlightableChoices().each2(function(i,elm){if(equal(self.id(elm.data("select2-data")),self.opts.element.val()))return selected=i,!1}),noHighlightUpdate!==!1&&(initial===!0&&selected>=0?this.highlight(selected):this.highlight(0)),initial===!0){var min=this.opts.minimumResultsForSearch;min>=0&&this.showSearch(countResults(data.results)>=min)}},showSearch:function(showSearchInput){this.showSearchInput!==showSearchInput&&(this.showSearchInput=showSearchInput,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!showSearchInput),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!showSearchInput),$(this.dropdown,this.container).toggleClass("select2-with-searchbox",showSearchInput))},onSelect:function(data,options){if(this.triggerSelect(data)){var old=this.opts.element.val(),oldData=this.data();this.opts.element.val(this.id(data)),this.updateSelection(data),this.opts.element.trigger({type:"select2-selected",val:this.id(data),choice:data}),this.lastSearchTerm=this.search.val(),this.close(),options&&options.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),equal(old,this.id(data))||this.triggerChange({added:data,removed:oldData})}},updateSelection:function(data){var formatted,cssClass,container=this.selection.find(".select2-chosen");this.selection.data("select2-data",data),container.empty(),null!==data&&(formatted=this.opts.formatSelection(data,container,this.opts.escapeMarkup)),formatted!==undefined&&container.append(formatted),cssClass=this.opts.formatSelectionCssClass(data,container),cssClass!==undefined&&container.addClass(cssClass),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==undefined&&this.container.addClass("select2-allowclear")},val:function(){var val,triggerChange=!1,data=null,self=this,oldData=this.data();if(0===arguments.length)return this.opts.element.val();if(val=arguments[0],arguments.length>1&&(triggerChange=arguments[1],this.opts.debug&&console&&console.warn&&console.warn('Select2: The second option to `select2("val")` is not supported in Select2 4.0.0. The `change` event will always be triggered in 4.0.0.')),this.select)this.opts.debug&&console&&console.warn&&console.warn('Select2: Setting the value on a <select> using `select2("val")` is no longer supported in 4.0.0. You can use the `.val(newValue).trigger("change")` method provided by jQuery instead.'),this.select.val(val).find("option").filter(function(){return this.selected}).each2(function(i,elm){return data=self.optionToData(elm),!1}),this.updateSelection(data),this.setPlaceholder(),triggerChange&&this.triggerChange({added:data,removed:oldData});else{if(!val&&0!==val)return void this.clear(triggerChange);if(this.opts.initSelection===undefined)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(val),this.opts.initSelection(this.opts.element,function(data){self.opts.element.val(data?self.id(data):""),self.updateSelection(data),self.setPlaceholder(),triggerChange&&self.triggerChange({added:data,removed:oldData})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(value){var data,triggerChange=!1;return 0===arguments.length?(data=this.selection.data("select2-data"),data==undefined&&(data=null),data):(this.opts.debug&&console&&console.warn&&console.warn('Select2: The `select2("data")` method can no longer set selected values in 4.0.0, consider using the `.val()` method instead.'),arguments.length>1&&(triggerChange=arguments[1]),value?(data=this.data(),this.opts.element.val(value?this.id(value):""),this.updateSelection(value),triggerChange&&this.triggerChange({added:value,removed:data})):this.clear(triggerChange),void 0)}}),MultiSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return container},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments),self=this;return"select"===opts.element.get(0).tagName.toLowerCase()?opts.initSelection=function(element,callback){var data=[];element.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(i,elm){data.push(self.optionToData(elm))}),callback(data)}:"data"in opts&&(opts.initSelection=opts.initSelection||function(element,callback){var ids=splitVal(element.val(),opts.separator,opts.transformVal),matches=[];opts.query({matcher:function(term,text,el){var is_match=$.grep(ids,function(id){return equal(id,opts.id(el))}).length;return is_match&&matches.push(el),is_match},callback:$.isFunction(callback)?function(){for(var ordered=[],i=0;i<ids.length;i++)for(var id=ids[i],j=0;j<matches.length;j++){var match=matches[j];if(equal(id,opts.id(match))){ordered.push(match),matches.splice(j,1);break}}callback(ordered)}:$.noop})}),opts},selectChoice:function(choice){var selected=this.container.find(".select2-search-choice-focus");selected.length&&choice&&choice[0]==selected[0]||(selected.length&&this.opts.element.trigger("choice-deselected",selected),
selected.removeClass("select2-search-choice-focus"),choice&&choice.length&&(this.close(),choice.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",choice)))},destroy:function(){$("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),cleanupJQueryElements.call(this,"searchContainer","selection")},initContainer:function(){var selection,selector=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=selection=this.container.find(selector);var _this=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",function(e){_this.search[0].focus(),_this.selectChoice($(this))}),this.search.attr("id","s2id_autogen"+nextUid()),this.search.prev().text($("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.search.on("input paste",this.bind(function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var selected=selection.find(".select2-search-choice-focus"),prev=selected.prev(".select2-search-choice:not(.select2-locked)"),next=selected.next(".select2-search-choice:not(.select2-locked)"),pos=getCursorInfo(this.search);if(selected.length&&(e.which==KEY.LEFT||e.which==KEY.RIGHT||e.which==KEY.BACKSPACE||e.which==KEY.DELETE||e.which==KEY.ENTER)){var selectedChoice=selected;return e.which==KEY.LEFT&&prev.length?selectedChoice=prev:e.which==KEY.RIGHT?selectedChoice=next.length?next:null:e.which===KEY.BACKSPACE?this.unselect(selected.first())&&(this.search.width(10),selectedChoice=prev.length?prev:next):e.which==KEY.DELETE?this.unselect(selected.first())&&(this.search.width(10),selectedChoice=next.length?next:null):e.which==KEY.ENTER&&(selectedChoice=null),this.selectChoice(selectedChoice),killEvent(e),void(selectedChoice&&selectedChoice.length||this.open())}if((e.which===KEY.BACKSPACE&&1==this.keydowns||e.which==KEY.LEFT)&&0==pos.offset&&!pos.length)return this.selectChoice(selection.find(".select2-search-choice:not(.select2-locked)").last()),void killEvent(e);if(this.selectChoice(null),this.opened())switch(e.which){case KEY.UP:case KEY.DOWN:return this.moveHighlight(e.which===KEY.UP?-1:1),void killEvent(e);case KEY.ENTER:return this.selectHighlighted(),void killEvent(e);case KEY.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case KEY.ESC:return this.cancel(e),void killEvent(e)}if(e.which!==KEY.TAB&&!KEY.isControl(e)&&!KEY.isFunctionKey(e)&&e.which!==KEY.BACKSPACE&&e.which!==KEY.ESC){if(e.which===KEY.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),e.which!==KEY.PAGE_UP&&e.which!==KEY.PAGE_DOWN||killEvent(e),e.which===KEY.ENTER&&killEvent(e)}}})),this.search.on("keyup",this.bind(function(e){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),e.stopImmediatePropagation(),this.opts.element.trigger($.Event("select2-blur"))})),this.container.on("click",selector,this.bind(function(e){this.isInterfaceEnabled()&&($(e.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.open(),this.focusSearch(),e.preventDefault()))})),this.container.on("focus",selector,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.hide(),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var self=this;this.opts.initSelection.call(null,this.opts.element,function(data){data!==undefined&&null!==data&&(self.updateSelection(data),self.close(),self.clearSearch())})}},clearSearch:function(){var placeholder=this.getPlaceholder(),maxWidth=this.getMaxSearchWidth();placeholder!==undefined&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(placeholder).addClass("select2-default"),this.search.width(maxWidth>0?maxWidth:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.prefillNextSearchTerm(),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger($.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(data){var ids={},filtered=[],self=this;$(data).each(function(){self.id(this)in ids||(ids[self.id(this)]=0,filtered.push(this))}),this.selection.find(".select2-search-choice").remove(),this.addSelectedChoice(filtered),self.postprocessResults()},tokenize:function(){var input=this.search.val();input=this.opts.tokenizer.call(this,input,this.data(),this.bind(this.onSelect),this.opts),null!=input&&input!=undefined&&(this.search.val(input),input.length>0&&this.open())},onSelect:function(data,options){this.triggerSelect(data)&&""!==data.text&&(this.addSelectedChoice(data),this.opts.element.trigger({type:"selected",val:this.id(data),choice:data}),this.lastSearchTerm=this.search.val(),this.clearSearch(),this.updateResults(),!this.select&&this.opts.closeOnSelect||this.postprocessResults(data,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.prefillNextSearchTerm()&&this.updateResults(),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:data}),options&&options.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(data){var val=this.getVal(),self=this;$(data).each(function(){val.push(self.createChoice(this))}),this.setVal(val)},createChoice:function(data){var formatted,cssClass,enableChoice=!data.locked,enabledItem=$("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),disabledItem=$("<li class='select2-search-choice select2-locked'><div></div></li>"),choice=enableChoice?enabledItem:disabledItem,id=this.id(data);return formatted=this.opts.formatSelection(data,choice.find("div"),this.opts.escapeMarkup),formatted!=undefined&&choice.find("div").replaceWith($("<div></div>").html(formatted)),cssClass=this.opts.formatSelectionCssClass(data,choice.find("div")),cssClass!=undefined&&choice.addClass(cssClass),enableChoice&&choice.find(".select2-search-choice-close").on("mousedown",killEvent).on("click dblclick",this.bind(function(e){this.isInterfaceEnabled()&&(this.unselect($(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),killEvent(e),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),choice.data("select2-data",data),choice.insertBefore(this.searchContainer),id},unselect:function(selected){var data,index,val=this.getVal();if(selected=selected.closest(".select2-search-choice"),0===selected.length)throw"Invalid argument: "+selected+". Must be .select2-search-choice";if(data=selected.data("select2-data")){var evt=$.Event("select2-removing");if(evt.val=this.id(data),evt.choice=data,this.opts.element.trigger(evt),evt.isDefaultPrevented())return!1;for(;(index=indexOf(this.id(data),val))>=0;)val.splice(index,1),this.setVal(val),this.select&&this.postprocessResults();return selected.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(data),choice:data}),this.triggerChange({removed:data}),!0}},postprocessResults:function(data,initial,noHighlightUpdate){var val=this.getVal(),choices=this.results.find(".select2-result"),compound=this.results.find(".select2-result-with-children"),self=this;choices.each2(function(i,choice){var id=self.id(choice.data("select2-data"));indexOf(id,val)>=0&&(choice.addClass("select2-selected"),choice.find(".select2-result-selectable").addClass("select2-selected"))}),compound.each2(function(i,choice){choice.is(".select2-result-selectable")||0!==choice.find(".select2-result-selectable:not(.select2-selected)").length||choice.addClass("select2-selected")}),this.highlight()==-1&&noHighlightUpdate!==!1&&this.opts.closeOnSelect===!0&&self.highlight(0),!this.opts.createSearchChoice&&!choices.filter(".select2-result:not(.select2-selected)").length>0&&(!data||data&&!data.more&&0===this.results.find(".select2-no-results").length)&&checkFormatter(self.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+evaluate(self.opts.formatNoMatches,self.opts.element,self.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-getSideBorderPadding(this.search)},resizeSearch:function(){var minimumWidth,left,maxWidth,containerLeft,searchWidth,sideBorderPadding=getSideBorderPadding(this.search);minimumWidth=measureTextWidth(this.search)+10,left=this.search.offset().left,maxWidth=this.selection.width(),containerLeft=this.selection.offset().left,searchWidth=maxWidth-(left-containerLeft)-sideBorderPadding,searchWidth<minimumWidth&&(searchWidth=maxWidth-sideBorderPadding),searchWidth<40&&(searchWidth=maxWidth-sideBorderPadding),searchWidth<=0&&(searchWidth=minimumWidth),this.search.width(Math.floor(searchWidth))},getVal:function(){var val;return this.select?(val=this.select.val(),null===val?[]:val):(val=this.opts.element.val(),splitVal(val,this.opts.separator,this.opts.transformVal))},setVal:function(val){if(this.select)this.select.val(val);else{var unique=[],valMap={};$(val).each(function(){this in valMap||(unique.push(this),valMap[this]=0)}),this.opts.element.val(0===unique.length?"":unique.join(this.opts.separator))}},buildChangeDetails:function(old,current){for(var current=current.slice(0),old=old.slice(0),i=0;i<current.length;i++)for(var j=0;j<old.length;j++)if(equal(this.opts.id(current[i]),this.opts.id(old[j]))){current.splice(i,1),i--,old.splice(j,1);break}return{added:current,removed:old}},val:function(val,triggerChange){var oldData,self=this;if(0===arguments.length)return this.getVal();if(oldData=this.data(),oldData.length||(oldData=[]),!val&&0!==val)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(triggerChange&&this.triggerChange({added:this.data(),removed:oldData}));if(this.setVal(val),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),triggerChange&&this.triggerChange(this.buildChangeDetails(oldData,this.data()));else{if(this.opts.initSelection===undefined)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(data){var ids=$.map(data,self.id);self.setVal(ids),self.updateSelection(data),self.clearSearch(),triggerChange&&self.triggerChange(self.buildChangeDetails(oldData,self.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var val=[],self=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){val.push(self.opts.id($(this).data("select2-data")))}),this.setVal(val),this.triggerChange()},data:function(values,triggerChange){var ids,old,self=this;return 0===arguments.length?this.selection.children(".select2-search-choice").map(function(){return $(this).data("select2-data")}).get():(old=this.data(),values||(values=[]),ids=$.map(values,function(e){return self.opts.id(e)}),this.setVal(ids),this.updateSelection(values),this.clearSearch(),triggerChange&&this.triggerChange(this.buildChangeDetails(old,this.data())),void 0)}}),$.fn.select2=function(){var opts,select2,method,value,multiple,args=Array.prototype.slice.call(arguments,0),allowedMethods=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],valueMethods=["opened","isFocused","container","dropdown"],propertyMethods=["val","data"],methodsMap={search:"externalSearch"};return this.each(function(){if(0===args.length||"object"==typeof args[0])opts=0===args.length?{}:$.extend({},args[0]),opts.element=$(this),"select"===opts.element.get(0).tagName.toLowerCase()?multiple=opts.element.prop("multiple"):(multiple=opts.multiple||!1,"tags"in opts&&(opts.multiple=multiple=!0)),select2=multiple?new window.Select2["class"].multi:new window.Select2["class"].single,select2.init(opts);else{if("string"!=typeof args[0])throw"Invalid arguments to select2 plugin: "+args;if(indexOf(args[0],allowedMethods)<0)throw"Unknown method: "+args[0];if(value=undefined,select2=$(this).data("select2"),select2===undefined)return;if(method=args[0],"container"===method?value=select2.container:"dropdown"===method?value=select2.dropdown:(methodsMap[method]&&(method=methodsMap[method]),value=select2[method].apply(select2,args.slice(1))),indexOf(args[0],valueMethods)>=0||indexOf(args[0],propertyMethods)>=0&&1==args.length)return!1}}),value===undefined?this:value},$.fn.select2.defaults={debug:!1,width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(result,container,query,escapeMarkup){var markup=[];return markMatch(this.text(result),query.term,markup,escapeMarkup),markup.join("")},transformVal:function(val){return $.trim(val)},formatSelection:function(data,container,escapeMarkup){return data?escapeMarkup(this.text(data)):undefined},sortResults:function(results,container,query){return results},formatResultCssClass:function(data){return data.css},formatSelectionCssClass:function(data,container){return undefined},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==undefined?null:e.id},text:function(e){return e&&this.data&&this.data.text?$.isFunction(this.data.text)?this.data.text(e):e[this.data.text]:e.text},matcher:function(term,text){return stripDiacritics(""+text).toUpperCase().indexOf(stripDiacritics(""+term).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:defaultTokenizer,escapeMarkup:defaultEscapeMarkup,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(c){return c},adaptDropdownCssClass:function(c){return null},nextSearchTerm:function(selectedObject,currentSearchTerm){return undefined},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(instance){var supportsTouchEvents="ontouchstart"in window||navigator.msMaxTouchPoints>0;return!supportsTouchEvents||!(instance.opts.minimumResultsForSearch<0)}},$.fn.select2.locales=[],$.fn.select2.locales.en={formatMatches:function(matches){return 1===matches?"One result is available, press enter to select it.":matches+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(jqXHR,textStatus,errorThrown){return"Loading failed"},formatInputTooShort:function(input,min){var n=min-input.length;return"Please enter "+n+" or more character"+(1==n?"":"s")},formatInputTooLong:function(input,max){var n=input.length-max;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(limit){return"You can only select "+limit+" item"+(1==limit?"":"s")},formatLoadMore:function(pageNumber){return"Loading more results…"},formatSearching:function(){return"Searching…"}},$.extend($.fn.select2.defaults,$.fn.select2.locales.en),$.fn.select2.ajaxDefaults={transport:$.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:ajax,local:local,tags:tags},util:{debounce:debounce,markMatch:markMatch,escapeMarkup:defaultEscapeMarkup,stripDiacritics:stripDiacritics},"class":{"abstract":AbstractSelect2,single:SingleSelect2,multi:MultiSelect2}}}}(jQuery)}.apply(root,arguments)})}(this),function(root){define("jquery.event.drag",["jquery"],function(){return function(){!function($){$.fn.drag=function(str,arg,opts){var type="string"==typeof str?str:"",fn=$.isFunction(str)?str:$.isFunction(arg)?arg:null;return 0!==type.indexOf("drag")&&(type="drag"+type),opts=(str==fn?arg:opts)||{},fn?this.bind(type,opts,fn):this.trigger(type)};var $event=$.event,$special=$event.special,drag=$special.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(obj){var data=$.data(this,drag.datakey),opts=obj.data||{};data.related+=1,$.each(drag.defaults,function(key,def){void 0!==opts[key]&&(data[key]=opts[key])})},remove:function(){$.data(this,drag.datakey).related-=1},setup:function(){if(!$.data(this,drag.datakey)){var data=$.extend({related:0},drag.defaults);$.data(this,drag.datakey,data),$event.add(this,"touchstart mousedown",drag.init,data),this.attachEvent&&this.attachEvent("ondragstart",drag.dontstart)}},teardown:function(){var data=$.data(this,drag.datakey)||{};data.related||($.removeData(this,drag.datakey),$event.remove(this,"touchstart mousedown",drag.init),drag.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",drag.dontstart))},init:function(event){if(!drag.touched){var results,dd=event.data;if(!(0!=event.which&&dd.which>0&&event.which!=dd.which)&&!$(event.target).is(dd.not)&&(!dd.handle||$(event.target).closest(dd.handle,event.currentTarget).length)&&(drag.touched="touchstart"==event.type?this:null,dd.propagates=1,dd.mousedown=this,dd.interactions=[drag.interaction(this,dd)],dd.target=event.target,dd.pageX=event.pageX,dd.pageY=event.pageY,dd.dragging=null,results=drag.hijack(event,"draginit",dd),dd.propagates))return results=drag.flatten(results),results&&results.length&&(dd.interactions=[],$.each(results,function(){dd.interactions.push(drag.interaction(this,dd))})),dd.propagates=dd.interactions.length,dd.drop!==!1&&$special.drop&&$special.drop.handler(event,dd),drag.textselect(!1),drag.touched?$event.add(drag.touched,"touchmove touchend",drag.handler,dd):$event.add(document,"mousemove mouseup",drag.handler,dd),!(!drag.touched||dd.live)&&void 0}},interaction:function(elem,dd){var offset=$(elem)[dd.relative?"position":"offset"]()||{top:0,left:0};return{drag:elem,callback:new drag.callback,droppable:[],offset:offset}},handler:function(event){var dd=event.data;switch(event.type){case!dd.dragging&&"touchmove":event.preventDefault();case!dd.dragging&&"mousemove":if(Math.pow(event.pageX-dd.pageX,2)+Math.pow(event.pageY-dd.pageY,2)<Math.pow(dd.distance,2))break;event.target=dd.target,drag.hijack(event,"dragstart",dd),dd.propagates&&(dd.dragging=!0);case"touchmove":event.preventDefault();case"mousemove":if(dd.dragging){if(drag.hijack(event,"drag",dd),dd.propagates){dd.drop!==!1&&$special.drop&&$special.drop.handler(event,dd);break}event.type="mouseup"}case"touchend":case"mouseup":default:drag.touched?$event.remove(drag.touched,"touchmove touchend",drag.handler):$event.remove(document,"mousemove mouseup",drag.handler),dd.dragging&&(dd.drop!==!1&&$special.drop&&$special.drop.handler(event,dd),drag.hijack(event,"dragend",dd)),drag.textselect(!0),dd.click===!1&&dd.dragging&&$.data(dd.mousedown,"suppress.click",(new Date).getTime()+5),dd.dragging=drag.touched=!1}},hijack:function(event,type,dd,x,elem){if(dd){var result,ia,callback,orig={event:event.originalEvent,type:event.type},mode=type.indexOf("drop")?"drag":"drop",i=x||0,len=isNaN(x)?dd.interactions.length:x;event.type=type,event.originalEvent=null,dd.results=[];do if(ia=dd.interactions[i]){if("dragend"!==type&&ia.cancelled)continue;callback=drag.properties(event,dd,ia),ia.results=[],$(elem||ia[mode]||dd.droppable).each(function(p,subject){if(callback.target=subject,event.isPropagationStopped=function(){return!1},result=subject?$event.dispatch.call(subject,event,callback):null,result===!1?("drag"==mode&&(ia.cancelled=!0,dd.propagates-=1),"drop"==type&&(ia[mode][p]=null)):"dropinit"==type&&ia.droppable.push(drag.element(result)||subject),"dragstart"==type&&(ia.proxy=$(drag.element(result)||ia.drag)[0]),ia.results.push(result),delete event.result,"dropinit"!==type)return result}),dd.results[i]=drag.flatten(ia.results),"dropinit"==type&&(ia.droppable=drag.flatten(ia.droppable)),"dragstart"!=type||ia.cancelled||callback.update()}while(++i<len);return event.type=orig.type,event.originalEvent=orig.event,drag.flatten(dd.results)}},properties:function(event,dd,ia){var obj=ia.callback;return obj.drag=ia.drag,obj.proxy=ia.proxy||ia.drag,obj.startX=dd.pageX,obj.startY=dd.pageY,obj.deltaX=event.pageX-dd.pageX,obj.deltaY=event.pageY-dd.pageY,obj.originalX=ia.offset.left,obj.originalY=ia.offset.top,obj.offsetX=obj.originalX+obj.deltaX,obj.offsetY=obj.originalY+obj.deltaY,obj.drop=drag.flatten((ia.drop||[]).slice()),obj.available=drag.flatten((ia.droppable||[]).slice()),obj},element:function(arg){if(arg&&(arg.jquery||1==arg.nodeType))return arg},flatten:function(arr){return $.map(arr,function(member){return member&&member.jquery?$.makeArray(member):member&&member.length?drag.flatten(member):member})},textselect:function(bool){$(document)[bool?"unbind":"bind"]("selectstart",drag.dontstart).css("MozUserSelect",bool?"":"none"),document.unselectable=bool?"off":"on"},dontstart:function(){return!1},callback:function(){}};drag.callback.prototype={update:function(){$special.drop&&this.available.length&&$.each(this.available,function(i){$special.drop.locate(this,i)})}};var $dispatch=$event.dispatch;$event.dispatch=function(event){return $.data(this,"suppress."+event.type)-(new Date).getTime()>0?void $.removeData(this,"suppress."+event.type):$dispatch.apply(this,arguments)};var touchHooks=$event.fixHooks.touchstart=$event.fixHooks.touchmove=$event.fixHooks.touchend=$event.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(event,orig){if(orig){var touched=orig.touches&&orig.touches[0]||orig.changedTouches&&orig.changedTouches[0]||null;touched&&$.each(touchHooks.props,function(i,prop){event[prop]=touched[prop]})}return event}}}(jQuery)}.apply(root,arguments)})}(this),function(root){define("jquery.event.drop",["jquery"],function(){return function(){return function($){$.fn.drop=function(str,arg,opts){var type="string"==typeof str?str:"",fn=$.isFunction(str)?str:$.isFunction(arg)?arg:null;return 0!==type.indexOf("drop")&&(type="drop"+type),opts=(str==fn?arg:opts)||{},fn?this.bind(type,opts,fn):this.trigger(type)},$.drop=function(opts){opts=opts||{},drop.multi=opts.multi===!0?1/0:opts.multi===!1?1:isNaN(opts.multi)?drop.multi:opts.multi,drop.delay=opts.delay||drop.delay,drop.tolerance=$.isFunction(opts.tolerance)?opts.tolerance:null===opts.tolerance?null:drop.tolerance,drop.mode=opts.mode||drop.mode||"intersect"};var $event=$.event,$special=$event.special,drop=$.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(obj){var data=$.data(this,drop.datakey);data.related+=1},remove:function(){$.data(this,drop.datakey).related-=1},setup:function(){if(!$.data(this,drop.datakey)){var data={related:0,active:[],anyactive:0,winner:0,location:{}};$.data(this,drop.datakey,data),drop.targets.push(this)}},teardown:function(){var data=$.data(this,drop.datakey)||{};if(!data.related){$.removeData(this,drop.datakey);var element=this;drop.targets=$.grep(drop.targets,function(target){return target!==element})}},handler:function(event,dd){var $targets;if(dd)switch(event.type){case"mousedown":case"touchstart":$targets=$(drop.targets),"string"==typeof dd.drop&&($targets=$targets.filter(dd.drop)),$targets.each(function(){var data=$.data(this,drop.datakey);data.active=[],data.anyactive=0,data.winner=0}),dd.droppable=$targets,$special.drag.hijack(event,"dropinit",dd);break;case"mousemove":case"touchmove":drop.event=event,drop.timer||drop.tolerate(dd);break;case"mouseup":case"touchend":drop.timer=clearTimeout(drop.timer),dd.propagates&&($special.drag.hijack(event,"drop",dd),$special.drag.hijack(event,"dropend",dd))}},locate:function(elem,index){var data=$.data(elem,drop.datakey),$elem=$(elem),posi=$elem.offset()||{},height=$elem.outerHeight(),width=$elem.outerWidth(),location={elem:elem,width:width,height:height,top:posi.top,left:posi.left,right:posi.left+width,bottom:posi.top+height};return data&&(data.location=location,data.index=index,data.elem=elem),location},contains:function(target,test){return(test[0]||test.left)>=target.left&&(test[0]||test.right)<=target.right&&(test[1]||test.top)>=target.top&&(test[1]||test.bottom)<=target.bottom},modes:{intersect:function(event,proxy,target){return this.contains(target,[event.pageX,event.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(event,proxy,target){return Math.max(0,Math.min(target.bottom,proxy.bottom)-Math.max(target.top,proxy.top))*Math.max(0,Math.min(target.right,proxy.right)-Math.max(target.left,proxy.left))},fit:function(event,proxy,target){return this.contains(target,proxy)?1:0},middle:function(event,proxy,target){return this.contains(target,[proxy.left+.5*proxy.width,proxy.top+.5*proxy.height])?1:0}},sort:function(a,b){return b.winner-a.winner||a.index-b.index},tolerate:function(dd){var i,drp,drg,data,arr,len,elem,ia,x=0,end=dd.interactions.length,xy=[drop.event.pageX,drop.event.pageY],tolerance=drop.tolerance||drop.modes[drop.mode];do if(ia=dd.interactions[x]){if(!ia)return;ia.drop=[],arr=[],len=ia.droppable.length,tolerance&&(drg=drop.locate(ia.proxy)),i=0;do if(elem=ia.droppable[i]){if(data=$.data(elem,drop.datakey),drp=data.location,!drp)continue;data.winner=tolerance?tolerance.call(drop,drop.event,drg,drp):drop.contains(drp,xy)?1:0,arr.push(data)}while(++i<len);arr.sort(drop.sort),i=0;do(data=arr[i])&&(data.winner&&ia.drop.length<drop.multi?(data.active[x]||data.anyactive||($special.drag.hijack(drop.event,"dropstart",dd,x,data.elem)[0]!==!1?(data.active[x]=1,data.anyactive+=1):data.winner=0),data.winner&&ia.drop.push(data.elem)):data.active[x]&&1==data.anyactive&&($special.drag.hijack(drop.event,"dropend",dd,x,data.elem),data.active[x]=0,data.anyactive-=1));while(++i<len)}while(++x<end);drop.last&&xy[0]==drop.last.pageX&&xy[1]==drop.last.pageY?delete drop.timer:drop.timer=setTimeout(function(){drop.tolerate(dd)},drop.delay),drop.last=drop.event}};$special.dropinit=$special.dropstart=$special.dropend=drop}(jQuery),$.drop}.apply(root,arguments)})}(this),define("mockup-patterns-select2",["jquery","pat-base","mockup-utils","select2","jquery.event.drag","jquery.event.drop"],function($,Base,utils){"use strict";var Select2=Base.extend({name:"select2",trigger:".pat-select2",parser:"mockup",defaults:{separator:","},initializeValues:function(){var self=this;self.options.initialValues&&(self.options.id=function(term){return term.id},self.options.initSelection=function($el,callback){var data=[],value=$el.val(),seldefaults=self.options.initialValues;"string"==typeof self.options.initialValues&&""!==self.options.initialValues&&("{"===self.options.initialValues[0]?seldefaults=JSON.parse(self.options.initialValues):(seldefaults={},$(self.options.initialValues.split(self.options.separator)).each(function(){var selection=this.split(":"),id=$.trim(selection[0]),text=$.trim(selection[1]);seldefaults[id]=text}))),$(value.split(self.options.separator)).each(function(){var text=this;seldefaults[this]&&(text=seldefaults[this]),data.push({id:utils.removeHTML(this),text:utils.removeHTML(text)})}),callback(data)})},initializeTags:function(){var self=this;self.options.tags&&"string"==typeof self.options.tags&&("["===self.options.tags.substr(0,1)?self.options.tags=JSON.parse(self.options.tags):self.options.tags=self.options.tags.split(self.options.separator)),self.options.tags&&!self.options.allowNewItems&&(self.options.data=$.map(self.options.tags,function(value,i){return{id:value,text:value}}),self.options.multiple=!0,delete self.options.tags)},initializeOrdering:function(){var self=this;if(self.options.orderable){var formatSelection=function(data,$container){return data?data.text:void 0};self.options.formatSelection&&(formatSelection=self.options.formatSelection),self.options.formatSelection=function(data,$container){return $container.parents("li").drag("start",function(e,dd){return $(this).addClass("select2-choice-dragging"),self.$el.select2("onSortStart"),$.drop({tolerance:function(event,proxy,target){var test=event.pageY>target.top+target.height/2;return $.data(target.elem,"drop+reorder",test?"insertAfter":"insertBefore"),this.contains(target,[event.pageX,event.pageY])}}),$(this).clone().addClass("dragging").css({opacity:.75,position:"absolute"}).appendTo(document.body)}).drag(function(e,dd){$(dd.proxy).css({top:dd.offsetY,left:dd.offsetX});var drop=dd.drop[0],method=$.data(drop||{},"drop+reorder");!drop||drop==dd.current&&method==dd.method||($(this)[method](drop),dd.current=drop,dd.method=method,dd.update())}).drag("end",function(e,dd){$(this).removeClass("select2-choice-dragging"),self.$el.select2("onSortEnd"),$(dd.proxy).remove()}).drop("init",function(e,dd){return this!=dd.drag}),formatSelection(data,$container)}}},initializeSelect2:function(){var self=this;self.options.formatResultCssClass=function(ob){if(ob.id)return"select2-option-"+ob.id.toLowerCase().replace(/[ \:\)\(\[\]\{\}\_\+\=\&\*\%\#]/g,"-")},self.$el.select2(self.options),self.$select2=self.$el.parent().find(".select2-container"),self.$el.parent().off("close.plone-modal.patterns"),self.options.orderable&&self.$select2.addClass("select2-orderable")},init:function(){var self=this;if(self.options.allowNewItems=!self.options.hasOwnProperty("allowNewItems")||JSON.parse(self.options.allowNewItems),self.options.ajax||self.options.vocabularyUrl){self.options.vocabularyUrl&&(self.options.multiple=void 0===self.options.multiple||self.options.multiple,self.options.ajax=self.options.ajax||{},self.options.ajax.url=self.options.vocabularyUrl,self.options.initSelection=function($el,callback){var data=[],value=$el.val();$(value.split(self.options.separator)).each(function(){var val=utils.removeHTML(this);data.push({id:val,text:val})}),callback(data)});var queryTerm="";self.options.ajax=$.extend({quietMillis:300,data:function(term,page){return queryTerm=term,{query:term,page_limit:10,page:page}},results:function(data,page){var results=data.results;if(self.options.vocabularyUrl){var dataIds=[];$.each(data.results,function(i,item){dataIds.push(item.id)}),results=[];var haveResult=""===queryTerm||$.inArray(queryTerm,dataIds)>=0;self.options.allowNewItems&&!haveResult&&(queryTerm=utils.removeHTML(queryTerm),
results.push({id:queryTerm,text:queryTerm})),$.each(data.results,function(i,item){results.push(item)})}return{results:results}}},self.options.ajax)}else if(self.options.multiple&&self.$el.is("select")){var vals=self.$el.val()||[],options=$.map(self.$el.find("option"),function(o){return{text:$(o).html(),id:o.value}}),$hidden=$('<input type="hidden" />');$hidden.val(vals.join(self.options.separator)),$hidden.attr("class",self.$el.attr("class")),$hidden.attr("name",self.$el.attr("name")),$hidden.attr("id",self.$el.attr("id")),self.$orig=self.$el,self.$el.replaceWith($hidden),self.$el=$hidden,self.options.data=options}self.initializeValues(),self.initializeTags(),self.initializeOrdering(),self.initializeSelect2()}});return Select2}),define("mockup-patterns-passwordstrength",["jquery","pat-base"],function($,Base){"use strict";function loadScript(src){var s,i,scripts=document.getElementsByTagName("script");for(i=0;i<scripts.length;i++)if(scripts[i].src.indexOf(src)!==-1)return;s=document.createElement("script"),s.type="text/javascript",s.async=!0,s.src=src,scripts[0].parentNode.insertBefore(s,scripts[0])}function jsDiv(){return $(document.createElement("div"))}var PasswordStrength=Base.extend({name:"passwordstrength",trigger:".pat-passwordstrength",parser:"mockup",defaults:{zxcvbn:"//cdnjs.cloudflare.com/ajax/libs/zxcvbn/1.0/zxcvbn.js"},init:function(){function setLevel(){var score=0;"function"!=typeof window.zxcvbn?loadScript(self.options.zxcvbn):$pwfield[0].value.length>0&&(score=Math.max(1,window.zxcvbn($pwfield[0].value,[].map.call(($pwfield[0].form||{elements:[]}).elements,function(inp){return inp===$pwfield[0]?null:inp.value||null}).filter(function(x){return x})).score)),$pwmeter.attr("class","pat-passwordstrength-meter level-"+score)}var self=this,$pwfield=this.$el,$pwmeter=jsDiv().append([jsDiv(),jsDiv(),jsDiv(),jsDiv()]);$pwfield.after($pwmeter),$pwfield.on("keyup",function(e){var timeoutId=0;clearTimeout(timeoutId),timeoutId=setTimeout(setLevel,500)}),setLevel()}});return PasswordStrength}),define("mockup-i18n",["jquery"],function($){"use strict";var I18N=function(){var self=this;self.baseUrl=$("body").attr("data-i18ncatalogurl"),self.baseUrl||(self.baseUrl="/plonejsi18n"),self.currentLanguage=$("html").attr("lang")||"en-us",self.storage=null,self.catalogs={},self.ttl=864e5,Date.now||(Date.now=function(){return(new Date).valueOf()});try{"localStorage"in window&&null!==window.localStorage&&"JSON"in window&&null!==window.JSON&&(self.storage=window.localStorage)}catch(e){}self.configure=function(config){for(var key in config)self[key]=config[key]},self._setCatalog=function(domain,language,catalog){domain in self.catalogs?self.catalogs[domain][language]=catalog:(self.catalogs[domain]={},self.catalogs[domain][language]=catalog)},self._storeCatalog=function(domain,language,catalog){var key=domain+"-"+language;null!==self.storage&&null!==catalog&&(self.storage.setItem(key,JSON.stringify(catalog)),self.storage.setItem(key+"-updated",Date.now()))},self.getUrl=function(domain,language){return self.baseUrl+"?domain="+domain+"&language="+language},self.loadCatalog=function(domain,language){if(void 0===language&&(language=self.currentLanguage),null!==self.storage){var key=domain+"-"+language;if(key in self.storage&&Date.now()-parseInt(self.storage.getItem(key+"-updated"),10)<self.ttl){var catalog=JSON.parse(self.storage.getItem(key));return void self._setCatalog(domain,language,catalog)}}$.getJSON(self.getUrl(domain,language),function(catalog){null!==catalog&&(self._setCatalog(domain,language,catalog),self._storeCatalog(domain,language,catalog))})},self.MessageFactory=function(domain,language){return language=language||self.currentLanguage,function(msgid,keywords){var msgstr;if(msgstr=domain in self.catalogs&&language in self.catalogs[domain]&&msgid in self.catalogs[domain][language]?self.catalogs[domain][language][msgid]:msgid,keywords){var regexp,keyword;for(keyword in keywords)keywords.hasOwnProperty(keyword)&&(regexp=new RegExp("\\$\\{"+keyword+"\\}","g"),msgstr=msgstr.replace(regexp,keywords[keyword]))}return msgstr}}};return I18N}),define("translate",["mockup-i18n"],function(I18N){"use strict";var _t=null;return function(msgid,keywords){if(null===_t){var i18n=new I18N;i18n.loadCatalog("widgets"),_t=i18n.MessageFactory("widgets")}return _t(msgid,keywords)}}),function(factory){"function"==typeof define&&define.amd?define("picker",["jquery"],factory):"object"==typeof exports?module.exports=factory(require("jquery")):this.Picker=factory(jQuery)}(function($){function PickerConstructor(ELEMENT,NAME,COMPONENT,OPTIONS){function createWrappedComponent(){return PickerConstructor._.node("div",PickerConstructor._.node("div",PickerConstructor._.node("div",PickerConstructor._.node("div",P.component.nodes(STATE.open),CLASSES.box),CLASSES.wrap),CLASSES.frame),CLASSES.holder,'tabindex="-1"')}function prepareElement(){$ELEMENT.data(NAME,P).addClass(CLASSES.input).val($ELEMENT.data("value")?P.get("select",SETTINGS.format):ELEMENT.value),SETTINGS.editable||$ELEMENT.on("focus."+STATE.id+" click."+STATE.id,function(event){event.preventDefault(),P.open()}).on("keydown."+STATE.id,handleKeydownEvent),aria(ELEMENT,{haspopup:!0,expanded:!1,readonly:!1,owns:ELEMENT.id+"_root"})}function prepareElementRoot(){aria(P.$root[0],"hidden",!0)}function prepareElementHolder(){P.$holder.on({keydown:handleKeydownEvent,"focus.toOpen":handleFocusToOpenEvent,blur:function(){$ELEMENT.removeClass(CLASSES.target)},focusin:function(event){P.$root.removeClass(CLASSES.focused),event.stopPropagation()},"mousedown click":function(event){var target=event.target;target!=P.$holder[0]&&(event.stopPropagation(),"mousedown"!=event.type||$(target).is("input, select, textarea, button, option")||(event.preventDefault(),P.$holder[0].focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var $target=$(this),targetData=$target.data(),targetDisabled=$target.hasClass(CLASSES.navDisabled)||$target.hasClass(CLASSES.disabled),activeElement=getActiveElement();activeElement=activeElement&&(activeElement.type||activeElement.href),(targetDisabled||activeElement&&!$.contains(P.$root[0],activeElement))&&P.$holder[0].focus(),!targetDisabled&&targetData.nav?P.set("highlight",P.component.item.highlight,{nav:targetData.nav}):!targetDisabled&&"pick"in targetData?(P.set("select",targetData.pick),SETTINGS.closeOnSelect&&P.close(!0)):targetData.clear?(P.clear(),SETTINGS.closeOnClear&&P.close(!0)):targetData.close&&P.close(!0)})}function prepareElementHidden(){var name;SETTINGS.hiddenName===!0?(name=ELEMENT.name,ELEMENT.name=""):(name=["string"==typeof SETTINGS.hiddenPrefix?SETTINGS.hiddenPrefix:"","string"==typeof SETTINGS.hiddenSuffix?SETTINGS.hiddenSuffix:"_submit"],name=name[0]+ELEMENT.name+name[1]),P._hidden=$('<input type=hidden name="'+name+'"'+($ELEMENT.data("value")||ELEMENT.value?' value="'+P.get("select",SETTINGS.formatSubmit)+'"':"")+">")[0],$ELEMENT.on("change."+STATE.id,function(){P._hidden.value=ELEMENT.value?P.get("select",SETTINGS.formatSubmit):""})}function focusPickerOnceOpened(){IS_DEFAULT_THEME&&supportsTransitions?P.$holder.find("."+CLASSES.frame).one("transitionend",function(){P.$holder[0].focus()}):P.$holder[0].focus()}function handleFocusToOpenEvent(event){event.stopPropagation(),$ELEMENT.addClass(CLASSES.target),P.$root.addClass(CLASSES.focused),P.open()}function handleKeydownEvent(event){var keycode=event.keyCode,isKeycodeDelete=/^(8|46)$/.test(keycode);return 27==keycode?(P.close(!0),!1):void((32==keycode||isKeycodeDelete||!STATE.open&&P.component.key[keycode])&&(event.preventDefault(),event.stopPropagation(),isKeycodeDelete?P.clear().close():P.open()))}if(!ELEMENT)return PickerConstructor;var IS_DEFAULT_THEME=!1,STATE={id:ELEMENT.id||"P"+Math.abs(~~(Math.random()*new Date))},SETTINGS=COMPONENT?$.extend(!0,{},COMPONENT.defaults,OPTIONS):OPTIONS||{},CLASSES=$.extend({},PickerConstructor.klasses(),SETTINGS.klass),$ELEMENT=$(ELEMENT),PickerInstance=function(){return this.start()},P=PickerInstance.prototype={constructor:PickerInstance,$node:$ELEMENT,start:function(){return STATE&&STATE.start?P:(STATE.methods={},STATE.start=!0,STATE.open=!1,STATE.type=ELEMENT.type,ELEMENT.autofocus=ELEMENT==getActiveElement(),ELEMENT.readOnly=!SETTINGS.editable,ELEMENT.id=ELEMENT.id||STATE.id,"text"!=ELEMENT.type&&(ELEMENT.type="text"),P.component=new COMPONENT(P,SETTINGS),P.$root=$('<div class="'+CLASSES.picker+'" id="'+ELEMENT.id+'_root" />'),prepareElementRoot(),P.$holder=$(createWrappedComponent()).appendTo(P.$root),prepareElementHolder(),SETTINGS.formatSubmit&&prepareElementHidden(),prepareElement(),SETTINGS.containerHidden?$(SETTINGS.containerHidden).append(P._hidden):$ELEMENT.after(P._hidden),SETTINGS.container?$(SETTINGS.container).append(P.$root):$ELEMENT.after(P.$root),P.on({start:P.component.onStart,render:P.component.onRender,stop:P.component.onStop,open:P.component.onOpen,close:P.component.onClose,set:P.component.onSet}).on({start:SETTINGS.onStart,render:SETTINGS.onRender,stop:SETTINGS.onStop,open:SETTINGS.onOpen,close:SETTINGS.onClose,set:SETTINGS.onSet}),IS_DEFAULT_THEME=isUsingDefaultTheme(P.$holder[0]),ELEMENT.autofocus&&P.open(),P.trigger("start").trigger("render"))},render:function(entireComponent){return entireComponent?(P.$holder=$(createWrappedComponent()),prepareElementHolder(),P.$root.html(P.$holder)):P.$root.find("."+CLASSES.box).html(P.component.nodes(STATE.open)),P.trigger("render")},stop:function(){return STATE.start?(P.close(),P._hidden&&P._hidden.parentNode.removeChild(P._hidden),P.$root.remove(),$ELEMENT.removeClass(CLASSES.input).removeData(NAME),setTimeout(function(){$ELEMENT.off("."+STATE.id)},0),ELEMENT.type=STATE.type,ELEMENT.readOnly=!1,P.trigger("stop"),STATE.methods={},STATE.start=!1,P):P},open:function(dontGiveFocus){return STATE.open?P:($ELEMENT.addClass(CLASSES.active),aria(ELEMENT,"expanded",!0),setTimeout(function(){P.$root.addClass(CLASSES.opened),aria(P.$root[0],"hidden",!1)},0),dontGiveFocus!==!1&&(STATE.open=!0,IS_DEFAULT_THEME&&$html.css("overflow","hidden").css("padding-right","+="+getScrollbarWidth()),focusPickerOnceOpened(),$document.on("click."+STATE.id+" focusin."+STATE.id,function(event){var target=event.target;target!=ELEMENT&&target!=document&&3!=event.which&&P.close(target===P.$holder[0])}).on("keydown."+STATE.id,function(event){var keycode=event.keyCode,keycodeToMove=P.component.key[keycode],target=event.target;27==keycode?P.close(!0):target!=P.$holder[0]||!keycodeToMove&&13!=keycode?$.contains(P.$root[0],target)&&13==keycode&&(event.preventDefault(),target.click()):(event.preventDefault(),keycodeToMove?PickerConstructor._.trigger(P.component.key.go,P,[PickerConstructor._.trigger(keycodeToMove)]):P.$root.find("."+CLASSES.highlighted).hasClass(CLASSES.disabled)||(P.set("select",P.component.item.highlight),SETTINGS.closeOnSelect&&P.close(!0)))})),P.trigger("open"))},close:function(giveFocus){return giveFocus&&(SETTINGS.editable?ELEMENT.focus():(P.$holder.off("focus.toOpen").focus(),setTimeout(function(){P.$holder.on("focus.toOpen",handleFocusToOpenEvent)},0))),$ELEMENT.removeClass(CLASSES.active),aria(ELEMENT,"expanded",!1),setTimeout(function(){P.$root.removeClass(CLASSES.opened+" "+CLASSES.focused),aria(P.$root[0],"hidden",!0)},0),STATE.open?(STATE.open=!1,IS_DEFAULT_THEME&&$html.css("overflow","").css("padding-right","-="+getScrollbarWidth()),$document.off("."+STATE.id),P.trigger("close")):P},clear:function(options){return P.set("clear",null,options)},set:function(thing,value,options){var thingItem,thingValue,thingIsObject=$.isPlainObject(thing),thingObject=thingIsObject?thing:{};if(options=thingIsObject&&$.isPlainObject(value)?value:options||{},thing){thingIsObject||(thingObject[thing]=value);for(thingItem in thingObject)thingValue=thingObject[thingItem],thingItem in P.component.item&&(void 0===thingValue&&(thingValue=null),P.component.set(thingItem,thingValue,options)),"select"!=thingItem&&"clear"!=thingItem||$ELEMENT.val("clear"==thingItem?"":P.get(thingItem,SETTINGS.format)).trigger("change");P.render()}return options.muted?P:P.trigger("set",thingObject)},get:function(thing,format){if(thing=thing||"value",null!=STATE[thing])return STATE[thing];if("valueSubmit"==thing){if(P._hidden)return P._hidden.value;thing="value"}if("value"==thing)return ELEMENT.value;if(thing in P.component.item){if("string"==typeof format){var thingValue=P.component.get(thing);return thingValue?PickerConstructor._.trigger(P.component.formats.toString,P.component,[format,thingValue]):""}return P.component.get(thing)}},on:function(thing,method,internal){var thingName,thingMethod,thingIsObject=$.isPlainObject(thing),thingObject=thingIsObject?thing:{};if(thing){thingIsObject||(thingObject[thing]=method);for(thingName in thingObject)thingMethod=thingObject[thingName],internal&&(thingName="_"+thingName),STATE.methods[thingName]=STATE.methods[thingName]||[],STATE.methods[thingName].push(thingMethod)}return P},off:function(){var i,thingName,names=arguments;for(i=0,namesCount=names.length;i<namesCount;i+=1)thingName=names[i],thingName in STATE.methods&&delete STATE.methods[thingName];return P},trigger:function(name,data){var _trigger=function(name){var methodList=STATE.methods[name];methodList&&methodList.map(function(method){PickerConstructor._.trigger(method,P,[data])})};return _trigger("_"+name),_trigger(name),P}};return new PickerInstance}function isUsingDefaultTheme(element){var theme,prop="position";return element.currentStyle?theme=element.currentStyle[prop]:window.getComputedStyle&&(theme=getComputedStyle(element)[prop]),"fixed"==theme}function getScrollbarWidth(){if($html.height()<=$window.height())return 0;var $outer=$('<div style="visibility:hidden;width:100px" />').appendTo("body"),widthWithoutScroll=$outer[0].offsetWidth;$outer.css("overflow","scroll");var $inner=$('<div style="width:100%" />').appendTo($outer),widthWithScroll=$inner[0].offsetWidth;return $outer.remove(),widthWithoutScroll-widthWithScroll}function aria(element,attribute,value){if($.isPlainObject(attribute))for(var key in attribute)ariaSet(element,key,attribute[key]);else ariaSet(element,attribute,value)}function ariaSet(element,attribute,value){element.setAttribute(("role"==attribute?"":"aria-")+attribute,value)}function ariaAttr(attribute,data){$.isPlainObject(attribute)||(attribute={attribute:data}),data="";for(var key in attribute){var attr=("role"==key?"":"aria-")+key,attrVal=attribute[key];data+=null==attrVal?"":attr+'="'+attribute[key]+'"'}return data}function getActiveElement(){try{return document.activeElement}catch(err){}}var $window=$(window),$document=$(document),$html=$(document.documentElement),supportsTransitions=null!=document.documentElement.style.transition;return PickerConstructor.klasses=function(prefix){return prefix=prefix||"picker",{picker:prefix,opened:prefix+"--opened",focused:prefix+"--focused",input:prefix+"__input",active:prefix+"__input--active",target:prefix+"__input--target",holder:prefix+"__holder",frame:prefix+"__frame",wrap:prefix+"__wrap",box:prefix+"__box"}},PickerConstructor._={group:function(groupObject){for(var loopObjectScope,nodesList="",counter=PickerConstructor._.trigger(groupObject.min,groupObject);counter<=PickerConstructor._.trigger(groupObject.max,groupObject,[counter]);counter+=groupObject.i)loopObjectScope=PickerConstructor._.trigger(groupObject.item,groupObject,[counter]),nodesList+=PickerConstructor._.node(groupObject.node,loopObjectScope[0],loopObjectScope[1],loopObjectScope[2]);return nodesList},node:function(wrapper,item,klass,attribute){return item?(item=$.isArray(item)?item.join(""):item,klass=klass?' class="'+klass+'"':"",attribute=attribute?" "+attribute:"","<"+wrapper+klass+attribute+">"+item+"</"+wrapper+">"):""},lead:function(number){return(number<10?"0":"")+number},trigger:function(callback,scope,args){return"function"==typeof callback?callback.apply(scope,args||[]):callback},digits:function(string){return/\d/.test(string[1])?2:1},isDate:function(value){return{}.toString.call(value).indexOf("Date")>-1&&this.isInteger(value.getDate())},isInteger:function(value){return{}.toString.call(value).indexOf("Number")>-1&&value%1===0},ariaAttr:ariaAttr},PickerConstructor.extend=function(name,Component){$.fn[name]=function(options,action){var componentData=this.data(name);return"picker"==options?componentData:componentData&&"string"==typeof options?PickerConstructor._.trigger(componentData[options],componentData,[action]):this.each(function(){var $this=$(this);$this.data(name)||new PickerConstructor(this,name,Component,options)})},$.fn[name].defaults=Component.defaults},PickerConstructor}),function(factory){"function"==typeof define&&define.amd?define("picker.date",["picker","jquery"],factory):"object"==typeof exports?module.exports=factory(require("./picker.js"),require("jquery")):factory(Picker,jQuery)}(function(Picker,$){function DatePicker(picker,settings){var calendar=this,element=picker.$node[0],elementValue=element.value,elementDataValue=picker.$node.data("value"),valueString=elementDataValue||elementValue,formatString=elementDataValue?settings.formatSubmit:settings.format,isRTL=function(){return element.currentStyle?"rtl"==element.currentStyle.direction:"rtl"==getComputedStyle(picker.$root[0]).direction};calendar.settings=settings,calendar.$node=picker.$node,calendar.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},calendar.item={},calendar.item.clear=null,calendar.item.disable=(settings.disable||[]).slice(0),calendar.item.enable=-function(collectionDisabled){return collectionDisabled[0]===!0?collectionDisabled.shift():-1}(calendar.item.disable),calendar.set("min",settings.min).set("max",settings.max).set("now"),valueString?calendar.set("select",valueString,{format:formatString,defaultValue:!0}):calendar.set("select",null).set("highlight",calendar.item.now),calendar.key={40:7,38:-7,39:function(){return isRTL()?-1:1},37:function(){return isRTL()?1:-1},go:function(timeChange){var highlightedObject=calendar.item.highlight,targetDate=new Date(highlightedObject.year,highlightedObject.month,highlightedObject.date+timeChange);calendar.set("highlight",targetDate,{interval:timeChange}),this.render()}},picker.on("render",function(){picker.$root.find("."+settings.klass.selectMonth).on("change",function(){var value=this.value;value&&(picker.set("highlight",[picker.get("view").year,value,picker.get("highlight").date]),picker.$root.find("."+settings.klass.selectMonth).trigger("focus"))}),picker.$root.find("."+settings.klass.selectYear).on("change",function(){var value=this.value;value&&(picker.set("highlight",[value,picker.get("view").month,picker.get("highlight").date]),picker.$root.find("."+settings.klass.selectYear).trigger("focus"))})},1).on("open",function(){var includeToday="";calendar.disabled(calendar.get("now"))&&(includeToday=":not(."+settings.klass.buttonToday+")"),picker.$root.find("button"+includeToday+", select").attr("disabled",!1)},1).on("close",function(){picker.$root.find("button, select").attr("disabled",!0)},1)}var DAYS_IN_WEEK=7,WEEKS_IN_CALENDAR=6,_=Picker._;DatePicker.prototype.set=function(type,value,options){var calendar=this,calendarItem=calendar.item;return null===value?("clear"==type&&(type="select"),calendarItem[type]=value,calendar):(calendarItem["enable"==type?"disable":"flip"==type?"enable":type]=calendar.queue[type].split(" ").map(function(method){return value=calendar[method](type,value,options)}).pop(),"select"==type?calendar.set("highlight",calendarItem.select,options):"highlight"==type?calendar.set("view",calendarItem.highlight,options):type.match(/^(flip|min|max|disable|enable)$/)&&(calendarItem.select&&calendar.disabled(calendarItem.select)&&calendar.set("select",calendarItem.select,options),calendarItem.highlight&&calendar.disabled(calendarItem.highlight)&&calendar.set("highlight",calendarItem.highlight,options)),calendar)},DatePicker.prototype.get=function(type){return this.item[type]},DatePicker.prototype.create=function(type,value,options){var isInfiniteValue,calendar=this;return value=void 0===value?type:value,value==-(1/0)||value==1/0?isInfiniteValue=value:$.isPlainObject(value)&&_.isInteger(value.pick)?value=value.obj:$.isArray(value)?(value=new Date(value[0],value[1],value[2]),value=_.isDate(value)?value:calendar.create().obj):value=_.isInteger(value)||_.isDate(value)?calendar.normalize(new Date(value),options):calendar.now(type,value,options),{year:isInfiniteValue||value.getFullYear(),month:isInfiniteValue||value.getMonth(),date:isInfiniteValue||value.getDate(),day:isInfiniteValue||value.getDay(),obj:isInfiniteValue||value,pick:isInfiniteValue||value.getTime()}},DatePicker.prototype.createRange=function(from,to){var calendar=this,createDate=function(date){return date===!0||$.isArray(date)||_.isDate(date)?calendar.create(date):date};return _.isInteger(from)||(from=createDate(from)),_.isInteger(to)||(to=createDate(to)),_.isInteger(from)&&$.isPlainObject(to)?from=[to.year,to.month,to.date+from]:_.isInteger(to)&&$.isPlainObject(from)&&(to=[from.year,from.month,from.date+to]),{from:createDate(from),to:createDate(to)}},DatePicker.prototype.withinRange=function(range,dateUnit){return range=this.createRange(range.from,range.to),dateUnit.pick>=range.from.pick&&dateUnit.pick<=range.to.pick},DatePicker.prototype.overlapRanges=function(one,two){var calendar=this;return one=calendar.createRange(one.from,one.to),two=calendar.createRange(two.from,two.to),calendar.withinRange(one,two.from)||calendar.withinRange(one,two.to)||calendar.withinRange(two,one.from)||calendar.withinRange(two,one.to)},DatePicker.prototype.now=function(type,value,options){return value=new Date,options&&options.rel&&value.setDate(value.getDate()+options.rel),this.normalize(value,options)},DatePicker.prototype.navigate=function(type,value,options){var targetDateObject,targetYear,targetMonth,targetDate,isTargetArray=$.isArray(value),isTargetObject=$.isPlainObject(value),viewsetObject=this.item.view;if(isTargetArray||isTargetObject){for(isTargetObject?(targetYear=value.year,targetMonth=value.month,targetDate=value.date):(targetYear=+value[0],targetMonth=+value[1],targetDate=+value[2]),options&&options.nav&&viewsetObject&&viewsetObject.month!==targetMonth&&(targetYear=viewsetObject.year,targetMonth=viewsetObject.month),targetDateObject=new Date(targetYear,targetMonth+(options&&options.nav?options.nav:0),1),targetYear=targetDateObject.getFullYear(),targetMonth=targetDateObject.getMonth();new Date(targetYear,targetMonth,targetDate).getMonth()!==targetMonth;)targetDate-=1;value=[targetYear,targetMonth,targetDate]}return value},DatePicker.prototype.normalize=function(value){return value.setHours(0,0,0,0),value},DatePicker.prototype.measure=function(type,value){var calendar=this;return value?"string"==typeof value?value=calendar.parse(type,value):_.isInteger(value)&&(value=calendar.now(type,value,{rel:value})):value="min"==type?-(1/0):1/0,value},DatePicker.prototype.viewset=function(type,dateObject){return this.create([dateObject.year,dateObject.month,1])},DatePicker.prototype.validate=function(type,dateObject,options){var hasEnabledBeforeTarget,hasEnabledAfterTarget,reachedMin,reachedMax,calendar=this,originalDateObject=dateObject,interval=options&&options.interval?options.interval:1,isFlippedBase=calendar.item.enable===-1,minLimitObject=calendar.item.min,maxLimitObject=calendar.item.max,hasEnabledWeekdays=isFlippedBase&&calendar.item.disable.filter(function(value){if($.isArray(value)){var dateTime=calendar.create(value).pick;dateTime<dateObject.pick?hasEnabledBeforeTarget=!0:dateTime>dateObject.pick&&(hasEnabledAfterTarget=!0)}return _.isInteger(value)}).length;if((!options||!options.nav&&!options.defaultValue)&&(!isFlippedBase&&calendar.disabled(dateObject)||isFlippedBase&&calendar.disabled(dateObject)&&(hasEnabledWeekdays||hasEnabledBeforeTarget||hasEnabledAfterTarget)||!isFlippedBase&&(dateObject.pick<=minLimitObject.pick||dateObject.pick>=maxLimitObject.pick)))for(isFlippedBase&&!hasEnabledWeekdays&&(!hasEnabledAfterTarget&&interval>0||!hasEnabledBeforeTarget&&interval<0)&&(interval*=-1);calendar.disabled(dateObject)&&(Math.abs(interval)>1&&(dateObject.month<originalDateObject.month||dateObject.month>originalDateObject.month)&&(dateObject=originalDateObject,interval=interval>0?1:-1),dateObject.pick<=minLimitObject.pick?(reachedMin=!0,interval=1,dateObject=calendar.create([minLimitObject.year,minLimitObject.month,minLimitObject.date+(dateObject.pick===minLimitObject.pick?0:-1)])):dateObject.pick>=maxLimitObject.pick&&(reachedMax=!0,interval=-1,dateObject=calendar.create([maxLimitObject.year,maxLimitObject.month,maxLimitObject.date+(dateObject.pick===maxLimitObject.pick?0:1)])),!reachedMin||!reachedMax);)dateObject=calendar.create([dateObject.year,dateObject.month,dateObject.date+interval]);return dateObject},DatePicker.prototype.disabled=function(dateToVerify){var calendar=this,isDisabledMatch=calendar.item.disable.filter(function(dateToDisable){return _.isInteger(dateToDisable)?dateToVerify.day===(calendar.settings.firstDay?dateToDisable:dateToDisable-1)%7:$.isArray(dateToDisable)||_.isDate(dateToDisable)?dateToVerify.pick===calendar.create(dateToDisable).pick:$.isPlainObject(dateToDisable)?calendar.withinRange(dateToDisable,dateToVerify):void 0});return isDisabledMatch=isDisabledMatch.length&&!isDisabledMatch.filter(function(dateToDisable){return $.isArray(dateToDisable)&&"inverted"==dateToDisable[3]||$.isPlainObject(dateToDisable)&&dateToDisable.inverted}).length,calendar.item.enable===-1?!isDisabledMatch:isDisabledMatch||dateToVerify.pick<calendar.item.min.pick||dateToVerify.pick>calendar.item.max.pick},DatePicker.prototype.parse=function(type,value,options){var calendar=this,parsingObject={};return value&&"string"==typeof value?(options&&options.format||(options=options||{},options.format=calendar.settings.format),calendar.formats.toArray(options.format).map(function(label){var formattingLabel=calendar.formats[label],formatLength=formattingLabel?_.trigger(formattingLabel,calendar,[value,parsingObject]):label.replace(/^!/,"").length;formattingLabel&&(parsingObject[label]=value.substr(0,formatLength)),value=value.substr(formatLength)}),[parsingObject.yyyy||parsingObject.yy,+(parsingObject.mm||parsingObject.m)-1,parsingObject.dd||parsingObject.d]):value},DatePicker.prototype.formats=function(){function getWordLengthFromCollection(string,collection,dateObject){var word=string.match(/[^\x00-\x7F]+|\w+/)[0];return dateObject.mm||dateObject.m||(dateObject.m=collection.indexOf(word)+1),word.length}function getFirstWordLength(string){return string.match(/\w+/)[0].length}return{d:function(string,dateObject){return string?_.digits(string):dateObject.date},dd:function(string,dateObject){return string?2:_.lead(dateObject.date)},ddd:function(string,dateObject){return string?getFirstWordLength(string):this.settings.weekdaysShort[dateObject.day]},dddd:function(string,dateObject){return string?getFirstWordLength(string):this.settings.weekdaysFull[dateObject.day]},m:function(string,dateObject){return string?_.digits(string):dateObject.month+1},mm:function(string,dateObject){return string?2:_.lead(dateObject.month+1)},mmm:function(string,dateObject){var collection=this.settings.monthsShort;return string?getWordLengthFromCollection(string,collection,dateObject):collection[dateObject.month]},mmmm:function(string,dateObject){var collection=this.settings.monthsFull;return string?getWordLengthFromCollection(string,collection,dateObject):collection[dateObject.month]},yy:function(string,dateObject){return string?2:(""+dateObject.year).slice(2)},yyyy:function(string,dateObject){return string?4:dateObject.year},toArray:function(formatString){return formatString.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(formatString,itemObject){var calendar=this;return calendar.formats.toArray(formatString).map(function(label){return _.trigger(calendar.formats[label],calendar,[0,itemObject])||label.replace(/^!/,"")}).join("")}}}(),DatePicker.prototype.isDateExact=function(one,two){var calendar=this;return _.isInteger(one)&&_.isInteger(two)||"boolean"==typeof one&&"boolean"==typeof two?one===two:(_.isDate(one)||$.isArray(one))&&(_.isDate(two)||$.isArray(two))?calendar.create(one).pick===calendar.create(two).pick:!(!$.isPlainObject(one)||!$.isPlainObject(two))&&(calendar.isDateExact(one.from,two.from)&&calendar.isDateExact(one.to,two.to))},DatePicker.prototype.isDateOverlap=function(one,two){var calendar=this,firstDay=calendar.settings.firstDay?1:0;return _.isInteger(one)&&(_.isDate(two)||$.isArray(two))?(one=one%7+firstDay,one===calendar.create(two).day+1):_.isInteger(two)&&(_.isDate(one)||$.isArray(one))?(two=two%7+firstDay,two===calendar.create(one).day+1):!(!$.isPlainObject(one)||!$.isPlainObject(two))&&calendar.overlapRanges(one,two)},DatePicker.prototype.flipEnable=function(val){var itemObject=this.item;itemObject.enable=val||(itemObject.enable==-1?1:-1)},DatePicker.prototype.deactivate=function(type,datesToDisable){var calendar=this,disabledItems=calendar.item.disable.slice(0);return"flip"==datesToDisable?calendar.flipEnable():datesToDisable===!1?(calendar.flipEnable(1),disabledItems=[]):datesToDisable===!0?(calendar.flipEnable(-1),disabledItems=[]):datesToDisable.map(function(unitToDisable){for(var matchFound,index=0;index<disabledItems.length;index+=1)if(calendar.isDateExact(unitToDisable,disabledItems[index])){matchFound=!0;break}matchFound||(_.isInteger(unitToDisable)||_.isDate(unitToDisable)||$.isArray(unitToDisable)||$.isPlainObject(unitToDisable)&&unitToDisable.from&&unitToDisable.to)&&disabledItems.push(unitToDisable)}),disabledItems},DatePicker.prototype.activate=function(type,datesToEnable){var calendar=this,disabledItems=calendar.item.disable,disabledItemsCount=disabledItems.length;return"flip"==datesToEnable?calendar.flipEnable():datesToEnable===!0?(calendar.flipEnable(1),disabledItems=[]):datesToEnable===!1?(calendar.flipEnable(-1),disabledItems=[]):datesToEnable.map(function(unitToEnable){var matchFound,disabledUnit,index,isExactRange;for(index=0;index<disabledItemsCount;index+=1){if(disabledUnit=disabledItems[index],calendar.isDateExact(disabledUnit,unitToEnable)){matchFound=disabledItems[index]=null,isExactRange=!0;break}if(calendar.isDateOverlap(disabledUnit,unitToEnable)){$.isPlainObject(unitToEnable)?(unitToEnable.inverted=!0,matchFound=unitToEnable):$.isArray(unitToEnable)?(matchFound=unitToEnable,matchFound[3]||matchFound.push("inverted")):_.isDate(unitToEnable)&&(matchFound=[unitToEnable.getFullYear(),unitToEnable.getMonth(),unitToEnable.getDate(),"inverted"]);break}}if(matchFound)for(index=0;index<disabledItemsCount;index+=1)if(calendar.isDateExact(disabledItems[index],unitToEnable)){disabledItems[index]=null;break}if(isExactRange)for(index=0;index<disabledItemsCount;index+=1)if(calendar.isDateOverlap(disabledItems[index],unitToEnable)){disabledItems[index]=null;break}matchFound&&disabledItems.push(matchFound)}),disabledItems.filter(function(val){return null!=val})},DatePicker.prototype.nodes=function(isOpen){var calendar=this,settings=calendar.settings,calendarItem=calendar.item,nowObject=calendarItem.now,selectedObject=calendarItem.select,highlightedObject=calendarItem.highlight,viewsetObject=calendarItem.view,disabledCollection=calendarItem.disable,minLimitObject=calendarItem.min,maxLimitObject=calendarItem.max,tableHead=function(collection,fullCollection){return settings.firstDay&&(collection.push(collection.shift()),fullCollection.push(fullCollection.shift())),_.node("thead",_.node("tr",_.group({min:0,max:DAYS_IN_WEEK-1,i:1,node:"th",item:function(counter){return[collection[counter],settings.klass.weekdays,'scope=col title="'+fullCollection[counter]+'"']}})))}((settings.showWeekdaysFull?settings.weekdaysFull:settings.weekdaysShort).slice(0),settings.weekdaysFull.slice(0)),createMonthNav=function(next){return _.node("div"," ",settings.klass["nav"+(next?"Next":"Prev")]+(next&&viewsetObject.year>=maxLimitObject.year&&viewsetObject.month>=maxLimitObject.month||!next&&viewsetObject.year<=minLimitObject.year&&viewsetObject.month<=minLimitObject.month?" "+settings.klass.navDisabled:""),"data-nav="+(next||-1)+" "+_.ariaAttr({
role:"button",controls:calendar.$node[0].id+"_table"})+' title="'+(next?settings.labelMonthNext:settings.labelMonthPrev)+'"')},createMonthLabel=function(){var monthsCollection=settings.showMonthsShort?settings.monthsShort:settings.monthsFull;return settings.selectMonths?_.node("select",_.group({min:0,max:11,i:1,node:"option",item:function(loopedMonth){return[monthsCollection[loopedMonth],0,"value="+loopedMonth+(viewsetObject.month==loopedMonth?" selected":"")+(viewsetObject.year==minLimitObject.year&&loopedMonth<minLimitObject.month||viewsetObject.year==maxLimitObject.year&&loopedMonth>maxLimitObject.month?" disabled":"")]}}),settings.klass.selectMonth,(isOpen?"":"disabled")+" "+_.ariaAttr({controls:calendar.$node[0].id+"_table"})+' title="'+settings.labelMonthSelect+'"'):_.node("div",monthsCollection[viewsetObject.month],settings.klass.month)},createYearLabel=function(){var focusedYear=viewsetObject.year,numberYears=settings.selectYears===!0?5:~~(settings.selectYears/2);if(numberYears){var minYear=minLimitObject.year,maxYear=maxLimitObject.year,lowestYear=focusedYear-numberYears,highestYear=focusedYear+numberYears;if(minYear>lowestYear&&(highestYear+=minYear-lowestYear,lowestYear=minYear),maxYear<highestYear){var availableYears=lowestYear-minYear,neededYears=highestYear-maxYear;lowestYear-=availableYears>neededYears?neededYears:availableYears,highestYear=maxYear}return _.node("select",_.group({min:lowestYear,max:highestYear,i:1,node:"option",item:function(loopedYear){return[loopedYear,0,"value="+loopedYear+(focusedYear==loopedYear?" selected":"")]}}),settings.klass.selectYear,(isOpen?"":"disabled")+" "+_.ariaAttr({controls:calendar.$node[0].id+"_table"})+' title="'+settings.labelYearSelect+'"')}return _.node("div",focusedYear,settings.klass.year)};return _.node("div",(settings.selectYears?createYearLabel()+createMonthLabel():createMonthLabel()+createYearLabel())+createMonthNav()+createMonthNav(1),settings.klass.header)+_.node("table",tableHead+_.node("tbody",_.group({min:0,max:WEEKS_IN_CALENDAR-1,i:1,node:"tr",item:function(rowCounter){var shiftDateBy=settings.firstDay&&0===calendar.create([viewsetObject.year,viewsetObject.month,1]).day?-7:0;return[_.group({min:DAYS_IN_WEEK*rowCounter-viewsetObject.day+shiftDateBy+1,max:function(){return this.min+DAYS_IN_WEEK-1},i:1,node:"td",item:function(targetDate){targetDate=calendar.create([viewsetObject.year,viewsetObject.month,targetDate+(settings.firstDay?1:0)]);var isSelected=selectedObject&&selectedObject.pick==targetDate.pick,isHighlighted=highlightedObject&&highlightedObject.pick==targetDate.pick,isDisabled=disabledCollection&&calendar.disabled(targetDate)||targetDate.pick<minLimitObject.pick||targetDate.pick>maxLimitObject.pick,formattedDate=_.trigger(calendar.formats.toString,calendar,[settings.format,targetDate]);return[_.node("div",targetDate.date,function(klasses){return klasses.push(viewsetObject.month==targetDate.month?settings.klass.infocus:settings.klass.outfocus),nowObject.pick==targetDate.pick&&klasses.push(settings.klass.now),isSelected&&klasses.push(settings.klass.selected),isHighlighted&&klasses.push(settings.klass.highlighted),isDisabled&&klasses.push(settings.klass.disabled),klasses.join(" ")}([settings.klass.day]),"data-pick="+targetDate.pick+" "+_.ariaAttr({role:"gridcell",label:formattedDate,selected:!(!isSelected||calendar.$node.val()!==formattedDate)||null,activedescendant:!!isHighlighted||null,disabled:!!isDisabled||null})),"",_.ariaAttr({role:"presentation"})]}})]}})),settings.klass.table,'id="'+calendar.$node[0].id+'_table" '+_.ariaAttr({role:"grid",controls:calendar.$node[0].id,readonly:!0}))+_.node("div",_.node("button",settings.today,settings.klass.buttonToday,"type=button data-pick="+nowObject.pick+(isOpen&&!calendar.disabled(nowObject)?"":" disabled")+" "+_.ariaAttr({controls:calendar.$node[0].id}))+_.node("button",settings.clear,settings.klass.buttonClear,"type=button data-clear=1"+(isOpen?"":" disabled")+" "+_.ariaAttr({controls:calendar.$node[0].id}))+_.node("button",settings.close,settings.klass.buttonClose,"type=button data-close=true "+(isOpen?"":" disabled")+" "+_.ariaAttr({controls:calendar.$node[0].id})),settings.klass.footer)},DatePicker.defaults=function(prefix){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:!0,closeOnClear:!0,format:"d mmmm, yyyy",klass:{table:prefix+"table",header:prefix+"header",navPrev:prefix+"nav--prev",navNext:prefix+"nav--next",navDisabled:prefix+"nav--disabled",month:prefix+"month",year:prefix+"year",selectMonth:prefix+"select--month",selectYear:prefix+"select--year",weekdays:prefix+"weekday",day:prefix+"day",disabled:prefix+"day--disabled",selected:prefix+"day--selected",highlighted:prefix+"day--highlighted",now:prefix+"day--today",infocus:prefix+"day--infocus",outfocus:prefix+"day--outfocus",footer:prefix+"footer",buttonClear:prefix+"button--clear",buttonToday:prefix+"button--today",buttonClose:prefix+"button--close"}}}(Picker.klasses().picker+"__"),Picker.extend("pickadate",DatePicker)}),function(factory){"function"==typeof define&&define.amd?define("picker.time",["picker","jquery"],factory):"object"==typeof exports?module.exports=factory(require("./picker.js"),require("jquery")):factory(Picker,jQuery)}(function(Picker,$){function TimePicker(picker,settings){var clock=this,elementValue=picker.$node[0].value,elementDataValue=picker.$node.data("value"),valueString=elementDataValue||elementValue,formatString=elementDataValue?settings.formatSubmit:settings.format;clock.settings=settings,clock.$node=picker.$node,clock.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"},clock.item={},clock.item.clear=null,clock.item.interval=settings.interval||30,clock.item.disable=(settings.disable||[]).slice(0),clock.item.enable=-function(collectionDisabled){return collectionDisabled[0]===!0?collectionDisabled.shift():-1}(clock.item.disable),clock.set("min",settings.min).set("max",settings.max).set("now"),valueString?clock.set("select",valueString,{format:formatString}):clock.set("select",null).set("highlight",clock.item.now),clock.key={40:1,38:-1,39:1,37:-1,go:function(timeChange){clock.set("highlight",clock.item.highlight.pick+timeChange*clock.item.interval,{interval:timeChange*clock.item.interval}),this.render()}},picker.on("render",function(){var $pickerHolder=picker.$root.children(),$viewset=$pickerHolder.find("."+settings.klass.viewset),vendors=function(prop){return["webkit","moz","ms","o",""].map(function(vendor){return(vendor?"-"+vendor+"-":"")+prop})},animations=function($el,state){vendors("transform").map(function(prop){$el.css(prop,state)}),vendors("transition").map(function(prop){$el.css(prop,state)})};$viewset.length&&(animations($pickerHolder,"none"),$pickerHolder[0].scrollTop=~~$viewset.position().top-2*$viewset[0].clientHeight,animations($pickerHolder,""))},1).on("open",function(){picker.$root.find("button").attr("disabled",!1)},1).on("close",function(){picker.$root.find("button").attr("disabled",!0)},1)}var HOURS_IN_DAY=24,MINUTES_IN_HOUR=60,HOURS_TO_NOON=12,MINUTES_IN_DAY=HOURS_IN_DAY*MINUTES_IN_HOUR,_=Picker._;TimePicker.prototype.set=function(type,value,options){var clock=this,clockItem=clock.item;return null===value?("clear"==type&&(type="select"),clockItem[type]=value,clock):(clockItem["enable"==type?"disable":"flip"==type?"enable":type]=clock.queue[type].split(" ").map(function(method){return value=clock[method](type,value,options)}).pop(),"select"==type?clock.set("highlight",clockItem.select,options):"highlight"==type?clock.set("view",clockItem.highlight,options):"interval"==type?clock.set("min",clockItem.min,options).set("max",clockItem.max,options):type.match(/^(flip|min|max|disable|enable)$/)&&(clockItem.select&&clock.disabled(clockItem.select)&&clock.set("select",value,options),clockItem.highlight&&clock.disabled(clockItem.highlight)&&clock.set("highlight",value,options),"min"==type&&clock.set("max",clockItem.max,options)),clock)},TimePicker.prototype.get=function(type){return this.item[type]},TimePicker.prototype.create=function(type,value,options){var clock=this;return value=void 0===value?type:value,_.isDate(value)&&(value=[value.getHours(),value.getMinutes()]),$.isPlainObject(value)&&_.isInteger(value.pick)?value=value.pick:$.isArray(value)?value=+value[0]*MINUTES_IN_HOUR+ +value[1]:_.isInteger(value)||(value=clock.now(type,value,options)),"max"==type&&value<clock.item.min.pick&&(value+=MINUTES_IN_DAY),"min"!=type&&"max"!=type&&(value-clock.item.min.pick)%clock.item.interval!==0&&(value+=clock.item.interval),value=clock.normalize(type,value,options),{hour:~~(HOURS_IN_DAY+value/MINUTES_IN_HOUR)%HOURS_IN_DAY,mins:(MINUTES_IN_HOUR+value%MINUTES_IN_HOUR)%MINUTES_IN_HOUR,time:(MINUTES_IN_DAY+value)%MINUTES_IN_DAY,pick:value%MINUTES_IN_DAY}},TimePicker.prototype.createRange=function(from,to){var clock=this,createTime=function(time){return time===!0||$.isArray(time)||_.isDate(time)?clock.create(time):time};return _.isInteger(from)||(from=createTime(from)),_.isInteger(to)||(to=createTime(to)),_.isInteger(from)&&$.isPlainObject(to)?from=[to.hour,to.mins+from*clock.settings.interval]:_.isInteger(to)&&$.isPlainObject(from)&&(to=[from.hour,from.mins+to*clock.settings.interval]),{from:createTime(from),to:createTime(to)}},TimePicker.prototype.withinRange=function(range,timeUnit){return range=this.createRange(range.from,range.to),timeUnit.pick>=range.from.pick&&timeUnit.pick<=range.to.pick},TimePicker.prototype.overlapRanges=function(one,two){var clock=this;return one=clock.createRange(one.from,one.to),two=clock.createRange(two.from,two.to),clock.withinRange(one,two.from)||clock.withinRange(one,two.to)||clock.withinRange(two,one.from)||clock.withinRange(two,one.to)},TimePicker.prototype.now=function(type,value){var isBelowInterval,interval=this.item.interval,date=new Date,nowMinutes=date.getHours()*MINUTES_IN_HOUR+date.getMinutes(),isValueInteger=_.isInteger(value);return nowMinutes-=nowMinutes%interval,isBelowInterval=value<0&&interval*value+nowMinutes<=-interval,nowMinutes+="min"==type&&isBelowInterval?0:interval,isValueInteger&&(nowMinutes+=interval*(isBelowInterval&&"max"!=type?value+1:value)),nowMinutes},TimePicker.prototype.normalize=function(type,value){var interval=this.item.interval,minTime=this.item.min&&this.item.min.pick||0;return value-="min"==type?0:(value-minTime)%interval},TimePicker.prototype.measure=function(type,value,options){var clock=this;return value||(value="min"==type?[0,0]:[HOURS_IN_DAY-1,MINUTES_IN_HOUR-1]),"string"==typeof value?value=clock.parse(type,value):value===!0||_.isInteger(value)?value=clock.now(type,value,options):$.isPlainObject(value)&&_.isInteger(value.pick)&&(value=clock.normalize(type,value.pick,options)),value},TimePicker.prototype.validate=function(type,timeObject,options){var clock=this,interval=options&&options.interval?options.interval:clock.item.interval;return clock.disabled(timeObject)&&(timeObject=clock.shift(timeObject,interval)),timeObject=clock.scope(timeObject),clock.disabled(timeObject)&&(timeObject=clock.shift(timeObject,interval*-1)),timeObject},TimePicker.prototype.disabled=function(timeToVerify){var clock=this,isDisabledMatch=clock.item.disable.filter(function(timeToDisable){return _.isInteger(timeToDisable)?timeToVerify.hour==timeToDisable:$.isArray(timeToDisable)||_.isDate(timeToDisable)?timeToVerify.pick==clock.create(timeToDisable).pick:$.isPlainObject(timeToDisable)?clock.withinRange(timeToDisable,timeToVerify):void 0});return isDisabledMatch=isDisabledMatch.length&&!isDisabledMatch.filter(function(timeToDisable){return $.isArray(timeToDisable)&&"inverted"==timeToDisable[2]||$.isPlainObject(timeToDisable)&&timeToDisable.inverted}).length,clock.item.enable===-1?!isDisabledMatch:isDisabledMatch||timeToVerify.pick<clock.item.min.pick||timeToVerify.pick>clock.item.max.pick},TimePicker.prototype.shift=function(timeObject,interval){var clock=this,minLimit=clock.item.min.pick,maxLimit=clock.item.max.pick;for(interval=interval||clock.item.interval;clock.disabled(timeObject)&&(timeObject=clock.create(timeObject.pick+=interval),!(timeObject.pick<=minLimit||timeObject.pick>=maxLimit)););return timeObject},TimePicker.prototype.scope=function(timeObject){var minLimit=this.item.min.pick,maxLimit=this.item.max.pick;return this.create(timeObject.pick>maxLimit?maxLimit:timeObject.pick<minLimit?minLimit:timeObject)},TimePicker.prototype.parse=function(type,value,options){var hour,minutes,isPM,item,parseValue,clock=this,parsingObject={};if(!value||"string"!=typeof value)return value;options&&options.format||(options=options||{},options.format=clock.settings.format),clock.formats.toArray(options.format).map(function(label){var substring,formattingLabel=clock.formats[label],formatLength=formattingLabel?_.trigger(formattingLabel,clock,[value,parsingObject]):label.replace(/^!/,"").length;formattingLabel&&(substring=value.substr(0,formatLength),parsingObject[label]=substring.match(/^\d+$/)?+substring:substring),value=value.substr(formatLength)});for(item in parsingObject)parseValue=parsingObject[item],_.isInteger(parseValue)?item.match(/^(h|hh)$/i)?(hour=parseValue,"h"!=item&&"hh"!=item||(hour%=12)):"i"==item&&(minutes=parseValue):item.match(/^a$/i)&&parseValue.match(/^p/i)&&("h"in parsingObject||"hh"in parsingObject)&&(isPM=!0);return(isPM?hour+12:hour)*MINUTES_IN_HOUR+minutes},TimePicker.prototype.formats={h:function(string,timeObject){return string?_.digits(string):timeObject.hour%HOURS_TO_NOON||HOURS_TO_NOON},hh:function(string,timeObject){return string?2:_.lead(timeObject.hour%HOURS_TO_NOON||HOURS_TO_NOON)},H:function(string,timeObject){return string?_.digits(string):""+timeObject.hour%24},HH:function(string,timeObject){return string?_.digits(string):_.lead(timeObject.hour%24)},i:function(string,timeObject){return string?2:_.lead(timeObject.mins)},a:function(string,timeObject){return string?4:MINUTES_IN_DAY/2>timeObject.time%MINUTES_IN_DAY?"a.m.":"p.m."},A:function(string,timeObject){return string?2:MINUTES_IN_DAY/2>timeObject.time%MINUTES_IN_DAY?"AM":"PM"},toArray:function(formatString){return formatString.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(formatString,itemObject){var clock=this;return clock.formats.toArray(formatString).map(function(label){return _.trigger(clock.formats[label],clock,[0,itemObject])||label.replace(/^!/,"")}).join("")}},TimePicker.prototype.isTimeExact=function(one,two){var clock=this;return _.isInteger(one)&&_.isInteger(two)||"boolean"==typeof one&&"boolean"==typeof two?one===two:(_.isDate(one)||$.isArray(one))&&(_.isDate(two)||$.isArray(two))?clock.create(one).pick===clock.create(two).pick:!(!$.isPlainObject(one)||!$.isPlainObject(two))&&(clock.isTimeExact(one.from,two.from)&&clock.isTimeExact(one.to,two.to))},TimePicker.prototype.isTimeOverlap=function(one,two){var clock=this;return _.isInteger(one)&&(_.isDate(two)||$.isArray(two))?one===clock.create(two).hour:_.isInteger(two)&&(_.isDate(one)||$.isArray(one))?two===clock.create(one).hour:!(!$.isPlainObject(one)||!$.isPlainObject(two))&&clock.overlapRanges(one,two)},TimePicker.prototype.flipEnable=function(val){var itemObject=this.item;itemObject.enable=val||(itemObject.enable==-1?1:-1)},TimePicker.prototype.deactivate=function(type,timesToDisable){var clock=this,disabledItems=clock.item.disable.slice(0);return"flip"==timesToDisable?clock.flipEnable():timesToDisable===!1?(clock.flipEnable(1),disabledItems=[]):timesToDisable===!0?(clock.flipEnable(-1),disabledItems=[]):timesToDisable.map(function(unitToDisable){for(var matchFound,index=0;index<disabledItems.length;index+=1)if(clock.isTimeExact(unitToDisable,disabledItems[index])){matchFound=!0;break}matchFound||(_.isInteger(unitToDisable)||_.isDate(unitToDisable)||$.isArray(unitToDisable)||$.isPlainObject(unitToDisable)&&unitToDisable.from&&unitToDisable.to)&&disabledItems.push(unitToDisable)}),disabledItems},TimePicker.prototype.activate=function(type,timesToEnable){var clock=this,disabledItems=clock.item.disable,disabledItemsCount=disabledItems.length;return"flip"==timesToEnable?clock.flipEnable():timesToEnable===!0?(clock.flipEnable(1),disabledItems=[]):timesToEnable===!1?(clock.flipEnable(-1),disabledItems=[]):timesToEnable.map(function(unitToEnable){var matchFound,disabledUnit,index,isRangeMatched;for(index=0;index<disabledItemsCount;index+=1){if(disabledUnit=disabledItems[index],clock.isTimeExact(disabledUnit,unitToEnable)){matchFound=disabledItems[index]=null,isRangeMatched=!0;break}if(clock.isTimeOverlap(disabledUnit,unitToEnable)){$.isPlainObject(unitToEnable)?(unitToEnable.inverted=!0,matchFound=unitToEnable):$.isArray(unitToEnable)?(matchFound=unitToEnable,matchFound[2]||matchFound.push("inverted")):_.isDate(unitToEnable)&&(matchFound=[unitToEnable.getFullYear(),unitToEnable.getMonth(),unitToEnable.getDate(),"inverted"]);break}}if(matchFound)for(index=0;index<disabledItemsCount;index+=1)if(clock.isTimeExact(disabledItems[index],unitToEnable)){disabledItems[index]=null;break}if(isRangeMatched)for(index=0;index<disabledItemsCount;index+=1)if(clock.isTimeOverlap(disabledItems[index],unitToEnable)){disabledItems[index]=null;break}matchFound&&disabledItems.push(matchFound)}),disabledItems.filter(function(val){return null!=val})},TimePicker.prototype.i=function(type,value){return _.isInteger(value)&&value>0?value:this.item.interval},TimePicker.prototype.nodes=function(isOpen){var clock=this,settings=clock.settings,selectedObject=clock.item.select,highlightedObject=clock.item.highlight,viewsetObject=clock.item.view,disabledCollection=clock.item.disable;return _.node("ul",_.group({min:clock.item.min.pick,max:clock.item.max.pick,i:clock.item.interval,node:"li",item:function(loopedTime){loopedTime=clock.create(loopedTime);var timeMinutes=loopedTime.pick,isSelected=selectedObject&&selectedObject.pick==timeMinutes,isHighlighted=highlightedObject&&highlightedObject.pick==timeMinutes,isDisabled=disabledCollection&&clock.disabled(loopedTime),formattedTime=_.trigger(clock.formats.toString,clock,[settings.format,loopedTime]);return[_.trigger(clock.formats.toString,clock,[_.trigger(settings.formatLabel,clock,[loopedTime])||settings.format,loopedTime]),function(klasses){return isSelected&&klasses.push(settings.klass.selected),isHighlighted&&klasses.push(settings.klass.highlighted),viewsetObject&&viewsetObject.pick==timeMinutes&&klasses.push(settings.klass.viewset),isDisabled&&klasses.push(settings.klass.disabled),klasses.join(" ")}([settings.klass.listItem]),"data-pick="+loopedTime.pick+" "+_.ariaAttr({role:"option",label:formattedTime,selected:!(!isSelected||clock.$node.val()!==formattedTime)||null,activedescendant:!!isHighlighted||null,disabled:!!isDisabled||null})]}})+_.node("li",_.node("button",settings.clear,settings.klass.buttonClear,"type=button data-clear=1"+(isOpen?"":" disabled")+" "+_.ariaAttr({controls:clock.$node[0].id})),"",_.ariaAttr({role:"presentation"})),settings.klass.list,_.ariaAttr({role:"listbox",controls:clock.$node[0].id}))},TimePicker.defaults=function(prefix){return{clear:"Clear",format:"h:i A",interval:30,closeOnSelect:!0,closeOnClear:!0,klass:{picker:prefix+" "+prefix+"--time",holder:prefix+"__holder",list:prefix+"__list",listItem:prefix+"__list-item",disabled:prefix+"__list-item--disabled",selected:prefix+"__list-item--selected",highlighted:prefix+"__list-item--highlighted",viewset:prefix+"__list-item--viewset",now:prefix+"__list-item--now",buttonClear:prefix+"__button--clear"}}}(Picker.klasses().picker),Picker.extend("pickatime",TimePicker)}),define("mockup-patterns-pickadate",["jquery","pat-base","mockup-utils","translate","picker","picker.date","picker.time","mockup-patterns-select2"],function($,Base,utils,_t){"use strict";var PickADate=Base.extend({name:"pickadate",trigger:".pat-pickadate",parser:"mockup",defaults:{separator:" ",date:{selectYears:!0,selectMonths:!0,formatSubmit:"yyyy-mm-dd",format:"yyyy-mm-dd",labelMonthNext:_t("Next month"),labelMonthPrev:_t("Previous month"),labelMonthSelect:_t("Select a month"),labelYearSelect:_t("Select a year"),clear:!1,close:!1,today:!1},time:{clear:!1},today:_t("Today"),clear:_t("Clear"),timezone:null,autoSetTimeOnDateChange:"+[0,0]",classWrapperName:"pattern-pickadate-wrapper",classSeparatorName:"pattern-pickadate-separator",classDateName:"pattern-pickadate-date",classDateWrapperName:"pattern-pickadate-date-wrapper",classTimeName:"pattern-pickadate-time",classTimeWrapperName:"pattern-pickadate-time-wrapper",classTimezoneName:"pattern-pickadate-timezone",classTimezoneWrapperName:"pattern-pickadate-timezone-wrapper",classClearName:"pattern-pickadate-clear",classNowName:"pattern-pickadate-now",placeholderDate:_t("Enter date..."),placeholderTime:_t("Enter time..."),placeholderTimezone:_t("Enter timezone...")},parseTimeOffset:function(timeOffset){var op=void 0;0===timeOffset.indexOf("+")?(op="+",timeOffset=timeOffset.split("+")[1]):0===timeOffset.indexOf("-")&&(op="-",timeOffset=timeOffset.split("-")[1]);try{timeOffset=JSON.parse(timeOffset)}catch(e){timeOffset=void 0}if(timeOffset===!1)return!1;if(timeOffset===!0||Array.isArray(timeOffset)!==!0)return[0,0];var hours=parseInt(timeOffset[0],10)||0,mins=parseInt(timeOffset[1],10)||0;if("+"===op||"-"===op){var offset=new Date,curHours=offset.getHours(),curMins=offset.getMinutes();"+"===op?(hours=curHours+hours,hours>23&&(hours=23),mins=curMins+mins,mins>59&&(mins=59)):"-"===op&&(hours=curHours-hours,hours<0&&(hours=0),mins=curMins-mins,mins<0&&(mins=0))}return[hours,mins]},init:function(){var self=this,value=self.$el.val().split(" "),dateValue=value[0]||"",timeValue=value[1]||"";if(utils.bool(self.options.date)===!1&&(self.options.date=!1),utils.bool(self.options.time)===!1&&(self.options.time=!1),self.options.autoSetTimeOnDateChange=self.parseTimeOffset(self.options.autoSetTimeOnDateChange),self.options.date===!1&&(timeValue=value[0]),self.$el.hide(),self.$wrapper=$("<div/>").addClass(self.options.classWrapperName).insertAfter(self.$el),self.options.date!==!1&&(self.$date=$('<input type="text"/>').attr("placeholder",self.options.placeholderDate).attr("data-value",dateValue).addClass(self.options.classDateName).appendTo($("<div/>").addClass(self.options.classDateWrapperName).appendTo(self.$wrapper)).pickadate($.extend(!0,{},self.options.date,{onSet:function(e){void 0!==e.select&&(self.$date.attr("data-value",e.select),self.options.autoSetTimeOnDateChange!==!1&&self.$time&&(self.$time.pickatime("picker").get("select")||self.$time.pickatime("picker").set("select",self.options.autoSetTimeOnDateChange)),self.options.time!==!1&&""===self.$time.attr("data-value")||self.updateValue.call(self)),e.hasOwnProperty("clear")&&(self.$el.val(""),self.$date.attr("data-value",""))}}))),self.options.time!==!1&&(self.options.time.formatSubmit="HH:i",self.$time=$('<input type="text"/>').attr("placeholder",self.options.placeholderTime).attr("data-value",timeValue).addClass(self.options.classTimeName).appendTo($("<div/>").addClass(self.options.classTimeWrapperName).appendTo(self.$wrapper)).pickatime($.extend(!0,{},self.options.time,{onSet:function(e){void 0!==e.select&&(self.$time.attr("data-value",e.select),self.options.date!==!1&&""===self.$date.attr("data-value")||self.updateValue.call(self)),e.hasOwnProperty("clear")&&(self.$el.val(""),self.$time.attr("data-value",""))}})),"string"==typeof timeValue&&"00"===timeValue.substring(0,2)&&(self.$time.pickatime("picker").set("select",timeValue.split(":")),self.$time.attr("data-value",timeValue))),self.options.date!==!1&&self.options.time!==!1&&self.options.timezone&&(self.$separator=$("<span/>").addClass(self.options.classSeparatorName).html(" "===self.options.separator?"&nbsp;":self.options.separator).appendTo(self.$wrapper)),null!==self.options.timezone){self.$timezone=$('<input type="text"/>').addClass(self.options.classTimezoneName).appendTo($("<div/>").addClass(self.options.classTimezoneWrapperName).appendTo(self.$wrapper)).patternSelect2($.extend(!0,{placeholder:self.options.placeholderTimezone,width:"10em"},self.options.timezone,{multiple:!1})).on("change",function(e){void 0!==e.val&&(self.$timezone.attr("data-value",e.val),self.options.date!==!1&&""===self.$date.attr("data-value")||self.options.time!==!1&&""===self.$time.attr("data-value")||self.updateValue.call(self))});var defaultTimezone=self.options.timezone["default"];if(defaultTimezone){var isInList;self.options.timezone.data.some(function(obj){return isInList=obj.text===self.options.timezone["default"]}),isInList&&(self.$timezone.attr("data-value",defaultTimezone),self.$timezone.parent().find(".select2-chosen").text(defaultTimezone))}1===self.options.timezone.data.length&&(self.$timezone.attr("data-value",self.options.timezone.data[0].text),self.$timezone.parent().find(".select2-chosen").text(self.options.timezone.data[0].text),self.$timezone.select2("enable",!1))}utils.bool(self.options.today)&&(self.$now=$('<button class="btn btn-xs btn-info" title="'+self.options.today+'"><span class="glyphicon glyphicon-time"></span></button>').addClass(self.options.classNowName).on("click",function(e){e.preventDefault();var now=new Date;self.$date&&self.$date.data("pickadate").set("select",now),self.$time&&self.$time.data("pickatime").set("select",now)}).appendTo(self.$wrapper)),utils.bool(self.options.clear)&&(self.$clear=$('<button class="btn btn-xs btn-danger" title="'+self.options.clear+'"><span class="glyphicon glyphicon-trash"></span></button>').addClass(self.options.classClearName).on("click",function(e){e.preventDefault(),self.$date&&self.$date.data("pickadate").clear(),self.$time&&self.$time.data("pickatime").clear()}).appendTo(self.$wrapper))},updateValue:function(){var self=this,value="";if(self.options.date!==!1){var date=self.$date.data("pickadate").component,dateValue=self.$date.data("pickadate").get("select"),formatDate=date.formats.toString;dateValue&&(value+=formatDate.apply(date,[self.options.date.formatSubmit,dateValue]))}if(self.options.date!==!1&&self.options.time!==!1&&(value+=" "),self.options.time!==!1){var time=self.$time.data("pickatime").component,timeValue=self.$time.data("pickatime").get("select"),formatTime=time.formats.toString;timeValue&&(value+=formatTime.apply(time,["HH:i",timeValue]))}if(null!==self.options.timezone){var timezone=" "+self.$timezone.attr("data-value");timezone&&(value+=timezone)}self.$el.val(value),self.emit("updated")}});return PickADate}),function(root){define("jquery.tools.overlay",["jquery"],function(){return function(){!function($){function Overlay(trigger,conf){var closers,overlay,opened,self=this,fire=trigger.add(self),w=$(window),maskConf=$.tools.expose&&(conf.mask||conf.expose),uid=Math.random().toString().slice(10);maskConf&&("string"==typeof maskConf&&(maskConf={color:maskConf}),maskConf.closeOnClick=maskConf.closeOnEsc=!1);var jq=conf.target||trigger.attr("rel");if(overlay=jq?$(jq):trigger,!overlay.length)throw"Could not find Overlay: "+jq;trigger&&trigger.index(overlay)==-1&&trigger.click(function(e){return self.load(e),e.preventDefault()}),$.extend(self,{load:function(e){if(self.isOpened())return self;var eff=effects[conf.effect];if(!eff)throw'Overlay: cannot find effect : "'+conf.effect+'"';if(conf.oneInstance&&$.each(instances,function(){this.close(e)}),e=e||$.Event(),e.type="onBeforeLoad",fire.trigger(e),e.isDefaultPrevented())return self;opened=!0,maskConf&&$(overlay).expose(maskConf);var top=conf.top,left=conf.left,oWidth=overlay.outerWidth(!0),oHeight=overlay.outerHeight(!0);return"string"==typeof top&&(top="center"==top?Math.max((w.height()-oHeight)/2,0):parseInt(top,10)/100*w.height()),"center"==left&&(left=Math.max((w.width()-oWidth)/2,0)),eff[0].call(self,{top:top,left:left},function(){opened&&(e.type="onLoad",fire.trigger(e))}),maskConf&&conf.closeOnClick&&$.mask.getMask().one("click",self.close),conf.closeOnClick&&$(document).on("click."+uid,function(e){$(e.target).parents(overlay).length||self.close(e)}),conf.closeOnEsc&&$(document).on("keydown."+uid,function(e){27==e.keyCode&&self.close(e)}),self},close:function(e){return self.isOpened()?(e=e||$.Event(),e.type="onBeforeClose",fire.trigger(e),e.isDefaultPrevented()?void 0:(opened=!1,effects[conf.effect][1].call(self,function(){e.type="onClose",fire.trigger(e)}),$(document).off("click."+uid+" keydown."+uid),maskConf&&$.mask.close(),self)):self},getOverlay:function(){return overlay},getTrigger:function(){return trigger},getClosers:function(){return closers},isOpened:function(){return opened},getConf:function(){return conf}}),$.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),closers=overlay.find(conf.close||".close"),closers.length||conf.close||(closers=$('<a class="close"></a>'),overlay.prepend(closers)),closers.click(function(e){self.close(e)}),conf.load&&self.load()}$.tools=$.tools||{version:"@VERSION"},$.tools.overlay={addEffect:function(name,loadFn,closeFn){effects[name]=[loadFn,closeFn]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!/msie/.test(navigator.userAgent.toLowerCase())||navigator.appVersion>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var instances=[],effects={};$.tools.overlay.addEffect("default",function(pos,onLoad){var conf=this.getConf(),w=$(window);conf.fixed||(pos.top+=w.scrollTop(),pos.left+=w.scrollLeft()),pos.position=conf.fixed?"fixed":"absolute",this.getOverlay().css(pos).fadeIn(conf.speed,onLoad)},function(onClose){this.getOverlay().fadeOut(this.getConf().closeSpeed,onClose)}),$.fn.overlay=function(conf){var el=this.data("overlay");return el?el:($.isFunction(conf)&&(conf={onBeforeLoad:conf}),conf=$.extend(!0,{},$.tools.overlay.conf,conf),this.each(function(){el=new Overlay($(this),conf),instances.push(el),$(this).data("overlay",el)}),conf.api?el:this)}}(jQuery),function($){function find(root,query){var el=$(query);return el.length<2?el:root.parent().find(query)}function Scrollable(root,conf){var self=this,fire=root.add(self),itemWrap=root.children(),index=0,vertical=conf.vertical;if(current||(current=self),itemWrap.length>1&&(itemWrap=$(conf.items,root)),conf.size>1&&(conf.circular=!1),$.extend(self,{getConf:function(){return conf},getIndex:function(){return index},getSize:function(){return self.getItems().size()},getNaviButtons:function(){return prev.add(next)},getRoot:function(){return root},getItemWrap:function(){return itemWrap},getItems:function(){return itemWrap.find(conf.item).not("."+conf.clonedClass)},move:function(offset,time){return self.seekTo(index+offset,time)},next:function(time){return self.move(conf.size,time)},prev:function(time){return self.move(-conf.size,time)},begin:function(time){return self.seekTo(0,time)},end:function(time){return self.seekTo(self.getSize()-1,time)},focus:function(){return current=self,self},addItem:function(item){return item=$(item),conf.circular?(itemWrap.children().last().before(item),itemWrap.children().first().replaceWith(item.clone().addClass(conf.clonedClass))):(itemWrap.append(item),next.removeClass("disabled")),fire.trigger("onAddItem",[item]),self},seekTo:function(i,time,fn){if(i.jquery||(i*=1),conf.circular&&0===i&&index==-1&&0!==time)return self;if(!conf.circular&&i<0||i>self.getSize()||i<-1)return self;var item=i;i.jquery?i=self.getItems().index(i):item=self.getItems().eq(i);var e=$.Event("onBeforeSeek");if(!fn&&(fire.trigger(e,[i,time]),
e.isDefaultPrevented()||!item.length))return self;var props=vertical?{top:-item.position().top}:{left:-item.position().left};return index=i,current=self,void 0===time&&(time=conf.speed),itemWrap.animate(props,time,conf.easing,fn||function(){fire.trigger("onSeek",[i])}),self}}),$.each(["onBeforeSeek","onSeek","onAddItem"],function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.circular){var cloned1=self.getItems().slice(-1).clone().prependTo(itemWrap),cloned2=self.getItems().eq(1).clone().appendTo(itemWrap);cloned1.add(cloned2).addClass(conf.clonedClass),self.onBeforeSeek(function(e,i,time){if(!e.isDefaultPrevented())return i==-1?(self.seekTo(cloned1,time,function(){self.end(0)}),e.preventDefault()):void(i==self.getSize()&&self.seekTo(cloned2,time,function(){self.begin(0)}))});var hidden_parents=root.parents().add(root).filter(function(){if("none"===$(this).css("display"))return!0});hidden_parents.length?(hidden_parents.show(),self.seekTo(0,0,function(){}),hidden_parents.hide()):self.seekTo(0,0,function(){})}var prev=find(root,conf.prev).click(function(e){e.stopPropagation(),self.prev()}),next=find(root,conf.next).click(function(e){e.stopPropagation(),self.next()});if(conf.circular||(self.onBeforeSeek(function(e,i){setTimeout(function(){e.isDefaultPrevented()||(prev.toggleClass(conf.disabledClass,i<=0),next.toggleClass(conf.disabledClass,i>=self.getSize()-1))},1)}),conf.initialIndex||prev.addClass(conf.disabledClass)),self.getSize()<2&&prev.add(next).addClass(conf.disabledClass),conf.mousewheel&&$.fn.mousewheel&&root.mousewheel(function(e,delta){if(conf.mousewheel)return self.move(delta<0?1:-1,conf.wheelSpeed||50),!1}),conf.touch){var touch={};itemWrap[0].ontouchstart=function(e){var t=e.touches[0];touch.x=t.clientX,touch.y=t.clientY},itemWrap[0].ontouchmove=function(e){if(1==e.touches.length&&!itemWrap.is(":animated")){var t=e.touches[0],deltaX=touch.x-t.clientX,deltaY=touch.y-t.clientY;self[vertical&&deltaY>0||!vertical&&deltaX>0?"next":"prev"](),e.preventDefault()}}}conf.keyboard&&$(document).on("keydown.scrollable",function(evt){if(!(!conf.keyboard||evt.altKey||evt.ctrlKey||evt.metaKey||$(evt.target).is(":input")||"static"!=conf.keyboard&&current!=self)){var key=evt.keyCode;return!vertical||38!=key&&40!=key?vertical||37!=key&&39!=key?void 0:(self.move(37==key?-1:1),evt.preventDefault()):(self.move(38==key?-1:1),evt.preventDefault())}}),conf.initialIndex&&self.seekTo(conf.initialIndex,0,function(){})}$.tools=$.tools||{version:"@VERSION"},$.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}};var current;$.fn.scrollable=function(conf){var el=this.data("scrollable");return el?el:(conf=$.extend({},$.tools.scrollable.conf,conf),this.each(function(){el=new Scrollable($(this),conf),$(this).data("scrollable",el)}),conf.api?el:this)}}(jQuery),function($){function Tabs(root,paneSelector,conf){var current,self=this,trigger=root.add(this),tabs=root.find(conf.tabs),panes=paneSelector.jquery?paneSelector:root.children(paneSelector);tabs.length||(tabs=root.children()),panes.length||(panes=root.parent().find(paneSelector)),panes.length||(panes=$(paneSelector)),$.extend(this,{click:function(i,e){var tab=tabs.eq(i),firstRender=!root.data("tabs");if("string"==typeof i&&i.replace("#","")&&(tab=tabs.filter('[href*="'+i.replace("#","")+'"]'),i=Math.max(tabs.index(tab),0)),conf.rotate){var last=tabs.length-1;if(i<0)return self.click(last,e);if(i>last)return self.click(0,e)}if(!tab.length){if(current>=0)return self;i=conf.initialIndex,tab=tabs.eq(i)}if(i===current)return self;if(e=e||$.Event(),e.type="onBeforeClick",trigger.trigger(e,[i]),!e.isDefaultPrevented()){var effect=firstRender?conf.initialEffect&&conf.effect||"default":conf.effect;return effects[effect].call(self,i,function(){current=i,e.type="onClick",trigger.trigger(e,[i])}),tabs.removeClass(conf.current),tab.addClass(conf.current),self}},getConf:function(){return conf},getTabs:function(){return tabs},getPanes:function(){return panes},getCurrentPane:function(){return panes.eq(current)},getCurrentTab:function(){return tabs.eq(current)},getIndex:function(){return current},next:function(){return self.click(current+1)},prev:function(){return self.click(current-1)},destroy:function(){return tabs.off(conf.event).removeClass(conf.current),panes.find('a[href^="#"]').off("click.T"),self}}),$.each("onBeforeClick,onClick".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.history&&$.fn.history&&($.tools.history.init(tabs),conf.event="history"),tabs.each(function(i){$(this).on(conf.event,function(e){return self.click(i,e),e.preventDefault()})}),panes.find('a[href^="#"]').on("click.T",function(e){self.click($(this).attr("href"),e)}),location.hash&&"a"==conf.tabs&&root.find('[href="'+location.hash+'"]').length?self.click(location.hash):(0===conf.initialIndex||conf.initialIndex>0)&&self.click(conf.initialIndex)}$.tools=$.tools||{version:"@VERSION"},$.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialEffect:!1,initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(name,fn){effects[name]=fn}};var animating,w,effects={"default":function(i,done){this.getPanes().hide().eq(i).show(),done.call()},fade:function(i,done){var conf=this.getConf(),speed=conf.fadeOutSpeed,panes=this.getPanes();speed?panes.fadeOut(speed):panes.hide(),panes.eq(i).fadeIn(conf.fadeInSpeed,done)},slide:function(i,done){var conf=this.getConf();this.getPanes().slideUp(conf.slideUpSpeed),this.getPanes().eq(i).slideDown(conf.slideDownSpeed,done)},ajax:function(i,done){this.getPanes().eq(0).load(this.getTabs().eq(i).attr("href"),done)}};$.tools.tabs.addEffect("horizontal",function(i,done){if(!animating){var nextPane=this.getPanes().eq(i),currentPane=this.getCurrentPane();w||(w=this.getPanes().eq(0).width()),animating=!0,nextPane.show(),currentPane.animate({width:0},{step:function(now){nextPane.css("width",w-now)},complete:function(){$(this).hide(),done.call(),animating=!1}}),currentPane.length||(done.call(),animating=!1)}}),$.fn.tabs=function(paneSelector,conf){var el=this.data("tabs");return el&&(el.destroy(),this.removeData("tabs")),$.isFunction(conf)&&(conf={onBeforeClick:conf}),conf=$.extend({},$.tools.tabs.conf,conf),this.each(function(){el=new Tabs($(this),paneSelector,conf),$(this).data("tabs",el)}),conf.api?el:this}}(jQuery),function($){function setIframeLocation(h){if(h){var doc=iframe.contentWindow.document;doc.open().close(),doc.location.hash=h}}var hash,iframe,links,inited;$.tools=$.tools||{version:"@VERSION"},$.tools.history={init:function(els){inited||($.browser.msie&&$.browser.version<"8"?iframe||(iframe=$("<iframe/>").attr("src","javascript:false;").hide().get(0),$("body").append(iframe),setInterval(function(){var idoc=iframe.contentWindow.document,h=idoc.location.hash;hash!==h&&$(window).trigger("hash",h)},100),setIframeLocation(location.hash||"#")):setInterval(function(){var h=location.hash;h!==hash&&$(window).trigger("hash",h)},100),links=links?links.add(els):els,els.click(function(e){var href=$(this).attr("href");if(iframe&&setIframeLocation(href),"#"!=href.slice(0,1))return location.href="#"+href,e.preventDefault()}),inited=!0)}},$(window).on("hash",function(e,h){h?links.filter(function(){var href=$(this).attr("href");return href==h||href==h.replace("#","")}).trigger("history",[h]):links.eq(0).trigger("history",[h]),hash=h}),$.fn.history=function(fn){return $.tools.history.init(this),this.on("history",fn)}}(jQuery),function($){function viewport(){if(/msie/.test(navigator.userAgent.toLowerCase())){var d=$(document).height(),w=$(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d-w<20?w:d]}return[$(document).width(),$(document).height()]}function call(fn){if(fn)return fn.call($.mask)}$.tools=$.tools||{version:"@VERSION"};var tool;tool=$.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};var mask,exposed,loaded,config,overlayIndex;$.mask={load:function(conf,els){if(loaded)return this;"string"==typeof conf&&(conf={color:conf}),conf=conf||config,config=conf=$.extend($.extend({},tool.conf),conf),mask=$("#"+conf.maskId),mask.length||(mask=$("<div/>").attr("id",conf.maskId),$("body").append(mask));var size=viewport();return mask.css({position:"absolute",top:0,left:0,width:size[0],height:size[1],display:"none",opacity:conf.startOpacity,zIndex:conf.zIndex}),conf.color&&mask.css("backgroundColor",conf.color),call(conf.onBeforeLoad)===!1?this:(conf.closeOnEsc&&$(document).on("keydown.mask",function(e){27==e.keyCode&&$.mask.close(e)}),conf.closeOnClick&&mask.on("click.mask",function(e){$.mask.close(e)}),$(window).on("resize.mask",function(){$.mask.fit()}),els&&els.length&&(overlayIndex=els.eq(0).css("zIndex"),$.each(els,function(){var el=$(this);/relative|absolute|fixed/i.test(el.css("position"))||el.css("position","relative")}),exposed=els.css({zIndex:Math.max(conf.zIndex+1,"auto"==overlayIndex?0:overlayIndex)})),mask.css({display:"block"}).fadeTo(conf.loadSpeed,conf.opacity,function(){$.mask.fit(),call(conf.onLoad),loaded="full"}),loaded=!0,this)},close:function(){if(loaded){if(call(config.onBeforeClose)===!1)return this;mask.fadeOut(config.closeSpeed,function(){exposed&&exposed.css({zIndex:overlayIndex}),loaded=!1,call(config.onClose)}),$(document).off("keydown.mask"),mask.off("click.mask"),$(window).off("resize.mask")}return this},fit:function(){if(loaded){var size=viewport();mask.css({width:size[0],height:size[1]})}},getMask:function(){return mask},isLoaded:function(fully){return fully?"full"==loaded:loaded},getConf:function(){return config},getExposed:function(){return exposed}},$.fn.mask=function(conf){return $.mask.load(conf),this},$.fn.expose=function(conf){return $.mask.load(conf,this),this}}(jQuery),function($){function getPosition(trigger,tip,conf){var top=conf.relative?trigger.position().top:trigger.offset().top,left=conf.relative?trigger.position().left:trigger.offset().left,pos=conf.position[0];top-=tip.outerHeight()-conf.offset[0],left+=trigger.outerWidth()+conf.offset[1],/iPad/i.test(navigator.userAgent)&&(top-=$(window).scrollTop());var height=tip.outerHeight()+trigger.outerHeight();"center"==pos&&(top+=height/2),"bottom"==pos&&(top+=height),pos=conf.position[1];var width=tip.outerWidth()+trigger.outerWidth();return"center"==pos&&(left-=width/2),"left"==pos&&(left-=width),{top:top,left:left}}function Tooltip(trigger,conf){var tip,shown,self=this,fire=trigger.add(self),timer=0,pretimer=0,title=trigger.attr("title"),tipAttr=trigger.attr("data-tooltip"),effect=effects[conf.effect],isInput=trigger.is(":input"),isWidget=isInput&&trigger.is(":checkbox, :radio, select, :button, :submit"),type=trigger.attr("type"),evt=conf.events[type]||conf.events[isInput?isWidget?"widget":"input":"def"];if(!effect)throw'Nonexistent effect "'+conf.effect+'"';if(evt=evt.split(/,\s*/),2!=evt.length)throw"Tooltip: bad events configuration for "+type;trigger.on(evt[0],function(e){clearTimeout(timer),conf.predelay?pretimer=setTimeout(function(){self.show(e)},conf.predelay):self.show(e)}).on(evt[1],function(e){clearTimeout(pretimer),conf.delay?timer=setTimeout(function(){self.hide(e)},conf.delay):self.hide(e)}),title&&conf.cancelDefault&&(trigger.removeAttr("title"),trigger.data("title",title)),$.extend(self,{show:function(e){if(!tip&&(tipAttr?tip=$(tipAttr):conf.tip?tip=$(conf.tip).eq(0):title?tip=$(conf.layout).addClass(conf.tipClass).appendTo(document.body).hide().append(title):(tip=trigger.find("."+conf.tipClass),tip.length||(tip=trigger.next()),tip.length||(tip=trigger.parent().next())),!tip.length))throw"Cannot find tooltip for "+trigger;if(self.isShown())return self;tip.stop(!0,!0);var pos=getPosition(trigger,tip,conf);if(conf.tip&&tip.html(trigger.data("title")),e=$.Event(),e.type="onBeforeShow",fire.trigger(e,[pos]),e.isDefaultPrevented())return self;pos=getPosition(trigger,tip,conf),tip.css({position:"absolute",top:pos.top,left:pos.left}),shown=!0,effect[0].call(self,function(){e.type="onShow",shown="full",fire.trigger(e)});var event=conf.events.tooltip.split(/,\s*/);return tip.data("__set")||(tip.off(event[0]).on(event[0],function(){clearTimeout(timer),clearTimeout(pretimer)}),event[1]&&!trigger.is("input:not(:checkbox, :radio), textarea")&&tip.off(event[1]).on(event[1],function(e){e.relatedTarget!=trigger[0]&&trigger.trigger(evt[1].split(" ")[0])}),conf.tip||tip.data("__set",!0)),self},hide:function(e){return tip&&self.isShown()?(e=$.Event(),e.type="onBeforeHide",fire.trigger(e),e.isDefaultPrevented()?void 0:(shown=!1,effects[conf.effect][1].call(self,function(){e.type="onHide",fire.trigger(e)}),self)):self},isShown:function(fully){return fully?"full"==shown:shown},getConf:function(){return conf},getTip:function(){return tip},getTrigger:function(){return trigger}}),$.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}})}$.tools=$.tools||{version:"@VERSION"},$.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(name,loadFn,hideFn){effects[name]=[loadFn,hideFn]}};var effects={toggle:[function(done){var conf=this.getConf(),tip=this.getTip(),o=conf.opacity;o<1&&tip.css({opacity:o}),tip.show(),done.call()},function(done){this.getTip().hide(),done.call()}],fade:[function(done){var conf=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||conf.fadeIE?this.getTip().fadeTo(conf.fadeInSpeed,conf.opacity,done):(this.getTip().show(),done())},function(done){var conf=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||conf.fadeIE?this.getTip().fadeOut(conf.fadeOutSpeed,done):(this.getTip().hide(),done())}]};$.fn.tooltip=function(conf){var api=this.data("tooltip");return api?api:(conf=$.extend(!0,{},$.tools.tooltip.conf,conf),"string"==typeof conf.position&&(conf.position=conf.position.split(/,?\s/)),this.each(function(){api=new Tooltip($(this),conf),$(this).data("tooltip",api)}),conf.api?api:this)}}(jQuery)}.apply(root,arguments)})}(this),function(root){define("jquery.tools.dateinput",["jquery"],function(){return function(){!function($,undefined){function dayAm(year,month){return new Date(year,month+1,0).getDate()}function zeropad(val,len){for(val=""+val,len=len||2;val.length<len;)val="0"+val;return val}function format(formatter,date,text,lang){var d=date.getDate(),D=date.getDay(),m=date.getMonth(),y=date.getFullYear(),flags={d:d,dd:zeropad(d),ddd:LABELS[lang].shortDays[D],dddd:LABELS[lang].days[D],m:m+1,mm:zeropad(m+1),mmm:LABELS[lang].shortMonths[m],mmmm:LABELS[lang].months[m],yy:String(y).slice(2),yyyy:y},ret=formatters[formatter](text,date,flags,lang);return tmpTag.html(ret).html()}function integer(val){return parseInt(val,10)}function isSameDay(d1,d2){return d1.getFullYear()===d2.getFullYear()&&d1.getMonth()==d2.getMonth()&&d1.getDate()==d2.getDate()}function parseDate(val){if(val!==undefined){if(val.constructor==Date)return val;if("string"==typeof val){var els=val.split("-");if(3==els.length)return new Date(integer(els[0]),integer(els[1])-1,integer(els[2]));if(!/^-?\d+$/.test(val))return;val=integer(val)}var date=new Date;return date.setDate(date.getDate()+val),date}}function Dateinput(input,conf){function select(date,conf,e){return input.attr("readonly")?void self.hide(e):(value=date,currYear=date.getFullYear(),currMonth=date.getMonth(),currDay=date.getDate(),e||(e=$.Event("api")),"click"!=e.type||/msie/.test(navigator.userAgent.toLowerCase())||input.focus(),e.type="beforeChange",fire.trigger(e,[date]),void(e.isDefaultPrevented()||(input.val(format(conf.formatter,date,conf.format,conf.lang)),e.type="change",e.target=input[0],fire.trigger(e),input.data("date",date),self.hide(e))))}function onShow(ev){ev.type="onShow",fire.trigger(ev),$(document).on("keydown.d",function(e){if(e.ctrlKey)return!0;var key=e.keyCode;if(8==key||46==key)return input.val(""),self.hide(e);if(27==key||9==key)return self.hide(e);if($(KEYS).index(key)>=0){if(!opened)return self.show(e),e.preventDefault();var days=$("#"+css.weeks+" a"),el=$("."+css.focus),index=days.index(el);return el.removeClass(css.focus),74==key||40==key?index+=7:75==key||38==key?index-=7:76==key||39==key?index+=1:(72==key||37==key)&&(index-=1),index>41?(self.addMonth(),el=$("#"+css.weeks+" a:eq("+(index-42)+")")):0>index?(self.addMonth(-1),el=$("#"+css.weeks+" a:eq("+(index+42)+")")):el=days.eq(index),el.addClass(css.focus),e.preventDefault()}return 34==key?self.addMonth():33==key?self.addMonth(-1):36==key?self.today():(13==key&&($(e.target).is("select")||$("."+css.focus).click()),$([16,17,18,9]).index(key)>=0)}),$(document).on("click.d",function(e){var el=e.target;el.id==css.root||$(el).parents("#"+css.root).length||el==input[0]||trigger&&el==trigger[0]||self.hide(e)})}var trigger,pm,nm,currYear,currMonth,currDay,opened,original,self=this,now=new Date,yearNow=now.getFullYear(),css=conf.css,labels=LABELS[conf.lang],root=$("#"+css.root),title=root.find("#"+css.title),value=input.attr("data-value")||conf.value||input.val(),min=input.attr("min")||conf.min,max=input.attr("max")||conf.max;if(0===min&&(min="0"),value=parseDate(value)||now,min=parseDate(min||new Date(yearNow+conf.yearRange[0],1,1)),max=parseDate(max||new Date(yearNow+conf.yearRange[1]+1,1,(-1))),!labels)throw"Dateinput: invalid language: "+conf.lang;if("date"==input.attr("type")){var original=input.clone(),def=original.wrap("<div/>").parent().html(),clone=$(def.replace(/type/i,"type=text data-orig-type"));conf.value&&clone.val(conf.value),input.replaceWith(clone),input=clone}input.addClass(css.input);var fire=input.add(self);if(!root.length){if(root=$("<div><div><a/><div/><a/></div><div><div/><div/></div></div>").hide().css({position:"absolute"}).attr("id",css.root),root.children().eq(0).attr("id",css.head).end().eq(1).attr("id",css.body).children().eq(0).attr("id",css.days).end().eq(1).attr("id",css.weeks).end().end().end().find("a").eq(0).attr("id",css.prev).end().eq(1).attr("id",css.next),title=root.find("#"+css.head).find("div").attr("id",css.title),conf.selectors){var monthSelector=$("<select/>").attr("id",css.month),yearSelector=$("<select/>").attr("id",css.year);title.html(monthSelector.add(yearSelector))}for(var days=root.find("#"+css.days),d=0;7>d;d++)days.append($("<span/>").text(labels.shortDays[(d+conf.firstDay)%7]));$("body").append(root)}conf.trigger&&(trigger=$("<a/>").attr("href","#").addClass(css.trigger).click(function(e){return conf.toggle?self.toggle():self.show(),e.preventDefault()}).insertAfter(input));var weeks=root.find("#"+css.weeks);yearSelector=root.find("#"+css.year),monthSelector=root.find("#"+css.month),$.extend(self,{show:function(e){if(!input.attr("disabled")&&!opened&&(e=e||$.Event(),e.type="onBeforeShow",fire.trigger(e),!e.isDefaultPrevented())){$.each(instances,function(){this.hide()}),opened=!0,monthSelector.off("change").change(function(){self.setValue(integer(yearSelector.val()),integer($(this).val()))}),yearSelector.off("change").change(function(){self.setValue(integer($(this).val()),integer(monthSelector.val()))}),pm=root.find("#"+css.prev).off("click").click(function(){return pm.hasClass(css.disabled)||self.addMonth(-1),!1}),nm=root.find("#"+css.next).off("click").click(function(){return nm.hasClass(css.disabled)||self.addMonth(),!1}),self.setValue(value);var pos=input.offset();return/iPad/i.test(navigator.userAgent)&&(pos.top-=$(window).scrollTop()),root.css({top:pos.top+input.outerHeight(!0)+conf.offset[0],left:pos.left+conf.offset[1]}),conf.speed?root.show(conf.speed,function(){onShow(e)}):(root.show(),onShow(e)),self}},setValue:function(year,month,day){var date=integer(month)>=-1?new Date(integer(year),integer(month),integer(day==undefined||isNaN(day)?1:day)):year||value;if(min>date?date=min:date>max&&(date=max),"string"==typeof year&&(date=parseDate(year)),year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),-1==month?(month=11,year--):12==month&&(month=0,year++),!opened)return select(date,conf),self;currMonth=month,currYear=year,currDay=day;var week,tmp=new Date(year,month,1-conf.firstDay),begin=tmp.getDay(),days=dayAm(year,month),prevDays=dayAm(year,month-1);if(conf.selectors){monthSelector.empty(),$.each(labels.months,function(i,m){min<new Date(year,i+1,1)&&max>new Date(year,i,0)&&monthSelector.append($("<option/>").html(m).attr("value",i))}),yearSelector.empty();for(var yearNow=now.getFullYear(),i=yearNow+conf.yearRange[0];i<yearNow+conf.yearRange[1];i++)min<new Date(i+1,0,1)&&max>new Date(i,0,0)&&yearSelector.append($("<option/>").text(i));monthSelector.val(month),yearSelector.val(year)}else title.html(labels.months[month]+" "+year);weeks.empty(),pm.add(nm).removeClass(css.disabled);for(var a,num,j=begin?0:-7;(begin?42:35)>j;j++)a=$("<a/>"),j%7===0&&(week=$("<div/>").addClass(css.week),weeks.append(week)),begin>j?(a.addClass(css.off),num=prevDays-begin+j+1,date=new Date(year,month-1,num)):j>=begin+days?(a.addClass(css.off),num=j-days-begin+1,date=new Date(year,month+1,num)):(num=j-begin+1,date=new Date(year,month,num),isSameDay(value,date)?a.attr("id",css.current).addClass(css.focus):isSameDay(now,date)&&a.attr("id",css.today)),min&&min>date&&a.add(pm).addClass(css.disabled),max&&date>max&&a.add(nm).addClass(css.disabled),a.attr("href","#"+num).text(num).data("date",date),week.append(a);return weeks.find("a").click(function(e){var el=$(this);return el.hasClass(css.disabled)||($("#"+css.current).removeAttr("id"),el.attr("id",css.current),select(el.data("date"),conf,e)),!1}),css.sunday&&weeks.find("."+css.week).each(function(){var beg=conf.firstDay?7-conf.firstDay:0;$(this).children().slice(beg,beg+1).addClass(css.sunday)}),self},setMin:function(val,fit){return min=parseDate(val),fit&&min>value&&self.setValue(min),self},setMax:function(val,fit){return max=parseDate(val),fit&&value>max&&self.setValue(max),self},today:function(){return self.setValue(now)},addDay:function(amount){return this.setValue(currYear,currMonth,currDay+(amount||1))},addMonth:function(amount){var targetMonth=currMonth+(amount||1),daysInTargetMonth=dayAm(currYear,targetMonth),targetDay=daysInTargetMonth>=currDay?currDay:daysInTargetMonth;return this.setValue(currYear,targetMonth,targetDay)},addYear:function(amount){return this.setValue(currYear+(amount||1),currMonth,currDay)},destroy:function(){input.add(document).off("click.d keydown.d"),root.add(trigger).remove(),input.removeData("dateinput").removeClass(css.input),original&&input.replaceWith(original)},hide:function(e){if(opened){if(e=$.Event(),e.type="onHide",fire.trigger(e),e.isDefaultPrevented())return;$(document).off("click.d keydown.d"),root.hide(),opened=!1}return self},toggle:function(){return self.isOpen()?self.hide():self.show()},getConf:function(){return conf},getInput:function(){return input},getCalendar:function(){return root},getValue:function(dateFormat){return dateFormat?format(conf.formatter,value,dateFormat,conf.lang):value},isOpen:function(){return opened}}),$.each(["onBeforeShow","onShow","change","onHide"],function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.editable||input.on("focus.d click.d",self.show).keydown(function(e){var key=e.keyCode;return!opened&&$(KEYS).index(key)>=0?(self.show(e),e.preventDefault()):((8==key||46==key)&&input.val(""),!!(e.shiftKey||e.ctrlKey||e.altKey||9==key)||e.preventDefault())}),parseDate(input.val())&&select(value,conf)}$.tools=$.tools||{version:"@VERSION"};var tool,instances=[],formatters={},KEYS=[75,76,38,39,74,72,40,37],LABELS={};tool=$.tools.dateinput={conf:{format:"mm/dd/yy",formatter:"default",selectors:!1,yearRange:[-5,5],lang:"en",offset:[0,0],speed:0,firstDay:0,min:undefined,max:undefined,trigger:0,toggle:0,editable:0,css:{prefix:"cal",input:"date",root:0,head:0,title:0,prev:0,next:0,month:0,year:0,days:0,body:0,weeks:0,today:0,current:0,week:0,off:0,sunday:0,focus:0,disabled:0,trigger:0}},addFormatter:function(name,fn){formatters[name]=fn},localize:function(language,labels){$.each(labels,function(key,val){labels[key]=val.split(",")}),LABELS[language]=labels}},tool.localize("en",{months:"January,February,March,April,May,June,July,August,September,October,November,December",shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",days:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat"});var tmpTag=$("<a/>");tool.addFormatter("default",function(text,date,flags){return text.replace(/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g,function($0){return $0 in flags?flags[$0]:$0})}),tool.addFormatter("prefixed",function(text,date,flags){return text.replace(/%(d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*')/g,function($0,$1){return $1 in flags?flags[$1]:$0})}),$.expr[":"].date=function(el){var type=el.getAttribute("type");return type&&"date"==type||!!$(el).data("dateinput")},$.fn.dateinput=function(conf){if(this.data("dateinput"))return this;conf=$.extend(!0,{},tool.conf,conf),$.each(conf.css,function(key,val){val||"prefix"==key||(conf.css[key]=(conf.css.prefix||"")+(val||key))});var els;return this.each(function(){var el=new Dateinput($(this),conf);instances.push(el);var input=el.getInput().data("dateinput",el);els=els?els.add(input):input}),els?els:this}}(jQuery)}.apply(root,arguments)})}(this),function(root){define("jquery.tmpl",["jquery"],function(){return function(){!function(jQuery,undefined){function newTmplItem(options,parentItem,fn,data){var newItem={data:data||(parentItem?parentItem.data:{}),_wrap:parentItem?parentItem._wrap:null,tmpl:null,parent:parentItem||null,nodes:[],calls:tiCalls,nest:tiNest,wrap:tiWrap,html:tiHtml,update:tiUpdate};return options&&jQuery.extend(newItem,options,{nodes:[],parent:parentItem}),fn&&(newItem.tmpl=fn,newItem._ctnt=newItem._ctnt||newItem.tmpl(jQuery,newItem),newItem.key=++itemKey,(stack.length?wrappedItems:newTmplItems)[itemKey]=newItem),newItem}function build(tmplItem,nested,content){var frag,ret=content?jQuery.map(content,function(item){return"string"==typeof item?tmplItem.key?item.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+tmplItmAtt+'="'+tmplItem.key+'" $2'):item:build(item,tmplItem,item._ctnt)}):tmplItem;return nested?ret:(ret=ret.join(""),ret.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(all,before,middle,after){frag=jQuery(middle).get(),storeTmplItems(frag),before&&(frag=unencode(before).concat(frag)),after&&(frag=frag.concat(unencode(after)))}),frag?frag:unencode(ret))}function unencode(text){var el=document.createElement("div");return el.innerHTML=text,jQuery.makeArray(el.childNodes)}function buildTmplFn(markup){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+jQuery.trim(markup).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(all,slash,type,fnargs,target,parens,args){var def,expr,exprAutoFnDetect,tag=jQuery.tmpl.tag[type];if(!tag)throw"Template command not found: "+type;return def=tag._default||[],parens&&!/\w$/.test(target)&&(target+=parens,parens=""),target?(target=unescape(target),args=args?","+unescape(args)+")":parens?")":"",expr=parens?target.indexOf(".")>-1?target+parens:"("+target+").call($item"+args:target,exprAutoFnDetect=parens?expr:"(typeof("+target+")==='function'?("+target+").call($item):("+target+"))"):exprAutoFnDetect=expr=def.$1||"null",fnargs=unescape(fnargs),"');"+tag[slash?"close":"open"].split("$notnull_1").join(target?"typeof("+target+")!=='undefined' && ("+target+")!=null":"true").split("$1a").join(exprAutoFnDetect).split("$1").join(expr).split("$2").join(fnargs?fnargs.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(all,name,parens,params){return params=params?","+params+")":parens?")":"",params?"("+name+").call($item"+params:all}):def.$2||"")+"_.push('"})+"');}return _;")}function updateWrapped(options,wrapped){options._wrap=build(options,!0,jQuery.isArray(wrapped)?wrapped:[htmlExpr.test(wrapped)?wrapped:jQuery(wrapped).html()]).join("")}function unescape(args){return args?args.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function outerHtml(elem){var div=document.createElement("div");return div.appendChild(elem.cloneNode(!0)),div.innerHTML}function storeTmplItems(content){function processItemKey(el){function cloneTmplItem(key){key+=keySuffix,tmplItem=newClonedItems[key]=newClonedItems[key]||newTmplItem(tmplItem,newTmplItems[tmplItem.parent.key+keySuffix]||tmplItem.parent,null,!0)}var pntKey,pntItem,tmplItem,key,pntNode=el;if(key=el.getAttribute(tmplItmAtt)){for(;pntNode.parentNode&&1===(pntNode=pntNode.parentNode).nodeType&&!(pntKey=pntNode.getAttribute(tmplItmAtt)););pntKey!==key&&(pntNode=pntNode.parentNode?11===pntNode.nodeType?0:pntNode.getAttribute(tmplItmAtt)||0:0,(tmplItem=newTmplItems[key])||(tmplItem=wrappedItems[key],tmplItem=newTmplItem(tmplItem,newTmplItems[pntNode]||wrappedItems[pntNode],null,!0),tmplItem.key=++itemKey,newTmplItems[itemKey]=tmplItem),cloneIndex&&cloneTmplItem(key)),el.removeAttribute(tmplItmAtt)}else cloneIndex&&(tmplItem=jQuery.data(el,"tmplItem"))&&(cloneTmplItem(tmplItem.key),newTmplItems[tmplItem.key]=tmplItem,pntNode=jQuery.data(el.parentNode,"tmplItem"),pntNode=pntNode?pntNode.key:0);if(tmplItem){for(pntItem=tmplItem;pntItem&&pntItem.key!=pntNode;)pntItem.nodes.push(el),pntItem=pntItem.parent;delete tmplItem._ctnt,delete tmplItem._wrap,jQuery.data(el,"tmplItem",tmplItem)}}var elem,elems,i,l,m,keySuffix="_"+cloneIndex,newClonedItems={};for(i=0,l=content.length;i<l;i++)if(1===(elem=content[i]).nodeType){for(elems=elem.getElementsByTagName("*"),m=elems.length-1;m>=0;m--)processItemKey(elems[m]);processItemKey(elem)}}function tiCalls(content,tmpl,data,options){return content?void stack.push({_:content,tmpl:tmpl,item:this,data:data,options:options}):stack.pop()}function tiNest(tmpl,data,options){return jQuery.tmpl(jQuery.template(tmpl),data,options,this)}function tiWrap(call,wrapped){var options=call.options||{};return options.wrapped=wrapped,jQuery.tmpl(jQuery.template(call.tmpl),call.data,options,call.item)}function tiHtml(filter,textOnly){var wrapped=this._wrap;return jQuery.map(jQuery(jQuery.isArray(wrapped)?wrapped.join(""):wrapped).filter(filter||"*"),function(e){return textOnly?e.innerText||e.textContent:e.outerHTML||outerHtml(e)})}function tiUpdate(){var coll=this.nodes;jQuery.tmpl(null,null,null,this).insertBefore(coll[0]),jQuery(coll).remove()}var appendToTmplItems,oldManip=jQuery.fn.domManip,tmplItmAtt="_tmplitem",htmlExpr=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,newTmplItems={},wrappedItems={},topTmplItem={key:0,data:{}},itemKey=0,cloneIndex=0,stack=[];jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,i,l,tmplItems,ret=[],insert=jQuery(selector),parent=1===this.length&&this[0].parentNode;if(appendToTmplItems=newTmplItems||{},parent&&11===parent.nodeType&&1===parent.childNodes.length&&1===insert.length)insert[original](this[0]),ret=this;else{for(i=0,l=insert.length;i<l;i++)cloneIndex=i,elems=(i>0?this.clone(!0):this).get(),
jQuery.fn[original].apply(jQuery(insert[i]),elems),ret=ret.concat(elems);cloneIndex=0,ret=this.pushStack(ret,name,insert.selector)}return tmplItems=appendToTmplItems,appendToTmplItems=null,jQuery.tmpl.complete(tmplItems),ret}}),jQuery.fn.extend({tmpl:function(data,options,parentItem){return jQuery.tmpl(this[0],data,options,parentItem)},tmplItem:function(){return jQuery.tmplItem(this[0])},template:function(name){return jQuery.template(name,this[0])},domManip:function(args,table,callback,options){if(args[0]&&args[0].nodeType){for(var tmplItem,dmArgs=jQuery.makeArray(arguments),argsLength=args.length,i=0;i<argsLength&&!(tmplItem=jQuery.data(args[i++],"tmplItem")););argsLength>1&&(dmArgs[0]=[jQuery.makeArray(args)]),tmplItem&&cloneIndex&&(dmArgs[2]=function(fragClone){jQuery.tmpl.afterManip(this,fragClone,callback)}),oldManip.apply(this,dmArgs)}else oldManip.apply(this,arguments);return cloneIndex=0,appendToTmplItems||jQuery.tmpl.complete(newTmplItems),this}}),jQuery.extend({tmpl:function(tmpl,data,options,parentItem){var ret,topLevel=!parentItem;if(topLevel)parentItem=topTmplItem,tmpl=jQuery.template[tmpl]||jQuery.template(null,tmpl),wrappedItems={};else if(!tmpl)return tmpl=parentItem.tmpl,newTmplItems[parentItem.key]=parentItem,parentItem.nodes=[],parentItem.wrapped&&updateWrapped(parentItem,parentItem.wrapped),jQuery(build(parentItem,null,parentItem.tmpl(jQuery,parentItem)));return tmpl?("function"==typeof data&&(data=data.call(parentItem||{})),options&&options.wrapped&&updateWrapped(options,options.wrapped),ret=jQuery.isArray(data)?jQuery.map(data,function(dataItem){return dataItem?newTmplItem(options,parentItem,tmpl,dataItem):null}):[newTmplItem(options,parentItem,tmpl,data)],topLevel?jQuery(build(parentItem,null,ret)):ret):[]},tmplItem:function(elem){var tmplItem;for(elem instanceof jQuery&&(elem=elem[0]);elem&&1===elem.nodeType&&!(tmplItem=jQuery.data(elem,"tmplItem"))&&(elem=elem.parentNode););return tmplItem||topTmplItem},template:function(name,tmpl){return tmpl?("string"==typeof tmpl?tmpl=buildTmplFn(tmpl):tmpl instanceof jQuery&&(tmpl=tmpl[0]||{}),tmpl.nodeType&&(tmpl=jQuery.data(tmpl,"tmpl")||jQuery.data(tmpl,"tmpl",buildTmplFn(tmpl.innerHTML))),"string"==typeof name?jQuery.template[name]=tmpl:tmpl):name?"string"!=typeof name?jQuery.template(null,name):jQuery.template[name]||jQuery.template(null,htmlExpr.test(name)?name:jQuery(name)):null},encode:function(text){return(""+text).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),jQuery.extend(jQuery.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(items){newTmplItems={}},afterManip:function(elem,fragClone,callback){var content=11===fragClone.nodeType?jQuery.makeArray(fragClone.childNodes):1===fragClone.nodeType?[fragClone]:[];callback.call(elem,fragClone),storeTmplItems(content),cloneIndex++}})}(jQuery)}.apply(root,arguments)})}(this),function(root){define("jquery.recurrenceinput",["jquery","jquery.tools.overlay","jquery.tools.dateinput","jquery.tmpl"],function(){return function(){!function($){function zeropad(val,len){for(val=val.toString(),len=len||2;val.length<len;)val="0"+val;return val}function format(date,fmt,conf){var d=date.getDate(),D=date.getDay(),m=date.getMonth(),y=date.getFullYear(),flags={d:d,dd:zeropad(d),ddd:conf.i18n.shortWeekdays[D],dddd:conf.i18n.weekdays[D],m:m+1,mm:zeropad(m+1),mmm:conf.i18n.shortMonths[m],mmmm:conf.i18n.months[m],yy:String(y).slice(2),yyyy:y},result=fmt.replace(Re,function($0){return flags.hasOwnProperty($0)?flags[$0]:$0.slice(1,$0.length-1)});return result}function widgetSaveToRfc5545(form,conf,tz){var field,input,weekdays,i18nweekdays,i,j,index,tmp,day,month,year,interval,yearlyType,occurrences,date,value=form.find("select[name=rirtemplate]").val(),rtemplate=conf.rtemplate[value],result=rtemplate.rrule,human=conf.i18n.rtemplate[value];for(i=0;i<rtemplate.fields.length;i++)switch(field=form.find("#"+rtemplate.fields[i]),field.attr("id")){case"ridailyinterval":interval=field.find("input[name=ridailyinterval]").val(),"1"!==interval&&(result+=";INTERVAL="+interval),human=interval+" "+conf.i18n.dailyInterval2;break;case"riweeklyinterval":interval=field.find("input[name=riweeklyinterval]").val(),"1"!==interval&&(result+=";INTERVAL="+interval),human=interval+" "+conf.i18n.weeklyInterval2;break;case"riweeklyweekdays":for(weekdays="",i18nweekdays="",j=0;j<conf.weekdays.length;j++)input=field.find("input[name=riweeklyweekdays"+conf.weekdays[j]+"]"),input.is(":checked")&&(weekdays&&(weekdays+=",",i18nweekdays+=", "),weekdays+=conf.weekdays[j],i18nweekdays+=conf.i18n.weekdays[j]);weekdays&&(result+=";BYDAY="+weekdays,human+=" "+conf.i18n.weeklyWeekdaysHuman+" "+i18nweekdays);break;case"rimonthlyinterval":interval=field.find("input[name=rimonthlyinterval]").val(),"1"!==interval&&(result+=";INTERVAL="+interval),human=interval+" "+conf.i18n.monthlyInterval2;break;case"rimonthlyoptions":var monthlyType=$("input[name=rimonthlytype]:checked",form).val();switch(monthlyType){case"DAYOFMONTH":day=$("select[name=rimonthlydayofmonthday]",form).val(),result+=";BYMONTHDAY="+day,human+=", "+conf.i18n.monthlyDayOfMonth1Human+" "+day+" "+conf.i18n.monthlyDayOfMonth2;break;case"WEEKDAYOFMONTH":index=$("select[name=rimonthlyweekdayofmonthindex]",form).val(),day=$("select[name=rimonthlyweekdayofmonth]",form).val(),$.inArray(day,["MO","TU","WE","TH","FR","SA","SU"])>-1&&(result+=";BYDAY="+index+day,human+=", "+conf.i18n.monthlyWeekdayOfMonth1Human+" ",human+=" "+conf.i18n.orderIndexes[$.inArray(index,conf.orderIndexes)],human+=" "+conf.i18n.monthlyWeekdayOfMonth2,human+=" "+conf.i18n.weekdays[$.inArray(day,conf.weekdays)],human+=" "+conf.i18n.monthlyDayOfMonth2)}break;case"riyearlyinterval":interval=field.find("input[name=riyearlyinterval]").val(),"1"!==interval&&(result+=";INTERVAL="+interval),human=interval+" "+conf.i18n.yearlyInterval2;break;case"riyearlyoptions":switch(yearlyType=$("input[name=riyearlyType]:checked",form).val()){case"DAYOFMONTH":month=$("select[name=riyearlydayofmonthmonth]",form).val(),day=$("select[name=riyearlydayofmonthday]",form).val(),result+=";BYMONTH="+month,result+=";BYMONTHDAY="+day,human+=", "+conf.i18n.yearlyDayOfMonth1Human+" "+conf.i18n.months[month-1]+" "+day;break;case"WEEKDAYOFMONTH":index=$("select[name=riyearlyweekdayofmonthindex]",form).val(),day=$("select[name=riyearlyweekdayofmonthday]",form).val(),month=$("select[name=riyearlyweekdayofmonthmonth]",form).val(),result+=";BYMONTH="+month,$.inArray(day,["MO","TU","WE","TH","FR","SA","SU"])>-1&&(result+=";BYDAY="+index+day,human+=", "+conf.i18n.yearlyWeekdayOfMonth1Human,human+=" "+conf.i18n.orderIndexes[$.inArray(index,conf.orderIndexes)],human+=" "+conf.i18n.yearlyWeekdayOfMonth2,human+=" "+conf.i18n.weekdays[$.inArray(day,conf.weekdays)],human+=" "+conf.i18n.yearlyWeekdayOfMonth3,human+=" "+conf.i18n.months[month-1],human+=" "+conf.i18n.yearlyWeekdayOfMonth4)}break;case"rirangeoptions":var rangeType=form.find("input[name=rirangetype]:checked").val();switch(rangeType){case"BYOCCURRENCES":occurrences=form.find("input[name=rirangebyoccurrencesvalue]").val(),result+=";COUNT="+occurrences,human+=", "+conf.i18n.rangeByOccurrences1Human,human+=" "+occurrences,human+=" "+conf.i18n.rangeByOccurrences2;break;case"BYENDDATE":field=form.find("input[name=rirangebyenddatecalendar]"),date=field.data("dateinput").getValue("yyyymmdd"),result+=";UNTIL="+date+"T000000",tz===!0&&(result+="Z"),human+=", "+conf.i18n.rangeByEndDateHuman,human+=" "+field.data("dateinput").getValue(conf.i18n.longDateFormat)}}if(void 0!==form.ical.RDATE&&form.ical.RDATE.length>0){for(form.ical.RDATE.sort(),tmp=[],i=0;i<form.ical.RDATE.length;i++)""!==form.ical.RDATE[i]&&(year=parseInt(form.ical.RDATE[i].substring(0,4),10),month=parseInt(form.ical.RDATE[i].substring(4,6),10)-1,day=parseInt(form.ical.RDATE[i].substring(6,8),10),tmp.push(format(new Date(year,month,day),conf.i18n.longDateFormat,conf)));0!==tmp.length&&(human=human+conf.i18n.including+" "+tmp.join("; "))}if(void 0!==form.ical.EXDATE&&form.ical.EXDATE.length>0){for(form.ical.EXDATE.sort(),tmp=[],i=0;i<form.ical.EXDATE.length;i++)""!==form.ical.EXDATE[i]&&(year=parseInt(form.ical.EXDATE[i].substring(0,4),10),month=parseInt(form.ical.EXDATE[i].substring(4,6),10)-1,day=parseInt(form.ical.EXDATE[i].substring(6,8),10),tmp.push(format(new Date(year,month,day),conf.i18n.longDateFormat,conf)));0!==tmp.length&&(human=human+conf.i18n.except+" "+tmp.join("; "))}return result="RRULE:"+result,void 0!==form.ical.EXDATE&&""!==form.ical.EXDATE.join()&&(tmp=$.map(form.ical.EXDATE,function(x){return 8===x.length&&(x+="T000000"),tz===!0&&(x+="Z"),x}),result=result+"\nEXDATE:"+tmp),void 0!==form.ical.RDATE&&""!==form.ical.RDATE.join()&&(tmp=$.map(form.ical.RDATE,function(x){return 8===x.length&&(x+="T000000"),tz===!0&&(x+="Z"),x}),result=result+"\nRDATE:"+tmp),{result:result,description:human}}function parseLine(icalline){var result={},pos=icalline.indexOf(":"),property=icalline.substring(0,pos);return result.value=icalline.substring(pos+1),property.indexOf(";")!==-1?(pos=property.indexOf(";"),result.parameters=property.substring(pos+1),result.property=property.substring(0,pos)):(result.parameters=null,result.property=property),result}function cleanDates(dates){var date,result=[],splitDates=dates.split(",");for(date in splitDates)splitDates.hasOwnProperty(date)&&(splitDates[date].indexOf("Z")!==-1?result.push(splitDates[date].substring(0,15)):result.push(splitDates[date]));return result}function parseIcal(icaldata){var nextline,lines=[],result={},line=null;for(lines=icaldata.split("\n"),lines.reverse();;){if(lines.length>0){if(nextline=lines.pop()," "===nextline.charAt(0)||"\t"===nextline.charAt(0)){line+=nextline;continue}}else nextline="";if(null!==line&&(line=parseLine(line),"RDATE"===line.property||"EXDATE"===line.property?result[line.property]=cleanDates(line.value):result[line.property]=line.value),line=nextline,""===line)break}return result}function widgetLoadFromRfc5545(form,conf,icaldata,force){var i,matches,match,matchIndex,rtemplate,d,input,index,selector,selectors,field,radiobutton,interval,byday,bymonth,bymonthday,count,until,day,month,year,weekday,unsupportedFeatures=[];if(form.ical=parseIcal(icaldata),void 0===form.ical.RRULE){if(unsupportedFeatures.push(conf.i18n.noRule),!force)return-1}else{matches=/INTERVAL=([0-9]+);?/.exec(form.ical.RRULE),interval=matches?matches[1]:"1",matches=/BYDAY=([^;]+);?/.exec(form.ical.RRULE),byday=matches?matches[1]:"",matches=/BYMONTHDAY=([^;]+);?/.exec(form.ical.RRULE),bymonthday=matches?matches[1].split(","):null,matches=/BYMONTH=([^;]+);?/.exec(form.ical.RRULE),bymonth=matches?matches[1].split(","):null,matches=/COUNT=([0-9]+);?/.exec(form.ical.RRULE),count=matches?matches[1]:null,matches=/UNTIL=([0-9T]+);?/.exec(form.ical.RRULE),until=matches?matches[1]:null,matches=/BYSETPOS=([^;]+);?/.exec(form.ical.RRULE),matches&&unsupportedFeatures.push(conf.i18n.bysetpos),match="",matchIndex=null;for(i in conf.rtemplate)conf.rtemplate.hasOwnProperty(i)&&(rtemplate=conf.rtemplate[i],0===form.ical.RRULE.indexOf(rtemplate.rrule)&&form.ical.RRULE.length>match.length&&(match=form.ical.RRULE,matchIndex=i));if(match)rtemplate=conf.rtemplate[matchIndex],selector=form.find("select[name=rirtemplate]").val(matchIndex);else{for(rtemplate in conf.rtemplate)if(conf.rtemplate.hasOwnProperty(rtemplate)){rtemplate=conf.rtemplate[rtemplate];break}unsupportedFeatures.push(conf.i18n.noTemplateMatch)}for(i=0;i<rtemplate.fields.length;i++)switch(field=form.find("#"+rtemplate.fields[i]),field.attr("id")){case"ridailyinterval":field.find("input[name=ridailyinterval]").val(interval);break;case"riweeklyinterval":field.find("input[name=riweeklyinterval]").val(interval);break;case"riweeklyweekdays":for(byday=byday.split(","),d=0;d<conf.weekdays.length;d++)day=conf.weekdays[d],input=field.find("input[name=riweeklyweekdays"+day+"]"),input.attr("checked",$.inArray(day,byday)!==-1);break;case"rimonthlyinterval":field.find("input[name=rimonthlyinterval]").val(interval);break;case"rimonthlyoptions":var monthlyType="DAYOFMONTH";for(bymonthday&&(monthlyType="DAYOFMONTH",bymonthday.length>1&&(unsupportedFeatures.push(conf.i18n.multipleDayOfMonth),bymonthday=bymonthday[0]),field.find("select[name=rimonthlydayofmonthday]").val(bymonthday)),byday&&(monthlyType="WEEKDAYOFMONTH",byday.indexOf(",")!==-1&&(unsupportedFeatures.push(conf.i18n.multipleDayOfMonth),byday=byday.split(",")[0]),index=byday.slice(0,-2),"+"!==index.charAt(0)&&"-"!==index.charAt(0)&&(index="+"+index),weekday=byday.slice(-2),field.find("select[name=rimonthlyweekdayofmonthindex]").val(index),field.find("select[name=rimonthlyweekdayofmonth]").val(weekday)),selectors=field.find("input[name=rimonthlytype]"),index=0;index<selectors.length;index++)radiobutton=selectors[index],$(radiobutton).attr("checked",radiobutton.value===monthlyType);break;case"riyearlyinterval":field.find("input[name=riyearlyinterval]").val(interval);break;case"riyearlyoptions":var yearlyType="DAYOFMONTH";for(bymonthday&&(yearlyType="DAYOFMONTH",bymonthday.length>1&&(unsupportedFeatures.push(conf.i18n.multipleDayOfMonth),bymonthday=bymonthday[0]),field.find("select[name=riyearlydayofmonthmonth]").val(bymonth),field.find("select[name=riyearlydayofmonthday]").val(bymonthday)),byday&&(yearlyType="WEEKDAYOFMONTH",byday.indexOf(",")!==-1&&(unsupportedFeatures.push(conf.i18n.multipleDayOfMonth),byday=byday.split(",")[0]),index=byday.slice(0,-2),"+"!==index.charAt(0)&&"-"!==index.charAt(0)&&(index="+"+index),weekday=byday.slice(-2),field.find("select[name=riyearlyweekdayofmonthindex]").val(index),field.find("select[name=riyearlyweekdayofmonthday]").val(weekday),field.find("select[name=riyearlyweekdayofmonthmonth]").val(bymonth)),selectors=field.find("input[name=riyearlyType]"),index=0;index<selectors.length;index++)radiobutton=selectors[index],$(radiobutton).attr("checked",radiobutton.value===yearlyType);break;case"rirangeoptions":var rangeType="NOENDDATE";for(count&&(rangeType="BYOCCURRENCES",field.find("input[name=rirangebyoccurrencesvalue]").val(count)),until&&(rangeType="BYENDDATE",input=field.find("input[name=rirangebyenddatecalendar]"),year=until.slice(0,4),month=until.slice(4,6),month=parseInt(month,10)-1,day=until.slice(6,8),input.data("dateinput").setValue(new Date(year,month,day))),selectors=field.find("input[name=rirangetype]"),index=0;index<selectors.length;index++)radiobutton=selectors[index],$(radiobutton).attr("checked",radiobutton.value===rangeType)}}var messagearea=form.find("#messagearea");return 0!==unsupportedFeatures.length?(messagearea.text(conf.i18n.unsupportedFeatures+" "+unsupportedFeatures.join("; ")),messagearea.show(),1):(messagearea.text(""),messagearea.hide(),0)}function RecurrenceInput(conf,textarea){function displayFields(selector){var i;form.find(".rifield").hide();var value=selector.val();if(value){var rtemplate=conf.rtemplate[value];for(i=0;i<rtemplate.fields.length;i++)form.find("#"+rtemplate.fields[i]).show()}}function occurrenceExclude(event){event.preventDefault(),void 0===form.ical.EXDATE&&(form.ical.EXDATE=[]),form.ical.EXDATE.push(this.attributes.date.value);var $this=$(this);$this.attr("class","exdate"),$this.parent().parent().addClass("exdate"),$this.unbind(event),$this.click(occurrenceInclude)}function occurrenceInclude(event){event.preventDefault(),form.ical.EXDATE.splice($.inArray(this.attributes.date.value,form.ical.EXDATE),1);var $this=$(this);$this.attr("class","rrule"),$this.parent().parent().removeClass("exdate"),$this.unbind(event),$this.click(occurrenceExclude)}function occurrenceDelete(event){event.preventDefault(),form.ical.RDATE.splice($.inArray(this.attributes.date.value,form.ical.RDATE),1),$(this).parent().parent().hide("slow",function(){$(this).remove()})}function occurrenceAdd(event){event.preventDefault();var dateinput=form.find(".riaddoccurrence input#adddate").data("dateinput"),datevalue=dateinput.getValue("yyyymmddT000000");void 0===form.ical.RDATE&&(form.ical.RDATE=[]);var errorarea=form.find(".riaddoccurrence div.errorarea");if(errorarea.text(""),errorarea.hide(),$.inArray(datevalue,form.ical.RDATE)===-1){form.ical.RDATE.push(datevalue);var html=['<div class="occurrence rdate" style="display: none;">','<span class="rdate">',dateinput.getValue(conf.i18n.longDateFormat),'<span class="rlabel">'+conf.i18n.additionalDate+"</span>","</span>",'<span class="action">','<a date="'+datevalue+'" href="#" class="rdate" >',"Include","</a>","</span>","</div>"].join("\n");form.find("div.rioccurrences").prepend(html),$(form.find("div.rioccurrences div")[0]).slideDown(),$(form.find("div.rioccurrences .action a.rdate")[0]).click(occurrenceDelete)}else errorarea.text(conf.i18n.alreadyAdded).show()}function loadOccurrences(startdate,rfc5545,start,readonly){var element,occurrenceDiv;element=readonly?display:form,occurrenceDiv=element.find(".rioccurrences"),occurrenceDiv.hide();var year,month,day;year=startdate.getFullYear(),month=startdate.getMonth()+1,day=startdate.getDate();var data={year:year,month:month,day:day,rrule:rfc5545,format:conf.i18n.longDateFormat,start:start},dict={url:conf.ajaxURL,async:!1,type:"post",dataType:"json",contentType:conf.ajaxContentType,cache:!1,data:data,success:function(data,status,jqXHR){var result,element;element=readonly?display:form,data.readOnly=readonly,data.i18n=conf.i18n;var occurrence,date,y,m,d,each;for(each in data.occurrences)data.occurrences.hasOwnProperty(each)&&(occurrence=data.occurrences[each],date=occurrence.date,y=parseInt(date.substring(0,4),10),m=parseInt(date.substring(4,6),10)-1,d=parseInt(date.substring(6,8),10),occurrence.formattedDate=format(new Date(y,m,d),conf.i18n.longDateFormat,conf));result=$.tmpl("occurrenceTmpl",data),occurrenceDiv=element.find(".rioccurrences"),occurrenceDiv.replaceWith(result),element.find(".rioccurrences .batching a").click(function(event){event.preventDefault(),loadOccurrences(startdate,rfc5545,this.attributes.start.value,readonly)}),readonly||(element.find(".rioccurrences .action a.rrule").click(occurrenceExclude),element.find(".rioccurrences .action a.exdate").click(occurrenceInclude),element.find(".rioccurrences .action a.rdate").click(occurrenceDelete)),element.find(".rioccurrences").show()},error:function(jqXHR,textStatus,errorThrown){alert(textStatus)}};$.ajax(dict)}function getField(field){var realField=$(field);return realField.length||(realField=$("#"+field)),realField.length||(realField=$("input[name='"+field+"']")),realField}function findStartDate(){var startField,startFieldYear,startFieldMonth,startFieldDay,startdate=null;if(conf.startField){if(startField=getField(conf.startField),!startField.length)return null;startdate=startField.data("dateinput"),startdate?startdate=startdate.getValue():(startdate=startField.val(),""===startdate&&(startdate=startField.text())),"string"==typeof startdate&&(startdate=startdate.replace(" ","T")),startdate=new Date(startdate)}else if(conf.startFieldYear&&conf.startFieldMonth&&conf.startFieldDay){if(startFieldYear=getField(conf.startFieldYear),startFieldMonth=getField(conf.startFieldMonth),startFieldDay=getField(conf.startFieldDay),!startFieldYear.length&&!startFieldMonth.length&&!startFieldDay.length)return null;startdate=new Date(startFieldYear.val(),startFieldMonth.val()-1,startFieldDay.val())}return null===startdate?null:isNaN(startdate)?null:startdate}function findEndDate(form){var endField,enddate;return endField=form.find("input[name=rirangebyenddatecalendar]"),enddate=endField.data("dateinput"),enddate=enddate?enddate.getValue():endField.val(),enddate=new Date(enddate),isNaN(enddate)||""===endField.val()?null:enddate}function findIntField(fieldName,form){var field,num;return field=form.find("input[name="+fieldName+"]"),num=field.val(),isNaN(num)||num.toString().indexOf(".")!==-1||""===field.val()?null:num}function loadData(rfc5545){var selector,startdate,dayindex,day;rfc5545&&widgetLoadFromRfc5545(form,conf,rfc5545,!0),startdate=findStartDate(),null!==startdate?(form.find("select[name=rimonthlydayofmonthday]").val(startdate.getDate()),dayindex=conf.orderIndexes[Math.floor((startdate.getDate()-1)/7)],day=conf.weekdays[startdate.getDay()],form.find("select[name=rimonthlyweekdayofmonthindex]").val(dayindex),form.find("select[name=rimonthlyweekdayofmonth]").val(day),form.find("select[name=riyearlydayofmonthmonth]").val(startdate.getMonth()+1),form.find("select[name=riyearlydayofmonthday]").val(startdate.getDate()),form.find("select[name=riyearlyweekdayofmonthindex]").val(dayindex),form.find("select[name=riyearlyweekdayofmonthday]").val(day),form.find("select[name=riyearlyweekdayofmonthmonth]").val(startdate.getMonth()+1),loadOccurrences(startdate,widgetSaveToRfc5545(form,conf,!1).result,0,!1),form.find("div.rioccurrencesactions").show()):form.find("div.rioccurrencesactions").hide(),selector=form.find("select[name=rirtemplate]"),displayFields(selector)}function recurrenceOn(){var RFC5545=widgetSaveToRfc5545(form,conf,!1),label=display.find("label[class=ridisplay]");label.text(conf.i18n.displayActivate+" "+RFC5545.description),textarea.val(RFC5545.result).change();var startdate=findStartDate();null!==startdate&&loadOccurrences(startdate,widgetSaveToRfc5545(form,conf,!1).result,0,!0),display.find('button[name="riedit"]').text(conf.i18n.edit_rules),display.find('button[name="ridelete"]').show()}function recurrenceOff(){var label=display.find("label[class=ridisplay]");label.text(conf.i18n.displayUnactivate),textarea.val("").change(),display.find(".rioccurrences").hide(),display.find('button[name="riedit"]').text(conf.i18n.add_rules),display.find('button[name="ridelete"]').hide()}function checkFields(form){var startDate,endDate,num,messagearea;if(startDate=findStartDate(),messagearea=form.find("#messagearea"),messagearea.text(""),messagearea.hide(),form.find(".riaddoccurrence div.errorarea").text("").hide(),"block"===form.find("#ridailyinterval").css("display")&&(num=findIntField("ridailyinterval",form),!num||num<1||num>1e3))return messagearea.text(conf.i18n.noRepeatEvery).show(),!1;if("block"===form.find("#riweeklyinterval").css("display")&&(num=findIntField("riweeklyinterval",form),!num||num<1||num>1e3))return messagearea.text(conf.i18n.noRepeatEvery).show(),!1;if("block"===form.find("#rimonthlyinterval").css("display")){if(num=findIntField("rimonthlyinterval",form),!num||num<1||num>1e3)return messagearea.text(conf.i18n.noRepeatEvery).show(),!1;if(0===form.find("#rimonthlyoptions input:checked").length)return messagearea.text(conf.i18n.noRepeatOn).show(),!1}if("block"===form.find("#riyearlyinterval").css("display")){if(num=findIntField("riyearlyinterval",form),!num||num<1||num>1e3)return messagearea.text(conf.i18n.noRepeatEvery).show(),!1;if(0===form.find("#riyearlyoptions input:checked").length)return messagearea.text(conf.i18n.noRepeatOn).show(),!1}if(form.find('input[value="BYOCCURRENCES"]:visible:checked').length>0&&(num=findIntField("rirangebyoccurrencesvalue",form),!num||num<1||num>1e3))return messagearea.text(conf.i18n.noEndAfterNOccurrences).show(),!1;if(form.find('input[value="BYENDDATE"]:visible:checked').length>0){if(endDate=findEndDate(form),!endDate)return messagearea.text(conf.i18n.noEndDate).show(),!1;if(endDate<startDate)return messagearea.text(conf.i18n.pastEndDate).show(),!1}return!0}function save(event){event.preventDefault(),checkFields(form)&&(form.overlay().close(),recurrenceOn())}function cancel(event){event.preventDefault(),form.overlay().close()}function updateOccurances(){var startDate;startDate=findStartDate(),checkFields(form)&&loadOccurrences(startDate,widgetSaveToRfc5545(form,conf,!1).result,0,!1)}var form,display,index,i,self=this,orderedWeekdays=[];for(i=0;i<7;i++)index=i+conf.firstDay,index>6&&(index-=7),orderedWeekdays.push(index);if($.extend(conf,{orderIndexes:["+1","+2","+3","+4","-1"],weekdays:["SU","MO","TU","WE","TH","FR","SA"],orderedWeekdays:orderedWeekdays}),display=$.tmpl("displayTmpl",conf),form=$.tmpl("formTmpl",conf),form.overlay(conf.formOverlay).hide(),form.ical={RDATE:[],EXDATE:[]},$.tools.dateinput.localize(conf.lang,{months:LABELS[conf.lang].months.join(),shortMonths:LABELS[conf.lang].shortMonths.join(),days:LABELS[conf.lang].weekdays.join(),shortDays:LABELS[conf.lang].shortWeekdays.join()}),form.find("input[name=rirangebyenddatecalendar]").dateinput({selectors:!0,lang:conf.lang,format:conf.i18n.shortDateFormat,firstDay:conf.firstDay,yearRange:[-5,10]}).data("dateinput").setValue(new Date),textarea.val()){var result=widgetLoadFromRfc5545(form,conf,textarea.val(),!1);if(result===-1){var label=display.find("label[class=ridisplay]");label.text(conf.i18n.noRule)}else recurrenceOn()}display.find("button[name=ridelete]").click(function(e){e.preventDefault(),recurrenceOff()}),display.find("button[name=riedit]").click(function(e){loadData(textarea.val()),e.preventDefault(),form.overlay().load()}),form.find("div.riaddoccurrence input#adddate").dateinput({selectors:!0,lang:conf.lang,format:conf.i18n.shortDateFormat,firstDay:conf.firstDay,yearRange:[-5,10]}).data("dateinput").setValue(new Date),form.find("input#addaction").click(occurrenceAdd),form.find("a.rirefreshbutton").click(function(event){event.preventDefault(),updateOccurances()}),form.find("select[name=rirtemplate]").change(function(e){displayFields($(this))}),form.find("select").change(function(e){$(this).parent().find("> input").click().change()}),form.find("input[name=rirangebyoccurrencesvalue]").change(function(e){$(this).parent().find("input[name=rirangetype]").click().change()}),form.find("input[name=rirangebyenddatecalendar]").change(function(){$(this).parent().find("input[name=rirangetype]").click(),0!==form.find(".rioccurrencesactions:visible").length&&updateOccurances()}),form.find("input:radio, .riweeklyweekday > input, input[name=ridailyinterval], input[name=riweeklyinterval], input[name=rimonthlyinterval], input[name=riyearlyinterval]").change(function(e){0!==form.find(".rioccurrencesactions:visible").length&&updateOccurances()}),form.find(".ricancelbutton").click(cancel),form.find(".risavebutton").click(save),$.extend(self,{display:display,form:form,loadData:loadData,save:save})}$.tools=$.tools||{version:"@VERSION"};var tool,LABELS={};tool=$.tools.recurrenceinput={conf:{lang:"en",readOnly:!1,firstDay:0,startField:null,startFieldYear:null,startFieldMonth:null,startFieldDay:null,ajaxURL:null,ajaxContentType:"application/json; charset=utf8",ributtonExtraClass:"",hasRepeatForeverButton:!0,formOverlay:{speed:"fast",fixed:!1},template:{form:"#jquery-recurrenceinput-form-tmpl",display:"#jquery-recurrenceinput-display-tmpl"},rtemplate:{daily:{rrule:"FREQ=DAILY",fields:["ridailyinterval","rirangeoptions"]},mondayfriday:{rrule:"FREQ=WEEKLY;BYDAY=MO,FR",fields:["rirangeoptions"]},weekdays:{rrule:"FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR",fields:["rirangeoptions"]},weekly:{rrule:"FREQ=WEEKLY",fields:["riweeklyinterval","riweeklyweekdays","rirangeoptions"]},monthly:{rrule:"FREQ=MONTHLY",fields:["rimonthlyinterval","rimonthlyoptions","rirangeoptions"]},yearly:{rrule:"FREQ=YEARLY",fields:["riyearlyinterval","riyearlyoptions","rirangeoptions"]}}},localize:function(language,labels){LABELS[language]=labels},setTemplates:function(templates,titles){var lang,template;tool.conf.rtemplate=templates;for(lang in titles)if(titles.hasOwnProperty(lang))for(template in titles[lang])titles[lang].hasOwnProperty(template)&&(LABELS[lang].rtemplate[template]=titles[lang][template])}},tool.localize("en",{displayUnactivate:"Does not repeat",displayActivate:"Repeats every",add_rules:"Add",edit_rules:"Edit",delete_rules:"Delete",add:"Add",refresh:"Refresh",title:"Repeat",preview:"Selected dates",addDate:"Add date",recurrenceType:"Repeats:",dailyInterval1:"Repeat every:",dailyInterval2:"days",weeklyInterval1:"Repeat every:",weeklyInterval2:"week(s)",weeklyWeekdays:"Repeat on:",weeklyWeekdaysHuman:"on:",monthlyInterval1:"Repeat every:",monthlyInterval2:"month(s)",monthlyDayOfMonth1:"Day",monthlyDayOfMonth1Human:"on day",monthlyDayOfMonth2:"of the month",monthlyDayOfMonth3:"month(s)",monthlyWeekdayOfMonth1:"The",monthlyWeekdayOfMonth1Human:"on the",monthlyWeekdayOfMonth2:"",monthlyWeekdayOfMonth3:"of the month",monthlyRepeatOn:"Repeat on:",yearlyInterval1:"Repeat every:",yearlyInterval2:"year(s)",yearlyDayOfMonth1:"Every",yearlyDayOfMonth1Human:"on",yearlyDayOfMonth2:"",yearlyDayOfMonth3:"",yearlyWeekdayOfMonth1:"The",yearlyWeekdayOfMonth1Human:"on the",yearlyWeekdayOfMonth2:"",yearlyWeekdayOfMonth3:"of",yearlyWeekdayOfMonth4:"",yearlyRepeatOn:"Repeat on:",range:"End recurrence:",rangeNoEnd:"Never",rangeByOccurrences1:"After",rangeByOccurrences1Human:"ends after",rangeByOccurrences2:"occurrence(s)",rangeByEndDate:"On",rangeByEndDateHuman:"ends on",including:", and also",except:", except for",cancel:"Cancel",save:"Save",recurrenceStart:"Start of the recurrence",additionalDate:"Additional date",include:"Include",exclude:"Exclude",remove:"Remove",orderIndexes:["first","second","third","fourth","last"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortWeekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDateFormat:"mmmm dd, yyyy",shortDateFormat:"mm/dd/yyyy",unsupportedFeatures:"Warning: This event uses recurrence features not supported by this widget. Saving the recurrence may change the recurrence in unintended ways:",noTemplateMatch:"No matching recurrence template",multipleDayOfMonth:"This widget does not support multiple days in monthly or yearly recurrence",bysetpos:"BYSETPOS is not supported",noRule:"No RRULE in RRULE data",noRepeatEvery:'Error: The "Repeat every"-field must be between 1 and 1000',noEndDate:"Error: End date is not set. Please set a correct value",noRepeatOn:'Error: "Repeat on"-value must be selected',pastEndDate:"Error: End date cannot be before start date",noEndAfterNOccurrences:'Error: The "After N occurrences"-field must be between 1 and 1000',alreadyAdded:"This date was already added",rtemplate:{daily:"Daily",mondayfriday:"Monday and Friday",weekdays:"Weekday",weekly:"Weekly",monthly:"Monthly",yearly:"Yearly"}});var OCCURRENCETMPL=['<div class="rioccurrences">',"{{each occurrences}}",'<div class="occurrence ${occurrences[$index].type}">',"<span>","${occurrences[$index].formattedDate}",'{{if occurrences[$index].type === "start"}}','<span class="rlabel">${i18n.recurrenceStart}</span>',"{{/if}}",'{{if occurrences[$index].type === "rdate"}}','<span class="rlabel">${i18n.additionalDate}</span>',"{{/if}}","</span>","{{if !readOnly}}",'<span class="action">','{{if occurrences[$index].type === "rrule"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.exclude}">',"${i18n.exclude}","</a>","{{/if}}",'{{if occurrences[$index].type === "rdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.remove}" >',"${i18n.remove}","</a>","{{/if}}",'{{if occurrences[$index].type === "exdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.include}">',"${i18n.include}","</a>","{{/if}}","</span>","{{/if}}","</div>","{{/each}}",'<div class="batching">',"{{each batch.batches}}",'{{if $index === batch.currentBatch}}<span class="current">{{/if}}','<a href="#" start="${batch.batches[$index][0]}">[${batch.batches[$index][0]} - ${batch.batches[$index][1]}]</a>',"{{if $index === batch.currentBatch}}</span>{{/if}}","{{/each}}","</div></div>"].join("\n");
$.template("occurrenceTmpl",OCCURRENCETMPL);var DISPLAYTMPL=['<div class="ridisplay">','<div class="rimain">',"{{if !readOnly}}",'<button name="riedit">${i18n.add_rules}</button>','<button name="ridelete" style="display:none">${i18n.delete_rules}</button>',"{{/if}}",'<label class="ridisplay">${i18n.displayUnactivate}</label>',"</div>",'<div class="rioccurrences" style="display:none" /></div>'].join("\n");$.template("displayTmpl",DISPLAYTMPL);var FORMTMPL=['<div class="riform">',"<form>","<h1>${i18n.title}</h1>",'<div id="messagearea" style="display: none;">',"</div>",'<div id="rirtemplate">','<label for="${name}rtemplate" class="label">',"${i18n.recurrenceType}","</label>",'<select id="rirtemplate" name="rirtemplate" class="field">',"{{each rtemplate}}",'<option value="${$index}">${i18n.rtemplate[$index]}</value>',"{{/each}}","</select>","<div>",'<div id="riformfields">','<div id="ridailyinterval" class="rifield">','<label for="${name}dailyinterval" class="label">',"${i18n.dailyInterval1}","</label>",'<div class="field">','<input type="text" size="2"','value="1"','name="ridailyinterval"','id="${name}dailyinterval" />',"${i18n.dailyInterval2}","</div>","</div>",'<div id="riweeklyinterval" class="rifield">','<label for="${name}weeklyinterval" class="label">',"${i18n.weeklyInterval1}","</label>",'<div class="field">','<input type="text" size="2"','value="1"','name="riweeklyinterval"','id="${name}weeklyinterval"/>',"${i18n.weeklyInterval2}","</div>","</div>",'<div id="riweeklyweekdays" class="rifield">','<label for="${name}weeklyinterval" class="label">${i18n.weeklyWeekdays}</label>','<div class="field">',"{{each orderedWeekdays}}",'<div class="riweeklyweekday">','<input type="checkbox"','name="riweeklyweekdays${weekdays[$value]}"','id="${name}weeklyWeekdays${weekdays[$value]}"','value="${weekdays[$value]}" />','<label for="${name}weeklyWeekdays${weekdays[$value]}">${i18n.shortWeekdays[$value]}</label>',"</div>","{{/each}}","</div>","</div>",'<div id="rimonthlyinterval" class="rifield">','<label for="rimonthlyinterval" class="label">${i18n.monthlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="rimonthlyinterval"/>',"${i18n.monthlyInterval2}","</div>","</div>",'<div id="rimonthlyoptions" class="rifield">','<label for="rimonthlytype" class="label">${i18n.monthlyRepeatOn}</label>','<div class="field">',"<div>","<input",'type="radio"','value="DAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:DAYOFMONTH" />','<label for="${name}monthlytype:DAYOFMONTH">',"${i18n.monthlyDayOfMonth1}","</label>",'<select name="rimonthlydayofmonthday"','id="${name}monthlydayofmonthday">',"{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,","18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}",'<option value="${$value}">${$value}</option>',"{{/each}}","</select>","${i18n.monthlyDayOfMonth2}","</div>","<div>","<input",'type="radio"','value="WEEKDAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:WEEKDAYOFMONTH" />','<label for="${name}monthlytype:WEEKDAYOFMONTH">',"${i18n.monthlyWeekdayOfMonth1}","</label>",'<select name="rimonthlyweekdayofmonthindex">',"{{each i18n.orderIndexes}}",'<option value="${orderIndexes[$index]}">${$value}</option>',"{{/each}}","</select>","${i18n.monthlyWeekdayOfMonth2}",'<select name="rimonthlyweekdayofmonth">',"{{each orderedWeekdays}}",'<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>',"{{/each}}","</select>","${i18n.monthlyWeekdayOfMonth3}","</div>","</div>","</div>",'<div id="riyearlyinterval" class="rifield">','<label for="riyearlyinterval" class="label">${i18n.yearlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="riyearlyinterval"/>',"${i18n.yearlyInterval2}","</div>","</div>",'<div id="riyearlyoptions" class="rifield">','<label for="riyearlyType" class="label">${i18n.yearlyRepeatOn}</label>','<div class="field">',"<div>","<input",'type="radio"','value="DAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:DAYOFMONTH" />','<label for="${name}yearlytype:DAYOFMONTH">',"${i18n.yearlyDayOfMonth1}","</label>",'<select name="riyearlydayofmonthmonth">',"{{each i18n.months}}",'<option value="${$index+1}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyDayOfMonth2}",'<select name="riyearlydayofmonthday">',"{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,","18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}",'<option value="${$value}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyDayOfMonth3}","</div>","<div>","<input",'type="radio"','value="WEEKDAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:WEEKDAYOFMONTH"/>','<label for="${name}yearlytype:WEEKDAYOFMONTH">',"${i18n.yearlyWeekdayOfMonth1}","</label>",'<select name="riyearlyweekdayofmonthindex">',"{{each i18n.orderIndexes}}",'<option value="${orderIndexes[$index]}">${$value}</option>',"{{/each}}","</select>",'<label for="${name}yearlytype:WEEKDAYOFMONTH">',"${i18n.yearlyWeekdayOfMonth2}","</label>",'<select name="riyearlyweekdayofmonthday">',"{{each orderedWeekdays}}",'<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>',"{{/each}}","</select>","${i18n.yearlyWeekdayOfMonth3}",'<select name="riyearlyweekdayofmonthmonth">',"{{each i18n.months}}",'<option value="${$index+1}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyWeekdayOfMonth4}","</div>","</div>","</div>",'<div id="rirangeoptions" class="rifield">','<label class="label">${i18n.range}</label>','<div class="field">',"{{if hasRepeatForeverButton}}","<div>","<input",'type="radio"','value="NOENDDATE"','name="rirangetype"','id="${name}rangetype:NOENDDATE"/>','<label for="${name}rangetype:NOENDDATE">',"${i18n.rangeNoEnd}","</label>","</div>","{{/if}}","<div>","<input",'type="radio"','checked="checked"','value="BYOCCURRENCES"','name="rirangetype"','id="${name}rangetype:BYOCCURRENCES"/>','<label for="${name}rangetype:BYOCCURRENCES">',"${i18n.rangeByOccurrences1}","</label>","<input",'type="text" size="3"','value="7"','name="rirangebyoccurrencesvalue" />',"${i18n.rangeByOccurrences2}","</div>","<div>","<input",'type="radio"','value="BYENDDATE"','name="rirangetype"','id="${name}rangetype:BYENDDATE"/>','<label for="${name}rangetype:BYENDDATE">',"${i18n.rangeByEndDate}","</label>","<input",'type="date"','name="rirangebyenddatecalendar" />',"</div>","</div>","</div>","</div>",'<div class="rioccurrencesactions">','<div class="rioccurancesheader">',"<h2>${i18n.preview}</h2>",'<span class="refreshbutton action">','<a class="rirefreshbutton" href="#" title="${i18n.refresh}">',"${i18n.refresh}","</a>","</span>","</div>","</div>",'<div class="rioccurrences">',"</div>",'<div class="rioccurrencesactions">','<div class="rioccurancesheader">',"<h2>${i18n.addDate}</h2>","</div>",'<div class="riaddoccurrence">','<div class="errorarea"></div>','<input type="date" name="adddate" id="adddate" />','<input type="button" name="addaction" id="addaction" value="${i18n.add}">',"</div>","</div>",'<div class="ributtons">',"<input",'type="submit"','class="ricancelbutton ${ributtonExtraClass}"','value="${i18n.cancel}" />',"<input",'type="submit"','class="risavebutton ${ributtonExtraClass}"','value="${i18n.save}" />',"</div>","</form></div>"].join("\n");$.template("formTmpl",FORMTMPL);var Re=/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g;$.fn.recurrenceinput=function(conf){if(this.data("recurrenceinput"))return this.data("recurrenceinput");var config=$.extend({},tool.conf);$.extend(config,conf),$.extend(config,{i18n:LABELS[config.lang],name:this.attr("name")});var recurrenceinput=new RecurrenceInput(config,this);return recurrenceinput.form.appendTo("body"),this.after(recurrenceinput.display),this.hide(),this.data("recurrenceinput",recurrenceinput),recurrenceinput}}(jQuery)}.apply(root,arguments)})}(this),define("mockup-patterns-recurrence",["jquery","pat-base","jquery.recurrenceinput"],function($,Base){"use strict";var Recurrence=Base.extend({name:"recurrence",trigger:".pat-recurrence",parser:"mockup",defaults:{language:"en",localization:null,configuration:{}},init:function(){this.$el.addClass("recurrence-widget"),this.options.localization&&$.tools.recurrenceinput.localize(this.options.language,this.options.localization),this.$el.recurrenceinput(this.options.configuration)}});return Recurrence}),function(root,factory){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(_,$,exports){root.Backbone=factory(root,exports,_,$)});else if("undefined"!=typeof exports){var _=require("underscore");factory(root,exports,_)}else root.Backbone=factory(root,{},root._,root.jQuery||root.Zepto||root.ender||root.$)}(this,function(root,Backbone,_,$){var previousBackbone=root.Backbone,array=[],slice=(array.push,array.slice);array.splice;Backbone.VERSION="1.1.2",Backbone.$=$,Backbone.noConflict=function(){return root.Backbone=previousBackbone,this},Backbone.emulateHTTP=!1,Backbone.emulateJSON=!1;var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,"on",name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);return events.push({callback:callback,context:context,ctx:context||this}),this},once:function(name,callback,context){if(!eventsApi(this,"once",name,[callback,context])||!callback)return this;var self=this,once=_.once(function(){self.off(name,once),callback.apply(this,arguments)});return once._callback=callback,this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,"off",name,[callback,context]))return this;if(!name&&!callback&&!context)return this._events=void 0,this;for(names=name?[name]:_.keys(this._events),i=0,l=names.length;i<l;i++)if(name=names[i],events=this._events[name]){if(this._events[name]=retain=[],callback||context)for(j=0,k=events.length;j<k;j++)ev=events[j],(callback&&callback!==ev.callback&&callback!==ev.callback._callback||context&&context!==ev.context)&&retain.push(ev);retain.length||delete this._events[name]}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,"trigger",name,args))return this;var events=this._events[name],allEvents=this._events.all;return events&&triggerEvents(events,args),allEvents&&triggerEvents(allEvents,arguments),this},stopListening:function(obj,name,callback){var listeningTo=this._listeningTo;if(!listeningTo)return this;var remove=!name&&!callback;callback||"object"!=typeof name||(callback=this),obj&&((listeningTo={})[obj._listenId]=obj);for(var id in listeningTo)obj=listeningTo[id],obj.off(name,callback,this),(remove||_.isEmpty(obj._events))&&delete this._listeningTo[id];return this}},eventSplitter=/\s+/,eventsApi=function(obj,action,name,rest){if(!name)return!0;if("object"==typeof name){for(var key in name)obj[action].apply(obj,[key,name[key]].concat(rest));return!1}if(eventSplitter.test(name)){for(var names=name.split(eventSplitter),i=0,l=names.length;i<l;i++)obj[action].apply(obj,[names[i]].concat(rest));return!1}return!0},triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx);return;case 1:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:for(;++i<l;)(ev=events[i]).callback.apply(ev.ctx,args);return}},listenMethods={listenTo:"on",listenToOnce:"once"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeningTo=this._listeningTo||(this._listeningTo={}),id=obj._listenId||(obj._listenId=_.uniqueId("l"));return listeningTo[id]=obj,callback||"object"!=typeof name||(callback=this),obj[implementation](name,callback,this),this}}),Events.bind=Events.on,Events.unbind=Events.off,_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var attrs=attributes||{};options||(options={}),this.cid=_.uniqueId("c"),this.attributes={},options.collection&&(this.collection=options.collection),options.parse&&(attrs=this.parse(attrs,options)||{}),attrs=_.defaults({},attrs,_.result(this,"defaults")),this.set(attrs,options),this.changed={},this.initialize.apply(this,arguments)};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(options){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return null!=this.get(attr)},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(null==key)return this;if("object"==typeof key?(attrs=key,options=val):(attrs={})[key]=val,options||(options={}),!this._validate(attrs,options))return!1;unset=options.unset,silent=options.silent,changes=[],changing=this._changing,this._changing=!0,changing||(this._previousAttributes=_.clone(this.attributes),this.changed={}),current=this.attributes,prev=this._previousAttributes,this.idAttribute in attrs&&(this.id=attrs[this.idAttribute]);for(attr in attrs)val=attrs[attr],_.isEqual(current[attr],val)||changes.push(attr),_.isEqual(prev[attr],val)?delete this.changed[attr]:this.changed[attr]=val,unset?delete current[attr]:current[attr]=val;if(!silent){changes.length&&(this._pending=options);for(var i=0,l=changes.length;i<l;i++)this.trigger("change:"+changes[i],this,current[changes[i]],options)}if(changing)return this;if(!silent)for(;this._pending;)options=this._pending,this._pending=!1,this.trigger("change",this,options);return this._pending=!1,this._changing=!1,this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:!0}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:!0}))},hasChanged:function(attr){return null==attr?!_.isEmpty(this.changed):_.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return!!this.hasChanged()&&_.clone(this.changed);var val,changed=!1,old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff)_.isEqual(old[attr],val=diff[attr])||((changed||(changed={}))[attr]=val);return changed},previous:function(attr){return null!=attr&&this._previousAttributes?this._previousAttributes[attr]:null},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{},void 0===options.parse&&(options.parse=!0);var model=this,success=options.success;return options.success=function(resp){return!!model.set(model.parse(resp,options),options)&&(success&&success(model,resp,options),void model.trigger("sync",model,resp,options))},wrapError(this,options),this.sync("read",this,options)},save:function(key,val,options){var attrs,method,xhr,attributes=this.attributes;if(null==key||"object"==typeof key?(attrs=key,options=val):(attrs={})[key]=val,options=_.extend({validate:!0},options),attrs&&!options.wait){if(!this.set(attrs,options))return!1}else if(!this._validate(attrs,options))return!1;attrs&&options.wait&&(this.attributes=_.extend({},attributes,attrs)),void 0===options.parse&&(options.parse=!0);var model=this,success=options.success;return options.success=function(resp){model.attributes=attributes;var serverAttrs=model.parse(resp,options);return options.wait&&(serverAttrs=_.extend(attrs||{},serverAttrs)),!(_.isObject(serverAttrs)&&!model.set(serverAttrs,options))&&(success&&success(model,resp,options),void model.trigger("sync",model,resp,options))},wrapError(this,options),method=this.isNew()?"create":options.patch?"patch":"update","patch"===method&&(options.attrs=attrs),xhr=this.sync(method,this,options),attrs&&options.wait&&(this.attributes=attributes),xhr},destroy:function(options){options=options?_.clone(options):{};var model=this,success=options.success,destroy=function(){model.trigger("destroy",model,model.collection,options)};if(options.success=function(resp){(options.wait||model.isNew())&&destroy(),success&&success(model,resp,options),model.isNew()||model.trigger("sync",model,resp,options)},this.isNew())return options.success(),!1;wrapError(this,options);var xhr=this.sync("delete",this,options);return options.wait||destroy(),xhr},url:function(){var base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();return this.isNew()?base:base.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(options){return this._validate({},_.extend(options||{},{validate:!0}))},_validate:function(attrs,options){if(!options.validate||!this.validate)return!0;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;return!error||(this.trigger("invalid",this,error,_.extend(options,{validationError:error})),!1)}});var modelMethods=["keys","values","pairs","invert","pick","omit"];_.each(modelMethods,function(method){Model.prototype[method]=function(){var args=slice.call(arguments);return args.unshift(this.attributes),_[method].apply(_,args)}});var Collection=Backbone.Collection=function(models,options){options||(options={}),options.model&&(this.model=options.model),void 0!==options.comparator&&(this.comparator=options.comparator),this._reset(),this.initialize.apply(this,arguments),models&&this.reset(models,_.extend({silent:!0},options))},setOptions={add:!0,remove:!0,merge:!0},addOptions={add:!0,remove:!1};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){return this.set(models,_.extend({merge:!1},options,addOptions))},remove:function(models,options){var singular=!_.isArray(models);models=singular?[models]:_.clone(models),options||(options={});var i,l,index,model;for(i=0,l=models.length;i<l;i++)model=models[i]=this.get(models[i]),model&&(delete this._byId[model.id],delete this._byId[model.cid],index=this.indexOf(model),this.models.splice(index,1),this.length--,options.silent||(options.index=index,model.trigger("remove",model,this,options)),this._removeReference(model,options));return singular?models[0]:models},set:function(models,options){options=_.defaults({},options,setOptions),options.parse&&(models=this.parse(models,options));var singular=!_.isArray(models);models=singular?models?[models]:[]:_.clone(models);var i,l,id,model,attrs,existing,sort,at=options.at,targetModel=this.model,sortable=this.comparator&&null==at&&options.sort!==!1,sortAttr=_.isString(this.comparator)?this.comparator:null,toAdd=[],toRemove=[],modelMap={},add=options.add,merge=options.merge,remove=options.remove,order=!(sortable||!add||!remove)&&[];for(i=0,l=models.length;i<l;i++){if(attrs=models[i]||{},id=attrs instanceof Model?model=attrs:attrs[targetModel.prototype.idAttribute||"id"],existing=this.get(id))remove&&(modelMap[existing.cid]=!0),merge&&(attrs=attrs===model?model.attributes:attrs,options.parse&&(attrs=existing.parse(attrs,options)),existing.set(attrs,options),sortable&&!sort&&existing.hasChanged(sortAttr)&&(sort=!0)),models[i]=existing;else if(add){if(model=models[i]=this._prepareModel(attrs,options),!model)continue;toAdd.push(model),this._addReference(model,options)}model=existing||model,!order||!model.isNew()&&modelMap[model.id]||order.push(model),modelMap[model.id]=!0}if(remove){for(i=0,l=this.length;i<l;++i)modelMap[(model=this.models[i]).cid]||toRemove.push(model);toRemove.length&&this.remove(toRemove,options)}if(toAdd.length||order&&order.length)if(sortable&&(sort=!0),this.length+=toAdd.length,null!=at)for(i=0,l=toAdd.length;i<l;i++)this.models.splice(at+i,0,toAdd[i]);else{order&&(this.models.length=0);var orderedModels=order||toAdd;for(i=0,l=orderedModels.length;i<l;i++)this.models.push(orderedModels[i])}if(sort&&this.sort({silent:!0}),!options.silent){for(i=0,l=toAdd.length;i<l;i++)(model=toAdd[i]).trigger("add",model,this,options);(sort||order&&order.length)&&this.trigger("sort",this,options)}return singular?models[0]:models},reset:function(models,options){options||(options={});for(var i=0,l=this.models.length;i<l;i++)this._removeReference(this.models[i],options);return options.previousModels=this.models,this._reset(),models=this.add(models,_.extend({silent:!0},options)),options.silent||this.trigger("reset",this,options),models},push:function(model,options){return this.add(model,_.extend({at:this.length},options))},pop:function(options){var model=this.at(this.length-1);return this.remove(model,options),model},unshift:function(model,options){return this.add(model,_.extend({at:0},options))},shift:function(options){var model=this.at(0);return this.remove(model,options),model},slice:function(){return slice.apply(this.models,arguments)},get:function(obj){if(null!=obj)return this._byId[obj]||this._byId[obj.id]||this._byId[obj.cid]},at:function(index){return this.models[index]},where:function(attrs,first){return _.isEmpty(attrs)?first?void 0:[]:this[first?"find":"filter"](function(model){for(var key in attrs)if(attrs[key]!==model.get(key))return!1;return!0})},findWhere:function(attrs){return this.where(attrs,!0)},sort:function(options){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return options||(options={}),_.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(_.bind(this.comparator,this)),options.silent||this.trigger("sort",this,options),this},pluck:function(attr){return _.invoke(this.models,"get",attr)},fetch:function(options){options=options?_.clone(options):{},void 0===options.parse&&(options.parse=!0);var success=options.success,collection=this;return options.success=function(resp){var method=options.reset?"reset":"set";collection[method](resp,options),success&&success(collection,resp,options),collection.trigger("sync",collection,resp,options)},wrapError(this,options),this.sync("read",this,options)},create:function(model,options){if(options=options?_.clone(options):{},!(model=this._prepareModel(model,options)))return!1;options.wait||this.add(model,options);var collection=this,success=options.success;return options.success=function(model,resp){options.wait&&collection.add(model,options),success&&success(model,resp,options)},model.save(null,options),model},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model)return attrs;options=options?_.clone(options):{},options.collection=this;var model=new this.model(attrs,options);return model.validationError?(this.trigger("invalid",this,model.validationError,options),!1):model},_addReference:function(model,options){this._byId[model.cid]=model,null!=model.id&&(this._byId[model.id]=model),model.collection||(model.collection=this),model.on("all",this._onModelEvent,this)},_removeReference:function(model,options){this===model.collection&&delete model.collection,model.off("all",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){("add"!==event&&"remove"!==event||collection===this)&&("destroy"===event&&this.remove(model,options),model&&event==="change:"+model.idAttribute&&(delete this._byId[model.previous(model.idAttribute)],null!=model.id&&(this._byId[model.id]=model)),this.trigger.apply(this,arguments))}});var methods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);return args.unshift(this.models),_[method].apply(_,args)}});var attributeMethods=["groupBy","countBy","sortBy","indexBy"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var View=Backbone.View=function(options){this.cid=_.uniqueId("view"),options||(options={}),_.extend(this,_.pick(options,viewOptions)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},delegateEventSplitter=/^(\S+)\s*(.*)$/,viewOptions=["model","collection","el","id","attributes","className","tagName","events"];_.extend(View.prototype,Events,{tagName:"div",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(element,delegate){return this.$el&&this.undelegateEvents(),this.$el=element instanceof Backbone.$?element:Backbone.$(element),this.el=this.$el[0],delegate!==!1&&this.delegateEvents(),this},delegateEvents:function(events){if(!events&&!(events=_.result(this,"events")))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(_.isFunction(method)||(method=this[events[key]]),method){var match=key.match(delegateEventSplitter),eventName=match[1],selector=match[2];method=_.bind(method,this),eventName+=".delegateEvents"+this.cid,""===selector?this.$el.on(eventName,method):this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(_.result(this,"el"),!1);else{var attrs=_.extend({},_.result(this,"attributes"));this.id&&(attrs.id=_.result(this,"id")),this.className&&(attrs["class"]=_.result(this,"className"));var $el=Backbone.$("<"+_.result(this,"tagName")+">").attr(attrs);this.setElement($el,!1)}}}),Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:"json"};if(options.url||(params.url=_.result(model,"url")||urlError()),null!=options.data||!model||"create"!==method&&"update"!==method&&"patch"!==method||(params.contentType="application/json",params.data=JSON.stringify(options.attrs||model.toJSON(options))),options.emulateJSON&&(params.contentType="application/x-www-form-urlencoded",params.data=params.data?{model:params.data}:{}),options.emulateHTTP&&("PUT"===type||"DELETE"===type||"PATCH"===type)){params.type="POST",options.emulateJSON&&(params.data._method=type);var beforeSend=options.beforeSend;options.beforeSend=function(xhr){if(xhr.setRequestHeader("X-HTTP-Method-Override",type),beforeSend)return beforeSend.apply(this,arguments)}}"GET"===params.type||options.emulateJSON||(params.processData=!1),"PATCH"===params.type&&noXhrPatch&&(params.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var xhr=options.xhr=Backbone.ajax(_.extend(params,options));return model.trigger("request",model,xhr,options),xhr};var noXhrPatch=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var Router=Backbone.Router=function(options){options||(options={}),options.routes&&(this.routes=options.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},optionalParam=/\((.*?)\)/g,namedParam=/(\(\?)?:\w+/g,splatParam=/\*\w+/g,escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){_.isRegExp(route)||(route=this._routeToRegExp(route)),_.isFunction(name)&&(callback=name,name=""),callback||(callback=this[name]);var router=this;return Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);router.execute(callback,args),router.trigger.apply(router,["route:"+name].concat(args)),router.trigger("route",name,args),Backbone.history.trigger("route",router,name,args)}),this},execute:function(callback,args){callback&&callback.apply(this,args)},navigate:function(fragment,options){return Backbone.history.navigate(fragment,options),this},_bindRoutes:function(){if(this.routes){this.routes=_.result(this,"routes");for(var route,routes=_.keys(this.routes);null!=(route=routes.pop());)this.route(route,this.routes[route])}},_routeToRegExp:function(route){return route=route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,function(match,optional){return optional?match:"([^/?]+)"}).replace(splatParam,"([^?]*?)"),new RegExp("^"+route+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param,i){return i===params.length-1?param||null:param?decodeURIComponent(param):null})}});var History=Backbone.History=function(){this.handlers=[],_.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},routeStripper=/^[#\/]|\s+$/g,rootStripper=/^\/+|\/+$/g,isExplorer=/msie [\w.]+/,trailingSlash=/\/$/,pathStripper=/#.*$/;History.started=!1,_.extend(History.prototype,Events,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:""},getFragment:function(fragment,forcePushState){if(null==fragment)if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=decodeURI(this.location.pathname+this.location.search);var root=this.root.replace(trailingSlash,"");fragment.indexOf(root)||(fragment=fragment.slice(root.length))}else fragment=this.getHash();return fragment.replace(routeStripper,"")},start:function(options){if(History.started)throw new Error("Backbone.history has already been started");History.started=!0,this.options=_.extend({root:"/"},this.options,options),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment(),docMode=document.documentMode,oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7);if(this.root=("/"+this.root+"/").replace(rootStripper,"/"),oldIE&&this._wantsHashChange){var frame=Backbone.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=frame.hide().appendTo("body")[0].contentWindow,this.navigate(fragment)}this._hasPushState?Backbone.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!oldIE?Backbone.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=fragment;var loc=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&loc.hash&&(this.fragment=this.getHash().replace(routeStripper,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){Backbone.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),History.started=!1},route:function(route,callback){this.handlers.unshift({
route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();return current===this.fragment&&this.iframe&&(current=this.getFragment(this.getHash(this.iframe))),current!==this.fragment&&(this.iframe&&this.navigate(current),void this.loadUrl())},loadUrl:function(fragment){return fragment=this.fragment=this.getFragment(fragment),_.any(this.handlers,function(handler){if(handler.route.test(fragment))return handler.callback(fragment),!0})},navigate:function(fragment,options){if(!History.started)return!1;options&&options!==!0||(options={trigger:!!options});var url=this.root+(fragment=this.getFragment(fragment||""));if(fragment=fragment.replace(pathStripper,""),this.fragment!==fragment){if(this.fragment=fragment,""===fragment&&"/"!==url&&(url=url.slice(0,-1)),this._hasPushState)this.history[options.replace?"replaceState":"pushState"]({},document.title,url);else{if(!this._wantsHashChange)return this.location.assign(url);this._updateHash(this.location,fragment,options.replace),this.iframe&&fragment!==this.getFragment(this.getHash(this.iframe))&&(options.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,fragment,options.replace))}return options.trigger?this.loadUrl(fragment):void 0}},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,"");location.replace(href+"#"+fragment)}else location.hash="#"+fragment}}),Backbone.history=new History;var extend=function(protoProps,staticProps){var child,parent=this;child=protoProps&&_.has(protoProps,"constructor")?protoProps.constructor:function(){return parent.apply(this,arguments)},_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};return Surrogate.prototype=parent.prototype,child.prototype=new Surrogate,protoProps&&_.extend(child.prototype,protoProps),child.__super__=parent.prototype,child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified')},wrapError=function(model,options){var error=options.error;options.error=function(resp){error&&error(model,resp,options),model.trigger("error",model,resp,options)}};return Backbone}),define("mockup-ui-url/views/base",["jquery","underscore","backbone","translate"],function($,_,Backbone,_t){"use strict";var BaseView=Backbone.View.extend({isUIView:!0,eventPrefix:"ui",template:null,idPrefix:"base-",appendInContainer:!0,initialize:function(options){this.options=options;for(var key in this.options)this[key]=this.options[key];this.options._t=_t},render:function(){return this.applyTemplate(),this.trigger("render",this),this.afterRender(),this.options.id&&this.$el.attr("id",this.idPrefix+this.options.id),this},afterRender:function(){},serializedModel:function(){return this.options},applyTemplate:function(){if(null!==this.template){var data=$.extend({_t:_t},this.options,this.serializedModel()),template=this.template;"string"==typeof template&&(template=_.template(template)),this.$el.html(template(data))}},propagateEvent:function(eventName){if(eventName.indexOf(":")>0){var eventId=eventName.split(":")[0];if(""!==this.eventPrefix&&(eventId===this.eventPrefix||eventId===this.eventPrefix+"."+this.id))return!0}return!1},uiEventTrigger:function(name){var args=[].slice.call(arguments,0);""!==this.eventPrefix&&(args[0]=this.eventPrefix+":"+name,Backbone.View.prototype.trigger.apply(this,args),this.id&&(args[0]=this.eventPrefix+"."+this.id+":"+name,Backbone.View.prototype.trigger.apply(this,args)))}});return BaseView}),define("mockup-patterns-tooltip",["jquery","pat-base"],function($,Base,undefined){"use strict";var bootstrapTooltip=function(element,options){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",element,options)};bootstrapTooltip.VERSION="3.2.0",bootstrapTooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip mockup-tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!0,container:!1,viewport:{selector:"body",padding:0}},bootstrapTooltip.prototype.init=function(type,element,options){this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.$viewport=this.options.viewport&&$(this.options.viewport.selector||this.options.viewport);for(var triggers=this.options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];if("click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},bootstrapTooltip.prototype.getDefaults=function(){return bootstrapTooltip.DEFAULTS},bootstrapTooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},bootstrapTooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},bootstrapTooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),clearTimeout(self.timeout),self.hoverState="in",self.options.delay&&self.options.delay.show?void(self.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show)):self.show()},bootstrapTooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),clearTimeout(self.timeout),self.hoverState="out",self.options.delay&&self.options.delay.hide?void(self.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide)):self.hide()},bootstrapTooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var inDom=$.contains(document.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!inDom)return;var that=this,$tip=this.tip(),tipId=this.getUID(this.type);this.setContent(),$tip.attr("id",tipId),this.$element.attr("aria-describedby",tipId),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement).data("bs."+this.type,this),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var orgPlacement=placement,$parent=this.$element.parent(),parentDim=this.getPosition($parent);placement="bottom"==placement&&pos.top+pos.height+actualHeight-parentDim.scroll>parentDim.height?"top":"top"==placement&&pos.top-parentDim.scroll-actualHeight<0?"bottom":"right"==placement&&pos.right+actualWidth>parentDim.width?"left":"left"==placement&&pos.left-actualWidth<parentDim.left?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement);var complete=function(){that.$element.trigger("shown.bs."+that.type),that.hoverState=null};$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(150):complete()}},bootstrapTooltip.prototype.applyPlacement=function(offset,placement){var $tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top=offset.top+marginTop,offset.left=offset.left+marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;"top"==placement&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight);var delta=this.getViewportAdjustedDelta(placement,offset,actualWidth,actualHeight);delta.left?offset.left+=delta.left:offset.top+=delta.top;var arrowDelta=delta.left?2*delta.left-width+actualWidth:2*delta.top-height+actualHeight,arrowPosition=delta.left?"left":"top",arrowOffsetPosition=delta.left?"offsetWidth":"offsetHeight";$tip.offset(offset),this.replaceArrow(arrowDelta,$tip[0][arrowOffsetPosition],arrowPosition)},bootstrapTooltip.prototype.replaceArrow=function(delta,dimension,position){this.arrow().css(position,delta?50*(1-delta/dimension)+"%":"")},bootstrapTooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},bootstrapTooltip.prototype.hide=function(){function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element.trigger("hidden.bs."+that.type)}var that=this,$tip=this.tip(),e=$.Event("hide.bs."+this.type);if(this.$element.removeAttr("aria-describedby"),this.$element.trigger(e),!e.isDefaultPrevented())return $tip.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(150):complete(),this.hoverState=null,this},bootstrapTooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},bootstrapTooltip.prototype.hasContent=function(){return this.getTitle()},bootstrapTooltip.prototype.getPosition=function($element){$element=$element||this.$element;var el=$element[0],isBody="BODY"==el.tagName;return $.extend({},"function"==typeof el.getBoundingClientRect?el.getBoundingClientRect():null,{scroll:isBody?document.documentElement.scrollTop||document.body.scrollTop:$element.scrollTop(),width:isBody?$(window).width():$element.outerWidth(),height:isBody?$(window).height():$element.outerHeight()},isBody?{top:0,left:0}:$element.offset())},bootstrapTooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},bootstrapTooltip.prototype.getViewportAdjustedDelta=function(placement,pos,actualWidth,actualHeight){var delta={top:0,left:0};if(!this.$viewport)return delta;var viewportPadding=this.options.viewport&&this.options.viewport.padding||0,viewportDimensions=this.getPosition(this.$viewport);if(/right|left/.test(placement)){var topEdgeOffset=pos.top-viewportPadding-viewportDimensions.scroll,bottomEdgeOffset=pos.top+viewportPadding-viewportDimensions.scroll+actualHeight;topEdgeOffset<viewportDimensions.top?delta.top=viewportDimensions.top-topEdgeOffset:bottomEdgeOffset>viewportDimensions.top+viewportDimensions.height&&(delta.top=viewportDimensions.top+viewportDimensions.height-bottomEdgeOffset)}else{var leftEdgeOffset=pos.left-viewportPadding,rightEdgeOffset=pos.left+viewportPadding+actualWidth;leftEdgeOffset<viewportDimensions.left?delta.left=viewportDimensions.left-leftEdgeOffset:rightEdgeOffset>viewportDimensions.width&&(delta.left=viewportDimensions.left+viewportDimensions.width-rightEdgeOffset)}return delta},bootstrapTooltip.prototype.getTitle=function(){var title,$e=this.$element,o=this.options;return title=$e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},bootstrapTooltip.prototype.getUID=function(prefix){do prefix+=~~(1e6*Math.random());while(document.getElementById(prefix));return prefix},bootstrapTooltip.prototype.tip=function(){return this.$tip=this.$tip||$(this.options.template)},bootstrapTooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},bootstrapTooltip.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},bootstrapTooltip.prototype.enable=function(){this.enabled=!0},bootstrapTooltip.prototype.disable=function(){this.enabled=!1},bootstrapTooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},bootstrapTooltip.prototype.toggle=function(e){var self=this;e&&(self=$(e.currentTarget).data("bs."+this.type),self||(self=new this.constructor(e.currentTarget,this.getDelegateOptions()),$(e.currentTarget).data("bs."+this.type,self))),self.tip().hasClass("in")?self.leave(self):self.enter(self)},bootstrapTooltip.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var Tooltip=Base.extend({name:"tooltip",trigger:".pat-tooltip",parser:"mockup",defaults:{html:!1,placement:"top"},init:function(){"true"===this.options.html?this.options.html=!0:this.options.html=!1,this.data=new bootstrapTooltip(this.$el[0],this.options)}});return Tooltip}),define("mockup-ui-url/views/button",["underscore","mockup-ui-url/views/base","mockup-patterns-tooltip"],function(_,BaseView,Tooltip){"use strict";var ButtonView=BaseView.extend({tagName:"a",className:"btn",eventPrefix:"button",context:"default",idPrefix:"btn-",attributes:{href:"#"},extraClasses:[],tooltip:null,template:'<% if (icon) { %><span class="glyphicon glyphicon-<%= icon %>"></span><% } %> <%= title %>',events:{click:"handleClick"},initialize:function(options){if(!options.id){var title=options.title||"";options.id=""!==title?title.toLowerCase().replace(" ","-"):this.cid}BaseView.prototype.initialize.apply(this,[options]),this.on("disable",function(){this.disable()},this),this.on("enable",function(){this.enable()},this),this.on("render",function(){if(this.$el.attr("title",this.options.title||""),this.$el.attr("aria-label",this.options.title||this.options.tooltip||""),null!==this.context&&this.$el.addClass("btn-"+this.context),_.each(this.extraClasses,function(klass){this.$el.addClass(klass)}),null!==this.tooltip){this.$el.attr("title",this.tooltip);new Tooltip(this.$el);this.$el.on("hidden",function(e){"hidden"===e.type&&e.stopPropagation()})}},this)},handleClick:function(e){e.preventDefault(),this.$el.is(".disabled")||this.uiEventTrigger("click",this,e)},serializedModel:function(){return _.extend({icon:"",title:""},this.options)},disable:function(){this.options.disabled=!0,this.$el.addClass("disabled")},enable:function(){this.options.disabled=!1,this.$el.removeClass("disabled")}});return ButtonView}),define("text",["module"],function(module){"use strict";function useDefault(value,defaultValue){return void 0===value||""===value?defaultValue:value}function isSamePort(protocol1,port1,protocol2,port2){if(port1===port2)return!0;if(protocol1===protocol2){if("http"===protocol1)return useDefault(port1,"80")===useDefault(port2,"80");if("https"===protocol1)return useDefault(port1,"443")===useDefault(port2,"443")}return!1}var text,fs,Cc,Ci,xpcIsWindows,progIds=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],xmlRegExp=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,bodyRegExp=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,hasLocation="undefined"!=typeof location&&location.href,defaultProtocol=hasLocation&&location.protocol&&location.protocol.replace(/\:/,""),defaultHostName=hasLocation&&location.hostname,defaultPort=hasLocation&&(location.port||void 0),buildMap={},masterConfig=module.config&&module.config()||{};return text={version:"2.0.15",strip:function(content){if(content){content=content.replace(xmlRegExp,"");var matches=content.match(bodyRegExp);matches&&(content=matches[1])}else content="";return content},jsEscape:function(content){return content.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:masterConfig.createXhr||function(){var xhr,i,progId;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(i=0;i<3;i+=1){progId=progIds[i];try{xhr=new ActiveXObject(progId)}catch(e){}if(xhr){progIds=[progId];break}}return xhr},parseName:function(name){var modName,ext,temp,strip=!1,index=name.lastIndexOf("."),isRelative=0===name.indexOf("./")||0===name.indexOf("../");return index!==-1&&(!isRelative||index>1)?(modName=name.substring(0,index),ext=name.substring(index+1)):modName=name,temp=ext||modName,index=temp.indexOf("!"),index!==-1&&(strip="strip"===temp.substring(index+1),temp=temp.substring(0,index),ext?ext=temp:modName=temp),{moduleName:modName,ext:ext,strip:strip}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(url,protocol,hostname,port){var uProtocol,uHostName,uPort,match=text.xdRegExp.exec(url);return!match||(uProtocol=match[2],uHostName=match[3],uHostName=uHostName.split(":"),uPort=uHostName[1],uHostName=uHostName[0],(!uProtocol||uProtocol===protocol)&&(!uHostName||uHostName.toLowerCase()===hostname.toLowerCase())&&(!uPort&&!uHostName||isSamePort(uProtocol,uPort,protocol,port)))},finishLoad:function(name,strip,content,onLoad){content=strip?text.strip(content):content,masterConfig.isBuild&&(buildMap[name]=content),onLoad(content)},load:function(name,req,onLoad,config){if(config&&config.isBuild&&!config.inlineText)return void onLoad();masterConfig.isBuild=config&&config.isBuild;var parsed=text.parseName(name),nonStripName=parsed.moduleName+(parsed.ext?"."+parsed.ext:""),url=req.toUrl(nonStripName),useXhr=masterConfig.useXhr||text.useXhr;return 0===url.indexOf("empty:")?void onLoad():void(!hasLocation||useXhr(url,defaultProtocol,defaultHostName,defaultPort)?text.get(url,function(content){text.finishLoad(name,parsed.strip,content,onLoad)},function(err){onLoad.error&&onLoad.error(err)}):req([nonStripName],function(content){text.finishLoad(parsed.moduleName+"."+parsed.ext,parsed.strip,content,onLoad)}))},write:function(pluginName,moduleName,write,config){if(buildMap.hasOwnProperty(moduleName)){var content=text.jsEscape(buildMap[moduleName]);write.asModule(pluginName+"!"+moduleName,"define(function () { return '"+content+"';});\n")}},writeFile:function(pluginName,moduleName,req,write,config){var parsed=text.parseName(moduleName),extPart=parsed.ext?"."+parsed.ext:"",nonStripName=parsed.moduleName+extPart,fileName=req.toUrl(parsed.moduleName+extPart)+".js";text.load(nonStripName,req,function(value){var textWrite=function(contents){return write(fileName,contents)};textWrite.asModule=function(moduleName,contents){return write.asModule(moduleName,fileName,contents)},text.write(pluginName,nonStripName,textWrite,config)},config)}},"node"===masterConfig.env||!masterConfig.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(fs=require.nodeRequire("fs"),text.get=function(url,callback,errback){try{var file=fs.readFileSync(url,"utf8");"\ufeff"===file[0]&&(file=file.substring(1)),callback(file)}catch(e){errback&&errback(e)}}):"xhr"===masterConfig.env||!masterConfig.env&&text.createXhr()?text.get=function(url,callback,errback,headers){var header,xhr=text.createXhr();if(xhr.open("GET",url,!0),headers)for(header in headers)headers.hasOwnProperty(header)&&xhr.setRequestHeader(header.toLowerCase(),headers[header]);masterConfig.onXhr&&masterConfig.onXhr(xhr,url),xhr.onreadystatechange=function(evt){var status,err;4===xhr.readyState&&(status=xhr.status||0,status>399&&status<600?(err=new Error(url+" HTTP status: "+status),err.xhr=xhr,errback&&errback(err)):callback(xhr.responseText),masterConfig.onXhrComplete&&masterConfig.onXhrComplete(xhr,url))},xhr.send(null)}:"rhino"===masterConfig.env||!masterConfig.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?text.get=function(url,callback){var stringBuffer,line,encoding="utf-8",file=new java.io.File(url),lineSeparator=java.lang.System.getProperty("line.separator"),input=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file),encoding)),content="";try{for(stringBuffer=new java.lang.StringBuffer,line=input.readLine(),line&&line.length()&&65279===line.charAt(0)&&(line=line.substring(1)),null!==line&&stringBuffer.append(line);null!==(line=input.readLine());)stringBuffer.append(lineSeparator),stringBuffer.append(line);content=String(stringBuffer.toString())}finally{input.close()}callback(content)}:("xpconnect"===masterConfig.env||!masterConfig.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(Cc=Components.classes,Ci=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),xpcIsWindows="@mozilla.org/windows-registry-key;1"in Cc,text.get=function(url,callback){var inStream,convertStream,fileObj,readData={};xpcIsWindows&&(url=url.replace(/\//g,"\\")),fileObj=new FileUtils.File(url);try{inStream=Cc["@mozilla.org/network/file-input-stream;1"].createInstance(Ci.nsIFileInputStream),inStream.init(fileObj,1,0,!1),convertStream=Cc["@mozilla.org/intl/converter-input-stream;1"].createInstance(Ci.nsIConverterInputStream),convertStream.init(inStream,"utf-8",inStream.available(),Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),convertStream.readString(inStream.available(),readData),convertStream.close(),inStream.close(),callback(readData.value)}catch(e){throw new Error((fileObj&&fileObj.path||"")+": "+e)}}),text}),define("text!mockup-patterns-relateditems-url/templates/breadcrumb.xml",[],function(){return'<span class="separator">/<span>\n<a href="<%- path %>" class="crumb"><%- text %></a>\n'}),define("text!mockup-patterns-relateditems-url/templates/favorite.xml",[],function(){return'<li><a href="<%- path %>" class="fav" aria-labelledby="blip"><%- title %></a></li>\n'}),define("text!mockup-patterns-relateditems-url/templates/result.xml",[],function(){return'<div class="pattern-relateditems-result">\n  <a href="#" class=" pattern-relateditems-result-select <% if (selectable) { %>selectable<% } %>">\n    <% if (typeof getURL !== \'undefined\' && ((typeof getIcon !== \'undefined\' && getIcon === true) || portal_type === "Image")) { %><img src="<%- getURL %>/@@images/image/icon "><br><% } %>\n    <span class="pattern-relateditems-result-title <% if (typeof review_state !== "undefined") { %> state-<%- review_state %> <% } %>  " /span>\n    <span class="pattern-relateditems contenttype-<%- portal_type.toLowerCase() %>"><%- Title %></span>\n    <span class="pattern-relateditems-result-path"><%- path %></span>\n  </a>\n  <span class="pattern-relateditems-buttons">\n  <% if (mode !== "search" && is_folderish) { %>\n     <a class="pattern-relateditems-result-browse" href="#" data-path="<%- path %>"></a>\n   <% } %>\n </span>\n</div>\n'}),define("text!mockup-patterns-relateditems-url/templates/selection.xml",[],function(){return'<span class="pattern-relateditems-item">\n  <% if (typeof getURL !== \'undefined\' && ((typeof getIcon !== \'undefined\' && getIcon === true) || portal_type === "Image")) { %><img src="<%- getURL %>/@@images/image/icon"><br><% } %>\n  <span class="pattern-relateditems-item-title contenttype-<%- portal_type.toLowerCase() %> <% if (typeof review_state !== "undefined") { %> state-<%- review_state  %> <% } %>" ><%- Title %></span>\n  <span class="pattern-relateditems-item-path"><%- path %></span>\n</span>\n'}),define("text!mockup-patterns-relateditems-url/templates/toolbar.xml",[],function(){return'<div class="btn-group mode-selector" role="group">\n  <button type="button" class="mode search btn <% if (mode=="search") { %>btn-primary<% } else {%>btn-default<% } %>"><%- searchModeText %></button>\n  <button type="button" class="mode browse btn <% if (mode=="browse") { %>btn-primary<% } else {%>btn-default<% } %>"><%- browseModeText %></button>\n</div>\n<div class="path-wrapper">\n  <span class="pattern-relateditems-path-label"><%- searchText %></span>\n  <a class="crumb" href="/"><span class="glyphicon glyphicon-home"/></a>\n  <%= items %>\n</div>\n<div class="controls pull-right">\n  <% if (favorites.length > 0) { %>\n  <div class="favorites dropdown pull-right">\n    <button type="button" class="favorites dropdown-toggle btn btn-primary" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n      <span class="glyphicon glyphicon-star"/>\n      <%- favText %>\n      <span class="caret"/>\n    </button>\n    <ul class="dropdown-menu">\n      <%= favItems %>\n    </ul>\n  </div>\n  <% } %>\n</div>\n'}),function(root){define("bootstrap-dropdown",["jquery"],function(){return function(){return+function($){"use strict";function getParent($this){var selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}function clearMenus(e){e&&3===e.which||($(backdrop).remove(),$(toggle).each(function(){var $this=$(this),$parent=getParent($this),relatedTarget={relatedTarget:this};$parent.hasClass("open")&&(e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&$.contains($parent[0],e.target)||($parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget)),e.isDefaultPrevented()||($this.attr("aria-expanded","false"),$parent.removeClass("open").trigger($.Event("hidden.bs.dropdown",relatedTarget)))))}))}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})}var backdrop=".dropdown-backdrop",toggle='[data-toggle="dropdown"]',Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.VERSION="3.3.6",Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$(document.createElement("div")).addClass("dropdown-backdrop").insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};if($parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget)),e.isDefaultPrevented())return;$this.trigger("focus").attr("aria-expanded","true"),$parent.toggleClass("open").trigger($.Event("shown.bs.dropdown",relatedTarget))}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive&&27!=e.which||isActive&&27==e.which)return 27==e.which&&$parent.find(toggle).trigger("focus"),$this.trigger("click");var desc=" li:not(.disabled):visible a",$items=$parent.find(".dropdown-menu"+desc);if($items.length){var index=$items.index(e.target);38==e.which&&index>0&&index--,40==e.which&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).trigger("focus")}}}};var old=$.fn.dropdown;$.fn.dropdown=Plugin,$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle,Dropdown.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",Dropdown.prototype.keydown)}(jQuery),window.jQuery.fn.dropdown.Constructor}.apply(root,arguments)})}(this),define("mockup-patterns-relateditems",["jquery","underscore","pat-base","mockup-patterns-select2","mockup-ui-url/views/button","mockup-utils","translate","text!mockup-patterns-relateditems-url/templates/breadcrumb.xml","text!mockup-patterns-relateditems-url/templates/favorite.xml","text!mockup-patterns-relateditems-url/templates/result.xml","text!mockup-patterns-relateditems-url/templates/selection.xml","text!mockup-patterns-relateditems-url/templates/toolbar.xml","bootstrap-dropdown"],function($,_,Base,Select2,ButtonView,utils,_t,BreadcrumbTemplate,FavoriteTemplate,ResultTemplate,SelectionTemplate,ToolbarTemplate){"use strict";var RelatedItems=Base.extend({name:"relateditems",trigger:".pat-relateditems",parser:"mockup",currentPath:void 0,openAfterInit:void 0,defaults:{vocabularyUrl:null,upload:!1,attributes:["UID","Title","portal_type","path","getURL","getIcon","is_folderish","review_state"],basePath:"",closeOnSelect:!0,dropdownCssClass:"pattern-relateditems-dropdown",favorites:[],maximumSelectionSize:-1,minimumInputLength:0,mode:"search",browsing:void 0,orderable:!0,rootPath:"/",rootUrl:"",pathOperator:"plone.app.querystring.operation.string.path",selectableTypes:null,separator:",",tokenSeparators:[","," "],width:"100%",breadcrumbTemplate:BreadcrumbTemplate,breadcrumbTemplateSelector:null,favoriteTemplate:FavoriteTemplate,favoriteTemplateSelector:null,resultTemplate:ResultTemplate,resultTemplateSelector:null,selectionTemplate:SelectionTemplate,selectionTemplateSelector:null,toolbarTemplate:ToolbarTemplate,toolbarTemplateSelector:null,multiple:!0},applyTemplate:function(tpl,item){var template,self=this;self.options[tpl+"TemplateSelector"]?(template=$(self.options[tpl+"TemplateSelector"]).html(),template||(template=self.options[tpl+"Template"])):template=self.options[tpl+"Template"];var options=$.extend(!0,{},self.options,item);return options._item=item,_.template(template)(options)},setQuery:function(){var baseCriteria=[];"search"==this.options.mode&&(this.options.selectableTypes&&baseCriteria.push({i:"portal_type",o:"plone.app.querystring.operation.selection.any",v:this.options.selectableTypes}),baseCriteria.push({i:"path",o:this.options.pathOperator,v:this.options.rootPath+this.currentPath})),this.query=new utils.QueryHelper($.extend(!0,{},this.options,{pattern:this,baseCriteria:baseCriteria}));var ajax={};this.query.valid&&(ajax=this.query.selectAjax()),this.options.ajax=ajax,this.$el.select2(this.options)},setBreadCrumbs:function(){function initUploadView(UploadView,disabled){var uploadButtonId="upload-"+utils.generateId(),uploadButton=new ButtonView({id:uploadButtonId,title:_t("Upload"),tooltip:_t("Upload files"),icon:"upload"});disabled&&uploadButton.disable(),$(".controls",self.$toolbar).prepend(uploadButton.render().el),self.uploadView=new UploadView({triggerView:uploadButton,app:self}),$("#btn-"+uploadButtonId,self.$toolbar).append(self.uploadView.render().el)}var html,self=this,path=self.currentPath,paths=path.split("/"),itemPath="",itemsHtml="";_.each(paths,function(node){if(""!==node){var item={};itemPath=itemPath+"/"+node,item.text=node,item.path=itemPath,itemsHtml+=self.applyTemplate("breadcrumb",item)}});var favoritesHtml="";_.each(self.options.favorites,function(item){var item_copy=_.clone(item);item_copy.path=item_copy.path.substr(self.options.rootPath.length)||"/",
favoritesHtml+=self.applyTemplate("favorite",item_copy)}),html=self.applyTemplate("toolbar",{items:itemsHtml,favItems:favoritesHtml,favText:_t("Favorites"),searchText:_t("Current path:"),searchModeText:_t("Search"),browseModeText:_t("Browse")}),self.$toolbar.html(html),$(".dropdown-toggle",self.$toolbar).dropdown(),$("button.mode.search",self.$toolbar).on("click",function(e){e.preventDefault(),self.browsing?($("button.mode.search",self.$toolbar).toggleClass("btn-primary btn-default"),$("button.mode.browse",self.$toolbar).toggleClass("btn-primary btn-default"),self.options.mode="search",self.browsing=!1,self.$el.select2("data").length>0&&(self.openAfterInit=!0),self.setQuery(),self.openAfterInit||(self.$el.select2("close"),self.$el.select2("open"))):(self.$el.select2("close"),self.$el.select2("open"))}),$("button.mode.browse",self.$toolbar).on("click",function(e){e.preventDefault(),self.browsing?(self.$el.select2("close"),self.$el.select2("open")):($("button.mode.search",self.$toolbar).toggleClass("btn-primary btn-default"),$("button.mode.browse",self.$toolbar).toggleClass("btn-primary btn-default"),self.options.mode="browse",self.browsing=!0,self.$el.select2("data").length>0&&(self.openAfterInit=!0),self.setQuery(),self.openAfterInit||(self.$el.select2("close"),self.$el.select2("open")))}),$("a.crumb",self.$toolbar).on("click",function(e){e.preventDefault(),self.browseTo($(this).attr("href"))}),$("a.fav",self.$toolbar).on("click",function(e){e.preventDefault(),self.browseTo($(this).attr("href"))}),self.options.upload&&utils.featureSupport.dragAndDrop()&&utils.featureSupport.fileApi()&&require(["mockup-patterns-relateditems-upload"],function(UploadView){self.options.uploadAllowView?$.ajax({url:self.options.uploadAllowView,dataType:"JSON",data:{path:self.options.rootPath+self.currentPath},type:"GET",success:function(result){initUploadView(UploadView,!result.allowUpload)}}):initUploadView(UploadView)})},browseTo:function(path){var self=this;self.emit("before-browse"),self.currentPath=path,self.$el.select2("close"),self.setBreadCrumbs(),self.setQuery(),self.$el.select2("open"),self.emit("after-browse")},selectItem:function(item){var self=this;self.emit("selecting");var data=self.$el.select2("data");data.push(item),self.$el.select2("data",data,!0),self.emit("selected")},deselectItem:function(item){var self=this;self.emit("deselecting");var data=self.$el.select2("data");_.each(data,function(obj,i){obj.UID===item.UID&&data.splice(i,1)}),self.$el.select2("data",data,!0),self.emit("deselected")},isSelectable:function(item){var self=this;return null===self.options.selectableTypes||_.indexOf(self.options.selectableTypes,item.portal_type)>-1},init:function(){var self=this;self.browsing="browse"===self.options.mode,self.options.rootPath=self.options.rootPath.replace(/\/$/,""),self.currentPath=self.options.basePath.substr(self.options.rootPath.length)||"/",self.setQuery(),self.$el.wrap('<div class="pattern-relateditems-container" />'),self.$container=self.$el.parents(".pattern-relateditems-container"),self.$container.width(self.options.width),Select2.prototype.initializeValues.call(self),Select2.prototype.initializeTags.call(self),self.options.formatSelection=function(item,$container){return self.applyTemplate("selection",item)},Select2.prototype.initializeOrdering.call(self),self.options.formatResult=function(item){item.selectable=self.isSelectable(item);for(var data=self.$el.select2("data"),i=0;i<data.length;i+=1)if(data[i].UID===item.UID)return;var result=$(self.applyTemplate("result",item));return $(".pattern-relateditems-result-select",result).on("click",function(event){if(event.preventDefault(),$(this).is(".selectable")){var $parent=$(this).parents(".pattern-relateditems-result");if($parent.is(".pattern-relateditems-active"))$parent.removeClass("pattern-relateditems-active"),self.deselectItem(item);else{if(self.selectItem(item),$parent.addClass("pattern-relateditems-active"),self.options.maximumSelectionSize>0){var items=self.$el.select2("data");items.length>=self.options.maximumSelectionSize&&self.$el.select2("close")}self.options.closeOnSelect&&self.$el.select2("close")}}}),$(".pattern-relateditems-result-browse",result).on("click",function(event){event.preventDefault(),event.stopPropagation();var path=$(this).data("path");self.browseTo(path)}),$(result)},self.options.initSelection=function(element,callback){var value=$(element).val();if(""!==value){var ids=value.split(self.options.separator),query=new utils.QueryHelper($.extend(!0,{},self.options,{pattern:self}));query.search("UID","plone.app.querystring.operation.list.contains",ids,function(data){var results=data.results.reduce(function(prev,item){return prev[item.UID]=item,prev},{});callback(ids.map(function(uid){return results[uid]}).filter(function(item){return void 0!==item})),self.openAfterInit&&(self.$el.select2("open"),self.openAfterInit=void 0)},!1)}},self.options.id=function(item){return item.UID},Select2.prototype.initializeSelect2.call(self),self.$toolbar=$('<div class="toolbar ui-offset-parent" />'),self.$container.prepend(self.$toolbar),self.$el.on("select2-selecting",function(event){event.preventDefault()}),self.setBreadCrumbs()}});return RelatedItems}),define("mockup-patterns-querystring",["jquery","pat-base","mockup-patterns-select2","mockup-patterns-pickadate","mockup-patterns-relateditems","select2","translate","underscore"],function($,Base,Select2,PickADate,relatedItems,undefined,_t,_){"use strict";var Criteria=function(){this.init.apply(this,arguments)};Criteria.prototype={defaults:{indexWidth:"20em",remove:"",classBetweenDtName:"querystring-criteria-betweendt",classWrapperName:"querystring-criteria-wrapper",classIndexName:"querystring-criteria-index",classOperatorName:"querystring-criteria-operator",classValueName:"querystring-criteria-value",classRemoveName:"querystring-criteria-remove",classResultsName:"querystring-criteria-results",classClearName:"querystring-criteria-clear",classDepthName:"querystring-criteria-depth"},init:function($el,options,indexes,index,operator,value,baseUrl){var self=this;self.options=$.extend(!0,{},self.defaults,options),self.indexes=indexes,self.indexGroups={},self.baseUrl=baseUrl,self.advanced=!1,self.initial=value,self.$wrapper=$("<div/>").addClass(self.options.classWrapperName).appendTo($el),self.$remove=$("<div>"+self.options.remove+"</div>").addClass(self.options.classRemoveName).appendTo(self.$wrapper).on("click",function(e){self.remove()}),self.$index=$("<select><option></option></select>").attr("placeholder",_t("Select criteria")),$.each(self.indexes,function(value,options){options.enabled&&(self.indexGroups[options.group]||(self.indexGroups[options.group]=$("<optgroup/>").attr("label",options.group).appendTo(self.$index)),self.indexGroups[options.group].append($("<option/>").attr("value",value).html(options.title)))}),self.$wrapper.append($("<div/>").addClass(self.options.classIndexName).append(self.$index)),self.$index.patternSelect2({width:self.options.indexWidth,placeholder:_t("Select criteria")}).on("change",function(e){self.removeValue(),self.createOperator(e.val),self.createClear(),self.trigger("index-changed")}),"undefined"!=typeof index&&(self.$index.select2("val",index),self.createOperator(index,operator,value),self.createClear()),self.trigger("create-criteria")},appendOperators:function(index){var self=this;self.$operator=$("<select/>"),self.indexes[index]&&_.each(self.indexes[index].operations,function(value){var options=self.indexes[index].operators[value];$("<option/>").attr("value",value).html(options.title).appendTo(self.$operator)}),self.$wrapper.append($("<div/>").addClass(self.options.classOperatorName).append(self.$operator)),self.$operator.patternSelect2({width:"10em"}).on("change",function(e){self.createValue(index),self.createClear(),self.trigger("operator-changed")})},convertPathOperators:function(oval){var self=this;return self.advanced?oval:oval=oval.replace("advanced","relativePath").replace("path","relativePath")},createPathOperators:function(){var self=this;if(self.advanced)return void self.resetPathOperators();var newOperator="plone.app.querystring.operation.string.advanced";"undefined"==typeof self.indexes.path.operators[newOperator]&&(self.indexes.path.operations.push(newOperator),self.indexes.path.operators[newOperator]={title:"Advanced",widget:"AdvancedPathWidget",description:"Enter a custom path string",operation:"plone.app.querystring.queryparser._relativePath"}),$.each(self.indexes.path.operators,function(key,value){var options=value;key.indexOf("absolute")>0?options.title="Custom":key.indexOf("relative")>0?options.title="Parent (../)":key.indexOf("advanced")>0?options.title="Advanced Mode":(options.title="Current (./)",options.widget="RelativePathWidget")})},resetPathOperators:function(){var self=this;$.each(self.indexes.path.operators,function(key,value){var options=value;key.indexOf("absolute")>0?options.title="Absolute Path":key.indexOf("relative")>0?options.title="Relative Path":key.indexOf("advanced")>0?options.title="Simple Mode":(options.title="Navigation Path",options.widget="ReferenceWidget")})},createOperator:function(index,operator,value){var self=this;self.removeOperator(),self.createPathOperators(),"path"===index&&value&&".::1"!==value&&"..::1"!==value&&!value.match(/^[0-9a-f]{32}::-?[0-9]+$/)&&(self.advanced=!0,self.resetPathOperators()),self.appendOperators(index),"undefined"==typeof operator&&(operator=self.$operator.select2("val")),self.$operator.select2("val",operator),self.createValue(index,value),self.trigger("create-operator")},createValue:function(index,value){var self=this,widget=self.indexes[index].operators[self.$operator.val()].widget,$wrapper=$("<div/>").addClass(self.options.classValueName).appendTo(self.$wrapper);self.removeValue();var createDepthSelect=function(selected){for(var select="<div class='depth-select-box'><label for='depth-select'>Depth</label><select name='depth-select' class='"+self.options.classDepthName+"'><option value='-1' selected='selected'>Unlimited</option>",i=0;i<=10;i+=1)select+="<option value="+i+" ",""+i===selected&&(select+="selected='selected' "),select+=">"+i+"</option>";return select+="</select></div>",$(select).change(function(){self.trigger("depth-changed")})};if("StringWidget"===widget)self.$value=$('<input type="text"/>').addClass(self.options.classValueName+"-"+widget).val(value).appendTo($wrapper).change(function(){self.trigger("value-changed")});else if("DateWidget"===widget)self.$value=$('<input type="text"/>').addClass(self.options.classValueName+"-"+widget).attr("data-pat-pickadate",'{"time": false, "date": {"format": "dd/mm/yyyy" }}').val(value).appendTo($wrapper).patternPickadate().on("updated.pickadate.patterns",function(){self.trigger("value-changed")});else if("DateRangeWidget"===widget){var startwrap=$("<span/>").appendTo($wrapper),val1="",val2="";value&&(val1=value[0]?value[0]:"",val2=value[1]?value[1]:"");var startdt=$('<input type="text"/>').addClass(self.options.classValueName+"-"+widget).addClass(self.options.classValueName+"-"+widget+"-start").attr("data-pat-pickadate",'{"time": false, "date": {"format": "dd/mm/yyyy" }}').val(val1).appendTo(startwrap).patternPickadate().on("updated.pickadate.patterns",function(){self.trigger("value-changed")});$wrapper.append($("<span/>").html(_t("to")).addClass(self.options.classBetweenDtName));var endwrap=$("<span/>").appendTo($wrapper),enddt=$('<input type="text"/>').addClass(self.options.classValueName+"-"+widget).addClass(self.options.classValueName+"-"+widget+"-end").attr("data-pat-pickadate",'{"time": false, "date": {"format": "dd/mm/yyyy" }}').val(val2).appendTo(endwrap).patternPickadate().on("updated.pickadate.patterns",function(){self.trigger("value-changed")});self.$value=[startdt,enddt]}else if("RelativeDateWidget"===widget)self.$value=$('<input type="text"/>').after($("<span/>").html(_t("days"))).addClass(self.options.classValueName+"-"+widget).appendTo($wrapper).change(function(){self.trigger("value-changed")});else if("AdvancedPathWidget"===widget)self.advanced?self.advanced=!1:self.advanced=!0,self.createPathOperators(),self.removeOperator(),self.appendOperators(index),self.createValue(index);else if("RelativePathWidget"===widget)self.advanced?self.$value=$('<input type="text"/>').addClass(self.options.classValueName+"-"+widget).appendTo($wrapper).val(value).change(function(){self.trigger("value-changed")}):(value?".::1"===value&&self.$operator.select2("val","plone.app.querystring.operation.string.path"):(value=".::1",self.$operator.val().indexOf("relativePath")>0&&(value="..::1")),self.$value=$('<input type="hidden"/>').addClass(self.options.classValueName+"-"+widget).appendTo($wrapper).val(value));else if("ReferenceWidget"===widget)if(self.advanced)self.$value=$('<input type="text"/>').addClass(self.options.classValueName+"-"+widget).val(value).appendTo($wrapper).change(function(){self.trigger("value-changed")});else{var pathAndDepth=["",-1];"undefined"!=typeof value&&(pathAndDepth=value.split("::")),self.$value=$('<input type="text"/>').addClass(self.options.classValueName+"-"+widget).appendTo($wrapper).val(pathAndDepth[0]).patternRelateditems({vocabularyUrl:self.baseUrl+"@@getVocabulary?name=plone.app.vocabularies.Catalog&field=relatedItems",folderTypes:["Folder"],maximumSelectionSize:1,width:"400px"}).change(function(){self.trigger("value-changed")}),self.$value.parent().after(createDepthSelect(pathAndDepth[1])),self.$value.parents("."+self.options.classValueName).addClass("break-line")}else"MultipleSelectionWidget"===widget&&(self.$value=$("<select/>").prop("multiple",!0).addClass(self.options.classValueName+"-"+widget).appendTo($wrapper).change(function(){self.trigger("value-changed")}),self.indexes[index]&&$.each(self.indexes[index].values,function(value,options){$("<option/>").attr("value",value).html(options.title).appendTo(self.$value)}),self.$value.patternSelect2({width:"250px"}));if("undefined"!=typeof value&&"undefined"!=typeof self.$value)if($.isArray(self.$value))$.each(value,function(i,v){self.$value[i].select2("val",v)});else{var trimmedValue=value;"string"==typeof value&&"RelativePathWidget"!==widget&&(trimmedValue=value.replace(/::-?[0-9]+/,"")),self.$value.select2("val",trimmedValue)}self.trigger("create-value")},createClear:function(){var self=this;self.removeClear(),self.$clear=$("<div/>").addClass(self.options.classClearName).appendTo(self.$wrapper)},remove:function(){var self=this;self.trigger("remove"),self.$remove.remove(),self.$index.parent().remove(),self.removeOperator(),self.removeValue(),self.removeClear(),self.$wrapper.remove()},removeClear:function(){var self=this;self.trigger("remove-clear"),self.$clear&&self.$clear.remove()},removeOperator:function(){var self=this;self.trigger("remove-operator"),self.$operator&&self.$operator.parent().remove()},removeValue:function(){var self=this;self.trigger("remove-value"),self.$value&&($.isArray(self.$value)?self.$value[0].parents(".querystring-criteria-value").remove():self.$value.parents(".querystring-criteria-value").remove())},buildQueryPart:function(){var self=this,ival=self.$index.select2("val");if(""===ival)return"";var istr="query.i:records="+ival;if("undefined"==typeof self.$operator)return"";var oval=self.$operator.val();if("path"===ival){if(oval.indexOf("advanced")>0)return"";oval=self.convertPathOperators(oval)}var ostr="query.o:records="+oval,vstrbase="query.v:records=",vstrlistbase="query.v:records:list=",vstr=[];if("undefined"==typeof self.$value)vstr.push(vstrbase);else if($.isArray(self.$value))$.each(self.$value,function(i,v){vstr.push(vstrlistbase+$(this).val())});else if($.isArray(self.$value.val()))$.each(self.$value.val(),function(i,v){vstr.push(vstrlistbase+v)});else{var str=vstrbase+self.$value.val();"path"===ival&&""!==self.$value.val()?str+=self.getDepthString():"undefined"!=typeof self.initial&&(str=vstrbase+self.initial,delete self.initial),vstr.push(str)}return istr+"&"+ostr+"&"+vstr.join("&")},getJSONListStr:function(){var self=this,ival=self.$index.select2("val");if(""===ival)return"";if("undefined"==typeof self.$operator)return"";var oval=self.$operator.val();if("path"===ival){if(oval.indexOf("advanced")>0)return"";oval=self.convertPathOperators(oval)}var varr=[];if($.isArray(self.$value))$.each(self.$value,function(i,v){varr.push($(this).val())});else if("undefined"!=typeof self.$value){var value=self.$value.val();if("string"==typeof value){var depth=self.getDepthString();depth&&(value+=depth)}varr.push(value)}var vval;return vval=varr.length>1?'["'+varr.join('","')+'"]':1===varr.length?JSON.stringify(varr[0]):'""',"undefined"!=typeof self.indexes[ival].operators[oval]?'{"i":"'+ival+'", "o":"'+oval+'", "v":'+vval+"}":void 0},getDepthString:function(){var self=this,out="",depth=$("."+self.options.classDepthName).val();return""!==depth&&"undefined"!=typeof depth&&(out+="::"+depth),out},trigger:function(name){this.$wrapper.trigger(name+"-criteria.querystring.patterns",[this])},on:function(name,callback){this.$wrapper.on(name+"-criteria.querystring.patterns",callback)}};var QueryString=Base.extend({name:"querystring",trigger:".pat-querystring",parser:"mockup",defaults:{indexes:[],classWrapperName:"querystring-wrapper",criteria:{},indexOptionsUrl:null,previewURL:"portal_factory/@@querybuilder_html_results",previewCountURL:"portal_factory/@@querybuildernumberofresults",classSortLabelName:"querystring-sort-label",classSortReverseName:"querystring-sortreverse",classSortReverseLabelName:"querystring-sortreverse-label",classPreviewCountWrapperName:"querystring-previewcount-wrapper",classPreviewResultsWrapperName:"querystring-previewresults-wrapper",classPreviewWrapperName:"querystring-preview-wrapper",classPreviewName:"querystring-preview",classPreviewTitleName:"querystring-preview-title",classPreviewDescriptionName:"querystring-preview-description",classSortWrapperName:"querystring-sort-wrapper",showPreviews:!0},init:function(){var self=this;self.$el.hide(),self.$wrapper=$("<div/>"),self.$el.after(self.$wrapper),self.initialized=!1,self.options.indexOptionsUrl?$.ajax({url:self.options.indexOptionsUrl,success:function(data){self.options.indexes=data.indexes,self.options.sortable_indexes=data.sortable_indexes,self._init()},error:function(xhr){}}):self._init()},_init:function(){var self=this;self.$criteriaWrapper=$("<div/>").addClass(self.options.classWrapperName).appendTo(self.$wrapper),self.$sortWrapper=$("<div/>").addClass(self.options.classSortWrapperName).appendTo(self.$wrapper),"false"===self.options.showPreviews&&(self.options.showPreviews=!1),self.options.showPreviews&&(self.$previewWrapper=$("<div/>").addClass(self.options.classPreviewWrapperName).appendTo(self.$wrapper),$("<div/>").addClass(self.options.classPreviewTitleName).html(_t("Preview")).appendTo(self.$previewWrapper),$("<div/>").addClass(self.options.classPreviewDescriptionName).html(_t("Preview of at most 10 items")).appendTo(self.$previewWrapper)),self.criterias=[],self.$el.val()&&$.each(JSON.parse(self.$el.val()),function(i,item){self.createCriteria(item.i,item.o,item.v)}),self.createCriteria(),self.createSort(),self.options.showPreviews&&self.refreshPreviewEvent(),self.$el.trigger("initialized"),self.initialized=!0},createCriteria:function(index,operator,value){var self=this,baseUrl=self.options.indexOptionsUrl.replace(/(@@.*)/g,""),criteria=new Criteria(self.$criteriaWrapper,self.options.criteria,self.options.indexes,index,operator,value,baseUrl);criteria.on("remove",function(e){self.criterias[self.criterias.length-1]===criteria&&self.createCriteria()}),criteria.on("index-changed",function(e){self.criterias[self.criterias.length-1]===criteria&&self.createCriteria()});var _doupdates=function(){self.refreshPreviewEvent(),self.updateValue()},_updateTimeout=-1,doupdates=function(){clearTimeout(_updateTimeout),_updateTimeout=setTimeout(_doupdates,100)};criteria.on("remove",function(e,criteria){self.criterias.indexOf(criteria)!==-1&&self.criterias.splice(self.criterias.indexOf(criteria),1),doupdates(e,criteria)}),criteria.on("remove-clear",doupdates),criteria.on("remove-operator",doupdates),criteria.on("remove-value",doupdates),criteria.on("index-changed",doupdates),criteria.on("operator-changed",doupdates),criteria.on("create-criteria",doupdates),criteria.on("create-operator",doupdates),criteria.on("create-value",doupdates),criteria.on("value-changed",doupdates),criteria.on("depth-changed",doupdates),self.criterias.push(criteria)},createSort:function(){var self=this,existingSortOn=$('[id$="-sort_on"]').filter('[id^="formfield-"]'),existingSortOrder=$('[id$="-sort_reversed"]').filter('[id^="formfield-"]');$("<span/>").addClass(self.options.classSortLabelName).html(_t("Sort on")).appendTo(self.$sortWrapper),self.$sortOn=$("<select/>").attr("name","sort_on").appendTo(self.$sortWrapper).change(function(){self.refreshPreviewEvent.call(self),$('[id$="sort_on"]',existingSortOn).val($(this).val())}),self.$sortOn.append($('<option value="">No sorting</option>'));for(var key in self.options.sortable_indexes)self.$sortOn.append($("<option/>").attr("value",key).html(self.options.indexes[key].title));if(self.$sortOn.patternSelect2({width:150}),self.$sortOrder=$('<input type="checkbox" />').attr("name","sort_reversed:boolean").change(function(){self.refreshPreviewEvent.call(self),$(this).prop("checked")?$('.option input[type="checkbox"]',existingSortOrder).prop("checked",!0):$('.option input[type="checkbox"]',existingSortOrder).prop("checked",!1)}),$("<span/>").addClass(self.options.classSortReverseName).appendTo(self.$sortWrapper).append(self.$sortOrder).append($("<span/>").html(_t("Reversed Order")).addClass(self.options.classSortReverseLabelName)),existingSortOn.length>=1&&existingSortOrder.length>=1){var reversed=$('.option input[type="checkbox"]',existingSortOrder).prop("checked"),sortOn=$('[id$="-sort_on"]',existingSortOn).val();reversed&&self.$sortOrder.prop("checked",!0),self.$sortOn.select2("val",sortOn),$(existingSortOn).hide(),$(existingSortOrder).hide()}},refreshPreviewEvent:function(value){var self=this;if(self.options.showPreviews){"undefined"!=typeof self._previewXhr&&self._previewXhr.abort(),"undefined"!=typeof self.$previewPane&&self.$previewPane.remove();var query=[];if($.each(self.criterias,function(i,criteria){var querypart=criteria.buildQueryPart();""!==querypart&&query.push(querypart)}),self.$previewPane=$("<div/>").addClass(self.options.classPreviewName).appendTo(self.$previewWrapper),query.length<=0)return void $("<div/>").addClass(self.options.classPreviewCountWrapperName).html("No results to preview").prependTo(self.$previewPane);query.push("sort_on="+self.$sortOn.val()),self.$sortOrder.prop("checked")&&query.push("sort_order=reverse"),self._previewXhr=$.get(self.options.previewURL+"?"+query.join("&")).done(function(data,stat){$("<div/>").addClass(self.options.classPreviewResultsWrapperName).html(data).appendTo(self.$previewPane)})}},updateValue:function(){var self=this,criteriastrs=[];$.each(self.criterias,function(i,criteria){var jsonstr=criteria.getJSONListStr();""!==jsonstr&&criteriastrs.push(jsonstr)});var val=(self.$el.val(),"["+criteriastrs.join(",")+"]");self.$el.val(val),self.$el.trigger("change")}});return QueryString}),function(root){define("tinymce",[],function(){return function(){return function(){!function(){"use strict";function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf$1.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push$1.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf$1.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document$1&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push$1.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}function DeviceType(os,browser,userAgent){var isiPad=os.isiOS()&&/ipad/i.test(userAgent)===!0,isiPhone=os.isiOS()&&!isiPad,isAndroid3=os.isAndroid()&&3===os.version.major,isAndroid4=os.isAndroid()&&4===os.version.major,isTablet=isiPad||isAndroid3||isAndroid4&&/mobile/i.test(userAgent)===!0,isTouch=os.isiOS()||os.isAndroid(),isPhone=isTouch&&!isTablet,iOSwebview=browser.isSafari()&&os.isiOS()&&/safari/i.test(userAgent)===!1;return{isiPad:$_eqpqvr6jh8lyw3s.constant(isiPad),isiPhone:$_eqpqvr6jh8lyw3s.constant(isiPhone),isTablet:$_eqpqvr6jh8lyw3s.constant(isTablet),isPhone:$_eqpqvr6jh8lyw3s.constant(isPhone),isTouch:$_eqpqvr6jh8lyw3s.constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:$_eqpqvr6jh8lyw3s.constant(iOSwebview)}}function Immutable(){for(var fields=[],_i=0;_i<arguments.length;_i++)fields[_i]=arguments[_i];return function(){for(var values=[],_i=0;_i<arguments.length;_i++)values[_i]=arguments[_i];if(fields.length!==values.length)throw new Error('Wrong number of arguments to struct. Expected "['+fields.length+']", got '+values.length+" arguments");var struct={};return $_5wjzy24jh8lyw2t.each(fields,function(name,i){struct[name]=$_eqpqvr6jh8lyw3s.constant(values[i])}),struct}}function MixedBag(required,optional){var everything=required.concat(optional);if(0===everything.length)throw new Error("You must specify at least one required or optional field.");return $_8ab5mm1bjh8lywg2.validateStrArr("required",required),$_8ab5mm1bjh8lywg2.validateStrArr("optional",optional),$_8ab5mm1bjh8lywg2.checkDupes(everything),function(obj){var keys=$_g63v2c13jh8lywej.keys(obj),allReqd=$_5wjzy24jh8lyw2t.forall(required,function(req){return $_5wjzy24jh8lyw2t.contains(keys,req)});allReqd||$_8ab5mm1bjh8lywg2.reqMessage(required,keys);var unsupported=$_5wjzy24jh8lyw2t.filter(keys,function(key){return!$_5wjzy24jh8lyw2t.contains(everything,key)});unsupported.length>0&&$_8ab5mm1bjh8lywg2.unsuppMessage(unsupported);var r={};return $_5wjzy24jh8lyw2t.each(required,function(req){r[req]=$_eqpqvr6jh8lyw3s.constant(obj[req])}),$_5wjzy24jh8lyw2t.each(optional,function(opt){r[opt]=$_eqpqvr6jh8lyw3s.constant(Object.prototype.hasOwnProperty.call(obj,opt)?Option.some(obj[opt]):Option.none())}),r}}function StyleSheetLoader(document,settings){
var maxLoadTime,idCount=0,loadedStates={};settings=settings||{},maxLoadTime=settings.maxLoadTime||5e3;var appendToHead=function(node){document.getElementsByTagName("head")[0].appendChild(node)},load=function(url,loadedCallback,errorCallback){var link,style,startTime,state,passed=function(){for(var callbacks=state.passed,i=callbacks.length;i--;)callbacks[i]();state.status=2,state.passed=[],state.failed=[]},failed=function(){for(var callbacks=state.failed,i=callbacks.length;i--;)callbacks[i]();state.status=3,state.passed=[],state.failed=[]},isOldWebKit=function(){var webKitChunks=navigator.userAgent.match(/WebKit\/(\d*)/);return!!(webKitChunks&&parseInt(webKitChunks[1],10)<536)},wait=function(testCallback,waitCallback){testCallback()||((new Date).getTime()-startTime<maxLoadTime?$_8sy3pfhjh8lyw95.setTimeout(waitCallback):failed())},waitForWebKitLinkLoaded=function(){wait(function(){for(var styleSheet,owner,styleSheets=document.styleSheets,i=styleSheets.length;i--;)if(styleSheet=styleSheets[i],owner=styleSheet.ownerNode?styleSheet.ownerNode:styleSheet.owningElement,owner&&owner.id===link.id)return passed(),!0},waitForWebKitLinkLoaded)},waitForGeckoLinkLoaded=function(){wait(function(){try{var cssRules=style.sheet.cssRules;return passed(),!!cssRules}catch(ex){}},waitForGeckoLinkLoaded)};if(url=$_ahowuxkjh8lywbj._addCacheSuffix(url),loadedStates[url]?state=loadedStates[url]:(state={passed:[],failed:[]},loadedStates[url]=state),loadedCallback&&state.passed.push(loadedCallback),errorCallback&&state.failed.push(errorCallback),1!==state.status){if(2===state.status)return void passed();if(3===state.status)return void failed();if(state.status=1,link=document.createElement("link"),link.rel="stylesheet",link.type="text/css",link.id="u"+idCount++,link.async=!1,link.defer=!1,startTime=(new Date).getTime(),"onload"in link&&!isOldWebKit())link.onload=waitForWebKitLinkLoaded,link.onerror=failed;else{if(navigator.userAgent.indexOf("Firefox")>0)return style=document.createElement("style"),style.textContent='@import "'+url+'"',waitForGeckoLinkLoaded(),void appendToHead(style);waitForWebKitLinkLoaded()}appendToHead(link),link.href=url}},loadF=function(url){return Future.nu(function(resolve){load(url,$_eqpqvr6jh8lyw3s.compose(resolve,$_eqpqvr6jh8lyw3s.constant(Result.value(url))),$_eqpqvr6jh8lyw3s.compose(resolve,$_eqpqvr6jh8lyw3s.constant(Result.error(url))))})},unbox=function(result){return result.fold($_eqpqvr6jh8lyw3s.identity,$_eqpqvr6jh8lyw3s.identity)},loadAll=function(urls,success,failure){$_5lpsz51kjh8lywh6.par($_5wjzy24jh8lyw2t.map(urls,loadF)).get(function(result){var parts=$_5wjzy24jh8lyw2t.partition(result,function(r){return r.isValue()});parts.fail.length>0?failure(parts.fail.map(unbox)):success(parts.pass.map(unbox))})};return{load:load,loadAll:loadAll}}function TreeWalker(startNode,rootNode){var node=startNode,findSibling=function(node,startName,siblingName,shallow){var sibling,parent;if(node){if(!shallow&&node[startName])return node[startName];if(node!==rootNode){if(sibling=node[siblingName])return sibling;for(parent=node.parentNode;parent&&parent!==rootNode;parent=parent.parentNode)if(sibling=parent[siblingName])return sibling}}},findPreviousNode=function(node,startName,siblingName,shallow){var sibling,parent,child;if(node){if(sibling=node[siblingName],rootNode&&sibling===rootNode)return;if(sibling){if(!shallow)for(child=sibling[startName];child;child=child[startName])if(!child[startName])return child;return sibling}if(parent=node.parentNode,parent&&parent!==rootNode)return parent}};this.current=function(){return node},this.next=function(shallow){return node=findSibling(node,"firstChild","nextSibling",shallow)},this.prev=function(shallow){return node=findSibling(node,"lastChild","previousSibling",shallow)},this.prev2=function(shallow){return node=findPreviousNode(node,"lastChild","previousSibling",shallow)}}function Schema(settings){var validStyles,invalidStyles,schemaItems,whiteSpaceElementsMap,selfClosingElementsMap,shortEndedElementsMap,boolAttrMap,validClasses,blockElementsMap,nonEmptyElementsMap,moveCaretBeforeOnEnterElementsMap,textBlockElementsMap,textInlineElementsMap,elements={},children={},patternElements=[],customElementsMap={},specialElements={},createLookupTable=function(option,defaultValue,extendWith){var value=settings[option];return value?value=makeMap$2(value,/[, ]/,makeMap$2(value.toUpperCase(),/[, ]/)):(value=mapCache[option],value||(value=makeMap$2(defaultValue," ",makeMap$2(defaultValue.toUpperCase()," ")),value=extend$1(value,extendWith),mapCache[option]=value)),value};settings=settings||{},schemaItems=compileSchema(settings.schema),settings.verify_html===!1&&(settings.valid_elements="*[*]"),validStyles=compileElementMap(settings.valid_styles),invalidStyles=compileElementMap(settings.invalid_styles,"map"),validClasses=compileElementMap(settings.valid_classes,"map"),whiteSpaceElementsMap=createLookupTable("whitespace_elements","pre script noscript style textarea video audio iframe object code"),selfClosingElementsMap=createLookupTable("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),shortEndedElementsMap=createLookupTable("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),boolAttrMap=createLookupTable("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),nonEmptyElementsMap=createLookupTable("non_empty_elements","td th iframe video audio object script pre code",shortEndedElementsMap),moveCaretBeforeOnEnterElementsMap=createLookupTable("move_caret_before_on_enter_elements","table",nonEmptyElementsMap),textBlockElementsMap=createLookupTable("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure"),blockElementsMap=createLookupTable("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",textBlockElementsMap),textInlineElementsMap=createLookupTable("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp"),each$4((settings.special||"script noscript noframes noembed title style textarea xmp").split(" "),function(name){specialElements[name]=new RegExp("</"+name+"[^>]*>","gi")});var patternToRegExp=function(str){return new RegExp("^"+str.replace(/([?+*])/g,".$1")+"$")},addValidElements=function(validElements){var ei,el,ai,al,matches,element,attr,attrData,elementName,attrName,attrType,attributes,attributesOrder,prefix,outputName,globalAttributes,globalAttributesOrder,key,value,elementRuleRegExp=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,attrRuleRegExp=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,hasPatternsRegExp=/[*?+]/;if(validElements)for(validElements=split(validElements,","),elements["@"]&&(globalAttributes=elements["@"].attributes,globalAttributesOrder=elements["@"].attributesOrder),ei=0,el=validElements.length;ei<el;ei++)if(matches=elementRuleRegExp.exec(validElements[ei])){if(prefix=matches[1],elementName=matches[2],outputName=matches[3],attrData=matches[5],attributes={},attributesOrder=[],element={attributes:attributes,attributesOrder:attributesOrder},"#"===prefix&&(element.paddEmpty=!0),"-"===prefix&&(element.removeEmpty=!0),"!"===matches[4]&&(element.removeEmptyAttrs=!0),globalAttributes){for(key in globalAttributes)attributes[key]=globalAttributes[key];attributesOrder.push.apply(attributesOrder,globalAttributesOrder)}if(attrData)for(attrData=split(attrData,"|"),ai=0,al=attrData.length;ai<al;ai++)if(matches=attrRuleRegExp.exec(attrData[ai])){if(attr={},attrType=matches[1],attrName=matches[2].replace(/[\\:]:/g,":"),prefix=matches[3],value=matches[4],"!"===attrType&&(element.attributesRequired=element.attributesRequired||[],element.attributesRequired.push(attrName),attr.required=!0),"-"===attrType){delete attributes[attrName],attributesOrder.splice(inArray$1(attributesOrder,attrName),1);continue}prefix&&("="===prefix&&(element.attributesDefault=element.attributesDefault||[],element.attributesDefault.push({name:attrName,value:value}),attr.defaultValue=value),":"===prefix&&(element.attributesForced=element.attributesForced||[],element.attributesForced.push({name:attrName,value:value}),attr.forcedValue=value),"<"===prefix&&(attr.validValues=makeMap$2(value,"?"))),hasPatternsRegExp.test(attrName)?(element.attributePatterns=element.attributePatterns||[],attr.pattern=patternToRegExp(attrName),element.attributePatterns.push(attr)):(attributes[attrName]||attributesOrder.push(attrName),attributes[attrName]=attr)}globalAttributes||"@"!==elementName||(globalAttributes=attributes,globalAttributesOrder=attributesOrder),outputName&&(element.outputName=elementName,elements[outputName]=element),hasPatternsRegExp.test(elementName)?(element.pattern=patternToRegExp(elementName),patternElements.push(element)):elements[elementName]=element}},setValidElements=function(validElements){elements={},patternElements=[],addValidElements(validElements),each$4(schemaItems,function(element,name){children[name]=element.children})},addCustomElements=function(customElements){var customElementRegExp=/^(~)?(.+)$/;customElements&&(mapCache.text_block_elements=mapCache.block_elements=null,each$4(split(customElements,","),function(rule){var matches=customElementRegExp.exec(rule),inline="~"===matches[1],cloneName=inline?"span":"div",name=matches[2];if(children[name]=children[cloneName],customElementsMap[name]=cloneName,inline||(blockElementsMap[name.toUpperCase()]={},blockElementsMap[name]={}),!elements[name]){var customRule=elements[cloneName];customRule=extend$1({},customRule),delete customRule.removeEmptyAttrs,delete customRule.removeEmpty,elements[name]=customRule}each$4(children,function(element,elmName){element[cloneName]&&(children[elmName]=element=extend$1({},children[elmName]),element[name]=element[cloneName])})}))},addValidChildren=function(validChildren){var childRuleRegExp=/^([+\-]?)(\w+)\[([^\]]+)\]$/;mapCache[settings.schema]=null,validChildren&&each$4(split(validChildren,","),function(rule){var parent,prefix,matches=childRuleRegExp.exec(rule);matches&&(prefix=matches[1],parent=prefix?children[matches[2]]:children[matches[2]]={"#comment":{}},parent=children[matches[2]],each$4(split(matches[3],"|"),function(child){"-"===prefix?delete parent[child]:parent[child]={}}))})},getElementRule=function(name){var i,element=elements[name];if(element)return element;for(i=patternElements.length;i--;)if(element=patternElements[i],element.pattern.test(name))return element};settings.valid_elements?setValidElements(settings.valid_elements):(each$4(schemaItems,function(element,name){elements[name]={attributes:element.attributes,attributesOrder:element.attributesOrder},children[name]=element.children}),"html5"!==settings.schema&&each$4(split("strong/b em/i"),function(item){item=split(item,"/"),elements[item[1]].outputName=item[0]}),each$4(split("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(name){elements[name]&&(elements[name].removeEmpty=!0)}),each$4(split("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),function(name){elements[name].paddEmpty=!0}),each$4(split("span"),function(name){elements[name].removeEmptyAttrs=!0})),addCustomElements(settings.custom_elements),addValidChildren(settings.valid_children),addValidElements(settings.extended_valid_elements),addValidChildren("+ol[ul|ol],+ul[ul|ol]"),each$4({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},function(parents,item){elements[item]&&(elements[item].parentsRequired=split(parents))}),settings.invalid_elements&&each$4(explode$1(settings.invalid_elements),function(item){elements[item]&&delete elements[item]}),getElementRule("span")||addValidElements("span[!data-mce-type|*]");var getValidStyles=function(){return validStyles},getInvalidStyles=function(){return invalidStyles},getValidClasses=function(){return validClasses},getBoolAttrs=function(){return boolAttrMap},getBlockElements=function(){return blockElementsMap},getTextBlockElements=function(){return textBlockElementsMap},getTextInlineElements=function(){return textInlineElementsMap},getShortEndedElements=function(){return shortEndedElementsMap},getSelfClosingElements=function(){return selfClosingElementsMap},getNonEmptyElements=function(){return nonEmptyElementsMap},getMoveCaretBeforeOnEnterElements=function(){return moveCaretBeforeOnEnterElementsMap},getWhiteSpaceElements=function(){return whiteSpaceElementsMap},getSpecialElements=function(){return specialElements},isValidChild=function(name,child){var parent=children[name.toLowerCase()];return!(!parent||!parent[child.toLowerCase()])},isValid=function(name,attr){var attrPatterns,i,rule=getElementRule(name);if(rule){if(!attr)return!0;if(rule.attributes[attr])return!0;if(attrPatterns=rule.attributePatterns)for(i=attrPatterns.length;i--;)if(attrPatterns[i].pattern.test(name))return!0}return!1},getCustomElements=function(){return customElementsMap};return{children:children,elements:elements,getValidStyles:getValidStyles,getValidClasses:getValidClasses,getBlockElements:getBlockElements,getInvalidStyles:getInvalidStyles,getShortEndedElements:getShortEndedElements,getTextBlockElements:getTextBlockElements,getTextInlineElements:getTextInlineElements,getBoolAttrs:getBoolAttrs,getElementRule:getElementRule,getSelfClosingElements:getSelfClosingElements,getNonEmptyElements:getNonEmptyElements,getMoveCaretBeforeOnEnterElements:getMoveCaretBeforeOnEnterElements,getWhiteSpaceElements:getWhiteSpaceElements,getSpecialElements:getSpecialElements,isValidChild:isValidChild,isValid:isValid,getCustomElements:getCustomElements,addValidElements:addValidElements,setValidElements:setValidElements,addCustomElements:addCustomElements,addValidChildren:addValidChildren}}function Styles(settings,schema){var i,encodingItems,validStyles,invalidStyles,rgbRegExp=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,urlOrStrRegExp=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,styleRegExp=/\s*([^:]+):\s*([^;]+);?/g,trimRightRegExp=/\s+$/,encodingLookup={},invisibleChar="\ufeff";for(settings=settings||{},schema&&(validStyles=schema.getValidStyles(),invalidStyles=schema.getInvalidStyles()),encodingItems=("\\\" \\' \\; \\: ; : "+invisibleChar).split(" "),i=0;i<encodingItems.length;i++)encodingLookup[encodingItems[i]]=invisibleChar+i,encodingLookup[invisibleChar+i]=encodingItems[i];return{toHex:function(color){return color.replace(rgbRegExp,toHex)},parse:function(css){var matches,name,value,isEncoded,styles={},urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope||this,compress=function(prefix,suffix,noJoin){var top,right,bottom,left;if(top=styles[prefix+"-top"+suffix],top&&(right=styles[prefix+"-right"+suffix],right&&(bottom=styles[prefix+"-bottom"+suffix],bottom&&(left=styles[prefix+"-left"+suffix])))){var box=[top,right,bottom,left];for(i=box.length-1;i--&&box[i]===box[i+1];);i>-1&&noJoin||(styles[prefix+suffix]=i===-1?box[0]:box.join(" "),delete styles[prefix+"-top"+suffix],delete styles[prefix+"-right"+suffix],delete styles[prefix+"-bottom"+suffix],delete styles[prefix+"-left"+suffix])}},canCompress=function(key){var i,value=styles[key];if(value){for(value=value.split(" "),i=value.length;i--;)if(value[i]!==value[0])return!1;return styles[key]=value[0],!0}},compress2=function(target,a,b,c){canCompress(a)&&canCompress(b)&&canCompress(c)&&(styles[target]=styles[a]+" "+styles[b]+" "+styles[c],delete styles[a],delete styles[b],delete styles[c])},encode=function(str){return isEncoded=!0,encodingLookup[str]},decode=function(str,keepSlashes){return isEncoded&&(str=str.replace(/\uFEFF[0-9]/g,function(str){return encodingLookup[str]})),keepSlashes||(str=str.replace(/\\([\'\";:])/g,"$1")),str},decodeSingleHexSequence=function(escSeq){return String.fromCharCode(parseInt(escSeq.slice(1),16))},decodeHexSequences=function(value){return value.replace(/\\[0-9a-f]+/gi,decodeSingleHexSequence)},processUrl=function(match,url,url2,url3,str,str2){if(str=str||str2)return str=decode(str),"'"+str.replace(/\'/g,"\\'")+"'";if(url=decode(url||url2||url3),!settings.allow_script_urls){var scriptUrl=url.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(scriptUrl))return"";if(!settings.allow_svg_data_urls&&/^data:image\/svg/i.test(scriptUrl))return""}return urlConverter&&(url=urlConverter.call(urlConverterScope,url,"style")),"url('"+url.replace(/\'/g,"\\'")+"')"};if(css){for(css=css.replace(/[\u0000-\u001F]/g,""),css=css.replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(str){return str.replace(/[;:]/g,encode)});matches=styleRegExp.exec(css);)if(styleRegExp.lastIndex=matches.index+matches[0].length,name=matches[1].replace(trimRightRegExp,"").toLowerCase(),value=matches[2].replace(trimRightRegExp,""),name&&value){if(name=decodeHexSequences(name),value=decodeHexSequences(value),name.indexOf(invisibleChar)!==-1||name.indexOf('"')!==-1)continue;if(!settings.allow_script_urls&&("behavior"===name||/expression\s*\(|\/\*|\*\//.test(value)))continue;"font-weight"===name&&"700"===value?value="bold":"color"!==name&&"background-color"!==name||(value=value.toLowerCase()),value=value.replace(rgbRegExp,toHex),value=value.replace(urlOrStrRegExp,processUrl),styles[name]=isEncoded?decode(value,!0):value}compress("border","",!0),compress("border","-width"),compress("border","-color"),compress("border","-style"),compress("padding",""),compress("margin",""),compress2("border","border-width","border-style","border-color"),"medium none"===styles.border&&delete styles.border,"none"===styles["border-image"]&&delete styles["border-image"]}return styles},serialize:function(styles,elementName){var name,value,css="",serializeStyles=function(name){var styleList,i,l,value;if(styleList=validStyles[name])for(i=0,l=styleList.length;i<l;i++)name=styleList[i],value=styles[name],value&&(css+=(css.length>0?" ":"")+name+": "+value+";")},isValid=function(name,elementName){var styleMap;return styleMap=invalidStyles["*"],(!styleMap||!styleMap[name])&&(styleMap=invalidStyles[elementName],!styleMap||!styleMap[name])};if(elementName&&validStyles)serializeStyles("*"),serializeStyles(elementName);else for(name in styles)value=styles[name],!value||invalidStyles&&!isValid(name,elementName)||(css+=(css.length>0?" ":"")+name+": "+value+";");return css}}}function DOMUtils(doc,settings){var _this=this;void 0===settings&&(settings={});var attrHooks,addedStyles={},win=window,files={},counter=0,stdMode=!0,boxModel=!0,styleSheetLoader=StyleSheetLoader(doc),boundEvents=[],schema=settings.schema?settings.schema:Schema({}),styles=Styles({url_converter:settings.url_converter,url_converter_scope:settings.url_converter_scope},settings.schema),events=settings.ownEvents?new EventUtils(settings.proxy):EventUtils.Event,blockElementsMap=schema.getBlockElements(),$=DomQuery.overrideDefaults(function(){return{context:doc,element:self.getRoot()}}),isBlock=function(node){if("string"==typeof node)return!!blockElementsMap[node];if(node){var type=node.nodeType;if(type)return!(1!==type||!blockElementsMap[node.nodeName])}return!1},get=function(elm){if(elm&&doc&&"string"==typeof elm){var node=doc.getElementById(elm);return node&&node.id!==elm?doc.getElementsByName(elm)[1]:node}return elm},$$=function(elm){return"string"==typeof elm&&(elm=get(elm)),$(elm)},getAttrib=function(elm,name,defaultVal){var hook,value,$elm=$$(elm);return $elm.length&&(hook=attrHooks[name],value=hook&&hook.get?hook.get($elm,name):$elm.attr(name)),"undefined"==typeof value&&(value=defaultVal||""),value},getAttribs=function(elm){var node=get(elm);return node?node.attributes:[]},setAttrib=function(elm,name,value){var originalValue,hook;""===value&&(value=null);var $elm=$$(elm);originalValue=$elm.attr(name),$elm.length&&(hook=attrHooks[name],hook&&hook.set?hook.set($elm,value,name):$elm.attr(name,value),originalValue!==value&&settings.onSetAttrib&&settings.onSetAttrib({attrElm:$elm,attrName:name,attrValue:value}))},clone=function(node,deep){if(!isIE||1!==node.nodeType||deep)return node.cloneNode(deep);if(!deep){var clone_1=doc.createElement(node.nodeName);return each$5(getAttribs(node),function(attr){setAttrib(clone_1,attr.nodeName,getAttrib(node,attr.nodeName))}),clone_1}return null},getRoot=function(){return settings.root_element||doc.body},getViewPort=function(argWin){var actWin=argWin?argWin:win,doc=actWin.document,rootElm=boxModel?doc.documentElement:doc.body;return{x:actWin.pageXOffset||rootElm.scrollLeft,y:actWin.pageYOffset||rootElm.scrollTop,w:actWin.innerWidth||rootElm.clientWidth,h:actWin.innerHeight||rootElm.clientHeight}},getPos=function(elm,rootElm){return $_6pe7rlmjh8lywbu.getPos(doc.body,get(elm),rootElm)},setStyle=function(elm,name,value){var $elm=$$(elm).css(name,value);settings.update_styles&&updateInternalStyleAttr(styles,$elm)},setStyles=function(elm,stylesArg){var $elm=$$(elm).css(stylesArg);settings.update_styles&&updateInternalStyleAttr(styles,$elm)},getStyle=function(elm,name,computed){var $elm=$$(elm);return computed?$elm.css(name):(name=name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()}),"float"===name&&(name=$_9bpim8ajh8lyw68.ie&&$_9bpim8ajh8lyw68.ie<12?"styleFloat":"cssFloat"),$elm[0]&&$elm[0].style?$elm[0].style[name]:void 0)},getSize=function(elm){var w,h;return elm=get(elm),w=getStyle(elm,"width"),h=getStyle(elm,"height"),w.indexOf("px")===-1&&(w=0),h.indexOf("px")===-1&&(h=0),{w:parseInt(w,10)||elm.offsetWidth||elm.clientWidth,h:parseInt(h,10)||elm.offsetHeight||elm.clientHeight}},getRect=function(elm){var pos,size;return elm=get(elm),pos=getPos(elm),size=getSize(elm),{x:pos.x,y:pos.y,w:size.w,h:size.h}},is=function(elm,selector){var i;if(!elm)return!1;if(!Array.isArray(elm)){if("*"===selector)return 1===elm.nodeType;if(simpleSelectorRe.test(selector)){var selectors=selector.toLowerCase().split(/,/),elmName=elm.nodeName.toLowerCase();for(i=selectors.length-1;i>=0;i--)if(selectors[i]===elmName)return!0;return!1}if(elm.nodeType&&1!==elm.nodeType)return!1}var elms=Array.isArray(elm)?elm:[elm];return Sizzle(selector,elms[0].ownerDocument||elms[0],null,elms).length>0},getParents=function(elm,selector,root,collect){var selectorVal,result=[],node=get(elm);for(collect=void 0===collect,root=root||("BODY"!==getRoot().nodeName?getRoot().parentNode:null),$_ahowuxkjh8lywbj.is(selector,"string")&&(selectorVal=selector,selector="*"===selector?function(node){return 1===node.nodeType}:function(node){return is(node,selectorVal)});node&&node!==root&&node.nodeType&&9!==node.nodeType;){if(!selector||"function"==typeof selector&&selector(node)){if(!collect)return[node];result.push(node)}node=node.parentNode}return collect?result:null},getParent=function(node,selector,root){var parents=getParents(node,selector,root,!1);return parents&&parents.length>0?parents[0]:null},_findSib=function(node,selector,name){var func=selector;if(node)for("string"==typeof selector&&(func=function(node){return is(node,selector)}),node=node[name];node;node=node[name])if("function"==typeof func&&func(node))return node;return null},getNext=function(node,selector){return _findSib(node,selector,"nextSibling")},getPrev=function(node,selector){return _findSib(node,selector,"previousSibling")},select=function(selector,scope){return Sizzle(selector,get(scope)||settings.root_element||doc,[])},run=function(elm,func,scope){var result,node="string"==typeof elm?get(elm):elm;if(!node)return!1;if($_ahowuxkjh8lywbj.isArray(node)&&(node.length||0===node.length))return result=[],each$5(node,function(elm,i){elm&&("string"==typeof elm&&(elm=get(elm)),result.push(func.call(scope,elm,i)))}),result;var context=scope?scope:_this;return func.call(context,node)},setAttribs=function(elm,attrs){$$(elm).each(function(i,node){each$5(attrs,function(value,name){setAttrib(node,name,value)})})},setHTML=function(elm,html){var $elm=$$(elm);isIE?$elm.each(function(i,target){if(target.canHaveHTML!==!1){for(;target.firstChild;)target.removeChild(target.firstChild);try{target.innerHTML="<br>"+html,target.removeChild(target.firstChild)}catch(ex){DomQuery("<div></div>").html("<br>"+html).contents().slice(1).appendTo(target)}return html}}):$elm.html(html)},add=function(parentElm,name,attrs,html,create){return run(parentElm,function(parentElm){var newElm="string"==typeof name?doc.createElement(name):name;return setAttribs(newElm,attrs),html&&("string"!=typeof html&&html.nodeType?newElm.appendChild(html):"string"==typeof html&&setHTML(newElm,html)),create?newElm:parentElm.appendChild(newElm)})},create=function(name,attrs,html){return add(doc.createElement(name),name,attrs,html,!0)},decode=$_gex7a11rjh8lywi4.decode,encode=$_gex7a11rjh8lywi4.encodeAllRaw,createHTML=function(name,attrs,html){var key,outHtml="";outHtml+="<"+name;for(key in attrs)attrs.hasOwnProperty(key)&&null!==attrs[key]&&"undefined"!=typeof attrs[key]&&(outHtml+=" "+key+'="'+encode(attrs[key])+'"');return"undefined"!=typeof html?outHtml+">"+html+"</"+name+">":outHtml+" />"},createFragment=function(html){var node,container=doc.createElement("div"),frag=doc.createDocumentFragment();for(html&&(container.innerHTML=html);node=container.firstChild;)frag.appendChild(node);return frag},remove=function(node,keepChildren){var $node=$$(node);return keepChildren?$node.each(function(){for(var child;child=this.firstChild;)3===child.nodeType&&0===child.data.length?this.removeChild(child):this.parentNode.insertBefore(child,this)}).remove():$node.remove(),$node.length>1?$node.toArray():$node[0]},removeAllAttribs=function(e){return run(e,function(e){var i,attrs=e.attributes;for(i=attrs.length-1;i>=0;i--)e.removeAttributeNode(attrs.item(i))})},parseStyle=function(cssText){return styles.parse(cssText)},serializeStyle=function(stylesArg,name){return styles.serialize(stylesArg,name)},addStyle=function(cssText){var head,styleElm;if(self!==DOMUtils.DOM&&doc===document){if(addedStyles[cssText])return;addedStyles[cssText]=!0}styleElm=doc.getElementById("mceDefaultStyles"),styleElm||(styleElm=doc.createElement("style"),styleElm.id="mceDefaultStyles",styleElm.type="text/css",head=doc.getElementsByTagName("head")[0],head.firstChild?head.insertBefore(styleElm,head.firstChild):head.appendChild(styleElm)),styleElm.styleSheet?styleElm.styleSheet.cssText+=cssText:styleElm.appendChild(doc.createTextNode(cssText))},loadCSS=function(url){var head;return self!==DOMUtils.DOM&&doc===document?void DOMUtils.DOM.loadCSS(url):(url||(url=""),head=doc.getElementsByTagName("head")[0],void each$5(url.split(","),function(url){var link;url=$_ahowuxkjh8lywbj._addCacheSuffix(url),files[url]||(files[url]=!0,link=create("link",{rel:"stylesheet",href:url}),head.appendChild(link))}))},toggleClass=function(elm,cls,state){$$(elm).toggleClass(cls,state).each(function(){""===this.className&&DomQuery(this).attr("class",null)})},addClass=function(elm,cls){$$(elm).addClass(cls)},removeClass=function(elm,cls){toggleClass(elm,cls,!1)},hasClass=function(elm,cls){return $$(elm).hasClass(cls)},show=function(elm){$$(elm).show()},hide=function(elm){$$(elm).hide()},isHidden=function(elm){return"none"===$$(elm).css("display")},uniqueId=function(prefix){return(prefix?prefix:"mce_")+counter++},getOuterHTML=function(elm){var node="string"==typeof elm?get(elm):elm;return $_5oonaz1qjh8lywhz.isElement(node)?node.outerHTML:DomQuery("<div></div>").append(DomQuery(node).clone()).html()},setOuterHTML=function(elm,html){$$(elm).each(function(){try{if("outerHTML"in this)return void(this.outerHTML=html)}catch(ex){}remove(DomQuery(this).html(html),!0)})},insertAfter=function(node,reference){var referenceNode=get(reference);return run(node,function(node){var parent,nextSibling;return parent=referenceNode.parentNode,nextSibling=referenceNode.nextSibling,nextSibling?parent.insertBefore(node,nextSibling):parent.appendChild(node),node})},replace=function(newElm,oldElm,keepChildren){return run(oldElm,function(oldElm){return $_ahowuxkjh8lywbj.is(oldElm,"array")&&(newElm=newElm.cloneNode(!0)),keepChildren&&each$5(grep$1(oldElm.childNodes),function(node){newElm.appendChild(node)}),oldElm.parentNode.replaceChild(newElm,oldElm)})},rename=function(elm,name){var newElm;return elm.nodeName!==name.toUpperCase()&&(newElm=create(name),each$5(getAttribs(elm),function(attrNode){setAttrib(newElm,attrNode.nodeName,getAttrib(elm,attrNode.nodeName))}),replace(newElm,elm,!0)),newElm||elm},findCommonAncestor=function(a,b){for(var pe,ps=a;ps;){for(pe=b;pe&&ps!==pe;)pe=pe.parentNode;if(ps===pe)break;ps=ps.parentNode}return!ps&&a.ownerDocument?a.ownerDocument.documentElement:ps},toHex=function(rgbVal){return styles.toHex($_ahowuxkjh8lywbj.trim(rgbVal))},isEmpty=function(node,elements){var i,attributes,type,whitespace,walker,name,brCount=0;if(node=node.firstChild){walker=new TreeWalker(node,node.parentNode),elements=elements||(schema?schema.getNonEmptyElements():null),whitespace=schema?schema.getWhiteSpaceElements():{};do{if(type=node.nodeType,$_5oonaz1qjh8lywhz.isElement(node)){var bogusVal=node.getAttribute("data-mce-bogus");if(bogusVal){node=walker.next("all"===bogusVal);continue}if(name=node.nodeName.toLowerCase(),elements&&elements[name]){if("br"===name){brCount++,node=walker.next();continue}return!1}for(attributes=getAttribs(node),i=attributes.length;i--;)if(name=attributes[i].nodeName,"name"===name||"data-mce-bookmark"===name)return!1}if(8===type)return!1;if(3===type&&!whiteSpaceRegExp$2.test(node.nodeValue))return!1;if(3===type&&node.parentNode&&whitespace[node.parentNode.nodeName]&&whiteSpaceRegExp$2.test(node.nodeValue))return!1;node=walker.next()}while(node)}return brCount<=1},createRng=function(){return doc.createRange()},split=function(parentElm,splitElm,replacementElm){var bef,aft,pa,r=createRng();if(parentElm&&splitElm)return r.setStart(parentElm.parentNode,findNodeIndex(parentElm)),r.setEnd(splitElm.parentNode,findNodeIndex(splitElm)),bef=r.extractContents(),r=createRng(),r.setStart(splitElm.parentNode,findNodeIndex(splitElm)+1),r.setEnd(parentElm.parentNode,findNodeIndex(parentElm)+1),aft=r.extractContents(),pa=parentElm.parentNode,pa.insertBefore($_cm6fub1ojh8lywhl.trimNode(self,bef),parentElm),replacementElm?pa.insertBefore(replacementElm,parentElm):pa.insertBefore(splitElm,parentElm),pa.insertBefore($_cm6fub1ojh8lywhl.trimNode(self,aft),parentElm),remove(parentElm),replacementElm||splitElm},bind=function(target,name,func,scope){if($_ahowuxkjh8lywbj.isArray(target)){for(var i=target.length;i--;)target[i]=bind(target[i],name,func,scope);return target}return!settings.collect||target!==doc&&target!==win||boundEvents.push([target,name,func,scope]),events.bind(target,name,func,scope||self)},unbind=function(target,name,func){var i;if($_ahowuxkjh8lywbj.isArray(target)){for(i=target.length;i--;)target[i]=unbind(target[i],name,func);return target}if(boundEvents&&(target===doc||target===win))for(i=boundEvents.length;i--;){var item=boundEvents[i];target!==item[0]||name&&name!==item[1]||func&&func!==item[2]||events.unbind(item[0],item[1],item[2])}return events.unbind(target,name,func)},fire=function(target,name,evt){return events.fire(target,name,evt)},getContentEditable=function(node){if(node&&$_5oonaz1qjh8lywhz.isElement(node)){var contentEditable=node.getAttribute("data-mce-contenteditable");return contentEditable&&"inherit"!==contentEditable?contentEditable:"inherit"!==node.contentEditable?node.contentEditable:null}return null},getContentEditableParent=function(node){for(var root=getRoot(),state=null;node&&node!==root&&(state=getContentEditable(node),null===state);node=node.parentNode);return state},destroy=function(){if(boundEvents)for(var i=boundEvents.length;i--;){var item=boundEvents[i];events.unbind(item[0],item[1],item[2])}Sizzle.setDocument&&Sizzle.setDocument();
},isChildOf=function(node,parent){for(;node;){if(parent===node)return!0;node=node.parentNode}return!1},dumpRng=function(r){return"startContainer: "+r.startContainer.nodeName+", startOffset: "+r.startOffset+", endContainer: "+r.endContainer.nodeName+", endOffset: "+r.endOffset},self={doc:doc,settings:settings,win:win,files:files,stdMode:stdMode,boxModel:boxModel,styleSheetLoader:styleSheetLoader,boundEvents:boundEvents,styles:styles,schema:schema,events:events,isBlock:isBlock,$:$,$$:$$,root:null,clone:clone,getRoot:getRoot,getViewPort:getViewPort,getRect:getRect,getSize:getSize,getParent:getParent,getParents:getParents,get:get,getNext:getNext,getPrev:getPrev,select:select,is:is,add:add,create:create,createHTML:createHTML,createFragment:createFragment,remove:remove,setStyle:setStyle,getStyle:getStyle,setStyles:setStyles,removeAllAttribs:removeAllAttribs,setAttrib:setAttrib,setAttribs:setAttribs,getAttrib:getAttrib,getPos:getPos,parseStyle:parseStyle,serializeStyle:serializeStyle,addStyle:addStyle,loadCSS:loadCSS,addClass:addClass,removeClass:removeClass,hasClass:hasClass,toggleClass:toggleClass,show:show,hide:hide,isHidden:isHidden,uniqueId:uniqueId,setHTML:setHTML,getOuterHTML:getOuterHTML,setOuterHTML:setOuterHTML,decode:decode,encode:encode,insertAfter:insertAfter,replace:replace,rename:rename,findCommonAncestor:findCommonAncestor,toHex:toHex,run:run,getAttribs:getAttribs,isEmpty:isEmpty,createRng:createRng,nodeIndex:findNodeIndex,split:split,bind:bind,unbind:unbind,fire:fire,getContentEditable:getContentEditable,getContentEditableParent:getContentEditableParent,destroy:destroy,isChildOf:isChildOf,dumpRng:dumpRng};return attrHooks=setupAttrHooks(styles,settings,function(){return self}),self}function AddOnManager(){var _this=this,items=[],urls={},lookup={},_listeners=[],get=function(name){if(lookup[name])return lookup[name].instance},dependencies=function(name){var result;return lookup[name]&&(result=lookup[name].dependencies),result||[]},requireLangPack=function(name,languages){var language=AddOnManager.language;if(language&&AddOnManager.languageLoad!==!1){if(languages)if(languages=","+languages+",",languages.indexOf(","+language.substr(0,2)+",")!==-1)language=language.substr(0,2);else if(languages.indexOf(","+language+",")===-1)return;ScriptLoader.ScriptLoader.add(urls[name]+"/langs/"+language+".js")}},add=function(id,addOn,dependencies){items.push(addOn),lookup[id]={instance:addOn,dependencies:dependencies};var result=$_5wjzy24jh8lyw2t.partition(_listeners,function(listener){return listener.name===id});return _listeners=result.fail,each$7(result.pass,function(listener){listener.callback()}),addOn},remove=function(name){delete urls[name],delete lookup[name]},createUrl=function(baseUrl,dep){return"object"==typeof dep?dep:"string"==typeof baseUrl?{prefix:"",resource:dep,suffix:""}:{prefix:baseUrl.prefix,resource:dep,suffix:baseUrl.suffix}},addComponents=function(pluginName,scripts){var pluginUrl=_this.urls[pluginName];each$7(scripts,function(script){ScriptLoader.ScriptLoader.add(pluginUrl+"/"+script)})},loadDependencies=function(addOnUrl,success,scope){var deps=dependencies(name);each$7(deps,function(dep){var newUrl=createUrl(addOnUrl,dep);load(newUrl.resource,newUrl,void 0,void 0)}),success&&(scope?success.call(scope):success.call(ScriptLoader))},load=function(name,addOnUrl,success,scope,failure){if(!urls[name]){var urlString="string"==typeof addOnUrl?addOnUrl:addOnUrl.prefix+addOnUrl.resource+addOnUrl.suffix;0!==urlString.indexOf("/")&&urlString.indexOf("://")===-1&&(urlString=AddOnManager.baseURL+"/"+urlString),urls[name]=urlString.substring(0,urlString.lastIndexOf("/")),lookup[name]?loadDependencies(addOnUrl,success,scope):ScriptLoader.ScriptLoader.add(urlString,function(){return loadDependencies(addOnUrl,success,scope)},scope,failure)}},waitFor=function(name,callback){lookup.hasOwnProperty(name)?callback():_listeners.push({name:name,callback:callback})};return{items:items,urls:urls,lookup:lookup,_listeners:_listeners,get:get,dependencies:dependencies,requireLangPack:requireLangPack,add:add,remove:remove,createUrl:createUrl,addComponents:addComponents,load:load,waitFor:waitFor}}function CaretPosition(container,offset,clientRects){var isAtStart=function(){return isText$4(container)?0===offset:0===offset},isAtEnd=function(){return isText$4(container)?offset>=container.data.length:offset>=container.childNodes.length},toRange=function(){var range;return range=createRange(container.ownerDocument),range.setStart(container,offset),range.setEnd(container,offset),range},getClientRects=function(){return clientRects||(clientRects=getCaretPositionClientRects(CaretPosition(container,offset))),clientRects},isVisible=function(){return getClientRects().length>0},isEqual$$1=function(caretPosition){return caretPosition&&container===caretPosition.container()&&offset===caretPosition.offset()},getNode$$1=function(before){return resolveIndex(container,before?offset-1:offset)};return{container:$_8aqzj925jh8lywmj.constant(container),offset:$_8aqzj925jh8lywmj.constant(offset),toRange:toRange,getClientRects:getClientRects,isVisible:isVisible,isAtStart:isAtStart,isAtEnd:isAtEnd,isEqual:isEqual$$1,getNode:getNode$$1}}function NodeValue(is,name){var get=function(element){if(!is(element))throw new Error("Can only get "+name+" value of a "+name+" node");return getOption(element).getOr("")},getOptionIE10=function(element){try{return getOptionSafe(element)}catch(e){return Option.none()}},getOptionSafe=function(element){return is(element)?Option.from(element.dom().nodeValue):Option.none()},browser=$_9hkktfnjh8lywc6.detect().browser,getOption=browser.isIE()&&10===browser.version.major?getOptionIE10:getOptionSafe,set=function(element,value){if(!is(element))throw new Error("Can only set raw "+name+" value of a "+name+" node");element.dom().nodeValue=value};return{get:get,getOption:getOption,set:set}}function Writer(settings){var indent,indentBefore,indentAfter,encode,htmlOutput,html=[];return settings=settings||{},indent=settings.indent,indentBefore=makeMap$3(settings.indent_before||""),indentAfter=makeMap$3(settings.indent_after||""),encode=$_gex7a11rjh8lywi4.getEncodeFunc(settings.entity_encoding||"raw",settings.entities),htmlOutput="html"===settings.element_format,{start:function(name,attrs,empty){var i,l,attr,value;if(indent&&indentBefore[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n")),html.push("<",name),attrs)for(i=0,l=attrs.length;i<l;i++)attr=attrs[i],html.push(" ",attr.name,'="',encode(attr.value,!0),'"');!empty||htmlOutput?html[html.length]=">":html[html.length]=" />",empty&&indent&&indentAfter[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n"))},end:function(name){var value;html.push("</",name,">"),indent&&indentAfter[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n"))},text:function(text,raw){text.length>0&&(html[html.length]=raw?text:encode(text))},cdata:function(text){html.push("<![CDATA[",text,"]]>")},comment:function(text){html.push("<!--",text,"-->")},pi:function(name,text){text?html.push("<?",name," ",encode(text),"?>"):html.push("<?",name,"?>"),indent&&html.push("\n")},doctype:function(text){html.push("<!DOCTYPE",text,">",indent?"\n":"")},reset:function(){html.length=0},getContent:function(){return html.join("").replace(/\n$/,"")}}}function HtmlSerializer(settings,schema){void 0===schema&&(schema=Schema());var writer=Writer(settings);settings=settings||{},settings.validate=!("validate"in settings)||settings.validate;var serialize=function(node){var handlers,validate;validate=settings.validate,handlers={3:function(node){writer.text(node.value,node.raw)},8:function(node){writer.comment(node.value)},7:function(node){writer.pi(node.name,node.value)},10:function(node){writer.doctype(node.value)},4:function(node){writer.cdata(node.value)},11:function(node){if(node=node.firstChild)do walk(node);while(node=node.next)}},writer.reset();var walk=function(node){var name,isEmpty,attrs,attrName,attrValue,sortedAttrs,i,l,elementRule,handler=handlers[node.type];if(handler)handler(node);else{if(name=node.name,isEmpty=node.shortEnded,attrs=node.attributes,validate&&attrs&&attrs.length>1&&(sortedAttrs=[],sortedAttrs.map={},elementRule=schema.getElementRule(node.name))){for(i=0,l=elementRule.attributesOrder.length;i<l;i++)attrName=elementRule.attributesOrder[i],attrName in attrs.map&&(attrValue=attrs.map[attrName],sortedAttrs.map[attrName]=attrValue,sortedAttrs.push({name:attrName,value:attrValue}));for(i=0,l=attrs.length;i<l;i++)attrName=attrs[i].name,attrName in sortedAttrs.map||(attrValue=attrs.map[attrName],sortedAttrs.map[attrName]=attrValue,sortedAttrs.push({name:attrName,value:attrValue}));attrs=sortedAttrs}if(writer.start(node.name,attrs,isEmpty),!isEmpty){if(node=node.firstChild)do walk(node);while(node=node.next);writer.end(name)}}};return 1!==node.type||settings.inner?handlers[11](node):walk(node),writer.getContent()};return{serialize:serialize}}function ClosestOrAncestor(is,ancestor,scope,a,isRoot){return is(scope,a)?Option.some(scope):$_dp4g6d7jh8lyw3y.isFunction(isRoot)&&isRoot(scope)?Option.none():ancestor(scope,a,isRoot)}function EditorCommands(editor){var dom,selection,formatter,bookmark,commands={state:{},exec:{},value:{}},settings=editor.settings;editor.on("PreInit",function(){dom=editor.dom,selection=editor.selection,settings=editor.settings,formatter=editor.formatter});var execCommand=function(command,ui,value,args){var func,customCommand,state=!1;if(!editor.removed){if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command)||args&&args.skip_focus?$_eqs11m40jh8lyx31.restore(editor):editor.focus(),args=editor.fire("BeforeExecCommand",{command:command,ui:ui,value:value}),args.isDefaultPrevented())return!1;if(customCommand=command.toLowerCase(),func=commands.exec[customCommand])return func(customCommand,ui,value),editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0;if(each$9(editor.plugins,function(p){if(p.execCommand&&p.execCommand(command,ui,value))return editor.fire("ExecCommand",{command:command,ui:ui,value:value}),state=!0,!1}),state)return state;if(editor.theme&&editor.theme.execCommand&&editor.theme.execCommand(command,ui,value))return editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0;try{state=editor.getDoc().execCommand(command,ui,value)}catch(ex){}return!!state&&(editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0)}},queryCommandState=function(command){var func;if(!editor.quirks.isHidden()&&!editor.removed){if(command=command.toLowerCase(),func=commands.state[command])return func(command);try{return editor.getDoc().queryCommandState(command)}catch(ex){}return!1}},queryCommandValue=function(command){var func;if(!editor.quirks.isHidden()&&!editor.removed){if(command=command.toLowerCase(),func=commands.value[command])return func(command);try{return editor.getDoc().queryCommandValue(command)}catch(ex){}}},addCommands=function(commandList,type){type=type||"exec",each$9(commandList,function(callback,command){each$9(command.toLowerCase().split(","),function(command){commands[type][command]=callback})})},addCommand=function(command,callback,scope){command=command.toLowerCase(),commands.exec[command]=function(command,ui,value,args){return callback.call(scope||editor,ui,value,args)}},queryCommandSupported=function(command){if(command=command.toLowerCase(),commands.exec[command])return!0;try{return editor.getDoc().queryCommandSupported(command)}catch(ex){}return!1},addQueryStateHandler=function(command,callback,scope){command=command.toLowerCase(),commands.state[command]=function(){return callback.call(scope||editor)}},addQueryValueHandler=function(command,callback,scope){command=command.toLowerCase(),commands.value[command]=function(){return callback.call(scope||editor)}},hasCustomCommand=function(command){return command=command.toLowerCase(),!!commands.exec[command]};extend$2(this,{execCommand:execCommand,queryCommandState:queryCommandState,queryCommandValue:queryCommandValue,queryCommandSupported:queryCommandSupported,addCommands:addCommands,addCommand:addCommand,addQueryStateHandler:addQueryStateHandler,addQueryValueHandler:addQueryValueHandler,hasCustomCommand:hasCustomCommand});var execNativeCommand=function(command,ui,value){return void 0===ui&&(ui=!1),void 0===value&&(value=null),editor.getDoc().execCommand(command,ui,value)},isFormatMatch=function(name){return formatter.match(name)},toggleFormat=function(name,value){formatter.toggle(name,value?{value:value}:void 0),editor.nodeChanged()},storeSelection=function(type){bookmark=selection.getBookmark(type)},restoreSelection=function(){selection.moveToBookmark(bookmark)};addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){editor.undoManager.add()},"Cut,Copy,Paste":function(command){var failed,doc=editor.getDoc();try{execNativeCommand(command)}catch(ex){failed=!0}if("paste"!==command||doc.queryCommandEnabled(command)||(failed=!0),failed||!doc.queryCommandSupported(command)){var msg=editor.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");$_9bpim8ajh8lyw68.mac&&(msg=msg.replace(/Ctrl\+/g,"⌘+")),editor.notificationManager.open({text:msg,type:"error"})}},unlink:function(){if(selection.isCollapsed()){var elm=editor.dom.getParent(editor.selection.getStart(),"a");return void(elm&&editor.dom.remove(elm,!0))}formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(command){var align=command.substring(7);"full"===align&&(align="justify"),each$9("left,center,right,justify".split(","),function(name){align!==name&&formatter.remove("align"+name)}),"none"!==align&&toggleFormat("align"+align)},"InsertUnorderedList,InsertOrderedList":function(command){var listElm,listParent;execNativeCommand(command),listElm=dom.getParent(selection.getNode(),"ol,ul"),listElm&&(listParent=listElm.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)&&(storeSelection(),dom.split(listParent,listElm),restoreSelection()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){toggleFormat(command)},"ForeColor,HiliteColor":function(command,ui,value){toggleFormat(command,value)},FontName:function(command,ui,value){fontNameAction(editor,value)},FontSize:function(command,ui,value){fontSizeAction(editor,value)},RemoveFormat:function(command){formatter.remove(command)},mceBlockQuote:function(){toggleFormat("blockquote")},FormatBlock:function(command,ui,value){return toggleFormat(value||"p")},mceCleanup:function(){var bookmark=selection.getBookmark();editor.setContent(editor.getContent()),selection.moveToBookmark(bookmark)},mceRemoveNode:function(command,ui,value){var node=value||selection.getNode();node!==editor.getBody()&&(storeSelection(),editor.dom.remove(node,!0),restoreSelection())},mceSelectNodeDepth:function(command,ui,value){var counter=0;dom.getParent(selection.getNode(),function(node){if(1===node.nodeType&&counter++===value)return selection.select(node),!1},editor.getBody())},mceSelectNode:function(command,ui,value){selection.select(value)},mceInsertContent:function(command,ui,value){$_13xltl1wjh8lywkr.insertAtCaret(editor,value)},mceInsertRawHTML:function(command,ui,value){var content=editor.getContent();selection.setContent("tiny_mce_marker"),editor.setContent(content.replace(/tiny_mce_marker/g,function(){return value}))},mceToggleFormat:function(command,ui,value){toggleFormat(value)},mceSetContent:function(command,ui,value){editor.setContent(value)},"Indent,Outdent":function(command){handle(editor,command)},mceRepaint:function(){},InsertHorizontalRule:function(){editor.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){editor.hasVisual=!editor.hasVisual,editor.addVisual()},mceReplaceContent:function(command,ui,value){editor.execCommand("mceInsertContent",!1,value.replace(/\{\$selection\}/g,selection.getContent({format:"text"})))},mceInsertLink:function(command,ui,value){var anchor;"string"==typeof value&&(value={href:value}),anchor=dom.getParent(selection.getNode(),"a"),value.href=value.href.replace(" ","%20"),anchor&&value.href||formatter.remove("link"),value.href&&formatter.apply("link",value,anchor)},selectAll:function(){var editingHost=dom.getParent(selection.getStart(),$_5oonaz1qjh8lywhz.isContentEditableTrue);if(editingHost){var rng=dom.createRng();rng.selectNodeContents(editingHost),selection.setRng(rng)}},"delete":function(){$_fmagiy31jh8lywrp.deleteCommand(editor)},forwardDelete:function(){$_fmagiy31jh8lywrp.forwardDeleteCommand(editor)},mceNewDocument:function(){editor.setContent("")},InsertLineBreak:function(command,ui,value){return $_cg4dz53xjh8lyx2g.insert(editor,value),!0}});var alignStates=function(name){return function(){var nodes=selection.isCollapsed()?[dom.getParent(selection.getNode(),dom.isBlock)]:selection.getSelectedBlocks(),matches=map$2(nodes,function(node){return!!formatter.matchNode(node,name)});return inArray$2(matches,!0)!==-1}};addCommands({JustifyLeft:alignStates("alignleft"),JustifyCenter:alignStates("aligncenter"),JustifyRight:alignStates("alignright"),JustifyFull:alignStates("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){return isFormatMatch(command)},mceBlockQuote:function(){return isFormatMatch("blockquote")},Outdent:function(){var node;if(settings.inline_styles){if((node=dom.getParent(selection.getStart(),dom.isBlock))&&parseInt(node.style.paddingLeft,10)>0)return!0;if((node=dom.getParent(selection.getEnd(),dom.isBlock))&&parseInt(node.style.paddingLeft,10)>0)return!0}return queryCommandState("InsertUnorderedList")||queryCommandState("InsertOrderedList")||!settings.inline_styles&&!!dom.getParent(selection.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(command){var list=dom.getParent(selection.getNode(),"ul,ol");return list&&("insertunorderedlist"===command&&"UL"===list.tagName||"insertorderedlist"===command&&"OL"===list.tagName)}},"state"),addCommands({Undo:function(){editor.undoManager.undo()},Redo:function(){editor.undoManager.redo()}}),addQueryValueHandler("FontName",function(){return fontNameQuery(editor)},this),addQueryValueHandler("FontSize",function(){return fontSizeQuery(editor)},this)}function Toggler(turnOff,turnOn,initial){var active=initial||!1,on=function(){turnOn(),active=!0},off=function(){turnOff(),active=!1},toggle=function(){var f=active?off:on;f()},isOn=function(){return active};return{on:on,off:off,toggle:toggle,isOn:isOn}}function Shortcuts(editor){var self=this,shortcuts={},pendingPatterns=[],parseShortcut=function(pattern){var id,key,shortcut={};each$10(explode$2(pattern,"+"),function(value){value in modifierNames?shortcut[value]=!0:/^[0-9]{2,}$/.test(value)?shortcut.keyCode=parseInt(value,10):(shortcut.charCode=value.charCodeAt(0),shortcut.keyCode=keyCodeLookup[value]||value.toUpperCase().charCodeAt(0))}),id=[shortcut.keyCode];for(key in modifierNames)shortcut[key]?id.push(key):shortcut[key]=!1;return shortcut.id=id.join(","),shortcut.access&&(shortcut.alt=!0,$_9bpim8ajh8lyw68.mac?shortcut.ctrl=!0:shortcut.shift=!0),shortcut.meta&&($_9bpim8ajh8lyw68.mac?shortcut.meta=!0:(shortcut.ctrl=!0,shortcut.meta=!1)),shortcut},createShortcut=function(pattern,desc,cmdFunc,scope){var shortcuts;return shortcuts=$_ahowuxkjh8lywbj.map(explode$2(pattern,">"),parseShortcut),shortcuts[shortcuts.length-1]=$_ahowuxkjh8lywbj.extend(shortcuts[shortcuts.length-1],{func:cmdFunc,scope:scope||editor}),$_ahowuxkjh8lywbj.extend(shortcuts[0],{desc:editor.translate(desc),subpatterns:shortcuts.slice(1)})},hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},isFunctionKey=function(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123},matchShortcut=function(e,shortcut){return!!shortcut&&(shortcut.ctrl===e.ctrlKey&&shortcut.meta===e.metaKey&&(shortcut.alt===e.altKey&&shortcut.shift===e.shiftKey&&(!!(e.keyCode===shortcut.keyCode||e.charCode&&e.charCode===shortcut.charCode)&&(e.preventDefault(),!0))))},executeShortcutAction=function(shortcut){return shortcut.func?shortcut.func.call(shortcut.scope):null};editor.on("keyup keypress keydown",function(e){!hasModifier(e)&&!isFunctionKey(e)||e.isDefaultPrevented()||(each$10(shortcuts,function(shortcut){if(matchShortcut(e,shortcut))return pendingPatterns=shortcut.subpatterns.slice(0),"keydown"===e.type&&executeShortcutAction(shortcut),!0}),matchShortcut(e,pendingPatterns[0])&&(1===pendingPatterns.length&&"keydown"===e.type&&executeShortcutAction(pendingPatterns[0]),pendingPatterns.shift()))}),self.add=function(pattern,desc,cmdFunc,scope){var cmd;return cmd=cmdFunc,"string"==typeof cmdFunc?cmdFunc=function(){editor.execCommand(cmd,!1,null)}:$_ahowuxkjh8lywbj.isArray(cmd)&&(cmdFunc=function(){editor.execCommand(cmd[0],cmd[1],cmd[2])}),each$10(explode$2($_ahowuxkjh8lywbj.trim(pattern.toLowerCase())),function(pattern){var shortcut=createShortcut(pattern,desc,cmdFunc,scope);shortcuts[shortcut.id]=shortcut}),!0},self.remove=function(pattern){var shortcut=createShortcut(pattern);return!!shortcuts[shortcut.id]&&(delete shortcuts[shortcut.id],!0)}}function NotificationManagerImpl(){var unimplemented=function(){throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:unimplemented,close:unimplemented,reposition:unimplemented,getArgs:unimplemented}}function NotificationManager(editor){var notifications=[],getImplementation=function(){var theme=editor.theme;return theme&&theme.getNotificationManagerImpl?theme.getNotificationManagerImpl():NotificationManagerImpl()},getTopNotification=function(){return Option.from(notifications[0])},isEqual=function(a,b){return!(a.type!==b.type||a.text!==b.text||a.progressBar||a.timeout||b.progressBar||b.timeout)},reposition=function(){notifications.length>0&&getImplementation().reposition(notifications)},addNotification=function(notification){notifications.push(notification)},closeNotification=function(notification){$_5wjzy24jh8lyw2t.findIndex(notifications,function(otherNotification){return otherNotification===notification}).each(function(index){notifications.splice(index,1)})},open=function(args){if(!editor.removed&&$_7f1iw94jjh8lyx60.isEditorAttachedToDom(editor))return $_5wjzy24jh8lyw2t.find(notifications,function(notification){return isEqual(getImplementation().getArgs(notification),args)}).getOrThunk(function(){editor.editorManager.setActive(editor);var notification=getImplementation().open(args,function(){closeNotification(notification),reposition()});return addNotification(notification),reposition(),notification})},close=function(){getTopNotification().each(function(notification){getImplementation().close(notification),closeNotification(notification),reposition()})},getNotifications=function(){return notifications},registerEvents=function(editor){editor.on("SkinLoaded",function(){var serviceMessage=editor.settings.service_message;serviceMessage&&open({text:serviceMessage,type:"warning",timeout:0,icon:""})}),editor.on("ResizeEditor ResizeWindow",function(){$_8sy3pfhjh8lyw95.requestAnimationFrame(reposition)}),editor.on("remove",function(){$_5wjzy24jh8lyw2t.each(notifications,function(notification){getImplementation().close(notification)})})};return registerEvents(editor),{open:open,close:close,getNotifications:getNotifications}}function WindowManagerImpl(){var unimplemented=function(){throw new Error("Theme did not provide a WindowManager implementation.")};return{open:unimplemented,alert:unimplemented,confirm:unimplemented,close:unimplemented,getParams:unimplemented,setParams:unimplemented}}function WindowManager(editor){var windows=[],getImplementation=function(){var theme=editor.theme;return theme&&theme.getWindowManagerImpl?theme.getWindowManagerImpl():WindowManagerImpl()},funcBind=function(scope,f){return function(){return f?f.apply(scope,arguments):void 0}},fireOpenEvent=function(win){editor.fire("OpenWindow",{win:win})},fireCloseEvent=function(win){editor.fire("CloseWindow",{win:win})},addWindow=function(win){windows.push(win),fireOpenEvent(win)},closeWindow=function(win){$_5wjzy24jh8lyw2t.findIndex(windows,function(otherWindow){return otherWindow===win}).each(function(index){windows.splice(index,1),fireCloseEvent(win),0===windows.length&&editor.focus()})},getTopWindow=function(){return Option.from(windows[windows.length-1])},open=function(args,params){editor.editorManager.setActive(editor),$_eqs11m40jh8lyx31.store(editor);var win=getImplementation().open(args,params,closeWindow);return addWindow(win),win},alert=function(message,callback,scope){var win=getImplementation().alert(message,funcBind(scope?scope:this,callback),closeWindow);addWindow(win)},confirm=function(message,callback,scope){var win=getImplementation().confirm(message,funcBind(scope?scope:this,callback),closeWindow);addWindow(win)},close=function(){getTopWindow().each(function(win){getImplementation().close(win),closeWindow(win)})},getParams=function(){return getTopWindow().map(getImplementation().getParams).getOr(null)},setParams=function(params){getTopWindow().each(function(win){getImplementation().setParams(win,params)})},getWindows=function(){return windows};return editor.on("remove",function(){$_5wjzy24jh8lyw2t.each(windows.slice(0),function(win){getImplementation().close(win)})}),{windows:windows,open:open,alert:alert,confirm:confirm,close:close,getParams:getParams,setParams:setParams,getWindows:getWindows}}function XMLHttpRequest(){var f=$_99xmy7cjh8lyw6k.getOrDie("XMLHttpRequest");return new f}function Uploader(uploadStatus,settings){var pendingPromises={},pathJoin=function(path1,path2){return path1?path1.replace(/\/$/,"")+"/"+path2.replace(/^\//,""):path2},defaultHandler=function(blobInfo,success,failure,progress){var xhr,formData;xhr=new XMLHttpRequest,xhr.open("POST",settings.url),xhr.withCredentials=settings.credentials,xhr.upload.onprogress=function(e){progress(e.loaded/e.total*100)},xhr.onerror=function(){failure("Image upload failed due to a XHR Transport error. Code: "+xhr.status)},xhr.onload=function(){var json;return xhr.status<200||xhr.status>=300?void failure("HTTP Error: "+xhr.status):(json=JSON.parse(xhr.responseText),json&&"string"==typeof json.location?void success(pathJoin(settings.basePath,json.location)):void failure("Invalid JSON: "+xhr.responseText))},formData=new FormData,formData.append("file",blobInfo.blob(),blobInfo.filename()),xhr.send(formData)},noUpload=function(){return new promiseObj(function(resolve){resolve([])})},handlerSuccess=function(blobInfo,url){return{url:url,blobInfo:blobInfo,status:!0}},handlerFailure=function(blobInfo,error){return{url:"",blobInfo:blobInfo,status:!1,error:error}},resolvePending=function(blobUri,result){$_ahowuxkjh8lywbj.each(pendingPromises[blobUri],function(resolve){resolve(result)}),delete pendingPromises[blobUri]},uploadBlobInfo=function(blobInfo,handler,openNotification){return uploadStatus.markPending(blobInfo.blobUri()),new promiseObj(function(resolve){var notification,progress,noop=function(){};try{var closeNotification_1=function(){notification&&(notification.close(),progress=noop)},success=function(url){closeNotification_1(),uploadStatus.markUploaded(blobInfo.blobUri(),url),resolvePending(blobInfo.blobUri(),handlerSuccess(blobInfo,url)),resolve(handlerSuccess(blobInfo,url))},failure=function(error){closeNotification_1(),uploadStatus.removeFailed(blobInfo.blobUri()),resolvePending(blobInfo.blobUri(),handlerFailure(blobInfo,error)),resolve(handlerFailure(blobInfo,error))};progress=function(percent){percent<0||percent>100||(notification||(notification=openNotification()),notification.progressBar.value(percent))},handler(blobInfo,success,failure,progress)}catch(ex){resolve(handlerFailure(blobInfo,ex.message))}})},isDefaultHandler=function(handler){return handler===defaultHandler},pendingUploadBlobInfo=function(blobInfo){var blobUri=blobInfo.blobUri();return new promiseObj(function(resolve){pendingPromises[blobUri]=pendingPromises[blobUri]||[],pendingPromises[blobUri].push(resolve)})},uploadBlobs=function(blobInfos,openNotification){return blobInfos=$_ahowuxkjh8lywbj.grep(blobInfos,function(blobInfo){return!uploadStatus.isUploaded(blobInfo.blobUri())}),promiseObj.all($_ahowuxkjh8lywbj.map(blobInfos,function(blobInfo){return uploadStatus.isPending(blobInfo.blobUri())?pendingUploadBlobInfo(blobInfo):uploadBlobInfo(blobInfo,settings.handler,openNotification)}))},upload=function(blobInfos,openNotification){return!settings.url&&isDefaultHandler(settings.handler)?noUpload():uploadBlobs(blobInfos,openNotification)};return settings=$_ahowuxkjh8lywbj.extend({credentials:!1,handler:defaultHandler},settings),{upload:upload}}function Blob(parts,properties){var f=$_99xmy7cjh8lyw6k.getOrDie("Blob");return new f(parts,properties)}function FileReader(){var f=$_99xmy7cjh8lyw6k.getOrDie("FileReader");return new f}function Uint8Array(arr){var f=$_99xmy7cjh8lyw6k.getOrDie("Uint8Array");return new f(arr)}function ImageScanner(uploadStatus,blobCache){var cachedPromises={},findAll=function(elm,predicate){var images;predicate||(predicate=$_8aqzj925jh8lywmj.constant(!0)),images=$_9tjm51ljh8lywbq.filter(getAllImages(elm),function(img){var src=img.src;return!!$_9bpim8ajh8lyw68.fileApi&&(!img.hasAttribute("data-mce-bogus")&&(!img.hasAttribute("data-mce-placeholder")&&(!(!src||src===$_9bpim8ajh8lyw68.transparentSrc)&&(0===src.indexOf("blob:")?!uploadStatus.isUploaded(src):0===src.indexOf("data:")&&predicate(img)))))});var promises=$_9tjm51ljh8lywbq.map(images,function(img){if(cachedPromises[img.src])return new promiseObj(function(resolve){cachedPromises[img.src].then(function(imageInfo){return"string"==typeof imageInfo?imageInfo:void resolve({image:img,blobInfo:imageInfo.blobInfo})})});var newPromise=new promiseObj(function(resolve,reject){imageToBlobInfo(blobCache,img,resolve,reject)}).then(function(result){return delete cachedPromises[result.image.src],result})["catch"](function(error){return delete cachedPromises[img.src],error});return cachedPromises[img.src]=newPromise,newPromise});return promiseObj.all(promises)};return{findAll:findAll}}function BlobCache(){var cache=[],constant=$_8aqzj925jh8lywmj.constant,mimeToExt=function(mime){var mimes={"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png"};return mimes[mime.toLowerCase()]||"dat"},create=function(o,blob,base64,filename){return toBlobInfo("object"==typeof o?o:{id:o,name:filename,blob:blob,base64:base64})},toBlobInfo=function(o){var id,name;if(!o.blob||!o.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");return id=o.id||$_co2y7g52jh8lyx8f.uuid("blobid"),name=o.name||id,{id:constant(id),name:constant(name),filename:constant(name+"."+mimeToExt(o.blob.type)),blob:constant(o.blob),base64:constant(o.base64),blobUri:constant(o.blobUri||$_ge0pt0bjh8lyw6g.createObjectURL(o.blob)),uri:constant(o.uri)}},add=function(blobInfo){get(blobInfo.id())||cache.push(blobInfo)},get=function(id){return findFirst(function(cachedBlobInfo){return cachedBlobInfo.id()===id})},findFirst=function(predicate){return $_9tjm51ljh8lywbq.filter(cache,predicate)[0]},getByUri=function(blobUri){return findFirst(function(blobInfo){return blobInfo.blobUri()===blobUri})},removeByUri=function(blobUri){cache=$_9tjm51ljh8lywbq.filter(cache,function(blobInfo){return blobInfo.blobUri()!==blobUri||($_ge0pt0bjh8lyw6g.revokeObjectURL(blobInfo.blobUri()),!1)})},destroy=function(){$_9tjm51ljh8lywbq.each(cache,function(cachedBlobInfo){$_ge0pt0bjh8lyw6g.revokeObjectURL(cachedBlobInfo.blobUri())}),cache=[]};return{create:create,add:add,get:get,getByUri:getByUri,findFirst:findFirst,removeByUri:removeByUri,destroy:destroy}}function UploadStatus(){var PENDING=1,UPLOADED=2,blobUriStatuses={},createStatus=function(status,resultUri){return{status:status,resultUri:resultUri}},hasBlobUri=function(blobUri){return blobUri in blobUriStatuses;
},getResultUri=function(blobUri){var result=blobUriStatuses[blobUri];return result?result.resultUri:null},isPending=function(blobUri){return!!hasBlobUri(blobUri)&&blobUriStatuses[blobUri].status===PENDING},isUploaded=function(blobUri){return!!hasBlobUri(blobUri)&&blobUriStatuses[blobUri].status===UPLOADED},markPending=function(blobUri){blobUriStatuses[blobUri]=createStatus(PENDING,null)},markUploaded=function(blobUri,resultUri){blobUriStatuses[blobUri]=createStatus(UPLOADED,resultUri)},removeFailed=function(blobUri){delete blobUriStatuses[blobUri]},destroy=function(){blobUriStatuses={}};return{hasBlobUri:hasBlobUri,getResultUri:getResultUri,isPending:isPending,isUploaded:isUploaded,markPending:markPending,markUploaded:markUploaded,removeFailed:removeFailed,destroy:destroy}}function EditorUpload(editor){var uploader,imageScanner,blobCache=BlobCache(),settings=editor.settings,uploadStatus=UploadStatus(),aliveGuard=function(callback){return function(result){return editor.selection?callback(result):[]}},cacheInvalidator=function(){return"?"+(new Date).getTime()},replaceString=function(content,search,replace){var index=0;do index=content.indexOf(search,index),index!==-1&&(content=content.substring(0,index)+replace+content.substr(index+search.length),index+=replace.length-search.length+1);while(index!==-1);return content},replaceImageUrl=function(content,targetUrl,replacementUrl){return content=replaceString(content,'src="'+targetUrl+'"','src="'+replacementUrl+'"'),content=replaceString(content,'data-mce-src="'+targetUrl+'"','data-mce-src="'+replacementUrl+'"')},replaceUrlInUndoStack=function(targetUrl,replacementUrl){$_9tjm51ljh8lywbq.each(editor.undoManager.data,function(level){"fragmented"===level.type?level.fragments=$_9tjm51ljh8lywbq.map(level.fragments,function(fragment){return replaceImageUrl(fragment,targetUrl,replacementUrl)}):level.content=replaceImageUrl(level.content,targetUrl,replacementUrl)})},openNotification=function(){return editor.notificationManager.open({text:editor.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})},replaceImageUri=function(image,resultUri){blobCache.removeByUri(image.src),replaceUrlInUndoStack(image.src,resultUri),editor.$(image).attr({src:settings.images_reuse_filename?resultUri+cacheInvalidator():resultUri,"data-mce-src":editor.convertURL(resultUri,"src")})},uploadImages=function(callback){return uploader||(uploader=Uploader(uploadStatus,{url:settings.images_upload_url,basePath:settings.images_upload_base_path,credentials:settings.images_upload_credentials,handler:settings.images_upload_handler})),scanForImages().then(aliveGuard(function(imageInfos){var blobInfos;return blobInfos=$_9tjm51ljh8lywbq.map(imageInfos,function(imageInfo){return imageInfo.blobInfo}),uploader.upload(blobInfos,openNotification).then(aliveGuard(function(result){var filteredResult=$_9tjm51ljh8lywbq.map(result,function(uploadInfo,index){var image=imageInfos[index].image;return uploadInfo.status&&editor.settings.images_replace_blob_uris!==!1?replaceImageUri(image,uploadInfo.url):uploadInfo.error&&$_5vy074njh8lyx6h.uploadError(editor,uploadInfo.error),{element:image,status:uploadInfo.status}});return callback&&callback(filteredResult),filteredResult}))}))},uploadImagesAuto=function(callback){if(settings.automatic_uploads!==!1)return uploadImages(callback)},isValidDataUriImage=function(imgElm){return!settings.images_dataimg_filter||settings.images_dataimg_filter(imgElm)},scanForImages=function(){return imageScanner||(imageScanner=ImageScanner(uploadStatus,blobCache)),imageScanner.findAll(editor.getBody(),isValidDataUriImage).then(aliveGuard(function(result){return result=$_9tjm51ljh8lywbq.filter(result,function(resultItem){return"string"!=typeof resultItem||($_5vy074njh8lyx6h.displayError(editor,resultItem),!1)}),$_9tjm51ljh8lywbq.each(result,function(resultItem){replaceUrlInUndoStack(resultItem.image.src,resultItem.blobInfo.blobUri()),resultItem.image.src=resultItem.blobInfo.blobUri(),resultItem.image.removeAttribute("data-mce-src")}),result}))},destroy=function(){blobCache.destroy(),uploadStatus.destroy(),imageScanner=uploader=null},replaceBlobUris=function(content){return content.replace(/src="(blob:[^"]+)"/g,function(match,blobUri){var resultUri=uploadStatus.getResultUri(blobUri);if(resultUri)return'src="'+resultUri+'"';var blobInfo=blobCache.getByUri(blobUri);return blobInfo||(blobInfo=$_9tjm51ljh8lywbq.reduce(editor.editorManager.get(),function(result,editor){return result||editor.editorUpload&&editor.editorUpload.blobCache.getByUri(blobUri)},null)),blobInfo?'src="data:'+blobInfo.blob().type+";base64,"+blobInfo.base64()+'"':match})};return editor.on("setContent",function(){editor.settings.automatic_uploads!==!1?uploadImagesAuto():scanForImages()}),editor.on("RawSaveContent",function(e){e.content=replaceBlobUris(e.content)}),editor.on("getContent",function(e){e.source_view||"raw"===e.format||(e.content=replaceBlobUris(e.content))}),editor.on("PostRender",function(){editor.parser.addNodeFilter("img",function(images){$_9tjm51ljh8lywbq.each(images,function(img){var src=img.attr("src");if(!blobCache.getByUri(src)){var resultUri=uploadStatus.getResultUri(src);resultUri&&img.attr("src",resultUri)}})})}),{blobCache:blobCache,uploadImages:uploadImages,uploadImagesAuto:uploadImagesAuto,scanForImages:scanForImages,destroy:destroy}}function NodeChange(editor){var lastRng,lastPath=[],isSameElementPath=function(startElm){var i,currentPath;if(currentPath=editor.$(startElm).parentsUntil(editor.getBody()).add(startElm),currentPath.length===lastPath.length){for(i=currentPath.length;i>=0&&currentPath[i]===lastPath[i];i--);if(i===-1)return lastPath=currentPath,!0}return lastPath=currentPath,!1};"onselectionchange"in editor.getDoc()||editor.on("NodeChange Click MouseUp KeyUp Focus",function(e){var nativeRng,fakeRng;nativeRng=editor.selection.getRng(),fakeRng={startContainer:nativeRng.startContainer,startOffset:nativeRng.startOffset,endContainer:nativeRng.endContainer,endOffset:nativeRng.endOffset},"nodechange"!==e.type&&$_aayq8q3zjh8lyx2z.isEq(fakeRng,lastRng)||editor.fire("SelectionChange"),lastRng=fakeRng}),editor.on("contextmenu",function(){editor.fire("SelectionChange")}),editor.on("SelectionChange",function(){var startElm=editor.selection.getStart(!0);!startElm||!$_9bpim8ajh8lyw68.range&&editor.selection.isCollapsed()||hasAnyRanges(editor)&&!isSameElementPath(startElm)&&editor.dom.isChildOf(startElm,editor.getBody())&&editor.nodeChanged({selectionChange:!0})}),editor.on("MouseUp",function(e){!e.isDefaultPrevented()&&hasAnyRanges(editor)&&("IMG"===editor.selection.getNode().nodeName?$_8sy3pfhjh8lyw95.setEditorTimeout(editor,function(){editor.nodeChanged()}):editor.nodeChanged())}),this.nodeChanged=function(args){var node,parents,root,selection=editor.selection;editor.initialized&&selection&&!editor.settings.disable_nodechange&&!editor.readonly&&(root=editor.getBody(),node=selection.getStart(!0)||root,node.ownerDocument===editor.getDoc()&&editor.dom.isChildOf(node,root)||(node=root),parents=[],editor.dom.getParent(node,function(node){return node===root||void parents.push(node)}),args=args||{},args.element=node,args.parents=parents,editor.fire("NodeChange",args))}}function SaxParser(settings,schema){void 0===schema&&(schema=Schema());var noop=function(){};settings=settings||{},settings.fix_self_closing!==!1&&(settings.fix_self_closing=!0);var comment=settings.comment?settings.comment:noop,cdata=settings.cdata?settings.cdata:noop,text=settings.text?settings.text:noop,start=settings.start?settings.start:noop,end=settings.end?settings.end:noop,pi=settings.pi?settings.pi:noop,doctype=settings.doctype?settings.doctype:noop,parse=function(html){var matches,value,endRegExp,attrList,i,textData,name,isInternalElement,removeInternalElements,shortEndedElements,fillAttrsMap,isShortEnded,validate,elementRule,isValidElement,attr,attribsValue,validAttributesMap,validAttributePatterns,attributesRequired,attributesDefault,attributesForced,processHtml,anyAttributesRequired,selfClosing,tokenRegExp,attrRegExp,specialElements,attrValue,fixSelfClosing,index=0,stack=[],idCount=0,decode=$_gex7a11rjh8lywi4.decode,filteredUrlAttrs=$_ahowuxkjh8lywbj.makeMap("src,href,data,background,formaction,poster,xlink:href"),scriptUriRegExp=/((java|vb)script|mhtml):/i,processEndTag=function(name){var pos,i;for(pos=stack.length;pos--&&stack[pos].name!==name;);if(pos>=0){for(i=stack.length-1;i>=pos;i--)name=stack[i],name.valid&&end(name.name);stack.length=pos}},parseAttribute=function(match,name,value,val2,val3){var attrRule,i,trimRegExp=/[\s\u0000-\u001F]+/g;if(name=name.toLowerCase(),value=name in fillAttrsMap?name:decode(value||val2||val3||""),validate&&!isInternalElement&&isValidPrefixAttrName(name)===!1){if(attrRule=validAttributesMap[name],!attrRule&&validAttributePatterns){for(i=validAttributePatterns.length;i--&&(attrRule=validAttributePatterns[i],!attrRule.pattern.test(name)););i===-1&&(attrRule=null)}if(!attrRule)return;if(attrRule.validValues&&!(value in attrRule.validValues))return}if(filteredUrlAttrs[name]&&!settings.allow_script_urls){var uri=value.replace(trimRegExp,"");try{uri=decodeURIComponent(uri)}catch(ex){uri=unescape(uri)}if(scriptUriRegExp.test(uri))return;if(isInvalidUri(settings,uri))return}isInternalElement&&(name in filteredUrlAttrs||0===name.indexOf("on"))||(attrList.map[name]=value,attrList.push({name:name,value:value}))};for(tokenRegExp=new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),attrRegExp=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,shortEndedElements=schema.getShortEndedElements(),selfClosing=settings.self_closing_elements||schema.getSelfClosingElements(),fillAttrsMap=schema.getBoolAttrs(),validate=settings.validate,removeInternalElements=settings.remove_internals,fixSelfClosing=settings.fix_self_closing,specialElements=schema.getSpecialElements(),processHtml=html+">";matches=tokenRegExp.exec(processHtml);){if(index<matches.index&&text(decode(html.substr(index,matches.index-index))),value=matches[6])value=value.toLowerCase(),":"===value.charAt(0)&&(value=value.substr(1)),processEndTag(value);else if(value=matches[7]){if(matches.index+matches[0].length>html.length){text(decode(html.substr(matches.index))),index=matches.index+matches[0].length;continue}if(value=value.toLowerCase(),":"===value.charAt(0)&&(value=value.substr(1)),isShortEnded=value in shortEndedElements,fixSelfClosing&&selfClosing[value]&&stack.length>0&&stack[stack.length-1].name===value&&processEndTag(value),!validate||(elementRule=schema.getElementRule(value))){if(isValidElement=!0,validate&&(validAttributesMap=elementRule.attributes,validAttributePatterns=elementRule.attributePatterns),(attribsValue=matches[8])?(isInternalElement=attribsValue.indexOf("data-mce-type")!==-1,isInternalElement&&removeInternalElements&&(isValidElement=!1),attrList=[],attrList.map={},attribsValue.replace(attrRegExp,parseAttribute)):(attrList=[],attrList.map={}),validate&&!isInternalElement){if(attributesRequired=elementRule.attributesRequired,attributesDefault=elementRule.attributesDefault,attributesForced=elementRule.attributesForced,anyAttributesRequired=elementRule.removeEmptyAttrs,anyAttributesRequired&&!attrList.length&&(isValidElement=!1),attributesForced)for(i=attributesForced.length;i--;)attr=attributesForced[i],name=attr.name,attrValue=attr.value,"{$uid}"===attrValue&&(attrValue="mce_"+idCount++),attrList.map[name]=attrValue,attrList.push({name:name,value:attrValue});if(attributesDefault)for(i=attributesDefault.length;i--;)attr=attributesDefault[i],name=attr.name,name in attrList.map||(attrValue=attr.value,"{$uid}"===attrValue&&(attrValue="mce_"+idCount++),attrList.map[name]=attrValue,attrList.push({name:name,value:attrValue}));if(attributesRequired){for(i=attributesRequired.length;i--&&!(attributesRequired[i]in attrList.map););i===-1&&(isValidElement=!1)}if(attr=attrList.map["data-mce-bogus"]){if("all"===attr){index=findEndTagIndex(schema,html,tokenRegExp.lastIndex),tokenRegExp.lastIndex=index;continue}isValidElement=!1}}isValidElement&&start(value,attrList,isShortEnded)}else isValidElement=!1;if(endRegExp=specialElements[value]){endRegExp.lastIndex=index=matches.index+matches[0].length,(matches=endRegExp.exec(html))?(isValidElement&&(textData=html.substr(index,matches.index-index)),index=matches.index+matches[0].length):(textData=html.substr(index),index=html.length),isValidElement&&(textData.length>0&&text(textData,!0),end(value)),tokenRegExp.lastIndex=index;continue}isShortEnded||(attribsValue&&attribsValue.indexOf("/")===attribsValue.length-1?isValidElement&&end(value):stack.push({name:value,valid:isValidElement}))}else(value=matches[1])?(">"===value.charAt(0)&&(value=" "+value),settings.allow_conditional_comments||"[if"!==value.substr(0,3).toLowerCase()||(value=" "+value),comment(value)):(value=matches[2])?cdata(trimComments(value)):(value=matches[3])?doctype(value):(value=matches[4])&&pi(value,matches[5]);index=matches.index+matches[0].length}for(index<html.length&&text(decode(html.substr(index))),i=stack.length-1;i>=0;i--)value=stack[i],value.valid&&end(value.name)};return{parse:parse}}function UndoManager(editor){var beforeBookmark,isFirstTypedCharacter,self=this,index=0,data=[],locks=0,isUnlocked=function(){return 0===locks},setTyping=function(typing){isUnlocked()&&(self.typing=typing)},setDirty=function(state){editor.setDirty(state)},addNonTypingUndoLevel=function(e){setTyping(!1),self.add({},e)},endTyping=function(){self.typing&&(setTyping(!1),self.add())};editor.on("init",function(){self.add()}),editor.on("BeforeExecCommand",function(e){var cmd=e.command;"Undo"!==cmd&&"Redo"!==cmd&&"mceRepaint"!==cmd&&(endTyping(),self.beforeChange())}),editor.on("ExecCommand",function(e){var cmd=e.command;"Undo"!==cmd&&"Redo"!==cmd&&"mceRepaint"!==cmd&&addNonTypingUndoLevel(e)}),editor.on("ObjectResizeStart Cut",function(){self.beforeChange()}),editor.on("SaveContent ObjectResized blur",addNonTypingUndoLevel),editor.on("DragEnd",addNonTypingUndoLevel),editor.on("KeyUp",function(e){var keyCode=e.keyCode;e.isDefaultPrevented()||((keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||45===keyCode||e.ctrlKey)&&(addNonTypingUndoLevel(),editor.nodeChanged()),46!==keyCode&&8!==keyCode||editor.nodeChanged(),isFirstTypedCharacter&&self.typing&&$_dxjj465ijh8lyxb4.isEq($_dxjj465ijh8lyxb4.createFromEditor(editor),data[0])===!1&&(editor.isDirty()===!1&&(setDirty(!0),editor.fire("change",{level:data[0],lastLevel:null})),editor.fire("TypingUndo"),isFirstTypedCharacter=!1,editor.nodeChanged()))}),editor.on("KeyDown",function(e){var keyCode=e.keyCode;if(!e.isDefaultPrevented()){if(keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||45===keyCode)return void(self.typing&&addNonTypingUndoLevel(e));var modKey=e.ctrlKey&&!e.altKey||e.metaKey;!(keyCode<16||keyCode>20)||224===keyCode||91===keyCode||self.typing||modKey||(self.beforeChange(),setTyping(!0),self.add({},e),isFirstTypedCharacter=!0)}}),editor.on("MouseDown",function(e){self.typing&&addNonTypingUndoLevel(e)});var isInsertReplacementText=function(event){return"insertReplacementText"===event.inputType},isInsertTextDataNull=function(event){return"insertText"===event.inputType&&null===event.data};return editor.on("input",function(e){e.inputType&&(isInsertReplacementText(e)||isInsertTextDataNull(e))&&addNonTypingUndoLevel(e)}),editor.addShortcut("meta+z","","Undo"),editor.addShortcut("meta+y,meta+shift+z","","Redo"),editor.on("AddUndo Undo Redo ClearUndos",function(e){e.isDefaultPrevented()||editor.nodeChanged()}),self={data:data,typing:!1,beforeChange:function(){isUnlocked()&&(beforeBookmark=$_8b82yg2ojh8lywpq.getUndoBookmark(editor.selection))},add:function(level,event){var i,lastLevel,currentLevel,settings=editor.settings;if(currentLevel=$_dxjj465ijh8lyxb4.createFromEditor(editor),level=level||{},level=$_ahowuxkjh8lywbj.extend(level,currentLevel),isUnlocked()===!1||editor.removed)return null;if(lastLevel=data[index],editor.fire("BeforeAddUndo",{level:level,lastLevel:lastLevel,originalEvent:event}).isDefaultPrevented())return null;if(lastLevel&&$_dxjj465ijh8lyxb4.isEq(lastLevel,level))return null;if(data[index]&&(data[index].beforeBookmark=beforeBookmark),settings.custom_undo_redo_levels&&data.length>settings.custom_undo_redo_levels){for(i=0;i<data.length-1;i++)data[i]=data[i+1];data.length--,index=data.length}level.bookmark=$_8b82yg2ojh8lywpq.getUndoBookmark(editor.selection),index<data.length-1&&(data.length=index+1),data.push(level),index=data.length-1;var args={level:level,lastLevel:lastLevel,originalEvent:event};return editor.fire("AddUndo",args),index>0&&(setDirty(!0),editor.fire("change",args)),level},undo:function(){var level;return self.typing&&(self.add(),self.typing=!1,setTyping(!1)),index>0&&(level=data[--index],$_dxjj465ijh8lyxb4.applyToEditor(editor,level,!0),setDirty(!0),editor.fire("undo",{level:level})),level},redo:function(){var level;return index<data.length-1&&(level=data[++index],$_dxjj465ijh8lyxb4.applyToEditor(editor,level,!1),setDirty(!0),editor.fire("redo",{level:level})),level},clear:function(){data=[],index=0,self.typing=!1,self.data=data,editor.fire("ClearUndos")},hasUndo:function(){return index>0||self.typing&&data[0]&&!$_dxjj465ijh8lyxb4.isEq($_dxjj465ijh8lyxb4.createFromEditor(editor),data[0])},hasRedo:function(){return index<data.length-1&&!self.typing},transact:function(callback){return endTyping(),self.beforeChange(),self.ignore(callback),self.add()},ignore:function(callback){try{locks++,callback()}finally{locks--}},extra:function(callback1,callback2){var lastLevel,bookmark;self.transact(callback1)&&(bookmark=data[index].bookmark,lastLevel=data[index-1],$_dxjj465ijh8lyxb4.applyToEditor(editor,lastLevel,!0),self.transact(callback2)&&(data[index-1].beforeBookmark=bookmark))}}}function FormatRegistry(editor){var formats={},get=function(name){return name?formats[name]:formats},register=function(name,format){name&&("string"!=typeof name?$_ahowuxkjh8lywbj.each(name,function(format,name){register(name,format)}):(format=format.length?format:[format],$_ahowuxkjh8lywbj.each(format,function(format){"undefined"==typeof format.deep&&(format.deep=!format.selector),"undefined"==typeof format.split&&(format.split=!format.selector||format.inline),"undefined"==typeof format.remove&&format.selector&&!format.inline&&(format.remove="none"),format.selector&&format.inline&&(format.mixed=!0,format.block_expand=!0),"string"==typeof format.classes&&(format.classes=format.classes.split(/\s+/))}),formats[name]=format))},unregister=function(name){return name&&formats[name]&&delete formats[name],formats};return register($_3zwfyl62jh8lyxez.get(editor.dom)),register(editor.settings.formats),{get:get,register:register,unregister:unregister}}function Formatter(editor){var formats=FormatRegistry(editor),formatChangeState=Cell(null);return $_3p946b65jh8lyxfe.setup(editor),setup$2(editor),{get:formats.get,register:formats.register,unregister:formats.unregister,apply:$_eqpqvr6jh8lyw3s.curry($_36ocwe5qjh8lyxck.applyFormat,editor),remove:$_eqpqvr6jh8lyw3s.curry($_7cys7h5yjh8lyxeg.remove,editor),toggle:$_eqpqvr6jh8lyw3s.curry($_5bc2se64jh8lyxfc.toggle,editor,formats),match:$_eqpqvr6jh8lyw3s.curry($_8qd8fq5ujh8lyxdx.match,editor),matchAll:$_eqpqvr6jh8lyw3s.curry($_8qd8fq5ujh8lyxdx.matchAll,editor),matchNode:$_eqpqvr6jh8lyw3s.curry($_8qd8fq5ujh8lyxdx.matchNode,editor),canApply:$_eqpqvr6jh8lyw3s.curry($_8qd8fq5ujh8lyxdx.canApply,editor),formatChanged:$_eqpqvr6jh8lyw3s.curry($_cpfal560jh8lyxeu.formatChanged,editor,formatChangeState),getCssText:$_eqpqvr6jh8lyw3s.curry($_fwiqkm63jh8lyxf5.getCssText,editor)}}function DomParser(settings,schema){void 0===schema&&(schema=Schema());var nodeFilters={},attributeFilters=[],matchedNodes={},matchedAttributes={};settings=settings||{},settings.validate=!("validate"in settings)||settings.validate,settings.root_name=settings.root_name||"body";var fixInvalidChildren=function(nodes){var ni,node,parent,parents,newParent,currentNode,tempNode,childNode,i,nonEmptyElements,whitespaceElements,nonSplitableElements,textBlockElements,specialElements,sibling,nextNode;for(nonSplitableElements=makeMap$4("tr,td,th,tbody,thead,tfoot,table"),nonEmptyElements=schema.getNonEmptyElements(),whitespaceElements=schema.getWhiteSpaceElements(),textBlockElements=schema.getTextBlockElements(),specialElements=schema.getSpecialElements(),ni=0;ni<nodes.length;ni++)if(node=nodes[ni],node.parent&&!node.fixed)if(textBlockElements[node.name]&&"li"===node.parent.name){for(sibling=node.next;sibling&&textBlockElements[sibling.name];)sibling.name="li",sibling.fixed=!0,node.parent.insert(sibling,node.parent),sibling=sibling.next;node.unwrap(node)}else{for(parents=[node],parent=node.parent;parent&&!schema.isValidChild(parent.name,node.name)&&!nonSplitableElements[parent.name];parent=parent.parent)parents.push(parent);if(parent&&parents.length>1){for(parents.reverse(),newParent=currentNode=filterNode(parents[0].clone()),i=0;i<parents.length-1;i++){for(schema.isValidChild(currentNode.name,parents[i].name)?(tempNode=filterNode(parents[i].clone()),currentNode.append(tempNode)):tempNode=currentNode,childNode=parents[i].firstChild;childNode&&childNode!==parents[i+1];)nextNode=childNode.next,tempNode.append(childNode),childNode=nextNode;currentNode=tempNode}isEmpty$2(schema,nonEmptyElements,whitespaceElements,newParent)?parent.insert(node,parents[0],!0):(parent.insert(newParent,parents[0],!0),parent.insert(node,newParent)),parent=parents[0],(isEmpty$2(schema,nonEmptyElements,whitespaceElements,parent)||hasOnlyChild(parent,"br"))&&parent.empty().remove()}else if(node.parent){if("li"===node.name){if(sibling=node.prev,sibling&&("ul"===sibling.name||"ul"===sibling.name)){sibling.append(node);continue}if(sibling=node.next,sibling&&("ul"===sibling.name||"ul"===sibling.name)){sibling.insert(node,sibling.firstChild,!0);continue}node.wrap(filterNode(new Node$2("ul",1)));continue}schema.isValidChild(node.parent.name,"div")&&schema.isValidChild("div",node.name)?node.wrap(filterNode(new Node$2("div",1))):specialElements[node.name]?node.empty().remove():node.unwrap()}}},filterNode=function(node){var i,name,list;name in nodeFilters&&(list=matchedNodes[name],list?list.push(node):matchedNodes[name]=[node]),i=attributeFilters.length;for(;i--;)name=attributeFilters[i].name,name in node.attributes.map&&(list=matchedAttributes[name],list?list.push(node):matchedAttributes[name]=[node]);return node},addNodeFilter=function(name,callback){each$18(explode$3(name),function(name){var list=nodeFilters[name];list||(nodeFilters[name]=list=[]),list.push(callback)})},getNodeFilters=function(){var out=[];for(var name_1 in nodeFilters)nodeFilters.hasOwnProperty(name_1)&&out.push({name:name_1,callbacks:nodeFilters[name_1]});return out},addAttributeFilter=function(name,callback){each$18(explode$3(name),function(name){var i;for(i=0;i<attributeFilters.length;i++)if(attributeFilters[i].name===name)return void attributeFilters[i].callbacks.push(callback);attributeFilters.push({name:name,callbacks:[callback]})})},getAttributeFilters=function(){return[].concat(attributeFilters)},parse=function(html,args){var parser,nodes,i,l,fi,fl,list,name,blockElements,isInWhiteSpacePreservedElement,node,invalidChildren=[];args=args||{},matchedNodes={},matchedAttributes={},blockElements=extend$3(makeMap$4("script,style,head,html,body,title,meta,param"),schema.getBlockElements());var nonEmptyElements=schema.getNonEmptyElements(),children=schema.children,validate=settings.validate,rootBlockName="forced_root_block"in args?args.forced_root_block:settings.forced_root_block,whiteSpaceElements=schema.getWhiteSpaceElements(),startWhiteSpaceRegExp=/^[ \t\r\n]+/,endWhiteSpaceRegExp=/[ \t\r\n]+$/,allWhiteSpaceRegExp=/[ \t\r\n]+/g,isAllWhiteSpaceRegExp=/^[ \t\r\n]+$/;isInWhiteSpacePreservedElement=whiteSpaceElements.hasOwnProperty(args.context)||whiteSpaceElements.hasOwnProperty(settings.root_name);var addRootBlocks=function(){var next,rootBlockNode,node=rootNode.firstChild,trim=function(rootBlockNode){rootBlockNode&&(node=rootBlockNode.firstChild,node&&3===node.type&&(node.value=node.value.replace(startWhiteSpaceRegExp,"")),node=rootBlockNode.lastChild,node&&3===node.type&&(node.value=node.value.replace(endWhiteSpaceRegExp,"")))};if(schema.isValidChild(rootNode.name,rootBlockName.toLowerCase())){for(;node;)next=node.next,3===node.type||1===node.type&&"p"!==node.name&&!blockElements[node.name]&&!node.attr("data-mce-type")?rootBlockNode?rootBlockNode.append(node):(rootBlockNode=createNode(rootBlockName,1),rootBlockNode.attr(settings.forced_root_block_attrs),rootNode.insert(rootBlockNode,node),rootBlockNode.append(node)):(trim(rootBlockNode),rootBlockNode=null),node=next;trim(rootBlockNode)}},createNode=function(name,type){var list,node=new Node$2(name,type);return name in nodeFilters&&(list=matchedNodes[name],list?list.push(node):matchedNodes[name]=[node]),node},removeWhitespaceBefore=function(node){var textNode,textNodeNext,textVal,sibling,blockElements=schema.getBlockElements();for(textNode=node.prev;textNode&&3===textNode.type;){if(textVal=textNode.value.replace(endWhiteSpaceRegExp,""),textVal.length>0)return void(textNode.value=textVal);if(textNodeNext=textNode.next){if(3===textNodeNext.type&&textNodeNext.value.length){textNode=textNode.prev;continue}if(!blockElements[textNodeNext.name]&&"script"!==textNodeNext.name&&"style"!==textNodeNext.name){textNode=textNode.prev;continue}}sibling=textNode.prev,textNode.remove(),textNode=sibling}},cloneAndExcludeBlocks=function(input){var name,output={};for(name in input)"li"!==name&&"p"!==name&&(output[name]=input[name]);return output};parser=SaxParser$1({validate:validate,allow_script_urls:settings.allow_script_urls,allow_conditional_comments:settings.allow_conditional_comments,self_closing_elements:cloneAndExcludeBlocks(schema.getSelfClosingElements()),cdata:function(text){node.append(createNode("#cdata",4)).value=text},text:function(text,raw){var textNode;isInWhiteSpacePreservedElement||(text=text.replace(allWhiteSpaceRegExp," "),isLineBreakNode(node.lastChild,blockElements)&&(text=text.replace(startWhiteSpaceRegExp,""))),0!==text.length&&(textNode=createNode("#text",3),textNode.raw=!!raw,node.append(textNode).value=text)},comment:function(text){node.append(createNode("#comment",8)).value=text},pi:function(name,text){node.append(createNode(name,7)).value=text,removeWhitespaceBefore(node)},doctype:function(text){var newNode;newNode=node.append(createNode("#doctype",10)),newNode.value=text,removeWhitespaceBefore(node)},start:function(name,attrs,empty){var newNode,attrFiltersLen,elementRule,attrName,parent;if(elementRule=validate?schema.getElementRule(name):{}){for(newNode=createNode(elementRule.outputName||name,1),newNode.attributes=attrs,newNode.shortEnded=empty,node.append(newNode),parent=children[node.name],parent&&children[newNode.name]&&!parent[newNode.name]&&invalidChildren.push(newNode),attrFiltersLen=attributeFilters.length;attrFiltersLen--;)attrName=attributeFilters[attrFiltersLen].name,attrName in attrs.map&&(list=matchedAttributes[attrName],list?list.push(newNode):matchedAttributes[attrName]=[newNode]);blockElements[name]&&removeWhitespaceBefore(newNode),empty||(node=newNode),!isInWhiteSpacePreservedElement&&whiteSpaceElements[name]&&(isInWhiteSpacePreservedElement=!0)}},end:function(name){var textNode,elementRule,text,sibling,tempNode;if(elementRule=validate?schema.getElementRule(name):{}){if(blockElements[name]&&!isInWhiteSpacePreservedElement){if(textNode=node.firstChild,textNode&&3===textNode.type)if(text=textNode.value.replace(startWhiteSpaceRegExp,""),text.length>0)textNode.value=text,textNode=textNode.next;else for(sibling=textNode.next,textNode.remove(),textNode=sibling;textNode&&3===textNode.type;)text=textNode.value,sibling=textNode.next,(0===text.length||isAllWhiteSpaceRegExp.test(text))&&(textNode.remove(),textNode=sibling),textNode=sibling;if(textNode=node.lastChild,textNode&&3===textNode.type)if(text=textNode.value.replace(endWhiteSpaceRegExp,""),text.length>0)textNode.value=text,textNode=textNode.prev;else for(sibling=textNode.prev,textNode.remove(),textNode=sibling;textNode&&3===textNode.type;)text=textNode.value,sibling=textNode.prev,(0===text.length||isAllWhiteSpaceRegExp.test(text))&&(textNode.remove(),textNode=sibling),textNode=sibling}if(isInWhiteSpacePreservedElement&&whiteSpaceElements[name]&&(isInWhiteSpacePreservedElement=!1),elementRule.removeEmpty&&isEmpty$2(schema,nonEmptyElements,whiteSpaceElements,node)&&!node.attributes.map.name&&!node.attr("id"))return tempNode=node.parent,blockElements[node.name]?node.empty().remove():node.unwrap(),void(node=tempNode);elementRule.paddEmpty&&(isPaddedWithNbsp(node)||isEmpty$2(schema,nonEmptyElements,whiteSpaceElements,node))&&paddEmptyNode(settings,args,blockElements,node),node=node.parent}}},schema);var rootNode=node=new Node$2(args.context||settings.root_name,11);if(parser.parse(html),validate&&invalidChildren.length&&(args.context?args.invalid=!0:fixInvalidChildren(invalidChildren)),rootBlockName&&("body"===rootNode.name||args.isRootContent)&&addRootBlocks(),!args.invalid){for(name in matchedNodes){for(list=nodeFilters[name],nodes=matchedNodes[name],fi=nodes.length;fi--;)nodes[fi].parent||nodes.splice(fi,1);for(i=0,l=list.length;i<l;i++)list[i](nodes,name,args)}for(i=0,l=attributeFilters.length;i<l;i++)if(list=attributeFilters[i],list.name in matchedAttributes){for(nodes=matchedAttributes[list.name],fi=nodes.length;fi--;)nodes[fi].parent||nodes.splice(fi,1);for(fi=0,fl=list.callbacks.length;fi<fl;fi++)list.callbacks[fi](nodes,list.name,args)}}return rootNode},exports={schema:schema,addAttributeFilter:addAttributeFilter,getAttributeFilters:getAttributeFilters,addNodeFilter:addNodeFilter,getNodeFilters:getNodeFilters,filterNode:filterNode,parse:parse};return register$2(exports,settings),$_9ewhzh6cjh8lyxgp.register(exports,settings),exports}function DomSerializer(settings,editor){var dom,schema,htmlParser,tempAttrs=["data-mce-selected"];dom=editor&&editor.dom?editor.dom:DOMUtils$1.DOM,schema=editor&&editor.schema?editor.schema:Schema(settings),settings.entity_encoding=settings.entity_encoding||"named",settings.remove_trailing_brs=!("remove_trailing_brs"in settings)||settings.remove_trailing_brs,htmlParser=DomParser(settings,schema),$_834niu69jh8lyxg1.register(htmlParser,settings,dom);var serialize=function(node,parserArgs){var args=$_7ffry568jh8lyxfy.merge({format:"html"},parserArgs?parserArgs:{}),targetNode=$_gg1aca6ajh8lyxg7.process(editor,node,args),html=getHtmlFromNode(dom,targetNode,args),rootNode=parseHtml(htmlParser,html,args);return"tree"===args.format?rootNode:toHtml(editor,settings,schema,rootNode,args)};return{schema:schema,addNodeFilter:htmlParser.addNodeFilter,addAttributeFilter:htmlParser.addAttributeFilter,serialize:serialize,addRules:function(rules){schema.addValidElements(rules)},setRules:function(rules){schema.setValidElements(rules)},addTempAttr:$_eqpqvr6jh8lyw3s.curry(addTempAttr,htmlParser,tempAttrs),getTempAttrs:function(){return tempAttrs}}}function DomSerializer$1(settings,editor){var domSerializer=DomSerializer(settings,editor);return{schema:domSerializer.schema,addNodeFilter:domSerializer.addNodeFilter,addAttributeFilter:domSerializer.addAttributeFilter,serialize:domSerializer.serialize,addRules:domSerializer.addRules,setRules:domSerializer.setRules,addTempAttr:domSerializer.addTempAttr,getTempAttrs:domSerializer.getTempAttrs}}function BookmarkManager(selection){return{getBookmark:$_eqpqvr6jh8lyw3s.curry($_eyp5ec2njh8lywpo.getBookmark,selection),moveToBookmark:$_eqpqvr6jh8lyw3s.curry($_eyp5ec2njh8lywpo.moveToBookmark,selection)}}function Quirks(editor){var each=$_ahowuxkjh8lywbj.each,BACKSPACE=$_6lsk4i5gjh8lyxau.BACKSPACE,DELETE=$_6lsk4i5gjh8lyxau.DELETE,dom=editor.dom,selection=editor.selection,settings=editor.settings,parser=editor.parser,isGecko=$_9bpim8ajh8lyw68.gecko,isIE=$_9bpim8ajh8lyw68.ie,isWebKit=$_9bpim8ajh8lyw68.webkit,mceInternalUrlPrefix="data:text/mce-internal,",mceInternalDataType=isIE?"Text":"URL",setEditorCommandState=function(cmd,state){
try{editor.getDoc().execCommand(cmd,!1,state)}catch(ex){}},isDefaultPrevented=function(e){return e.isDefaultPrevented()},setMceInternalContent=function(e){var selectionHtml,internalContent;e.dataTransfer&&(editor.selection.isCollapsed()&&"IMG"===e.target.tagName&&selection.select(e.target),selectionHtml=editor.selection.getContent(),selectionHtml.length>0&&(internalContent=mceInternalUrlPrefix+escape(editor.id)+","+escape(selectionHtml),e.dataTransfer.setData(mceInternalDataType,internalContent)))},getMceInternalContent=function(e){var internalContent;return e.dataTransfer&&(internalContent=e.dataTransfer.getData(mceInternalDataType),internalContent&&internalContent.indexOf(mceInternalUrlPrefix)>=0)?(internalContent=internalContent.substr(mceInternalUrlPrefix.length).split(","),{id:unescape(internalContent[0]),html:unescape(internalContent[1])}):null},insertClipboardContents=function(content,internal){editor.queryCommandSupported("mceInsertClipboardContent")?editor.execCommand("mceInsertClipboardContent",!1,{content:content,internal:internal}):editor.execCommand("mceInsertContent",!1,content)},emptyEditorWhenDeleting=function(){var serializeRng=function(rng){var body=dom.create("body"),contents=rng.cloneContents();return body.appendChild(contents),selection.serializer.serialize(body,{format:"html"})},allContentsSelected=function(rng){var selection=serializeRng(rng),allRng=dom.createRng();allRng.selectNode(editor.getBody());var allSelection=serializeRng(allRng);return selection===allSelection};editor.on("keydown",function(e){var isCollapsed,body,keyCode=e.keyCode;if(!isDefaultPrevented(e)&&(keyCode===DELETE||keyCode===BACKSPACE)){if(isCollapsed=editor.selection.isCollapsed(),body=editor.getBody(),isCollapsed&&!dom.isEmpty(body))return;if(!isCollapsed&&!allContentsSelected(editor.selection.getRng()))return;e.preventDefault(),editor.setContent(""),body.firstChild&&dom.isBlock(body.firstChild)?editor.selection.setCursorLocation(body.firstChild,0):editor.selection.setCursorLocation(body,0),editor.nodeChanged()}})},selectAll=function(){editor.shortcuts.add("meta+a",null,"SelectAll")},inputMethodFocus=function(){editor.settings.content_editable||dom.bind(editor.getDoc(),"mousedown mouseup",function(e){var rng;if(e.target===editor.getDoc().documentElement)if(rng=selection.getRng(),editor.getBody().focus(),"mousedown"===e.type){if(isCaretContainer(rng.startContainer))return;selection.placeCaretAt(e.clientX,e.clientY)}else selection.setRng(rng)})},removeHrOnBackspace=function(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE){if(!editor.getBody().getElementsByTagName("hr").length)return;if(selection.isCollapsed()&&0===selection.getRng().startOffset){var node=selection.getNode(),previousSibling=node.previousSibling;if("HR"===node.nodeName)return dom.remove(node),void e.preventDefault();previousSibling&&previousSibling.nodeName&&"hr"===previousSibling.nodeName.toLowerCase()&&(dom.remove(previousSibling),e.preventDefault())}}})},focusBody=function(){Range.prototype.getClientRects||editor.on("mousedown",function(e){if(!isDefaultPrevented(e)&&"HTML"===e.target.nodeName){var body_1=editor.getBody();body_1.blur(),$_8sy3pfhjh8lyw95.setEditorTimeout(editor,function(){body_1.focus()})}})},selectControlElements=function(){editor.on("click",function(e){var target=e.target;/^(IMG|HR)$/.test(target.nodeName)&&"false"!==dom.getContentEditableParent(target)&&(e.preventDefault(),editor.selection.select(target),editor.nodeChanged()),"A"===target.nodeName&&dom.hasClass(target,"mce-item-anchor")&&(e.preventDefault(),selection.select(target))})},removeStylesWhenDeletingAcrossBlockElements=function(){var getAttributeApplyFunction=function(){var template=dom.getAttribs(selection.getStart().cloneNode(!1));return function(){var target=selection.getStart();target!==editor.getBody()&&(dom.setAttrib(target,"style",null),each(template,function(attr){target.setAttributeNode(attr.cloneNode(!0))}))}},isSelectionAcrossElements=function(){return!selection.isCollapsed()&&dom.getParent(selection.getStart(),dom.isBlock)!==dom.getParent(selection.getEnd(),dom.isBlock)};editor.on("keypress",function(e){var applyAttributes;if(!isDefaultPrevented(e)&&(8===e.keyCode||46===e.keyCode)&&isSelectionAcrossElements())return applyAttributes=getAttributeApplyFunction(),editor.getDoc().execCommand("delete",!1,null),applyAttributes(),e.preventDefault(),!1}),dom.bind(editor.getDoc(),"cut",function(e){var applyAttributes;!isDefaultPrevented(e)&&isSelectionAcrossElements()&&(applyAttributes=getAttributeApplyFunction(),$_8sy3pfhjh8lyw95.setEditorTimeout(editor,function(){applyAttributes()}))})},disableBackspaceIntoATable=function(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE&&selection.isCollapsed()&&0===selection.getRng().startOffset){var previousSibling=selection.getNode().previousSibling;if(previousSibling&&previousSibling.nodeName&&"table"===previousSibling.nodeName.toLowerCase())return e.preventDefault(),!1}})},removeBlockQuoteOnBackSpace=function(){editor.on("keydown",function(e){var rng,container,offset,root,parent;if(!isDefaultPrevented(e)&&e.keyCode===$_6lsk4i5gjh8lyxau.BACKSPACE&&(rng=selection.getRng(),container=rng.startContainer,offset=rng.startOffset,root=dom.getRoot(),parent=container,rng.collapsed&&0===offset)){for(;parent&&parent.parentNode&&parent.parentNode.firstChild===parent&&parent.parentNode!==root;)parent=parent.parentNode;"BLOCKQUOTE"===parent.tagName&&(editor.formatter.toggle("blockquote",null,parent),rng=dom.createRng(),rng.setStart(container,0),rng.setEnd(container,0),selection.setRng(rng))}})},setGeckoEditingOptions=function(){var setOpts=function(){setEditorCommandState("StyleWithCSS",!1),setEditorCommandState("enableInlineTableEditing",!1),settings.object_resizing||setEditorCommandState("enableObjectResizing",!1)};settings.readonly||editor.on("BeforeExecCommand MouseDown",setOpts)},addBrAfterLastLinks=function(){var fixLinks=function(){each(dom.select("a"),function(node){var parentNode=node.parentNode,root=dom.getRoot();if(parentNode.lastChild===node){for(;parentNode&&!dom.isBlock(parentNode);){if(parentNode.parentNode.lastChild!==parentNode||parentNode===root)return;parentNode=parentNode.parentNode}dom.add(parentNode,"br",{"data-mce-bogus":1})}})};editor.on("SetContent ExecCommand",function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||fixLinks()})},setDefaultBlockType=function(){settings.forced_root_block&&editor.on("init",function(){setEditorCommandState("DefaultParagraphSeparator",settings.forced_root_block)})},normalizeSelection=function(){editor.on("keyup focusin mouseup",function(e){$_6lsk4i5gjh8lyxau.modifierPressed(e)||selection.normalize()},!0)},showBrokenImageIcon=function(){editor.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},restoreFocusOnKeyDown=function(){editor.inline||editor.on("keydown",function(){document.activeElement===document.body&&editor.getWin().focus()})},bodyHeight=function(){editor.inline||(editor.contentStyles.push("body {min-height: 150px}"),editor.on("click",function(e){var rng;if("HTML"===e.target.nodeName){if($_9bpim8ajh8lyw68.ie>11)return void editor.getBody().focus();rng=editor.selection.getRng(),editor.getBody().focus(),editor.selection.setRng(rng),editor.selection.normalize(),editor.nodeChanged()}}))},blockCmdArrowNavigation=function(){$_9bpim8ajh8lyw68.mac&&editor.on("keydown",function(e){!$_6lsk4i5gjh8lyxau.metaKeyPressed(e)||e.shiftKey||37!==e.keyCode&&39!==e.keyCode||(e.preventDefault(),editor.selection.getSel().modify("move",37===e.keyCode?"backward":"forward","lineboundary"))})},disableAutoUrlDetect=function(){setEditorCommandState("AutoUrlDetect",!1)},tapLinksAndImages=function(){editor.on("click",function(e){var elm=e.target;do if("A"===elm.tagName)return void e.preventDefault();while(elm=elm.parentNode)}),editor.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},blockFormSubmitInsideEditor=function(){editor.on("init",function(){editor.dom.bind(editor.getBody(),"submit",function(e){e.preventDefault()})})},removeAppleInterchangeBrs=function(){parser.addNodeFilter("br",function(nodes){for(var i=nodes.length;i--;)"Apple-interchange-newline"===nodes[i].attr("class")&&nodes[i].remove()})},ieInternalDragAndDrop=function(){editor.on("dragstart",function(e){setMceInternalContent(e)}),editor.on("drop",function(e){if(!isDefaultPrevented(e)){var internalContent=getMceInternalContent(e);if(internalContent&&internalContent.id!==editor.id){e.preventDefault();var rng=$_ct0ht56jjh8lyxif.fromPoint(e.x,e.y,editor.getDoc());selection.setRng(rng),insertClipboardContents(internalContent.html,!0)}}})},refreshContentEditable=function(){},isHidden=function(){var sel;return!isGecko||editor.removed?0:(sel=editor.selection.getSel(),!sel||!sel.rangeCount||0===sel.rangeCount)};return removeBlockQuoteOnBackSpace(),emptyEditorWhenDeleting(),$_9bpim8ajh8lyw68.windowsPhone||normalizeSelection(),isWebKit&&(inputMethodFocus(),selectControlElements(),setDefaultBlockType(),blockFormSubmitInsideEditor(),disableBackspaceIntoATable(),removeAppleInterchangeBrs(),$_9bpim8ajh8lyw68.iOS?(restoreFocusOnKeyDown(),bodyHeight(),tapLinksAndImages()):selectAll()),$_9bpim8ajh8lyw68.ie>=11&&(bodyHeight(),disableBackspaceIntoATable()),$_9bpim8ajh8lyw68.ie&&(selectAll(),disableAutoUrlDetect(),ieInternalDragAndDrop()),isGecko&&(removeHrOnBackspace(),focusBody(),removeStylesWhenDeletingAcrossBlockElements(),setGeckoEditingOptions(),addBrAfterLastLinks(),showBrokenImageIcon(),blockCmdArrowNavigation(),disableBackspaceIntoATable()),{refreshContentEditable:refreshContentEditable,isHidden:isHidden}}function RangeUtils(dom){var walk=function(rng,callback){return $_90itx05zjh8lyxeq.walk(dom,rng,callback)},split=$_5hrcpr5vjh8lyxe2.split,normalize=function(rng){return $_4v2pn63yjh8lyx2s.normalize(dom,rng).fold($_eqpqvr6jh8lyw3s.constant(!1),function(normalizedRng){return rng.setStart(normalizedRng.startContainer,normalizedRng.startOffset),rng.setEnd(normalizedRng.endContainer,normalizedRng.endOffset),!0})};return{walk:walk,split:split,normalize:normalize}}var opera,webkit,ie,ie11,ie12,gecko,mac,iDevice,android,fileApi,phone,tablet,windowsPhone,noop=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i]},noarg=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return f()}},compose=function(fa,fb){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return fa(fb.apply(null,arguments))}},constant=function(value){return function(){return value}},identity=function(x){return x},tripleEquals=function(a,b){return a===b},curry=function(f){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];for(var args=new Array(arguments.length-1),i=1;i<arguments.length;i++)args[i-1]=arguments[i];return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];for(var newArgs=new Array(arguments.length),j=0;j<newArgs.length;j++)newArgs[j]=arguments[j];var all=args.concat(newArgs);return f.apply(null,all)}},not=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return!f.apply(null,arguments)}},die=function(msg){return function(){throw new Error(msg)}},apply=function(f){return f()},call=function(f){f()},never=constant(!1),always=constant(!0),$_eqpqvr6jh8lyw3s={noop:noop,noarg:noarg,compose:compose,constant:constant,identity:identity,tripleEquals:tripleEquals,curry:curry,not:not,die:die,apply:apply,call:call,never:never,always:always},never$1=$_eqpqvr6jh8lyw3s.never,always$1=$_eqpqvr6jh8lyw3s.always,none=function(){return NONE},NONE=function(){var eq=function(o){return o.isNone()},call=function(thunk){return thunk()},id=function(n){return n},noop=function(){},me={fold:function(n,s){return n()},is:never$1,isSome:never$1,isNone:always$1,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},or:id,orThunk:call,map:none,ap:none,each:noop,bind:none,flatten:none,exists:never$1,forall:always$1,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:$_eqpqvr6jh8lyw3s.constant("none()")};return Object.freeze&&Object.freeze(me),me}(),some=function(a){var constant_a=function(){return a},self=function(){return me},map=function(f){return some(f(a))},bind=function(f){return f(a)},me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always$1,isNone:never$1,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,or:self,orThunk:self,map:map,ap:function(optfab){return optfab.fold(none,function(fab){return some(fab(a))})},each:function(f){f(a)},bind:bind,flatten:constant_a,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never$1,function(b){return elementEq(a,b)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return me},from=function(value){return null===value||void 0===value?NONE:some(value)},Option={some:some,none:none,from:from},typeOf=function(x){if(null===x)return"null";var t=typeof x;return"object"===t&&Array.prototype.isPrototypeOf(x)?"array":"object"===t&&String.prototype.isPrototypeOf(x)?"string":t},isType=function(type){return function(value){return typeOf(value)===type}},$_dp4g6d7jh8lyw3y={isString:isType("string"),isObject:isType("object"),isArray:isType("array"),isNull:isType("null"),isBoolean:isType("boolean"),isUndefined:isType("undefined"),isFunction:isType("function"),isNumber:isType("number")},rawIndexOf=function(){var pIndexOf=Array.prototype.indexOf,fastIndex=function(xs,x){return pIndexOf.call(xs,x)},slowIndex=function(xs,x){return slowIndexOf(xs,x)};return void 0===pIndexOf?slowIndex:fastIndex}(),indexOf=function(xs,x){var r=rawIndexOf(xs,x);return r===-1?Option.none():Option.some(r)},contains=function(xs,x){return rawIndexOf(xs,x)>-1},exists=function(xs,pred){return findIndex(xs,pred).isSome()},range=function(num,f){for(var r=[],i=0;i<num;i++)r.push(f(i));return r},chunk=function(array,size){for(var r=[],i=0;i<array.length;i+=size){var s=array.slice(i,i+size);r.push(s)}return r},map=function(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i,xs)}return r},each=function(xs,f){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];f(x,i,xs)}},eachr=function(xs,f){for(var i=xs.length-1;i>=0;i--){var x=xs[i];f(x,i,xs)}},partition=function(xs,pred){for(var pass=[],fail=[],i=0,len=xs.length;i<len;i++){var x=xs[i],arr=pred(x,i,xs)?pass:fail;arr.push(x)}return{pass:pass,fail:fail}},filter=function(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i,xs)&&r.push(x)}return r},groupBy=function(xs,f){if(0===xs.length)return[];for(var wasType=f(xs[0]),r=[],group=[],i=0,len=xs.length;i<len;i++){var x=xs[i],type=f(x);type!==wasType&&(r.push(group),group=[]),wasType=type,group.push(x)}return 0!==group.length&&r.push(group),r},foldr=function(xs,f,acc){return eachr(xs,function(x){acc=f(acc,x)}),acc},foldl=function(xs,f,acc){return each(xs,function(x){acc=f(acc,x)}),acc},find=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs))return Option.some(x)}return Option.none()},findIndex=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs))return Option.some(i)}return Option.none()},slowIndexOf=function(xs,x){for(var i=0,len=xs.length;i<len;++i)if(xs[i]===x)return i;return-1},push=Array.prototype.push,flatten=function(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!Array.prototype.isPrototypeOf(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);push.apply(r,xs[i])}return r},bind=function(xs,f){var output=map(xs,f);return flatten(output)},forall=function(xs,pred){for(var i=0,len=xs.length;i<len;++i){var x=xs[i];if(pred(x,i,xs)!==!0)return!1}return!0},equal=function(a1,a2){return a1.length===a2.length&&forall(a1,function(x,i){return x===a2[i]})},slice=Array.prototype.slice,reverse=function(xs){var r=slice.call(xs,0);return r.reverse(),r},difference=function(a1,a2){return filter(a1,function(x){return!contains(a2,x)})},mapToObject=function(xs,f){for(var r={},i=0,len=xs.length;i<len;i++){var x=xs[i];r[String(x)]=f(x,i)}return r},pure=function(x){return[x]},sort=function(xs,comparator){var copy=slice.call(xs,0);return copy.sort(comparator),copy},head=function(xs){return 0===xs.length?Option.none():Option.some(xs[0])},last=function(xs){return 0===xs.length?Option.none():Option.some(xs[xs.length-1])},from$1=$_dp4g6d7jh8lyw3y.isFunction(Array.from)?Array.from:function(x){return slice.call(x)},$_5wjzy24jh8lyw2t={map:map,each:each,eachr:eachr,partition:partition,filter:filter,groupBy:groupBy,indexOf:indexOf,foldr:foldr,foldl:foldl,find:find,findIndex:findIndex,flatten:flatten,bind:bind,forall:forall,exists:exists,contains:contains,equal:equal,reverse:reverse,chunk:chunk,difference:difference,mapToObject:mapToObject,pure:pure,sort:sort,range:range,head:head,last:last,from:from$1},global="undefined"!=typeof window?window:Function("return this;")(),path=function(parts,scope){for(var o=void 0!==scope&&null!==scope?scope:global,i=0;i<parts.length&&void 0!==o&&null!==o;++i)o=o[parts[i]];return o},resolve=function(p,scope){var parts=p.split(".");return path(parts,scope)},step=function(o,part){return void 0!==o[part]&&null!==o[part]||(o[part]={}),o[part]},forge=function(parts,target){for(var o=void 0!==target?target:global,i=0;i<parts.length;++i)o=step(o,parts[i]);return o},namespace=function(name,target){var parts=name.split(".");return forge(parts,target)},$_br50dmdjh8lyw6o={path:path,resolve:resolve,forge:forge,namespace:namespace},unsafe=function(name,scope){return $_br50dmdjh8lyw6o.resolve(name,scope)},getOrDie=function(name,scope){var actual=unsafe(name,scope);if(void 0===actual||null===actual)throw name+" not available on this browser";return actual},$_99xmy7cjh8lyw6k={getOrDie:getOrDie},url=function(){return $_99xmy7cjh8lyw6k.getOrDie("URL")},createObjectURL=function(blob){return url().createObjectURL(blob)},revokeObjectURL=function(u){url().revokeObjectURL(u)},$_ge0pt0bjh8lyw6g={createObjectURL:createObjectURL,revokeObjectURL:revokeObjectURL},nav=navigator,userAgent=nav.userAgent,matchMediaQuery=function(query){return"matchMedia"in window&&matchMedia(query).matches};opera=!1,android=/Android/.test(userAgent),webkit=/WebKit/.test(userAgent),ie=!webkit&&!opera&&/MSIE/gi.test(userAgent)&&/Explorer/gi.test(nav.appName),ie=ie&&/MSIE (\w+)\./.exec(userAgent)[1],ie11=userAgent.indexOf("Trident/")!==-1&&(userAgent.indexOf("rv:")!==-1||nav.appName.indexOf("Netscape")!==-1)&&11,ie12=userAgent.indexOf("Edge/")!==-1&&!ie&&!ie11&&12,ie=ie||ie11||ie12,gecko=!webkit&&!ie11&&/Gecko/.test(userAgent),mac=userAgent.indexOf("Mac")!==-1,iDevice=/(iPad|iPhone)/.test(userAgent),fileApi="FormData"in window&&"FileReader"in window&&"URL"in window&&!!$_ge0pt0bjh8lyw6g.createObjectURL,phone=matchMediaQuery("only screen and (max-device-width: 480px)")&&(android||iDevice),tablet=matchMediaQuery("only screen and (min-width: 800px)")&&(android||iDevice),windowsPhone=userAgent.indexOf("Windows Phone")!==-1,ie12&&(webkit=!1);var requestAnimationFramePromise,contentEditable=!iDevice||fileApi||parseInt(userAgent.match(/AppleWebKit\/(\d*)/)[1],10)>=534,$_9bpim8ajh8lyw68={opera:opera,webkit:webkit,ie:ie,gecko:gecko,mac:mac,iOS:iDevice,android:android,contentEditable:contentEditable,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:8!==ie,range:window.getSelection&&"Range"in window,documentMode:ie&&!ie12?document.documentMode||7:10,fileApi:fileApi,ceFalse:ie===!1||ie>8,cacheSuffix:null,container:null,overrideViewPort:null,experimentalShadowDom:!1,canHaveCSP:ie===!1||ie>11,desktop:!phone&&!tablet,windowsPhone:windowsPhone},promise=function(){function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function handle(deferred){var me=this;return null===this._state?void this._deferreds.push(deferred):void asap(function(){var cb=me._state?deferred.onFulfilled:deferred.onRejected;if(null===cb)return void(me._state?deferred.resolve:deferred.reject)(me._value);var ret;try{ret=cb(me._value)}catch(e){return void deferred.reject(e)}deferred.resolve(ret)})}function resolve(newValue){try{if(newValue===this)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if("function"==typeof then)return void doResolve(bind(then,newValue),bind(resolve,this),bind(reject,this))}this._state=!0,this._value=newValue,finale.call(this)}catch(e){reject.call(this,e)}}function reject(newValue){this._state=!1,this._value=newValue,finale.call(this)}function finale(){for(var i=0,len=this._deferreds.length;i<len;i++)handle.call(this,this._deferreds[i]);this._deferreds=null}function Handler(onFulfilled,onRejected,resolve,reject){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.resolve=resolve,this.reject=reject}function doResolve(fn,onFulfilled,onRejected){var done=!1;try{fn(function(value){done||(done=!0,onFulfilled(value))},function(reason){done||(done=!0,onRejected(reason))})}catch(ex){if(done)return;done=!0,onRejected(ex)}}var isArray=Array.isArray||function(value){return"[object Array]"===Object.prototype.toString.call(value)},Promise=function(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],doResolve(fn,bind(resolve,this),bind(reject,this))},asap=Promise.immediateFn||"function"==typeof setImmediate&&setImmediate||function(fn){setTimeout(fn,1)};return Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var me=this;return new Promise(function(resolve,reject){handle.call(me,new Handler(onFulfilled,onRejected,resolve,reject))})},Promise.all=function(){var args=Array.prototype.slice.call(1===arguments.length&&isArray(arguments[0])?arguments[0]:arguments);return new Promise(function(resolve,reject){function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0===--remaining&&resolve(args)}catch(ex){reject(ex)}}if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise},promiseObj=window.Promise?window.Promise:promise(),requestAnimationFrame=function(callback,element){var i,requestAnimationFrameFunc=window.requestAnimationFrame,vendors=["ms","moz","webkit"],featurefill=function(callback){window.setTimeout(callback,0)};for(i=0;i<vendors.length&&!requestAnimationFrameFunc;i++)requestAnimationFrameFunc=window[vendors[i]+"RequestAnimationFrame"];requestAnimationFrameFunc||(requestAnimationFrameFunc=featurefill),requestAnimationFrameFunc(callback,element)},wrappedSetTimeout=function(callback,time){return"number"!=typeof time&&(time=0),setTimeout(callback,time)},wrappedSetInterval=function(callback,time){return"number"!=typeof time&&(time=1),setInterval(callback,time)},wrappedClearTimeout=function(id){return clearTimeout(id)},wrappedClearInterval=function(id){return clearInterval(id)},debounce=function(callback,time){var timer,func;return func=function(){var args=arguments;clearTimeout(timer),timer=wrappedSetTimeout(function(){callback.apply(this,args)},time)},func.stop=function(){clearTimeout(timer)},func},$_8sy3pfhjh8lyw95={requestAnimationFrame:function(callback,element){return requestAnimationFramePromise?void requestAnimationFramePromise.then(callback):void(requestAnimationFramePromise=new promiseObj(function(resolve){element||(element=document.body),requestAnimationFrame(resolve,element)}).then(callback))},setTimeout:wrappedSetTimeout,setInterval:wrappedSetInterval,setEditorTimeout:function(editor,callback,time){return wrappedSetTimeout(function(){editor.removed||callback()},time)},setEditorInterval:function(editor,callback,time){var timer;return timer=wrappedSetInterval(function(){editor.removed?clearInterval(timer):callback()},time)},debounce:debounce,throttle:debounce,clearInterval:wrappedClearInterval,clearTimeout:wrappedClearTimeout},eventExpandoPrefix="mce-data-",mouseEventRe=/^(?:mouse|contextmenu)|click/,deprecated={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1},hasIsDefaultPrevented=function(event){return event.isDefaultPrevented===returnTrue||event.isDefaultPrevented===returnFalse},returnFalse=function(){return!1},returnTrue=function(){return!0},addEvent=function(target,name,callback,capture){target.addEventListener?target.addEventListener(name,callback,capture||!1):target.attachEvent&&target.attachEvent("on"+name,callback)},removeEvent=function(target,name,callback,capture){target.removeEventListener?target.removeEventListener(name,callback,capture||!1):target.detachEvent&&target.detachEvent("on"+name,callback)},getTargetFromShadowDom=function(event,defaultTarget){var path,target=defaultTarget;return path=event.path,path&&path.length>0&&(target=path[0]),event.composedPath&&(path=event.composedPath(),path&&path.length>0&&(target=path[0])),target},fix=function(originalEvent,data){var name,event=data||{};for(name in originalEvent)deprecated[name]||(event[name]=originalEvent[name]);if(event.target||(event.target=event.srcElement||document),$_9bpim8ajh8lyw68.experimentalShadowDom&&(event.target=getTargetFromShadowDom(originalEvent,event.target)),originalEvent&&mouseEventRe.test(originalEvent.type)&&void 0===originalEvent.pageX&&void 0!==originalEvent.clientX){var eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body;event.pageX=originalEvent.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=originalEvent.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}return event.preventDefault=function(){event.isDefaultPrevented=returnTrue,originalEvent&&(originalEvent.preventDefault?originalEvent.preventDefault():originalEvent.returnValue=!1)},event.stopPropagation=function(){event.isPropagationStopped=returnTrue,originalEvent&&(originalEvent.stopPropagation?originalEvent.stopPropagation():originalEvent.cancelBubble=!0)},event.stopImmediatePropagation=function(){event.isImmediatePropagationStopped=returnTrue,event.stopPropagation()},hasIsDefaultPrevented(event)===!1&&(event.isDefaultPrevented=returnFalse,event.isPropagationStopped=returnFalse,event.isImmediatePropagationStopped=returnFalse),"undefined"==typeof event.metaKey&&(event.metaKey=!1),event},bindOnReady=function(win,callback,eventUtils){var doc=win.document,event={type:"ready"};if(eventUtils.domLoaded)return void callback(event);var isDocReady=function(){return"complete"===doc.readyState||"interactive"===doc.readyState&&doc.body},readyHandler=function(){eventUtils.domLoaded||(eventUtils.domLoaded=!0,callback(event))},waitForDomLoaded=function(){isDocReady()&&(removeEvent(doc,"readystatechange",waitForDomLoaded),readyHandler())},tryScroll=function(){try{doc.documentElement.doScroll("left")}catch(ex){return void $_8sy3pfhjh8lyw95.setTimeout(tryScroll)}readyHandler()};!doc.addEventListener||$_9bpim8ajh8lyw68.ie&&$_9bpim8ajh8lyw68.ie<11?(addEvent(doc,"readystatechange",waitForDomLoaded),doc.documentElement.doScroll&&win.self===win.top&&tryScroll()):isDocReady()?readyHandler():addEvent(win,"DOMContentLoaded",readyHandler),addEvent(win,"load",readyHandler)},EventUtils=function(){var count,expando,hasFocusIn,hasMouseEnterLeave,mouseEnterLeave,self=this,events={};expando=eventExpandoPrefix+(+new Date).toString(32),hasMouseEnterLeave="onmouseenter"in document.documentElement,hasFocusIn="onfocusin"in document.documentElement,mouseEnterLeave={mouseenter:"mouseover",mouseleave:"mouseout"},count=1,self.domLoaded=!1,self.events=events;var executeHandlers=function(evt,id){var callbackList,i,l,callback,container=events[id];if(callbackList=container&&container[evt.type])for(i=0,l=callbackList.length;i<l;i++)if(callback=callbackList[i],callback&&callback.func.call(callback.scope,evt)===!1&&evt.preventDefault(),evt.isImmediatePropagationStopped())return};self.bind=function(target,names,callback,scope){var id,callbackList,i,name,fakeName,nativeHandler,capture,win=window,defaultNativeHandler=function(evt){executeHandlers(fix(evt||win.event),id)};if(target&&3!==target.nodeType&&8!==target.nodeType){for(target[expando]?id=target[expando]:(id=count++,target[expando]=id,events[id]={}),scope=scope||target,names=names.split(" "),i=names.length;i--;)name=names[i],nativeHandler=defaultNativeHandler,fakeName=capture=!1,"DOMContentLoaded"===name&&(name="ready"),self.domLoaded&&"ready"===name&&"complete"===target.readyState?callback.call(scope,fix({type:name})):(hasMouseEnterLeave||(fakeName=mouseEnterLeave[name],fakeName&&(nativeHandler=function(evt){var current,related;if(current=evt.currentTarget,related=evt.relatedTarget,related&&current.contains)related=current.contains(related);else for(;related&&related!==current;)related=related.parentNode;related||(evt=fix(evt||win.event),evt.type="mouseout"===evt.type?"mouseleave":"mouseenter",evt.target=current,executeHandlers(evt,id))})),hasFocusIn||"focusin"!==name&&"focusout"!==name||(capture=!0,fakeName="focusin"===name?"focus":"blur",nativeHandler=function(evt){evt=fix(evt||win.event),evt.type="focus"===evt.type?"focusin":"focusout",executeHandlers(evt,id)}),callbackList=events[id][name],callbackList?"ready"===name&&self.domLoaded?callback({type:name}):callbackList.push({func:callback,scope:scope}):(events[id][name]=callbackList=[{func:callback,scope:scope}],callbackList.fakeName=fakeName,callbackList.capture=capture,callbackList.nativeHandler=nativeHandler,"ready"===name?bindOnReady(target,nativeHandler,self):addEvent(target,fakeName||name,nativeHandler,capture)));return target=callbackList=0,callback}},self.unbind=function(target,names,callback){var id,callbackList,i,ci,name,eventMap;if(!target||3===target.nodeType||8===target.nodeType)return self;if(id=target[expando]){if(eventMap=events[id],names){for(names=names.split(" "),i=names.length;i--;)if(name=names[i],callbackList=eventMap[name]){if(callback)for(ci=callbackList.length;ci--;)if(callbackList[ci].func===callback){var nativeHandler=callbackList.nativeHandler,fakeName=callbackList.fakeName,capture=callbackList.capture;callbackList=callbackList.slice(0,ci).concat(callbackList.slice(ci+1)),callbackList.nativeHandler=nativeHandler,callbackList.fakeName=fakeName,callbackList.capture=capture,eventMap[name]=callbackList}callback&&0!==callbackList.length||(delete eventMap[name],removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture))}}else{for(name in eventMap)callbackList=eventMap[name],removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture);eventMap={}}for(name in eventMap)return self;delete events[id];try{delete target[expando]}catch(ex){target[expando]=null}}return self},self.fire=function(target,name,args){var id;if(!target||3===target.nodeType||8===target.nodeType)return self;args=fix(null,args),args.type=name,args.target=target;do id=target[expando],id&&executeHandlers(args,id),target=target.parentNode||target.ownerDocument||target.defaultView||target.parentWindow;while(target&&!args.isPropagationStopped());
return self},self.clean=function(target){var i,children,unbind=self.unbind;if(!target||3===target.nodeType||8===target.nodeType)return self;if(target[expando]&&unbind(target),target.getElementsByTagName||(target=target.document),target&&target.getElementsByTagName)for(unbind(target),children=target.getElementsByTagName("*"),i=children.length;i--;)target=children[i],target[expando]&&unbind(target);return self},self.destroy=function(){events={}},self.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1}};EventUtils.Event=new EventUtils,EventUtils.Event.bind(window,"ready",function(){});var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document$1,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains$1,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},strundefined="undefined",MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push$1=arr.push,slice$1=arr.slice,indexOf$1=arr.indexOf||function(elem){for(var i=0,len=this.length;i<len;i++)if(this[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)};try{push$1.apply(arr=slice$1.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push$1={apply:arr.length?function(target,els){push_native.apply(target,slice$1.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}var Sizzle=function(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document$1&&setDocument(context),context=context||document$1,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains$1(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push$1.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName)return push$1.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push$1.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)};support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return!!documentElement&&"HTML"!==documentElement.nodeName},setDocument=Sizzle.setDocument=function(node){function getTop(win){try{return win.top}catch(ex){}return null}var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;return doc!==document$1&&9===doc.nodeType&&doc.documentElement?(document$1=doc,docElem=doc.documentElement,documentIsHTML=!isXML(doc),parent&&parent!==getTop(parent)&&(parent.addEventListener?parent.addEventListener("unload",function(){setDocument()},!1):parent.attachEvent&&parent.attachEvent("onunload",function(){setDocument()})),support.attributes=!0,support.getElementsByTagName=!0,support.getElementsByClassName=rnative.test(doc.getElementsByClassName),support.getById=!0,Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}},Expr.find.TAG=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined)return context.getElementsByTagName(tag)}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],support.disconnectedMatch=!0,rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains$1=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains$1(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains$1(preferredDoc,b)?1:sortInput?indexOf$1.call(sortInput,a)-indexOf$1.call(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf$1.call(sortInput,a)-indexOf$1.call(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document$1},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document$1&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document$1,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document$1&&setDocument(context),contains$1(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document$1&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf$1.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document$1.activeElement&&(!document$1.hasFocus||document$1.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push$1.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=!0;var isArray=Array.isArray,toArray=function(obj){var i,l,array=obj;if(!isArray(obj))for(array=[],i=0,l=obj.length;i<l;i++)array[i]=obj[i];return array},each$1=function(o,cb,s){var n,l;if(!o)return 0;if(s=s||o,void 0!==o.length){for(n=0,l=o.length;n<l;n++)if(cb.call(s,o[n],n,o)===!1)return 0}else for(n in o)if(o.hasOwnProperty(n)&&cb.call(s,o[n],n,o)===!1)return 0;return 1},map$1=function(array,callback){var out=[];return each$1(array,function(item,index){out.push(callback(item,index,array))}),out},filter$1=function(a,f){var o=[];return each$1(a,function(v,index){f&&!f(v,index,a)||o.push(v)}),o},indexOf$2=function(a,v){var i,l;if(a)for(i=0,l=a.length;i<l;i++)if(a[i]===v)return i;return-1},reduce=function(collection,iteratee,accumulator,thisArg){var i=0;for(arguments.length<3&&(accumulator=collection[0]);i<collection.length;i++)accumulator=iteratee.call(thisArg,accumulator,collection[i],i);return accumulator},findIndex$1=function(array,predicate,thisArg){var i,l;for(i=0,l=array.length;i<l;i++)if(predicate.call(thisArg,array[i],i,array))return i;return-1},find$1=function(array,predicate,thisArg){var idx=findIndex$1(array,predicate,thisArg);if(idx!==-1)return array[idx]},last$1=function(collection){return collection[collection.length-1]},$_9tjm51ljh8lywbq={isArray:isArray,toArray:toArray,each:each$1,map:map$1,filter:filter$1,indexOf:indexOf$2,reduce:reduce,findIndex:findIndex$1,find:find$1,last:last$1},whiteSpaceRegExp=/^\s*|\s*$/g,trim=function(str){return null===str||void 0===str?"":(""+str).replace(whiteSpaceRegExp,"")},is=function(obj,type){return type?!("array"!==type||!$_9tjm51ljh8lywbq.isArray(obj))||typeof obj===type:void 0!==obj},makeMap=function(items,delim,map){var i;for(items=items||[],delim=delim||",","string"==typeof items&&(items=items.split(delim)),map=map||{},i=items.length;i--;)map[items[i]]={};return map},hasOwnProperty=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)},create=function(s,p,root){var sp,ns,cn,scn,c,self=this,de=0;if(s=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(s),cn=s[3].match(/(^|\.)(\w+)$/i)[2],ns=self.createNS(s[3].replace(/\.\w+$/,""),root),!ns[cn]){if("static"===s[2])return ns[cn]=p,void(this.onCreate&&this.onCreate(s[2],s[3],ns[cn]));p[cn]||(p[cn]=function(){},de=1),ns[cn]=p[cn],self.extend(ns[cn].prototype,p),s[5]&&(sp=self.resolve(s[5]).prototype,scn=s[5].match(/\.(\w+)$/i)[1],c=ns[cn],de?ns[cn]=function(){return sp[scn].apply(this,arguments)}:ns[cn]=function(){return this.parent=sp[scn],c.apply(this,arguments)},ns[cn].prototype[cn]=ns[cn],self.each(sp,function(f,n){ns[cn].prototype[n]=sp[n]}),self.each(p,function(f,n){sp[n]?ns[cn].prototype[n]=function(){return this.parent=sp[n],f.apply(this,arguments)}:n!==cn&&(ns[cn].prototype[n]=f)})),self.each(p["static"],function(f,n){ns[cn][n]=f})}},extend=function(obj,ext){for(var x=[],_i=2;_i<arguments.length;_i++)x[_i-2]=arguments[_i];var i,l,name,value,args=arguments;for(i=1,l=args.length;i<l;i++){ext=args[i];for(name in ext)ext.hasOwnProperty(name)&&(value=ext[name],void 0!==value&&(obj[name]=value))}return obj},walk=function(o,f,n,s){s=s||this,o&&(n&&(o=o[n]),$_9tjm51ljh8lywbq.each(o,function(o,i){return f.call(s,o,i,n)!==!1&&void walk(o,f,n,s)}))},createNS=function(n,o){var i,v;for(o=o||window,n=n.split("."),i=0;i<n.length;i++)v=n[i],o[v]||(o[v]={}),o=o[v];return o},resolve$1=function(n,o){var i,l;for(o=o||window,n=n.split("."),i=0,l=n.length;i<l&&(o=o[n[i]],o);i++);return o},explode=function(s,d){return!s||is(s,"array")?s:$_9tjm51ljh8lywbq.map(s.split(d||","),trim)},_addCacheSuffix=function(url){var cacheSuffix=$_9bpim8ajh8lyw68.cacheSuffix;return cacheSuffix&&(url+=(url.indexOf("?")===-1?"?":"&")+cacheSuffix),url},$_ahowuxkjh8lywbj={trim:trim,isArray:$_9tjm51ljh8lywbq.isArray,is:is,toArray:$_9tjm51ljh8lywbq.toArray,makeMap:makeMap,each:$_9tjm51ljh8lywbq.each,map:$_9tjm51ljh8lywbq.map,grep:$_9tjm51ljh8lywbq.filter,inArray:$_9tjm51ljh8lywbq.indexOf,hasOwn:hasOwnProperty,extend:extend,create:create,walk:walk,createNS:createNS,resolve:resolve$1,explode:explode,_addCacheSuffix:_addCacheSuffix},doc=document,push$2=Array.prototype.push,slice$2=Array.prototype.slice,rquickExpr$1=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Event=EventUtils.Event,skipUniques=$_ahowuxkjh8lywbj.makeMap("children,contents,next,prev"),isDefined=function(obj){return"undefined"!=typeof obj},isString=function(obj){return"string"==typeof obj},isWindow=function(obj){return obj&&obj===obj.window},createFragment=function(html,fragDoc){var frag,node,container;for(fragDoc=fragDoc||doc,container=fragDoc.createElement("div"),frag=fragDoc.createDocumentFragment(),container.innerHTML=html;node=container.firstChild;)frag.appendChild(node);return frag},domManipulate=function(targetNodes,sourceItem,callback,reverse){var i;if(isString(sourceItem))sourceItem=createFragment(sourceItem,getElementDocument(targetNodes[0]));else if(sourceItem.length&&!sourceItem.nodeType){if(sourceItem=DomQuery.makeArray(sourceItem),reverse)for(i=sourceItem.length-1;i>=0;i--)domManipulate(targetNodes,sourceItem[i],callback,reverse);else for(i=0;i<sourceItem.length;i++)domManipulate(targetNodes,sourceItem[i],callback,reverse);return targetNodes}if(sourceItem.nodeType)for(i=targetNodes.length;i--;)callback.call(targetNodes[i],sourceItem);return targetNodes},hasClass=function(node,className){return node&&className&&(" "+node.className+" ").indexOf(" "+className+" ")!==-1},wrap=function(elements,wrapper,all){var lastParent,newWrapper;return wrapper=DomQuery(wrapper)[0],elements.each(function(){var self=this;all&&lastParent===self.parentNode?newWrapper.appendChild(self):(lastParent=self.parentNode,newWrapper=wrapper.cloneNode(!1),self.parentNode.insertBefore(newWrapper,self),newWrapper.appendChild(self))}),elements},numericCssMap=$_ahowuxkjh8lywbj.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),booleanMap=$_ahowuxkjh8lywbj.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),propFix={"for":"htmlFor","class":"className",readonly:"readOnly"},cssFix={"float":"cssFloat"},attrHooks={},cssHooks={},DomQuery=function(selector,context){return new DomQuery.fn.init(selector,context)},inArray=function(item,array){var i;if(array.indexOf)return array.indexOf(item);for(i=array.length;i--;)if(array[i]===item)return i;return-1},whiteSpaceRegExp$1=/^\s*|\s*$/g,trim$1=function(str){return null===str||void 0===str?"":(""+str).replace(whiteSpaceRegExp$1,"")},each$2=function(obj,callback){var length,key,i,value;if(obj)if(length=obj.length,void 0===length){for(key in obj)if(obj.hasOwnProperty(key)&&(value=obj[key],callback.call(value,key,value)===!1))break}else for(i=0;i<length&&(value=obj[i],callback.call(value,i,value)!==!1);i++);return obj},grep=function(array,callback){var out=[];return each$2(array,function(i,item){callback(item,i)&&out.push(item)}),out},getElementDocument=function(element){return element?9===element.nodeType?element:element.ownerDocument:doc};DomQuery.fn=DomQuery.prototype={constructor:DomQuery,selector:"",context:null,length:0,init:function(selector,context){var match,node,self=this;if(!selector)return self;if(selector.nodeType)return self.context=self[0]=selector,self.length=1,self;if(context&&context.nodeType)self.context=context;else{if(context)return DomQuery(selector).attr(context);self.context=context=document}if(isString(selector)){if(self.selector=selector,match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr$1.exec(selector),!match)return DomQuery(context).find(selector);if(match[1])for(node=createFragment(selector,getElementDocument(context)).firstChild;node;)push$2.call(self,node),node=node.nextSibling;else{if(node=getElementDocument(context).getElementById(match[2]),!node)return self;if(node.id!==match[2])return self.find(selector);self.length=1,self[0]=node}}else this.add(selector,!1);return self},toArray:function(){return $_ahowuxkjh8lywbj.toArray(this)},add:function(items,sort){var nodes,i,self=this;if(isString(items))return self.add(DomQuery(items));if(sort!==!1)for(nodes=DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items))),self.length=nodes.length,i=0;i<nodes.length;i++)self[i]=nodes[i];else push$2.apply(self,DomQuery.makeArray(items));return self},attr:function(name,value){var hook,self=this;if("object"==typeof name)each$2(name,function(name,value){self.attr(name,value)});else{if(!isDefined(value)){if(self[0]&&1===self[0].nodeType){if(hook=attrHooks[name],hook&&hook.get)return hook.get(self[0],name);if(booleanMap[name])return self.prop(name)?name:void 0;value=self[0].getAttribute(name,2),null===value&&(value=void 0)}return value}this.each(function(){var hook;if(1===this.nodeType){if(hook=attrHooks[name],hook&&hook.set)return void hook.set(this,value);null===value?this.removeAttribute(name,2):this.setAttribute(name,value,2)}})}return self},removeAttr:function(name){return this.attr(name,null)},prop:function(name,value){var self=this;if(name=propFix[name]||name,"object"==typeof name)each$2(name,function(name,value){self.prop(name,value)});else{if(!isDefined(value))return self[0]&&self[0].nodeType&&name in self[0]?self[0][name]:value;this.each(function(){1===this.nodeType&&(this[name]=value)})}return self},css:function(name,value){var elm,hook,self=this,camel=function(name){return name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()})},dashed=function(name){return name.replace(/[A-Z]/g,function(a){return"-"+a})};if("object"==typeof name)each$2(name,function(name,value){self.css(name,value)});else if(isDefined(value))name=camel(name),"number"!=typeof value||numericCssMap[name]||(value=value.toString()+"px"),self.each(function(){var style=this.style;if(hook=cssHooks[name],hook&&hook.set)return void hook.set(this,value);try{this.style[cssFix[name]||name]=value}catch(ex){}null!==value&&""!==value||(style.removeProperty?style.removeProperty(dashed(name)):style.removeAttribute(name))});else{if(elm=self[0],hook=cssHooks[name],hook&&hook.get)return hook.get(elm);if(!elm.ownerDocument.defaultView)return elm.currentStyle?elm.currentStyle[camel(name)]:"";try{return elm.ownerDocument.defaultView.getComputedStyle(elm,null).getPropertyValue(dashed(name))}catch(ex){return}}return self},remove:function(){for(var node,self=this,i=this.length;i--;)node=self[i],Event.clean(node),node.parentNode&&node.parentNode.removeChild(node);return this},empty:function(){for(var node,self=this,i=this.length;i--;)for(node=self[i];node.firstChild;)node.removeChild(node.firstChild);return this},html:function(value){var i,self=this;if(isDefined(value)){i=self.length;try{for(;i--;)self[i].innerHTML=value}catch(ex){DomQuery(self[i]).empty().append(value)}return self}return self[0]?self[0].innerHTML:""},text:function(value){var i,self=this;if(isDefined(value)){for(i=self.length;i--;)"innerText"in self[i]?self[i].innerText=value:self[0].textContent=value;return self}return self[0]?self[0].innerText||self[0].textContent:""},append:function(){return domManipulate(this,arguments,function(node){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(node)})},prepend:function(){return domManipulate(this,arguments,function(node){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(node,this.firstChild)},!0)},before:function(){var self=this;return self[0]&&self[0].parentNode?domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this);
}):self},after:function(){var self=this;return self[0]&&self[0].parentNode?domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this.nextSibling)},!0):self},appendTo:function(val){return DomQuery(val).append(this),this},prependTo:function(val){return DomQuery(val).prepend(this),this},replaceWith:function(content){return this.before(content).remove()},wrap:function(content){return wrap(this,content)},wrapAll:function(content){return wrap(this,content,!0)},wrapInner:function(content){return this.each(function(){DomQuery(this).contents().wrapAll(content)}),this},unwrap:function(){return this.parent().each(function(){DomQuery(this).replaceWith(this.childNodes)})},clone:function(){var result=[];return this.each(function(){result.push(this.cloneNode(!0))}),DomQuery(result)},addClass:function(className){return this.toggleClass(className,!0)},removeClass:function(className){return this.toggleClass(className,!1)},toggleClass:function(className,state){var self=this;return"string"!=typeof className?self:(className.indexOf(" ")!==-1?each$2(className.split(" "),function(){self.toggleClass(this,state)}):self.each(function(index,node){var existingClassName,classState;classState=hasClass(node,className),classState!==state&&(existingClassName=node.className,classState?node.className=trim$1((" "+existingClassName+" ").replace(" "+className+" "," ")):node.className+=existingClassName?" "+className:className)}),self)},hasClass:function(className){return hasClass(this[0],className)},each:function(callback){return each$2(this,callback)},on:function(name,callback){return this.each(function(){Event.bind(this,name,callback)})},off:function(name,callback){return this.each(function(){Event.unbind(this,name,callback)})},trigger:function(name){return this.each(function(){"object"==typeof name?Event.fire(this,name.type,name):Event.fire(this,name)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new DomQuery(slice$2.apply(this,arguments))},eq:function(index){return index===-1?this.slice(index):this.slice(index,+index+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(selector){var i,l,ret=[];for(i=0,l=this.length;i<l;i++)DomQuery.find(selector,this[i],ret);return DomQuery(ret)},filter:function(selector){return DomQuery("function"==typeof selector?grep(this.toArray(),function(item,i){return selector(i,item)}):DomQuery.filter(selector,this.toArray()))},closest:function(selector){var result=[];return selector instanceof DomQuery&&(selector=selector[0]),this.each(function(i,node){for(;node;){if("string"==typeof selector&&DomQuery(node).is(selector)){result.push(node);break}if(node===selector){result.push(node);break}node=node.parentNode}}),DomQuery(result)},offset:function(offset){var elm,doc,docElm,pos,x=0,y=0;return offset?this.css(offset):(elm=this[0],elm&&(doc=elm.ownerDocument,docElm=doc.documentElement,elm.getBoundingClientRect&&(pos=elm.getBoundingClientRect(),x=pos.left+(docElm.scrollLeft||doc.body.scrollLeft)-docElm.clientLeft,y=pos.top+(docElm.scrollTop||doc.body.scrollTop)-docElm.clientTop)),{left:x,top:y})},push:push$2,sort:[].sort,splice:[].splice},$_ahowuxkjh8lywbj.extend(DomQuery,{extend:$_ahowuxkjh8lywbj.extend,makeArray:function(object){return isWindow(object)||object.nodeType?[object]:$_ahowuxkjh8lywbj.toArray(object)},inArray:inArray,isArray:$_ahowuxkjh8lywbj.isArray,each:each$2,trim:trim$1,grep:grep,find:Sizzle,expr:Sizzle.selectors,unique:Sizzle.uniqueSort,text:Sizzle.getText,contains:Sizzle.contains,filter:function(expr,elems,not){var i=elems.length;for(not&&(expr=":not("+expr+")");i--;)1!==elems[i].nodeType&&elems.splice(i,1);return elems=1===elems.length?DomQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:DomQuery.find.matches(expr,elems)}});var dir=function(el,prop,until){var matched=[],cur=el[prop];for("string"!=typeof until&&until instanceof DomQuery&&(until=until[0]);cur&&9!==cur.nodeType;){if(void 0!==until){if(cur===until)break;if("string"==typeof until&&DomQuery(cur).is(until))break}1===cur.nodeType&&matched.push(cur),cur=cur[prop]}return matched},sibling=function(node,siblingName,nodeType,until){var result=[];for(until instanceof DomQuery&&(until=until[0]);node;node=node[siblingName])if(!nodeType||node.nodeType===nodeType){if(void 0!==until){if(node===until)break;if("string"==typeof until&&DomQuery(node).is(until))break}result.push(node)}return result},firstSibling=function(node,siblingName,nodeType){for(node=node[siblingName];node;node=node[siblingName])if(node.nodeType===nodeType)return node;return null};each$2({parent:function(node){var parent=node.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(node){return dir(node,"parentNode")},next:function(node){return firstSibling(node,"nextSibling",1)},prev:function(node){return firstSibling(node,"previousSibling",1)},children:function(node){return sibling(node.firstChild,"nextSibling",1)},contents:function(node){return $_ahowuxkjh8lywbj.toArray(("iframe"===node.nodeName?node.contentDocument||node.contentWindow.document:node).childNodes)}},function(name,fn){DomQuery.fn[name]=function(selector){var self=this,result=[];return self.each(function(){var nodes=fn.call(result,this,selector,result);nodes&&(DomQuery.isArray(nodes)?result.push.apply(result,nodes):result.push(nodes))}),this.length>1&&(skipUniques[name]||(result=DomQuery.unique(result)),0===name.indexOf("parents")&&(result=result.reverse())),result=DomQuery(result),selector?result.filter(selector):result}}),each$2({parentsUntil:function(node,until){return dir(node,"parentNode",until)},nextUntil:function(node,until){return sibling(node,"nextSibling",1,until).slice(1)},prevUntil:function(node,until){return sibling(node,"previousSibling",1,until).slice(1)}},function(name,fn){DomQuery.fn[name]=function(selector,filter){var self=this,result=[];return self.each(function(){var nodes=fn.call(result,this,selector,result);nodes&&(DomQuery.isArray(nodes)?result.push.apply(result,nodes):result.push(nodes))}),this.length>1&&(result=DomQuery.unique(result),0!==name.indexOf("parents")&&"prevUntil"!==name||(result=result.reverse())),result=DomQuery(result),filter?result.filter(filter):result}}),DomQuery.fn.is=function(selector){return!!selector&&this.filter(selector).length>0},DomQuery.fn.init.prototype=DomQuery.fn,DomQuery.overrideDefaults=function(callback){var defaults,sub=function(selector,context){return defaults=defaults||callback(),0===arguments.length&&(selector=defaults.element),context||(context=defaults.context),new sub.fn.init(selector,context)};return DomQuery.extend(sub,this),sub};var appendHooks=function(targetHooks,prop,hooks){each$2(hooks,function(name,func){targetHooks[name]=targetHooks[name]||{},targetHooks[name][prop]=func})};$_9bpim8ajh8lyw68.ie&&$_9bpim8ajh8lyw68.ie<8&&(appendHooks(attrHooks,"get",{maxlength:function(elm){var value=elm.maxLength;if(2147483647!==value)return value},size:function(elm){var value=elm.size;if(20!==value)return value},"class":function(elm){return elm.className},style:function(elm){var value=elm.style.cssText;if(0!==value.length)return value}}),appendHooks(attrHooks,"set",{"class":function(elm,value){elm.className=value},style:function(elm,value){elm.style.cssText=value}})),$_9bpim8ajh8lyw68.ie&&$_9bpim8ajh8lyw68.ie<9&&(cssFix["float"]="styleFloat",appendHooks(cssHooks,"set",{opacity:function(elm,value){var style=elm.style;null===value||""===value?style.removeAttribute("filter"):(style.zoom=1,style.filter="alpha(opacity="+100*value+")")}})),DomQuery.attrHooks=attrHooks,DomQuery.cssHooks=cssHooks;var namedEntities,baseEntities,reverseEntities,cached=function(f){var r,called=!1;return function(){return called||(called=!0,r=f.apply(null,arguments)),r}},$_bbi2igojh8lywc9={cached:cached},firstMatch=function(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s))return x}},find$2=function(regexes,agent){var r=firstMatch(regexes,agent);if(!r)return{major:0,minor:0};var group=function(i){return Number(agent.replace(r,"$"+i))};return nu(group(1),group(2))},detect=function(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();return 0===versionRegexes.length?unknown():find$2(versionRegexes,cleanedAgent)},unknown=function(){return nu(0,0)},nu=function(major,minor){return{major:major,minor:minor}},$_a84zfnrjh8lywch={nu:nu,detect:detect,unknown:unknown},edge="Edge",chrome="Chrome",ie$1="IE",opera$1="Opera",firefox="Firefox",safari="Safari",isBrowser=function(name,current){return function(){return current===name}},unknown$1=function(){return nu$1({current:void 0,version:$_a84zfnrjh8lywch.unknown()})},nu$1=function(info){var current=info.current,version=info.version;return{current:current,version:version,isEdge:isBrowser(edge,current),isChrome:isBrowser(chrome,current),isIE:isBrowser(ie$1,current),isOpera:isBrowser(opera$1,current),isFirefox:isBrowser(firefox,current),isSafari:isBrowser(safari,current)}},$_dckbfzqjh8lywcd={unknown:unknown$1,nu:nu$1,edge:$_eqpqvr6jh8lyw3s.constant(edge),chrome:$_eqpqvr6jh8lyw3s.constant(chrome),ie:$_eqpqvr6jh8lyw3s.constant(ie$1),opera:$_eqpqvr6jh8lyw3s.constant(opera$1),firefox:$_eqpqvr6jh8lyw3s.constant(firefox),safari:$_eqpqvr6jh8lyw3s.constant(safari)},windows="Windows",ios="iOS",android$1="Android",linux="Linux",osx="OSX",solaris="Solaris",freebsd="FreeBSD",isOS=function(name,current){return function(){return current===name}},unknown$2=function(){return nu$2({current:void 0,version:$_a84zfnrjh8lywch.unknown()})},nu$2=function(info){var current=info.current,version=info.version;return{current:current,version:version,isWindows:isOS(windows,current),isiOS:isOS(ios,current),isAndroid:isOS(android$1,current),isOSX:isOS(osx,current),isLinux:isOS(linux,current),isSolaris:isOS(solaris,current),isFreeBSD:isOS(freebsd,current)}},$_dixfehsjh8lywcw={unknown:unknown$2,nu:nu$2,windows:$_eqpqvr6jh8lyw3s.constant(windows),ios:$_eqpqvr6jh8lyw3s.constant(ios),android:$_eqpqvr6jh8lyw3s.constant(android$1),linux:$_eqpqvr6jh8lyw3s.constant(linux),osx:$_eqpqvr6jh8lyw3s.constant(osx),solaris:$_eqpqvr6jh8lyw3s.constant(solaris),freebsd:$_eqpqvr6jh8lyw3s.constant(freebsd)},detect$1=function(candidates,userAgent){var agent=String(userAgent).toLowerCase();return $_5wjzy24jh8lyw2t.find(candidates,function(candidate){return candidate.search(agent)})},detectBrowser=function(browsers,userAgent){return detect$1(browsers,userAgent).map(function(browser){var version=$_a84zfnrjh8lywch.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version}})},detectOs=function(oses,userAgent){return detect$1(oses,userAgent).map(function(os){var version=$_a84zfnrjh8lywch.detect(os.versionRegexes,userAgent);return{current:os.name,version:version}})},$_deu818ujh8lywd4={detectBrowser:detectBrowser,detectOs:detectOs},addToStart=function(str,prefix){return prefix+str},addToEnd=function(str,suffix){return str+suffix},removeFromStart=function(str,numChars){return str.substring(numChars)},removeFromEnd=function(str,numChars){return str.substring(0,str.length-numChars)},$_4h6f09xjh8lywdm={addToStart:addToStart,addToEnd:addToEnd,removeFromStart:removeFromStart,removeFromEnd:removeFromEnd},first=function(str,count){return str.substr(0,count)},last$2=function(str,count){return str.substr(str.length-count,str.length)},head$1=function(str){return""===str?Option.none():Option.some(str.substr(0,1))},tail=function(str){return""===str?Option.none():Option.some(str.substring(1))},$_amulxnyjh8lywdo={first:first,last:last$2,head:head$1,tail:tail},checkRange=function(str,substr,start){if(""===substr)return!0;if(str.length<substr.length)return!1;var x=str.substr(start,start+substr.length);return x===substr},supplant=function(str,obj){var isStringOrNumber=function(a){var t=typeof a;return"string"===t||"number"===t};return str.replace(/\${([^{}]*)}/g,function(a,b){var value=obj[b];return isStringOrNumber(value)?value:a})},removeLeading=function(str,prefix){return startsWith(str,prefix)?$_4h6f09xjh8lywdm.removeFromStart(str,prefix.length):str},removeTrailing=function(str,prefix){return endsWith(str,prefix)?$_4h6f09xjh8lywdm.removeFromEnd(str,prefix.length):str},ensureLeading=function(str,prefix){return startsWith(str,prefix)?str:$_4h6f09xjh8lywdm.addToStart(str,prefix)},ensureTrailing=function(str,prefix){return endsWith(str,prefix)?str:$_4h6f09xjh8lywdm.addToEnd(str,prefix)},contains$2=function(str,substr){return str.indexOf(substr)!==-1},capitalize=function(str){return $_amulxnyjh8lywdo.head(str).bind(function(head){return $_amulxnyjh8lywdo.tail(str).map(function(tail){return head.toUpperCase()+tail})}).getOr(str)},startsWith=function(str,prefix){return checkRange(str,prefix,0)},endsWith=function(str,suffix){return checkRange(str,suffix,str.length-suffix.length)},trim$2=function(str){return str.replace(/^\s+|\s+$/g,"")},lTrim=function(str){return str.replace(/^\s+/g,"")},rTrim=function(str){return str.replace(/\s+$/g,"")},$_4w196awjh8lywdj={supplant:supplant,startsWith:startsWith,removeLeading:removeLeading,removeTrailing:removeTrailing,ensureLeading:ensureLeading,ensureTrailing:ensureTrailing,endsWith:endsWith,contains:contains$2,trim:trim$2,lTrim:lTrim,rTrim:rTrim,capitalize:capitalize},normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,checkContains=function(target){return function(uastring){return $_4w196awjh8lywdj.contains(uastring,target)}},browsers=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(uastring){var monstrosity=$_4w196awjh8lywdj.contains(uastring,"edge/")&&$_4w196awjh8lywdj.contains(uastring,"chrome")&&$_4w196awjh8lywdj.contains(uastring,"safari")&&$_4w196awjh8lywdj.contains(uastring,"applewebkit");return monstrosity}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function(uastring){return $_4w196awjh8lywdj.contains(uastring,"chrome")&&!$_4w196awjh8lywdj.contains(uastring,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(uastring){return $_4w196awjh8lywdj.contains(uastring,"msie")||$_4w196awjh8lywdj.contains(uastring,"trident")}},{name:"Opera",versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(uastring){return($_4w196awjh8lywdj.contains(uastring,"safari")||$_4w196awjh8lywdj.contains(uastring,"mobile/"))&&$_4w196awjh8lywdj.contains(uastring,"applewebkit")}}],oses=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(uastring){return $_4w196awjh8lywdj.contains(uastring,"iphone")||$_4w196awjh8lywdj.contains(uastring,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]}],$_8gakxrvjh8lywdb={browsers:$_eqpqvr6jh8lyw3s.constant(browsers),oses:$_eqpqvr6jh8lyw3s.constant(oses)},detect$2=function(userAgent){var browsers=$_8gakxrvjh8lywdb.browsers(),oses=$_8gakxrvjh8lywdb.oses(),browser=$_deu818ujh8lywd4.detectBrowser(browsers,userAgent).fold($_dckbfzqjh8lywcd.unknown,$_dckbfzqjh8lywcd.nu),os=$_deu818ujh8lywd4.detectOs(oses,userAgent).fold($_dixfehsjh8lywcw.unknown,$_dixfehsjh8lywcw.nu),deviceType=DeviceType(os,browser,userAgent);return{browser:browser,os:os,deviceType:deviceType}},$_3cj09epjh8lywcb={detect:detect$2},detect$3=$_bbi2igojh8lywc9.cached(function(){var userAgent=navigator.userAgent;return $_3cj09epjh8lywcb.detect(userAgent)}),$_9hkktfnjh8lywc6={detect:detect$3},fromHtml=function(html,scope){var doc=scope||document,div=doc.createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||div.childNodes.length>1)throw console.error("HTML does not have a single root node",html),"HTML must have a single root node";return fromDom(div.childNodes[0])},fromTag=function(tag,scope){var doc=scope||document,node=doc.createElement(tag);return fromDom(node)},fromText=function(text,scope){var doc=scope||document,node=doc.createTextNode(text);return fromDom(node)},fromDom=function(node){if(null===node||void 0===node)throw new Error("Node cannot be null or undefined");return{dom:$_eqpqvr6jh8lyw3s.constant(node)}},fromPoint=function(doc,x,y){return Option.from(doc.dom().elementFromPoint(x,y)).map(fromDom)},$_cgttw3zjh8lywdq={fromHtml:fromHtml,fromTag:fromTag,fromText:fromText,fromDom:fromDom,fromPoint:fromPoint},$_2ctxk11jh8lywdy={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12},name$1=function(element){var r=element.dom().nodeName;return r.toLowerCase()},type=function(element){return element.dom().nodeType},value=function(element){return element.dom().nodeValue},isType$1=function(t){return function(element){return type(element)===t}},isComment=function(element){return type(element)===$_2ctxk11jh8lywdy.COMMENT||"#comment"===name$1(element)},isElement=isType$1($_2ctxk11jh8lywdy.ELEMENT),isText=isType$1($_2ctxk11jh8lywdy.TEXT),isDocument=isType$1($_2ctxk11jh8lywdy.DOCUMENT),$_7j1jt210jh8lywdx={name:name$1,type:type,value:value,isElement:isElement,isText:isText,isDocument:isDocument,isComment:isComment},keys=function(){var fastKeys=Object.keys,slowKeys=function(o){var r=[];for(var i in o)o.hasOwnProperty(i)&&r.push(i);return r};return void 0===fastKeys?slowKeys:fastKeys}(),each$3=function(obj,f){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k],x=obj[i];f(x,i,obj)}},objectMap=function(obj,f){return tupleMap(obj,function(x,i,obj){return{k:i,v:f(x,i,obj)}})},tupleMap=function(obj,f){var r={};return each$3(obj,function(x,i){var tuple=f(x,i,obj);r[tuple.k]=tuple.v}),r},bifilter=function(obj,pred){var t={},f={};return each$3(obj,function(x,i){var branch=pred(x,i)?t:f;branch[i]=x}),{t:t,f:f}},mapToArray=function(obj,f){var r=[];return each$3(obj,function(value,name){r.push(f(value,name))}),r},find$3=function(obj,pred){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k],x=obj[i];if(pred(x,i,obj))return Option.some(x)}return Option.none()},values=function(obj){return mapToArray(obj,function(v){return v})},size=function(obj){return values(obj).length},$_g63v2c13jh8lywej={bifilter:bifilter,each:each$3,map:objectMap,mapToArray:mapToArray,tupleMap:tupleMap,find:find$3,keys:keys,values:values,size:size},rawSet=function(dom,key,value){if(!($_dp4g6d7jh8lyw3y.isString(value)||$_dp4g6d7jh8lyw3y.isBoolean(value)||$_dp4g6d7jh8lyw3y.isNumber(value)))throw console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom),new Error("Attribute value was not simple");dom.setAttribute(key,value+"")},set=function(element,key,value){rawSet(element.dom(),key,value)},setAll=function(element,attrs){var dom=element.dom();$_g63v2c13jh8lywej.each(attrs,function(v,k){rawSet(dom,k,v)})},get=function(element,key){var v=element.dom().getAttribute(key);return null===v?void 0:v},has=function(element,key){var dom=element.dom();return!(!dom||!dom.hasAttribute)&&dom.hasAttribute(key)},remove=function(element,key){element.dom().removeAttribute(key)},hasNone=function(element){var attrs=element.dom().attributes;return void 0===attrs||null===attrs||0===attrs.length},clone=function(element){return $_5wjzy24jh8lyw2t.foldl(element.dom().attributes,function(acc,attr){return acc[attr.name]=attr.value,acc},{})},transferOne=function(source,destination,attr){has(source,attr)&&!has(destination,attr)&&set(destination,attr,get(source,attr))},transfer=function(source,destination,attrs){$_7j1jt210jh8lywdx.isElement(source)&&$_7j1jt210jh8lywdx.isElement(destination)&&$_5wjzy24jh8lyw2t.each(attrs,function(attr){transferOne(source,destination,attr)})},$_3da62i14jh8lyweo={clone:clone,set:set,setAll:setAll,get:get,has:has,remove:remove,hasNone:hasNone,transfer:transfer},inBody=function(element){var dom=$_7j1jt210jh8lywdx.isText(element)?element.dom().parentNode:element.dom();return void 0!==dom&&null!==dom&&dom.ownerDocument.body.contains(dom)},body=$_bbi2igojh8lywc9.cached(function(){return getBody($_cgttw3zjh8lywdq.fromDom(document))}),getBody=function(doc){var body=doc.dom().body;if(null===body||void 0===body)throw"Body is not available yet";return $_cgttw3zjh8lywdq.fromDom(body)},$_boa99a15jh8lywey={body:body,getBody:getBody,inBody:inBody},isSupported=function(dom){return void 0!==dom.style},$_fjd24o16jh8lywfc={isSupported:isSupported},internalSet=function(dom,property,value){if(!$_dp4g6d7jh8lyw3y.isString(value))throw console.error("Invalid call to CSS.set. Property ",property,":: Value ",value,":: Element ",dom),new Error("CSS value must be a string: "+value);$_fjd24o16jh8lywfc.isSupported(dom)&&dom.style.setProperty(property,value)},internalRemove=function(dom,property){$_fjd24o16jh8lywfc.isSupported(dom)&&dom.style.removeProperty(property)},set$1=function(element,property,value){var dom=element.dom();internalSet(dom,property,value)},setAll$1=function(element,css){var dom=element.dom();$_g63v2c13jh8lywej.each(css,function(v,k){internalSet(dom,k,v)})},setOptions=function(element,css){var dom=element.dom();$_g63v2c13jh8lywej.each(css,function(v,k){v.fold(function(){internalRemove(dom,k)},function(value){internalSet(dom,k,value)})})},get$1=function(element,property){var dom=element.dom(),styles=window.getComputedStyle(dom),r=styles.getPropertyValue(property),v=""!==r||$_boa99a15jh8lywey.inBody(element)?r:getUnsafeProperty(dom,property);return null===v?void 0:v},getUnsafeProperty=function(dom,property){return $_fjd24o16jh8lywfc.isSupported(dom)?dom.style.getPropertyValue(property):""},getRaw=function(element,property){var dom=element.dom(),raw=getUnsafeProperty(dom,property);return Option.from(raw).filter(function(r){return r.length>0})},getAllRaw=function(element){var css={},dom=element.dom();if($_fjd24o16jh8lywfc.isSupported(dom))for(var i=0;i<dom.style.length;i++){var ruleName=dom.style.item(i);css[ruleName]=dom.style[ruleName]}return css},isValidValue=function(tag,property,value){var element=$_cgttw3zjh8lywdq.fromTag(tag);set$1(element,property,value);var style=getRaw(element,property);return style.isSome()},remove$1=function(element,property){var dom=element.dom();internalRemove(dom,property),$_3da62i14jh8lyweo.has(element,"style")&&""===$_4w196awjh8lywdj.trim($_3da62i14jh8lyweo.get(element,"style"))&&$_3da62i14jh8lyweo.remove(element,"style")},preserve=function(element,f){var oldStyles=$_3da62i14jh8lyweo.get(element,"style"),result=f(element),restore=void 0===oldStyles?$_3da62i14jh8lyweo.remove:$_3da62i14jh8lyweo.set;return restore(element,"style",oldStyles),result},copy=function(source,target){var sourceDom=source.dom(),targetDom=target.dom();$_fjd24o16jh8lywfc.isSupported(sourceDom)&&$_fjd24o16jh8lywfc.isSupported(targetDom)&&(targetDom.style.cssText=sourceDom.style.cssText)},reflow=function(e){return e.dom().offsetWidth},transferOne$1=function(source,destination,style){getRaw(source,style).each(function(value){getRaw(destination,style).isNone()&&set$1(destination,style,value)})},transfer$1=function(source,destination,styles){$_7j1jt210jh8lywdx.isElement(source)&&$_7j1jt210jh8lywdx.isElement(destination)&&$_5wjzy24jh8lyw2t.each(styles,function(style){transferOne$1(source,destination,style)})},$_36knnd12jh8lywe1={copy:copy,set:set$1,preserve:preserve,setAll:setAll$1,setOptions:setOptions,remove:remove$1,get:get$1,getRaw:getRaw,getAllRaw:getAllRaw,isValidValue:isValidValue,reflow:reflow,transfer:transfer$1},sort$1=function(arr){return arr.slice(0).sort()},reqMessage=function(required,keys){throw new Error("All required keys ("+sort$1(required).join(", ")+") were not specified. Specified keys were: "+sort$1(keys).join(", ")+".")},unsuppMessage=function(unsupported){throw new Error("Unsupported keys for object: "+sort$1(unsupported).join(", "))},validateStrArr=function(label,array){if(!$_dp4g6d7jh8lyw3y.isArray(array))throw new Error("The "+label+" fields must be an array. Was: "+array+".");$_5wjzy24jh8lyw2t.each(array,function(a){if(!$_dp4g6d7jh8lyw3y.isString(a))throw new Error("The value "+a+" in the "+label+" fields was not a string.")})},invalidTypeMessage=function(incorrect,type){throw new Error("All values need to be of type: "+type+". Keys ("+sort$1(incorrect).join(", ")+") were not.")},checkDupes=function(everything){var sorted=sort$1(everything),dupe=$_5wjzy24jh8lyw2t.find(sorted,function(s,i){return i<sorted.length-1&&s===sorted[i+1]});dupe.each(function(d){throw new Error("The field: "+d+" occurs more than once in the combined fields: ["+sorted.join(", ")+"].")})},$_8ab5mm1bjh8lywg2={sort:sort$1,reqMessage:reqMessage,unsuppMessage:unsuppMessage,validateStrArr:validateStrArr,invalidTypeMessage:invalidTypeMessage,checkDupes:checkDupes},$_4jz0ce18jh8lywft={immutable:Immutable,immutableBag:MixedBag},toArray$1=function(target,f){var r=[],recurse=function(e){return r.push(e),f(e)},cur=f(target);do cur=cur.bind(recurse);while(cur.isSome());return r},$_42xx4d1cjh8lywg4={toArray:toArray$1},node=function(){var f=$_99xmy7cjh8lyw6k.getOrDie("Node");return f},compareDocumentPosition=function(a,b,match){return 0!==(a.compareDocumentPosition(b)&match)},documentPositionPreceding=function(a,b){return compareDocumentPosition(a,b,node().DOCUMENT_POSITION_PRECEDING)},documentPositionContainedBy=function(a,b){return compareDocumentPosition(a,b,node().DOCUMENT_POSITION_CONTAINED_BY)},$_1zkvjk1ejh8lywgg={documentPositionPreceding:documentPositionPreceding,documentPositionContainedBy:documentPositionContainedBy},ELEMENT=$_2ctxk11jh8lywdy.ELEMENT,DOCUMENT=$_2ctxk11jh8lywdy.DOCUMENT,is$1=function(element,selector){var elem=element.dom();if(elem.nodeType!==ELEMENT)return!1;if(void 0!==elem.matches)return elem.matches(selector);if(void 0!==elem.msMatchesSelector)return elem.msMatchesSelector(selector);if(void 0!==elem.webkitMatchesSelector)return elem.webkitMatchesSelector(selector);if(void 0!==elem.mozMatchesSelector)return elem.mozMatchesSelector(selector);throw new Error("Browser lacks native selectors")},bypassSelector=function(dom){return dom.nodeType!==ELEMENT&&dom.nodeType!==DOCUMENT||0===dom.childElementCount},all=function(selector,scope){var base=void 0===scope?document:scope.dom();return bypassSelector(base)?[]:$_5wjzy24jh8lyw2t.map(base.querySelectorAll(selector),$_cgttw3zjh8lywdq.fromDom)},one=function(selector,scope){var base=void 0===scope?document:scope.dom();return bypassSelector(base)?Option.none():Option.from(base.querySelector(selector)).map($_cgttw3zjh8lywdq.fromDom)},$_5h4ipt1fjh8lywgi={all:all,is:is$1,one:one},eq=function(e1,e2){return e1.dom()===e2.dom()},isEqualNode=function(e1,e2){return e1.dom().isEqualNode(e2.dom())},member=function(element,elements){return $_5wjzy24jh8lyw2t.exists(elements,$_eqpqvr6jh8lyw3s.curry(eq,element))},regularContains=function(e1,e2){var d1=e1.dom(),d2=e2.dom();return d1!==d2&&d1.contains(d2)},ieContains=function(e1,e2){return $_1zkvjk1ejh8lywgg.documentPositionContainedBy(e1.dom(),e2.dom())},browser=$_9hkktfnjh8lywc6.detect().browser,contains$3=browser.isIE()?ieContains:regularContains,$_5f6gpb1djh8lywg5={eq:eq,isEqualNode:isEqualNode,member:member,contains:contains$3,is:$_5h4ipt1fjh8lywgi.is},owner=function(element){return $_cgttw3zjh8lywdq.fromDom(element.dom().ownerDocument)},documentElement=function(element){var doc=owner(element);return $_cgttw3zjh8lywdq.fromDom(doc.dom().documentElement)},defaultView=function(element){var el=element.dom(),defaultView=el.ownerDocument.defaultView;return $_cgttw3zjh8lywdq.fromDom(defaultView)},parent=function(element){var dom=element.dom();return Option.from(dom.parentNode).map($_cgttw3zjh8lywdq.fromDom)},findIndex$2=function(element){return parent(element).bind(function(p){var kin=children(p);return $_5wjzy24jh8lyw2t.findIndex(kin,function(elem){return $_5f6gpb1djh8lywg5.eq(element,elem)})})},parents=function(element,isRoot){for(var stop=$_dp4g6d7jh8lyw3y.isFunction(isRoot)?isRoot:$_eqpqvr6jh8lyw3s.constant(!1),dom=element.dom(),ret=[];null!==dom.parentNode&&void 0!==dom.parentNode;){var rawParent=dom.parentNode,parent=$_cgttw3zjh8lywdq.fromDom(rawParent);if(ret.push(parent),stop(parent)===!0)break;dom=rawParent}return ret},siblings=function(element){var filterSelf=function(elements){return $_5wjzy24jh8lyw2t.filter(elements,function(x){return!$_5f6gpb1djh8lywg5.eq(element,x)})};return parent(element).map(children).map(filterSelf).getOr([])},offsetParent=function(element){var dom=element.dom();return Option.from(dom.offsetParent).map($_cgttw3zjh8lywdq.fromDom)},prevSibling=function(element){var dom=element.dom();return Option.from(dom.previousSibling).map($_cgttw3zjh8lywdq.fromDom)},nextSibling=function(element){var dom=element.dom();return Option.from(dom.nextSibling).map($_cgttw3zjh8lywdq.fromDom)},prevSiblings=function(element){return $_5wjzy24jh8lyw2t.reverse($_42xx4d1cjh8lywg4.toArray(element,prevSibling))},nextSiblings=function(element){return $_42xx4d1cjh8lywg4.toArray(element,nextSibling)},children=function(element){var dom=element.dom();return $_5wjzy24jh8lyw2t.map(dom.childNodes,$_cgttw3zjh8lywdq.fromDom)},child=function(element,index){var children=element.dom().childNodes;return Option.from(children[index]).map($_cgttw3zjh8lywdq.fromDom)},firstChild=function(element){return child(element,0)},lastChild=function(element){return child(element,element.dom().childNodes.length-1)},childNodesCount=function(element){return element.dom().childNodes.length},hasChildNodes=function(element){return element.dom().hasChildNodes()},spot=$_4jz0ce18jh8lywft.immutable("element","offset"),leaf=function(element,offset){var cs=children(element);return cs.length>0&&offset<cs.length?spot(cs[offset],0):spot(element,offset)},$_a43q0i17jh8lywfe={owner:owner,defaultView:defaultView,documentElement:documentElement,parent:parent,findIndex:findIndex$2,parents:parents,siblings:siblings,prevSibling:prevSibling,offsetParent:offsetParent,prevSiblings:prevSiblings,nextSibling:nextSibling,nextSiblings:nextSiblings,children:children,child:child,firstChild:firstChild,lastChild:lastChild,childNodesCount:childNodesCount,hasChildNodes:hasChildNodes,leaf:leaf},browser$1=$_9hkktfnjh8lywc6.detect().browser,firstElement=function(nodes){return $_5wjzy24jh8lyw2t.find(nodes,$_7j1jt210jh8lywdx.isElement)},getTableCaptionDeltaY=function(elm){return browser$1.isFirefox()&&"table"===$_7j1jt210jh8lywdx.name(elm)?firstElement($_a43q0i17jh8lywfe.children(elm)).filter(function(elm){return"caption"===$_7j1jt210jh8lywdx.name(elm)}).bind(function(caption){return firstElement($_a43q0i17jh8lywfe.nextSiblings(caption)).map(function(body){var bodyTop=body.dom().offsetTop,captionTop=caption.dom().offsetTop,captionHeight=caption.dom().offsetHeight;return bodyTop<=captionTop?-captionHeight:0})}).getOr(0):0},getPos=function(body,elm,rootElm){var offsetParent,pos,x=0,y=0,doc=body.ownerDocument;if(rootElm=rootElm?rootElm:body,elm){if(rootElm===body&&elm.getBoundingClientRect&&"static"===$_36knnd12jh8lywe1.get($_cgttw3zjh8lywdq.fromDom(body),"position"))return pos=elm.getBoundingClientRect(),x=pos.left+(doc.documentElement.scrollLeft||body.scrollLeft)-doc.documentElement.clientLeft,y=pos.top+(doc.documentElement.scrollTop||body.scrollTop)-doc.documentElement.clientTop,{x:x,y:y};for(offsetParent=elm;offsetParent&&offsetParent!==rootElm&&offsetParent.nodeType;)x+=offsetParent.offsetLeft||0,y+=offsetParent.offsetTop||0,offsetParent=offsetParent.offsetParent;for(offsetParent=elm.parentNode;offsetParent&&offsetParent!==rootElm&&offsetParent.nodeType;)x-=offsetParent.scrollLeft||0,
y-=offsetParent.scrollTop||0,offsetParent=offsetParent.parentNode;y+=getTableCaptionDeltaY($_cgttw3zjh8lywdq.fromDom(elm))}return{x:x,y:y}},$_6pe7rlmjh8lywbu={getPos:getPos},nu$3=function(baseFn){var data=Option.none(),callbacks=[],map=function(f){return nu$3(function(nCallback){get(function(data){nCallback(f(data))})})},get=function(nCallback){isReady()?call(nCallback):callbacks.push(nCallback)},set=function(x){data=Option.some(x),run(callbacks),callbacks=[]},isReady=function(){return data.isSome()},run=function(cbs){$_5wjzy24jh8lyw2t.each(cbs,call)},call=function(cb){data.each(function(x){setTimeout(function(){cb(x)},0)})};return baseFn(set),{get:get,map:map,isReady:isReady}},pure$1=function(a){return nu$3(function(callback){callback(a)})},LazyValue={nu:nu$3,pure:pure$1},bounce=function(f){return function(){var args=Array.prototype.slice.call(arguments),me=this;setTimeout(function(){f.apply(me,args)},0)}},$_fhsj121jjh8lywh5={bounce:bounce},nu$4=function(baseFn){var get=function(callback){baseFn($_fhsj121jjh8lywh5.bounce(callback))},map=function(fab){return nu$4(function(callback){get(function(a){var value=fab(a);callback(value)})})},bind=function(aFutureB){return nu$4(function(callback){get(function(a){aFutureB(a).get(callback)})})},anonBind=function(futureB){return nu$4(function(callback){get(function(a){futureB.get(callback)})})},toLazy=function(){return LazyValue.nu(get)};return{map:map,bind:bind,anonBind:anonBind,toLazy:toLazy,get:get}},pure$2=function(a){return nu$4(function(callback){callback(a)})},Future={nu:nu$4,pure:pure$2},par=function(asyncValues,nu){return nu(function(callback){var r=[],count=0,cb=function(i){return function(value){r[i]=value,count++,count>=asyncValues.length&&callback(r)}};0===asyncValues.length?callback([]):$_5wjzy24jh8lyw2t.each(asyncValues,function(asyncValue,i){asyncValue.get(cb(i))})})},$_8nbwrm1ljh8lywh8={par:par},par$1=function(futures){return $_8nbwrm1ljh8lywh8.par(futures,Future.nu)},mapM=function(array,fn){var futures=$_5wjzy24jh8lyw2t.map(array,fn);return par$1(futures)},compose$1=function(f,g){return function(a){return g(a).bind(f)}},$_5lpsz51kjh8lywh6={par:par$1,mapM:mapM,compose:compose$1},value$1=function(o){var is=function(v){return o===v},or=function(opt){return value$1(o)},orThunk=function(f){return value$1(o)},map=function(f){return value$1(f(o))},each=function(f){f(o)},bind=function(f){return f(o)},fold=function(_,onValue){return onValue(o)},exists=function(f){return f(o)},forall=function(f){return f(o)},toOption=function(){return Option.some(o)};return{is:is,isValue:$_eqpqvr6jh8lyw3s.always,isError:$_eqpqvr6jh8lyw3s.never,getOr:$_eqpqvr6jh8lyw3s.constant(o),getOrThunk:$_eqpqvr6jh8lyw3s.constant(o),getOrDie:$_eqpqvr6jh8lyw3s.constant(o),or:or,orThunk:orThunk,fold:fold,map:map,each:each,bind:bind,exists:exists,forall:forall,toOption:toOption}},error=function(message){var getOrThunk=function(f){return f()},getOrDie=function(){return $_eqpqvr6jh8lyw3s.die(String(message))()},or=function(opt){return opt},orThunk=function(f){return f()},map=function(f){return error(message)},bind=function(f){return error(message)},fold=function(onError,_){return onError(message)};return{is:$_eqpqvr6jh8lyw3s.never,isValue:$_eqpqvr6jh8lyw3s.never,isError:$_eqpqvr6jh8lyw3s.always,getOr:$_eqpqvr6jh8lyw3s.identity,getOrThunk:getOrThunk,getOrDie:getOrDie,or:or,orThunk:orThunk,fold:fold,map:map,each:$_eqpqvr6jh8lyw3s.noop,bind:bind,exists:$_eqpqvr6jh8lyw3s.never,forall:$_eqpqvr6jh8lyw3s.always,toOption:Option.none}},Result={value:value$1,error:error},blocks=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"],voids=["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed","source","wbr","track"],tableCells=["td","th"],tableSections=["thead","tbody","tfoot"],textBlocks=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],headings=["h1","h2","h3","h4","h5","h6"],listItems=["li","dd","dt"],lists=["ul","ol","dl"],wsElements=["pre","script","textarea","style"],lazyLookup=function(items){var lookup;return function(node){return lookup=lookup?lookup:$_5wjzy24jh8lyw2t.mapToObject(items,$_eqpqvr6jh8lyw3s.constant(!0)),lookup.hasOwnProperty($_7j1jt210jh8lywdx.name(node))}},isHeading=lazyLookup(headings),isBlock=lazyLookup(blocks),isInline=function(node){return $_7j1jt210jh8lywdx.isElement(node)&&!isBlock(node)},isBr=function(node){return $_7j1jt210jh8lywdx.isElement(node)&&"br"===$_7j1jt210jh8lywdx.name(node)},isTextBlock=lazyLookup(textBlocks),isList=lazyLookup(lists),isListItem=lazyLookup(listItems),isVoid=lazyLookup(voids),isTableSection=lazyLookup(tableSections),isTableCell=lazyLookup(tableCells),isWsPreserveElement=lazyLookup(wsElements),isNodeType=function(type){return function(node){return!!node&&node.nodeType===type}},isElement$1=isNodeType(1),matchNodeNames=function(names){var items=names.toLowerCase().split(" ");return function(node){var i,name;if(node&&node.nodeType)for(name=node.nodeName.toLowerCase(),i=0;i<items.length;i++)if(name===items[i])return!0;return!1}},matchStyleValues=function(name,values){var items=values.toLowerCase().split(" ");return function(node){var i,cssValue;if(isElement$1(node))for(i=0;i<items.length;i++){var computed=node.ownerDocument.defaultView.getComputedStyle(node,null);if(cssValue=computed?computed.getPropertyValue(name):null,cssValue===items[i])return!0}return!1}},hasPropValue=function(propName,propValue){return function(node){return isElement$1(node)&&node[propName]===propValue}},hasAttribute=function(attrName,attrValue){return function(node){return isElement$1(node)&&node.hasAttribute(attrName)}},hasAttributeValue=function(attrName,attrValue){return function(node){return isElement$1(node)&&node.getAttribute(attrName)===attrValue}},isBogus=function(node){return isElement$1(node)&&node.hasAttribute("data-mce-bogus")},isBogusAll=function(node){return isElement$1(node)&&"all"===node.getAttribute("data-mce-bogus")},isTable=function(node){return isElement$1(node)&&"TABLE"===node.tagName},hasContentEditableState=function(value){return function(node){if(isElement$1(node)){if(node.contentEditable===value)return!0;if(node.getAttribute("data-mce-contenteditable")===value)return!0}return!1}},isText$1=isNodeType(3),isComment$1=isNodeType(8),isDocument$1=isNodeType(9),isBr$1=matchNodeNames("br"),isContentEditableTrue=hasContentEditableState("true"),isContentEditableFalse=hasContentEditableState("false"),$_5oonaz1qjh8lywhz={isText:isText$1,isElement:isElement$1,isComment:isComment$1,isDocument:isDocument$1,isBr:isBr$1,isContentEditableTrue:isContentEditableTrue,isContentEditableFalse:isContentEditableFalse,matchNodeNames:matchNodeNames,hasPropValue:hasPropValue,hasAttribute:hasAttribute,hasAttributeValue:hasAttributeValue,matchStyleValues:matchStyleValues,isBogus:isBogus,isBogusAll:isBogusAll,isTable:isTable},surroundedBySpans=function(node){var previousIsSpan=node.previousSibling&&"SPAN"===node.previousSibling.nodeName,nextIsSpan=node.nextSibling&&"SPAN"===node.nextSibling.nodeName;return previousIsSpan&&nextIsSpan},isBookmarkNode=function(node){return node&&"SPAN"===node.tagName&&"bookmark"===node.getAttribute("data-mce-type")},trimNode=function(dom,node){var i,children=node.childNodes;if(!$_5oonaz1qjh8lywhz.isElement(node)||!isBookmarkNode(node)){for(i=children.length-1;i>=0;i--)trimNode(dom,children[i]);if($_5oonaz1qjh8lywhz.isDocument(node)===!1){if($_5oonaz1qjh8lywhz.isText(node)&&node.nodeValue.length>0){var trimmedLength=$_ahowuxkjh8lywbj.trim(node.nodeValue).length;if(dom.isBlock(node.parentNode)||trimmedLength>0)return;if(0===trimmedLength&&surroundedBySpans(node))return}else if($_5oonaz1qjh8lywhz.isElement(node)&&(children=node.childNodes,1===children.length&&isBookmarkNode(children[0])&&node.parentNode.insertBefore(children[0],node),children.length||isVoid($_cgttw3zjh8lywdq.fromDom(node))))return;dom.remove(node)}return node}},$_cm6fub1ojh8lywhl={trimNode:trimNode},makeMap$1=$_ahowuxkjh8lywbj.makeMap,attrsCharsRegExp=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,textCharsRegExp=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rawCharsRegExp=/[<>&\"\']/g,entityRegExp=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,asciiMap={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"};baseEntities={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},reverseEntities={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};var nativeDecode=function(text){var elm;return elm=$_cgttw3zjh8lywdq.fromTag("div").dom(),elm.innerHTML=text,elm.textContent||elm.innerText||text},buildEntitiesLookup=function(items,radix){var i,chr,entity,lookup={};if(items){for(items=items.split(","),radix=radix||10,i=0;i<items.length;i+=2)chr=String.fromCharCode(parseInt(items[i],radix)),baseEntities[chr]||(entity="&"+items[i+1]+";",lookup[chr]=entity,lookup[entity]=chr);return lookup}};namedEntities=buildEntitiesLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var encodeRaw=function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeAllRaw=function(text){return(""+text).replace(rawCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeNumeric=function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return chr.length>1?"&#"+(1024*(chr.charCodeAt(0)-55296)+(chr.charCodeAt(1)-56320)+65536)+";":baseEntities[chr]||"&#"+chr.charCodeAt(0)+";"})},encodeNamed=function(text,attr,entities){return entities=entities||namedEntities,text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||chr})},getEncodeFunc=function(name,entities){var entitiesMap=buildEntitiesLookup(entities)||namedEntities,encodeNamedAndNumeric=function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return void 0!==baseEntities[chr]?baseEntities[chr]:void 0!==entitiesMap[chr]?entitiesMap[chr]:chr.length>1?"&#"+(1024*(chr.charCodeAt(0)-55296)+(chr.charCodeAt(1)-56320)+65536)+";":"&#"+chr.charCodeAt(0)+";"})},encodeCustomNamed=function(text,attr){return encodeNamed(text,attr,entitiesMap)},nameMap=makeMap$1(name.replace(/\+/g,","));return nameMap.named&&nameMap.numeric?encodeNamedAndNumeric:nameMap.named?entities?encodeCustomNamed:encodeNamed:nameMap.numeric?encodeNumeric:encodeRaw},decode=function(text){return text.replace(entityRegExp,function(all,numeric){return numeric?(numeric="x"===numeric.charAt(0).toLowerCase()?parseInt(numeric.substr(1),16):parseInt(numeric,10),numeric>65535?(numeric-=65536,String.fromCharCode(55296+(numeric>>10),56320+(1023&numeric))):asciiMap[numeric]||String.fromCharCode(numeric)):reverseEntities[all]||namedEntities[all]||nativeDecode(all)})},$_gex7a11rjh8lywi4={encodeRaw:encodeRaw,encodeAllRaw:encodeAllRaw,encodeNumeric:encodeNumeric,encodeNamed:encodeNamed,getEncodeFunc:getEncodeFunc,decode:decode},mapCache={},dummyObj={},makeMap$2=$_ahowuxkjh8lywbj.makeMap,each$4=$_ahowuxkjh8lywbj.each,extend$1=$_ahowuxkjh8lywbj.extend,explode$1=$_ahowuxkjh8lywbj.explode,inArray$1=$_ahowuxkjh8lywbj.inArray,split=function(items,delim){return items=$_ahowuxkjh8lywbj.trim(items),items?items.split(delim||" "):[]},compileSchema=function(type){var globalAttributes,blockContent,phrasingContent,flowContent,html4BlockContent,html4PhrasingContent,schema={},add=function(name,attributes,children){var ni,attributesOrder,element,arrayToMap=function(array,obj){var i,l,map={};for(i=0,l=array.length;i<l;i++)map[array[i]]=obj||{};return map};for(children=children||[],attributes=attributes||"","string"==typeof children&&(children=split(children)),name=split(name),ni=name.length;ni--;)attributesOrder=split([globalAttributes,attributes].join(" ")),element={attributes:arrayToMap(attributesOrder),attributesOrder:attributesOrder,children:arrayToMap(children,dummyObj)},schema[name[ni]]=element},addAttrs=function(name,attributes){var ni,schemaItem,i,l;for(name=split(name),ni=name.length,attributes=split(attributes);ni--;)for(schemaItem=schema[name[ni]],i=0,l=attributes.length;i<l;i++)schemaItem.attributes[attributes[i]]={},schemaItem.attributesOrder.push(attributes[i])};return mapCache[type]?mapCache[type]:(globalAttributes="id accesskey class dir lang style tabindex title role",blockContent="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",phrasingContent="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==type&&(globalAttributes+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",blockContent+=" article aside details dialog figure header footer hgroup section nav",phrasingContent+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==type&&(globalAttributes+=" xml:lang",html4PhrasingContent="acronym applet basefont big font strike tt",phrasingContent=[phrasingContent,html4PhrasingContent].join(" "),each$4(split(html4PhrasingContent),function(name){add(name,"",phrasingContent)}),html4BlockContent="center dir isindex noframes",blockContent=[blockContent,html4BlockContent].join(" "),flowContent=[blockContent,phrasingContent].join(" "),each$4(split(html4BlockContent),function(name){add(name,"",flowContent)})),flowContent=flowContent||[blockContent,phrasingContent].join(" "),add("html","manifest","head body"),add("head","","base command link meta noscript script style title"),add("title hr noscript br"),add("base","href target"),add("link","href rel media hreflang type sizes hreflang"),add("meta","name http-equiv content charset"),add("style","media type scoped"),add("script","src async defer type charset"),add("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",flowContent),add("address dt dd div caption","",flowContent),add("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",phrasingContent),add("blockquote","cite",flowContent),add("ol","reversed start type","li"),add("ul","","li"),add("li","value",flowContent),add("dl","","dt dd"),add("a","href target rel media hreflang type",phrasingContent),add("q","cite",phrasingContent),add("ins del","cite datetime",flowContent),add("img","src sizes srcset alt usemap ismap width height"),add("iframe","src name width height",flowContent),add("embed","src type width height"),add("object","data type typemustmatch name usemap form width height",[flowContent,"param"].join(" ")),add("param","name value"),add("map","name",[flowContent,"area"].join(" ")),add("area","alt coords shape href target rel media hreflang type"),add("table","border","caption colgroup thead tfoot tbody tr"+("html4"===type?" col":"")),add("colgroup","span","col"),add("col","span"),add("tbody thead tfoot","","tr"),add("tr","","td th"),add("td","colspan rowspan headers",flowContent),add("th","colspan rowspan headers scope abbr",flowContent),add("form","accept-charset action autocomplete enctype method name novalidate target",flowContent),add("fieldset","disabled form name",[flowContent,"legend"].join(" ")),add("label","form for",phrasingContent),add("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),add("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===type?flowContent:phrasingContent),add("select","disabled form multiple name required size","option optgroup"),add("optgroup","disabled label","option"),add("option","disabled label selected value"),add("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),add("menu","type label",[flowContent,"li"].join(" ")),add("noscript","",flowContent),"html4"!==type&&(add("wbr"),add("ruby","",[phrasingContent,"rt rp"].join(" ")),add("figcaption","",flowContent),add("mark rt rp summary bdi","",phrasingContent),add("canvas","width height",flowContent),add("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[flowContent,"track source"].join(" ")),add("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[flowContent,"track source"].join(" ")),add("picture","","img source"),add("source","src srcset type media sizes"),add("track","kind src srclang label default"),add("datalist","",[phrasingContent,"option"].join(" ")),add("article section nav aside header footer","",flowContent),add("hgroup","","h1 h2 h3 h4 h5 h6"),add("figure","",[flowContent,"figcaption"].join(" ")),add("time","datetime",phrasingContent),add("dialog","open",flowContent),add("command","type label icon disabled checked radiogroup command"),add("output","for form name",phrasingContent),add("progress","value max",phrasingContent),add("meter","value min max low high optimum",phrasingContent),add("details","open",[flowContent,"summary"].join(" ")),add("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==type&&(addAttrs("script","language xml:space"),addAttrs("style","xml:space"),addAttrs("object","declare classid code codebase codetype archive standby align border hspace vspace"),addAttrs("embed","align name hspace vspace"),addAttrs("param","valuetype type"),addAttrs("a","charset name rev shape coords"),addAttrs("br","clear"),addAttrs("applet","codebase archive code object alt name width height align hspace vspace"),addAttrs("img","name longdesc align border hspace vspace"),addAttrs("iframe","longdesc frameborder marginwidth marginheight scrolling align"),addAttrs("font basefont","size color face"),addAttrs("input","usemap align"),addAttrs("select","onchange"),addAttrs("textarea"),addAttrs("h1 h2 h3 h4 h5 h6 div p legend caption","align"),addAttrs("ul","type compact"),addAttrs("li","type"),addAttrs("ol dl menu dir","compact"),addAttrs("pre","width xml:space"),addAttrs("hr","align noshade size width"),addAttrs("isindex","prompt"),addAttrs("table","summary width frame rules cellspacing cellpadding align bgcolor"),addAttrs("col","width align char charoff valign"),addAttrs("colgroup","width align char charoff valign"),addAttrs("thead","align char charoff valign"),addAttrs("tr","align char charoff valign bgcolor"),addAttrs("th","axis align char charoff valign nowrap bgcolor width height"),addAttrs("form","accept"),addAttrs("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),addAttrs("tfoot","align char charoff valign"),addAttrs("tbody","align char charoff valign"),addAttrs("area","nohref"),addAttrs("body","background bgcolor text link vlink alink")),"html4"!==type&&(addAttrs("input button select textarea","autofocus"),addAttrs("input textarea","placeholder"),addAttrs("a","download"),addAttrs("link script img","crossorigin"),addAttrs("iframe","sandbox seamless allowfullscreen")),each$4(split("a form meter progress dfn"),function(name){schema[name]&&delete schema[name].children[name]}),delete schema.caption.children.table,delete schema.script,mapCache[type]=schema,schema)},compileElementMap=function(value,mode){var styles;return value&&(styles={},"string"==typeof value&&(value={"*":value}),each$4(value,function(value,key){styles[key]=styles[key.toUpperCase()]="map"===mode?makeMap$2(value,/[, ]/):explode$1(value,/[, ]/)})),styles},toHex=function(match,r,g,b){var hex=function(val){return val=parseInt(val,10).toString(16),val.length>1?val:"0"+val};return"#"+hex(r)+hex(g)+hex(b)},each$5=$_ahowuxkjh8lywbj.each,grep$1=$_ahowuxkjh8lywbj.grep,isIE=$_9bpim8ajh8lyw68.ie,simpleSelectorRe=/^([a-z0-9],?)+$/i,whiteSpaceRegExp$2=/^[ \t\r\n]*$/,setupAttrHooks=function(styles,settings,getContext){var attrHooks={},keepValues=settings.keep_values,keepUrlHook={set:function($elm,value,name){settings.url_converter&&(value=settings.url_converter.call(settings.url_converter_scope||getContext(),value,name,$elm[0])),$elm.attr("data-mce-"+name,value).attr(name,value)},get:function($elm,name){return $elm.attr("data-mce-"+name)||$elm.attr(name)}};return attrHooks={style:{set:function($elm,value){return null!==value&&"object"==typeof value?void $elm.css(value):(keepValues&&$elm.attr("data-mce-style",value),void $elm.attr("style",value))},get:function($elm){var value=$elm.attr("data-mce-style")||$elm.attr("style");return value=styles.serialize(styles.parse(value),$elm[0].nodeName)}}},keepValues&&(attrHooks.href=attrHooks.src=keepUrlHook),attrHooks},updateInternalStyleAttr=function(styles,$elm){var rawValue=$elm.attr("style"),value=styles.serialize(styles.parse(rawValue),$elm[0].nodeName);value||(value=null),$elm.attr("data-mce-style",value)},findNodeIndex=function(node,normalized){var lastNodeType,nodeType,idx=0;if(node)for(lastNodeType=node.nodeType,node=node.previousSibling;node;node=node.previousSibling)nodeType=node.nodeType,(!normalized||3!==nodeType||nodeType!==lastNodeType&&node.nodeValue.length)&&(idx++,lastNodeType=nodeType);return idx};!function(DOMUtils){DOMUtils.DOM=DOMUtils(document),DOMUtils.nodeIndex=findNodeIndex}(DOMUtils||(DOMUtils={}));var DOMUtils$1=DOMUtils,DOM=DOMUtils$1.DOM,each$6=$_ahowuxkjh8lywbj.each,grep$2=$_ahowuxkjh8lywbj.grep,isFunction=function(f){return"function"==typeof f},ScriptLoader=function(){var QUEUED=0,LOADING=1,LOADED=2,FAILED=3,states={},queue=[],scriptLoadedCallbacks={},queueLoadedCallbacks=[],loading=0,loadScript=function(url,success,failure){var elm,id,dom=DOM,done=function(){dom.remove(id),elm&&(elm.onreadystatechange=elm.onload=elm=null),success()},error=function(){isFunction(failure)?failure():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+url)};id=dom.uniqueId(),elm=document.createElement("script"),elm.id=id,elm.type="text/javascript",elm.src=$_ahowuxkjh8lywbj._addCacheSuffix(url),"onreadystatechange"in elm?elm.onreadystatechange=function(){/loaded|complete/.test(elm.readyState)&&done()}:elm.onload=done,elm.onerror=error,(document.getElementsByTagName("head")[0]||document.body).appendChild(elm)};this.isDone=function(url){return states[url]===LOADED},this.markDone=function(url){states[url]=LOADED},this.add=this.load=function(url,success,scope,failure){var state=states[url];void 0===state&&(queue.push(url),states[url]=QUEUED),success&&(scriptLoadedCallbacks[url]||(scriptLoadedCallbacks[url]=[]),scriptLoadedCallbacks[url].push({success:success,failure:failure,scope:scope||this}))},this.remove=function(url){delete states[url],delete scriptLoadedCallbacks[url]},this.loadQueue=function(success,scope,failure){this.loadScripts(queue,success,scope,failure)},this.loadScripts=function(scripts,success,scope,failure){var loadScripts,failures=[],execCallbacks=function(name,url){each$6(scriptLoadedCallbacks[url],function(callback){isFunction(callback[name])&&callback[name].call(callback.scope)}),scriptLoadedCallbacks[url]=void 0};queueLoadedCallbacks.push({success:success,failure:failure,scope:scope||this}),(loadScripts=function(){var loadingScripts=grep$2(scripts);if(scripts.length=0,each$6(loadingScripts,function(url){return states[url]===LOADED?void execCallbacks("success",url):states[url]===FAILED?void execCallbacks("failure",url):void(states[url]!==LOADING&&(states[url]=LOADING,loading++,loadScript(url,function(){states[url]=LOADED,loading--,execCallbacks("success",url),loadScripts()},function(){states[url]=FAILED,loading--,failures.push(url),execCallbacks("failure",url),loadScripts()})))}),!loading){var notifyCallbacks=queueLoadedCallbacks.slice(0);queueLoadedCallbacks.length=0,each$6(notifyCallbacks,function(callback){0===failures.length?isFunction(callback.success)&&callback.success.call(callback.scope):isFunction(callback.failure)&&callback.failure.call(callback.scope,failures)})}})()}};ScriptLoader.ScriptLoader=new ScriptLoader;var each$7=$_ahowuxkjh8lywbj.each;!function(AddOnManager){AddOnManager.PluginManager=AddOnManager(),AddOnManager.ThemeManager=AddOnManager()}(AddOnManager||(AddOnManager={}));var ZWSP="\ufeff",isZwsp=function(chr){return chr===ZWSP},trim$3=function(text){return text.replace(new RegExp(ZWSP,"g"),"")},$_d383mr21jh8lywlv={isZwsp:isZwsp,ZWSP:ZWSP,trim:trim$3},isElement$2=$_5oonaz1qjh8lywhz.isElement,isText$2=$_5oonaz1qjh8lywhz.isText,isCaretContainerBlock=function(node){return isText$2(node)&&(node=node.parentNode),isElement$2(node)&&node.hasAttribute("data-mce-caret")},isCaretContainerInline=function(node){return isText$2(node)&&$_d383mr21jh8lywlv.isZwsp(node.data)},isCaretContainer=function(node){return isCaretContainerBlock(node)||isCaretContainerInline(node)},hasContent=function(node){return node.firstChild!==node.lastChild||!$_5oonaz1qjh8lywhz.isBr(node.firstChild)},insertInline=function(node,before){var doc,sibling,textNode,parentNode;if(doc=node.ownerDocument,textNode=doc.createTextNode($_d383mr21jh8lywlv.ZWSP),parentNode=node.parentNode,before){if(sibling=node.previousSibling,isText$2(sibling)){if(isCaretContainer(sibling))return sibling;if(endsWithCaretContainer(sibling))return sibling.splitText(sibling.data.length-1)}parentNode.insertBefore(textNode,node)}else{if(sibling=node.nextSibling,isText$2(sibling)){if(isCaretContainer(sibling))return sibling;if(startsWithCaretContainer(sibling))return sibling.splitText(1),sibling}node.nextSibling?parentNode.insertBefore(textNode,node.nextSibling):parentNode.appendChild(textNode)}return textNode},isBeforeInline=function(pos){var container=pos.container();return pos&&$_5oonaz1qjh8lywhz.isText(container)&&container.data.charAt(pos.offset())===$_d383mr21jh8lywlv.ZWSP},isAfterInline=function(pos){var container=pos.container();return pos&&$_5oonaz1qjh8lywhz.isText(container)&&container.data.charAt(pos.offset()-1)===$_d383mr21jh8lywlv.ZWSP},createBogusBr=function(){var br=document.createElement("br");return br.setAttribute("data-mce-bogus","1"),br},insertBlock=function(blockName,node,before){var doc,blockNode,parentNode;return doc=node.ownerDocument,blockNode=doc.createElement(blockName),blockNode.setAttribute("data-mce-caret",before?"before":"after"),blockNode.setAttribute("data-mce-bogus","all"),blockNode.appendChild(createBogusBr()),parentNode=node.parentNode,before?parentNode.insertBefore(blockNode,node):node.nextSibling?parentNode.insertBefore(blockNode,node.nextSibling):parentNode.appendChild(blockNode),blockNode},startsWithCaretContainer=function(node){return isText$2(node)&&node.data[0]===$_d383mr21jh8lywlv.ZWSP},endsWithCaretContainer=function(node){return isText$2(node)&&node.data[node.data.length-1]===$_d383mr21jh8lywlv.ZWSP},trimBogusBr=function(elm){var brs=elm.getElementsByTagName("br"),lastBr=brs[brs.length-1];$_5oonaz1qjh8lywhz.isBogus(lastBr)&&lastBr.parentNode.removeChild(lastBr)},showCaretContainerBlock=function(caretContainer){return caretContainer&&caretContainer.hasAttribute("data-mce-caret")?(trimBogusBr(caretContainer),caretContainer.removeAttribute("data-mce-caret"),caretContainer.removeAttribute("data-mce-bogus"),caretContainer.removeAttribute("style"),caretContainer.removeAttribute("_moz_abspos"),caretContainer):null},isRangeInCaretContainerBlock=function(range){return isCaretContainerBlock(range.startContainer)},isContentEditableTrue$1=$_5oonaz1qjh8lywhz.isContentEditableTrue,isContentEditableFalse$1=$_5oonaz1qjh8lywhz.isContentEditableFalse,isBr$2=$_5oonaz1qjh8lywhz.isBr,isText$3=$_5oonaz1qjh8lywhz.isText,isInvalidTextElement=$_5oonaz1qjh8lywhz.matchNodeNames("script style textarea"),isAtomicInline=$_5oonaz1qjh8lywhz.matchNodeNames("img input textarea hr iframe video audio object"),isTable$1=$_5oonaz1qjh8lywhz.matchNodeNames("table"),isCaretContainer$1=isCaretContainer,isCaretCandidate=function(node){return!isCaretContainer$1(node)&&(isText$3(node)?!isInvalidTextElement(node.parentNode):isAtomicInline(node)||isBr$2(node)||isTable$1(node)||isNonUiContentEditableFalse(node))},isUnselectable=function(node){return $_5oonaz1qjh8lywhz.isElement(node)&&"true"===node.getAttribute("unselectable")},isNonUiContentEditableFalse=function(node){return isUnselectable(node)===!1&&isContentEditableFalse$1(node)},isInEditable=function(node,root){for(node=node.parentNode;node&&node!==root;node=node.parentNode){if(isNonUiContentEditableFalse(node))return!1;if(isContentEditableTrue$1(node))return!0}return!0},isAtomicContentEditableFalse=function(node){return!!isNonUiContentEditableFalse(node)&&$_9tjm51ljh8lywbq.reduce(node.getElementsByTagName("*"),function(result,elm){return result||isContentEditableTrue$1(elm)},!1)!==!0},isAtomic=function(node){return isAtomicInline(node)||isAtomicContentEditableFalse(node)},isEditableCaretCandidate=function(node,root){return isCaretCandidate(node)&&isInEditable(node,root)},round=Math.round,clone$1=function(rect){return rect?{left:round(rect.left),top:round(rect.top),bottom:round(rect.bottom),right:round(rect.right),width:round(rect.width),height:round(rect.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},collapse=function(rect,toStart){return rect=clone$1(rect),toStart?rect.right=rect.left:(rect.left=rect.left+rect.width,
rect.right=rect.left),rect.width=0,rect},isEqual=function(rect1,rect2){return rect1.left===rect2.left&&rect1.top===rect2.top&&rect1.bottom===rect2.bottom&&rect1.right===rect2.right},isValidOverflow=function(overflowY,rect1,rect2){return overflowY>=0&&overflowY<=Math.min(rect1.height,rect2.height)/2},isAbove=function(rect1,rect2){return rect1.bottom-rect1.height/2<rect2.top||!(rect1.top>rect2.bottom)&&isValidOverflow(rect2.top-rect1.bottom,rect1,rect2)},isBelow=function(rect1,rect2){return rect1.top>rect2.bottom||!(rect1.bottom<rect2.top)&&isValidOverflow(rect2.bottom-rect1.top,rect1,rect2)},containsXY=function(rect,clientX,clientY){return clientX>=rect.left&&clientX<=rect.right&&clientY>=rect.top&&clientY<=rect.bottom},overflowX=function(outer,inner){return inner.left>outer.left&&inner.right<outer.right?0:inner.left<outer.left?inner.left-outer.left:inner.right-outer.right},overflowY=function(outer,inner){return inner.top>outer.top&&inner.bottom<outer.bottom?0:inner.top<outer.top?inner.top-outer.top:inner.bottom-outer.bottom},getOverflow=function(outer,inner){return{x:overflowX(outer,inner),y:overflowY(outer,inner)}},getSelectedNode=function(range){var startContainer=range.startContainer,startOffset=range.startOffset;return startContainer.hasChildNodes()&&range.endOffset===startOffset+1?startContainer.childNodes[startOffset]:null},getNode=function(container,offset){return 1===container.nodeType&&container.hasChildNodes()&&(offset>=container.childNodes.length&&(offset=container.childNodes.length-1),container=container.childNodes[offset]),container},extendingChars=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),isExtendingChar=function(ch){return"string"==typeof ch&&ch.charCodeAt(0)>=768&&extendingChars.test(ch)},slice$3=[].slice,constant$1=function(value){return function(){return value}},negate=function(predicate){return function(x){return!predicate(x)}},compose$2=function(f,g){return function(x){return f(g(x))}},or=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];var args=slice$3.call(arguments);return function(x){for(var i=0;i<args.length;i++)if(args[i](x))return!0;return!1}},and=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];var args=slice$3.call(arguments);return function(x){for(var i=0;i<args.length;i++)if(!args[i](x))return!1;return!0}},curry$1=function(fn){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];var args=slice$3.call(arguments);return args.length-1>=fn.length?fn.apply(this,args.slice(1)):function(){var tempArgs=args.concat([].slice.call(arguments));return curry$1.apply(this,tempArgs)}},noop$1=function(){},$_8aqzj925jh8lywmj={constant:constant$1,negate:negate,and:and,or:or,curry:curry$1,compose:compose$2,noop:noop$1},cat=function(arr){for(var r=[],push=function(x){r.push(x)},i=0;i<arr.length;i++)arr[i].each(push);return r},findMap=function(arr,f){for(var i=0;i<arr.length;i++){var r=f(arr[i],i);if(r.isSome())return r}return Option.none()},liftN=function(arr,f){for(var r=[],i=0;i<arr.length;i++){var x=arr[i];if(!x.isSome())return Option.none();r.push(x.getOrDie())}return Option.some(f.apply(null,r))},$_b8twwq26jh8lywmm={cat:cat,findMap:findMap,liftN:liftN},isElement$3=$_5oonaz1qjh8lywhz.isElement,isCaretCandidate$1=isCaretCandidate,isBlock$1=$_5oonaz1qjh8lywhz.matchStyleValues("display","block table"),isFloated=$_5oonaz1qjh8lywhz.matchStyleValues("float","left right"),isValidElementCaretCandidate=$_8aqzj925jh8lywmj.and(isElement$3,isCaretCandidate$1,$_8aqzj925jh8lywmj.negate(isFloated)),isNotPre=$_8aqzj925jh8lywmj.negate($_5oonaz1qjh8lywhz.matchStyleValues("white-space","pre pre-line pre-wrap")),isText$4=$_5oonaz1qjh8lywhz.isText,isBr$3=$_5oonaz1qjh8lywhz.isBr,nodeIndex=DOMUtils$1.nodeIndex,resolveIndex=getNode,createRange=function(doc){return"createRange"in doc?doc.createRange():DOMUtils$1.DOM.createRng()},isWhiteSpace=function(chr){return chr&&/[\r\n\t ]/.test(chr)},isRange=function(rng){return!!rng.setStart&&!!rng.setEnd},isHiddenWhiteSpaceRange=function(range){var text,container=range.startContainer,offset=range.startOffset;return!!(isWhiteSpace(range.toString())&&isNotPre(container.parentNode)&&$_5oonaz1qjh8lywhz.isText(container)&&(text=container.data,isWhiteSpace(text[offset-1])||isWhiteSpace(text[offset+1])))},getBrClientRect=function(brNode){var clientRect,doc=brNode.ownerDocument,rng=createRange(doc),nbsp=doc.createTextNode(" "),parentNode=brNode.parentNode;return parentNode.insertBefore(nbsp,brNode),rng.setStart(nbsp,0),rng.setEnd(nbsp,1),clientRect=clone$1(rng.getBoundingClientRect()),parentNode.removeChild(nbsp),clientRect},getBoundingClientRectWebKitText=function(rng){var sc=rng.startContainer,ec=rng.endContainer,so=rng.startOffset,eo=rng.endOffset;if(sc===ec&&$_5oonaz1qjh8lywhz.isText(ec)&&0===so&&1===eo){var newRng=rng.cloneRange();return newRng.setEndAfter(ec),getBoundingClientRect(newRng)}return null},isZeroRect=function(r){return 0===r.left&&0===r.right&&0===r.top&&0===r.bottom},getBoundingClientRect=function(item){var clientRect,clientRects;return clientRects=item.getClientRects(),clientRect=clone$1(clientRects.length>0?clientRects[0]:item.getBoundingClientRect()),!isRange(item)&&isBr$3(item)&&isZeroRect(clientRect)?getBrClientRect(item):isZeroRect(clientRect)&&isRange(item)?getBoundingClientRectWebKitText(item):clientRect},collapseAndInflateWidth=function(clientRect,toStart){var newClientRect=collapse(clientRect,toStart);return newClientRect.width=1,newClientRect.right=newClientRect.left+1,newClientRect},getCaretPositionClientRects=function(caretPosition){var beforeNode,node,clientRects=[],addUniqueAndValidRect=function(clientRect){0!==clientRect.height&&(clientRects.length>0&&isEqual(clientRect,clientRects[clientRects.length-1])||clientRects.push(clientRect))},addCharacterOffset=function(container,offset){var range=createRange(container.ownerDocument);if(offset<container.data.length){if(isExtendingChar(container.data[offset]))return clientRects;if(isExtendingChar(container.data[offset-1])&&(range.setStart(container,offset),range.setEnd(container,offset+1),!isHiddenWhiteSpaceRange(range)))return addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),!1)),clientRects}offset>0&&(range.setStart(container,offset-1),range.setEnd(container,offset),isHiddenWhiteSpaceRange(range)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),!1))),offset<container.data.length&&(range.setStart(container,offset),range.setEnd(container,offset+1),isHiddenWhiteSpaceRange(range)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),!0)))};if(isText$4(caretPosition.container()))return addCharacterOffset(caretPosition.container(),caretPosition.offset()),clientRects;if(isElement$3(caretPosition.container()))if(caretPosition.isAtEnd())node=resolveIndex(caretPosition.container(),caretPosition.offset()),isText$4(node)&&addCharacterOffset(node,node.data.length),isValidElementCaretCandidate(node)&&!isBr$3(node)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!1));else{if(node=resolveIndex(caretPosition.container(),caretPosition.offset()),isText$4(node)&&addCharacterOffset(node,0),isValidElementCaretCandidate(node)&&caretPosition.isAtEnd())return addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!1)),clientRects;beforeNode=resolveIndex(caretPosition.container(),caretPosition.offset()-1),isValidElementCaretCandidate(beforeNode)&&!isBr$3(beforeNode)&&(isBlock$1(beforeNode)||isBlock$1(node)||!isValidElementCaretCandidate(node))&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode),!1)),isValidElementCaretCandidate(node)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!0))}return clientRects};!function(CaretPosition){CaretPosition.fromRangeStart=function(range){return CaretPosition(range.startContainer,range.startOffset)},CaretPosition.fromRangeEnd=function(range){return CaretPosition(range.endContainer,range.endOffset)},CaretPosition.after=function(node){return CaretPosition(node.parentNode,nodeIndex(node)+1)},CaretPosition.before=function(node){return CaretPosition(node.parentNode,nodeIndex(node))},CaretPosition.isAbove=function(pos1,pos2){return $_b8twwq26jh8lywmm.liftN([$_5wjzy24jh8lyw2t.head(pos2.getClientRects()),$_5wjzy24jh8lyw2t.last(pos1.getClientRects())],isAbove).getOr(!1)},CaretPosition.isBelow=function(pos1,pos2){return $_b8twwq26jh8lywmm.liftN([$_5wjzy24jh8lyw2t.last(pos2.getClientRects()),$_5wjzy24jh8lyw2t.head(pos1.getClientRects())],isBelow).getOr(!1)},CaretPosition.isAtStart=function(pos){return!!pos&&pos.isAtStart()},CaretPosition.isAtEnd=function(pos){return!!pos&&pos.isAtEnd()},CaretPosition.isTextPosition=function(pos){return!!pos&&$_5oonaz1qjh8lywhz.isText(pos.container())},CaretPosition.isElementPosition=function(pos){return CaretPosition.isTextPosition(pos)===!1}}(CaretPosition||(CaretPosition={}));var BreakType,CaretPosition$1=CaretPosition,isElement$4=$_5oonaz1qjh8lywhz.isElement,isText$5=$_5oonaz1qjh8lywhz.isText,removeNode=function(node){var parentNode=node.parentNode;parentNode&&parentNode.removeChild(node)},getNodeValue=function(node){try{return node.nodeValue}catch(ex){return""}},setNodeValue=function(node,text){0===text.length?removeNode(node):node.nodeValue=text},trimCount=function(text){var trimmedText=$_d383mr21jh8lywlv.trim(text);return{count:text.length-trimmedText.length,text:trimmedText}},removeUnchanged=function(caretContainer,pos){return remove$2(caretContainer),pos},removeTextAndReposition=function(caretContainer,pos){var before=trimCount(caretContainer.data.substr(0,pos.offset())),after=trimCount(caretContainer.data.substr(pos.offset())),text=before.text+after.text;return text.length>0?(setNodeValue(caretContainer,text),CaretPosition$1(caretContainer,pos.offset()-before.count)):pos},removeElementAndReposition=function(caretContainer,pos){var parentNode=pos.container(),newPosition=$_5wjzy24jh8lyw2t.indexOf($_5wjzy24jh8lyw2t.from(parentNode.childNodes),caretContainer).map(function(index){return index<pos.offset()?CaretPosition$1(parentNode,pos.offset()-1):pos}).getOr(pos);return remove$2(caretContainer),newPosition},removeTextCaretContainer=function(caretContainer,pos){return isText$5(caretContainer)&&pos.container()===caretContainer?removeTextAndReposition(caretContainer,pos):removeUnchanged(caretContainer,pos)},removeElementCaretContainer=function(caretContainer,pos){return pos.container()===caretContainer.parentNode?removeElementAndReposition(caretContainer,pos):removeUnchanged(caretContainer,pos)},removeAndReposition=function(container,pos){return CaretPosition$1.isTextPosition(pos)?removeTextCaretContainer(container,pos):removeElementCaretContainer(container,pos)},remove$2=function(caretContainerNode){if(isElement$4(caretContainerNode)&&isCaretContainer(caretContainerNode)&&(hasContent(caretContainerNode)?caretContainerNode.removeAttribute("data-mce-caret"):removeNode(caretContainerNode)),isText$5(caretContainerNode)){var text=$_d383mr21jh8lywlv.trim(getNodeValue(caretContainerNode));setNodeValue(caretContainerNode,text)}},$_9nl16f2ajh8lywne={removeAndReposition:removeAndReposition,remove:remove$2},walkToPositionIn=function(forward,root,start){var position=forward?CaretPosition$1.before(start):CaretPosition$1.after(start);return fromPosition(forward,root,position)},afterElement=function(node){return $_5oonaz1qjh8lywhz.isBr(node)?CaretPosition$1.before(node):CaretPosition$1.after(node)},isBeforeOrStart=function(position){return CaretPosition$1.isTextPosition(position)?0===position.offset():isCaretCandidate(position.getNode())},isAfterOrEnd=function(position){if(CaretPosition$1.isTextPosition(position)){var container=position.container();return position.offset()===container.data.length}return isCaretCandidate(position.getNode(!0))},isBeforeAfterSameElement=function(from,to){return!CaretPosition$1.isTextPosition(from)&&!CaretPosition$1.isTextPosition(to)&&from.getNode()===to.getNode(!0)},isAtBr=function(position){return!CaretPosition$1.isTextPosition(position)&&$_5oonaz1qjh8lywhz.isBr(position.getNode())},shouldSkipPosition=function(forward,from,to){return forward?!isBeforeAfterSameElement(from,to)&&!isAtBr(from)&&isAfterOrEnd(from)&&isBeforeOrStart(to):!isBeforeAfterSameElement(to,from)&&isBeforeOrStart(from)&&isAfterOrEnd(to)},fromPosition=function(forward,root,pos){var walker=CaretWalker(root);return Option.from(forward?walker.next(pos):walker.prev(pos))},navigate=function(forward,root,from){return fromPosition(forward,root,from).bind(function(to){return isInSameBlock(from,to,root)&&shouldSkipPosition(forward,from,to)?fromPosition(forward,root,to):Option.some(to)})},positionIn=function(forward,element){var startNode=forward?element.firstChild:element.lastChild;return $_5oonaz1qjh8lywhz.isText(startNode)?Option.some(CaretPosition$1(startNode,forward?0:startNode.data.length)):startNode?isCaretCandidate(startNode)?Option.some(forward?CaretPosition$1.before(startNode):afterElement(startNode)):walkToPositionIn(forward,element,startNode):Option.none()},$_9kvypj2cjh8lywnz={fromPosition:fromPosition,nextPosition:$_eqpqvr6jh8lyw3s.curry(fromPosition,!0),prevPosition:$_eqpqvr6jh8lyw3s.curry(fromPosition,!1),navigate:navigate,positionIn:positionIn,firstPositionIn:$_eqpqvr6jh8lyw3s.curry(positionIn,!0),lastPositionIn:$_eqpqvr6jh8lyw3s.curry(positionIn,!1)},isContentEditableTrue$2=$_5oonaz1qjh8lywhz.isContentEditableTrue,isContentEditableFalse$2=$_5oonaz1qjh8lywhz.isContentEditableFalse,showCaret=function(direction,editor,node,before,scrollIntoView){return editor._selectionOverrides.showCaret(direction,node,before,scrollIntoView)},getNodeRange=function(node){var rng=node.ownerDocument.createRange();return rng.selectNode(node),rng},selectNode=function(editor,node){var e=editor.fire("BeforeObjectSelected",{target:node});return e.isDefaultPrevented()?null:getNodeRange(node)},renderCaretAtRange=function(editor,range,scrollIntoView){var normalizedRange=normalizeRange(1,editor.getBody(),range),caretPosition=CaretPosition$1.fromRangeStart(normalizedRange),caretPositionNode=caretPosition.getNode();if(isContentEditableFalse$2(caretPositionNode))return showCaret(1,editor,caretPositionNode,!caretPosition.isAtEnd(),!1);var caretPositionBeforeNode=caretPosition.getNode(!0);if(isContentEditableFalse$2(caretPositionBeforeNode))return showCaret(1,editor,caretPositionBeforeNode,!1,!1);var ceRoot=editor.dom.getParent(caretPosition.getNode(),function(node){return isContentEditableFalse$2(node)||isContentEditableTrue$2(node)});return isContentEditableFalse$2(ceRoot)?showCaret(1,editor,ceRoot,!1,scrollIntoView):null},renderRangeCaret=function(editor,range,scrollIntoView){if(!range||!range.collapsed)return range;var caretRange=renderCaretAtRange(editor,range,scrollIntoView);return caretRange?caretRange:range};!function(BreakType){BreakType[BreakType.Br=0]="Br",BreakType[BreakType.Block=1]="Block",BreakType[BreakType.Wrap=2]="Wrap",BreakType[BreakType.Eol=3]="Eol"}(BreakType||(BreakType={}));var HDirection,flip=function(direction,positions){return direction===HDirection.Backwards?positions.reverse():positions},walk$1=function(direction,caretWalker,pos){return direction===HDirection.Forwards?caretWalker.next(pos):caretWalker.prev(pos)},getBreakType=function(scope,direction,currentPos,nextPos){return $_5oonaz1qjh8lywhz.isBr(nextPos.getNode(direction===HDirection.Forwards))?BreakType.Br:isInSameBlock(currentPos,nextPos)===!1?BreakType.Block:BreakType.Wrap},getPositionsUntil=function(predicate,direction,scope,start){for(var nextPos,caretWalker=CaretWalker(scope),currentPos=start,positions=[];currentPos&&(nextPos=walk$1(direction,caretWalker,currentPos));){if($_5oonaz1qjh8lywhz.isBr(nextPos.getNode(!1)))return direction===HDirection.Forwards?{positions:flip(direction,positions).concat([nextPos]),breakType:BreakType.Br,breakAt:Option.some(nextPos)}:{positions:flip(direction,positions),breakType:BreakType.Br,breakAt:Option.some(nextPos)};if(nextPos.isVisible()){if(predicate(currentPos,nextPos)){var breakType=getBreakType(scope,direction,currentPos,nextPos);return{positions:flip(direction,positions),breakType:breakType,breakAt:Option.some(nextPos)}}positions.push(nextPos),currentPos=nextPos}else currentPos=nextPos}return{positions:flip(direction,positions),breakType:BreakType.Eol,breakAt:Option.none()}},getAdjacentLinePositions=function(direction,getPositionsUntilBreak,scope,start){return getPositionsUntilBreak(scope,start).breakAt.map(function(pos){var positions=getPositionsUntilBreak(scope,pos).positions;return direction===HDirection.Backwards?positions.concat(pos):[pos].concat(positions)}).getOr([])},findClosestHorizontalPositionFromPoint=function(positions,x){return $_5wjzy24jh8lyw2t.foldl(positions,function(acc,newPos){return acc.fold(function(){return Option.some(newPos)},function(lastPos){return $_b8twwq26jh8lywmm.liftN([$_5wjzy24jh8lyw2t.head(lastPos.getClientRects()),$_5wjzy24jh8lyw2t.head(newPos.getClientRects())],function(lastRect,newRect){var lastDist=Math.abs(x-lastRect.left),newDist=Math.abs(x-newRect.left);return newDist<=lastDist?newPos:lastPos}).or(acc)})},Option.none())},findClosestHorizontalPosition=function(positions,pos){return $_5wjzy24jh8lyw2t.head(pos.getClientRects()).bind(function(targetRect){return findClosestHorizontalPositionFromPoint(positions,targetRect.left)})},getPositionsUntilPreviousLine=$_eqpqvr6jh8lyw3s.curry(getPositionsUntil,CaretPosition.isAbove,-1),getPositionsUntilNextLine=$_eqpqvr6jh8lyw3s.curry(getPositionsUntil,CaretPosition.isBelow,1),getPositionsAbove=$_eqpqvr6jh8lyw3s.curry(getAdjacentLinePositions,-1,getPositionsUntilPreviousLine),getPositionsBelow=$_eqpqvr6jh8lyw3s.curry(getAdjacentLinePositions,1,getPositionsUntilNextLine),getFirstLinePositions=function(scope){return $_9kvypj2cjh8lywnz.firstPositionIn(scope).map(function(pos){return[pos].concat(getPositionsUntilNextLine(scope,pos).positions)}).getOr([])},getLastLinePositions=function(scope){return $_9kvypj2cjh8lywnz.lastPositionIn(scope).map(function(pos){return getPositionsUntilPreviousLine(scope,pos).positions.concat(pos)}).getOr([])},all$1=function(predicate){return descendants($_boa99a15jh8lywey.body(),predicate)},ancestors=function(scope,predicate,isRoot){return $_5wjzy24jh8lyw2t.filter($_a43q0i17jh8lywfe.parents(scope,isRoot),predicate)},siblings$1=function(scope,predicate){return $_5wjzy24jh8lyw2t.filter($_a43q0i17jh8lywfe.siblings(scope),predicate)},children$1=function(scope,predicate){return $_5wjzy24jh8lyw2t.filter($_a43q0i17jh8lywfe.children(scope),predicate)},descendants=function(scope,predicate){var result=[];return $_5wjzy24jh8lyw2t.each($_a43q0i17jh8lywfe.children(scope),function(x){predicate(x)&&(result=result.concat([x])),result=result.concat(descendants(x,predicate))}),result},$_6y3ft32hjh8lywp5={all:all$1,ancestors:ancestors,siblings:siblings$1,children:children$1,descendants:descendants},all$2=function(selector){return $_5h4ipt1fjh8lywgi.all(selector)},ancestors$1=function(scope,selector,isRoot){return $_6y3ft32hjh8lywp5.ancestors(scope,function(e){return $_5h4ipt1fjh8lywgi.is(e,selector)},isRoot)},siblings$2=function(scope,selector){return $_6y3ft32hjh8lywp5.siblings(scope,function(e){return $_5h4ipt1fjh8lywgi.is(e,selector)})},children$2=function(scope,selector){return $_6y3ft32hjh8lywp5.children(scope,function(e){return $_5h4ipt1fjh8lywgi.is(e,selector)})},descendants$1=function(scope,selector){return $_5h4ipt1fjh8lywgi.all(selector,scope)},$_eebxu2gjh8lywp3={all:all$2,ancestors:ancestors$1,siblings:siblings$2,children:children$2,descendants:descendants$1},deflate=function(rect,delta){return{left:rect.left-delta,top:rect.top-delta,right:rect.right+2*delta,bottom:rect.bottom+2*delta,width:rect.width+delta,height:rect.height+delta}},getCorners=function(getYAxisValue,tds){return $_5wjzy24jh8lyw2t.bind(tds,function(td){var rect=deflate(td.getBoundingClientRect(),-1);return[{x:rect.left,y:getYAxisValue(rect),cell:td},{x:rect.right,y:getYAxisValue(rect),cell:td}]})},findClosestCorner=function(corners,x,y){return $_5wjzy24jh8lyw2t.foldl(corners,function(acc,newCorner){return acc.fold(function(){return Option.some(newCorner)},function(oldCorner){var oldDist=Math.sqrt(Math.abs(oldCorner.x-x)+Math.abs(oldCorner.y-y)),newDist=Math.sqrt(Math.abs(newCorner.x-x)+Math.abs(newCorner.y-y));return Option.some(newDist<oldDist?newCorner:oldCorner)})},Option.none())},getClosestCell=function(getYAxisValue,isTargetCorner,table,x,y){var cells=$_eebxu2gjh8lywp3.descendants($_cgttw3zjh8lywdq.fromDom(table),"td,th").map(function(e){return e.dom()}),corners=$_5wjzy24jh8lyw2t.filter(getCorners(getYAxisValue,cells),function(corner){return isTargetCorner(corner,y)});return findClosestCorner(corners,x,y).map(function(corner){return corner.cell})},getBottomValue=function(rect){return rect.bottom},getTopValue=function(rect){return rect.top},isAbove$1=function(corner,y){return corner.y<y},isBelow$1=function(corner,y){return corner.y>y},getClosestCellAbove=$_eqpqvr6jh8lyw3s.curry(getClosestCell,getBottomValue,isAbove$1),getClosestCellBelow=$_eqpqvr6jh8lyw3s.curry(getClosestCell,getTopValue,isBelow$1),findClosestPositionInAboveCell=function(table,pos){return $_5wjzy24jh8lyw2t.head(pos.getClientRects()).bind(function(rect){return getClosestCellAbove(table,rect.left,rect.top)}).bind(function(cell){return findClosestHorizontalPosition(getLastLinePositions(cell),pos)})},findClosestPositionInBelowCell=function(table,pos){return $_5wjzy24jh8lyw2t.last(pos.getClientRects()).bind(function(rect){return getClosestCellBelow(table,rect.left,rect.top)}).bind(function(cell){return findClosestHorizontalPosition(getFirstLinePositions(cell),pos)})},getPos$1=function(elm){for(var x=0,y=0,offsetParent=elm;offsetParent&&offsetParent.nodeType;)x+=offsetParent.offsetLeft||0,y+=offsetParent.offsetTop||0,offsetParent=offsetParent.offsetParent;return{x:x,y:y}},fireScrollIntoViewEvent=function(editor,elm,alignToTop){var scrollEvent={elm:elm,alignToTop:alignToTop};return editor.fire("scrollIntoView",scrollEvent),scrollEvent.isDefaultPrevented()},scrollElementIntoView=function(editor,elm,alignToTop){var y,viewPort,viewPortY,viewPortH,dom=editor.dom,root=dom.getRoot(),offsetY=0;if(!fireScrollIntoViewEvent(editor,elm,alignToTop)&&$_5oonaz1qjh8lywhz.isElement(elm)){if(alignToTop===!1&&(offsetY=elm.offsetHeight),"BODY"!==root.nodeName){var scrollContainer=editor.selection.getScrollContainer();if(scrollContainer)return y=getPos$1(elm).y-getPos$1(scrollContainer).y+offsetY,viewPortH=scrollContainer.clientHeight,viewPortY=scrollContainer.scrollTop,void((y<viewPortY||y+25>viewPortY+viewPortH)&&(scrollContainer.scrollTop=y<viewPortY?y:y-viewPortH+25))}viewPort=dom.getViewPort(editor.getWin()),y=dom.getPos(elm).y+offsetY,viewPortY=viewPort.y,viewPortH=viewPort.h,(y<viewPort.y||y+25>viewPortY+viewPortH)&&editor.getWin().scrollTo(0,y<viewPortY?y:y-viewPortH+25)}},getViewPortRect=function(editor){if(editor.inline)return editor.getBody().getBoundingClientRect();var win=editor.getWin();return{left:0,right:win.innerWidth,top:0,bottom:win.innerHeight,width:win.innerWidth,height:win.innerHeight}},scrollBy=function(editor,dx,dy){editor.inline?(editor.getBody().scrollLeft+=dx,editor.getBody().scrollTop+=dy):editor.getWin().scrollBy(dx,dy)},scrollRangeIntoView=function(editor,rng){$_5wjzy24jh8lyw2t.head(CaretPosition.fromRangeStart(rng).getClientRects()).each(function(rngRect){var bodyRect=getViewPortRect(editor),overflow=getOverflow(bodyRect,rngRect),margin=4,dx=overflow.x>0?overflow.x+margin:overflow.x-margin,dy=overflow.y>0?overflow.y+margin:overflow.y-margin;scrollBy(editor,0!==overflow.x?dx:0,0!==overflow.y?dy:0)})},$_cosk3k2ijh8lywpa={scrollElementIntoView:scrollElementIntoView,scrollRangeIntoView:scrollRangeIntoView},getBodySetting=function(editor,name,defaultValue){var value=editor.getParam(name,defaultValue);if(value.indexOf("=")!==-1){var bodyObj=editor.getParam(name,"","hash");return bodyObj.hasOwnProperty(editor.id)?bodyObj[editor.id]:defaultValue}return value},getIframeAttrs=function(editor){return editor.getParam("iframe_attrs",{})},getDocType=function(editor){return editor.getParam("doctype","<!DOCTYPE html>")},getDocumentBaseUrl=function(editor){return editor.getParam("document_base_url","")},getBodyId=function(editor){return getBodySetting(editor,"body_id","tinymce")},getBodyClass=function(editor){return getBodySetting(editor,"body_class","")},getContentSecurityPolicy=function(editor){return editor.getParam("content_security_policy","")},shouldPutBrInPre=function(editor){return editor.getParam("br_in_pre",!0)},getForcedRootBlock=function(editor){if(editor.getParam("force_p_newlines",!1))return"p";var block=editor.getParam("forced_root_block","p");return block===!1?"":block},getForcedRootBlockAttrs=function(editor){return editor.getParam("forced_root_block_attrs",{})},getBrNewLineSelector=function(editor){return editor.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")},getNoNewLineSelector=function(editor){return editor.getParam("no_newline_selector","")},shouldKeepStyles=function(editor){return editor.getParam("keep_styles",!0)},shouldEndContainerOnEmptyBlock=function(editor){return editor.getParam("end_container_on_empty_block",!1)},getFontStyleValues=function(editor){return $_ahowuxkjh8lywbj.explode(editor.getParam("font_size_style_values",""))},getFontSizeClasses=function(editor){return $_ahowuxkjh8lywbj.explode(editor.getParam("font_size_classes",""))},$_66vr6g2jjh8lywpf={getIframeAttrs:getIframeAttrs,getDocType:getDocType,getDocumentBaseUrl:getDocumentBaseUrl,getBodyId:getBodyId,getBodyClass:getBodyClass,getContentSecurityPolicy:getContentSecurityPolicy,shouldPutBrInPre:shouldPutBrInPre,getForcedRootBlock:getForcedRootBlock,getForcedRootBlockAttrs:getForcedRootBlockAttrs,getBrNewLineSelector:getBrNewLineSelector,getNoNewLineSelector:getNoNewLineSelector,shouldKeepStyles:shouldKeepStyles,shouldEndContainerOnEmptyBlock:shouldEndContainerOnEmptyBlock,getFontStyleValues:getFontStyleValues,getFontSizeClasses:getFontSizeClasses},before=function(marker,element){var parent=$_a43q0i17jh8lywfe.parent(marker);parent.each(function(v){v.dom().insertBefore(element.dom(),marker.dom())})},after=function(marker,element){var sibling=$_a43q0i17jh8lywfe.nextSibling(marker);sibling.fold(function(){var parent=$_a43q0i17jh8lywfe.parent(marker);parent.each(function(v){append(v,element)})},function(v){before(v,element)})},prepend=function(parent,element){var firstChild=$_a43q0i17jh8lywfe.firstChild(parent);firstChild.fold(function(){append(parent,element)},function(v){parent.dom().insertBefore(element.dom(),v.dom())})},append=function(parent,element){parent.dom().appendChild(element.dom())},appendAt=function(parent,element,index){$_a43q0i17jh8lywfe.child(parent,index).fold(function(){append(parent,element)},function(v){before(v,element)})},wrap$1=function(element,wrapper){before(element,wrapper),append(wrapper,element)},$_4m7u2e2kjh8lywpi={before:before,after:after,prepend:prepend,append:append,appendAt:appendAt,wrap:wrap$1},browser$2=$_9hkktfnjh8lywc6.detect().browser,isFakeCaretTableBrowser=function(){return browser$2.isIE()||browser$2.isEdge()||browser$2.isFirefox()},moveToRange=function(editor,rng){editor.selection.setRng(rng),$_cosk3k2ijh8lywpa.scrollRangeIntoView(editor,rng)},isAtTableCellLine=function(getPositionsUntil,scope,pos){var lineInfo=getPositionsUntil(scope,pos);return lineInfo.breakType===BreakType.Wrap&&0===lineInfo.positions.length?lineInfo.breakAt.map(function(breakPos){return getPositionsUntil(scope,breakPos).breakAt.isNone()}).getOr(!0):lineInfo.breakAt.isNone()},isAtFirstTableCellLine=$_8aqzj925jh8lywmj.curry(isAtTableCellLine,getPositionsUntilPreviousLine),isAtLastTableCellLine=$_8aqzj925jh8lywmj.curry(isAtTableCellLine,getPositionsUntilNextLine),isCaretAtStartOrEndOfTable=function(forward,rng,table){var caretPos=CaretPosition$1.fromRangeStart(rng);return $_9kvypj2cjh8lywnz.positionIn(!forward,table).map(function(pos){return pos.isEqual(caretPos)}).getOr(!1)},navigateHorizontally=function(editor,forward,table,td){var rng=editor.selection.getRng(),direction=forward?1:-1;if(isFakeCaretTableBrowser()&&isCaretAtStartOrEndOfTable(forward,rng,table)){var newRng=showCaret(direction,editor,table,!forward,!0);return moveToRange(editor,newRng),!0}return!1},getClosestAbovePosition=function(root,table,start){return findClosestPositionInAboveCell(table,start).orThunk(function(){return $_5wjzy24jh8lyw2t.head(start.getClientRects()).bind(function(rect){return findClosestHorizontalPositionFromPoint(getPositionsAbove(root,CaretPosition$1.before(table)),rect.left)})}).getOr(CaretPosition$1.before(table))},getClosestBelowPosition=function(root,table,start){return findClosestPositionInBelowCell(table,start).orThunk(function(){return $_5wjzy24jh8lyw2t.head(start.getClientRects()).bind(function(rect){return findClosestHorizontalPositionFromPoint(getPositionsBelow(root,CaretPosition$1.after(table)),rect.left)})}).getOr(CaretPosition$1.after(table))},getTable=function(previous,pos){var node=pos.getNode(previous);return $_5oonaz1qjh8lywhz.isElement(node)&&"TABLE"===node.nodeName?Option.some(node):Option.none()},renderBlock=function(down,editor,table,pos){var forcedRootBlock=$_66vr6g2jjh8lywpf.getForcedRootBlock(editor);forcedRootBlock?editor.undoManager.transact(function(){var element=$_cgttw3zjh8lywdq.fromTag(forcedRootBlock);$_3da62i14jh8lyweo.setAll(element,$_66vr6g2jjh8lywpf.getForcedRootBlockAttrs(editor)),$_4m7u2e2kjh8lywpi.append(element,$_cgttw3zjh8lywdq.fromTag("br")),down?$_4m7u2e2kjh8lywpi.after($_cgttw3zjh8lywdq.fromDom(table),element):$_4m7u2e2kjh8lywpi.before($_cgttw3zjh8lywdq.fromDom(table),element);var rng=editor.dom.createRng();rng.setStart(element.dom(),0),rng.setEnd(element.dom(),0),moveToRange(editor,rng)}):moveToRange(editor,pos.toRange())},moveCaret=function(editor,down,pos){var table=down?getTable(!0,pos):getTable(!1,pos),last=down===!1;table.fold(function(){return moveToRange(editor,pos.toRange())},function(table){return $_9kvypj2cjh8lywnz.positionIn(last,editor.getBody()).filter(function(lastPos){return lastPos.isEqual(pos)}).fold(function(){return moveToRange(editor,pos.toRange())},function(_){return renderBlock(down,editor,table,pos)})})},navigateVertically=function(editor,down,table,td){var rng=editor.selection.getRng(),pos=CaretPosition$1.fromRangeStart(rng),root=editor.getBody();if(!down&&isAtFirstTableCellLine(td,pos)){var newPos=getClosestAbovePosition(root,table,pos);return moveCaret(editor,down,newPos),!0}if(down&&isAtLastTableCellLine(td,pos)){var newPos=getClosestBelowPosition(root,table,pos);return moveCaret(editor,down,newPos),!0}return!1},moveH=function(editor,forward){return function(){return Option.from(editor.dom.getParent(editor.selection.getNode(),"td,th")).bind(function(td){return Option.from(editor.dom.getParent(td,"table")).map(function(table){return navigateHorizontally(editor,forward,table,td)})}).getOr(!1)}},moveV=function(editor,forward){return function(){return Option.from(editor.dom.getParent(editor.selection.getNode(),"td,th")).bind(function(td){return Option.from(editor.dom.getParent(td,"table")).map(function(table){return navigateVertically(editor,forward,table,td)})}).getOr(!1)}},Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},isContentEditableFalse$3=$_5oonaz1qjh8lywhz.isContentEditableFalse,isTableCell$1=function(node){return $_5oonaz1qjh8lywhz.isElement(node)&&/^(TD|TH)$/i.test(node.tagName);
},getAbsoluteClientRect=function(root,element,before){var docElm,scrollX,scrollY,margin,rootRect,clientRect=collapse(element.getBoundingClientRect(),before);return"BODY"===root.tagName?(docElm=root.ownerDocument.documentElement,scrollX=root.scrollLeft||docElm.scrollLeft,scrollY=root.scrollTop||docElm.scrollTop):(rootRect=root.getBoundingClientRect(),scrollX=root.scrollLeft-rootRect.left,scrollY=root.scrollTop-rootRect.top),clientRect.left+=scrollX,clientRect.right+=scrollX,clientRect.top+=scrollY,clientRect.bottom+=scrollY,clientRect.width=1,margin=element.offsetWidth-element.clientWidth,margin>0&&(before&&(margin*=-1),clientRect.left+=margin,clientRect.right+=margin),clientRect},trimInlineCaretContainers=function(root){var contentEditableFalseNodes,node,sibling,i,data;for(contentEditableFalseNodes=DomQuery("*[contentEditable=false]",root),i=0;i<contentEditableFalseNodes.length;i++)node=contentEditableFalseNodes[i],sibling=node.previousSibling,endsWithCaretContainer(sibling)&&(data=sibling.data,1===data.length?sibling.parentNode.removeChild(sibling):sibling.deleteData(data.length-1,1)),sibling=node.nextSibling,startsWithCaretContainer(sibling)&&(data=sibling.data,1===data.length?sibling.parentNode.removeChild(sibling):sibling.deleteData(0,1))},FakeCaret=function(root,isBlock,hasFocus){var cursorInterval,caretContainerNode,lastVisualCaret=Cell(Option.none()),show=function(before,element){var clientRect,rng;if(hide(),isTableCell$1(element))return null;if(!isBlock(element))return caretContainerNode=insertInline(element,before),rng=element.ownerDocument.createRange(),isContentEditableFalse$3(caretContainerNode.nextSibling)?(rng.setStart(caretContainerNode,0),rng.setEnd(caretContainerNode,0)):(rng.setStart(caretContainerNode,1),rng.setEnd(caretContainerNode,1)),rng;caretContainerNode=insertBlock("p",element,before),clientRect=getAbsoluteClientRect(root,element,before),DomQuery(caretContainerNode).css("top",clientRect.top);var caret=DomQuery('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(clientRect).appendTo(root)[0];return lastVisualCaret.set(Option.some({caret:caret,element:element,before:before})),lastVisualCaret.get().each(function(caretState){before&&DomQuery(caretState.caret).addClass("mce-visual-caret-before")}),startBlink(),rng=element.ownerDocument.createRange(),rng.setStart(caretContainerNode,0),rng.setEnd(caretContainerNode,0),rng},hide=function(){trimInlineCaretContainers(root),caretContainerNode&&($_9nl16f2ajh8lywne.remove(caretContainerNode),caretContainerNode=null),lastVisualCaret.get().each(function(caretState){DomQuery(caretState.caret).remove(),lastVisualCaret.set(Option.none())}),clearInterval(cursorInterval)},startBlink=function(){cursorInterval=$_8sy3pfhjh8lyw95.setInterval(function(){hasFocus()?DomQuery("div.mce-visual-caret",root).toggleClass("mce-visual-caret-hidden"):DomQuery("div.mce-visual-caret",root).addClass("mce-visual-caret-hidden")},500)},reposition=function(){lastVisualCaret.get().each(function(caretState){var clientRect=getAbsoluteClientRect(root,caretState.element,caretState.before);DomQuery(caretState.caret).css(clientRect)})},destroy=function(){return $_8sy3pfhjh8lyw95.clearInterval(cursorInterval)},getCss=function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"};return{show:show,hide:hide,getCss:getCss,reposition:reposition,destroy:destroy}},isFakeCaretTarget=function(node){return isContentEditableFalse$3(node)||$_5oonaz1qjh8lywhz.isTable(node)&&isFakeCaretTableBrowser()},isContentEditableFalse$4=$_5oonaz1qjh8lywhz.isContentEditableFalse,isBlockLike=$_5oonaz1qjh8lywhz.matchStyleValues("display","block table table-cell table-caption list-item"),isCaretContainer$2=isCaretContainer,isCaretContainerBlock$1=isCaretContainerBlock,curry$2=$_8aqzj925jh8lywmj.curry,isElement$5=$_5oonaz1qjh8lywhz.isElement,isCaretCandidate$2=isCaretCandidate,isForwards=function(direction){return direction>0},isBackwards=function(direction){return direction<0},skipCaretContainers=function(walk,shallow){for(var node;node=walk(shallow);)if(!isCaretContainerBlock$1(node))return node;return null},findNode=function(node,direction,predicateFn,rootNode,shallow){var walker=new TreeWalker(node,rootNode);if(isBackwards(direction)){if((isContentEditableFalse$4(node)||isCaretContainerBlock$1(node))&&(node=skipCaretContainers(walker.prev,!0),predicateFn(node)))return node;for(;node=skipCaretContainers(walker.prev,shallow);)if(predicateFn(node))return node}if(isForwards(direction)){if((isContentEditableFalse$4(node)||isCaretContainerBlock$1(node))&&(node=skipCaretContainers(walker.next,!0),predicateFn(node)))return node;for(;node=skipCaretContainers(walker.next,shallow);)if(predicateFn(node))return node}return null},getParentBlock=function(node,rootNode){for(;node&&node!==rootNode;){if(isBlockLike(node))return node;node=node.parentNode}return null},isInSameBlock=function(caretPosition1,caretPosition2,rootNode){return getParentBlock(caretPosition1.container(),rootNode)===getParentBlock(caretPosition2.container(),rootNode)},getChildNodeAtRelativeOffset=function(relativeOffset,caretPosition){var container,offset;return caretPosition?(container=caretPosition.container(),offset=caretPosition.offset(),isElement$5(container)?container.childNodes[offset+relativeOffset]:null):null},beforeAfter=function(before,node){var range=node.ownerDocument.createRange();return before?(range.setStartBefore(node),range.setEndBefore(node)):(range.setStartAfter(node),range.setEndAfter(node)),range},isNodesInSameBlock=function(root,node1,node2){return getParentBlock(node1,root)===getParentBlock(node2,root)},lean=function(left,root,node){var sibling,siblingName;for(siblingName=left?"previousSibling":"nextSibling";node&&node!==root;){if(sibling=node[siblingName],isCaretContainer$2(sibling)&&(sibling=sibling[siblingName]),isContentEditableFalse$4(sibling)){if(isNodesInSameBlock(root,sibling,node))return sibling;break}if(isCaretCandidate$2(sibling))break;node=node.parentNode}return null},before$1=curry$2(beforeAfter,!0),after$1=curry$2(beforeAfter,!1),normalizeRange=function(direction,root,range){var node,container,offset,location,leanLeft=curry$2(lean,!0,root),leanRight=curry$2(lean,!1,root);if(container=range.startContainer,offset=range.startOffset,isCaretContainerBlock(container)){if(isElement$5(container)||(container=container.parentNode),location=container.getAttribute("data-mce-caret"),"before"===location&&(node=container.nextSibling,isFakeCaretTarget(node)))return before$1(node);if("after"===location&&(node=container.previousSibling,isFakeCaretTarget(node)))return after$1(node)}if(!range.collapsed)return range;if($_5oonaz1qjh8lywhz.isText(container)){if(isCaretContainer$2(container)){if(1===direction){if(node=leanRight(container))return before$1(node);if(node=leanLeft(container))return after$1(node)}if(direction===-1){if(node=leanLeft(container))return after$1(node);if(node=leanRight(container))return before$1(node)}return range}if(endsWithCaretContainer(container)&&offset>=container.data.length-1)return 1===direction&&(node=leanRight(container))?before$1(node):range;if(startsWithCaretContainer(container)&&offset<=1)return direction===-1&&(node=leanLeft(container))?after$1(node):range;if(offset===container.data.length)return node=leanRight(container),node?before$1(node):range;if(0===offset)return node=leanLeft(container),node?after$1(node):range}return range},isNextToContentEditableFalse=function(relativeOffset,caretPosition){var node=getChildNodeAtRelativeOffset(relativeOffset,caretPosition);return isContentEditableFalse$4(node)&&!$_5oonaz1qjh8lywhz.isBogusAll(node)},isNextToTable=function(relativeOffset,caretPosition){return $_5oonaz1qjh8lywhz.isTable(getChildNodeAtRelativeOffset(relativeOffset,caretPosition))},getRelativeCefElm=function(forward,caretPosition){return Option.from(getChildNodeAtRelativeOffset(forward?0:-1,caretPosition)).filter(isContentEditableFalse$4)},getNormalizedRangeEndPoint=function(direction,root,range){var normalizedRange=normalizeRange(direction,root,range);return direction===-1?CaretPosition.fromRangeStart(normalizedRange):CaretPosition.fromRangeEnd(normalizedRange)},isBeforeContentEditableFalse=curry$2(isNextToContentEditableFalse,0),isAfterContentEditableFalse=curry$2(isNextToContentEditableFalse,-1),isBeforeTable=curry$2(isNextToTable,0),isAfterTable=curry$2(isNextToTable,-1);!function(HDirection){HDirection[HDirection.Backwards=-1]="Backwards",HDirection[HDirection.Forwards=1]="Forwards"}(HDirection||(HDirection={}));var isContentEditableFalse$5=$_5oonaz1qjh8lywhz.isContentEditableFalse,isText$6=$_5oonaz1qjh8lywhz.isText,isElement$6=$_5oonaz1qjh8lywhz.isElement,isBr$4=$_5oonaz1qjh8lywhz.isBr,isCaretCandidate$3=isCaretCandidate,isAtomic$1=isAtomic,isEditableCaretCandidate$1=isEditableCaretCandidate,getParents=function(node,root){for(var parents=[];node&&node!==root;)parents.push(node),node=node.parentNode;return parents},nodeAtIndex=function(container,offset){return container.hasChildNodes()&&offset<container.childNodes.length?container.childNodes[offset]:null},getCaretCandidatePosition=function(direction,node){if(isForwards(direction)){if(isCaretCandidate$3(node.previousSibling)&&!isText$6(node.previousSibling))return CaretPosition$1.before(node);if(isText$6(node))return CaretPosition$1(node,0)}if(isBackwards(direction)){if(isCaretCandidate$3(node.nextSibling)&&!isText$6(node.nextSibling))return CaretPosition$1.after(node);if(isText$6(node))return CaretPosition$1(node,node.data.length)}return isBackwards(direction)?isBr$4(node)?CaretPosition$1.before(node):CaretPosition$1.after(node):CaretPosition$1.before(node)},isBrBeforeBlock=function(node,root){var next;return!!$_5oonaz1qjh8lywhz.isBr(node)&&(next=findCaretPosition(1,CaretPosition$1.after(node),root),!!next&&!isInSameBlock(CaretPosition$1.before(node),CaretPosition$1.before(next),root))},findCaretPosition=function(direction,startPos,root){var node,nextNode,innerNode,rootContentEditableFalseElm,caretPosition;if(!isElement$6(root)||!startPos)return null;if(startPos.isEqual(CaretPosition$1.after(root))&&root.lastChild){if(caretPosition=CaretPosition$1.after(root.lastChild),isBackwards(direction)&&isCaretCandidate$3(root.lastChild)&&isElement$6(root.lastChild))return isBr$4(root.lastChild)?CaretPosition$1.before(root.lastChild):caretPosition}else caretPosition=startPos;var container=caretPosition.container(),offset=caretPosition.offset();if(isText$6(container)){if(isBackwards(direction)&&offset>0)return CaretPosition$1(container,--offset);if(isForwards(direction)&&offset<container.length)return CaretPosition$1(container,++offset);node=container}else{if(isBackwards(direction)&&offset>0&&(nextNode=nodeAtIndex(container,offset-1),isCaretCandidate$3(nextNode)))return!isAtomic$1(nextNode)&&(innerNode=findNode(nextNode,direction,isEditableCaretCandidate$1,nextNode))?isText$6(innerNode)?CaretPosition$1(innerNode,innerNode.data.length):CaretPosition$1.after(innerNode):isText$6(nextNode)?CaretPosition$1(nextNode,nextNode.data.length):CaretPosition$1.before(nextNode);if(isForwards(direction)&&offset<container.childNodes.length&&(nextNode=nodeAtIndex(container,offset),isCaretCandidate$3(nextNode)))return isBr$4(nextNode)&&root.lastChild===nextNode?null:isBrBeforeBlock(nextNode,root)?findCaretPosition(direction,CaretPosition$1.after(nextNode),root):!isAtomic$1(nextNode)&&(innerNode=findNode(nextNode,direction,isEditableCaretCandidate$1,nextNode))?isText$6(innerNode)?CaretPosition$1(innerNode,0):CaretPosition$1.before(innerNode):isText$6(nextNode)?CaretPosition$1(nextNode,0):CaretPosition$1.after(nextNode);node=nextNode?nextNode:caretPosition.getNode()}return(isForwards(direction)&&caretPosition.isAtEnd()||isBackwards(direction)&&caretPosition.isAtStart())&&(node=findNode(node,direction,$_8aqzj925jh8lywmj.constant(!0),root,!0),isEditableCaretCandidate$1(node,root))?getCaretCandidatePosition(direction,node):(nextNode=findNode(node,direction,isEditableCaretCandidate$1,root),rootContentEditableFalseElm=$_9tjm51ljh8lywbq.last($_9tjm51ljh8lywbq.filter(getParents(container,root),isContentEditableFalse$5)),!rootContentEditableFalseElm||nextNode&&rootContentEditableFalseElm.contains(nextNode)?nextNode?getCaretCandidatePosition(direction,nextNode):null:caretPosition=isForwards(direction)?CaretPosition$1.after(rootContentEditableFalseElm):CaretPosition$1.before(rootContentEditableFalseElm))},CaretWalker=function(root){return{next:function(caretPosition){return findCaretPosition(HDirection.Forwards,caretPosition,root)},prev:function(caretPosition){return findCaretPosition(HDirection.Backwards,caretPosition,root)}}},hasOnlyOneChild=function(node){return node.firstChild&&node.firstChild===node.lastChild},isPaddingNode=function(node){return"br"===node.name||" "===node.value},isPaddedEmptyBlock=function(schema,node){var blockElements=schema.getBlockElements();return blockElements[node.name]&&hasOnlyOneChild(node)&&isPaddingNode(node.firstChild)},isEmptyFragmentElement=function(schema,node){var nonEmptyElements=schema.getNonEmptyElements();return node&&(node.isEmpty(nonEmptyElements)||isPaddedEmptyBlock(schema,node))},isListFragment=function(schema,fragment){var firstChild=fragment.firstChild,lastChild=fragment.lastChild;return firstChild&&"meta"===firstChild.name&&(firstChild=firstChild.next),lastChild&&"mce_marker"===lastChild.attr("id")&&(lastChild=lastChild.prev),isEmptyFragmentElement(schema,lastChild)&&(lastChild=lastChild.prev),!(!firstChild||firstChild!==lastChild)&&("ul"===firstChild.name||"ol"===firstChild.name)},cleanupDomFragment=function(domFragment){var firstChild=domFragment.firstChild,lastChild=domFragment.lastChild;return firstChild&&"META"===firstChild.nodeName&&firstChild.parentNode.removeChild(firstChild),lastChild&&"mce_marker"===lastChild.id&&lastChild.parentNode.removeChild(lastChild),domFragment},toDomFragment=function(dom,serializer,fragment){var html=serializer.serialize(fragment),domFragment=dom.createFragment(html);return cleanupDomFragment(domFragment)},listItems$1=function(elm){return $_ahowuxkjh8lywbj.grep(elm.childNodes,function(child){return"LI"===child.nodeName})},isPadding=function(node){return" "===node.data||$_5oonaz1qjh8lywhz.isBr(node)},isListItemPadded=function(node){return node&&node.firstChild&&node.firstChild===node.lastChild&&isPadding(node.firstChild)},isEmptyOrPadded=function(elm){return!elm.firstChild||isListItemPadded(elm)},trimListItems=function(elms){return elms.length>0&&isEmptyOrPadded(elms[elms.length-1])?elms.slice(0,-1):elms},getParentLi=function(dom,node){var parentBlock=dom.getParent(node,dom.isBlock);return parentBlock&&"LI"===parentBlock.nodeName?parentBlock:null},isParentBlockLi=function(dom,node){return!!getParentLi(dom,node)},getSplit=function(parentNode,rng){var beforeRng=rng.cloneRange(),afterRng=rng.cloneRange();return beforeRng.setStartBefore(parentNode),afterRng.setEndAfter(parentNode),[beforeRng.cloneContents(),afterRng.cloneContents()]},findFirstIn=function(node,rootNode){var caretPos=CaretPosition$1.before(node),caretWalker=CaretWalker(rootNode),newCaretPos=caretWalker.next(caretPos);return newCaretPos?newCaretPos.toRange():null},findLastOf=function(node,rootNode){var caretPos=CaretPosition$1.after(node),caretWalker=CaretWalker(rootNode),newCaretPos=caretWalker.prev(caretPos);return newCaretPos?newCaretPos.toRange():null},insertMiddle=function(target,elms,rootNode,rng){var parts=getSplit(target,rng),parentElm=target.parentNode;return parentElm.insertBefore(parts[0],target),$_ahowuxkjh8lywbj.each(elms,function(li){parentElm.insertBefore(li,target)}),parentElm.insertBefore(parts[1],target),parentElm.removeChild(target),findLastOf(elms[elms.length-1],rootNode)},insertBefore=function(target,elms,rootNode){var parentElm=target.parentNode;return $_ahowuxkjh8lywbj.each(elms,function(elm){parentElm.insertBefore(elm,target)}),findFirstIn(target,rootNode)},insertAfter=function(target,elms,rootNode,dom){return dom.insertAfter(elms.reverse(),target),findLastOf(elms[0],rootNode)},insertAtCaret=function(serializer,dom,rng,fragment){var domFragment=toDomFragment(dom,serializer,fragment),liTarget=getParentLi(dom,rng.startContainer),liElms=trimListItems(listItems$1(domFragment.firstChild)),BEGINNING=1,END=2,rootNode=dom.getRoot(),isAt=function(location){var caretPos=CaretPosition$1.fromRangeStart(rng),caretWalker=CaretWalker(dom.getRoot()),newPos=location===BEGINNING?caretWalker.prev(caretPos):caretWalker.next(caretPos);return!newPos||getParentLi(dom,newPos.getNode())!==liTarget};return isAt(BEGINNING)?insertBefore(liTarget,liElms,rootNode):isAt(END)?insertAfter(liTarget,liElms,rootNode,dom):insertMiddle(liTarget,liElms,rootNode,rng)},$_eajoh11xjh8lywl6={isListFragment:isListFragment,insertAtCaret:insertAtCaret,isParentBlockLi:isParentBlockLi,trimListItems:trimListItems,listItems:listItems$1},isText$7=$_5oonaz1qjh8lywhz.isText,isBogus$1=$_5oonaz1qjh8lywhz.isBogus,nodeIndex$1=DOMUtils$1.nodeIndex,normalizedParent=function(node){var parentNode=node.parentNode;return isBogus$1(parentNode)?normalizedParent(parentNode):parentNode},getChildNodes=function(node){return node?$_9tjm51ljh8lywbq.reduce(node.childNodes,function(result,node){return isBogus$1(node)&&"BR"!==node.nodeName?result=result.concat(getChildNodes(node)):result.push(node),result},[]):[]},normalizedTextOffset=function(node,offset){for(;(node=node.previousSibling)&&isText$7(node);)offset+=node.data.length;return offset},equal$1=function(a){return function(b){return a===b}},normalizedNodeIndex=function(node){var nodes,index,numTextFragments;return nodes=getChildNodes(normalizedParent(node)),index=$_9tjm51ljh8lywbq.findIndex(nodes,equal$1(node),node),nodes=nodes.slice(0,index+1),numTextFragments=$_9tjm51ljh8lywbq.reduce(nodes,function(result,node,i){return isText$7(node)&&isText$7(nodes[i-1])&&result++,result},0),nodes=$_9tjm51ljh8lywbq.filter(nodes,$_5oonaz1qjh8lywhz.matchNodeNames(node.nodeName)),index=$_9tjm51ljh8lywbq.findIndex(nodes,equal$1(node),node),index-numTextFragments},createPathItem=function(node){var name;return name=isText$7(node)?"text()":node.nodeName.toLowerCase(),name+"["+normalizedNodeIndex(node)+"]"},parentsUntil=function(root,node,predicate){var parents=[];for(node=node.parentNode;node!==root&&(!predicate||!predicate(node));node=node.parentNode)parents.push(node);return parents},create$1=function(root,caretPosition){var container,offset,outputOffset,childNodes,parents,path=[];return container=caretPosition.container(),offset=caretPosition.offset(),isText$7(container)?outputOffset=normalizedTextOffset(container,offset):(childNodes=container.childNodes,offset>=childNodes.length?(outputOffset="after",offset=childNodes.length-1):outputOffset="before",container=childNodes[offset]),path.push(createPathItem(container)),parents=parentsUntil(root,container),parents=$_9tjm51ljh8lywbq.filter(parents,$_8aqzj925jh8lywmj.negate($_5oonaz1qjh8lywhz.isBogus)),path=path.concat($_9tjm51ljh8lywbq.map(parents,function(node){return createPathItem(node)})),path.reverse().join("/")+","+outputOffset},resolvePathItem=function(node,name,index){var nodes=getChildNodes(node);return nodes=$_9tjm51ljh8lywbq.filter(nodes,function(node,index){return!isText$7(node)||!isText$7(nodes[index-1])}),nodes=$_9tjm51ljh8lywbq.filter(nodes,$_5oonaz1qjh8lywhz.matchNodeNames(name)),nodes[index]},findTextPosition=function(container,offset){for(var dataLen,node=container,targetOffset=0;isText$7(node);){if(dataLen=node.data.length,offset>=targetOffset&&offset<=targetOffset+dataLen){container=node,offset-=targetOffset;break}if(!isText$7(node.nextSibling)){container=node,offset=dataLen;break}targetOffset+=dataLen,node=node.nextSibling}return isText$7(container)&&offset>container.data.length&&(offset=container.data.length),CaretPosition$1(container,offset)},resolve$2=function(root,path){var parts,container,offset;return path?(parts=path.split(","),path=parts[0].split("/"),offset=parts.length>1?parts[1]:"before",container=$_9tjm51ljh8lywbq.reduce(path,function(result,value){return(value=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(value))?("text()"===value[1]&&(value[1]="#text"),resolvePathItem(result,value[1],parseInt(value[2],10))):null},root),container?isText$7(container)?findTextPosition(container,parseInt(offset,10)):(offset="after"===offset?nodeIndex$1(container)+1:nodeIndex$1(container),CaretPosition$1(container.parentNode,offset)):null):null},isContentEditableFalse$6=$_5oonaz1qjh8lywhz.isContentEditableFalse,getNormalizedTextOffset=function(trim,container,offset){var node,trimmedOffset;for(trimmedOffset=trim(container.data.slice(0,offset)).length,node=container.previousSibling;node&&$_5oonaz1qjh8lywhz.isText(node);node=node.previousSibling)trimmedOffset+=trim(node.data).length;return trimmedOffset},getPoint=function(dom,trim,normalized,rng,start){var childNodes,container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],point=[],after=0,root=dom.getRoot();for($_5oonaz1qjh8lywhz.isText(container)?point.push(normalized?getNormalizedTextOffset(trim,container,offset):offset):(childNodes=container.childNodes,offset>=childNodes.length&&childNodes.length&&(after=1,offset=Math.max(0,childNodes.length-1)),point.push(dom.nodeIndex(childNodes[offset],normalized)+after));container&&container!==root;container=container.parentNode)point.push(dom.nodeIndex(container,normalized));return point},getLocation=function(trim,selection,normalized,rng){var dom=selection.dom,bookmark={};return bookmark.start=getPoint(dom,trim,normalized,rng,!0),selection.isCollapsed()||(bookmark.end=getPoint(dom,trim,normalized,rng,!1)),bookmark},trimEmptyTextNode=function(node){$_5oonaz1qjh8lywhz.isText(node)&&0===node.data.length&&node.parentNode.removeChild(node)},findIndex$3=function(dom,name,element){var count=0;return $_ahowuxkjh8lywbj.each(dom.select(name),function(node){if("all"!==node.getAttribute("data-mce-bogus"))return node!==element&&void count++}),count},moveEndPoint=function(rng,start){var container,offset,childNodes,prefix=start?"start":"end";container=rng[prefix+"Container"],offset=rng[prefix+"Offset"],$_5oonaz1qjh8lywhz.isElement(container)&&"TR"===container.nodeName&&(childNodes=container.childNodes,container=childNodes[Math.min(start?offset:offset-1,childNodes.length-1)],container&&(offset=start?0:container.childNodes.length,rng["set"+(start?"Start":"End")](container,offset)))},normalizeTableCellSelection=function(rng){return moveEndPoint(rng,!0),moveEndPoint(rng,!1),rng},findSibling=function(node,offset){var sibling;if($_5oonaz1qjh8lywhz.isElement(node)&&(node=getNode(node,offset),isContentEditableFalse$6(node)))return node;if(isCaretContainer(node)){if($_5oonaz1qjh8lywhz.isText(node)&&isCaretContainerBlock(node)&&(node=node.parentNode),sibling=node.previousSibling,isContentEditableFalse$6(sibling))return sibling;if(sibling=node.nextSibling,isContentEditableFalse$6(sibling))return sibling}},findAdjacentContentEditableFalseElm=function(rng){return findSibling(rng.startContainer,rng.startOffset)||findSibling(rng.endContainer,rng.endOffset)},getOffsetBookmark=function(trim,normalized,selection){var element=selection.getNode(),name=element?element.nodeName:null,rng=selection.getRng();if(isContentEditableFalse$6(element)||"IMG"===name)return{name:name,index:findIndex$3(selection.dom,name,element)};var sibling=findAdjacentContentEditableFalseElm(rng);return sibling?(name=sibling.tagName,{name:name,index:findIndex$3(selection.dom,name,sibling)}):getLocation(trim,selection,normalized,rng)},getCaretBookmark=function(selection){var rng=selection.getRng();return{start:create$1(selection.dom.getRoot(),CaretPosition$1.fromRangeStart(rng)),end:create$1(selection.dom.getRoot(),CaretPosition$1.fromRangeEnd(rng))}},getRangeBookmark=function(selection){return{rng:selection.getRng()}},createBookmarkSpan=function(dom,id,filled){var args={"data-mce-type":"bookmark",id:id,style:"overflow:hidden;line-height:0px"};return filled?dom.create("span",args,"&#xFEFF;"):dom.create("span",args)},getPersistentBookmark=function(selection,filled){var dom=selection.dom,rng=selection.getRng(),id=dom.uniqueId(),collapsed=selection.isCollapsed(),element=selection.getNode(),name=element.nodeName;if("IMG"===name)return{name:name,index:findIndex$3(dom,name,element)};var rng2=normalizeTableCellSelection(rng.cloneRange());if(!collapsed){rng2.collapse(!1);var endBookmarkNode=createBookmarkSpan(dom,id+"_end",filled);rng2.insertNode(endBookmarkNode),trimEmptyTextNode(endBookmarkNode.nextSibling)}rng=normalizeTableCellSelection(rng),rng.collapse(!0);var startBookmarkNode=createBookmarkSpan(dom,id+"_start",filled);return rng.insertNode(startBookmarkNode),trimEmptyTextNode(startBookmarkNode.previousSibling),selection.moveToBookmark({id:id,keep:1}),{id:id}},getBookmark=function(selection,type,normalized){return 2===type?getOffsetBookmark($_d383mr21jh8lywlv.trim,normalized,selection):3===type?getCaretBookmark(selection):type?getRangeBookmark(selection):getPersistentBookmark(selection,!1)},$_8b82yg2ojh8lywpq={getBookmark:getBookmark,getUndoBookmark:$_eqpqvr6jh8lyw3s.curry(getOffsetBookmark,$_eqpqvr6jh8lyw3s.identity,!0),getPersistentBookmark:getPersistentBookmark},CARET_ID="_mce_caret",isCaretNode=function(node){return $_5oonaz1qjh8lywhz.isElement(node)&&node.id===CARET_ID},getParentCaretContainer=function(body,node){for(;node&&node!==body;){if(node.id===CARET_ID)return node;node=node.parentNode}return null},isStringPathBookmark=function(bookmark){return"string"==typeof bookmark.start},isRangeBookmark=function(bookmark){return bookmark.hasOwnProperty("rng")},isIdBookmark=function(bookmark){return bookmark.hasOwnProperty("id")},isIndexBookmark=function(bookmark){return bookmark.hasOwnProperty("name")},isPathBookmark=function(bookmark){return $_ahowuxkjh8lywbj.isArray(bookmark.start)},addBogus=function(dom,node){return!dom.isBlock(node)||node.innerHTML||$_9bpim8ajh8lyw68.ie||(node.innerHTML='<br data-mce-bogus="1" />'),node},resolveCaretPositionBookmark=function(dom,bookmark){var rng,pos;return rng=dom.createRng(),pos=resolve$2(dom.getRoot(),bookmark.start),rng.setStart(pos.container(),pos.offset()),pos=resolve$2(dom.getRoot(),bookmark.end),rng.setEnd(pos.container(),pos.offset()),rng},insertZwsp=function(node,rng){var textNode=node.ownerDocument.createTextNode($_d383mr21jh8lywlv.ZWSP);node.appendChild(textNode),rng.setStart(textNode,0),rng.setEnd(textNode,0)},isEmpty=function(node){return node.hasChildNodes()===!1},tryFindRangePosition=function(node,rng){return $_9kvypj2cjh8lywnz.lastPositionIn(node).fold(function(){return!1},function(pos){return rng.setStart(pos.container(),pos.offset()),rng.setEnd(pos.container(),pos.offset()),!0})},padEmptyCaretContainer=function(root,node,rng){return!(!isEmpty(node)||!getParentCaretContainer(root,node))&&(insertZwsp(node,rng),!0)},setEndPoint=function(dom,start,bookmark,rng){var i,node,offset,children,point=bookmark[start?"start":"end"],root=dom.getRoot();if(point){for(offset=point[0],node=root,i=point.length-1;i>=1;i--){if(children=node.childNodes,padEmptyCaretContainer(root,node,rng))return!0;if(point[i]>children.length-1)return!!padEmptyCaretContainer(root,node,rng)||tryFindRangePosition(node,rng);node=children[point[i]]}3===node.nodeType&&(offset=Math.min(point[0],node.nodeValue.length)),1===node.nodeType&&(offset=Math.min(point[0],node.childNodes.length)),start?rng.setStart(node,offset):rng.setEnd(node,offset)}return!0},isValidTextNode=function(node){return $_5oonaz1qjh8lywhz.isText(node)&&node.data.length>0},restoreEndPoint=function(dom,suffix,bookmark){var node,idx,next,prev,container,offset,marker=dom.get(bookmark.id+"_"+suffix),keep=bookmark.keep;if(marker){if(node=marker.parentNode,"start"===suffix?(keep?marker.hasChildNodes()?(node=marker.firstChild,idx=1):isValidTextNode(marker.nextSibling)?(node=marker.nextSibling,idx=0):isValidTextNode(marker.previousSibling)?(node=marker.previousSibling,idx=marker.previousSibling.data.length):(node=marker.parentNode,idx=dom.nodeIndex(marker)+1):idx=dom.nodeIndex(marker),container=node,offset=idx):(keep?marker.hasChildNodes()?(node=marker.firstChild,idx=1):isValidTextNode(marker.previousSibling)?(node=marker.previousSibling,idx=marker.previousSibling.data.length):(node=marker.parentNode,idx=dom.nodeIndex(marker)):idx=dom.nodeIndex(marker),container=node,offset=idx),!keep){for(prev=marker.previousSibling,next=marker.nextSibling,$_ahowuxkjh8lywbj.each($_ahowuxkjh8lywbj.grep(marker.childNodes),function(node){$_5oonaz1qjh8lywhz.isText(node)&&(node.nodeValue=node.nodeValue.replace(/\uFEFF/g,""))});marker=dom.get(bookmark.id+"_"+suffix);)dom.remove(marker,!0);prev&&next&&prev.nodeType===next.nodeType&&$_5oonaz1qjh8lywhz.isText(prev)&&!$_9bpim8ajh8lyw68.opera&&(idx=prev.nodeValue.length,prev.appendData(next.nodeValue),dom.remove(next),"start"===suffix?(container=prev,offset=idx):(container=prev,offset=idx))}return Option.some(CaretPosition$1(container,offset))}return Option.none()},alt=function(o1,o2){return o1.isSome()?o1:o2},resolvePaths=function(dom,bookmark){var rng=dom.createRng();return setEndPoint(dom,!0,bookmark,rng)&&setEndPoint(dom,!1,bookmark,rng)?Option.some(rng):Option.none()},resolveId=function(dom,bookmark){var startPos=restoreEndPoint(dom,"start",bookmark),endPos=restoreEndPoint(dom,"end",bookmark);return $_b8twwq26jh8lywmm.liftN([startPos,alt(endPos,startPos)],function(spos,epos){var rng=dom.createRng();return rng.setStart(addBogus(dom,spos.container()),spos.offset()),rng.setEnd(addBogus(dom,epos.container()),epos.offset()),rng})},resolveIndex$1=function(dom,bookmark){return Option.from(dom.select(bookmark.name)[bookmark.index]).map(function(elm){var rng=dom.createRng();return rng.selectNode(elm),rng})},resolve$3=function(selection,bookmark){var dom=selection.dom;if(bookmark){if(isPathBookmark(bookmark))return resolvePaths(dom,bookmark);if(isStringPathBookmark(bookmark))return Option.some(resolveCaretPositionBookmark(dom,bookmark));if(isIdBookmark(bookmark))return resolveId(dom,bookmark);if(isIndexBookmark(bookmark))return resolveIndex$1(dom,bookmark);if(isRangeBookmark(bookmark))return Option.some(bookmark.rng)}return Option.none()},$_bncspc2qjh8lywq4={resolve:resolve$3},getBookmark$1=function(selection,type,normalized){return $_8b82yg2ojh8lywpq.getBookmark(selection,type,normalized)},moveToBookmark=function(selection,bookmark){$_bncspc2qjh8lywq4.resolve(selection,bookmark).each(function(rng){selection.setRng(rng)})},isBookmarkNode$1=function(node){return $_5oonaz1qjh8lywhz.isElement(node)&&"SPAN"===node.tagName&&"bookmark"===node.getAttribute("data-mce-type")},$_eyp5ec2njh8lywpo={getBookmark:getBookmark$1,moveToBookmark:moveToBookmark,isBookmarkNode:isBookmarkNode$1},each$8=$_ahowuxkjh8lywbj.each,ElementUtils=function(dom){this.compare=function(node1,node2){if(node1.nodeName!==node2.nodeName)return!1;var getAttribs=function(node){var attribs={};return each$8(dom.getAttribs(node),function(attr){var name=attr.nodeName.toLowerCase();0!==name.indexOf("_")&&"style"!==name&&0!==name.indexOf("data-")&&(attribs[name]=dom.getAttrib(node,name))}),attribs},compareObjects=function(obj1,obj2){var value,name;for(name in obj1)if(obj1.hasOwnProperty(name)){if(value=obj2[name],"undefined"==typeof value)return!1;if(obj1[name]!==value)return!1;delete obj2[name]}for(name in obj2)if(obj2.hasOwnProperty(name))return!1;return!0};return!!compareObjects(getAttribs(node1),getAttribs(node2))&&(!!compareObjects(dom.parseStyle(dom.getAttrib(node1,"style")),dom.parseStyle(dom.getAttrib(node2,"style")))&&(!$_eyp5ec2njh8lywpo.isBookmarkNode(node1)&&!$_eyp5ec2njh8lywpo.isBookmarkNode(node2)))}},before$2=function(marker,elements){$_5wjzy24jh8lyw2t.each(elements,function(x){$_4m7u2e2kjh8lywpi.before(marker,x)})},after$2=function(marker,elements){$_5wjzy24jh8lyw2t.each(elements,function(x,i){var e=0===i?marker:elements[i-1];$_4m7u2e2kjh8lywpi.after(e,x)})},prepend$1=function(parent,elements){
$_5wjzy24jh8lyw2t.each(elements.slice().reverse(),function(x){$_4m7u2e2kjh8lywpi.prepend(parent,x)})},append$1=function(parent,elements){$_5wjzy24jh8lyw2t.each(elements,function(x){$_4m7u2e2kjh8lywpi.append(parent,x)})},$_9hl8mu2vjh8lywr4={before:before$2,after:after$2,prepend:prepend$1,append:append$1},empty=function(element){element.dom().textContent="",$_5wjzy24jh8lyw2t.each($_a43q0i17jh8lywfe.children(element),function(rogue){remove$3(rogue)})},remove$3=function(element){var dom=element.dom();null!==dom.parentNode&&dom.parentNode.removeChild(dom)},unwrap=function(wrapper){var children=$_a43q0i17jh8lywfe.children(wrapper);children.length>0&&$_9hl8mu2vjh8lywr4.before(wrapper,children),remove$3(wrapper)},$_bfmuql2ujh8lywr1={empty:empty,remove:remove$3,unwrap:unwrap},api=NodeValue($_7j1jt210jh8lywdx.isText,"text"),get$2=function(element){return api.get(element)},getOption=function(element){return api.getOption(element)},set$2=function(element,value){api.set(element,value)},$_lh5l42wjh8lywr8={get:get$2,getOption:getOption,set:set$2},getLastChildren=function(elm){for(var children=[],rawNode=elm.dom();rawNode;)children.push($_cgttw3zjh8lywdq.fromDom(rawNode)),rawNode=rawNode.lastChild;return children},removeTrailingBr=function(elm){var allBrs=$_eebxu2gjh8lywp3.descendants(elm,"br"),brs=$_5wjzy24jh8lyw2t.filter(getLastChildren(elm).slice(-1),isBr);allBrs.length===brs.length&&$_5wjzy24jh8lyw2t.each(brs,$_bfmuql2ujh8lywr1.remove)},fillWithPaddingBr=function(elm){$_bfmuql2ujh8lywr1.empty(elm),$_4m7u2e2kjh8lywpi.append(elm,$_cgttw3zjh8lywdq.fromHtml('<br data-mce-bogus="1">'))},isPaddingContents=function(elm){return $_7j1jt210jh8lywdx.isText(elm)?" "===$_lh5l42wjh8lywr8.get(elm):isBr(elm)},isPaddedElement=function(elm){return 1===$_5wjzy24jh8lyw2t.filter($_a43q0i17jh8lywfe.children(elm),isPaddingContents).length},trimBlockTrailingBr=function(elm){$_a43q0i17jh8lywfe.lastChild(elm).each(function(lastChild){$_a43q0i17jh8lywfe.prevSibling(lastChild).each(function(lastChildPrevSibling){isBlock(elm)&&isBr(lastChild)&&isBlock(lastChildPrevSibling)&&$_bfmuql2ujh8lywr1.remove(lastChild)})})},$_2bvsfb2tjh8lywqo={removeTrailingBr:removeTrailingBr,fillWithPaddingBr:fillWithPaddingBr,isPaddedElement:isPaddedElement,trimBlockTrailingBr:trimBlockTrailingBr},makeMap$3=$_ahowuxkjh8lywbj.makeMap,createRange$1=function(sc,so,ec,eo){var rng=document.createRange();return rng.setStart(sc,so),rng.setEnd(ec,eo),rng},normalizeBlockSelectionRange=function(rng){var startPos=CaretPosition$1.fromRangeStart(rng),endPos=CaretPosition$1.fromRangeEnd(rng),rootNode=rng.commonAncestorContainer;return $_9kvypj2cjh8lywnz.fromPosition(!1,rootNode,endPos).map(function(newEndPos){return!isInSameBlock(startPos,endPos,rootNode)&&isInSameBlock(startPos,newEndPos,rootNode)?createRange$1(startPos.container(),startPos.offset(),newEndPos.container(),newEndPos.offset()):rng}).getOr(rng)},normalize=function(rng){return rng.collapsed?rng:normalizeBlockSelectionRange(rng)},$_cnbluh30jh8lywrn={normalize:normalize},isTableCell$2=$_5oonaz1qjh8lywhz.matchNodeNames("td th"),validInsertion=function(editor,value,parentNode){if("all"===parentNode.getAttribute("data-mce-bogus"))parentNode.parentNode.insertBefore(editor.dom.createFragment(value),parentNode);else{var node=parentNode.firstChild,node2=parentNode.lastChild;!node||node===node2&&"BR"===node.nodeName?editor.dom.setHTML(parentNode,value):editor.selection.setContent(value)}},trimBrsFromTableCell=function(dom,elm){Option.from(dom.getParent(elm,"td,th")).map($_cgttw3zjh8lywdq.fromDom).each($_2bvsfb2tjh8lywqo.trimBlockTrailingBr)},insertHtmlAtCaret=function(editor,value,details){var parser,serializer,parentNode,rootNode,fragment,args,marker,rng,node,node2,bookmarkHtml,merge,textInlineElements=editor.schema.getTextInlineElements(),selection=editor.selection,dom=editor.dom,trimOrPaddLeftRight=function(html){var rng,container,offset;rng=selection.getRng(),container=rng.startContainer,offset=rng.startOffset;var hasSiblingText=function(siblingName){return container[siblingName]&&3===container[siblingName].nodeType};return 3===container.nodeType&&(offset>0?html=html.replace(/^&nbsp;/," "):hasSiblingText("previousSibling")||(html=html.replace(/^ /,"&nbsp;")),offset<container.length?html=html.replace(/&nbsp;(<br>|)$/," "):hasSiblingText("nextSibling")||(html=html.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;"))),html},trimNbspAfterDeleteAndPaddValue=function(){var rng,container,offset;rng=selection.getRng(),container=rng.startContainer,offset=rng.startOffset,3===container.nodeType&&rng.collapsed&&(" "===container.data[offset]?(container.deleteData(offset,1),/[\u00a0| ]$/.test(value)||(value+=" ")):" "===container.data[offset-1]&&(container.deleteData(offset-1,1),/[\u00a0| ]$/.test(value)||(value=" "+value)))},reduceInlineTextElements=function(){if(merge){var root_1=editor.getBody(),elementUtils_1=new ElementUtils(dom);$_ahowuxkjh8lywbj.each(dom.select("*[data-mce-fragment]"),function(node){for(var testNode=node.parentNode;testNode&&testNode!==root_1;testNode=testNode.parentNode)textInlineElements[node.nodeName.toLowerCase()]&&elementUtils_1.compare(testNode,node)&&dom.remove(node,!0)})}},markFragmentElements=function(fragment){for(var node=fragment;node=node.walk();)1===node.type&&node.attr("data-mce-fragment","1")},umarkFragmentElements=function(elm){$_ahowuxkjh8lywbj.each(elm.getElementsByTagName("*"),function(elm){elm.removeAttribute("data-mce-fragment")})},isPartOfFragment=function(node){return!!node.getAttribute("data-mce-fragment")},canHaveChildren=function(node){return node&&!editor.schema.getShortEndedElements()[node.nodeName]},moveSelectionToMarker=function(marker){var parentEditableFalseElm,parentBlock,nextRng,getContentEditableFalseParent=function(node){for(var root=editor.getBody();node&&node!==root;node=node.parentNode)if("false"===editor.dom.getContentEditable(node))return node;return null};if(marker){if(selection.scrollIntoView(marker),parentEditableFalseElm=getContentEditableFalseParent(marker))return dom.remove(marker),void selection.select(parentEditableFalseElm);rng=dom.createRng(),node=marker.previousSibling,node&&3===node.nodeType?(rng.setStart(node,node.nodeValue.length),$_9bpim8ajh8lyw68.ie||(node2=marker.nextSibling,node2&&3===node2.nodeType&&(node.appendData(node2.data),node2.parentNode.removeChild(node2)))):(rng.setStartBefore(marker),rng.setEndBefore(marker));var findNextCaretRng=function(rng){var caretPos=CaretPosition$1.fromRangeStart(rng),caretWalker=CaretWalker(editor.getBody());if(caretPos=caretWalker.next(caretPos))return caretPos.toRange()};parentBlock=dom.getParent(marker,dom.isBlock),dom.remove(marker),parentBlock&&dom.isEmpty(parentBlock)&&(editor.$(parentBlock).empty(),rng.setStart(parentBlock,0),rng.setEnd(parentBlock,0),isTableCell$2(parentBlock)||isPartOfFragment(parentBlock)||!(nextRng=findNextCaretRng(rng))?dom.add(parentBlock,dom.create("br",{"data-mce-bogus":"1"})):(rng=nextRng,dom.remove(parentBlock))),selection.setRng(rng)}};if(/^ | $/.test(value)&&(value=trimOrPaddLeftRight(value)),parser=editor.parser,merge=details.merge,serializer=HtmlSerializer({validate:editor.settings.validate},editor.schema),bookmarkHtml='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>',args={content:value,format:"html",selection:!0,paste:details.paste},args=editor.fire("BeforeSetContent",args),args.isDefaultPrevented())return void editor.fire("SetContent",{content:args.content,format:"html",selection:!0,paste:details.paste});value=args.content,value.indexOf("{$caret}")===-1&&(value+="{$caret}"),value=value.replace(/\{\$caret\}/,bookmarkHtml),rng=selection.getRng();var caretElement=rng.startContainer||(rng.parentElement?rng.parentElement():null),body=editor.getBody();caretElement===body&&selection.isCollapsed()&&dom.isBlock(body.firstChild)&&canHaveChildren(body.firstChild)&&dom.isEmpty(body.firstChild)&&(rng=dom.createRng(),rng.setStart(body.firstChild,0),rng.setEnd(body.firstChild,0),selection.setRng(rng)),selection.isCollapsed()||(editor.selection.setRng($_cnbluh30jh8lywrn.normalize(editor.selection.getRng())),editor.getDoc().execCommand("Delete",!1,null),trimNbspAfterDeleteAndPaddValue()),parentNode=selection.getNode();var parserArgs={context:parentNode.nodeName.toLowerCase(),data:details.data,insert:!0};if(fragment=parser.parse(value,parserArgs),details.paste===!0&&$_eajoh11xjh8lywl6.isListFragment(editor.schema,fragment)&&$_eajoh11xjh8lywl6.isParentBlockLi(dom,parentNode))return rng=$_eajoh11xjh8lywl6.insertAtCaret(serializer,dom,editor.selection.getRng(),fragment),editor.selection.setRng(rng),void editor.fire("SetContent",args);if(markFragmentElements(fragment),node=fragment.lastChild,"mce_marker"===node.attr("id"))for(marker=node,node=node.prev;node;node=node.walk(!0))if(3===node.type||!dom.isBlock(node.name)){editor.schema.isValidChild(node.parent.name,"span")&&node.parent.insert(marker,node,"br"===node.name);break}if(editor._selectionOverrides.showBlockCaretContainer(parentNode),parserArgs.invalid){for(selection.setContent(bookmarkHtml),parentNode=selection.getNode(),rootNode=editor.getBody(),9===parentNode.nodeType?parentNode=node=rootNode:node=parentNode;node!==rootNode;)parentNode=node,node=node.parentNode;value=parentNode===rootNode?rootNode.innerHTML:dom.getOuterHTML(parentNode),value=serializer.serialize(parser.parse(value.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return serializer.serialize(fragment)}))),parentNode===rootNode?dom.setHTML(rootNode,value):dom.setOuterHTML(parentNode,value)}else value=serializer.serialize(fragment),validInsertion(editor,value,parentNode);reduceInlineTextElements(),moveSelectionToMarker(dom.get("mce_marker")),umarkFragmentElements(editor.getBody()),trimBrsFromTableCell(editor.dom,editor.selection.getStart()),editor.fire("SetContent",args),editor.addVisual()},processValue=function(value){var details;return"string"!=typeof value?(details=$_ahowuxkjh8lywbj.extend({paste:value.paste,data:{paste:value.paste}},value),{content:value.content,details:details}):{content:value,details:{}}},insertAtCaret$1=function(editor,value){var result=processValue(value);insertHtmlAtCaret(editor,result.content,result.details)},$_13xltl1wjh8lywkr={insertAtCaret:insertAtCaret$1},first$1=function(predicate){return descendant($_boa99a15jh8lywey.body(),predicate)},ancestor=function(scope,predicate,isRoot){for(var element=scope.dom(),stop=$_dp4g6d7jh8lyw3y.isFunction(isRoot)?isRoot:$_eqpqvr6jh8lyw3s.constant(!1);element.parentNode;){element=element.parentNode;var el=$_cgttw3zjh8lywdq.fromDom(element);if(predicate(el))return Option.some(el);if(stop(el))break}return Option.none()},closest=function(scope,predicate,isRoot){var is=function(scope){return predicate(scope)};return ClosestOrAncestor(is,ancestor,scope,predicate,isRoot)},sibling$1=function(scope,predicate){var element=scope.dom();return element.parentNode?child$1($_cgttw3zjh8lywdq.fromDom(element.parentNode),function(x){return!$_5f6gpb1djh8lywg5.eq(scope,x)&&predicate(x)}):Option.none()},child$1=function(scope,predicate){var result=$_5wjzy24jh8lyw2t.find(scope.dom().childNodes,$_eqpqvr6jh8lyw3s.compose(predicate,$_cgttw3zjh8lywdq.fromDom));return result.map($_cgttw3zjh8lywdq.fromDom)},descendant=function(scope,predicate){var descend=function(element){for(var i=0;i<element.childNodes.length;i++){if(predicate($_cgttw3zjh8lywdq.fromDom(element.childNodes[i])))return Option.some($_cgttw3zjh8lywdq.fromDom(element.childNodes[i]));var res=descend(element.childNodes[i]);if(res.isSome())return res}return Option.none()};return descend(scope.dom())},$_6hl03835jh8lywsm={first:first$1,ancestor:ancestor,closest:closest,sibling:sibling$1,child:child$1,descendant:descendant},sectionResult=$_4jz0ce18jh8lywft.immutable("sections","settings"),detection=$_9hkktfnjh8lywc6.detect(),isTouch=detection.deviceType.isTouch(),mobilePlugins=["lists","autolink","autosave"],defaultMobileSettings={theme:"mobile"},normalizePlugins=function(plugins){var pluginNames=$_dp4g6d7jh8lyw3y.isArray(plugins)?plugins.join(" "):plugins,trimmedPlugins=$_5wjzy24jh8lyw2t.map($_dp4g6d7jh8lyw3y.isString(pluginNames)?pluginNames.split(" "):[],$_4w196awjh8lywdj.trim);return $_5wjzy24jh8lyw2t.filter(trimmedPlugins,function(item){return item.length>0})},filterMobilePlugins=function(plugins){return $_5wjzy24jh8lyw2t.filter(plugins,$_eqpqvr6jh8lyw3s.curry($_5wjzy24jh8lyw2t.contains,mobilePlugins))},extractSections=function(keys,settings){var result=$_g63v2c13jh8lywej.bifilter(settings,function(value,key){return $_5wjzy24jh8lyw2t.contains(keys,key)});return sectionResult(result.t,result.f)},getSection=function(sectionResult,name,defaults){var sections=sectionResult.sections(),sectionSettings=sections.hasOwnProperty(name)?sections[name]:{};return $_ahowuxkjh8lywbj.extend({},defaults,sectionSettings)},hasSection=function(sectionResult,name){return sectionResult.sections().hasOwnProperty(name)},getDefaultSettings=function(id,documentBaseUrl,editor){return{id:id,theme:"modern",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:documentBaseUrl,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,render_ui:!0,indentation:"30px",inline_styles:!0,convert_fonts_to_spans:!0,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:editor.convertURL,url_converter_scope:editor,ie7_compat:!0}},getExternalPlugins=function(overrideSettings,settings){var userDefinedExternalPlugins=settings.external_plugins?settings.external_plugins:{};return overrideSettings&&overrideSettings.external_plugins?$_ahowuxkjh8lywbj.extend({},overrideSettings.external_plugins,userDefinedExternalPlugins):userDefinedExternalPlugins},combinePlugins=function(forcedPlugins,plugins){return[].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins))},processPlugins=function(isTouchDevice,sectionResult,defaultOverrideSettings,settings){var forcedPlugins=normalizePlugins(defaultOverrideSettings.forced_plugins),plugins=normalizePlugins(settings.plugins),platformPlugins=isTouchDevice&&hasSection(sectionResult,"mobile")?filterMobilePlugins(plugins):plugins,combinedPlugins=combinePlugins(forcedPlugins,platformPlugins);return $_ahowuxkjh8lywbj.extend(settings,{plugins:combinedPlugins.join(" ")})},isOnMobile=function(isTouchDevice,sectionResult){var isInline=sectionResult.settings().inline;return isTouchDevice&&hasSection(sectionResult,"mobile")&&!isInline},combineSettings=function(isTouchDevice,defaultSettings,defaultOverrideSettings,settings){var sectionResult=extractSections(["mobile"],settings),extendedSettings=$_ahowuxkjh8lywbj.extend(defaultSettings,defaultOverrideSettings,sectionResult.settings(),isOnMobile(isTouchDevice,sectionResult)?getSection(sectionResult,"mobile",defaultMobileSettings):{},{validate:!0,content_editable:sectionResult.settings().inline,external_plugins:getExternalPlugins(defaultOverrideSettings,sectionResult.settings())});return processPlugins(isTouchDevice,sectionResult,defaultOverrideSettings,extendedSettings)},getEditorSettings=function(editor,id,documentBaseUrl,defaultOverrideSettings,settings){var defaultSettings=getDefaultSettings(id,documentBaseUrl,editor);return combineSettings(isTouch,defaultSettings,defaultOverrideSettings,settings)},getFiltered=function(predicate,editor,name){return Option.from(editor.settings[name]).filter(predicate)},getString=$_eqpqvr6jh8lyw3s.curry(getFiltered,$_dp4g6d7jh8lyw3y.isString),getParamObject=function(value){var output={};return"string"==typeof value?$_5wjzy24jh8lyw2t.each(value.indexOf("=")>0?value.split(/[;,](?![^=;,]*(?:[;,]|$))/):value.split(","),function(val){var arr=val.split("=");arr.length>1?output[$_ahowuxkjh8lywbj.trim(arr[0])]=$_ahowuxkjh8lywbj.trim(arr[1]):output[$_ahowuxkjh8lywbj.trim(arr[0])]=$_ahowuxkjh8lywbj.trim(arr)}):output=value,output},isArrayOf=function(p){return function(a){return $_dp4g6d7jh8lyw3y.isArray(a)&&$_5wjzy24jh8lyw2t.forall(a,p)}},getParam=function(editor,name,defaultVal,type){var value=name in editor.settings?editor.settings[name]:defaultVal;return"hash"===type?getParamObject(value):"string"===type?getFiltered($_dp4g6d7jh8lyw3y.isString,editor,name).getOr(defaultVal):"number"===type?getFiltered($_dp4g6d7jh8lyw3y.isNumber,editor,name).getOr(defaultVal):"boolean"===type?getFiltered($_dp4g6d7jh8lyw3y.isBoolean,editor,name).getOr(defaultVal):"object"===type?getFiltered($_dp4g6d7jh8lyw3y.isObject,editor,name).getOr(defaultVal):"array"===type?getFiltered($_dp4g6d7jh8lyw3y.isArray,editor,name).getOr(defaultVal):"string[]"===type?getFiltered(isArrayOf($_dp4g6d7jh8lyw3y.isString),editor,name).getOr(defaultVal):"function"===type?getFiltered($_dp4g6d7jh8lyw3y.isFunction,editor,name).getOr(defaultVal):value},strongRtl=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,hasStrongRtl=function(text){return strongRtl.test(text)},isInlineTarget=function(editor,elm){var selector=getString(editor,"inline_boundaries_selector").getOr("a[href],code");return $_5h4ipt1fjh8lywgi.is($_cgttw3zjh8lywdq.fromDom(elm),selector)},isRtl=function(element){return"rtl"===DOMUtils$1.DOM.getStyle(element,"direction",!0)||hasStrongRtl(element.textContent)},findInlineParents=function(isInlineTarget,rootNode,pos){return $_5wjzy24jh8lyw2t.filter(DOMUtils$1.DOM.getParents(pos.container(),"*",rootNode),isInlineTarget)},findRootInline=function(isInlineTarget,rootNode,pos){var parents=findInlineParents(isInlineTarget,rootNode,pos);return Option.from(parents[parents.length-1])},hasSameParentBlock=function(rootNode,node1,node2){var block1=getParentBlock(node1,rootNode),block2=getParentBlock(node2,rootNode);return block1&&block1===block2},isAtZwsp=function(pos){return isBeforeInline(pos)||isAfterInline(pos)},normalizePosition=function(forward,pos){var container=pos.container(),offset=pos.offset();return forward?isCaretContainerInline(container)?$_5oonaz1qjh8lywhz.isText(container.nextSibling)?CaretPosition$1(container.nextSibling,0):CaretPosition$1.after(container):isBeforeInline(pos)?CaretPosition$1(container,offset+1):pos:isCaretContainerInline(container)?$_5oonaz1qjh8lywhz.isText(container.previousSibling)?CaretPosition$1(container.previousSibling,container.previousSibling.data.length):CaretPosition$1.before(container):isAfterInline(pos)?CaretPosition$1(container,offset-1):pos},normalizeForwards=$_eqpqvr6jh8lyw3s.curry(normalizePosition,!0),normalizeBackwards=$_eqpqvr6jh8lyw3s.curry(normalizePosition,!1),$_231v7s37jh8lywt3={isInlineTarget:isInlineTarget,findRootInline:findRootInline,isRtl:isRtl,isAtZwsp:isAtZwsp,normalizePosition:normalizePosition,normalizeForwards:normalizeForwards,normalizeBackwards:normalizeBackwards,hasSameParentBlock:hasSameParentBlock},isBeforeRoot=function(rootNode){return function(elm){return $_5f6gpb1djh8lywg5.eq(rootNode,$_cgttw3zjh8lywdq.fromDom(elm.dom().parentNode))}},getParentBlock$1=function(rootNode,elm){return $_5f6gpb1djh8lywg5.contains(rootNode,elm)?$_6hl03835jh8lywsm.closest(elm,function(element){return isTextBlock(element)||isListItem(element)},isBeforeRoot(rootNode)):Option.none()},placeCaretInEmptyBody=function(editor){var body=editor.getBody(),node=body.firstChild&&editor.dom.isBlock(body.firstChild)?body.firstChild:body;editor.selection.setCursorLocation(node,0)},paddEmptyBody=function(editor){editor.dom.isEmpty(editor.getBody())&&(editor.setContent(""),placeCaretInEmptyBody(editor))},willDeleteLastPositionInElement=function(forward,fromPos,elm){return $_b8twwq26jh8lywmm.liftN([$_9kvypj2cjh8lywnz.firstPositionIn(elm),$_9kvypj2cjh8lywnz.lastPositionIn(elm)],function(firstPos,lastPos){var normalizedFirstPos=$_231v7s37jh8lywt3.normalizePosition(!0,firstPos),normalizedLastPos=$_231v7s37jh8lywt3.normalizePosition(!1,lastPos),normalizedFromPos=$_231v7s37jh8lywt3.normalizePosition(!1,fromPos);return forward?$_9kvypj2cjh8lywnz.nextPosition(elm,normalizedFromPos).map(function(nextPos){return nextPos.isEqual(normalizedLastPos)&&fromPos.isEqual(normalizedFirstPos)}).getOr(!1):$_9kvypj2cjh8lywnz.prevPosition(elm,normalizedFromPos).map(function(prevPos){return prevPos.isEqual(normalizedFirstPos)&&fromPos.isEqual(normalizedLastPos)}).getOr(!1)}).getOr(!0)},$_aj8isd34jh8lyws4={getParentBlock:getParentBlock$1,paddEmptyBody:paddEmptyBody,willDeleteLastPositionInElement:willDeleteLastPositionInElement},first$2=function(selector){return $_5h4ipt1fjh8lywgi.one(selector)},ancestor$1=function(scope,selector,isRoot){return $_6hl03835jh8lywsm.ancestor(scope,function(e){return $_5h4ipt1fjh8lywgi.is(e,selector)},isRoot)},sibling$2=function(scope,selector){return $_6hl03835jh8lywsm.sibling(scope,function(e){return $_5h4ipt1fjh8lywgi.is(e,selector)})},child$2=function(scope,selector){return $_6hl03835jh8lywsm.child(scope,function(e){return $_5h4ipt1fjh8lywgi.is(e,selector)})},descendant$1=function(scope,selector){return $_5h4ipt1fjh8lywgi.one(selector,scope)},closest$1=function(scope,selector,isRoot){return ClosestOrAncestor($_5h4ipt1fjh8lywgi.is,ancestor$1,scope,selector,isRoot)},$_7sg18r3cjh8lywu1={first:first$2,ancestor:ancestor$1,sibling:sibling$2,child:child$2,descendant:descendant$1,closest:closest$1},any=function(selector){return $_7sg18r3cjh8lywu1.first(selector).isSome()},ancestor$2=function(scope,selector,isRoot){return $_7sg18r3cjh8lywu1.ancestor(scope,selector,isRoot).isSome()},sibling$3=function(scope,selector){return $_7sg18r3cjh8lywu1.sibling(scope,selector).isSome()},child$3=function(scope,selector){return $_7sg18r3cjh8lywu1.child(scope,selector).isSome()},descendant$2=function(scope,selector){return $_7sg18r3cjh8lywu1.descendant(scope,selector).isSome()},closest$2=function(scope,selector,isRoot){return $_7sg18r3cjh8lywu1.closest(scope,selector,isRoot).isSome()},$_8b29ae3bjh8lywu0={any:any,ancestor:ancestor$2,sibling:sibling$3,child:child$3,descendant:descendant$2,closest:closest$2},hasWhitespacePreserveParent=function(rootNode,node){var rootElement=$_cgttw3zjh8lywdq.fromDom(rootNode),startNode=$_cgttw3zjh8lywdq.fromDom(node);return $_8b29ae3bjh8lywu0.ancestor(startNode,"pre,code",$_eqpqvr6jh8lyw3s.curry($_5f6gpb1djh8lywg5.eq,rootElement))},isWhitespace=function(rootNode,node){return $_5oonaz1qjh8lywhz.isText(node)&&/^[ \t\r\n]*$/.test(node.data)&&hasWhitespacePreserveParent(rootNode,node)===!1},isNamedAnchor=function(node){return $_5oonaz1qjh8lywhz.isElement(node)&&"A"===node.nodeName&&node.hasAttribute("name")},isContent=function(rootNode,node){return isCaretCandidate(node)&&isWhitespace(rootNode,node)===!1||isNamedAnchor(node)||isBookmark(node)},isBookmark=$_5oonaz1qjh8lywhz.hasAttribute("data-mce-bookmark"),isBogus$2=$_5oonaz1qjh8lywhz.hasAttribute("data-mce-bogus"),isBogusAll$1=$_5oonaz1qjh8lywhz.hasAttributeValue("data-mce-bogus","all"),isEmptyNode=function(targetNode){var walker,node,brCount=0;if(isContent(targetNode,targetNode))return!1;if(node=targetNode.firstChild,!node)return!0;walker=new TreeWalker(node,targetNode);do if(isBogusAll$1(node))node=walker.next(!0);else if(isBogus$2(node))node=walker.next();else if($_5oonaz1qjh8lywhz.isBr(node))brCount++,node=walker.next();else{if(isContent(targetNode,node))return!1;node=walker.next()}while(node);return brCount<=1},isEmpty$1=function(elm){return isEmptyNode(elm.dom())},$_b1urh33ajh8lywts={isEmpty:isEmpty$1},BlockPosition=$_4jz0ce18jh8lywft.immutable("block","position"),BlockBoundary=$_4jz0ce18jh8lywft.immutable("from","to"),getBlockPosition=function(rootNode,pos){var rootElm=$_cgttw3zjh8lywdq.fromDom(rootNode),containerElm=$_cgttw3zjh8lywdq.fromDom(pos.container());return $_aj8isd34jh8lyws4.getParentBlock(rootElm,containerElm).map(function(block){return BlockPosition(block,pos)})},isDifferentBlocks=function(blockBoundary){return $_5f6gpb1djh8lywg5.eq(blockBoundary.from().block(),blockBoundary.to().block())===!1},hasSameParent=function(blockBoundary){return $_a43q0i17jh8lywfe.parent(blockBoundary.from().block()).bind(function(parent1){return $_a43q0i17jh8lywfe.parent(blockBoundary.to().block()).filter(function(parent2){return $_5f6gpb1djh8lywg5.eq(parent1,parent2)})}).isSome()},isEditable=function(blockBoundary){return $_5oonaz1qjh8lywhz.isContentEditableFalse(blockBoundary.from().block())===!1&&$_5oonaz1qjh8lywhz.isContentEditableFalse(blockBoundary.to().block())===!1},skipLastBr=function(rootNode,forward,blockPosition){return $_5oonaz1qjh8lywhz.isBr(blockPosition.position().getNode())&&$_b1urh33ajh8lywts.isEmpty(blockPosition.block())===!1?$_9kvypj2cjh8lywnz.positionIn(!1,blockPosition.block().dom()).bind(function(lastPositionInBlock){return lastPositionInBlock.isEqual(blockPosition.position())?$_9kvypj2cjh8lywnz.fromPosition(forward,rootNode,lastPositionInBlock).bind(function(to){return getBlockPosition(rootNode,to)}):Option.some(blockPosition)}).getOr(blockPosition):blockPosition},readFromRange=function(rootNode,forward,rng){var fromBlockPos=getBlockPosition(rootNode,CaretPosition$1.fromRangeStart(rng)),toBlockPos=fromBlockPos.bind(function(blockPos){return $_9kvypj2cjh8lywnz.fromPosition(forward,rootNode,blockPos.position()).bind(function(to){return getBlockPosition(rootNode,to).map(function(blockPos){return skipLastBr(rootNode,forward,blockPos)})})});return $_b8twwq26jh8lywmm.liftN([fromBlockPos,toBlockPos],BlockBoundary).filter(function(blockBoundary){return isDifferentBlocks(blockBoundary)&&hasSameParent(blockBoundary)&&isEditable(blockBoundary)})},read=function(rootNode,forward,rng){return rng.collapsed?readFromRange(rootNode,forward,rng):Option.none()},$_bmbex333jh8lywru={read:read},dropLast=function(xs){return xs.slice(0,-1)},parentsUntil$1=function(startNode,rootElm,predicate){return $_5f6gpb1djh8lywg5.contains(rootElm,startNode)?dropLast($_a43q0i17jh8lywfe.parents(startNode,function(elm){return predicate(elm)||$_5f6gpb1djh8lywg5.eq(elm,rootElm)})):[]},parents$1=function(startNode,rootElm){return parentsUntil$1(startNode,rootElm,$_eqpqvr6jh8lyw3s.constant(!1))},parentsAndSelf=function(startNode,rootElm){return[startNode].concat(parents$1(startNode,rootElm))},$_dyxtub3ejh8lywxq={parentsUntil:parentsUntil$1,parents:parents$1,parentsAndSelf:parentsAndSelf},getChildrenUntilBlockBoundary=function(block){var children=$_a43q0i17jh8lywfe.children(block);return $_5wjzy24jh8lyw2t.findIndex(children,isBlock).fold(function(){return children},function(index){return children.slice(0,index)})},extractChildren=function(block){var children=getChildrenUntilBlockBoundary(block);return $_5wjzy24jh8lyw2t.each(children,function(node){$_bfmuql2ujh8lywr1.remove(node)}),children},trimBr=function(first,block){$_9kvypj2cjh8lywnz.positionIn(first,block.dom()).each(function(position){var node=position.getNode();$_5oonaz1qjh8lywhz.isBr(node)&&$_bfmuql2ujh8lywr1.remove($_cgttw3zjh8lywdq.fromDom(node))})},removeEmptyRoot=function(rootNode,block){var parents=$_dyxtub3ejh8lywxq.parentsAndSelf(block,rootNode);return $_5wjzy24jh8lyw2t.find(parents.reverse(),$_b1urh33ajh8lywts.isEmpty).each($_bfmuql2ujh8lywr1.remove)},findParentInsertPoint=function(toBlock,block){var parents=$_a43q0i17jh8lywfe.parents(block,function(elm){return $_5f6gpb1djh8lywg5.eq(elm,toBlock)});return Option.from(parents[parents.length-2])},getInsertionPoint=function(fromBlock,toBlock){return $_5f6gpb1djh8lywg5.contains(toBlock,fromBlock)?$_a43q0i17jh8lywfe.parent(fromBlock).bind(function(parent){return $_5f6gpb1djh8lywg5.eq(parent,toBlock)?Option.some(fromBlock):findParentInsertPoint(toBlock,fromBlock)}):Option.none()},mergeBlockInto=function(rootNode,fromBlock,toBlock){if($_b1urh33ajh8lywts.isEmpty(toBlock))return $_bfmuql2ujh8lywr1.remove(toBlock),$_b1urh33ajh8lywts.isEmpty(fromBlock)&&$_2bvsfb2tjh8lywqo.fillWithPaddingBr(fromBlock),$_9kvypj2cjh8lywnz.firstPositionIn(fromBlock.dom());trimBr(!0,fromBlock),trimBr(!1,toBlock);var children_1=extractChildren(fromBlock);return getInsertionPoint(fromBlock,toBlock).fold(function(){removeEmptyRoot(rootNode,fromBlock);var position=$_9kvypj2cjh8lywnz.lastPositionIn(toBlock.dom());return $_5wjzy24jh8lyw2t.each(children_1,function(node){$_4m7u2e2kjh8lywpi.append(toBlock,node)}),position},function(target){var position=$_9kvypj2cjh8lywnz.prevPosition(toBlock.dom(),CaretPosition$1.before(target.dom()));return $_5wjzy24jh8lyw2t.each(children_1,function(node){$_4m7u2e2kjh8lywpi.before(target,node)}),removeEmptyRoot(rootNode,fromBlock),position})},mergeBlocks=function(rootNode,forward,block1,block2){return forward?mergeBlockInto(rootNode,block2,block1):mergeBlockInto(rootNode,block1,block2)},$_4yurvx3djh8lywu4={mergeBlocks:mergeBlocks},backspaceDelete=function(editor,forward){var position,rootNode=$_cgttw3zjh8lywdq.fromDom(editor.getBody());return position=$_bmbex333jh8lywru.read(rootNode.dom(),forward,editor.selection.getRng()).bind(function(blockBoundary){return $_4yurvx3djh8lywu4.mergeBlocks(rootNode,forward,blockBoundary.from().block(),blockBoundary.to().block())}),position.each(function(pos){editor.selection.setRng(pos.toRange())}),position.isSome()},$_5jmwsv32jh8lywrr={backspaceDelete:backspaceDelete},deleteRangeMergeBlocks=function(rootNode,selection){var rng=selection.getRng();return $_b8twwq26jh8lywmm.liftN([$_aj8isd34jh8lyws4.getParentBlock(rootNode,$_cgttw3zjh8lywdq.fromDom(rng.startContainer)),$_aj8isd34jh8lyws4.getParentBlock(rootNode,$_cgttw3zjh8lywdq.fromDom(rng.endContainer))],function(block1,block2){return $_5f6gpb1djh8lywg5.eq(block1,block2)===!1&&(rng.deleteContents(),$_4yurvx3djh8lywu4.mergeBlocks(rootNode,!0,block1,block2).each(function(pos){selection.setRng(pos.toRange())}),!0)}).getOr(!1)},isRawNodeInTable=function(root,rawNode){var node=$_cgttw3zjh8lywdq.fromDom(rawNode),isRoot=$_eqpqvr6jh8lyw3s.curry($_5f6gpb1djh8lywg5.eq,root);return $_6hl03835jh8lywsm.ancestor(node,isTableCell,isRoot).isSome()},isSelectionInTable=function(root,rng){return isRawNodeInTable(root,rng.startContainer)||isRawNodeInTable(root,rng.endContainer)},isEverythingSelected=function(root,rng){var noPrevious=$_9kvypj2cjh8lywnz.prevPosition(root.dom(),CaretPosition$1.fromRangeStart(rng)).isNone(),noNext=$_9kvypj2cjh8lywnz.nextPosition(root.dom(),CaretPosition$1.fromRangeEnd(rng)).isNone();return!isSelectionInTable(root,rng)&&noPrevious&&noNext},emptyEditor=function(editor){return editor.setContent(""),editor.selection.setCursorLocation(),!0},deleteRange=function(editor){var rootNode=$_cgttw3zjh8lywdq.fromDom(editor.getBody()),rng=editor.selection.getRng();return isEverythingSelected(rootNode,rng)?emptyEditor(editor):deleteRangeMergeBlocks(rootNode,editor.selection)},backspaceDelete$1=function(editor,forward){return!editor.selection.isCollapsed()&&deleteRange(editor)},$_lcy1p3fjh8lywxx={backspaceDelete:backspaceDelete$1},generate=function(cases){if(!$_dp4g6d7jh8lyw3y.isArray(cases))throw new Error("cases must be an array");if(0===cases.length)throw new Error("there must be at least one case");var constructors=[],adt={};return $_5wjzy24jh8lyw2t.each(cases,function(acase,count){var keys=$_g63v2c13jh8lywej.keys(acase);if(1!==keys.length)throw new Error("one and only one name per case");var key=keys[0],value=acase[key];if(void 0!==adt[key])throw new Error("duplicate key detected:"+key);if("cata"===key)throw new Error("cannot have a case named cata (sorry)");if(!$_dp4g6d7jh8lyw3y.isArray(value))throw new Error("case arguments must be an array");constructors.push(key),adt[key]=function(){var argLength=arguments.length;if(argLength!==value.length)throw new Error("Wrong number of arguments to case "+key+". Expected "+value.length+" ("+value+"), got "+argLength);
for(var args=new Array(argLength),i=0;i<args.length;i++)args[i]=arguments[i];var match=function(branches){var branchKeys=$_g63v2c13jh8lywej.keys(branches);if(constructors.length!==branchKeys.length)throw new Error("Wrong number of arguments to match. Expected: "+constructors.join(",")+"\nActual: "+branchKeys.join(","));var allReqd=$_5wjzy24jh8lyw2t.forall(constructors,function(reqKey){return $_5wjzy24jh8lyw2t.contains(branchKeys,reqKey)});if(!allReqd)throw new Error("Not all branches were specified when using match. Specified: "+branchKeys.join(", ")+"\nRequired: "+constructors.join(", "));return branches[key].apply(null,args)};return{fold:function(){if(arguments.length!==cases.length)throw new Error("Wrong number of arguments to fold. Expected "+cases.length+", got "+arguments.length);var target=arguments[count];return target.apply(null,args)},match:match,log:function(label){console.log(label,{constructors:constructors,constructor:key,params:args})}}}}),adt},$_1ml90g3ijh8lywyp={generate:generate},isCompoundElement=function(node){return isTableCell($_cgttw3zjh8lywdq.fromDom(node))||isListItem($_cgttw3zjh8lywdq.fromDom(node))},DeleteAction=$_1ml90g3ijh8lywyp.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),isAtContentEditableBlockCaret=function(forward,from){var elm=from.getNode(forward===!1),caretLocation=forward?"after":"before";return $_5oonaz1qjh8lywhz.isElement(elm)&&elm.getAttribute("data-mce-caret")===caretLocation},isDeleteFromCefDifferentBlocks=function(root,forward,from,to){var inSameBlock=function(elm){return isInline($_cgttw3zjh8lywdq.fromDom(elm))&&!isInSameBlock(from,to,root)};return getRelativeCefElm(!forward,from).fold(function(){return getRelativeCefElm(forward,to).fold($_eqpqvr6jh8lyw3s.constant(!1),inSameBlock)},inSameBlock)},deleteEmptyBlockOrMoveToCef=function(root,forward,from,to){var toCefElm=to.getNode(forward===!1);return $_aj8isd34jh8lyws4.getParentBlock($_cgttw3zjh8lywdq.fromDom(root),$_cgttw3zjh8lywdq.fromDom(from.getNode())).map(function(blockElm){return $_b1urh33ajh8lywts.isEmpty(blockElm)?DeleteAction.remove(blockElm.dom()):DeleteAction.moveToElement(toCefElm)}).orThunk(function(){return Option.some(DeleteAction.moveToElement(toCefElm))})},findCefPosition=function(root,forward,from){return $_9kvypj2cjh8lywnz.fromPosition(forward,root,from).bind(function(to){return isCompoundElement(to.getNode())?Option.none():isDeleteFromCefDifferentBlocks(root,forward,from,to)?Option.none():forward&&$_5oonaz1qjh8lywhz.isContentEditableFalse(to.getNode())?deleteEmptyBlockOrMoveToCef(root,forward,from,to):forward===!1&&$_5oonaz1qjh8lywhz.isContentEditableFalse(to.getNode(!0))?deleteEmptyBlockOrMoveToCef(root,forward,from,to):forward&&isAfterContentEditableFalse(from)?Option.some(DeleteAction.moveToPosition(to)):forward===!1&&isBeforeContentEditableFalse(from)?Option.some(DeleteAction.moveToPosition(to)):Option.none()})},getContentEditableBlockAction=function(forward,elm){return forward&&$_5oonaz1qjh8lywhz.isContentEditableFalse(elm.nextSibling)?Option.some(DeleteAction.moveToElement(elm.nextSibling)):forward===!1&&$_5oonaz1qjh8lywhz.isContentEditableFalse(elm.previousSibling)?Option.some(DeleteAction.moveToElement(elm.previousSibling)):Option.none()},skipMoveToActionFromInlineCefToContent=function(root,from,deleteAction){return deleteAction.fold(function(elm){return Option.some(DeleteAction.remove(elm))},function(elm){return Option.some(DeleteAction.moveToElement(elm))},function(to){return isInSameBlock(from,to,root)?Option.none():Option.some(DeleteAction.moveToPosition(to))})},getContentEditableAction=function(root,forward,from){return isAtContentEditableBlockCaret(forward,from)?getContentEditableBlockAction(forward,from.getNode(forward===!1)).fold(function(){return findCefPosition(root,forward,from)},Option.some):findCefPosition(root,forward,from).bind(function(deleteAction){return skipMoveToActionFromInlineCefToContent(root,from,deleteAction)})},read$1=function(root,forward,rng){var normalizedRange=normalizeRange(forward?1:-1,root,rng),from=CaretPosition$1.fromRangeStart(normalizedRange);return forward===!1&&isAfterContentEditableFalse(from)?Option.some(DeleteAction.remove(from.getNode(!0))):forward&&isBeforeContentEditableFalse(from)?Option.some(DeleteAction.remove(from.getNode())):getContentEditableAction(root,forward,from)},needsReposition=function(pos,elm){var container=pos.container(),offset=pos.offset();return CaretPosition$1.isTextPosition(pos)===!1&&container===elm.parentNode&&offset>CaretPosition$1.before(elm).offset()},reposition=function(elm,pos){return needsReposition(pos,elm)?CaretPosition$1(pos.container(),pos.offset()-1):pos},beforeOrStartOf=function(node){return $_5oonaz1qjh8lywhz.isText(node)?CaretPosition$1(node,0):CaretPosition$1.before(node)},afterOrEndOf=function(node){return $_5oonaz1qjh8lywhz.isText(node)?CaretPosition$1(node,node.data.length):CaretPosition$1.after(node)},getPreviousSiblingCaretPosition=function(elm){return isCaretCandidate(elm.previousSibling)?Option.some(afterOrEndOf(elm.previousSibling)):elm.previousSibling?$_9kvypj2cjh8lywnz.lastPositionIn(elm.previousSibling):Option.none()},getNextSiblingCaretPosition=function(elm){return isCaretCandidate(elm.nextSibling)?Option.some(beforeOrStartOf(elm.nextSibling)):elm.nextSibling?$_9kvypj2cjh8lywnz.firstPositionIn(elm.nextSibling):Option.none()},findCaretPositionBackwardsFromElm=function(rootElement,elm){var startPosition=CaretPosition$1.before(elm.previousSibling?elm.previousSibling:elm.parentNode);return $_9kvypj2cjh8lywnz.prevPosition(rootElement,startPosition).fold(function(){return $_9kvypj2cjh8lywnz.nextPosition(rootElement,CaretPosition$1.after(elm))},Option.some)},findCaretPositionForwardsFromElm=function(rootElement,elm){return $_9kvypj2cjh8lywnz.nextPosition(rootElement,CaretPosition$1.after(elm)).fold(function(){return $_9kvypj2cjh8lywnz.prevPosition(rootElement,CaretPosition$1.before(elm))},Option.some)},findCaretPositionBackwards=function(rootElement,elm){return getPreviousSiblingCaretPosition(elm).orThunk(function(){return getNextSiblingCaretPosition(elm)}).orThunk(function(){return findCaretPositionBackwardsFromElm(rootElement,elm)})},findCaretPositionForward=function(rootElement,elm){return getNextSiblingCaretPosition(elm).orThunk(function(){return getPreviousSiblingCaretPosition(elm)}).orThunk(function(){return findCaretPositionForwardsFromElm(rootElement,elm)})},findCaretPosition$1=function(forward,rootElement,elm){return forward?findCaretPositionForward(rootElement,elm):findCaretPositionBackwards(rootElement,elm)},findCaretPosOutsideElmAfterDelete=function(forward,rootElement,elm){return findCaretPosition$1(forward,rootElement,elm).map($_eqpqvr6jh8lyw3s.curry(reposition,elm))},setSelection=function(editor,forward,pos){pos.fold(function(){editor.focus()},function(pos){editor.selection.setRng(pos.toRange(),forward)})},eqRawNode=function(rawNode){return function(elm){return elm.dom()===rawNode}},isBlock$2=function(editor,elm){return elm&&editor.schema.getBlockElements().hasOwnProperty($_7j1jt210jh8lywdx.name(elm))},paddEmptyBlock=function(elm){if($_b1urh33ajh8lywts.isEmpty(elm)){var br=$_cgttw3zjh8lywdq.fromHtml('<br data-mce-bogus="1">');return $_bfmuql2ujh8lywr1.empty(elm),$_4m7u2e2kjh8lywpi.append(elm,br),Option.some(CaretPosition$1.before(br.dom()))}return Option.none()},deleteNormalized=function(elm,afterDeletePosOpt){return $_b8twwq26jh8lywmm.liftN([$_a43q0i17jh8lywfe.prevSibling(elm),$_a43q0i17jh8lywfe.nextSibling(elm),afterDeletePosOpt],function(prev,next,afterDeletePos){var offset,prevNode=prev.dom(),nextNode=next.dom();return $_5oonaz1qjh8lywhz.isText(prevNode)&&$_5oonaz1qjh8lywhz.isText(nextNode)?(offset=prevNode.data.length,prevNode.appendData(nextNode.data),$_bfmuql2ujh8lywr1.remove(next),$_bfmuql2ujh8lywr1.remove(elm),afterDeletePos.container()===nextNode?CaretPosition$1(prevNode,offset):afterDeletePos):($_bfmuql2ujh8lywr1.remove(elm),afterDeletePos)}).orThunk(function(){return $_bfmuql2ujh8lywr1.remove(elm),afterDeletePosOpt})},deleteElement=function(editor,forward,elm){var afterDeletePos=findCaretPosOutsideElmAfterDelete(forward,editor.getBody(),elm.dom()),parentBlock=$_6hl03835jh8lywsm.ancestor(elm,$_eqpqvr6jh8lyw3s.curry(isBlock$2,editor),eqRawNode(editor.getBody())),normalizedAfterDeletePos=deleteNormalized(elm,afterDeletePos);editor.dom.isEmpty(editor.getBody())?(editor.setContent(""),editor.selection.setCursorLocation()):parentBlock.bind(paddEmptyBlock).fold(function(){setSelection(editor,forward,normalizedAfterDeletePos)},function(paddPos){setSelection(editor,forward,Option.some(paddPos))})},$_1al0sh3jjh8lywyv={deleteElement:deleteElement},deleteElement$1=function(editor,forward){return function(element){return editor._selectionOverrides.hideFakeCaret(),$_1al0sh3jjh8lywyv.deleteElement(editor,forward,$_cgttw3zjh8lywdq.fromDom(element)),!0}},moveToElement=function(editor,forward){return function(element){var pos=forward?CaretPosition$1.before(element):CaretPosition$1.after(element);return editor.selection.setRng(pos.toRange()),!0}},moveToPosition=function(editor){return function(pos){return editor.selection.setRng(pos.toRange()),!0}},backspaceDeleteCaret=function(editor,forward){var result=read$1(editor.getBody(),forward,editor.selection.getRng()).map(function(deleteAction){return deleteAction.fold(deleteElement$1(editor,forward),moveToElement(editor,forward),moveToPosition(editor))});return result.getOr(!1)},deleteOffscreenSelection=function(rootElement){$_5wjzy24jh8lyw2t.each($_eebxu2gjh8lywp3.descendants(rootElement,".mce-offscreen-selection"),$_bfmuql2ujh8lywr1.remove)},backspaceDeleteRange=function(editor,forward){var selectedElement=editor.selection.getNode();return!!$_5oonaz1qjh8lywhz.isContentEditableFalse(selectedElement)&&(deleteOffscreenSelection($_cgttw3zjh8lywdq.fromDom(editor.getBody())),$_1al0sh3jjh8lywyv.deleteElement(editor,forward,$_cgttw3zjh8lywdq.fromDom(editor.selection.getNode())),$_aj8isd34jh8lyws4.paddEmptyBody(editor),!0)},getContentEditableRoot=function(root,node){for(;node&&node!==root;){if($_5oonaz1qjh8lywhz.isContentEditableTrue(node)||$_5oonaz1qjh8lywhz.isContentEditableFalse(node))return node;node=node.parentNode}return null},paddEmptyElement=function(editor){var br,ceRoot=getContentEditableRoot(editor.getBody(),editor.selection.getNode());return $_5oonaz1qjh8lywhz.isContentEditableTrue(ceRoot)&&editor.dom.isBlock(ceRoot)&&editor.dom.isEmpty(ceRoot)&&(br=editor.dom.create("br",{"data-mce-bogus":"1"}),editor.dom.setHTML(ceRoot,""),ceRoot.appendChild(br),editor.selection.setRng(CaretPosition$1.before(br).toRange())),!0},backspaceDelete$2=function(editor,forward){return editor.selection.isCollapsed()?backspaceDeleteCaret(editor,forward):backspaceDeleteRange(editor,forward)},$_ar80r13gjh8lywy7={backspaceDelete:backspaceDelete$2,paddEmptyElement:paddEmptyElement},isText$8=$_5oonaz1qjh8lywhz.isText,startsWithCaretContainer$1=function(node){return isText$8(node)&&node.data[0]===$_d383mr21jh8lywlv.ZWSP},endsWithCaretContainer$1=function(node){return isText$8(node)&&node.data[node.data.length-1]===$_d383mr21jh8lywlv.ZWSP},createZwsp=function(node){return node.ownerDocument.createTextNode($_d383mr21jh8lywlv.ZWSP)},insertBefore$1=function(node){if(isText$8(node.previousSibling))return endsWithCaretContainer$1(node.previousSibling)?node.previousSibling:(node.previousSibling.appendData($_d383mr21jh8lywlv.ZWSP),node.previousSibling);if(isText$8(node))return startsWithCaretContainer$1(node)?node:(node.insertData(0,$_d383mr21jh8lywlv.ZWSP),node);var newNode=createZwsp(node);return node.parentNode.insertBefore(newNode,node),newNode},insertAfter$1=function(node){if(isText$8(node.nextSibling))return startsWithCaretContainer$1(node.nextSibling)?node.nextSibling:(node.nextSibling.insertData(0,$_d383mr21jh8lywlv.ZWSP),node.nextSibling);if(isText$8(node))return endsWithCaretContainer$1(node)?node:(node.appendData($_d383mr21jh8lywlv.ZWSP),node);var newNode=createZwsp(node);return node.nextSibling?node.parentNode.insertBefore(newNode,node.nextSibling):node.parentNode.appendChild(newNode),newNode},insertInline$1=function(before,node){return before?insertBefore$1(node):insertAfter$1(node)},insertInlineBefore=$_eqpqvr6jh8lyw3s.curry(insertInline$1,!0),insertInlineAfter=$_eqpqvr6jh8lyw3s.curry(insertInline$1,!1),insertInlinePos=function(pos,before){return $_5oonaz1qjh8lywhz.isText(pos.container())?insertInline$1(before,pos.container()):insertInline$1(before,pos.getNode())},isPosCaretContainer=function(pos,caret){var caretNode=caret.get();return caretNode&&pos.container()===caretNode&&isCaretContainerInline(caretNode)},renderCaret=function(caret,location){return location.fold(function(element){$_9nl16f2ajh8lywne.remove(caret.get());var text=insertInlineBefore(element);return caret.set(text),Option.some(CaretPosition$1(text,text.length-1))},function(element){return $_9kvypj2cjh8lywnz.firstPositionIn(element).map(function(pos){if(isPosCaretContainer(pos,caret))return CaretPosition$1(caret.get(),1);$_9nl16f2ajh8lywne.remove(caret.get());var text=insertInlinePos(pos,!0);return caret.set(text),CaretPosition$1(text,1)})},function(element){return $_9kvypj2cjh8lywnz.lastPositionIn(element).map(function(pos){if(isPosCaretContainer(pos,caret))return CaretPosition$1(caret.get(),caret.get().length-1);$_9nl16f2ajh8lywne.remove(caret.get());var text=insertInlinePos(pos,!1);return caret.set(text),CaretPosition$1(text,text.length-1)})},function(element){$_9nl16f2ajh8lywne.remove(caret.get());var text=insertInlineAfter(element);return caret.set(text),Option.some(CaretPosition$1(text,1))})},$_biul8i3ljh8lywzl={renderCaret:renderCaret},evaluateUntil=function(fns,args){for(var i=0;i<fns.length;i++){var result=fns[i].apply(null,args);if(result.isSome())return result}return Option.none()},$_7r5om73ojh8lyx09={evaluateUntil:evaluateUntil},Location=$_1ml90g3ijh8lywyp.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),rescope=function(rootNode,node){var parentBlock=getParentBlock(node,rootNode);return parentBlock?parentBlock:rootNode},before$3=function(isInlineTarget,rootNode,pos){var nPos=$_231v7s37jh8lywt3.normalizeForwards(pos),scope=rescope(rootNode,nPos.container());return $_231v7s37jh8lywt3.findRootInline(isInlineTarget,scope,nPos).fold(function(){return $_9kvypj2cjh8lywnz.nextPosition(scope,nPos).bind($_eqpqvr6jh8lyw3s.curry($_231v7s37jh8lywt3.findRootInline,isInlineTarget,scope)).map(function(inline){return Location.before(inline)})},Option.none)},isNotInsideFormatCaretContainer=function(rootNode,elm){return null===getParentCaretContainer(rootNode,elm)},findInsideRootInline=function(isInlineTarget,rootNode,pos){return $_231v7s37jh8lywt3.findRootInline(isInlineTarget,rootNode,pos).filter($_eqpqvr6jh8lyw3s.curry(isNotInsideFormatCaretContainer,rootNode))},start=function(isInlineTarget,rootNode,pos){var nPos=$_231v7s37jh8lywt3.normalizeBackwards(pos);return findInsideRootInline(isInlineTarget,rootNode,nPos).bind(function(inline){var prevPos=$_9kvypj2cjh8lywnz.prevPosition(inline,nPos);return prevPos.isNone()?Option.some(Location.start(inline)):Option.none()})},end=function(isInlineTarget,rootNode,pos){var nPos=$_231v7s37jh8lywt3.normalizeForwards(pos);return findInsideRootInline(isInlineTarget,rootNode,nPos).bind(function(inline){var nextPos=$_9kvypj2cjh8lywnz.nextPosition(inline,nPos);return nextPos.isNone()?Option.some(Location.end(inline)):Option.none()})},after$3=function(isInlineTarget,rootNode,pos){var nPos=$_231v7s37jh8lywt3.normalizeBackwards(pos),scope=rescope(rootNode,nPos.container());return $_231v7s37jh8lywt3.findRootInline(isInlineTarget,scope,nPos).fold(function(){return $_9kvypj2cjh8lywnz.prevPosition(scope,nPos).bind($_eqpqvr6jh8lyw3s.curry($_231v7s37jh8lywt3.findRootInline,isInlineTarget,scope)).map(function(inline){return Location.after(inline)})},Option.none)},isValidLocation=function(location){return $_231v7s37jh8lywt3.isRtl(getElement(location))===!1},readLocation=function(isInlineTarget,rootNode,pos){var location=$_7r5om73ojh8lyx09.evaluateUntil([before$3,start,end,after$3],[isInlineTarget,rootNode,pos]);return location.filter(isValidLocation)},getElement=function(location){return location.fold($_eqpqvr6jh8lyw3s.identity,$_eqpqvr6jh8lyw3s.identity,$_eqpqvr6jh8lyw3s.identity,$_eqpqvr6jh8lyw3s.identity)},getName=function(location){return location.fold($_eqpqvr6jh8lyw3s.constant("before"),$_eqpqvr6jh8lyw3s.constant("start"),$_eqpqvr6jh8lyw3s.constant("end"),$_eqpqvr6jh8lyw3s.constant("after"))},outside=function(location){return location.fold(Location.before,Location.before,Location.after,Location.after)},inside=function(location){return location.fold(Location.start,Location.start,Location.end,Location.end)},isEq=function(location1,location2){return getName(location1)===getName(location2)&&getElement(location1)===getElement(location2)},betweenInlines=function(forward,isInlineTarget,rootNode,from,to,location){return $_b8twwq26jh8lywmm.liftN([$_231v7s37jh8lywt3.findRootInline(isInlineTarget,rootNode,from),$_231v7s37jh8lywt3.findRootInline(isInlineTarget,rootNode,to)],function(fromInline,toInline){return fromInline!==toInline&&$_231v7s37jh8lywt3.hasSameParentBlock(rootNode,fromInline,toInline)?Location.after(forward?fromInline:toInline):location}).getOr(location)},skipNoMovement=function(fromLocation,toLocation){return fromLocation.fold($_eqpqvr6jh8lyw3s.constant(!0),function(fromLocation){return!isEq(fromLocation,toLocation)})},findLocationTraverse=function(forward,isInlineTarget,rootNode,fromLocation,pos){var from=$_231v7s37jh8lywt3.normalizePosition(forward,pos),to=$_9kvypj2cjh8lywnz.fromPosition(forward,rootNode,from).map($_eqpqvr6jh8lyw3s.curry($_231v7s37jh8lywt3.normalizePosition,forward)),location=to.fold(function(){return fromLocation.map(outside)},function(to){return readLocation(isInlineTarget,rootNode,to).map($_eqpqvr6jh8lyw3s.curry(betweenInlines,forward,isInlineTarget,rootNode,from,to)).filter($_eqpqvr6jh8lyw3s.curry(skipNoMovement,fromLocation))});return location.filter(isValidLocation)},findLocationSimple=function(forward,location){return forward?location.fold($_eqpqvr6jh8lyw3s.compose(Option.some,Location.start),Option.none,$_eqpqvr6jh8lyw3s.compose(Option.some,Location.after),Option.none):location.fold(Option.none,$_eqpqvr6jh8lyw3s.compose(Option.some,Location.before),Option.none,$_eqpqvr6jh8lyw3s.compose(Option.some,Location.end))},findLocation=function(forward,isInlineTarget,rootNode,pos){var from=$_231v7s37jh8lywt3.normalizePosition(forward,pos),fromLocation=readLocation(isInlineTarget,rootNode,from);return readLocation(isInlineTarget,rootNode,from).bind($_eqpqvr6jh8lyw3s.curry(findLocationSimple,forward)).orThunk(function(){return findLocationTraverse(forward,isInlineTarget,rootNode,fromLocation,pos)})},$_6kjy7r3njh8lywzz={readLocation:readLocation,findLocation:findLocation,prevLocation:$_eqpqvr6jh8lyw3s.curry(findLocation,!1),nextLocation:$_eqpqvr6jh8lyw3s.curry(findLocation,!0),getElement:getElement,outside:outside,inside:inside},hasSelectionModifyApi=function(editor){return $_dp4g6d7jh8lyw3y.isFunction(editor.selection.getSel().modify)},moveRel=function(forward,selection,pos){var delta=forward?1:-1;return selection.setRng(CaretPosition$1(pos.container(),pos.offset()+delta).toRange()),selection.getSel().modify("move",forward?"forward":"backward","word"),!0},moveByWord=function(forward,editor){var rng=editor.selection.getRng(),pos=forward?CaretPosition$1.fromRangeEnd(rng):CaretPosition$1.fromRangeStart(rng);return!!hasSelectionModifyApi(editor)&&(forward&&isBeforeInline(pos)?moveRel(!0,editor.selection,pos):!(forward||!isAfterInline(pos))&&moveRel(!1,editor.selection,pos))},$_d48vbn3qjh8lyx0k={hasSelectionModifyApi:hasSelectionModifyApi,moveByWord:moveByWord},setCaretPosition=function(editor,pos){var rng=editor.dom.createRng();rng.setStart(pos.container(),pos.offset()),rng.setEnd(pos.container(),pos.offset()),editor.selection.setRng(rng)},isFeatureEnabled=function(editor){return editor.settings.inline_boundaries!==!1},setSelected=function(state,elm){state?elm.setAttribute("data-mce-selected","inline-boundary"):elm.removeAttribute("data-mce-selected")},renderCaretLocation=function(editor,caret,location){return $_biul8i3ljh8lywzl.renderCaret(caret,location).map(function(pos){return setCaretPosition(editor,pos),location})},findLocation$1=function(editor,caret,forward){var rootNode=editor.getBody(),from=CaretPosition$1.fromRangeStart(editor.selection.getRng()),isInlineTarget=$_eqpqvr6jh8lyw3s.curry($_231v7s37jh8lywt3.isInlineTarget,editor),location=$_6kjy7r3njh8lywzz.findLocation(forward,isInlineTarget,rootNode,from);return location.bind(function(location){return renderCaretLocation(editor,caret,location)})},toggleInlines=function(isInlineTarget,dom,elms){var selectedInlines=$_5wjzy24jh8lyw2t.filter(dom.select('*[data-mce-selected="inline-boundary"]'),isInlineTarget),targetInlines=$_5wjzy24jh8lyw2t.filter(elms,isInlineTarget);$_5wjzy24jh8lyw2t.each($_5wjzy24jh8lyw2t.difference(selectedInlines,targetInlines),$_eqpqvr6jh8lyw3s.curry(setSelected,!1)),$_5wjzy24jh8lyw2t.each($_5wjzy24jh8lyw2t.difference(targetInlines,selectedInlines),$_eqpqvr6jh8lyw3s.curry(setSelected,!0))},safeRemoveCaretContainer=function(editor,caret){if(editor.selection.isCollapsed()&&editor.composing!==!0&&caret.get()){var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng());CaretPosition$1.isTextPosition(pos)&&$_231v7s37jh8lywt3.isAtZwsp(pos)===!1&&(setCaretPosition(editor,$_9nl16f2ajh8lywne.removeAndReposition(caret.get(),pos)),caret.set(null))}},renderInsideInlineCaret=function(isInlineTarget,editor,caret,elms){if(editor.selection.isCollapsed()){var inlines=$_5wjzy24jh8lyw2t.filter(elms,isInlineTarget);$_5wjzy24jh8lyw2t.each(inlines,function(inline){var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng());$_6kjy7r3njh8lywzz.readLocation(isInlineTarget,editor.getBody(),pos).bind(function(location){return renderCaretLocation(editor,caret,location)})})}},move=function(editor,caret,forward){return function(){return!!isFeatureEnabled(editor)&&findLocation$1(editor,caret,forward).isSome()}},moveWord=function(forward,editor,caret){return function(){return!!isFeatureEnabled(editor)&&$_d48vbn3qjh8lyx0k.moveByWord(forward,editor)}},setupSelectedState=function(editor){var caret=Cell(null),isInlineTarget=$_eqpqvr6jh8lyw3s.curry($_231v7s37jh8lywt3.isInlineTarget,editor);return editor.on("NodeChange",function(e){isFeatureEnabled(editor)&&(toggleInlines(isInlineTarget,editor.dom,e.parents),safeRemoveCaretContainer(editor,caret),renderInsideInlineCaret(isInlineTarget,editor,caret,e.parents))}),caret},moveNextWord=$_eqpqvr6jh8lyw3s.curry(moveWord,!0),movePrevWord=$_eqpqvr6jh8lyw3s.curry(moveWord,!1),$_65xx7w3pjh8lyx0d={move:move,moveNextWord:moveNextWord,movePrevWord:movePrevWord,setupSelectedState:setupSelectedState,setCaretPosition:setCaretPosition},isFeatureEnabled$1=function(editor){return editor.settings.inline_boundaries!==!1},rangeFromPositions=function(from,to){var range=document.createRange();return range.setStart(from.container(),from.offset()),range.setEnd(to.container(),to.offset()),range},hasOnlyTwoOrLessPositionsLeft=function(elm){return $_b8twwq26jh8lywmm.liftN([$_9kvypj2cjh8lywnz.firstPositionIn(elm),$_9kvypj2cjh8lywnz.lastPositionIn(elm)],function(firstPos,lastPos){var normalizedFirstPos=$_231v7s37jh8lywt3.normalizePosition(!0,firstPos),normalizedLastPos=$_231v7s37jh8lywt3.normalizePosition(!1,lastPos);return $_9kvypj2cjh8lywnz.nextPosition(elm,normalizedFirstPos).map(function(pos){return pos.isEqual(normalizedLastPos)}).getOr(!0)}).getOr(!0)},setCaretLocation=function(editor,caret){return function(location){return $_biul8i3ljh8lywzl.renderCaret(caret,location).map(function(pos){return $_65xx7w3pjh8lyx0d.setCaretPosition(editor,pos),!0}).getOr(!1)}},deleteFromTo=function(editor,caret,from,to){var rootNode=editor.getBody(),isInlineTarget=$_eqpqvr6jh8lyw3s.curry($_231v7s37jh8lywt3.isInlineTarget,editor);editor.undoManager.ignore(function(){editor.selection.setRng(rangeFromPositions(from,to)),editor.execCommand("Delete"),$_6kjy7r3njh8lywzz.readLocation(isInlineTarget,rootNode,CaretPosition$1.fromRangeStart(editor.selection.getRng())).map($_6kjy7r3njh8lywzz.inside).map(setCaretLocation(editor,caret))}),editor.nodeChanged()},rescope$1=function(rootNode,node){var parentBlock=getParentBlock(node,rootNode);return parentBlock?parentBlock:rootNode},backspaceDeleteCollapsed=function(editor,caret,forward,from){var rootNode=rescope$1(editor.getBody(),from.container()),isInlineTarget=$_eqpqvr6jh8lyw3s.curry($_231v7s37jh8lywt3.isInlineTarget,editor),fromLocation=$_6kjy7r3njh8lywzz.readLocation(isInlineTarget,rootNode,from);return fromLocation.bind(function(location){return forward?location.fold($_eqpqvr6jh8lyw3s.constant(Option.some($_6kjy7r3njh8lywzz.inside(location))),Option.none,$_eqpqvr6jh8lyw3s.constant(Option.some($_6kjy7r3njh8lywzz.outside(location))),Option.none):location.fold(Option.none,$_eqpqvr6jh8lyw3s.constant(Option.some($_6kjy7r3njh8lywzz.outside(location))),Option.none,$_eqpqvr6jh8lyw3s.constant(Option.some($_6kjy7r3njh8lywzz.inside(location))))}).map(setCaretLocation(editor,caret)).getOrThunk(function(){var toPosition=$_9kvypj2cjh8lywnz.navigate(forward,rootNode,from),toLocation=toPosition.bind(function(pos){return $_6kjy7r3njh8lywzz.readLocation(isInlineTarget,rootNode,pos)});return fromLocation.isSome()&&toLocation.isSome()?$_231v7s37jh8lywt3.findRootInline(isInlineTarget,rootNode,from).map(function(elm){return!!hasOnlyTwoOrLessPositionsLeft(elm)&&($_1al0sh3jjh8lywyv.deleteElement(editor,forward,$_cgttw3zjh8lywdq.fromDom(elm)),!0)}).getOr(!1):toLocation.bind(function(_){return toPosition.map(function(to){return forward?deleteFromTo(editor,caret,from,to):deleteFromTo(editor,caret,to,from),!0})}).getOr(!1)})},backspaceDelete$3=function(editor,caret,forward){if(editor.selection.isCollapsed()&&isFeatureEnabled$1(editor)){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return backspaceDeleteCollapsed(editor,caret,forward,from)}return!1},$_ej9d8d3kjh8lywzc={backspaceDelete:backspaceDelete$3},tableCellRng=$_4jz0ce18jh8lywft.immutable("start","end"),tableSelection=$_4jz0ce18jh8lywft.immutable("rng","table","cells"),deleteAction=$_1ml90g3ijh8lywyp.generate([{removeTable:["element"]},{emptyCells:["cells"]}]),isRootFromElement=function(root){return $_eqpqvr6jh8lyw3s.curry($_5f6gpb1djh8lywg5.eq,root)},getClosestCell$1=function(container,isRoot){return $_7sg18r3cjh8lywu1.closest($_cgttw3zjh8lywdq.fromDom(container),"td,th",isRoot)},getClosestTable=function(cell,isRoot){return $_7sg18r3cjh8lywu1.ancestor(cell,"table",isRoot)},isExpandedCellRng=function(cellRng){return $_5f6gpb1djh8lywg5.eq(cellRng.start(),cellRng.end())===!1},getTableFromCellRng=function(cellRng,isRoot){return getClosestTable(cellRng.start(),isRoot).bind(function(startParentTable){return getClosestTable(cellRng.end(),isRoot).bind(function(endParentTable){return $_5f6gpb1djh8lywg5.eq(startParentTable,endParentTable)?Option.some(startParentTable):Option.none()})})},getTableCells=function(table){return $_eebxu2gjh8lywp3.descendants(table,"td,th")},getCellRangeFromStartTable=function(cellRng,isRoot){return getClosestTable(cellRng.start(),isRoot).bind(function(table){return $_5wjzy24jh8lyw2t.last(getTableCells(table)).map(function(endCell){return tableCellRng(cellRng.start(),endCell)})})},partialSelection=function(isRoot,rng){var startCell=getClosestCell$1(rng.startContainer,isRoot),endCell=getClosestCell$1(rng.endContainer,isRoot);return rng.collapsed?Option.none():$_b8twwq26jh8lywmm.liftN([startCell,endCell],tableCellRng).fold(function(){return startCell.fold(function(){return endCell.bind(function(endCell){return getClosestTable(endCell,isRoot).bind(function(table){return $_5wjzy24jh8lyw2t.head(getTableCells(table)).map(function(startCell){return tableCellRng(startCell,endCell)})})})},function(startCell){return getClosestTable(startCell,isRoot).bind(function(table){return $_5wjzy24jh8lyw2t.last(getTableCells(table)).map(function(endCell){return tableCellRng(startCell,endCell)})})})},function(cellRng){return isWithinSameTable(isRoot,cellRng)?Option.none():getCellRangeFromStartTable(cellRng,isRoot)})},isWithinSameTable=function(isRoot,cellRng){return getTableFromCellRng(cellRng,isRoot).isSome()},getCellRng=function(rng,isRoot){var startCell=getClosestCell$1(rng.startContainer,isRoot),endCell=getClosestCell$1(rng.endContainer,isRoot);return $_b8twwq26jh8lywmm.liftN([startCell,endCell],tableCellRng).filter(isExpandedCellRng).filter(function(cellRng){return isWithinSameTable(isRoot,cellRng)}).orThunk(function(){return partialSelection(isRoot,rng)})},getTableSelectionFromCellRng=function(cellRng,isRoot){return getTableFromCellRng(cellRng,isRoot).map(function(table){return tableSelection(cellRng,table,getTableCells(table))})},getTableSelectionFromRng=function(root,rng){var isRoot=isRootFromElement(root);return getCellRng(rng,isRoot).bind(function(cellRng){return getTableSelectionFromCellRng(cellRng,isRoot)})},getCellIndex=function(cells,cell){return $_5wjzy24jh8lyw2t.findIndex(cells,function(x){return $_5f6gpb1djh8lywg5.eq(x,cell)})},getSelectedCells=function(tableSelection){return $_b8twwq26jh8lywmm.liftN([getCellIndex(tableSelection.cells(),tableSelection.rng().start()),getCellIndex(tableSelection.cells(),tableSelection.rng().end())],function(startIndex,endIndex){return tableSelection.cells().slice(startIndex,endIndex+1)})},getAction=function(tableSelection){return getSelectedCells(tableSelection).map(function(selected){var cells=tableSelection.cells();return selected.length===cells.length?deleteAction.removeTable(tableSelection.table()):deleteAction.emptyCells(selected)})},getActionFromCells=function(cells){return deleteAction.emptyCells(cells)},getActionFromRange=function(root,rng){return getTableSelectionFromRng(root,rng).bind(getAction)},$_g0m0zq3sjh8lyx10={getActionFromRange:getActionFromRange,getActionFromCells:getActionFromCells},getRanges=function(selection){var ranges=[];if(selection)for(var i=0;i<selection.rangeCount;i++)ranges.push(selection.getRangeAt(i));return ranges},getSelectedNodes=function(ranges){return $_5wjzy24jh8lyw2t.bind(ranges,function(range){var node=getSelectedNode(range);return node?[$_cgttw3zjh8lywdq.fromDom(node)]:[]})},hasMultipleRanges=function(selection){return getRanges(selection).length>1},$_d1o8uj3ujh8lyx1u={getRanges:getRanges,getSelectedNodes:getSelectedNodes,hasMultipleRanges:hasMultipleRanges},getCellsFromRanges=function(ranges){return $_5wjzy24jh8lyw2t.filter($_d1o8uj3ujh8lyx1u.getSelectedNodes(ranges),isTableCell)},getCellsFromElement=function(elm){var selectedCells=$_eebxu2gjh8lywp3.descendants(elm,"td[data-mce-selected],th[data-mce-selected]");return selectedCells},getCellsFromElementOrRanges=function(ranges,element){var selectedCells=getCellsFromElement(element),rangeCells=getCellsFromRanges(ranges);return selectedCells.length>0?selectedCells:rangeCells},getCellsFromEditor=function(editor){return getCellsFromElementOrRanges($_d1o8uj3ujh8lyx1u.getRanges(editor.selection.getSel()),$_cgttw3zjh8lywdq.fromDom(editor.getBody()))},$_bwjtq63tjh8lyx1g={getCellsFromRanges:getCellsFromRanges,getCellsFromElement:getCellsFromElement,getCellsFromElementOrRanges:getCellsFromElementOrRanges,getCellsFromEditor:getCellsFromEditor},emptyCells=function(editor,cells){return $_5wjzy24jh8lyw2t.each(cells,$_2bvsfb2tjh8lywqo.fillWithPaddingBr),editor.selection.setCursorLocation(cells[0].dom(),0),!0},deleteTableElement=function(editor,table){return $_1al0sh3jjh8lywyv.deleteElement(editor,!1,table),!0},deleteCellRange=function(editor,rootElm,rng){return $_g0m0zq3sjh8lyx10.getActionFromRange(rootElm,rng).map(function(action){return action.fold($_eqpqvr6jh8lyw3s.curry(deleteTableElement,editor),$_eqpqvr6jh8lyw3s.curry(emptyCells,editor))})},deleteCaptionRange=function(editor,caption){return emptyElement(editor,caption)},deleteTableRange=function(editor,rootElm,rng,startElm){return getParentCaption(rootElm,startElm).fold(function(){
return deleteCellRange(editor,rootElm,rng)},function(caption){return deleteCaptionRange(editor,caption)}).getOr(!1)},deleteRange$1=function(editor,startElm){var rootNode=$_cgttw3zjh8lywdq.fromDom(editor.getBody()),rng=editor.selection.getRng(),selectedCells=$_bwjtq63tjh8lyx1g.getCellsFromEditor(editor);return 0!==selectedCells.length?emptyCells(editor,selectedCells):deleteTableRange(editor,rootNode,rng,startElm)},getParentCell=function(rootElm,elm){return $_5wjzy24jh8lyw2t.find($_dyxtub3ejh8lywxq.parentsAndSelf(elm,rootElm),isTableCell)},getParentCaption=function(rootElm,elm){return $_5wjzy24jh8lyw2t.find($_dyxtub3ejh8lywxq.parentsAndSelf(elm,rootElm),function(elm){return"caption"===$_7j1jt210jh8lywdx.name(elm)})},deleteBetweenCells=function(editor,rootElm,forward,fromCell,from){return $_9kvypj2cjh8lywnz.navigate(forward,editor.getBody(),from).bind(function(to){return getParentCell(rootElm,$_cgttw3zjh8lywdq.fromDom(to.getNode())).map(function(toCell){return $_5f6gpb1djh8lywg5.eq(toCell,fromCell)===!1})})},emptyElement=function(editor,elm){return $_2bvsfb2tjh8lywqo.fillWithPaddingBr(elm),editor.selection.setCursorLocation(elm.dom(),0),Option.some(!0)},isDeleteOfLastCharPos=function(fromCaption,forward,from,to){return $_9kvypj2cjh8lywnz.firstPositionIn(fromCaption.dom()).bind(function(first){return $_9kvypj2cjh8lywnz.lastPositionIn(fromCaption.dom()).map(function(last){return forward?from.isEqual(first)&&to.isEqual(last):from.isEqual(last)&&to.isEqual(first)})}).getOr(!0)},emptyCaretCaption=function(editor,elm){return emptyElement(editor,elm)},validateCaretCaption=function(rootElm,fromCaption,to){return getParentCaption(rootElm,$_cgttw3zjh8lywdq.fromDom(to.getNode())).map(function(toCaption){return $_5f6gpb1djh8lywg5.eq(toCaption,fromCaption)===!1})},deleteCaretInsideCaption=function(editor,rootElm,forward,fromCaption,from){return $_9kvypj2cjh8lywnz.navigate(forward,editor.getBody(),from).bind(function(to){return isDeleteOfLastCharPos(fromCaption,forward,from,to)?emptyCaretCaption(editor,fromCaption):validateCaretCaption(rootElm,fromCaption,to)}).or(Option.some(!0))},deleteCaretCells=function(editor,forward,rootElm,startElm){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return getParentCell(rootElm,startElm).bind(function(fromCell){return $_b1urh33ajh8lywts.isEmpty(fromCell)?emptyElement(editor,fromCell):deleteBetweenCells(editor,rootElm,forward,fromCell,from)})},deleteCaretCaption=function(editor,forward,rootElm,fromCaption){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return $_b1urh33ajh8lywts.isEmpty(fromCaption)?emptyElement(editor,fromCaption):deleteCaretInsideCaption(editor,rootElm,forward,fromCaption,from)},deleteCaret=function(editor,forward,startElm){var rootElm=$_cgttw3zjh8lywdq.fromDom(editor.getBody());return getParentCaption(rootElm,startElm).fold(function(){return deleteCaretCells(editor,forward,rootElm,startElm)},function(fromCaption){return deleteCaretCaption(editor,forward,rootElm,fromCaption)}).getOr(!1)},backspaceDelete$4=function(editor,forward){var startElm=$_cgttw3zjh8lywdq.fromDom(editor.selection.getStart(!0)),cells=$_bwjtq63tjh8lyx1g.getCellsFromEditor(editor);return editor.selection.isCollapsed()&&0===cells.length?deleteCaret(editor,forward,startElm):deleteRange$1(editor,startElm)},$_746feo3rjh8lyx0o={backspaceDelete:backspaceDelete$4},nativeCommand=function(editor,command){editor.getDoc().execCommand(command,!1,null)},deleteCommand=function(editor){$_ar80r13gjh8lywy7.backspaceDelete(editor,!1)||$_ej9d8d3kjh8lywzc.backspaceDelete(editor,!1)||$_5jmwsv32jh8lywrr.backspaceDelete(editor,!1)||$_746feo3rjh8lyx0o.backspaceDelete(editor)||$_lcy1p3fjh8lywxx.backspaceDelete(editor,!1)||(nativeCommand(editor,"Delete"),$_aj8isd34jh8lyws4.paddEmptyBody(editor))},forwardDeleteCommand=function(editor){$_ar80r13gjh8lywy7.backspaceDelete(editor,!0)||$_ej9d8d3kjh8lywzc.backspaceDelete(editor,!0)||$_5jmwsv32jh8lywrr.backspaceDelete(editor,!0)||$_746feo3rjh8lyx0o.backspaceDelete(editor)||$_lcy1p3fjh8lywxx.backspaceDelete(editor,!0)||nativeCommand(editor,"ForwardDelete")},$_fmagiy31jh8lywrp={deleteCommand:deleteCommand,forwardDeleteCommand:forwardDeleteCommand},getSpecifiedFontProp=function(propName,rootElm,elm){var getProperty=function(elm){return $_36knnd12jh8lywe1.getRaw(elm,propName)},isRoot=function(elm){return $_5f6gpb1djh8lywg5.eq($_cgttw3zjh8lywdq.fromDom(rootElm),elm)};return $_6hl03835jh8lywsm.closest($_cgttw3zjh8lywdq.fromDom(elm),function(elm){return getProperty(elm).isSome()},isRoot).bind(getProperty)},round$1=function(number,precision){var factor=Math.pow(10,precision);return Math.round(number*factor)/factor},toPt=function(fontSize,precision){return/[0-9.]+px$/.test(fontSize)?round$1(72*parseInt(fontSize,10)/96,precision||0)+"pt":fontSize},normalizeFontFamily=function(fontFamily){return fontFamily.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")},getComputedFontProp=function(propName,elm){return Option.from(DOMUtils$1.DOM.getStyle(elm,propName,!0))},getFontProp=function(propName){return function(rootElm,elm){return Option.from(elm).map($_cgttw3zjh8lywdq.fromDom).filter($_7j1jt210jh8lywdx.isElement).bind(function(element){return getSpecifiedFontProp(propName,rootElm,element.dom()).or(getComputedFontProp(propName,element.dom()))}).getOr("")}},$_9wj7cv3wjh8lyx23={getFontSize:getFontProp("font-size"),getFontFamily:$_eqpqvr6jh8lyw3s.compose(normalizeFontFamily,getFontProp("font-family")),toPt:toPt},findFirstCaretElement=function(editor){return $_9kvypj2cjh8lywnz.firstPositionIn(editor.getBody()).map(function(caret){var container=caret.container();return $_5oonaz1qjh8lywhz.isText(container)?container.parentNode:container})},isRangeAtStartOfNode=function(rng,root){return rng.startContainer===root&&0===rng.startOffset},getCaretElement=function(editor){return Option.from(editor.selection.getRng()).bind(function(rng){var root=editor.getBody();return isRangeAtStartOfNode(rng,root)?Option.none():Option.from(editor.selection.getStart(!0))})},fromFontSizeNumber=function(editor,value){if(/^[0-9\.]+$/.test(value)){var fontSizeNumber=parseInt(value,10);if(fontSizeNumber>=1&&fontSizeNumber<=7){var fontSizes=$_66vr6g2jjh8lywpf.getFontStyleValues(editor),fontClasses=$_66vr6g2jjh8lywpf.getFontSizeClasses(editor);return fontClasses?fontClasses[fontSizeNumber-1]||value:fontSizes[fontSizeNumber-1]||value}return value}return value},fontNameAction=function(editor,value){editor.formatter.toggle("fontname",{value:fromFontSizeNumber(editor,value)}),editor.nodeChanged()},fontNameQuery=function(editor){return getCaretElement(editor).fold(function(){return findFirstCaretElement(editor).map(function(caretElement){return $_9wj7cv3wjh8lyx23.getFontFamily(editor.getBody(),caretElement)}).getOr("")},function(caretElement){return $_9wj7cv3wjh8lyx23.getFontFamily(editor.getBody(),caretElement)})},fontSizeAction=function(editor,value){editor.formatter.toggle("fontsize",{value:fromFontSizeNumber(editor,value)}),editor.nodeChanged()},fontSizeQuery=function(editor){return getCaretElement(editor).fold(function(){return findFirstCaretElement(editor).map(function(caretElement){return $_9wj7cv3wjh8lyx23.getFontSize(editor.getBody(),caretElement)}).getOr("")},function(caretElement){return $_9wj7cv3wjh8lyx23.getFontSize(editor.getBody(),caretElement)})},isEq$1=function(rng1,rng2){return rng1&&rng2&&rng1.startContainer===rng2.startContainer&&rng1.startOffset===rng2.startOffset&&rng1.endContainer===rng2.endContainer&&rng1.endOffset===rng2.endOffset},$_aayq8q3zjh8lyx2z={isEq:isEq$1},findParent=function(node,rootNode,predicate){for(;node&&node!==rootNode;){if(predicate(node))return node;node=node.parentNode}return null},hasParent=function(node,rootNode,predicate){return null!==findParent(node,rootNode,predicate)},hasParentWithName=function(node,rootNode,name){return hasParent(node,rootNode,function(node){return node.nodeName===name})},isTable$2=function(node){return node&&"TABLE"===node.nodeName},isTableCell$3=function(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName)},isCeFalseCaretContainer=function(node,rootNode){return isCaretContainer(node)&&hasParent(node,rootNode,isCaretNode)===!1},hasBrBeforeAfter=function(dom,node,left){for(var walker=new TreeWalker(node,dom.getParent(node.parentNode,dom.isBlock)||dom.getRoot());node=walker[left?"prev":"next"]();)if($_5oonaz1qjh8lywhz.isBr(node))return!0},isPrevNode=function(node,name){return node.previousSibling&&node.previousSibling.nodeName===name},hasContentEditableFalseParent=function(body,node){for(;node&&node!==body;){if($_5oonaz1qjh8lywhz.isContentEditableFalse(node))return!0;node=node.parentNode}return!1},findTextNodeRelative=function(dom,isAfterNode,collapsed,left,startNode){var walker,lastInlineElement,parentBlockContainer,node,body=dom.getRoot(),nonEmptyElementsMap=dom.schema.getNonEmptyElements();if(parentBlockContainer=dom.getParent(startNode.parentNode,dom.isBlock)||body,left&&$_5oonaz1qjh8lywhz.isBr(startNode)&&isAfterNode&&dom.isEmpty(parentBlockContainer))return Option.some(CaretPosition(startNode.parentNode,dom.nodeIndex(startNode)));for(walker=new TreeWalker(startNode,parentBlockContainer);node=walker[left?"prev":"next"]();){if("false"===dom.getContentEditableParent(node)||isCeFalseCaretContainer(node,body))return Option.none();if($_5oonaz1qjh8lywhz.isText(node)&&node.nodeValue.length>0)return hasParentWithName(node,body,"A")===!1?Option.some(CaretPosition(node,left?node.nodeValue.length:0)):Option.none();if(dom.isBlock(node)||nonEmptyElementsMap[node.nodeName.toLowerCase()])return Option.none();lastInlineElement=node}return collapsed&&lastInlineElement?Option.some(CaretPosition(lastInlineElement,0)):Option.none()},normalizeEndPoint=function(dom,collapsed,start,rng){var container,offset,walker,node,nonEmptyElementsMap,directionLeft,isAfterNode,body=dom.getRoot(),normalized=!1;if(container=rng[(start?"start":"end")+"Container"],offset=rng[(start?"start":"end")+"Offset"],isAfterNode=$_5oonaz1qjh8lywhz.isElement(container)&&offset===container.childNodes.length,nonEmptyElementsMap=dom.schema.getNonEmptyElements(),directionLeft=start,isCaretContainer(container))return Option.none();if($_5oonaz1qjh8lywhz.isElement(container)&&offset>container.childNodes.length-1&&(directionLeft=!1),$_5oonaz1qjh8lywhz.isDocument(container)&&(container=body,offset=0),container===body){if(directionLeft&&(node=container.childNodes[offset>0?offset-1:0])){if(isCaretContainer(node))return Option.none();if(nonEmptyElementsMap[node.nodeName]||isTable$2(node))return Option.none()}if(container.hasChildNodes()){if(offset=Math.min(!directionLeft&&offset>0?offset-1:offset,container.childNodes.length-1),container=container.childNodes[offset],offset=$_5oonaz1qjh8lywhz.isText(container)&&isAfterNode?container.data.length:0,!collapsed&&container===body.lastChild&&isTable$2(container))return Option.none();if(hasContentEditableFalseParent(body,container)||isCaretContainer(container))return Option.none();if(container.hasChildNodes()&&isTable$2(container)===!1){node=container,walker=new TreeWalker(container,body);do{if($_5oonaz1qjh8lywhz.isContentEditableFalse(node)||isCaretContainer(node)){normalized=!1;break}if($_5oonaz1qjh8lywhz.isText(node)&&node.nodeValue.length>0){offset=directionLeft?0:node.nodeValue.length,container=node,normalized=!0;break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]&&!isTableCell$3(node)){offset=dom.nodeIndex(node),container=node.parentNode,directionLeft||offset++,normalized=!0;break}}while(node=directionLeft?walker.next():walker.prev())}}}return collapsed&&($_5oonaz1qjh8lywhz.isText(container)&&0===offset&&findTextNodeRelative(dom,isAfterNode,collapsed,!0,container).each(function(pos){container=pos.container(),offset=pos.offset(),normalized=!0}),$_5oonaz1qjh8lywhz.isElement(container)&&(node=container.childNodes[offset],node||(node=container.childNodes[offset-1]),!node||!$_5oonaz1qjh8lywhz.isBr(node)||isPrevNode(node,"A")||hasBrBeforeAfter(dom,node,!1)||hasBrBeforeAfter(dom,node,!0)||findTextNodeRelative(dom,isAfterNode,collapsed,!0,node).each(function(pos){container=pos.container(),offset=pos.offset(),normalized=!0}))),directionLeft&&!collapsed&&$_5oonaz1qjh8lywhz.isText(container)&&offset===container.nodeValue.length&&findTextNodeRelative(dom,isAfterNode,collapsed,!1,container).each(function(pos){container=pos.container(),offset=pos.offset(),normalized=!0}),normalized?Option.some(CaretPosition(container,offset)):Option.none()},normalize$1=function(dom,rng){var collapsed=rng.collapsed,normRng=rng.cloneRange(),startPos=CaretPosition.fromRangeStart(rng);return normalizeEndPoint(dom,collapsed,!0,normRng).each(function(pos){collapsed&&CaretPosition.isAbove(startPos,pos)||normRng.setStart(pos.container(),pos.offset())}),collapsed||normalizeEndPoint(dom,collapsed,!1,normRng).each(function(pos){normRng.setEnd(pos.container(),pos.offset())}),collapsed&&normRng.collapse(!0),$_aayq8q3zjh8lyx2z.isEq(rng,normRng)?Option.none():Option.some(normRng)},$_4v2pn63yjh8lyx2s={normalize:normalize$1},hasRightSideContent=function(schema,container,parentBlock){for(var node,walker=new TreeWalker(container,parentBlock),nonEmptyElementsMap=schema.getNonEmptyElements();node=walker.next();)if(nonEmptyElementsMap[node.nodeName.toLowerCase()]||node.length>0)return!0},scrollToBr=function(dom,selection,brElm){var marker=dom.create("span",{},"&nbsp;");brElm.parentNode.insertBefore(marker,brElm),selection.scrollIntoView(marker),dom.remove(marker)},moveSelectionToBr=function(dom,selection,brElm,extraBr){var rng=dom.createRng();extraBr?(rng.setStartBefore(brElm),rng.setEndBefore(brElm)):(rng.setStartAfter(brElm),rng.setEndAfter(brElm)),selection.setRng(rng)},insertBrAtCaret=function(editor,evt){var brElm,extraBr,selection=editor.selection,dom=editor.dom,rng=selection.getRng();$_4v2pn63yjh8lyx2s.normalize(dom,rng).each(function(normRng){rng.setStart(normRng.startContainer,normRng.startOffset),rng.setEnd(normRng.endContainer,normRng.endOffset)});var offset=rng.startOffset,container=rng.startContainer;if(1===container.nodeType&&container.hasChildNodes()){var isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container,offset=isAfterLastNodeInContainer&&3===container.nodeType?container.nodeValue.length:0}var parentBlock=dom.getParent(container,dom.isBlock),containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null,containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"",isControlKey=evt&&evt.ctrlKey;"LI"!==containerBlockName||isControlKey||(parentBlock=containerBlock),container&&3===container.nodeType&&offset>=container.nodeValue.length&&(hasRightSideContent(editor.schema,container,parentBlock)||(brElm=dom.create("br"),rng.insertNode(brElm),rng.setStartAfter(brElm),rng.setEndAfter(brElm),extraBr=!0)),brElm=dom.create("br"),rng.insertNode(brElm),scrollToBr(dom,selection,brElm),moveSelectionToBr(dom,selection,brElm,extraBr),editor.undoManager.add()},insertBrBefore=function(editor,inline){var br=$_cgttw3zjh8lywdq.fromTag("br");$_4m7u2e2kjh8lywpi.before($_cgttw3zjh8lywdq.fromDom(inline),br),editor.undoManager.add()},insertBrAfter=function(editor,inline){hasBrAfter(editor.getBody(),inline)||$_4m7u2e2kjh8lywpi.after($_cgttw3zjh8lywdq.fromDom(inline),$_cgttw3zjh8lywdq.fromTag("br"));var br=$_cgttw3zjh8lywdq.fromTag("br");$_4m7u2e2kjh8lywpi.after($_cgttw3zjh8lywdq.fromDom(inline),br),scrollToBr(editor.dom,editor.selection,br.dom()),moveSelectionToBr(editor.dom,editor.selection,br.dom(),!1),editor.undoManager.add()},isBeforeBr=function(pos){return $_5oonaz1qjh8lywhz.isBr(pos.getNode())},hasBrAfter=function(rootNode,startNode){return!!isBeforeBr(CaretPosition$1.after(startNode))||$_9kvypj2cjh8lywnz.nextPosition(rootNode,CaretPosition$1.after(startNode)).map(function(pos){return $_5oonaz1qjh8lywhz.isBr(pos.getNode())}).getOr(!1)},isAnchorLink=function(elm){return elm&&"A"===elm.nodeName&&"href"in elm},isInsideAnchor=function(location){return location.fold($_eqpqvr6jh8lyw3s.constant(!1),isAnchorLink,isAnchorLink,$_eqpqvr6jh8lyw3s.constant(!1))},readInlineAnchorLocation=function(editor){var isInlineTarget=$_eqpqvr6jh8lyw3s.curry($_231v7s37jh8lywt3.isInlineTarget,editor),position=CaretPosition$1.fromRangeStart(editor.selection.getRng());return $_6kjy7r3njh8lywzz.readLocation(isInlineTarget,editor.getBody(),position).filter(isInsideAnchor)},insertBrOutsideAnchor=function(editor,location){location.fold($_eqpqvr6jh8lyw3s.noop,$_eqpqvr6jh8lyw3s.curry(insertBrBefore,editor),$_eqpqvr6jh8lyw3s.curry(insertBrAfter,editor),$_eqpqvr6jh8lyw3s.noop)},insert=function(editor,evt){var anchorLocation=readInlineAnchorLocation(editor);anchorLocation.isSome()?anchorLocation.each($_eqpqvr6jh8lyw3s.curry(insertBrOutsideAnchor,editor)):insertBrAtCaret(editor,evt)},$_cg4dz53xjh8lyx2g={insert:insert},adt=$_1ml90g3ijh8lywyp.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),cata=function(subject,onBefore,onOn,onAfter){return subject.fold(onBefore,onOn,onAfter)},getStart=function(situ){return situ.fold($_eqpqvr6jh8lyw3s.identity,$_eqpqvr6jh8lyw3s.identity,$_eqpqvr6jh8lyw3s.identity)},$_fn8a2o42jh8lyx3r={before:adt.before,on:adt.on,after:adt.after,cata:cata,getStart:getStart},type$1=$_1ml90g3ijh8lywyp.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),range$1=$_4jz0ce18jh8lywft.immutable("start","soffset","finish","foffset"),exactFromRange=function(simRange){return type$1.exact(simRange.start(),simRange.soffset(),simRange.finish(),simRange.foffset())},getStart$1=function(selection){return selection.match({domRange:function(rng){return $_cgttw3zjh8lywdq.fromDom(rng.startContainer)},relative:function(startSitu,finishSitu){return $_fn8a2o42jh8lyx3r.getStart(startSitu)},exact:function(start,soffset,finish,foffset){return start}})},getWin=function(selection){var start=getStart$1(selection);return $_a43q0i17jh8lywfe.defaultView(start)},$_bx4foa41jh8lyx3f={domRange:type$1.domRange,relative:type$1.relative,exact:type$1.exact,exactFromRange:exactFromRange,range:range$1,getWin:getWin},browser$3=$_9hkktfnjh8lywc6.detect().browser,clamp=function(offset,element){var max=$_7j1jt210jh8lywdx.isText(element)?$_lh5l42wjh8lywr8.get(element).length:$_a43q0i17jh8lywfe.children(element).length+1;return offset>max?max:offset<0?0:offset},normalizeRng=function(rng){return $_bx4foa41jh8lyx3f.range(rng.start(),clamp(rng.soffset(),rng.start()),rng.finish(),clamp(rng.foffset(),rng.finish()))},isOrContains=function(root,elm){return $_5f6gpb1djh8lywg5.contains(root,elm)||$_5f6gpb1djh8lywg5.eq(root,elm)},isRngInRoot=function(root){return function(rng){return isOrContains(root,rng.start())&&isOrContains(root,rng.finish())}},shouldStore=function(editor){return editor.inline===!0||browser$3.isIE()},nativeRangeToSelectionRange=function(r){return $_bx4foa41jh8lyx3f.range($_cgttw3zjh8lywdq.fromDom(r.startContainer),r.startOffset,$_cgttw3zjh8lywdq.fromDom(r.endContainer),r.endOffset)},readRange=function(win){var selection=win.getSelection(),rng=selection&&0!==selection.rangeCount?Option.from(selection.getRangeAt(0)):Option.none();return rng.map(nativeRangeToSelectionRange)},getBookmark$2=function(root){var win=$_a43q0i17jh8lywfe.defaultView(root);return readRange(win.dom()).filter(isRngInRoot(root))},validate=function(root,bookmark){return Option.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng)},bookmarkToNativeRng=function(bookmark){var rng=document.createRange();try{return rng.setStart(bookmark.start().dom(),bookmark.soffset()),rng.setEnd(bookmark.finish().dom(),bookmark.foffset()),Option.some(rng)}catch(_){return Option.none()}},store=function(editor){var newBookmark=shouldStore(editor)?getBookmark$2($_cgttw3zjh8lywdq.fromDom(editor.getBody())):Option.none();editor.bookmark=newBookmark.isSome()?newBookmark:editor.bookmark},storeNative=function(editor,rng){var root=$_cgttw3zjh8lywdq.fromDom(editor.getBody()),range=shouldStore(editor)?Option.from(rng):Option.none(),newBookmark=range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));editor.bookmark=newBookmark.isSome()?newBookmark:editor.bookmark},getRng=function(editor){var bookmark=editor.bookmark?editor.bookmark:Option.none();return bookmark.bind($_eqpqvr6jh8lyw3s.curry(validate,$_cgttw3zjh8lywdq.fromDom(editor.getBody()))).bind(bookmarkToNativeRng)},restore=function(editor){getRng(editor).each(function(rng){editor.selection.setRng(rng)})},$_eqs11m40jh8lyx31={store:store,storeNative:storeNative,readRange:readRange,restore:restore,getRng:getRng,getBookmark:getBookmark$2,validate:validate},indentElement=function(dom,command,useMargin,value,unit,element){if("false"!==dom.getContentEditable(element)&&"LI"!==element.nodeName){var indentStyleName=useMargin?"margin":"padding";if(indentStyleName="TABLE"===element.nodeName?"margin":indentStyleName,indentStyleName+="rtl"===dom.getStyle(element,"direction",!0)?"Right":"Left","outdent"===command){var styleValue=Math.max(0,parseInt(element.style[indentStyleName]||0,10)-value);dom.setStyle(element,indentStyleName,styleValue?styleValue+unit:"")}else{var styleValue=parseInt(element.style[indentStyleName]||0,10)+value+unit;dom.setStyle(element,indentStyleName,styleValue)}}},handle=function(editor,command){var settings=editor.settings,dom=editor.dom,selection=editor.selection,formatter=editor.formatter,indentUnit=/[a-z%]+$/i.exec(settings.indentation)[0],indentValue=parseInt(settings.indentation,10),useMargin=editor.getParam("indent_use_margin",!1);editor.queryCommandState("InsertUnorderedList")||editor.queryCommandState("InsertOrderedList")||(settings.forced_root_block||dom.getParent(selection.getNode(),dom.isBlock)||formatter.apply("div"),$_5wjzy24jh8lyw2t.each(selection.getSelectedBlocks(),function(element){return indentElement(dom,command,useMargin,indentValue,indentUnit,element)}))},each$9=$_ahowuxkjh8lywbj.each,extend$2=$_ahowuxkjh8lywbj.extend,map$2=$_ahowuxkjh8lywbj.map,inArray$2=$_ahowuxkjh8lywbj.inArray,nativeEvents=$_ahowuxkjh8lywbj.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend"," "),Dispatcher=function(settings){var scope,toggleEvent,self=this,bindings={},returnFalse=function(){return!1},returnTrue=function(){return!0};settings=settings||{},scope=settings.scope||self,toggleEvent=settings.toggleEvent||returnFalse;var fire=function(name,args){var handlers,i,l,callback;if(name=name.toLowerCase(),args=args||{},args.type=name,args.target||(args.target=scope),args.preventDefault||(args.preventDefault=function(){args.isDefaultPrevented=returnTrue},args.stopPropagation=function(){args.isPropagationStopped=returnTrue},args.stopImmediatePropagation=function(){args.isImmediatePropagationStopped=returnTrue},args.isDefaultPrevented=returnFalse,args.isPropagationStopped=returnFalse,args.isImmediatePropagationStopped=returnFalse),settings.beforeFire&&settings.beforeFire(args),handlers=bindings[name])for(i=0,l=handlers.length;i<l;i++){if(callback=handlers[i],callback.once&&off(name,callback.func),args.isImmediatePropagationStopped())return args.stopPropagation(),args;if(callback.func.call(scope,args)===!1)return args.preventDefault(),args}return args},on=function(name,callback,prepend,extra){var handlers,names,i;if(callback===!1&&(callback=returnFalse),callback)for(callback={func:callback},extra&&$_ahowuxkjh8lywbj.extend(callback,extra),names=name.toLowerCase().split(" "),i=names.length;i--;)name=names[i],handlers=bindings[name],handlers||(handlers=bindings[name]=[],toggleEvent(name,!0)),prepend?handlers.unshift(callback):handlers.push(callback);return self},off=function(name,callback){var i,handlers,bindingName,names,hi;if(name)for(names=name.toLowerCase().split(" "),i=names.length;i--;){if(name=names[i],handlers=bindings[name],!name){for(bindingName in bindings)toggleEvent(bindingName,!1),delete bindings[bindingName];return self}if(handlers){if(callback)for(hi=handlers.length;hi--;)handlers[hi].func===callback&&(handlers=handlers.slice(0,hi).concat(handlers.slice(hi+1)),bindings[name]=handlers);else handlers.length=0;handlers.length||(toggleEvent(name,!1),delete bindings[name])}}else{for(name in bindings)toggleEvent(name,!1);bindings={}}return self},once=function(name,callback,prepend){return on(name,callback,prepend,{once:!0})},has=function(name){return name=name.toLowerCase(),!(!bindings[name]||0===bindings[name].length)};self.fire=fire,self.on=on,self.off=off,self.once=once,self.has=has};Dispatcher.isNative=function(name){return!!nativeEvents[name.toLowerCase()]};var customEventRootDelegates,getEventDispatcher=function(obj){return obj._eventDispatcher||(obj._eventDispatcher=new Dispatcher({scope:obj,toggleEvent:function(name,state){Dispatcher.isNative(name)&&obj.toggleNativeEvent&&obj.toggleNativeEvent(name,state)}})),obj._eventDispatcher},$_fuzxjg45jh8lyx45={fire:function(name,args,bubble){var self=this;if(self.removed&&"remove"!==name)return args;if(args=getEventDispatcher(self).fire(name,args,bubble),bubble!==!1&&self.parent)for(var parent_1=self.parent();parent_1&&!args.isPropagationStopped();)parent_1.fire(name,args,!1),parent_1=parent_1.parent();return args},on:function(name,callback,prepend){return getEventDispatcher(this).on(name,callback,prepend)},off:function(name,callback){return getEventDispatcher(this).off(name,callback)},once:function(name,callback){return getEventDispatcher(this).once(name,callback)},hasEventListeners:function(name){return getEventDispatcher(this).has(name)}},read$2=function(element,attr){var value=$_3da62i14jh8lyweo.get(element,attr);return void 0===value||""===value?[]:value.split(" ")},add=function(element,attr,id){var old=read$2(element,attr),nu=old.concat([id]);$_3da62i14jh8lyweo.set(element,attr,nu.join(" "))},remove$4=function(element,attr,id){var nu=$_5wjzy24jh8lyw2t.filter(read$2(element,attr),function(v){return v!==id});nu.length>0?$_3da62i14jh8lyweo.set(element,attr,nu.join(" ")):$_3da62i14jh8lyweo.remove(element,attr)},$_5xj9rq4bjh8lyx4m={read:read$2,add:add,remove:remove$4},supports=function(element){return void 0!==element.dom().classList},get$4=function(element){return $_5xj9rq4bjh8lyx4m.read(element,"class")},add$1=function(element,clazz){return $_5xj9rq4bjh8lyx4m.add(element,"class",clazz)},remove$5=function(element,clazz){return $_5xj9rq4bjh8lyx4m.remove(element,"class",clazz)},toggle=function(element,clazz){$_5wjzy24jh8lyw2t.contains(get$4(element),clazz)?remove$5(element,clazz):add$1(element,clazz)},$_eprb6o4ajh8lyx4j={get:get$4,add:add$1,remove:remove$5,toggle:toggle,supports:supports},add$2=function(element,clazz){$_eprb6o4ajh8lyx4j.supports(element)?element.dom().classList.add(clazz):$_eprb6o4ajh8lyx4j.add(element,clazz)},cleanClass=function(element){var classList=$_eprb6o4ajh8lyx4j.supports(element)?element.dom().classList:$_eprb6o4ajh8lyx4j.get(element);0===classList.length&&$_3da62i14jh8lyweo.remove(element,"class")},remove$6=function(element,clazz){if($_eprb6o4ajh8lyx4j.supports(element)){var classList=element.dom().classList;classList.remove(clazz)}else $_eprb6o4ajh8lyx4j.remove(element,clazz);cleanClass(element)},toggle$1=function(element,clazz){return $_eprb6o4ajh8lyx4j.supports(element)?element.dom().classList.toggle(clazz):$_eprb6o4ajh8lyx4j.toggle(element,clazz)},toggler=function(element,clazz){var hasClasslist=$_eprb6o4ajh8lyx4j.supports(element),classList=element.dom().classList,off=function(){hasClasslist?classList.remove(clazz):$_eprb6o4ajh8lyx4j.remove(element,clazz)},on=function(){hasClasslist?classList.add(clazz):$_eprb6o4ajh8lyx4j.add(element,clazz)};return Toggler(off,on,has$1(element,clazz))},has$1=function(element,clazz){return $_eprb6o4ajh8lyx4j.supports(element)&&element.dom().classList.contains(clazz)},$_6hv60f48jh8lyx4g={add:add$2,remove:remove$6,toggle:toggle$1,toggler:toggler,has:has$1},firePreProcess=function(editor,args){return editor.fire("PreProcess",args)},firePostProcess=function(editor,args){return editor.fire("PostProcess",args)},fireRemove=function(editor){return editor.fire("remove")},fireSwitchMode=function(editor,mode){return editor.fire("SwitchMode",{mode:mode})},fireObjectResizeStart=function(editor,target,width,height){editor.fire("ObjectResizeStart",{target:target,width:width,height:height})},fireObjectResized=function(editor,target,width,height){editor.fire("ObjectResized",{target:target,width:width,height:height})},$_a4fgrn4cjh8lyx4q={firePreProcess:firePreProcess,firePostProcess:firePostProcess,fireRemove:fireRemove,fireSwitchMode:fireSwitchMode,fireObjectResizeStart:fireObjectResizeStart,fireObjectResized:fireObjectResized},setEditorCommandState=function(editor,cmd,state){try{editor.getDoc().execCommand(cmd,!1,state)}catch(ex){}},toggleClass=function(elm,cls,state){$_6hv60f48jh8lyx4g.has(elm,cls)&&state===!1?$_6hv60f48jh8lyx4g.remove(elm,cls):state&&$_6hv60f48jh8lyx4g.add(elm,cls)},toggleReadOnly=function(editor,state){toggleClass($_cgttw3zjh8lywdq.fromDom(editor.getBody()),"mce-content-readonly",state),state?(editor.selection.controlSelection.hideResizeRect(),editor.readonly=!0,editor.getBody().contentEditable="false"):(editor.readonly=!1,editor.getBody().contentEditable="true",setEditorCommandState(editor,"StyleWithCSS",!1),setEditorCommandState(editor,"enableInlineTableEditing",!1),setEditorCommandState(editor,"enableObjectResizing",!1),editor.focus(),editor.nodeChanged())},setMode=function(editor,mode){mode!==getMode(editor)&&(editor.initialized?toggleReadOnly(editor,"readonly"===mode):editor.on("init",function(){toggleReadOnly(editor,"readonly"===mode)}),$_a4fgrn4cjh8lyx4q.fireSwitchMode(editor,mode))},getMode=function(editor){return editor.readonly?"readonly":"design"},isReadOnly=function(editor){return editor.readonly===!0},DOM$1=DOMUtils$1.DOM,getEventTarget=function(editor,eventName){return"selectionchange"===eventName?editor.getDoc():!editor.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)?editor.getDoc().documentElement:editor.settings.event_root?(editor.eventRoot||(editor.eventRoot=DOM$1.select(editor.settings.event_root)[0]),editor.eventRoot):editor.getBody()},isListening=function(editor){return!editor.hidden&&!editor.readonly},fireEvent=function(editor,eventName,e){isListening(editor)?editor.fire(eventName,e):isReadOnly(editor)&&e.preventDefault()},bindEventDelegate=function(editor,eventName){var eventRootElm,delegate;if(editor.delegates||(editor.delegates={}),!editor.delegates[eventName]&&!editor.removed)if(eventRootElm=getEventTarget(editor,eventName),editor.settings.event_root){if(customEventRootDelegates||(customEventRootDelegates={},editor.editorManager.on("removeEditor",function(){var name;if(!editor.editorManager.activeEditor&&customEventRootDelegates){for(name in customEventRootDelegates)editor.dom.unbind(getEventTarget(editor,name));customEventRootDelegates=null}})),customEventRootDelegates[eventName])return;delegate=function(e){for(var target=e.target,editors=editor.editorManager.get(),i=editors.length;i--;){var body=editors[i].getBody();(body===target||DOM$1.isChildOf(target,body))&&fireEvent(editors[i],eventName,e)}},customEventRootDelegates[eventName]=delegate,DOM$1.bind(eventRootElm,eventName,delegate)}else delegate=function(e){fireEvent(editor,eventName,e)},DOM$1.bind(eventRootElm,eventName,delegate),editor.delegates[eventName]=delegate},EditorObservable={bindPendingEventDelegates:function(){var self=this;$_ahowuxkjh8lywbj.each(self._pendingNativeEvents,function(name){bindEventDelegate(self,name)})},toggleNativeEvent:function(name,state){var self=this;"focus"!==name&&"blur"!==name&&(state?self.initialized?bindEventDelegate(self,name):self._pendingNativeEvents?self._pendingNativeEvents.push(name):self._pendingNativeEvents=[name]:self.initialized&&(self.dom.unbind(getEventTarget(self,name),name,self.delegates[name]),
delete self.delegates[name]))},unbindAllNativeEvents:function(){var name,self=this,body=self.getBody(),dom=self.dom;if(self.delegates){for(name in self.delegates)self.dom.unbind(getEventTarget(self,name),name,self.delegates[name]);delete self.delegates}!self.inline&&body&&dom&&(body.onload=null,dom.unbind(self.getWin()),dom.unbind(self.getDoc())),dom&&(dom.unbind(body),dom.unbind(self.getContainer()))}};EditorObservable=$_ahowuxkjh8lywbj.extend({},$_fuzxjg45jh8lyx45,EditorObservable);var VDirection,EditorObservable$1=EditorObservable,each$10=$_ahowuxkjh8lywbj.each,explode$2=$_ahowuxkjh8lywbj.explode,keyCodeLookup={f9:120,f10:121,f11:122},modifierNames=$_ahowuxkjh8lywbj.makeMap("alt,ctrl,shift,meta,access"),any$1=function(predicate){return $_6hl03835jh8lywsm.first(predicate).isSome()},ancestor$3=function(scope,predicate,isRoot){return $_6hl03835jh8lywsm.ancestor(scope,predicate,isRoot).isSome()},closest$3=function(scope,predicate,isRoot){return $_6hl03835jh8lywsm.closest(scope,predicate,isRoot).isSome()},sibling$4=function(scope,predicate){return $_6hl03835jh8lywsm.sibling(scope,predicate).isSome()},child$4=function(scope,predicate){return $_6hl03835jh8lywsm.child(scope,predicate).isSome()},descendant$3=function(scope,predicate){return $_6hl03835jh8lywsm.descendant(scope,predicate).isSome()},$_1jfttr4gjh8lyx5b={any:any$1,ancestor:ancestor$3,closest:closest$3,sibling:sibling$4,child:child$4,descendant:descendant$3},focus=function(element){element.dom().focus()},blur=function(element){element.dom().blur()},hasFocus=function(element){var doc=$_a43q0i17jh8lywfe.owner(element).dom();return element.dom()===doc.activeElement},active=function(_doc){var doc=void 0!==_doc?_doc.dom():document;return Option.from(doc.activeElement).map($_cgttw3zjh8lywdq.fromDom)},focusInside=function(element){var doc=$_a43q0i17jh8lywfe.owner(element),inside=active(doc).filter(function(a){return $_1jfttr4gjh8lyx5b.closest(a,$_eqpqvr6jh8lyw3s.curry($_5f6gpb1djh8lywg5.eq,element))});inside.fold(function(){focus(element)},$_eqpqvr6jh8lyw3s.noop)},search=function(element){return active($_a43q0i17jh8lywfe.owner(element)).filter(function(e){return element.dom().contains(e.dom())})},$_717ku14fjh8lyx55={hasFocus:hasFocus,focus:focus,blur:blur,active:active,search:search,focusInside:focusInside},getContentEditableHost=function(editor,node){return editor.dom.getParent(node,function(node){return"true"===editor.dom.getContentEditable(node)})},getCollapsedNode=function(rng){return rng.collapsed?Option.from(getNode(rng.startContainer,rng.startOffset)).map($_cgttw3zjh8lywdq.fromDom):Option.none()},getFocusInElement=function(root,rng){return getCollapsedNode(rng).bind(function(node){return isTableSection(node)?Option.some(node):$_5f6gpb1djh8lywg5.contains(root,node)===!1?Option.some(root):Option.none()})},normalizeSelection=function(editor,rng){getFocusInElement($_cgttw3zjh8lywdq.fromDom(editor.getBody()),rng).bind(function(elm){return $_9kvypj2cjh8lywnz.firstPositionIn(elm.dom())}).fold(function(){editor.selection.normalize()},function(caretPos){return editor.selection.setRng(caretPos.toRange())})},focusBody=function(body){if(body.setActive)try{body.setActive()}catch(ex){body.focus()}else body.focus()},hasElementFocus=function(elm){return $_717ku14fjh8lyx55.hasFocus(elm)||$_717ku14fjh8lyx55.search(elm).isSome()},hasIframeFocus=function(editor){return editor.iframeElement&&$_717ku14fjh8lyx55.hasFocus($_cgttw3zjh8lywdq.fromDom(editor.iframeElement))},hasInlineFocus=function(editor){var rawBody=editor.getBody();return rawBody&&hasElementFocus($_cgttw3zjh8lywdq.fromDom(rawBody))},hasFocus$1=function(editor){return editor.inline?hasInlineFocus(editor):hasIframeFocus(editor)},focusEditor=function(editor){var selection=editor.selection,contentEditable=editor.settings.content_editable,body=editor.getBody(),rng=selection.getRng();editor.quirks.refreshContentEditable();var contentEditableHost=getContentEditableHost(editor,selection.getNode());return editor.$.contains(body,contentEditableHost)?(focusBody(contentEditableHost),normalizeSelection(editor,rng),void activateEditor(editor)):(void 0!==editor.bookmark&&hasFocus$1(editor)===!1&&$_eqs11m40jh8lyx31.getRng(editor).each(function(bookmarkRng){editor.selection.setRng(bookmarkRng),rng=bookmarkRng}),contentEditable||($_9bpim8ajh8lyw68.opera||focusBody(body),editor.getWin().focus()),($_9bpim8ajh8lyw68.gecko||contentEditable)&&(focusBody(body),normalizeSelection(editor,rng)),void activateEditor(editor))},activateEditor=function(editor){return editor.editorManager.setActive(editor)},focus$1=function(editor,skipFocus){editor.removed||(skipFocus?activateEditor(editor):focusEditor(editor))},$_cnu79r4ejh8lyx4x={focus:focus$1,hasFocus:hasFocus$1},getProp=function(propName,elm){var rawElm=elm.dom();return rawElm[propName]},getComputedSizeProp=function(propName,elm){return parseInt($_36knnd12jh8lywe1.get(elm,propName),10)},getClientWidth=$_eqpqvr6jh8lyw3s.curry(getProp,"clientWidth"),getClientHeight=$_eqpqvr6jh8lyw3s.curry(getProp,"clientHeight"),getMarginTop=$_eqpqvr6jh8lyw3s.curry(getComputedSizeProp,"margin-top"),getMarginLeft=$_eqpqvr6jh8lyw3s.curry(getComputedSizeProp,"margin-left"),getBoundingClientRect$1=function(elm){return elm.dom().getBoundingClientRect()},isInsideElementContentArea=function(bodyElm,clientX,clientY){var clientWidth=getClientWidth(bodyElm),clientHeight=getClientHeight(bodyElm);return clientX>=0&&clientY>=0&&clientX<=clientWidth&&clientY<=clientHeight},transpose=function(inline,elm,clientX,clientY){var clientRect=getBoundingClientRect$1(elm),deltaX=inline?clientRect.left+elm.dom().clientLeft+getMarginLeft(elm):0,deltaY=inline?clientRect.top+elm.dom().clientTop+getMarginTop(elm):0,x=clientX-deltaX,y=clientY-deltaY;return{x:x,y:y}},isXYInContentArea=function(editor,clientX,clientY){var bodyElm=$_cgttw3zjh8lywdq.fromDom(editor.getBody()),targetElm=editor.inline?bodyElm:$_a43q0i17jh8lywfe.documentElement(bodyElm),transposedPoint=transpose(editor.inline,targetElm,clientX,clientY);return isInsideElementContentArea(targetElm,transposedPoint.x,transposedPoint.y)},fromDomSafe=function(node){return Option.from(node).map($_cgttw3zjh8lywdq.fromDom)},isEditorAttachedToDom=function(editor){var rawContainer=editor.inline?editor.getBody():editor.getContentAreaContainer();return fromDomSafe(rawContainer).map(function(container){return $_5f6gpb1djh8lywg5.contains($_a43q0i17jh8lywfe.owner(container),container)}).getOr(!1)},$_7f1iw94jjh8lyx60={isXYInContentArea:isXYInContentArea,isEditorAttachedToDom:isEditorAttachedToDom},PluginManager=AddOnManager.PluginManager,resolvePluginName=function(targetUrl,suffix){for(var name_1 in PluginManager.urls){var matchUrl=PluginManager.urls[name_1]+"/plugin"+suffix+".js";if(matchUrl===targetUrl)return name_1}return null},pluginUrlToMessage=function(editor,url){var plugin=resolvePluginName(url,editor.suffix);return plugin?"Failed to load plugin: "+plugin+" from url "+url:"Failed to load plugin url: "+url},displayNotification=function(editor,message){editor.notificationManager.open({type:"error",text:message})},displayError=function(editor,message){editor._skinLoaded?displayNotification(editor,message):editor.on("SkinLoaded",function(){displayNotification(editor,message)})},uploadError=function(editor,message){displayError(editor,"Failed to upload image: "+message)},pluginLoadError=function(editor,url){displayError(editor,pluginUrlToMessage(editor,url))},initError=function(message){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];var console=window.console;console&&(console.error?console.error.apply(console,arguments):console.log.apply(console,arguments))},$_5vy074njh8lyx6h={pluginLoadError:pluginLoadError,uploadError:uploadError,displayError:displayError,initError:initError},PluginManager$1=AddOnManager.PluginManager,ThemeManager=AddOnManager.ThemeManager,requestAnimationFrame$1=function(callback){var f=$_99xmy7cjh8lyw6k.getOrDie("requestAnimationFrame");f(callback)},atob=function(base64){var f=$_99xmy7cjh8lyw6k.getOrDie("atob");return f(base64)},$_bfbm2n50jh8lyx88={atob:atob,requestAnimationFrame:requestAnimationFrame$1},blobUriToBlob=function(url){return new promiseObj(function(resolve,reject){var rejectWithError=function(){reject("Cannot convert "+url+" to Blob. Resource might not exist or is inaccessible.")};try{var xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="blob",xhr.onload=function(){200===this.status?resolve(this.response):rejectWithError()},xhr.onerror=rejectWithError,xhr.send()}catch(ex){rejectWithError()}})},parseDataUri=function(uri){var type,matches;return uri=decodeURIComponent(uri).split(","),matches=/data:([^;]+)/.exec(uri[0]),matches&&(type=matches[1]),{type:type,data:uri[1]}},dataUriToBlob=function(uri){return new promiseObj(function(resolve){var str,arr,i;uri=parseDataUri(uri);try{str=$_bfbm2n50jh8lyx88.atob(uri.data)}catch(e){return void resolve(new Blob([]))}for(arr=new Uint8Array(str.length),i=0;i<arr.length;i++)arr[i]=str.charCodeAt(i);resolve(new Blob([arr],{type:uri.type}))})},uriToBlob=function(url){return 0===url.indexOf("blob:")?blobUriToBlob(url):0===url.indexOf("data:")?dataUriToBlob(url):null},blobToDataUri=function(blob){return new promiseObj(function(resolve){var reader=new FileReader;reader.onloadend=function(){resolve(reader.result)},reader.readAsDataURL(blob)})},$_ap7oid4wjh8lyx7y={uriToBlob:uriToBlob,blobToDataUri:blobToDataUri,parseDataUri:parseDataUri},count=0,uniqueId=function(prefix){return(prefix||"blobid")+count++},imageToBlobInfo=function(blobCache,img,resolve,reject){var base64,blobInfo;return 0===img.src.indexOf("blob:")?(blobInfo=blobCache.getByUri(img.src),void(blobInfo?resolve({image:img,blobInfo:blobInfo}):$_ap7oid4wjh8lyx7y.uriToBlob(img.src).then(function(blob){$_ap7oid4wjh8lyx7y.blobToDataUri(blob).then(function(dataUri){base64=$_ap7oid4wjh8lyx7y.parseDataUri(dataUri).data,blobInfo=blobCache.create(uniqueId(),blob,base64),blobCache.add(blobInfo),resolve({image:img,blobInfo:blobInfo})})},function(err){reject(err)}))):(base64=$_ap7oid4wjh8lyx7y.parseDataUri(img.src).data,blobInfo=blobCache.findFirst(function(cachedBlobInfo){return cachedBlobInfo.base64()===base64}),void(blobInfo?resolve({image:img,blobInfo:blobInfo}):$_ap7oid4wjh8lyx7y.uriToBlob(img.src).then(function(blob){blobInfo=blobCache.create(uniqueId(),blob,base64),blobCache.add(blobInfo),resolve({image:img,blobInfo:blobInfo})},function(err){reject(err)})))},getAllImages=function(elm){return elm?elm.getElementsByTagName("img"):[]},count$1=0,seed=function(){var rnd=function(){return Math.round(4294967295*Math.random()).toString(36)},now=(new Date).getTime();return"s"+now.toString(36)+rnd()+rnd()+rnd()},uuid=function(prefix){return prefix+count$1++ +seed()},$_co2y7g52jh8lyx8f={uuid:uuid},isBlockElement=function(blockElements,node){return blockElements.hasOwnProperty(node.nodeName)},isValidTarget=function(blockElements,node){return!!$_5oonaz1qjh8lywhz.isText(node)||!!$_5oonaz1qjh8lywhz.isElement(node)&&(!isBlockElement(blockElements,node)&&!$_eyp5ec2njh8lywpo.isBookmarkNode(node))},hasBlockParent=function(blockElements,root,node){return $_5wjzy24jh8lyw2t.exists($_dyxtub3ejh8lywxq.parents($_cgttw3zjh8lywdq.fromDom(node),$_cgttw3zjh8lywdq.fromDom(root)),function(elm){return isBlockElement(blockElements,elm.dom())})},shouldRemoveTextNode=function(blockElements,node){if($_5oonaz1qjh8lywhz.isText(node)){if(0===node.nodeValue.length)return!0;if(/^\s+$/.test(node.nodeValue)&&(!node.nextSibling||isBlockElement(blockElements,node.nextSibling)))return!0}return!1},addRootBlocks=function(editor){var rng,startContainer,startOffset,endContainer,endOffset,rootBlockNode,tempNode,wrapped,restoreSelection,rootNodeName,forcedRootBlock,settings=editor.settings,dom=editor.dom,selection=editor.selection,schema=editor.schema,blockElements=schema.getBlockElements(),node=selection.getStart(),rootNode=editor.getBody();if(forcedRootBlock=settings.forced_root_block,node&&$_5oonaz1qjh8lywhz.isElement(node)&&forcedRootBlock&&(rootNodeName=rootNode.nodeName.toLowerCase(),schema.isValidChild(rootNodeName,forcedRootBlock.toLowerCase())&&!hasBlockParent(blockElements,rootNode,node))){for(rng=selection.getRng(),startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,restoreSelection=$_cnu79r4ejh8lyx4x.hasFocus(editor),node=rootNode.firstChild;node;)if(isValidTarget(blockElements,node)){if(shouldRemoveTextNode(blockElements,node)){tempNode=node,node=node.nextSibling,dom.remove(tempNode);continue}rootBlockNode||(rootBlockNode=dom.create(forcedRootBlock,editor.settings.forced_root_block_attrs),node.parentNode.insertBefore(rootBlockNode,node),wrapped=!0),tempNode=node,node=node.nextSibling,rootBlockNode.appendChild(tempNode)}else rootBlockNode=null,node=node.nextSibling;wrapped&&restoreSelection&&(rng.setStart(startContainer,startOffset),rng.setEnd(endContainer,endOffset),selection.setRng(rng),editor.nodeChanged())}},setup=function(editor){editor.settings.forced_root_block&&editor.on("NodeChange",$_eqpqvr6jh8lyw3s.curry(addRootBlocks,editor))},$_85z7kh54jh8lyx8j={setup:setup},getStartNode=function(rng){var sc=rng.startContainer,so=rng.startOffset;return $_5oonaz1qjh8lywhz.isText(sc)?0===so?Option.some($_cgttw3zjh8lywdq.fromDom(sc)):Option.none():Option.from(sc.childNodes[so]).map($_cgttw3zjh8lywdq.fromDom)},getEndNode=function(rng){var ec=rng.endContainer,eo=rng.endOffset;return $_5oonaz1qjh8lywhz.isText(ec)?eo===ec.data.length?Option.some($_cgttw3zjh8lywdq.fromDom(ec)):Option.none():Option.from(ec.childNodes[eo-1]).map($_cgttw3zjh8lywdq.fromDom)},getFirstChildren=function(node){return $_a43q0i17jh8lywfe.firstChild(node).fold($_eqpqvr6jh8lyw3s.constant([node]),function(child){return[node].concat(getFirstChildren(child))})},getLastChildren$1=function(node){return $_a43q0i17jh8lywfe.lastChild(node).fold($_eqpqvr6jh8lyw3s.constant([node]),function(child){return"br"===$_7j1jt210jh8lywdx.name(child)?$_a43q0i17jh8lywfe.prevSibling(child).map(function(sibling){return[node].concat(getLastChildren$1(sibling))}).getOr([]):[node].concat(getLastChildren$1(child))})},hasAllContentsSelected=function(elm,rng){return $_b8twwq26jh8lywmm.liftN([getStartNode(rng),getEndNode(rng)],function(startNode,endNode){var start=$_5wjzy24jh8lyw2t.find(getFirstChildren(elm),$_eqpqvr6jh8lyw3s.curry($_5f6gpb1djh8lywg5.eq,startNode)),end=$_5wjzy24jh8lyw2t.find(getLastChildren$1(elm),$_eqpqvr6jh8lyw3s.curry($_5f6gpb1djh8lywg5.eq,endNode));return start.isSome()&&end.isSome()}).getOr(!1)},moveEndPoint$1=function(dom,rng,node,start){var root=node,walker=new TreeWalker(node,root),nonEmptyElementsMap=dom.schema.getNonEmptyElements();do{if(3===node.nodeType&&0!==$_ahowuxkjh8lywbj.trim(node.nodeValue).length)return void(start?rng.setStart(node,0):rng.setEnd(node,node.nodeValue.length));if(nonEmptyElementsMap[node.nodeName]&&!/^(TD|TH)$/.test(node.nodeName))return void(start?rng.setStartBefore(node):"BR"===node.nodeName?rng.setEndBefore(node):rng.setEndAfter(node));if($_9bpim8ajh8lyw68.ie&&$_9bpim8ajh8lyw68.ie<11&&dom.isBlock(node)&&dom.isEmpty(node))return void(start?rng.setStart(node,0):rng.setEnd(node,0))}while(node=start?walker.next():walker.prev());"BODY"===root.nodeName&&(start?rng.setStart(root,0):rng.setEnd(root,root.childNodes.length))},hasAnyRanges=function(editor){var sel=editor.selection.getSel();return sel&&sel.rangeCount>0},getAbsolutePosition=function(elm){var doc,docElem,win,clientRect;return clientRect=elm.getBoundingClientRect(),doc=elm.ownerDocument,docElem=doc.documentElement,win=doc.defaultView,{top:clientRect.top+win.pageYOffset-docElem.clientTop,left:clientRect.left+win.pageXOffset-docElem.clientLeft}},getBodyPosition=function(editor){return editor.inline?getAbsolutePosition(editor.getBody()):{left:0,top:0}},getScrollPosition=function(editor){var body=editor.getBody();return editor.inline?{left:body.scrollLeft,top:body.scrollTop}:{left:0,top:0}},getBodyScroll=function(editor){var body=editor.getBody(),docElm=editor.getDoc().documentElement,inlineScroll={left:body.scrollLeft,top:body.scrollTop},iframeScroll={left:body.scrollLeft||docElm.scrollLeft,top:body.scrollTop||docElm.scrollTop};return editor.inline?inlineScroll:iframeScroll},getMousePosition=function(editor,event){if(event.target.ownerDocument!==editor.getDoc()){var iframePosition=getAbsolutePosition(editor.getContentAreaContainer()),scrollPosition=getBodyScroll(editor);return{left:event.pageX-iframePosition.left+scrollPosition.left,top:event.pageY-iframePosition.top+scrollPosition.top}}return{left:event.pageX,top:event.pageY}},calculatePosition=function(bodyPosition,scrollPosition,mousePosition){return{pageX:mousePosition.left-bodyPosition.left+scrollPosition.left,pageY:mousePosition.top-bodyPosition.top+scrollPosition.top}},calc=function(editor,event){return calculatePosition(getBodyPosition(editor),getScrollPosition(editor),getMousePosition(editor,event))},$_car16w59jh8lyxa8={calc:calc},isContentEditableFalse$7=$_5oonaz1qjh8lywhz.isContentEditableFalse,isContentEditableTrue$4=$_5oonaz1qjh8lywhz.isContentEditableTrue,isDraggable=function(rootElm,elm){return isContentEditableFalse$7(elm)&&elm!==rootElm},isValidDropTarget=function(editor,targetElement,dragElement){return targetElement!==dragElement&&!editor.dom.isChildOf(targetElement,dragElement)&&!isContentEditableFalse$7(targetElement)},cloneElement=function(elm){var cloneElm=elm.cloneNode(!0);return cloneElm.removeAttribute("data-mce-selected"),cloneElm},createGhost=function(editor,elm,width,height){var clonedElm=elm.cloneNode(!0);editor.dom.setStyles(clonedElm,{width:width,height:height}),editor.dom.setAttrib(clonedElm,"data-mce-selected",null);var ghostElm=editor.dom.create("div",{"class":"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return editor.dom.setStyles(ghostElm,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:width,height:height}),editor.dom.setStyles(clonedElm,{margin:0,boxSizing:"border-box"}),ghostElm.appendChild(clonedElm),ghostElm},appendGhostToBody=function(ghostElm,bodyElm){ghostElm.parentNode!==bodyElm&&bodyElm.appendChild(ghostElm)},moveGhost=function(ghostElm,position,width,height,maxX,maxY){var overflowX=0,overflowY=0;ghostElm.style.left=position.pageX+"px",ghostElm.style.top=position.pageY+"px",position.pageX+width>maxX&&(overflowX=position.pageX+width-maxX),position.pageY+height>maxY&&(overflowY=position.pageY+height-maxY),ghostElm.style.width=width-overflowX+"px",ghostElm.style.height=height-overflowY+"px"},removeElement=function(elm){elm&&elm.parentNode&&elm.parentNode.removeChild(elm)},isLeftMouseButtonPressed=function(e){return 0===e.button},hasDraggableElement=function(state){return state.element},applyRelPos=function(state,position){return{pageX:position.pageX-state.relX,pageY:position.pageY+5}},start$1=function(state,editor){return function(e){if(isLeftMouseButtonPressed(e)){var ceElm=$_9tjm51ljh8lywbq.find(editor.dom.getParents(e.target),$_8aqzj925jh8lywmj.or(isContentEditableFalse$7,isContentEditableTrue$4));if(isDraggable(editor.getBody(),ceElm)){var elmPos=editor.dom.getPos(ceElm),bodyElm=editor.getBody(),docElm=editor.getDoc().documentElement;state.element=ceElm,state.screenX=e.screenX,state.screenY=e.screenY,state.maxX=(editor.inline?bodyElm.scrollWidth:docElm.offsetWidth)-2,state.maxY=(editor.inline?bodyElm.scrollHeight:docElm.offsetHeight)-2,state.relX=e.pageX-elmPos.x,state.relY=e.pageY-elmPos.y,state.width=ceElm.offsetWidth,state.height=ceElm.offsetHeight,state.ghost=createGhost(editor,ceElm,state.width,state.height)}}}},move$1=function(state,editor){var throttledPlaceCaretAt=$_8sy3pfhjh8lyw95.throttle(function(clientX,clientY){editor._selectionOverrides.hideFakeCaret(),editor.selection.placeCaretAt(clientX,clientY)},0);return function(e){var movement=Math.max(Math.abs(e.screenX-state.screenX),Math.abs(e.screenY-state.screenY));if(hasDraggableElement(state)&&!state.dragging&&movement>10){var args=editor.fire("dragstart",{target:state.element});if(args.isDefaultPrevented())return;state.dragging=!0,editor.focus()}if(state.dragging){var targetPos=applyRelPos(state,$_car16w59jh8lyxa8.calc(editor,e));appendGhostToBody(state.ghost,editor.getBody()),moveGhost(state.ghost,targetPos,state.width,state.height,state.maxX,state.maxY),throttledPlaceCaretAt(e.clientX,e.clientY)}}},getRawTarget=function(selection){var rng=selection.getSel().getRangeAt(0),startContainer=rng.startContainer;return 3===startContainer.nodeType?startContainer.parentNode:startContainer},drop=function(state,editor){return function(e){if(state.dragging&&isValidDropTarget(editor,getRawTarget(editor.selection),state.element)){var targetClone_1=cloneElement(state.element),args=editor.fire("drop",{targetClone:targetClone_1,clientX:e.clientX,clientY:e.clientY});args.isDefaultPrevented()||(targetClone_1=args.targetClone,editor.undoManager.transact(function(){removeElement(state.element),editor.insertContent(editor.dom.getOuterHTML(targetClone_1)),editor._selectionOverrides.hideFakeCaret()}))}removeDragState(state)}},stop=function(state,editor){return function(){state.dragging&&editor.fire("dragend"),removeDragState(state)}},removeDragState=function(state){state.dragging=!1,state.element=null,removeElement(state.ghost)},bindFakeDragEvents=function(editor){var pageDom,dragStartHandler,dragHandler,dropHandler,dragEndHandler,rootDocument,state={};pageDom=DOMUtils$1.DOM,rootDocument=document,dragStartHandler=start$1(state,editor),dragHandler=move$1(state,editor),dropHandler=drop(state,editor),dragEndHandler=stop(state,editor),editor.on("mousedown",dragStartHandler),editor.on("mousemove",dragHandler),editor.on("mouseup",dropHandler),pageDom.bind(rootDocument,"mousemove",dragHandler),pageDom.bind(rootDocument,"mouseup",dragEndHandler),editor.on("remove",function(){pageDom.unbind(rootDocument,"mousemove",dragHandler),pageDom.unbind(rootDocument,"mouseup",dragEndHandler)})},blockIeDrop=function(editor){editor.on("drop",function(e){var realTarget="undefined"!=typeof e.clientX?editor.getDoc().elementFromPoint(e.clientX,e.clientY):null;(isContentEditableFalse$7(realTarget)||isContentEditableFalse$7(editor.dom.getContentEditableParent(realTarget)))&&e.preventDefault()})},init=function(editor){bindFakeDragEvents(editor),blockIeDrop(editor)},$_8bbr0a58jh8lyxa1={init:init},getNodeClientRects=function(node){var toArrayWithNode=function(clientRects){return $_9tjm51ljh8lywbq.map(clientRects,function(clientRect){return clientRect=clone$1(clientRect),clientRect.node=node,clientRect})};if($_5oonaz1qjh8lywhz.isElement(node))return toArrayWithNode(node.getClientRects());if($_5oonaz1qjh8lywhz.isText(node)){var rng=node.ownerDocument.createRange();return rng.setStart(node,0),rng.setEnd(node,node.data.length),toArrayWithNode(rng.getClientRects())}},getClientRects=function(node){return $_9tjm51ljh8lywbq.reduce(node,function(result,node){return result.concat(getNodeClientRects(node))},[])};!function(VDirection){VDirection[VDirection.Up=-1]="Up",VDirection[VDirection.Down=1]="Down"}(VDirection||(VDirection={}));var findUntil=function(direction,root,predicateFn,node){for(;node=findNode(node,direction,isEditableCaretCandidate,root);)if(predicateFn(node))return},walkUntil=function(direction,isAboveFn,isBeflowFn,root,predicateFn,caretPosition){var node,targetClientRect,line=0,result=[],add=function(node){var i,clientRect,clientRects;for(clientRects=getClientRects([node]),direction===-1&&(clientRects=clientRects.reverse()),i=0;i<clientRects.length;i++)if(clientRect=clientRects[i],!isBeflowFn(clientRect,targetClientRect)){if(result.length>0&&isAboveFn(clientRect,$_9tjm51ljh8lywbq.last(result))&&line++,clientRect.line=line,predicateFn(clientRect))return!0;result.push(clientRect)}};return(targetClientRect=$_9tjm51ljh8lywbq.last(caretPosition.getClientRects()))?(node=caretPosition.getNode(),add(node),findUntil(direction,root,add,node),result):result},aboveLineNumber=function(lineNumber,clientRect){return clientRect.line>lineNumber},isLineNumber=function(lineNumber,clientRect){return clientRect.line===lineNumber},upUntil=$_eqpqvr6jh8lyw3s.curry(walkUntil,VDirection.Up,isAbove,isBelow),downUntil=$_eqpqvr6jh8lyw3s.curry(walkUntil,VDirection.Down,isBelow,isAbove),positionsUntil=function(direction,root,predicateFn,node){var walkFn,isBelowFn,isAboveFn,caretPosition,clientRect,targetClientRect,caretWalker=CaretWalker(root),result=[],line=0,getClientRect=function(caretPosition){return 1===direction?$_9tjm51ljh8lywbq.last(caretPosition.getClientRects()):$_9tjm51ljh8lywbq.last(caretPosition.getClientRects())};1===direction?(walkFn=caretWalker.next,isBelowFn=isBelow,isAboveFn=isAbove,caretPosition=CaretPosition$1.after(node)):(walkFn=caretWalker.prev,isBelowFn=isAbove,isAboveFn=isBelow,caretPosition=CaretPosition$1.before(node)),targetClientRect=getClientRect(caretPosition);do if(caretPosition.isVisible()&&(clientRect=getClientRect(caretPosition),!isAboveFn(clientRect,targetClientRect))){if(result.length>0&&isBelowFn(clientRect,$_9tjm51ljh8lywbq.last(result))&&line++,clientRect=clone$1(clientRect),clientRect.position=caretPosition,clientRect.line=line,predicateFn(clientRect))return result;result.push(clientRect)}while(caretPosition=walkFn(caretPosition));return result},isAboveLine=function(lineNumber){return function(clientRect){return aboveLineNumber(lineNumber,clientRect)}},isLine=function(lineNumber){return function(clientRect){return isLineNumber(lineNumber,clientRect)}},isContentEditableFalse$8=$_5oonaz1qjh8lywhz.isContentEditableFalse,findNode$1=findNode,distanceToRectLeft=function(clientRect,clientX){return Math.abs(clientRect.left-clientX)},distanceToRectRight=function(clientRect,clientX){return Math.abs(clientRect.right-clientX)},isInside=function(clientX,clientRect){return clientX>=clientRect.left&&clientX<=clientRect.right},findClosestClientRect=function(clientRects,clientX){return $_9tjm51ljh8lywbq.reduce(clientRects,function(oldClientRect,clientRect){var oldDistance,newDistance;return oldDistance=Math.min(distanceToRectLeft(oldClientRect,clientX),distanceToRectRight(oldClientRect,clientX)),newDistance=Math.min(distanceToRectLeft(clientRect,clientX),distanceToRectRight(clientRect,clientX)),isInside(clientX,clientRect)?clientRect:isInside(clientX,oldClientRect)?oldClientRect:newDistance===oldDistance&&isContentEditableFalse$8(clientRect.node)?clientRect:newDistance<oldDistance?clientRect:oldClientRect})},walkUntil$1=function(direction,root,predicateFn,node){for(;node=findNode$1(node,direction,isEditableCaretCandidate,root);)if(predicateFn(node))return},findLineNodeRects=function(root,targetNodeRect){var clientRects=[],collect=function(checkPosFn,node){var lineRects;return lineRects=$_9tjm51ljh8lywbq.filter(getClientRects([node]),function(clientRect){return!checkPosFn(clientRect,targetNodeRect)}),clientRects=clientRects.concat(lineRects),0===lineRects.length};return clientRects.push(targetNodeRect),walkUntil$1(VDirection.Up,root,$_eqpqvr6jh8lyw3s.curry(collect,isAbove),targetNodeRect.node),walkUntil$1(VDirection.Down,root,$_eqpqvr6jh8lyw3s.curry(collect,isBelow),targetNodeRect.node),clientRects},getFakeCaretTargets=function(root){return $_9tjm51ljh8lywbq.filter($_9tjm51ljh8lywbq.toArray(root.getElementsByTagName("*")),isFakeCaretTarget)},caretInfo=function(clientRect,clientX){return{node:clientRect.node,before:distanceToRectLeft(clientRect,clientX)<distanceToRectRight(clientRect,clientX)}},closestCaret=function(root,clientX,clientY){var closestNodeRect,contentEditableFalseNodeRects=getClientRects(getFakeCaretTargets(root)),targetNodeRects=$_9tjm51ljh8lywbq.filter(contentEditableFalseNodeRects,function(rect){return clientY>=rect.top&&clientY<=rect.bottom});return closestNodeRect=findClosestClientRect(targetNodeRects,clientX),closestNodeRect&&(closestNodeRect=findClosestClientRect(findLineNodeRects(root,closestNodeRect),clientX),closestNodeRect&&isFakeCaretTarget(closestNodeRect.node))?caretInfo(closestNodeRect,clientX):null},isXYWithinRange=function(clientX,clientY,range){return!range.collapsed&&$_5wjzy24jh8lyw2t.foldl(range.getClientRects(),function(state,rect){return state||containsXY(rect,clientX,clientY)},!1)},$_3kj84i5djh8lyxan={isXYWithinRange:isXYWithinRange},adaptable=function(fn,rate){var timer=null,args=null,cancel=function(){null!==timer&&(clearTimeout(timer),timer=null,args=null)},throttle=function(){args=arguments,null===timer&&(timer=setTimeout(function(){fn.apply(null,args),timer=null,args=null},rate))};return{cancel:cancel,throttle:throttle}},first$3=function(fn,rate){var timer=null,cancel=function(){null!==timer&&(clearTimeout(timer),timer=null)},throttle=function(){var args=arguments;null===timer&&(timer=setTimeout(function(){fn.apply(null,args),timer=null,args=null},rate))};return{cancel:cancel,throttle:throttle}},last$3=function(fn,rate){var timer=null,cancel=function(){null!==timer&&(clearTimeout(timer),timer=null)},throttle=function(){var args=arguments;null!==timer&&clearTimeout(timer),timer=setTimeout(function(){fn.apply(null,args),timer=null,args=null},rate)};return{cancel:cancel,throttle:throttle}},$_de600j5fjh8lyxas={adaptable:adaptable,first:first$3,last:last$3},setup$1=function(editor){var renderFocusCaret=$_de600j5fjh8lyxas.first(function(){if(!editor.removed){var rng=editor.selection.getRng();if(rng.collapsed){var caretRange=renderRangeCaret(editor,editor.selection.getRng(),!1);editor.selection.setRng(caretRange)}}},0);editor.on("focus",function(){renderFocusCaret.throttle()}),editor.on("blur",function(){renderFocusCaret.cancel()})},$_plloj5ejh8lyxap={setup:setup$1},$_6lsk4i5gjh8lyxau={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return $_9bpim8ajh8lyw68.mac?e.metaKey:e.ctrlKey&&!e.altKey}},isContentEditableTrue$5=$_5oonaz1qjh8lywhz.isContentEditableTrue,isContentEditableFalse$9=$_5oonaz1qjh8lywhz.isContentEditableFalse,isAfterContentEditableFalse$1=isAfterContentEditableFalse,isBeforeContentEditableFalse$1=isBeforeContentEditableFalse,getContentEditableRoot$1=function(editor,node){for(var root=editor.getBody();node&&node!==root;){if(isContentEditableTrue$5(node)||isContentEditableFalse$9(node))return node;node=node.parentNode}return null},SelectionOverrides=function(editor){var selectedContentEditableNode,isBlock=function(node){return editor.dom.isBlock(node)},rootNode=editor.getBody(),fakeCaret=FakeCaret(editor.getBody(),isBlock,function(){return $_cnu79r4ejh8lyx4x.hasFocus(editor)}),realSelectionId="sel-"+editor.dom.uniqueId(),isFakeSelectionElement=function(elm){return editor.dom.hasClass(elm,"mce-offscreen-selection")},getRealSelectionElement=function(){var container=editor.dom.get(realSelectionId);return container?container.getElementsByTagName("*")[0]:container},setRange=function(range){range&&editor.selection.setRng(range)},getRange=function(){return editor.selection.getRng()},showCaret$$1=function(direction,node,before,scrollIntoView){void 0===scrollIntoView&&(scrollIntoView=!0);var e;return e=editor.fire("ShowCaret",{target:node,direction:direction,before:before}),e.isDefaultPrevented()?null:(scrollIntoView&&editor.selection.scrollIntoView(node,direction===-1),fakeCaret.show(before,node))},getNormalizedRangeEndPoint$$1=function(direction,range){return range=normalizeRange(direction,rootNode,range),direction===-1?CaretPosition$1.fromRangeStart(range):CaretPosition$1.fromRangeEnd(range)},showBlockCaretContainer=function(blockCaretContainer){blockCaretContainer.hasAttribute("data-mce-caret")&&(showCaretContainerBlock(blockCaretContainer),setRange(getRange()),editor.selection.scrollIntoView(blockCaretContainer[0]))},registerEvents=function(){editor.on("mouseup",function(e){var range=getRange();range.collapsed&&$_7f1iw94jjh8lyx60.isXYInContentArea(editor,e.clientX,e.clientY)&&setRange(renderCaretAtRange(editor,range,!1))}),editor.on("click",function(e){var contentEditableRoot;contentEditableRoot=getContentEditableRoot$1(editor,e.target),
contentEditableRoot&&(isContentEditableFalse$9(contentEditableRoot)&&(e.preventDefault(),editor.focus()),isContentEditableTrue$5(contentEditableRoot)&&editor.dom.isChildOf(contentEditableRoot,editor.selection.getNode())&&removeContentEditableSelection())}),editor.on("blur NewBlock",function(){removeContentEditableSelection()}),editor.on("ResizeWindow FullscreenStateChanged",function(){return fakeCaret.reposition()});var handleTouchSelect=function(editor){var moved=!1;editor.on("touchstart",function(){moved=!1}),editor.on("touchmove",function(){moved=!0}),editor.on("touchend",function(e){var contentEditableRoot=getContentEditableRoot$1(editor,e.target);isContentEditableFalse$9(contentEditableRoot)&&(moved||(e.preventDefault(),setContentEditableSelection(selectNode(editor,contentEditableRoot))))})},hasNormalCaretPosition=function(elm){var caretWalker=CaretWalker(elm);if(!elm.firstChild)return!1;var startPos=CaretPosition$1.before(elm.firstChild),newPos=caretWalker.next(startPos);return newPos&&!isBeforeContentEditableFalse$1(newPos)&&!isAfterContentEditableFalse$1(newPos)},isInSameBlock$$1=function(node1,node2){var block1=editor.dom.getParent(node1,editor.dom.isBlock),block2=editor.dom.getParent(node2,editor.dom.isBlock);return block1===block2},hasBetterMouseTarget=function(targetNode,caretNode){var targetBlock=editor.dom.getParent(targetNode,editor.dom.isBlock),caretBlock=editor.dom.getParent(caretNode,editor.dom.isBlock);return!(!targetBlock||!editor.dom.isChildOf(targetBlock,caretBlock)||isContentEditableFalse$9(getContentEditableRoot$1(editor,targetBlock))!==!1)||targetBlock&&!isInSameBlock$$1(targetBlock,caretBlock)&&hasNormalCaretPosition(targetBlock)};handleTouchSelect(editor),editor.on("mousedown",function(e){var contentEditableRoot,targetElm=e.target;if((targetElm===rootNode||"HTML"===targetElm.nodeName||editor.dom.isChildOf(targetElm,rootNode))&&$_7f1iw94jjh8lyx60.isXYInContentArea(editor,e.clientX,e.clientY)!==!1)if(contentEditableRoot=getContentEditableRoot$1(editor,targetElm))isContentEditableFalse$9(contentEditableRoot)?(e.preventDefault(),setContentEditableSelection(selectNode(editor,contentEditableRoot))):(removeContentEditableSelection(),isContentEditableTrue$5(contentEditableRoot)&&e.shiftKey||$_3kj84i5djh8lyxan.isXYWithinRange(e.clientX,e.clientY,editor.selection.getRng())||(hideFakeCaret(),editor.selection.placeCaretAt(e.clientX,e.clientY)));else if(isFakeCaretTarget(targetElm)===!1){removeContentEditableSelection(),hideFakeCaret();var caretInfo=closestCaret(rootNode,e.clientX,e.clientY);if(caretInfo&&!hasBetterMouseTarget(e.target,caretInfo.node)){e.preventDefault();var range=showCaret$$1(1,caretInfo.node,caretInfo.before,!1);editor.getBody().focus(),setRange(range)}}}),editor.on("keypress",function(e){if(!$_6lsk4i5gjh8lyxau.modifierPressed(e))switch(e.keyCode){default:isContentEditableFalse$9(editor.selection.getNode())&&e.preventDefault()}}),editor.on("getSelectionRange",function(e){var rng=e.range;if(selectedContentEditableNode){if(!selectedContentEditableNode.parentNode)return void(selectedContentEditableNode=null);rng=rng.cloneRange(),rng.selectNode(selectedContentEditableNode),e.range=rng}}),editor.on("setSelectionRange",function(e){var rng;rng=setContentEditableSelection(e.range,e.forward),rng&&(e.range=rng)}),editor.on("AfterSetSelectionRange",function(e){var rng=e.range;isRangeInCaretContainer(rng)||hideFakeCaret(),isFakeSelectionElement(rng.startContainer.parentNode)||removeContentEditableSelection()}),editor.on("copy",function(e){var clipboardData=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!$_9bpim8ajh8lyw68.ie){var realSelectionElement=getRealSelectionElement();realSelectionElement&&(e.preventDefault(),clipboardData.clearData(),clipboardData.setData("text/html",realSelectionElement.outerHTML),clipboardData.setData("text/plain",realSelectionElement.outerText))}}),$_8bbr0a58jh8lyxa1.init(editor),$_plloj5ejh8lyxap.setup(editor)},addCss=function(){var styles=editor.contentStyles,rootClass=".mce-content-body";styles.push(fakeCaret.getCss()),styles.push(rootClass+" .mce-offscreen-selection {position: absolute;left: -9999999999px;max-width: 1000000px;}"+rootClass+" *[contentEditable=false] {cursor: default;}"+rootClass+" *[contentEditable=true] {cursor: text;}")},isWithinCaretContainer=function(node){return isCaretContainer(node)||startsWithCaretContainer(node)||endsWithCaretContainer(node)},isRangeInCaretContainer=function(rng){return isWithinCaretContainer(rng.startContainer)||isWithinCaretContainer(rng.endContainer)},setContentEditableSelection=function(range,forward){var node,$realSelectionContainer,sel,startContainer,startOffset,endOffset,e,caretPosition,targetClone,origTargetClone,$=editor.$,dom=editor.dom;if(!range)return null;if(range.collapsed){if(!isRangeInCaretContainer(range))if(forward===!1){if(caretPosition=getNormalizedRangeEndPoint$$1(-1,range),isFakeCaretTarget(caretPosition.getNode(!0)))return showCaret$$1(-1,caretPosition.getNode(!0),!1,!1);if(isFakeCaretTarget(caretPosition.getNode()))return showCaret$$1(-1,caretPosition.getNode(),!caretPosition.isAtEnd(),!1)}else{if(caretPosition=getNormalizedRangeEndPoint$$1(1,range),isFakeCaretTarget(caretPosition.getNode()))return showCaret$$1(1,caretPosition.getNode(),!caretPosition.isAtEnd(),!1);if(isFakeCaretTarget(caretPosition.getNode(!0)))return showCaret$$1(1,caretPosition.getNode(!0),!1,!1)}return null}return startContainer=range.startContainer,startOffset=range.startOffset,endOffset=range.endOffset,3===startContainer.nodeType&&0===startOffset&&isContentEditableFalse$9(startContainer.parentNode)&&(startContainer=startContainer.parentNode,startOffset=dom.nodeIndex(startContainer),startContainer=startContainer.parentNode),1!==startContainer.nodeType?null:(endOffset===startOffset+1&&(node=startContainer.childNodes[startOffset]),isContentEditableFalse$9(node)?(targetClone=origTargetClone=node.cloneNode(!0),e=editor.fire("ObjectSelected",{target:node,targetClone:targetClone}),e.isDefaultPrevented()?null:($realSelectionContainer=$_7sg18r3cjh8lywu1.descendant($_cgttw3zjh8lywdq.fromDom(editor.getBody()),"#"+realSelectionId).fold(function(){return $([])},function(elm){return $([elm.dom()])}),targetClone=e.targetClone,0===$realSelectionContainer.length&&($realSelectionContainer=$('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",realSelectionId),$realSelectionContainer.appendTo(editor.getBody())),range=editor.dom.createRng(),targetClone===origTargetClone&&$_9bpim8ajh8lyw68.ie?($realSelectionContainer.empty().append('<p style="font-size: 0" data-mce-bogus="all"> </p>').append(targetClone),range.setStartAfter($realSelectionContainer[0].firstChild.firstChild),range.setEndAfter(targetClone)):($realSelectionContainer.empty().append(" ").append(targetClone).append(" "),range.setStart($realSelectionContainer[0].firstChild,1),range.setEnd($realSelectionContainer[0].lastChild,0)),$realSelectionContainer.css({top:dom.getPos(node,editor.getBody()).y}),$realSelectionContainer[0].focus(),sel=editor.selection.getSel(),sel.removeAllRanges(),sel.addRange(range),$_5wjzy24jh8lyw2t.each($_eebxu2gjh8lywp3.descendants($_cgttw3zjh8lywdq.fromDom(editor.getBody()),"*[data-mce-selected]"),function(elm){$_3da62i14jh8lyweo.remove(elm,"data-mce-selected")}),node.setAttribute("data-mce-selected","1"),selectedContentEditableNode=node,hideFakeCaret(),range)):null)},removeContentEditableSelection=function(){selectedContentEditableNode&&selectedContentEditableNode.removeAttribute("data-mce-selected"),$_7sg18r3cjh8lywu1.descendant($_cgttw3zjh8lywdq.fromDom(editor.getBody()),"#"+realSelectionId).each($_bfmuql2ujh8lywr1.remove),selectedContentEditableNode=null},destroy=function(){fakeCaret.destroy(),selectedContentEditableNode=null},hideFakeCaret=function(){fakeCaret.hide()};return $_9bpim8ajh8lyw68.ceFalse&&(registerEvents(),addCss()),{showCaret:showCaret$$1,showBlockCaretContainer:showBlockCaretContainer,hideFakeCaret:hideFakeCaret,destroy:destroy}},isValidPrefixAttrName=function(name){return 0===name.indexOf("data-")||0===name.indexOf("aria-")},trimComments=function(text){return text.replace(/<!--|-->/g,"")},isInvalidUri=function(settings,uri){return!settings.allow_html_data_urls&&(/^data:image\//i.test(uri)?settings.allow_svg_data_urls===!1&&/^data:image\/svg\+xml/i.test(uri):/^data:/i.test(uri))},findEndTagIndex=function(schema,html,startIndex){var index,matches,tokenRegExp,shortEndedElements,count=1;for(shortEndedElements=schema.getShortEndedElements(),tokenRegExp=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g,tokenRegExp.lastIndex=index=startIndex;matches=tokenRegExp.exec(html);){if(index=tokenRegExp.lastIndex,"/"===matches[1])count--;else if(!matches[1]){if(matches[2]in shortEndedElements)continue;count++}if(0===count)break}return index};!function(SaxParser){SaxParser.findEndTag=findEndTagIndex}(SaxParser||(SaxParser={}));var SaxParser$1=SaxParser,trimHtml=function(tempAttrs,html){var trimContentRegExp=new RegExp(["\\s?("+tempAttrs.join("|")+')="[^"]+"'].join("|"),"gi");return html.replace(trimContentRegExp,"")},trimInternal=function(serializer,html){var endTagIndex,index,matchLength,matches,shortEndedElements,content=html,bogusAllRegExp=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,schema=serializer.schema;for(content=trimHtml(serializer.getTempAttrs(),content),shortEndedElements=schema.getShortEndedElements();matches=bogusAllRegExp.exec(content);)index=bogusAllRegExp.lastIndex,matchLength=matches[0].length,endTagIndex=shortEndedElements[matches[1]]?index:SaxParser$1.findEndTag(schema,content,index),content=content.substring(0,index-matchLength)+content.substring(endTagIndex),bogusAllRegExp.lastIndex=index-matchLength;return $_d383mr21jh8lywlv.trim(content)},trimExternal=trimInternal,$_8lol015jjh8lyxbf={trimExternal:trimExternal,trimInternal:trimInternal},KEEP=0,INSERT=1,DELETE=2,diff=function(left,right){var size=left.length+right.length+2,vDown=new Array(size),vUp=new Array(size),snake=function(start,end,diag){return{start:start,end:end,diag:diag}},buildScript=function(start1,end1,start2,end2,script){var middle=getMiddleSnake(start1,end1,start2,end2);if(null===middle||middle.start===end1&&middle.diag===end1-end2||middle.end===start1&&middle.diag===start1-start2)for(var i=start1,j=start2;i<end1||j<end2;)i<end1&&j<end2&&left[i]===right[j]?(script.push([KEEP,left[i]]),++i,++j):end1-start1>end2-start2?(script.push([DELETE,left[i]]),++i):(script.push([INSERT,right[j]]),++j);else{buildScript(start1,middle.start,start2,middle.start-middle.diag,script);for(var i2=middle.start;i2<middle.end;++i2)script.push([KEEP,left[i2]]);buildScript(middle.end,end1,middle.end-middle.diag,end2,script)}},buildSnake=function(start,diag,end1,end2){for(var end=start;end-diag<end2&&end<end1&&left[end]===right[end-diag];)++end;return snake(start,end,diag)},getMiddleSnake=function(start1,end1,start2,end2){var m=end1-start1,n=end2-start2;if(0===m||0===n)return null;var delta=m-n,sum=n+m,offset=(sum%2===0?sum:sum+1)/2;vDown[1+offset]=start1,vUp[1+offset]=end1+1;var d,k,i,x,y;for(d=0;d<=offset;++d){for(k=-d;k<=d;k+=2){for(i=k+offset,k===-d||k!==d&&vDown[i-1]<vDown[i+1]?vDown[i]=vDown[i+1]:vDown[i]=vDown[i-1]+1,x=vDown[i],y=x-start1+start2-k;x<end1&&y<end2&&left[x]===right[y];)vDown[i]=++x,++y;if(delta%2!==0&&delta-d<=k&&k<=delta+d&&vUp[i-delta]<=vDown[i])return buildSnake(vUp[i-delta],k+start1-start2,end1,end2)}for(k=delta-d;k<=delta+d;k+=2){for(i=k+offset-delta,k===delta-d||k!==delta+d&&vUp[i+1]<=vUp[i-1]?vUp[i]=vUp[i+1]-1:vUp[i]=vUp[i-1],x=vUp[i]-1,y=x-start1+start2-k;x>=start1&&y>=start2&&left[x]===right[y];)vUp[i]=x--,y--;if(delta%2===0&&-d<=k&&k<=d&&vUp[i]<=vDown[i+delta])return buildSnake(vUp[i],k+start1-start2,end1,end2)}}},script=[];return buildScript(0,left.length,0,right.length,script),script},$_5dhayi5mjh8lyxc5={KEEP:KEEP,DELETE:DELETE,INSERT:INSERT,diff:diff},getOuterHtml=function(elm){return $_5oonaz1qjh8lywhz.isElement(elm)?elm.outerHTML:$_5oonaz1qjh8lywhz.isText(elm)?$_gex7a11rjh8lywi4.encodeRaw(elm.data,!1):$_5oonaz1qjh8lywhz.isComment(elm)?"<!--"+elm.data+"-->":""},createFragment$1=function(html){var frag,node,container;for(container=document.createElement("div"),frag=document.createDocumentFragment(),html&&(container.innerHTML=html);node=container.firstChild;)frag.appendChild(node);return frag},insertAt=function(elm,html,index){var fragment=createFragment$1(html);if(elm.hasChildNodes()&&index<elm.childNodes.length){var target=elm.childNodes[index];target.parentNode.insertBefore(fragment,target)}else elm.appendChild(fragment)},removeAt=function(elm,index){if(elm.hasChildNodes()&&index<elm.childNodes.length){var target=elm.childNodes[index];target.parentNode.removeChild(target)}},applyDiff=function(diff,elm){var index=0;$_9tjm51ljh8lywbq.each(diff,function(action){action[0]===$_5dhayi5mjh8lyxc5.KEEP?index++:action[0]===$_5dhayi5mjh8lyxc5.INSERT?(insertAt(elm,action[1],index),index++):action[0]===$_5dhayi5mjh8lyxc5.DELETE&&removeAt(elm,index)})},read$3=function(elm){return $_9tjm51ljh8lywbq.filter($_9tjm51ljh8lywbq.map(elm.childNodes,getOuterHtml),function(item){return item.length>0})},write=function(fragments,elm){var currentFragments=$_9tjm51ljh8lywbq.map(elm.childNodes,getOuterHtml);return applyDiff($_5dhayi5mjh8lyxc5.diff(currentFragments,fragments),elm),elm},$_9x5cnf5ljh8lyxc2={read:read$3,write:write},fromHtml$1=function(html,scope){var doc=scope||document,div=doc.createElement("div");return div.innerHTML=html,$_a43q0i17jh8lywfe.children($_cgttw3zjh8lywdq.fromDom(div))},fromTags=function(tags,scope){return $_5wjzy24jh8lyw2t.map(tags,function(x){return $_cgttw3zjh8lywdq.fromTag(x,scope)})},fromText$1=function(texts,scope){return $_5wjzy24jh8lyw2t.map(texts,function(x){return $_cgttw3zjh8lywdq.fromText(x,scope)})},fromDom$1=function(nodes){return $_5wjzy24jh8lyw2t.map(nodes,$_cgttw3zjh8lywdq.fromDom)},$_egn65r5ojh8lyxcb={fromHtml:fromHtml$1,fromTags:fromTags,fromText:fromText$1,fromDom:fromDom$1},get$5=function(element){return element.dom().innerHTML},set$3=function(element,content){var owner=$_a43q0i17jh8lywfe.owner(element),docDom=owner.dom(),fragment=$_cgttw3zjh8lywdq.fromDom(docDom.createDocumentFragment()),contentElements=$_egn65r5ojh8lyxcb.fromHtml(content,docDom);$_9hl8mu2vjh8lywr4.append(fragment,contentElements),$_bfmuql2ujh8lywr1.empty(element),$_4m7u2e2kjh8lywpi.append(element,fragment)},getOuter=function(element){var container=$_cgttw3zjh8lywdq.fromTag("div"),clone=$_cgttw3zjh8lywdq.fromDom(element.dom().cloneNode(!0));return $_4m7u2e2kjh8lywpi.append(container,clone),get$5(container)},$_cxg0x95njh8lyxc9={get:get$5,set:set$3,getOuter:getOuter},undoLevelDocument=Cell(Option.none()),lazyTempDocument=function(){return undoLevelDocument.get().getOrThunk(function(){var doc=document.implementation.createHTMLDocument("undo");return undoLevelDocument.set(Option.some(doc)),doc})},hasIframes=function(html){return html.indexOf("</iframe>")!==-1},createFragmentedLevel=function(fragments){return{type:"fragmented",fragments:fragments,content:"",bookmark:null,beforeBookmark:null}},createCompleteLevel=function(content){return{type:"complete",fragments:null,content:content,bookmark:null,beforeBookmark:null}},createFromEditor=function(editor){var fragments,content,trimmedFragments;return fragments=$_9x5cnf5ljh8lyxc2.read(editor.getBody()),trimmedFragments=$_5wjzy24jh8lyw2t.bind(fragments,function(html){var trimmed=$_8lol015jjh8lyxbf.trimInternal(editor.serializer,html);return trimmed.length>0?[trimmed]:[]}),content=trimmedFragments.join(""),hasIframes(content)?createFragmentedLevel(trimmedFragments):createCompleteLevel(content)},applyToEditor=function(editor,level,before){"fragmented"===level.type?$_9x5cnf5ljh8lyxc2.write(level.fragments,editor.getBody()):editor.setContent(level.content,{format:"raw"}),editor.selection.moveToBookmark(before?level.beforeBookmark:level.bookmark)},getLevelContent=function(level){return"fragmented"===level.type?level.fragments.join(""):level.content},getCleanLevelContent=function(level){var elm=$_cgttw3zjh8lywdq.fromTag("body",lazyTempDocument());return $_cxg0x95njh8lyxc9.set(elm,getLevelContent(level)),$_5wjzy24jh8lyw2t.each($_eebxu2gjh8lywp3.descendants(elm,"*[data-mce-bogus]"),$_bfmuql2ujh8lywr1.unwrap),$_cxg0x95njh8lyxc9.get(elm)},hasEqualContent=function(level1,level2){return getLevelContent(level1)===getLevelContent(level2)},hasEqualCleanedContent=function(level1,level2){return getCleanLevelContent(level1)===getCleanLevelContent(level2)},isEq$2=function(level1,level2){return!(!level1||!level2)&&(!!hasEqualContent(level1,level2)||hasEqualCleanedContent(level1,level2))},$_dxjj465ijh8lyxb4={createFragmentedLevel:createFragmentedLevel,createCompleteLevel:createCompleteLevel,createFromEditor:createFromEditor,applyToEditor:applyToEditor,isEq:isEq$2},isInlineBlock=function(node){return node&&/^(IMG)$/.test(node.nodeName)},moveStart=function(dom,selection,rng){var walker,node,nodes,offset=rng.startOffset,container=rng.startContainer;if((rng.startContainer!==rng.endContainer||!isInlineBlock(rng.startContainer.childNodes[rng.startOffset]))&&1===container.nodeType)for(nodes=container.childNodes,offset<nodes.length?(container=nodes[offset],walker=new TreeWalker(container,dom.getParent(container,dom.isBlock))):(container=nodes[nodes.length-1],walker=new TreeWalker(container,dom.getParent(container,dom.isBlock)),walker.next(!0)),node=walker.current();node;node=walker.next())if(3===node.nodeType&&!isWhiteSpaceNode(node))return rng.setStart(node,0),void selection.setRng(rng)},getNonWhiteSpaceSibling=function(node,next,inc){if(node)for(next=next?"nextSibling":"previousSibling",node=inc?node:node[next];node;node=node[next])if(1===node.nodeType||!isWhiteSpaceNode(node))return node},isTextBlock$1=function(editor,name){return name.nodeType&&(name=name.nodeName),!!editor.schema.getTextBlockElements()[name.toLowerCase()]},isValid=function(ed,parent,child){return ed.schema.isValidChild(parent,child)},isWhiteSpaceNode=function(node){return node&&3===node.nodeType&&/^([\t \r\n]+|)$/.test(node.nodeValue)},replaceVars=function(value,vars){return"string"!=typeof value?value=value(vars):vars&&(value=value.replace(/%(\w+)/g,function(str,name){return vars[name]||str})),value},isEq$3=function(str1,str2){return str1=str1||"",str2=str2||"",str1=""+(str1.nodeName||str1),str2=""+(str2.nodeName||str2),str1.toLowerCase()===str2.toLowerCase()},normalizeStyleValue=function(dom,value,name){return"color"!==name&&"backgroundColor"!==name||(value=dom.toHex(value)),"fontWeight"===name&&700===value&&(value="bold"),"fontFamily"===name&&(value=value.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+value},getStyle=function(dom,node,name){return normalizeStyleValue(dom,dom.getStyle(node,name),name)},getTextDecoration=function(dom,node){var decoration;return dom.getParent(node,function(n){return decoration=dom.getStyle(n,"text-decoration"),decoration&&"none"!==decoration}),decoration},getParents$1=function(dom,node,selector){return dom.getParents(node,selector,dom.getRoot())},$_dodtof5tjh8lyxdh={isInlineBlock:isInlineBlock,moveStart:moveStart,getNonWhiteSpaceSibling:getNonWhiteSpaceSibling,isTextBlock:isTextBlock$1,isValid:isValid,isWhiteSpaceNode:isWhiteSpaceNode,replaceVars:replaceVars,isEq:isEq$3,normalizeStyleValue:normalizeStyleValue,getStyle:getStyle,getTextDecoration:getTextDecoration,getParents:getParents$1},isBookmarkNode$2=$_eyp5ec2njh8lywpo.isBookmarkNode,getParents$2=$_dodtof5tjh8lyxdh.getParents,isWhiteSpaceNode$1=$_dodtof5tjh8lyxdh.isWhiteSpaceNode,isTextBlock$2=$_dodtof5tjh8lyxdh.isTextBlock,findLeaf=function(node,offset){for("undefined"==typeof offset&&(offset=3===node.nodeType?node.length:node.childNodes.length);node&&node.hasChildNodes();)node=node.childNodes[offset],node&&(offset=3===node.nodeType?node.length:node.childNodes.length);return{node:node,offset:offset}},excludeTrailingWhitespace=function(endContainer,endOffset){var leaf=findLeaf(endContainer,endOffset);if(leaf.node){for(;leaf.node&&0===leaf.offset&&leaf.node.previousSibling;)leaf=findLeaf(leaf.node.previousSibling);leaf.node&&leaf.offset>0&&3===leaf.node.nodeType&&" "===leaf.node.nodeValue.charAt(leaf.offset-1)&&leaf.offset>1&&(endContainer=leaf.node,endContainer.splitText(leaf.offset-1))}return endContainer},isBogusBr=function(node){return"BR"===node.nodeName&&node.getAttribute("data-mce-bogus")&&!node.nextSibling},findParentContentEditable=function(dom,node){for(var parent=node;parent;){if(1===parent.nodeType&&dom.getContentEditable(parent))return"false"===dom.getContentEditable(parent)?parent:node;parent=parent.parentNode}return node},findSpace=function(start,remove,node,offset){var pos,pos2,str=node.nodeValue;return"undefined"==typeof offset&&(offset=start?str.length:0),start?(pos=str.lastIndexOf(" ",offset),pos2=str.lastIndexOf(" ",offset),pos=pos>pos2?pos:pos2,pos===-1||remove||pos++):(pos=str.indexOf(" ",offset),pos2=str.indexOf(" ",offset),pos=pos!==-1&&(pos2===-1||pos<pos2)?pos:pos2),pos},findWordEndPoint=function(dom,body,container,offset,start,remove){var walker,node,pos,lastTextNode;if(3===container.nodeType){if(pos=findSpace(start,remove,container,offset),pos!==-1)return{container:container,offset:pos};lastTextNode=container}for(walker=new TreeWalker(container,dom.getParent(container,dom.isBlock)||body);node=walker[start?"prev":"next"]();)if(3===node.nodeType){if(lastTextNode=node,pos=findSpace(start,remove,node),pos!==-1)return{container:node,offset:pos}}else if(dom.isBlock(node))break;if(lastTextNode)return offset=start?0:lastTextNode.length,{container:lastTextNode,offset:offset}},findSelectorEndPoint=function(dom,format,rng,container,siblingName){var parents,i,y,curFormat;for(3===container.nodeType&&0===container.nodeValue.length&&container[siblingName]&&(container=container[siblingName]),parents=getParents$2(dom,container),i=0;i<parents.length;i++)for(y=0;y<format.length;y++)if(curFormat=format[y],!("collapsed"in curFormat&&curFormat.collapsed!==rng.collapsed)&&dom.is(parents[i],curFormat.selector))return parents[i];return container},findBlockEndPoint=function(editor,format,container,siblingName){var node,dom=editor.dom,root=dom.getRoot();if(format[0].wrapper||(node=dom.getParent(container,format[0].block,root)),!node){var scopeRoot=dom.getParent(container,"LI,TD,TH");node=dom.getParent(3===container.nodeType?container.parentNode:container,function(node){return node!==root&&isTextBlock$2(editor,node)},scopeRoot)}if(node&&format[0].wrapper&&(node=getParents$2(dom,node,"ul,ol").reverse()[0]||node),!node)for(node=container;node[siblingName]&&!dom.isBlock(node[siblingName])&&(node=node[siblingName],!$_dodtof5tjh8lyxdh.isEq(node,"br")););return node||container},findParentContainer=function(dom,format,startContainer,startOffset,endContainer,endOffset,start){var container,parent,sibling,siblingName,root;if(container=parent=start?startContainer:endContainer,siblingName=start?"previousSibling":"nextSibling",root=dom.getRoot(),3===container.nodeType&&!isWhiteSpaceNode$1(container)&&(start?startOffset>0:endOffset<container.nodeValue.length))return container;for(;;){if(!format[0].block_expand&&dom.isBlock(parent))return parent;for(sibling=parent[siblingName];sibling;sibling=sibling[siblingName])if(!isBookmarkNode$2(sibling)&&!isWhiteSpaceNode$1(sibling)&&!isBogusBr(sibling))return parent;if(parent===root||parent.parentNode===root){container=parent;break}parent=parent.parentNode}return container},expandRng=function(editor,rng,format,remove){var endPoint,startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,dom=editor.dom;return 1===startContainer.nodeType&&startContainer.hasChildNodes()&&(startContainer=getNode(startContainer,startOffset),3===startContainer.nodeType&&(startOffset=0)),1===endContainer.nodeType&&endContainer.hasChildNodes()&&(endContainer=getNode(endContainer,rng.collapsed?endOffset:endOffset-1),3===endContainer.nodeType&&(endOffset=endContainer.nodeValue.length)),startContainer=findParentContentEditable(dom,startContainer),endContainer=findParentContentEditable(dom,endContainer),(isBookmarkNode$2(startContainer.parentNode)||isBookmarkNode$2(startContainer))&&(startContainer=isBookmarkNode$2(startContainer)?startContainer:startContainer.parentNode,startContainer=startContainer.nextSibling||startContainer,3===startContainer.nodeType&&(startOffset=0)),(isBookmarkNode$2(endContainer.parentNode)||isBookmarkNode$2(endContainer))&&(endContainer=isBookmarkNode$2(endContainer)?endContainer:endContainer.parentNode,endContainer=endContainer.previousSibling||endContainer,3===endContainer.nodeType&&(endOffset=endContainer.length)),format[0].inline&&(rng.collapsed&&(endPoint=findWordEndPoint(dom,editor.getBody(),startContainer,startOffset,!0,remove),endPoint&&(startContainer=endPoint.container,startOffset=endPoint.offset),endPoint=findWordEndPoint(dom,editor.getBody(),endContainer,endOffset,!1,remove),endPoint&&(endContainer=endPoint.container,endOffset=endPoint.offset)),endContainer=remove?endContainer:excludeTrailingWhitespace(endContainer,endOffset)),(format[0].inline||format[0].block_expand)&&(format[0].inline&&3===startContainer.nodeType&&0!==startOffset||(startContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!0)),format[0].inline&&3===endContainer.nodeType&&endOffset!==endContainer.nodeValue.length||(endContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!1))),format[0].selector&&format[0].expand!==!1&&!format[0].inline&&(startContainer=findSelectorEndPoint(dom,format,rng,startContainer,"previousSibling"),endContainer=findSelectorEndPoint(dom,format,rng,endContainer,"nextSibling")),(format[0].block||format[0].selector)&&(startContainer=findBlockEndPoint(editor,format,startContainer,"previousSibling"),endContainer=findBlockEndPoint(editor,format,endContainer,"nextSibling"),format[0].block&&(dom.isBlock(startContainer)||(startContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!0)),dom.isBlock(endContainer)||(endContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!1)))),1===startContainer.nodeType&&(startOffset=dom.nodeIndex(startContainer),startContainer=startContainer.parentNode),1===endContainer.nodeType&&(endOffset=dom.nodeIndex(endContainer)+1,endContainer=endContainer.parentNode),{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}},$_fryklb5sjh8lyxd9={expandRng:expandRng},isEq$4=$_dodtof5tjh8lyxdh.isEq,matchesUnInheritedFormatSelector=function(ed,node,name){var formatList=ed.formatter.get(name);if(formatList)for(var i=0;i<formatList.length;i++)if(formatList[i].inherit===!1&&ed.dom.is(node,formatList[i].selector))return!0;return!1},matchParents=function(editor,node,name,vars){var root=editor.dom.getRoot();return node!==root&&(node=editor.dom.getParent(node,function(node){return!!matchesUnInheritedFormatSelector(editor,node,name)||(node.parentNode===root||!!matchNode(editor,node,name,vars,!0))}),matchNode(editor,node,name,vars))},matchName=function(dom,node,format){return!!isEq$4(node,format.inline)||(!!isEq$4(node,format.block)||(format.selector?1===node.nodeType&&dom.is(node,format.selector):void 0))},matchItems=function(dom,node,format,itemName,similar,vars){var key,value,i,items=format[itemName];if(format.onmatch)return format.onmatch(node,format,itemName);if(items)if("undefined"==typeof items.length){for(key in items)if(items.hasOwnProperty(key)){if(value="attributes"===itemName?dom.getAttrib(node,key):$_dodtof5tjh8lyxdh.getStyle(dom,node,key),similar&&!value&&!format.exact)return;if((!similar||format.exact)&&!isEq$4(value,$_dodtof5tjh8lyxdh.normalizeStyleValue(dom,$_dodtof5tjh8lyxdh.replaceVars(items[key],vars),key)))return}}else for(i=0;i<items.length;i++)if("attributes"===itemName?dom.getAttrib(node,items[i]):$_dodtof5tjh8lyxdh.getStyle(dom,node,items[i]))return format;return format},matchNode=function(ed,node,name,vars,similar){var format,i,x,classes,formatList=ed.formatter.get(name),dom=ed.dom;if(formatList&&node)for(i=0;i<formatList.length;i++)if(format=formatList[i],matchName(ed.dom,node,format)&&matchItems(dom,node,format,"attributes",similar,vars)&&matchItems(dom,node,format,"styles",similar,vars)){if(classes=format.classes)for(x=0;x<classes.length;x++)if(!ed.dom.hasClass(node,classes[x]))return;return format}},match=function(editor,name,vars,node){var startNode;return node?matchParents(editor,node,name,vars):(node=editor.selection.getNode(),!!matchParents(editor,node,name,vars)||(startNode=editor.selection.getStart(),!(startNode===node||!matchParents(editor,startNode,name,vars))))},matchAll=function(editor,names,vars){var startElement,matchedFormatNames=[],checkedMap={};return startElement=editor.selection.getStart(),editor.dom.getParent(startElement,function(node){var i,name;for(i=0;i<names.length;i++)name=names[i],!checkedMap[name]&&matchNode(editor,node,name,vars)&&(checkedMap[name]=!0,matchedFormatNames.push(name))},editor.dom.getRoot()),matchedFormatNames},canApply=function(editor,name){var startNode,parents,i,x,selector,formatList=editor.formatter.get(name),dom=editor.dom;if(formatList)for(startNode=editor.selection.getStart(),parents=$_dodtof5tjh8lyxdh.getParents(dom,startNode),x=formatList.length-1;x>=0;x--){if(selector=formatList[x].selector,!selector||formatList[x].defaultBlock)return!0;for(i=parents.length-1;i>=0;i--)if(dom.is(parents[i],selector))return!0}return!1},$_8qd8fq5ujh8lyxdx={matchNode:matchNode,matchName:matchName,match:match,matchAll:matchAll,canApply:canApply,matchesUnInheritedFormatSelector:matchesUnInheritedFormatSelector},splitText=function(node,offset){return node.splitText(offset)},split$1=function(rng){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;return startContainer===endContainer&&$_5oonaz1qjh8lywhz.isText(startContainer)?startOffset>0&&startOffset<startContainer.nodeValue.length&&(endContainer=splitText(startContainer,startOffset),startContainer=endContainer.previousSibling,endOffset>startOffset?(endOffset-=startOffset,startContainer=endContainer=splitText(endContainer,endOffset).previousSibling,endOffset=endContainer.nodeValue.length,startOffset=0):endOffset=0):($_5oonaz1qjh8lywhz.isText(startContainer)&&startOffset>0&&startOffset<startContainer.nodeValue.length&&(startContainer=splitText(startContainer,startOffset),startOffset=0),$_5oonaz1qjh8lywhz.isText(endContainer)&&endOffset>0&&endOffset<endContainer.nodeValue.length&&(endContainer=splitText(endContainer,endOffset).previousSibling,endOffset=endContainer.nodeValue.length)),{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}},$_5hrcpr5vjh8lyxe2={split:split$1},ZWSP$1=$_d383mr21jh8lywlv.ZWSP,CARET_ID$1="_mce_caret",importNode=function(ownerDocument,node){return ownerDocument.importNode(node,!0)},getEmptyCaretContainers=function(node){for(var nodes=[];node;){if(3===node.nodeType&&node.nodeValue!==ZWSP$1||node.childNodes.length>1)return[];1===node.nodeType&&nodes.push(node),node=node.firstChild}return nodes},isCaretContainerEmpty=function(node){return getEmptyCaretContainers(node).length>0},findFirstTextNode=function(node){var walker;if(node)for(walker=new TreeWalker(node,node),node=walker.current();node;node=walker.next())if(3===node.nodeType)return node;return null},createCaretContainer=function(fill){var caretContainer=$_cgttw3zjh8lywdq.fromTag("span");return $_3da62i14jh8lyweo.setAll(caretContainer,{id:CARET_ID$1,"data-mce-bogus":"1","data-mce-type":"format-caret"}),fill&&$_4m7u2e2kjh8lywpi.append(caretContainer,$_cgttw3zjh8lywdq.fromText(ZWSP$1)),caretContainer},trimZwspFromCaretContainer=function(caretContainerNode){var textNode=findFirstTextNode(caretContainerNode);return textNode&&textNode.nodeValue.charAt(0)===ZWSP$1&&textNode.deleteData(0,1),textNode},removeCaretContainerNode=function(dom,selection,node,moveCaret){
var rng,block,textNode;rng=selection.getRng(!0),block=dom.getParent(node,dom.isBlock),isCaretContainerEmpty(node)?(moveCaret!==!1&&(rng.setStartBefore(node),rng.setEndBefore(node)),dom.remove(node)):(textNode=trimZwspFromCaretContainer(node),rng.startContainer===textNode&&rng.startOffset>0&&rng.setStart(textNode,rng.startOffset-1),rng.endContainer===textNode&&rng.endOffset>0&&rng.setEnd(textNode,rng.endOffset-1),dom.remove(node,!0)),block&&dom.isEmpty(block)&&$_2bvsfb2tjh8lywqo.fillWithPaddingBr($_cgttw3zjh8lywdq.fromDom(block)),selection.setRng(rng)},removeCaretContainer=function(body,dom,selection,node,moveCaret){if(node)removeCaretContainerNode(dom,selection,node,moveCaret);else if(node=getParentCaretContainer(body,selection.getStart()),!node)for(;node=dom.get(CARET_ID$1);)removeCaretContainerNode(dom,selection,node,!1)},insertCaretContainerNode=function(editor,caretContainer,formatNode){var dom=editor.dom,block=dom.getParent(formatNode,$_8aqzj925jh8lywmj.curry($_dodtof5tjh8lyxdh.isTextBlock,editor));block&&dom.isEmpty(block)?formatNode.parentNode.replaceChild(caretContainer,formatNode):($_2bvsfb2tjh8lywqo.removeTrailingBr($_cgttw3zjh8lywdq.fromDom(formatNode)),dom.isEmpty(formatNode)?formatNode.parentNode.replaceChild(caretContainer,formatNode):dom.insertAfter(caretContainer,formatNode))},appendNode=function(parentNode,node){return parentNode.appendChild(node),node},insertFormatNodesIntoCaretContainer=function(formatNodes,caretContainer){var innerMostFormatNode=$_5wjzy24jh8lyw2t.foldr(formatNodes,function(parentNode,formatNode){return appendNode(parentNode,formatNode.cloneNode(!1))},caretContainer);return appendNode(innerMostFormatNode,innerMostFormatNode.ownerDocument.createTextNode(ZWSP$1))},applyCaretFormat=function(editor,name,vars){var rng,caretContainer,textNode,offset,bookmark,container,text,selection=editor.selection;rng=selection.getRng(!0),offset=rng.startOffset,container=rng.startContainer,text=container.nodeValue,caretContainer=getParentCaretContainer(editor.getBody(),selection.getStart()),caretContainer&&(textNode=findFirstTextNode(caretContainer));var wordcharRegex=/[^\s\u00a0\u00ad\u200b\ufeff]/;text&&offset>0&&offset<text.length&&wordcharRegex.test(text.charAt(offset))&&wordcharRegex.test(text.charAt(offset-1))?(bookmark=selection.getBookmark(),rng.collapse(!0),rng=$_fryklb5sjh8lyxd9.expandRng(editor,rng,editor.formatter.get(name)),rng=$_5hrcpr5vjh8lyxe2.split(rng),editor.formatter.apply(name,vars,rng),selection.moveToBookmark(bookmark)):(caretContainer&&textNode.nodeValue===ZWSP$1?editor.formatter.apply(name,vars,caretContainer):(caretContainer=importNode(editor.getDoc(),createCaretContainer(!0).dom()),textNode=caretContainer.firstChild,rng.insertNode(caretContainer),offset=1,editor.formatter.apply(name,vars,caretContainer)),selection.setCursorLocation(textNode,offset))},removeCaretFormat=function(editor,name,vars,similar){var container,offset,bookmark,hasContentAfter,node,formatNode,caretContainer,dom=editor.dom,selection=editor.selection,parents=[],rng=selection.getRng();for(container=rng.startContainer,offset=rng.startOffset,node=container,3===container.nodeType&&(offset!==container.nodeValue.length&&(hasContentAfter=!0),node=node.parentNode);node;){if($_8qd8fq5ujh8lyxdx.matchNode(editor,node,name,vars,similar)){formatNode=node;break}node.nextSibling&&(hasContentAfter=!0),parents.push(node),node=node.parentNode}if(formatNode)if(hasContentAfter){bookmark=selection.getBookmark(),rng.collapse(!0);var expandedRng=$_fryklb5sjh8lyxd9.expandRng(editor,rng,editor.formatter.get(name),!0);expandedRng=$_5hrcpr5vjh8lyxe2.split(expandedRng),editor.formatter.remove(name,vars,expandedRng),selection.moveToBookmark(bookmark)}else{caretContainer=getParentCaretContainer(editor.getBody(),formatNode);var newCaretContainer=createCaretContainer(!1).dom(),caretNode=insertFormatNodesIntoCaretContainer(parents,newCaretContainer);caretContainer?insertCaretContainerNode(editor,newCaretContainer,caretContainer):insertCaretContainerNode(editor,newCaretContainer,formatNode),removeCaretContainerNode(dom,selection,caretContainer,!1),selection.setCursorLocation(caretNode,1),dom.isEmpty(formatNode)&&dom.remove(formatNode)}},disableCaretContainer=function(body,dom,selection,keyCode){removeCaretContainer(body,dom,selection,null,!1),8===keyCode&&selection.isCollapsed()&&selection.getStart().innerHTML===ZWSP$1&&removeCaretContainer(body,dom,selection,getParentCaretContainer(body,selection.getStart())),37!==keyCode&&39!==keyCode||removeCaretContainer(body,dom,selection,getParentCaretContainer(body,selection.getStart()))},setup$2=function(editor){var dom=editor.dom,selection=editor.selection,body=editor.getBody();editor.on("mouseup keydown",function(e){disableCaretContainer(body,dom,selection,e.keyCode)})},replaceWithCaretFormat=function(targetNode,formatNodes){var caretContainer=createCaretContainer(!1),innerMost=insertFormatNodesIntoCaretContainer(formatNodes,caretContainer.dom());return $_4m7u2e2kjh8lywpi.before($_cgttw3zjh8lywdq.fromDom(targetNode),caretContainer),$_bfmuql2ujh8lywr1.remove($_cgttw3zjh8lywdq.fromDom(targetNode)),CaretPosition$1(innerMost,0)},isFormatElement=function(editor,element){var inlineElements=editor.schema.getTextInlineElements();return inlineElements.hasOwnProperty($_7j1jt210jh8lywdx.name(element))&&!isCaretNode(element.dom())&&!$_5oonaz1qjh8lywhz.isBogus(element.dom())},postProcessHooks={},filter$2=$_9tjm51ljh8lywbq.filter,each$11=$_9tjm51ljh8lywbq.each,addPostProcessHook=function(name,hook){var hooks=postProcessHooks[name];hooks||(postProcessHooks[name]=hooks=[]),postProcessHooks[name].push(hook)},postProcess=function(name,editor){each$11(postProcessHooks[name],function(hook){hook(editor)})};addPostProcessHook("pre",function(editor){var isPre,blocks,rng=editor.selection.getRng(),hasPreSibling=function(pre){return isPre(pre.previousSibling)&&$_9tjm51ljh8lywbq.indexOf(blocks,pre.previousSibling)!==-1},joinPre=function(pre1,pre2){DomQuery(pre2).remove(),DomQuery(pre1).append("<br><br>").append(pre2.childNodes)};isPre=$_5oonaz1qjh8lywhz.matchNodeNames("pre"),rng.collapsed||(blocks=editor.selection.getSelectedBlocks(),each$11(filter$2(filter$2(blocks,isPre),hasPreSibling),function(pre){joinPre(pre.previousSibling,pre)}))});var $_78e03d5wjh8lyxe4={postProcess:postProcess},each$12=$_ahowuxkjh8lywbj.each,getEndChild=function(container,index){var childNodes=container.childNodes;return index--,index>childNodes.length-1?index=childNodes.length-1:index<0&&(index=0),childNodes[index]||container},walk$2=function(dom,rng,callback){var ancestor,startPoint,endPoint,node,parent,siblings,nodes,startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;if(nodes=dom.select("td[data-mce-selected],th[data-mce-selected]"),nodes.length>0)return void each$12(nodes,function(node){callback([node])});var exclude=function(nodes){var node;return node=nodes[0],3===node.nodeType&&node===startContainer&&startOffset>=node.nodeValue.length&&nodes.splice(0,1),node=nodes[nodes.length-1],0===endOffset&&nodes.length>0&&node===endContainer&&3===node.nodeType&&nodes.splice(nodes.length-1,1),nodes},collectSiblings=function(node,name,endNode){for(var siblings=[];node&&node!==endNode;node=node[name])siblings.push(node);return siblings},findEndPoint=function(node,root){do{if(node.parentNode===root)return node;node=node.parentNode}while(node)},walkBoundary=function(startNode,endNode,next){var siblingName=next?"nextSibling":"previousSibling";for(node=startNode,parent=node.parentNode;node&&node!==endNode;node=parent)parent=node.parentNode,siblings=collectSiblings(node===startNode?node:node[siblingName],siblingName),siblings.length&&(next||siblings.reverse(),callback(exclude(siblings)))};if(1===startContainer.nodeType&&startContainer.hasChildNodes()&&(startContainer=startContainer.childNodes[startOffset]),1===endContainer.nodeType&&endContainer.hasChildNodes()&&(endContainer=getEndChild(endContainer,endOffset)),startContainer===endContainer)return callback(exclude([startContainer]));for(ancestor=dom.findCommonAncestor(startContainer,endContainer),node=startContainer;node;node=node.parentNode){if(node===endContainer)return walkBoundary(startContainer,ancestor,!0);if(node===ancestor)break}for(node=endContainer;node;node=node.parentNode){if(node===startContainer)return walkBoundary(endContainer,ancestor);if(node===ancestor)break}startPoint=findEndPoint(startContainer,ancestor)||startContainer,endPoint=findEndPoint(endContainer,ancestor)||endContainer,walkBoundary(startContainer,startPoint,!0),siblings=collectSiblings(startPoint===startContainer?startPoint:startPoint.nextSibling,"nextSibling",endPoint===endContainer?endPoint.nextSibling:endPoint),siblings.length&&callback(exclude(siblings)),walkBoundary(endContainer,endPoint)},$_90itx05zjh8lyxeq={walk:walk$2},MCE_ATTR_RE=/^(src|href|style)$/,each$13=$_ahowuxkjh8lywbj.each,isEq$5=$_dodtof5tjh8lyxdh.isEq,isTableCell$4=function(node){return/^(TH|TD)$/.test(node.nodeName)},getContainer=function(ed,rng,start){var container,offset,lastIdx;return container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],$_5oonaz1qjh8lywhz.isElement(container)&&(lastIdx=container.childNodes.length-1,!start&&offset&&offset--,container=container.childNodes[offset>lastIdx?lastIdx:offset]),$_5oonaz1qjh8lywhz.isText(container)&&start&&offset>=container.nodeValue.length&&(container=new TreeWalker(container,ed.getBody()).next()||container),$_5oonaz1qjh8lywhz.isText(container)&&!start&&0===offset&&(container=new TreeWalker(container,ed.getBody()).prev()||container),container},wrap$2=function(dom,node,name,attrs){var wrapper=dom.create(name,attrs);return node.parentNode.insertBefore(wrapper,node),wrapper.appendChild(node),wrapper},matchName$1=function(dom,node,format){return!!isEq$5(node,format.inline)||(!!isEq$5(node,format.block)||(format.selector?$_5oonaz1qjh8lywhz.isElement(node)&&dom.is(node,format.selector):void 0))},isColorFormatAndAnchor=function(node,format){return format.links&&"A"===node.tagName},find$4=function(dom,node,next,inc){return node=$_dodtof5tjh8lyxdh.getNonWhiteSpaceSibling(node,next,inc),!node||"BR"===node.nodeName||dom.isBlock(node)},removeNode$1=function(ed,node,format){var rootBlockElm,parentNode=node.parentNode,dom=ed.dom,forcedRootBlock=ed.settings.forced_root_block;format.block&&(forcedRootBlock?parentNode===dom.getRoot()&&(format.list_block&&isEq$5(node,format.list_block)||each$13($_ahowuxkjh8lywbj.grep(node.childNodes),function(node){$_dodtof5tjh8lyxdh.isValid(ed,forcedRootBlock,node.nodeName.toLowerCase())?rootBlockElm?rootBlockElm.appendChild(node):(rootBlockElm=wrap$2(dom,node,forcedRootBlock),dom.setAttribs(rootBlockElm,ed.settings.forced_root_block_attrs)):rootBlockElm=0})):dom.isBlock(node)&&!dom.isBlock(parentNode)&&(find$4(dom,node,!1)||find$4(dom,node.firstChild,!0,1)||node.insertBefore(dom.create("br"),node.firstChild),find$4(dom,node,!0)||find$4(dom,node.lastChild,!1,1)||node.appendChild(dom.create("br")))),format.selector&&format.inline&&!isEq$5(format.inline,node)||dom.remove(node,1)},removeFormat=function(ed,format,vars,node,compareNode){var i,attrs,stylesModified,dom=ed.dom;if(!matchName$1(dom,node,format)&&!isColorFormatAndAnchor(node,format))return!1;if("all"!==format.remove)for(each$13(format.styles,function(value,name){value=$_dodtof5tjh8lyxdh.normalizeStyleValue(dom,$_dodtof5tjh8lyxdh.replaceVars(value,vars),name),"number"==typeof name&&(name=value,compareNode=0),(format.remove_similar||!compareNode||isEq$5($_dodtof5tjh8lyxdh.getStyle(dom,compareNode,name),value))&&dom.setStyle(node,name,""),stylesModified=1}),stylesModified&&""===dom.getAttrib(node,"style")&&(node.removeAttribute("style"),node.removeAttribute("data-mce-style")),each$13(format.attributes,function(value,name){var valueOut;if(value=$_dodtof5tjh8lyxdh.replaceVars(value,vars),"number"==typeof name&&(name=value,compareNode=0),!compareNode||isEq$5(dom.getAttrib(compareNode,name),value)){if("class"===name&&(value=dom.getAttrib(node,name),value&&(valueOut="",each$13(value.split(/\s+/),function(cls){/mce\-\w+/.test(cls)&&(valueOut+=(valueOut?" ":"")+cls)}),valueOut)))return void dom.setAttrib(node,name,valueOut);"class"===name&&node.removeAttribute("className"),MCE_ATTR_RE.test(name)&&node.removeAttribute("data-mce-"+name),node.removeAttribute(name)}}),each$13(format.classes,function(value){value=$_dodtof5tjh8lyxdh.replaceVars(value,vars),compareNode&&!dom.hasClass(compareNode,value)||dom.removeClass(node,value)}),attrs=dom.getAttribs(node),i=0;i<attrs.length;i++){var attrName=attrs[i].nodeName;if(0!==attrName.indexOf("_")&&0!==attrName.indexOf("data-"))return!1}return"none"!==format.remove?(removeNode$1(ed,node,format),!0):void 0},findFormatRoot=function(editor,container,name,vars,similar){var formatRoot;return each$13($_dodtof5tjh8lyxdh.getParents(editor.dom,container.parentNode).reverse(),function(parent){var format;formatRoot||"_start"===parent.id||"_end"===parent.id||(format=$_8qd8fq5ujh8lyxdx.matchNode(editor,parent,name,vars,similar),format&&format.split!==!1&&(formatRoot=parent))}),formatRoot},wrapAndSplit=function(editor,formatList,formatRoot,container,target,split,format,vars){var parent,clone,lastClone,firstClone,i,formatRootParent,dom=editor.dom;if(formatRoot){for(formatRootParent=formatRoot.parentNode,parent=container.parentNode;parent&&parent!==formatRootParent;parent=parent.parentNode){for(clone=dom.clone(parent,!1),i=0;i<formatList.length;i++)if(removeFormat(editor,formatList[i],vars,clone,clone)){clone=0;break}clone&&(lastClone&&clone.appendChild(lastClone),firstClone||(firstClone=clone),lastClone=clone)}!split||format.mixed&&dom.isBlock(formatRoot)||(container=dom.split(formatRoot,container)),lastClone&&(target.parentNode.insertBefore(lastClone,target),firstClone.appendChild(target))}return container},remove$7=function(ed,name,vars,node,similar){var bookmark,rng,formatList=ed.formatter.get(name),format=formatList[0],contentEditable=!0,dom=ed.dom,selection=ed.selection,splitToFormatRoot=function(container){var formatRoot=findFormatRoot(ed,container,name,vars,similar);return wrapAndSplit(ed,formatList,formatRoot,container,container,!0,format,vars)},process=function(node){var children,i,l,lastContentEditable,hasContentEditableState;if($_5oonaz1qjh8lywhz.isElement(node)&&dom.getContentEditable(node)&&(lastContentEditable=contentEditable,contentEditable="true"===dom.getContentEditable(node),hasContentEditableState=!0),children=$_ahowuxkjh8lywbj.grep(node.childNodes),contentEditable&&!hasContentEditableState)for(i=0,l=formatList.length;i<l&&!removeFormat(ed,formatList[i],vars,node,node);i++);if(format.deep&&children.length){for(i=0,l=children.length;i<l;i++)process(children[i]);hasContentEditableState&&(contentEditable=lastContentEditable)}},unwrap=function(start){var node=dom.get(start?"_start":"_end"),out=node[start?"firstChild":"lastChild"];return $_eyp5ec2njh8lywpo.isBookmarkNode(out)&&(out=out[start?"firstChild":"lastChild"]),$_5oonaz1qjh8lywhz.isText(out)&&0===out.data.length&&(out=start?node.previousSibling||node.nextSibling:node.nextSibling||node.previousSibling),dom.remove(node,!0),out},removeRngStyle=function(rng){var startContainer,endContainer,commonAncestorContainer=rng.commonAncestorContainer;if(rng=$_fryklb5sjh8lyxd9.expandRng(ed,rng,formatList,!0),format.split){if(startContainer=getContainer(ed,rng,!0),endContainer=getContainer(ed,rng),startContainer!==endContainer){if(/^(TR|TH|TD)$/.test(startContainer.nodeName)&&startContainer.firstChild&&(startContainer="TR"===startContainer.nodeName?startContainer.firstChild.firstChild||startContainer:startContainer.firstChild||startContainer),commonAncestorContainer&&/^T(HEAD|BODY|FOOT|R)$/.test(commonAncestorContainer.nodeName)&&isTableCell$4(endContainer)&&endContainer.firstChild&&(endContainer=endContainer.firstChild||endContainer),dom.isChildOf(startContainer,endContainer)&&startContainer!==endContainer&&!dom.isBlock(endContainer)&&!isTableCell$4(startContainer)&&!isTableCell$4(endContainer))return startContainer=wrap$2(dom,startContainer,"span",{id:"_start","data-mce-type":"bookmark"}),splitToFormatRoot(startContainer),void(startContainer=unwrap(!0));startContainer=wrap$2(dom,startContainer,"span",{id:"_start","data-mce-type":"bookmark"}),endContainer=wrap$2(dom,endContainer,"span",{id:"_end","data-mce-type":"bookmark"}),splitToFormatRoot(startContainer),splitToFormatRoot(endContainer),startContainer=unwrap(!0),endContainer=unwrap()}else startContainer=endContainer=splitToFormatRoot(startContainer);rng.startContainer=startContainer.parentNode?startContainer.parentNode:startContainer,rng.startOffset=dom.nodeIndex(startContainer),rng.endContainer=endContainer.parentNode?endContainer.parentNode:endContainer,rng.endOffset=dom.nodeIndex(endContainer)+1}$_90itx05zjh8lyxeq.walk(dom,rng,function(nodes){each$13(nodes,function(node){process(node),$_5oonaz1qjh8lywhz.isElement(node)&&"underline"===ed.dom.getStyle(node,"text-decoration")&&node.parentNode&&"underline"===$_dodtof5tjh8lyxdh.getTextDecoration(dom,node.parentNode)&&removeFormat(ed,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:"underline"}},null,node)})})};if(node)return void(node.nodeType?(rng=dom.createRng(),rng.setStartBefore(node),rng.setEndAfter(node),removeRngStyle(rng)):removeRngStyle(node));if("false"!==dom.getContentEditable(selection.getNode()))selection.isCollapsed()&&format.inline&&!dom.select("td[data-mce-selected],th[data-mce-selected]").length?removeCaretFormat(ed,name,vars,similar):(bookmark=$_8b82yg2ojh8lywpq.getPersistentBookmark(ed.selection,!0),removeRngStyle(selection.getRng()),selection.moveToBookmark(bookmark),format.inline&&$_8qd8fq5ujh8lyxdx.match(ed,name,vars,selection.getStart())&&$_dodtof5tjh8lyxdh.moveStart(dom,selection,selection.getRng()),ed.nodeChanged());else{node=selection.getNode();for(var i=0,l=formatList.length;i<l&&(!formatList[i].ceFalseOverride||!removeFormat(ed,formatList[i],vars,node,node));i++);}},$_7cys7h5yjh8lyxeg={removeFormat:removeFormat,remove:remove$7},each$14=$_ahowuxkjh8lywbj.each,isElementNode=function(node){return node&&1===node.nodeType&&!$_eyp5ec2njh8lywpo.isBookmarkNode(node)&&!isCaretNode(node)&&!$_5oonaz1qjh8lywhz.isBogus(node)},findElementSibling=function(node,siblingName){var sibling;for(sibling=node;sibling;sibling=sibling[siblingName]){if(3===sibling.nodeType&&0!==sibling.nodeValue.length)return node;if(1===sibling.nodeType&&!$_eyp5ec2njh8lywpo.isBookmarkNode(sibling))return sibling}return node},mergeSiblingsNodes=function(dom,prev,next){var sibling,tmpSibling,elementUtils=new ElementUtils(dom);if(prev&&next&&(prev=findElementSibling(prev,"previousSibling"),next=findElementSibling(next,"nextSibling"),elementUtils.compare(prev,next))){for(sibling=prev.nextSibling;sibling&&sibling!==next;)tmpSibling=sibling,sibling=sibling.nextSibling,prev.appendChild(tmpSibling);return dom.remove(next),$_ahowuxkjh8lywbj.each($_ahowuxkjh8lywbj.grep(next.childNodes),function(node){prev.appendChild(node)}),prev}return next},processChildElements=function(node,filter,process){each$14(node.childNodes,function(node){isElementNode(node)&&(filter(node)&&process(node),node.hasChildNodes()&&processChildElements(node,filter,process))})},hasStyle=function(dom,name){return $_eqpqvr6jh8lyw3s.curry(function(name,node){return!(!node||!$_dodtof5tjh8lyxdh.getStyle(dom,node,name))},name)},applyStyle=function(dom,name,value){return $_eqpqvr6jh8lyw3s.curry(function(name,value,node){dom.setStyle(node,name,value),""===node.getAttribute("style")&&node.removeAttribute("style"),unwrapEmptySpan(dom,node)},name,value)},unwrapEmptySpan=function(dom,node){"SPAN"===node.nodeName&&0===dom.getAttribs(node).length&&dom.remove(node,!0)},processUnderlineAndColor=function(dom,node){var textDecoration;1===node.nodeType&&node.parentNode&&1===node.parentNode.nodeType&&(textDecoration=$_dodtof5tjh8lyxdh.getTextDecoration(dom,node.parentNode),dom.getStyle(node,"color")&&textDecoration?dom.setStyle(node,"text-decoration",textDecoration):dom.getStyle(node,"text-decoration")===textDecoration&&dom.setStyle(node,"text-decoration",null))},mergeUnderlineAndColor=function(dom,format,vars,node){(format.styles.color||format.styles.textDecoration)&&($_ahowuxkjh8lywbj.walk(node,$_eqpqvr6jh8lyw3s.curry(processUnderlineAndColor,dom),"childNodes"),processUnderlineAndColor(dom,node))},mergeBackgroundColorAndFontSize=function(dom,format,vars,node){format.styles&&format.styles.backgroundColor&&processChildElements(node,hasStyle(dom,"fontSize"),applyStyle(dom,"backgroundColor",$_dodtof5tjh8lyxdh.replaceVars(format.styles.backgroundColor,vars)))},mergeSubSup=function(dom,format,vars,node){"sub"!==format.inline&&"sup"!==format.inline||(processChildElements(node,hasStyle(dom,"fontSize"),applyStyle(dom,"fontSize","")),dom.remove(dom.select("sup"===format.inline?"sub":"sup",node),!0))},mergeSiblings=function(dom,format,vars,node){node&&format.merge_siblings!==!1&&(node=mergeSiblingsNodes(dom,$_dodtof5tjh8lyxdh.getNonWhiteSpaceSibling(node),node),node=mergeSiblingsNodes(dom,node,$_dodtof5tjh8lyxdh.getNonWhiteSpaceSibling(node,!0)))},clearChildStyles=function(dom,format,node){if(format.clear_child_styles){var selector=format.links?"*:not(a)":"*";each$14(dom.select(selector,node),function(node){isElementNode(node)&&each$14(format.styles,function(value,name){dom.setStyle(node,name,"")})})}},mergeWithChildren=function(editor,formatList,vars,node){each$14(formatList,function(format){each$14(editor.dom.select(format.inline,node),function(child){isElementNode(child)&&$_7cys7h5yjh8lyxeg.removeFormat(editor,format,vars,child,format.exact?child:null)}),clearChildStyles(editor.dom,format,node)})},mergeWithParents=function(editor,format,name,vars,node){$_8qd8fq5ujh8lyxdx.matchNode(editor,node.parentNode,name,vars)&&$_7cys7h5yjh8lyxeg.removeFormat(editor,format,vars,node)||format.merge_with_parents&&editor.dom.getParent(node.parentNode,function(parent){if($_8qd8fq5ujh8lyxdx.matchNode(editor,parent,name,vars))return $_7cys7h5yjh8lyxeg.removeFormat(editor,format,vars,node),!0})},$_3fattg5xjh8lyxe7={mergeWithChildren:mergeWithChildren,mergeUnderlineAndColor:mergeUnderlineAndColor,mergeBackgroundColorAndFontSize:mergeBackgroundColorAndFontSize,mergeSubSup:mergeSubSup,mergeSiblings:mergeSiblings,mergeWithParents:mergeWithParents},each$15=$_ahowuxkjh8lywbj.each,isElementNode$1=function(node){return node&&1===node.nodeType&&!$_eyp5ec2njh8lywpo.isBookmarkNode(node)&&!isCaretNode(node)&&!$_5oonaz1qjh8lywhz.isBogus(node)},applyFormat=function(ed,name,vars,node){var bookmark,rng,formatList=ed.formatter.get(name),format=formatList[0],isCollapsed=!node&&ed.selection.isCollapsed(),dom=ed.dom,selection=ed.selection,setElementFormat=function(elm,fmt){if(fmt=fmt||format,elm){if(fmt.onformat&&fmt.onformat(elm,fmt,vars,node),each$15(fmt.styles,function(value,name){dom.setStyle(elm,name,$_dodtof5tjh8lyxdh.replaceVars(value,vars))}),fmt.styles){var styleVal=dom.getAttrib(elm,"style");styleVal&&elm.setAttribute("data-mce-style",styleVal)}each$15(fmt.attributes,function(value,name){dom.setAttrib(elm,name,$_dodtof5tjh8lyxdh.replaceVars(value,vars))}),each$15(fmt.classes,function(value){value=$_dodtof5tjh8lyxdh.replaceVars(value,vars),dom.hasClass(elm,value)||dom.addClass(elm,value)})}},applyNodeStyle=function(formatList,node){var found=!1;return!!format.selector&&(each$15(formatList,function(format){if(!("collapsed"in format&&format.collapsed!==isCollapsed))return dom.is(node,format.selector)&&!isCaretNode(node)?(setElementFormat(node,format),found=!0,!1):void 0}),found)},applyRngStyle=function(dom,rng,bookmark,nodeSpecific){var wrapName,wrapElm,newWrappers=[],contentEditable=!0;wrapName=format.inline||format.block,wrapElm=dom.create(wrapName),setElementFormat(wrapElm),$_90itx05zjh8lyxeq.walk(dom,rng,function(nodes){var currentWrapElm,process=function(node){var nodeName,parentName,hasContentEditableState,lastContentEditable;if(lastContentEditable=contentEditable,nodeName=node.nodeName.toLowerCase(),parentName=node.parentNode.nodeName.toLowerCase(),1===node.nodeType&&dom.getContentEditable(node)&&(lastContentEditable=contentEditable,contentEditable="true"===dom.getContentEditable(node),hasContentEditableState=!0),$_dodtof5tjh8lyxdh.isEq(nodeName,"br"))return currentWrapElm=0,void(format.block&&dom.remove(node));if(format.wrapper&&$_8qd8fq5ujh8lyxdx.matchNode(ed,node,name,vars))return void(currentWrapElm=0);if(contentEditable&&!hasContentEditableState&&format.block&&!format.wrapper&&$_dodtof5tjh8lyxdh.isTextBlock(ed,nodeName)&&$_dodtof5tjh8lyxdh.isValid(ed,parentName,wrapName))return node=dom.rename(node,wrapName),setElementFormat(node),newWrappers.push(node),void(currentWrapElm=0);if(format.selector){var found=applyNodeStyle(formatList,node);if(!format.inline||found)return void(currentWrapElm=0)}!contentEditable||hasContentEditableState||!$_dodtof5tjh8lyxdh.isValid(ed,wrapName,nodeName)||!$_dodtof5tjh8lyxdh.isValid(ed,parentName,wrapName)||!nodeSpecific&&3===node.nodeType&&1===node.nodeValue.length&&65279===node.nodeValue.charCodeAt(0)||isCaretNode(node)||format.inline&&dom.isBlock(node)?(currentWrapElm=0,each$15($_ahowuxkjh8lywbj.grep(node.childNodes),process),hasContentEditableState&&(contentEditable=lastContentEditable),currentWrapElm=0):(currentWrapElm||(currentWrapElm=dom.clone(wrapElm,!1),node.parentNode.insertBefore(currentWrapElm,node),newWrappers.push(currentWrapElm)),currentWrapElm.appendChild(node))};each$15(nodes,process)}),format.links===!0&&each$15(newWrappers,function(node){var process=function(node){"A"===node.nodeName&&setElementFormat(node,format),each$15($_ahowuxkjh8lywbj.grep(node.childNodes),process)};process(node)}),each$15(newWrappers,function(node){var childCount,getChildCount=function(node){var count=0;return each$15(node.childNodes,function(node){$_dodtof5tjh8lyxdh.isWhiteSpaceNode(node)||$_eyp5ec2njh8lywpo.isBookmarkNode(node)||count++}),count},getChildElementNode=function(root){var child=!1;return each$15(root.childNodes,function(node){if(isElementNode$1(node))return child=node,!1}),child},mergeStyles=function(node){var child,clone;return child=getChildElementNode(node),child&&!$_eyp5ec2njh8lywpo.isBookmarkNode(child)&&$_8qd8fq5ujh8lyxdx.matchName(dom,child,format)&&(clone=dom.clone(child,!1),setElementFormat(clone),dom.replace(clone,node,!0),dom.remove(child,1)),clone||node};return childCount=getChildCount(node),(newWrappers.length>1||!dom.isBlock(node))&&0===childCount?void dom.remove(node,1):void((format.inline||format.wrapper)&&(format.exact||1!==childCount||(node=mergeStyles(node)),$_3fattg5xjh8lyxe7.mergeWithChildren(ed,formatList,vars,node),$_3fattg5xjh8lyxe7.mergeWithParents(ed,format,name,vars,node),$_3fattg5xjh8lyxe7.mergeBackgroundColorAndFontSize(dom,format,vars,node),$_3fattg5xjh8lyxe7.mergeSubSup(dom,format,vars,node),$_3fattg5xjh8lyxe7.mergeSiblings(dom,format,vars,node)))})};if("false"!==dom.getContentEditable(selection.getNode())){if(format){if(node)node.nodeType?applyNodeStyle(formatList,node)||(rng=dom.createRng(),rng.setStartBefore(node),rng.setEndAfter(node),applyRngStyle(dom,$_fryklb5sjh8lyxd9.expandRng(ed,rng,formatList),null,!0)):applyRngStyle(dom,node,null,!0);else if(isCollapsed&&format.inline&&!dom.select("td[data-mce-selected],th[data-mce-selected]").length)applyCaretFormat(ed,name,vars);else{var curSelNode=ed.selection.getNode();ed.settings.forced_root_block||!formatList[0].defaultBlock||dom.getParent(curSelNode,dom.isBlock)||applyFormat(ed,formatList[0].defaultBlock),ed.selection.setRng($_cnbluh30jh8lywrn.normalize(ed.selection.getRng())),bookmark=$_8b82yg2ojh8lywpq.getPersistentBookmark(ed.selection,!0),applyRngStyle(dom,$_fryklb5sjh8lyxd9.expandRng(ed,selection.getRng(),formatList),bookmark),format.styles&&$_3fattg5xjh8lyxe7.mergeUnderlineAndColor(dom,format,vars,curSelNode),selection.moveToBookmark(bookmark),$_dodtof5tjh8lyxdh.moveStart(dom,selection,selection.getRng()),ed.nodeChanged()}$_78e03d5wjh8lyxe4.postProcess(name,ed)}}else{node=selection.getNode();for(var i=0,l=formatList.length;i<l;i++)if(formatList[i].ceFalseOverride&&dom.is(node,formatList[i].selector))return void setElementFormat(node,formatList[i])}},$_36ocwe5qjh8lyxck={applyFormat:applyFormat},each$16=$_ahowuxkjh8lywbj.each,setup$3=function(formatChangeData,editor){var currentFormats={};formatChangeData.set({}),editor.on("NodeChange",function(e){var parents=$_dodtof5tjh8lyxdh.getParents(editor.dom,e.element),matchedFormats={};parents=$_ahowuxkjh8lywbj.grep(parents,function(node){return 1===node.nodeType&&!node.getAttribute("data-mce-bogus")}),each$16(formatChangeData.get(),function(callbacks,format){each$16(parents,function(node){return editor.formatter.matchNode(node,format,{},callbacks.similar)?(currentFormats[format]||(each$16(callbacks,function(callback){callback(!0,{node:node,format:format,parents:parents})}),currentFormats[format]=callbacks),matchedFormats[format]=callbacks,!1):!$_8qd8fq5ujh8lyxdx.matchesUnInheritedFormatSelector(editor,node,format)&&void 0})}),each$16(currentFormats,function(callbacks,format){matchedFormats[format]||(delete currentFormats[format],each$16(callbacks,function(callback){callback(!1,{node:e.element,format:format,parents:parents})}))})})},addListeners=function(formatChangeData,formats,callback,similar){var formatChangeItems=formatChangeData.get();each$16(formats.split(","),function(format){formatChangeItems[format]||(formatChangeItems[format]=[],formatChangeItems[format].similar=similar),formatChangeItems[format].push(callback)}),formatChangeData.set(formatChangeItems)},formatChanged=function(editor,formatChangeState,formats,callback,similar){null===formatChangeState.get()&&setup$3(formatChangeState,editor),addListeners(formatChangeState,formats,callback,similar)},$_cpfal560jh8lyxeu={formatChanged:formatChanged},get$6=function(dom){var formats={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,
clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(){return!0},onformat:function(elm,fmt,vars){$_ahowuxkjh8lywbj.each(vars,function(value,key){dom.setAttrib(elm,key,value)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return $_ahowuxkjh8lywbj.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(name){formats[name]={block:name,remove:"all"}}),formats},$_3zwfyl62jh8lyxez={get:get$6},each$17=$_ahowuxkjh8lywbj.each,dom=DOMUtils$1.DOM,parsedSelectorToHtml=function(ancestry,editor){var elm,item,fragment,schema=editor&&editor.schema||Schema({}),decorate=function(elm,item){item.classes.length&&dom.addClass(elm,item.classes.join(" ")),dom.setAttribs(elm,item.attrs)},createElement=function(sItem){var elm;return item="string"==typeof sItem?{name:sItem,classes:[],attrs:{}}:sItem,elm=dom.create(item.name),decorate(elm,item),elm},getRequiredParent=function(elm,candidate){var name="string"!=typeof elm?elm.nodeName.toLowerCase():elm,elmRule=schema.getElementRule(name),parentsRequired=elmRule&&elmRule.parentsRequired;return!(!parentsRequired||!parentsRequired.length)&&(candidate&&$_ahowuxkjh8lywbj.inArray(parentsRequired,candidate)!==-1?candidate:parentsRequired[0])},wrapInHtml=function(elm,ancestry,siblings){var parent,parentCandidate,parentRequired,ancestor=ancestry.length>0&&ancestry[0],ancestorName=ancestor&&ancestor.name;if(parentRequired=getRequiredParent(elm,ancestorName))ancestorName===parentRequired?(parentCandidate=ancestry[0],ancestry=ancestry.slice(1)):parentCandidate=parentRequired;else if(ancestor)parentCandidate=ancestry[0],ancestry=ancestry.slice(1);else if(!siblings)return elm;return parentCandidate&&(parent=createElement(parentCandidate),parent.appendChild(elm)),siblings&&(parent||(parent=dom.create("div"),parent.appendChild(elm)),$_ahowuxkjh8lywbj.each(siblings,function(sibling){var siblingElm=createElement(sibling);parent.insertBefore(siblingElm,elm)})),wrapInHtml(parent,ancestry,parentCandidate&&parentCandidate.siblings)};return ancestry&&ancestry.length?(item=ancestry[0],elm=createElement(item),fragment=dom.create("div"),fragment.appendChild(wrapInHtml(elm,ancestry.slice(1),item.siblings)),fragment):""},selectorToHtml=function(selector,editor){return parsedSelectorToHtml(parseSelector(selector),editor)},parseSelectorItem=function(item){var tagName,obj={classes:[],attrs:{}};return item=obj.selector=$_ahowuxkjh8lywbj.trim(item),"*"!==item&&(tagName=item.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function($0,$1,$2,$3,$4){switch($1){case"#":obj.attrs.id=$2;break;case".":obj.classes.push($2);break;case":":$_ahowuxkjh8lywbj.inArray("checked disabled enabled read-only required".split(" "),$2)!==-1&&(obj.attrs[$2]=$2)}if("["===$3){var m=$4.match(/([\w\-]+)(?:\=\"([^\"]+))?/);m&&(obj.attrs[m[1]]=m[2])}return""})),obj.name=tagName||"div",obj},parseSelector=function(selector){return selector&&"string"==typeof selector?(selector=selector.split(/\s*,\s*/)[0],selector=selector.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),$_ahowuxkjh8lywbj.map(selector.split(/(?:>|\s+(?![^\[\]]+\]))/),function(item){var siblings=$_ahowuxkjh8lywbj.map(item.split(/(?:~\+|~|\+)/),parseSelectorItem),obj=siblings.pop();return siblings.length&&(obj.siblings=siblings),obj}).reverse()):[]},getCssText=function(editor,format){var name,previewFrag,previewElm,items,parentFontSize,previewStyles,previewCss="";if(previewStyles=editor.settings.preview_styles,previewStyles===!1)return"";"string"!=typeof previewStyles&&(previewStyles="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow");var removeVars=function(val){return val.replace(/%(\w+)/g,"")};if("string"==typeof format){if(format=editor.formatter.get(format),!format)return;format=format[0]}return"preview"in format&&(previewStyles=format.preview,previewStyles===!1)?"":(name=format.block||format.inline||"span",items=parseSelector(format.selector),items.length?(items[0].name||(items[0].name=name),name=format.selector,previewFrag=parsedSelectorToHtml(items,editor)):previewFrag=parsedSelectorToHtml([name],editor),previewElm=dom.select(name,previewFrag)[0]||previewFrag.firstChild,each$17(format.styles,function(value,name){value=removeVars(value),value&&dom.setStyle(previewElm,name,value)}),each$17(format.attributes,function(value,name){value=removeVars(value),value&&dom.setAttrib(previewElm,name,value)}),each$17(format.classes,function(value){value=removeVars(value),dom.hasClass(previewElm,value)||dom.addClass(previewElm,value)}),editor.fire("PreviewFormats"),dom.setStyles(previewFrag,{position:"absolute",left:-65535}),editor.getBody().appendChild(previewFrag),parentFontSize=dom.getStyle(editor.getBody(),"fontSize",!0),parentFontSize=/px$/.test(parentFontSize)?parseInt(parentFontSize,10):0,each$17(previewStyles.split(" "),function(name){var value=dom.getStyle(previewElm,name,!0);if(!("background-color"===name&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(value)&&(value=dom.getStyle(editor.getBody(),name,!0),"#ffffff"===dom.toHex(value).toLowerCase())||"color"===name&&"#000000"===dom.toHex(value).toLowerCase())){if("font-size"===name&&/em|%$/.test(value)){if(0===parentFontSize)return;var numValue=parseFloat(value)/(/%$/.test(value)?100:1);value=numValue*parentFontSize+"px"}"border"===name&&value&&(previewCss+="padding:0 2px;"),previewCss+=name+":"+value+";"}}),editor.fire("AfterPreviewFormats"),dom.remove(previewFrag),previewCss)},$_fwiqkm63jh8lyxf5={getCssText:getCssText,parseSelector:parseSelector,selectorToHtml:selectorToHtml},toggle$2=function(editor,formats,name,vars,node){var fmt=formats.get(name);!$_8qd8fq5ujh8lyxdx.match(editor,name,vars,node)||"toggle"in fmt[0]&&!fmt[0].toggle?$_36ocwe5qjh8lyxck.applyFormat(editor,name,vars,node):$_7cys7h5yjh8lyxeg.remove(editor,name,vars,node)},$_5bc2se64jh8lyxfc={toggle:toggle$2},setup$4=function(editor){editor.addShortcut("meta+b","","Bold"),editor.addShortcut("meta+i","","Italic"),editor.addShortcut("meta+u","","Underline");for(var i=1;i<=6;i++)editor.addShortcut("access+"+i,"",["FormatBlock",!1,"h"+i]);editor.addShortcut("access+7","",["FormatBlock",!1,"p"]),editor.addShortcut("access+8","",["FormatBlock",!1,"div"]),editor.addShortcut("access+9","",["FormatBlock",!1,"address"])},$_3p946b65jh8lyxfe={setup:setup$4},shallow=function(old,nu){return nu},deep=function(old,nu){var bothObjects=$_dp4g6d7jh8lyw3y.isObject(old)&&$_dp4g6d7jh8lyw3y.isObject(nu);return bothObjects?deepMerge(old,nu):nu},baseMerge=function(merger){return function(){for(var objects=new Array(arguments.length),i=0;i<objects.length;i++)objects[i]=arguments[i];if(0===objects.length)throw new Error("Can't merge zero objects");for(var ret={},j=0;j<objects.length;j++){var curObject=objects[j];for(var key in curObject)curObject.hasOwnProperty(key)&&(ret[key]=merger(ret[key],curObject[key]))}return ret}},deepMerge=baseMerge(deep),merge=baseMerge(shallow),$_7ffry568jh8lyxfy={deepMerge:deepMerge,merge:merge},register=function(htmlParser,settings,dom){htmlParser.addAttributeFilter("data-mce-tabindex",function(nodes,name){for(var node,i=nodes.length;i--;)node=nodes[i],node.attr("tabindex",node.attributes.map["data-mce-tabindex"]),node.attr(name,null)}),htmlParser.addAttributeFilter("src,href,style",function(nodes,name){for(var node,value,i=nodes.length,internalName="data-mce-"+name,urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope;i--;)node=nodes[i],value=node.attributes.map[internalName],void 0!==value?(node.attr(name,value.length>0?value:null),node.attr(internalName,null)):(value=node.attributes.map[name],"style"===name?value=dom.serializeStyle(dom.parseStyle(value),node.name):urlConverter&&(value=urlConverter.call(urlConverterScope,value,name,node.name)),node.attr(name,value.length>0?value:null))}),htmlParser.addAttributeFilter("class",function(nodes){for(var node,value,i=nodes.length;i--;)node=nodes[i],value=node.attr("class"),value&&(value=node.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),node.attr("class",value.length>0?value:null))}),htmlParser.addAttributeFilter("data-mce-type",function(nodes,name,args){for(var node,i=nodes.length;i--;)node=nodes[i],"bookmark"!==node.attributes.map["data-mce-type"]||args.cleanup||node.remove()}),htmlParser.addNodeFilter("noscript",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i].firstChild,node&&(node.value=$_gex7a11rjh8lywi4.decode(node.value))}),htmlParser.addNodeFilter("script,style",function(nodes,name){for(var node,value,type,i=nodes.length,trim=function(value){return value.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};i--;)node=nodes[i],value=node.firstChild?node.firstChild.value:"","script"===name?(type=node.attr("type"),type&&node.attr("type","mce-no/type"===type?null:type.replace(/^mce\-/,"")),"xhtml"===settings.element_format&&value.length>0&&(node.firstChild.value="// <![CDATA[\n"+trim(value)+"\n// ]]>")):"xhtml"===settings.element_format&&value.length>0&&(node.firstChild.value="<!--\n"+trim(value)+"\n-->")}),htmlParser.addNodeFilter("#comment",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],0===node.value.indexOf("[CDATA[")?(node.name="#cdata",node.type=4,node.value=node.value.replace(/^\[CDATA\[|\]\]$/g,"")):0===node.value.indexOf("mce:protected ")&&(node.name="#text",node.type=3,node.raw=!0,node.value=unescape(node.value).substr(14))}),htmlParser.addNodeFilter("xml:namespace,input",function(nodes,name){for(var node,i=nodes.length;i--;)node=nodes[i],7===node.type?node.remove():1===node.type&&("input"!==name||"type"in node.attributes.map||node.attr("type","text"))}),htmlParser.addAttributeFilter("data-mce-type",function(nodes){$_5wjzy24jh8lyw2t.each(nodes,function(node){"format-caret"===node.attr("data-mce-type")&&(node.isEmpty(htmlParser.schema.getNonEmptyElements())?node.remove():node.unwrap())})}),htmlParser.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize",function(nodes,name){for(var i=nodes.length;i--;)nodes[i].attr(name,null)})},trimTrailingBr=function(rootNode){var brNode1,brNode2,isBr=function(node){return node&&"br"===node.name};brNode1=rootNode.lastChild,isBr(brNode1)&&(brNode2=brNode1.prev,isBr(brNode2)&&(brNode1.remove(),brNode2.remove()))},$_834niu69jh8lyxg1={register:register,trimTrailingBr:trimTrailingBr},preProcess=function(editor,node,args){var impl,doc,oldDoc,dom=editor.dom;return node=node.cloneNode(!0),impl=document.implementation,impl.createHTMLDocument&&(doc=impl.createHTMLDocument(""),$_ahowuxkjh8lywbj.each("BODY"===node.nodeName?node.childNodes:[node],function(node){doc.body.appendChild(doc.importNode(node,!0))}),node="BODY"!==node.nodeName?doc.body.firstChild:doc.body,oldDoc=dom.doc,dom.doc=doc),$_a4fgrn4cjh8lyx4q.firePreProcess(editor,$_7ffry568jh8lyxfy.merge(args,{node:node})),oldDoc&&(dom.doc=oldDoc),node},shouldFireEvent=function(editor,args){return editor&&editor.hasEventListeners("PreProcess")&&!args.no_events},process=function(editor,node,args){return shouldFireEvent(editor,args)?preProcess(editor,node,args):node},$_gg1aca6ajh8lyxg7={process:process},removeAttrs=function(node,names){$_5wjzy24jh8lyw2t.each(names,function(name){node.attr(name,null)})},addFontToSpansFilter=function(domParser,styles,fontSizes){domParser.addNodeFilter("font",function(nodes){$_5wjzy24jh8lyw2t.each(nodes,function(node){var props=styles.parse(node.attr("style")),color=node.attr("color"),face=node.attr("face"),size=node.attr("size");color&&(props.color=color),face&&(props["font-family"]=face),size&&(props["font-size"]=fontSizes[parseInt(node.attr("size"),10)-1]),node.name="span",node.attr("style",styles.serialize(props)),removeAttrs(node,["color","face","size"])})})},addStrikeToSpanFilter=function(domParser,styles){domParser.addNodeFilter("strike",function(nodes){$_5wjzy24jh8lyw2t.each(nodes,function(node){var props=styles.parse(node.attr("style"));props["text-decoration"]="line-through",node.name="span",node.attr("style",styles.serialize(props))})})},addFilters=function(domParser,settings){var styles=Styles();settings.convert_fonts_to_spans&&addFontToSpansFilter(domParser,styles,$_ahowuxkjh8lywbj.explode(settings.font_size_legacy_values)),addStrikeToSpanFilter(domParser,styles)},register$1=function(domParser,settings){settings.inline_styles&&addFilters(domParser,settings)},$_9ewhzh6cjh8lyxgp={register:register$1},whiteSpaceRegExp$3=/^[ \t\r\n]*$/,typeLookup={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},walk$3=function(node,root,prev){var sibling,parent,startName=prev?"lastChild":"firstChild",siblingName=prev?"prev":"next";if(node[startName])return node[startName];if(node!==root){if(sibling=node[siblingName])return sibling;for(parent=node.parent;parent&&parent!==root;parent=parent.parent)if(sibling=parent[siblingName])return sibling}},Node$2=function(){function Node(name,type){this.name=name,this.type=type,1===type&&(this.attributes=[],this.attributes.map={})}return Node.create=function(name,attrs){var node,attrName;if(node=new Node(name,typeLookup[name]||1),attrs)for(attrName in attrs)node.attr(attrName,attrs[attrName]);return node},Node.prototype.replace=function(node){var self=this;return node.parent&&node.remove(),self.insert(node,self),self.remove(),self},Node.prototype.attr=function(name,value){var attrs,i,self=this;if("string"!=typeof name){for(i in name)self.attr(i,name[i]);return self}if(attrs=self.attributes){if(void 0!==value){if(null===value){if(name in attrs.map)for(delete attrs.map[name],i=attrs.length;i--;)if(attrs[i].name===name)return attrs=attrs.splice(i,1),self;return self}if(name in attrs.map){for(i=attrs.length;i--;)if(attrs[i].name===name){attrs[i].value=value;break}}else attrs.push({name:name,value:value});return attrs.map[name]=value,self}return attrs.map[name]}},Node.prototype.clone=function(){var i,l,selfAttrs,selfAttr,cloneAttrs,self=this,clone=new Node(self.name,self.type);if(selfAttrs=self.attributes){for(cloneAttrs=[],cloneAttrs.map={},i=0,l=selfAttrs.length;i<l;i++)selfAttr=selfAttrs[i],"id"!==selfAttr.name&&(cloneAttrs[cloneAttrs.length]={name:selfAttr.name,value:selfAttr.value},cloneAttrs.map[selfAttr.name]=selfAttr.value);clone.attributes=cloneAttrs}return clone.value=self.value,clone.shortEnded=self.shortEnded,clone},Node.prototype.wrap=function(wrapper){var self=this;return self.parent.insert(wrapper,self),wrapper.append(self),self},Node.prototype.unwrap=function(){var node,next,self=this;for(node=self.firstChild;node;)next=node.next,self.insert(node,self,!0),node=next;self.remove()},Node.prototype.remove=function(){var self=this,parent=self.parent,next=self.next,prev=self.prev;return parent&&(parent.firstChild===self?(parent.firstChild=next,next&&(next.prev=null)):prev.next=next,parent.lastChild===self?(parent.lastChild=prev,prev&&(prev.next=null)):next.prev=prev,self.parent=self.next=self.prev=null),self},Node.prototype.append=function(node){var last,self=this;return node.parent&&node.remove(),last=self.lastChild,last?(last.next=node,node.prev=last,self.lastChild=node):self.lastChild=self.firstChild=node,node.parent=self,node},Node.prototype.insert=function(node,refNode,before){var parent;return node.parent&&node.remove(),parent=refNode.parent||this,before?(refNode===parent.firstChild?parent.firstChild=node:refNode.prev.next=node,node.prev=refNode.prev,node.next=refNode,refNode.prev=node):(refNode===parent.lastChild?parent.lastChild=node:refNode.next.prev=node,node.next=refNode.next,node.prev=refNode,refNode.next=node),node.parent=parent,node},Node.prototype.getAll=function(name){var node,self=this,collection=[];for(node=self.firstChild;node;node=walk$3(node,self))node.name===name&&collection.push(node);return collection},Node.prototype.empty=function(){var nodes,i,node,self=this;if(self.firstChild){for(nodes=[],node=self.firstChild;node;node=walk$3(node,self))nodes.push(node);for(i=nodes.length;i--;)node=nodes[i],node.parent=node.firstChild=node.lastChild=node.next=node.prev=null}return self.firstChild=self.lastChild=null,self},Node.prototype.isEmpty=function(elements,whitespace,predicate){var i,name,self=this,node=self.firstChild;if(whitespace=whitespace||{},node)do{if(1===node.type){if(node.attributes.map["data-mce-bogus"])continue;if(elements[node.name])return!1;for(i=node.attributes.length;i--;)if(name=node.attributes[i].name,"name"===name||0===name.indexOf("data-mce-bookmark"))return!1}if(8===node.type)return!1;if(3===node.type&&!whiteSpaceRegExp$3.test(node.value))return!1;if(3===node.type&&node.parent&&whitespace[node.parent.name]&&whiteSpaceRegExp$3.test(node.value))return!1;if(predicate&&predicate(node))return!1}while(node=walk$3(node,self));return!0},Node.prototype.walk=function(prev){return walk$3(this,null,prev)},Node}(),paddEmptyNode=function(settings,args,blockElements,node){var brPreferred=settings.padd_empty_with_br||args.insert;brPreferred&&blockElements[node.name]?node.empty().append(new Node$2("br",1)).shortEnded=!0:node.empty().append(new Node$2("#text",3)).value=" "},isPaddedWithNbsp=function(node){return hasOnlyChild(node,"#text")&&" "===node.firstChild.value},hasOnlyChild=function(node,name){return node&&node.firstChild&&node.firstChild===node.lastChild&&node.firstChild.name===name},isPadded=function(schema,node){var rule=schema.getElementRule(node.name);return rule&&rule.paddEmpty},isEmpty$2=function(schema,nonEmptyElements,whitespaceElements,node){return node.isEmpty(nonEmptyElements,whitespaceElements,function(node){return isPadded(schema,node)})},isLineBreakNode=function(node,blockElements){return node&&(blockElements[node.name]||"br"===node.name)},register$2=function(parser,settings){var schema=parser.schema;settings.remove_trailing_brs&&parser.addNodeFilter("br",function(nodes,_,args){var i,node,parent,lastParent,prev,prevName,elementRule,textNode,l=nodes.length,blockElements=$_ahowuxkjh8lywbj.extend({},schema.getBlockElements()),nonEmptyElements=schema.getNonEmptyElements(),whiteSpaceElements=schema.getNonEmptyElements();for(blockElements.body=1,i=0;i<l;i++)if(node=nodes[i],parent=node.parent,blockElements[node.parent.name]&&node===parent.lastChild){for(prev=node.prev;prev;){if(prevName=prev.name,"span"!==prevName||"bookmark"!==prev.attr("data-mce-type")){if("br"!==prevName)break;if("br"===prevName){node=null;break}}prev=prev.prev}node&&(node.remove(),isEmpty$2(schema,nonEmptyElements,whiteSpaceElements,parent)&&(elementRule=schema.getElementRule(parent.name),elementRule&&(elementRule.removeEmpty?parent.remove():elementRule.paddEmpty&&paddEmptyNode(settings,args,blockElements,parent))))}else{for(lastParent=node;parent&&parent.firstChild===lastParent&&parent.lastChild===lastParent&&(lastParent=parent,!blockElements[parent.name]);)parent=parent.parent;lastParent===parent&&settings.padd_empty_with_br!==!0&&(textNode=new Node$2("#text",3),textNode.value=" ",node.replace(textNode))}}),parser.addAttributeFilter("href",function(nodes){var node,i=nodes.length,appendRel=function(rel){var parts=rel.split(" ").filter(function(p){return p.length>0});return parts.concat(["noopener"]).sort().join(" ")},addNoOpener=function(rel){var newRel=rel?$_ahowuxkjh8lywbj.trim(rel):"";return/\b(noopener)\b/g.test(newRel)?newRel:appendRel(newRel)};if(!settings.allow_unsafe_link_target)for(;i--;)node=nodes[i],"a"===node.name&&"_blank"===node.attr("target")&&node.attr("rel",addNoOpener(node.attr("rel")))}),settings.allow_html_in_named_anchor||parser.addAttributeFilter("id,name",function(nodes){for(var sibling,prevSibling,parent,node,i=nodes.length;i--;)if(node=nodes[i],"a"===node.name&&node.firstChild&&!node.attr("href")){parent=node.parent,sibling=node.lastChild;do prevSibling=sibling.prev,parent.insert(sibling,node),sibling=prevSibling;while(sibling)}}),settings.fix_list_elements&&parser.addNodeFilter("ul,ol",function(nodes){for(var node,parentNode,i=nodes.length;i--;)if(node=nodes[i],parentNode=node.parent,"ul"===parentNode.name||"ol"===parentNode.name)if(node.prev&&"li"===node.prev.name)node.prev.append(node);else{var li=new Node$2("li",1);li.attr("style","list-style-type: none"),node.wrap(li)}}),settings.validate&&schema.getValidClasses()&&parser.addAttributeFilter("class",function(nodes){for(var node,classList,ci,className,classValue,validClassesMap,valid,i=nodes.length,validClasses=schema.getValidClasses();i--;){for(node=nodes[i],classList=node.attr("class").split(" "),classValue="",ci=0;ci<classList.length;ci++)className=classList[ci],valid=!1,validClassesMap=validClasses["*"],validClassesMap&&validClassesMap[className]&&(valid=!0),validClassesMap=validClasses[node.name],!valid&&validClassesMap&&validClassesMap[className]&&(valid=!0),valid&&(classValue&&(classValue+=" "),classValue+=className);classValue.length||(classValue=null),node.attr("class",classValue)}})},makeMap$4=$_ahowuxkjh8lywbj.makeMap,each$18=$_ahowuxkjh8lywbj.each,explode$3=$_ahowuxkjh8lywbj.explode,extend$3=$_ahowuxkjh8lywbj.extend,addTempAttr=function(htmlParser,tempAttrs,name){$_ahowuxkjh8lywbj.inArray(tempAttrs,name)===-1&&(htmlParser.addAttributeFilter(name,function(nodes,name){for(var i=nodes.length;i--;)nodes[i].attr(name,null)}),tempAttrs.push(name))},postProcess$1=function(editor,args,content){if(!args.no_events&&editor){var outArgs=$_a4fgrn4cjh8lyx4q.firePostProcess(editor,$_7ffry568jh8lyxfy.merge(args,{content:content}));return outArgs.content}return content},getHtmlFromNode=function(dom,node,args){var html=$_d383mr21jh8lywlv.trim(args.getInner?node.innerHTML:dom.getOuterHTML(node));return args.selection||isWsPreserveElement($_cgttw3zjh8lywdq.fromDom(node))?html:$_ahowuxkjh8lywbj.trim(html)},parseHtml=function(htmlParser,html,args){var parserArgs=args.selection?$_7ffry568jh8lyxfy.merge({forced_root_block:!1},args):args,rootNode=htmlParser.parse(html,parserArgs);return $_834niu69jh8lyxg1.trimTrailingBr(rootNode),rootNode},serializeNode=function(settings,schema,node){var htmlSerializer=HtmlSerializer(settings,schema);return htmlSerializer.serialize(node)},toHtml=function(editor,settings,schema,rootNode,args){var content=serializeNode(settings,schema,rootNode);return postProcess$1(editor,args,content)};!function(BookmarkManager){BookmarkManager.isBookmarkNode=$_eyp5ec2njh8lywpo.isBookmarkNode}(BookmarkManager||(BookmarkManager={}));var BookmarkManager$1=BookmarkManager,isContentEditableFalse$10=$_5oonaz1qjh8lywhz.isContentEditableFalse,isContentEditableTrue$6=$_5oonaz1qjh8lywhz.isContentEditableTrue,getContentEditableRoot$2=function(root,node){for(;node&&node!==root;){if(isContentEditableTrue$6(node)||isContentEditableFalse$10(node))return node;node=node.parentNode}return null},ControlSelection=function(selection,editor){var selectedElm,selectedElmGhost,resizeHelper,resizeHandles,selectedHandle,startX,startY,selectedElmX,selectedElmY,startW,startH,ratio,resizeStarted,width,height,startScrollWidth,startScrollHeight,dom=editor.dom,each=$_ahowuxkjh8lywbj.each,editableDoc=editor.getDoc(),rootDocument=document,abs=Math.abs,round=Math.round,rootElement=editor.getBody();resizeHandles={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var rootClass=".mce-content-body";editor.contentStyles.push(rootClass+" div.mce-resizehandle {position: absolute;border: 1px solid black;box-sizing: content-box;background: #FFF;width: 7px;height: 7px;z-index: 10000}"+rootClass+" .mce-resizehandle:hover {background: #000}"+rootClass+" img[data-mce-selected],"+rootClass+" hr[data-mce-selected] {outline: 1px solid black;resize: none}"+rootClass+" .mce-clonedresizable {position: absolute;"+($_9bpim8ajh8lyw68.gecko?"":"outline: 1px dashed black;")+"opacity: .5;filter: alpha(opacity=50);z-index: 10000}"+rootClass+" .mce-resize-helper {background: #555;background: rgba(0,0,0,0.75);border-radius: 3px;border: 1px;color: white;display: none;font-family: sans-serif;font-size: 12px;white-space: nowrap;line-height: 14px;margin: 5px 10px;padding: 5px;position: absolute;z-index: 10001}");var isImage=function(elm){return elm&&("IMG"===elm.nodeName||editor.dom.is(elm,"figure.image"))},isEventOnImageOutsideRange=function(evt,range){return isImage(evt.target)&&!$_3kj84i5djh8lyxan.isXYWithinRange(evt.clientX,evt.clientY,range)},contextMenuSelectImage=function(evt){var target=evt.target;isEventOnImageOutsideRange(evt,editor.selection.getRng())&&!evt.isDefaultPrevented()&&(evt.preventDefault(),editor.selection.select(target))},getResizeTarget=function(elm){return editor.dom.is(elm,"figure.image")?elm.querySelector("img"):elm},isResizable=function(elm){var selector=editor.settings.object_resizing;return selector!==!1&&!$_9bpim8ajh8lyw68.iOS&&("string"!=typeof selector&&(selector="table,img,figure.image,div"),"false"!==elm.getAttribute("data-mce-resize")&&(elm!==editor.getBody()&&$_5h4ipt1fjh8lywgi.is($_cgttw3zjh8lywdq.fromDom(elm),selector)))},resizeGhostElement=function(e){var deltaX,deltaY,proportional,resizeHelperX,resizeHelperY;deltaX=e.screenX-startX,deltaY=e.screenY-startY,width=deltaX*selectedHandle[2]+startW,height=deltaY*selectedHandle[3]+startH,width=width<5?5:width,height=height<5?5:height,proportional=isImage(selectedElm)&&editor.settings.resize_img_proportional!==!1?!$_6lsk4i5gjh8lyxau.modifierPressed(e):$_6lsk4i5gjh8lyxau.modifierPressed(e)||isImage(selectedElm)&&selectedHandle[2]*selectedHandle[3]!==0,proportional&&(abs(deltaX)>abs(deltaY)?(height=round(width*ratio),width=round(height/ratio)):(width=round(height/ratio),height=round(width*ratio))),dom.setStyles(getResizeTarget(selectedElmGhost),{width:width,height:height}),resizeHelperX=selectedHandle.startPos.x+deltaX,resizeHelperY=selectedHandle.startPos.y+deltaY,resizeHelperX=resizeHelperX>0?resizeHelperX:0,resizeHelperY=resizeHelperY>0?resizeHelperY:0,dom.setStyles(resizeHelper,{left:resizeHelperX,top:resizeHelperY,display:"block"}),resizeHelper.innerHTML=width+" &times; "+height,selectedHandle[2]<0&&selectedElmGhost.clientWidth<=width&&dom.setStyle(selectedElmGhost,"left",selectedElmX+(startW-width)),selectedHandle[3]<0&&selectedElmGhost.clientHeight<=height&&dom.setStyle(selectedElmGhost,"top",selectedElmY+(startH-height)),deltaX=rootElement.scrollWidth-startScrollWidth,deltaY=rootElement.scrollHeight-startScrollHeight,deltaX+deltaY!==0&&dom.setStyles(resizeHelper,{left:resizeHelperX-deltaX,top:resizeHelperY-deltaY}),resizeStarted||($_a4fgrn4cjh8lyx4q.fireObjectResizeStart(editor,selectedElm,startW,startH),resizeStarted=!0)},endGhostResize=function(){resizeStarted=!1;var setSizeProp=function(name,value){value&&(selectedElm.style[name]||!editor.schema.isValid(selectedElm.nodeName.toLowerCase(),name)?dom.setStyle(getResizeTarget(selectedElm),name,value):dom.setAttrib(getResizeTarget(selectedElm),name,value))};setSizeProp("width",width),setSizeProp("height",height),dom.unbind(editableDoc,"mousemove",resizeGhostElement),dom.unbind(editableDoc,"mouseup",endGhostResize),rootDocument!==editableDoc&&(dom.unbind(rootDocument,"mousemove",resizeGhostElement),dom.unbind(rootDocument,"mouseup",endGhostResize)),dom.remove(selectedElmGhost),dom.remove(resizeHelper),showResizeRect(selectedElm),$_a4fgrn4cjh8lyx4q.fireObjectResized(editor,selectedElm,width,height),dom.setAttrib(selectedElm,"style",dom.getAttrib(selectedElm,"style")),editor.nodeChanged()},showResizeRect=function(targetElm){var position,targetWidth,targetHeight,e,rect;hideResizeRect(),unbindResizeHandleEvents(),position=dom.getPos(targetElm,rootElement),selectedElmX=position.x,selectedElmY=position.y,rect=targetElm.getBoundingClientRect(),targetWidth=rect.width||rect.right-rect.left,targetHeight=rect.height||rect.bottom-rect.top,selectedElm!==targetElm&&(selectedElm=targetElm,width=height=0),e=editor.fire("ObjectSelected",{target:targetElm}),isResizable(targetElm)&&!e.isDefaultPrevented()?each(resizeHandles,function(handle,name){var handleElm,startDrag=function(e){startX=e.screenX,startY=e.screenY,startW=getResizeTarget(selectedElm).clientWidth,startH=getResizeTarget(selectedElm).clientHeight,ratio=startH/startW,selectedHandle=handle,handle.startPos={x:targetWidth*handle[0]+selectedElmX,y:targetHeight*handle[1]+selectedElmY},startScrollWidth=rootElement.scrollWidth,startScrollHeight=rootElement.scrollHeight,selectedElmGhost=selectedElm.cloneNode(!0),dom.addClass(selectedElmGhost,"mce-clonedresizable"),dom.setAttrib(selectedElmGhost,"data-mce-bogus","all"),selectedElmGhost.contentEditable=!1,selectedElmGhost.unSelectabe=!0,dom.setStyles(selectedElmGhost,{left:selectedElmX,top:selectedElmY,margin:0}),selectedElmGhost.removeAttribute("data-mce-selected"),rootElement.appendChild(selectedElmGhost),dom.bind(editableDoc,"mousemove",resizeGhostElement),dom.bind(editableDoc,"mouseup",endGhostResize),rootDocument!==editableDoc&&(dom.bind(rootDocument,"mousemove",resizeGhostElement),dom.bind(rootDocument,"mouseup",endGhostResize)),resizeHelper=dom.add(rootElement,"div",{"class":"mce-resize-helper","data-mce-bogus":"all"},startW+" &times; "+startH)};handleElm=dom.get("mceResizeHandle"+name),handleElm&&dom.remove(handleElm),handleElm=dom.add(rootElement,"div",{id:"mceResizeHandle"+name,"data-mce-bogus":"all","class":"mce-resizehandle",unselectable:!0,style:"cursor:"+name+"-resize; margin:0; padding:0"}),11===$_9bpim8ajh8lyw68.ie&&(handleElm.contentEditable=!1),dom.bind(handleElm,"mousedown",function(e){e.stopImmediatePropagation(),e.preventDefault(),startDrag(e)}),handle.elm=handleElm,dom.setStyles(handleElm,{left:targetWidth*handle[0]+selectedElmX-handleElm.offsetWidth/2,top:targetHeight*handle[1]+selectedElmY-handleElm.offsetHeight/2})}):hideResizeRect(),selectedElm.setAttribute("data-mce-selected","1")},hideResizeRect=function(){var name,handleElm;unbindResizeHandleEvents(),selectedElm&&selectedElm.removeAttribute("data-mce-selected");for(name in resizeHandles)handleElm=dom.get("mceResizeHandle"+name),handleElm&&(dom.unbind(handleElm),dom.remove(handleElm))},updateResizeRect=function(e){var startElm,controlElm,isChildOrEqual=function(node,parent){if(node)do if(node===parent)return!0;while(node=node.parentNode)};if(!resizeStarted&&!editor.removed)return each(dom.select("img[data-mce-selected],hr[data-mce-selected]"),function(img){img.removeAttribute("data-mce-selected")}),controlElm="mousedown"===e.type?e.target:selection.getNode(),controlElm=dom.$(controlElm).closest("table,img,figure.image,hr")[0],isChildOrEqual(controlElm,rootElement)&&(disableGeckoResize(),startElm=selection.getStart(!0),isChildOrEqual(startElm,controlElm)&&isChildOrEqual(selection.getEnd(!0),controlElm))?void showResizeRect(controlElm):void hideResizeRect()},isWithinContentEditableFalse=function(elm){return isContentEditableFalse$10(getContentEditableRoot$2(editor.getBody(),elm))},unbindResizeHandleEvents=function(){for(var name_1 in resizeHandles){var handle=resizeHandles[name_1];handle.elm&&(dom.unbind(handle.elm),delete handle.elm)}},disableGeckoResize=function(){try{editor.getDoc().execCommand("enableObjectResizing",!1,!1)}catch(ex){}};editor.on("init",function(){disableGeckoResize(),$_9bpim8ajh8lyw68.ie&&$_9bpim8ajh8lyw68.ie>=11&&(editor.on("mousedown click",function(e){var target=e.target,nodeName=target.nodeName;
resizeStarted||!/^(TABLE|IMG|HR)$/.test(nodeName)||isWithinContentEditableFalse(target)||(2!==e.button&&editor.selection.select(target,"TABLE"===nodeName),"mousedown"===e.type&&editor.nodeChanged())}),editor.dom.bind(rootElement,"mscontrolselect",function(e){var delayedSelect=function(node){$_8sy3pfhjh8lyw95.setEditorTimeout(editor,function(){editor.selection.select(node)})};return isWithinContentEditableFalse(e.target)?(e.preventDefault(),void delayedSelect(e.target)):void(/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&delayedSelect(e.target)))}));var throttledUpdateResizeRect=$_8sy3pfhjh8lyw95.throttle(function(e){editor.composing||updateResizeRect(e)});editor.on("nodechange ResizeEditor ResizeWindow drop FullscreenStateChanged",throttledUpdateResizeRect),editor.on("keyup compositionend",function(e){selectedElm&&"TABLE"===selectedElm.nodeName&&throttledUpdateResizeRect(e)}),editor.on("hide blur",hideResizeRect),editor.on("contextmenu",contextMenuSelectImage)}),editor.on("remove",unbindResizeHandleEvents);var destroy=function(){selectedElm=selectedElmGhost=null};return{isResizable:isResizable,showResizeRect:showResizeRect,hideResizeRect:hideResizeRect,updateResizeRect:updateResizeRect,destroy:destroy}},hasCeProperty=function(node){return $_5oonaz1qjh8lywhz.isContentEditableTrue(node)||$_5oonaz1qjh8lywhz.isContentEditableFalse(node)},findParent$1=function(node,rootNode,predicate){for(;node&&node!==rootNode;){if(predicate(node))return node;node=node.parentNode}return null},findClosestIeRange=function(clientX,clientY,doc){var element,rng,rects;if(element=doc.elementFromPoint(clientX,clientY),rng=doc.body.createTextRange(),element&&"HTML"!==element.tagName||(element=doc.body),rng.moveToElementText(element),rects=$_ahowuxkjh8lywbj.toArray(rng.getClientRects()),rects=rects.sort(function(a,b){return a=Math.abs(Math.max(a.top-clientY,a.bottom-clientY)),b=Math.abs(Math.max(b.top-clientY,b.bottom-clientY)),a-b}),rects.length>0){clientY=(rects[0].bottom+rects[0].top)/2;try{return rng.moveToPoint(clientX,clientY),rng.collapse(!0),rng}catch(ex){}}return null},moveOutOfContentEditableFalse=function(rng,rootNode){var parentElement=rng&&rng.parentElement?rng.parentElement():null;return $_5oonaz1qjh8lywhz.isContentEditableFalse(findParent$1(parentElement,rootNode,hasCeProperty))?null:rng},fromPoint$1=function(clientX,clientY,doc){var rng,point,pointDoc=doc;if(pointDoc.caretPositionFromPoint)point=pointDoc.caretPositionFromPoint(clientX,clientY),point&&(rng=doc.createRange(),rng.setStart(point.offsetNode,point.offset),rng.collapse(!0));else if(doc.caretRangeFromPoint)rng=doc.caretRangeFromPoint(clientX,clientY);else if(pointDoc.body.createTextRange){rng=pointDoc.body.createTextRange();try{rng.moveToPoint(clientX,clientY),rng.collapse(!0)}catch(ex){rng=findClosestIeRange(clientX,clientY,doc)}return moveOutOfContentEditableFalse(rng,doc.body)}return rng},$_ct0ht56jjh8lyxif={fromPoint:fromPoint$1},processRanges=function(editor,ranges){return $_5wjzy24jh8lyw2t.map(ranges,function(range){var evt=editor.fire("GetSelectionRange",{range:range});return evt.range!==range?evt.range:range})},$_8o0eax6kjh8lyxii={processRanges:processRanges},clone$2=function(original,deep){return $_cgttw3zjh8lywdq.fromDom(original.dom().cloneNode(deep))},shallow$1=function(original){return clone$2(original,!1)},deep$1=function(original){return clone$2(original,!0)},shallowAs=function(original,tag){var nu=$_cgttw3zjh8lywdq.fromTag(tag),attributes=$_3da62i14jh8lyweo.clone(original);return $_3da62i14jh8lyweo.setAll(nu,attributes),nu},copy$1=function(original,tag){var nu=shallowAs(original,tag),cloneChildren=$_a43q0i17jh8lywfe.children(deep$1(original));return $_9hl8mu2vjh8lywr4.append(nu,cloneChildren),nu},mutate=function(original,tag){var nu=shallowAs(original,tag);$_4m7u2e2kjh8lywpi.before(original,nu);var children=$_a43q0i17jh8lywfe.children(original);return $_9hl8mu2vjh8lywr4.append(nu,children),$_bfmuql2ujh8lywr1.remove(original),nu},$_azl0s66njh8lyxj4={shallow:shallow$1,shallowAs:shallowAs,deep:deep$1,copy:copy$1,mutate:mutate},fromElements=function(elements,scope){var doc=scope||document,fragment=doc.createDocumentFragment();return $_5wjzy24jh8lyw2t.each(elements,function(element){fragment.appendChild(element.dom())}),$_cgttw3zjh8lywdq.fromDom(fragment)},$_401op36ojh8lyxj6={fromElements:fromElements},tableModel=$_4jz0ce18jh8lywft.immutable("element","width","rows"),tableRow=$_4jz0ce18jh8lywft.immutable("element","cells"),cellPosition=$_4jz0ce18jh8lywft.immutable("x","y"),getSpan=function(td,key){var value=parseInt($_3da62i14jh8lyweo.get(td,key),10);return isNaN(value)?1:value},fillout=function(table,x,y,tr,td){for(var rowspan=getSpan(td,"rowspan"),colspan=getSpan(td,"colspan"),rows=table.rows(),y2=y;y2<y+rowspan;y2++){rows[y2]||(rows[y2]=tableRow($_azl0s66njh8lyxj4.deep(tr),[]));for(var x2=x;x2<x+colspan;x2++){var cells=rows[y2].cells();cells[x2]=y2===y&&x2===x?td:$_azl0s66njh8lyxj4.shallow(td)}}},cellExists=function(table,x,y){var rows=table.rows(),cells=rows[y]?rows[y].cells():[];return!!cells[x]},skipCellsX=function(table,x,y){for(;cellExists(table,x,y);)x++;return x},getWidth=function(rows){return $_5wjzy24jh8lyw2t.foldl(rows,function(acc,row){return row.cells().length>acc?row.cells().length:acc},0)},findElementPos=function(table,element){for(var rows=table.rows(),y=0;y<rows.length;y++)for(var cells=rows[y].cells(),x=0;x<cells.length;x++)if($_5f6gpb1djh8lywg5.eq(cells[x],element))return Option.some(cellPosition(x,y));return Option.none()},extractRows=function(table,sx,sy,ex,ey){for(var newRows=[],rows=table.rows(),y=sy;y<=ey;y++){var cells=rows[y].cells(),slice=sx<ex?cells.slice(sx,ex+1):cells.slice(ex,sx+1);newRows.push(tableRow(rows[y].element(),slice))}return newRows},subTable=function(table,startPos,endPos){var sx=startPos.x(),sy=startPos.y(),ex=endPos.x(),ey=endPos.y(),newRows=sy<ey?extractRows(table,sx,sy,ex,ey):extractRows(table,sx,ey,ex,sy);return tableModel(table.element(),getWidth(newRows),newRows)},createDomTable=function(table,rows){var tableElement=$_azl0s66njh8lyxj4.shallow(table.element()),tableBody=$_cgttw3zjh8lywdq.fromTag("tbody");return $_9hl8mu2vjh8lywr4.append(tableBody,rows),$_4m7u2e2kjh8lywpi.append(tableElement,tableBody),tableElement},modelRowsToDomRows=function(table){return $_5wjzy24jh8lyw2t.map(table.rows(),function(row){var cells=$_5wjzy24jh8lyw2t.map(row.cells(),function(cell){var td=$_azl0s66njh8lyxj4.deep(cell);return $_3da62i14jh8lyweo.remove(td,"colspan"),$_3da62i14jh8lyweo.remove(td,"rowspan"),td}),tr=$_azl0s66njh8lyxj4.shallow(row.element());return $_9hl8mu2vjh8lywr4.append(tr,cells),tr})},fromDom$2=function(tableElm){var table=tableModel($_azl0s66njh8lyxj4.shallow(tableElm),0,[]);return $_5wjzy24jh8lyw2t.each($_eebxu2gjh8lywp3.descendants(tableElm,"tr"),function(tr,y){$_5wjzy24jh8lyw2t.each($_eebxu2gjh8lywp3.descendants(tr,"td,th"),function(td,x){fillout(table,skipCellsX(table,x,y),y,tr,td)})}),tableModel(table.element(),getWidth(table.rows()),table.rows())},toDom=function(table){return createDomTable(table,modelRowsToDomRows(table))},subsection=function(table,startElement,endElement){return findElementPos(table,startElement).bind(function(startPos){return findElementPos(table,endElement).map(function(endPos){return subTable(table,startPos,endPos)})})},$_fb3vwb6pjh8lyxjk={fromDom:fromDom$2,toDom:toDom,subsection:subsection},findParentListContainer=function(parents){return $_5wjzy24jh8lyw2t.find(parents,function(elm){return"ul"===$_7j1jt210jh8lywdx.name(elm)||"ol"===$_7j1jt210jh8lywdx.name(elm)})},getFullySelectedListWrappers=function(parents,rng){return $_5wjzy24jh8lyw2t.find(parents,function(elm){return"li"===$_7j1jt210jh8lywdx.name(elm)&&hasAllContentsSelected(elm,rng)}).fold($_eqpqvr6jh8lyw3s.constant([]),function(li){return findParentListContainer(parents).map(function(listCont){return[$_cgttw3zjh8lywdq.fromTag("li"),$_cgttw3zjh8lywdq.fromTag($_7j1jt210jh8lywdx.name(listCont))]}).getOr([])})},wrap$3=function(innerElm,elms){var wrapped=$_5wjzy24jh8lyw2t.foldl(elms,function(acc,elm){return $_4m7u2e2kjh8lywpi.append(elm,acc),elm},innerElm);return elms.length>0?$_401op36ojh8lyxj6.fromElements([wrapped]):wrapped},directListWrappers=function(commonAnchorContainer){return isListItem(commonAnchorContainer)?$_a43q0i17jh8lywfe.parent(commonAnchorContainer).filter(isList).fold($_eqpqvr6jh8lyw3s.constant([]),function(listElm){return[commonAnchorContainer,listElm]}):isList(commonAnchorContainer)?[commonAnchorContainer]:[]},getWrapElements=function(rootNode,rng){var commonAnchorContainer=$_cgttw3zjh8lywdq.fromDom(rng.commonAncestorContainer),parents=$_dyxtub3ejh8lywxq.parentsAndSelf(commonAnchorContainer,rootNode),wrapElements=$_5wjzy24jh8lyw2t.filter(parents,function(elm){return isInline(elm)||isHeading(elm)}),listWrappers=getFullySelectedListWrappers(parents,rng),allWrappers=wrapElements.concat(listWrappers.length?listWrappers:directListWrappers(commonAnchorContainer));return $_5wjzy24jh8lyw2t.map(allWrappers,$_azl0s66njh8lyxj4.shallow)},emptyFragment=function(){return $_401op36ojh8lyxj6.fromElements([])},getFragmentFromRange=function(rootNode,rng){return wrap$3($_cgttw3zjh8lywdq.fromDom(rng.cloneContents()),getWrapElements(rootNode,rng))},getParentTable=function(rootElm,cell){return $_7sg18r3cjh8lywu1.ancestor(cell,"table",$_eqpqvr6jh8lyw3s.curry($_5f6gpb1djh8lywg5.eq,rootElm))},getTableFragment=function(rootNode,selectedTableCells){return getParentTable(rootNode,selectedTableCells[0]).bind(function(tableElm){var firstCell=selectedTableCells[0],lastCell=selectedTableCells[selectedTableCells.length-1],fullTableModel=$_fb3vwb6pjh8lyxjk.fromDom(tableElm);return $_fb3vwb6pjh8lyxjk.subsection(fullTableModel,firstCell,lastCell).map(function(sectionedTableModel){return $_401op36ojh8lyxj6.fromElements([$_fb3vwb6pjh8lyxjk.toDom(sectionedTableModel)])})}).getOrThunk(emptyFragment)},getSelectionFragment=function(rootNode,ranges){return ranges.length>0&&ranges[0].collapsed?emptyFragment():getFragmentFromRange(rootNode,ranges[0])},read$4=function(rootNode,ranges){var selectedCells=$_bwjtq63tjh8lyx1g.getCellsFromElementOrRanges(ranges,rootNode);return selectedCells.length>0?getTableFragment(rootNode,selectedCells):getSelectionFragment(rootNode,ranges)},$_7lffms6mjh8lyxip={read:read$4},getContent=function(editor,args){var fragment,rng=editor.selection.getRng(),tmpElm=editor.dom.create("body"),sel=editor.selection.getSel(),ranges=$_8o0eax6kjh8lyxii.processRanges(editor,$_d1o8uj3ujh8lyx1u.getRanges(sel));if(args=args||{},args.get=!0,args.format=args.format||"html",args.selection=!0,args=editor.fire("BeforeGetContent",args),args.isDefaultPrevented())return editor.fire("GetContent",args),args.content;if("text"===args.format)return editor.selection.isCollapsed()?"":$_d383mr21jh8lywlv.trim(rng.text||(sel.toString?sel.toString():""));rng.cloneContents?(fragment=args.contextual?$_7lffms6mjh8lyxip.read($_cgttw3zjh8lywdq.fromDom(editor.getBody()),ranges).dom():rng.cloneContents(),fragment&&tmpElm.appendChild(fragment)):void 0!==rng.item||void 0!==rng.htmlText?(tmpElm.innerHTML="<br>"+(rng.item?rng.item(0).outerHTML:rng.htmlText),tmpElm.removeChild(tmpElm.firstChild)):tmpElm.innerHTML=rng.toString(),args.getInner=!0;var content=editor.selection.serializer.serialize(tmpElm,args);return"tree"===args.format?content:(args.content=editor.selection.isCollapsed()?"":content,editor.fire("GetContent",args),args.content)},$_dxvi8w6ljh8lyxik={getContent:getContent},setContent=function(editor,content,args){var caretNode,frag,temp,rng=editor.selection.getRng(),doc=editor.getDoc();if(args=args||{format:"html"},args.set=!0,args.selection=!0,args.content=content,!args.no_events&&(args=editor.fire("BeforeSetContent",args),args.isDefaultPrevented()))return void editor.fire("SetContent",args);if(content=args.content,rng.insertNode){content+='<span id="__caret">_</span>',rng.startContainer===doc&&rng.endContainer===doc?doc.body.innerHTML=content:(rng.deleteContents(),0===doc.body.childNodes.length?doc.body.innerHTML=content:rng.createContextualFragment?rng.insertNode(rng.createContextualFragment(content)):(frag=doc.createDocumentFragment(),temp=doc.createElement("div"),frag.appendChild(temp),temp.outerHTML=content,rng.insertNode(frag))),caretNode=editor.dom.get("__caret"),rng=doc.createRange(),rng.setStartBefore(caretNode),rng.setEndBefore(caretNode),editor.selection.setRng(rng),editor.dom.remove("__caret");try{editor.selection.setRng(rng)}catch(ex){}}else rng.item&&(doc.execCommand("Delete",!1,null),rng=editor.getRng()),/^\s+/.test(content)?(rng.pasteHTML('<span id="__mce_tmp">_</span>'+content),editor.dom.remove("__mce_tmp")):rng.pasteHTML(content);args.no_events||editor.fire("SetContent",args)},$_8s2a5k6qjh8lyxk1={setContent:setContent},getEndpointElement=function(root,rng,start,real,resolve){var container=start?rng.startContainer:rng.endContainer,offset=start?rng.startOffset:rng.endOffset;return Option.from(container).map($_cgttw3zjh8lywdq.fromDom).map(function(elm){return real&&rng.collapsed?elm:$_a43q0i17jh8lywfe.child(elm,resolve(elm,offset)).getOr(elm)}).bind(function(elm){return $_7j1jt210jh8lywdx.isElement(elm)?Option.some(elm):$_a43q0i17jh8lywfe.parent(elm)}).map(function(elm){return elm.dom()}).getOr(root)},getStart$2=function(root,rng,real){return getEndpointElement(root,rng,!0,real,function(elm,offset){return Math.min($_a43q0i17jh8lywfe.childNodesCount(elm),offset)})},getEnd=function(root,rng,real){return getEndpointElement(root,rng,!1,real,function(elm,offset){return offset>0?offset-1:offset})},skipEmptyTextNodes=function(node,forwards){for(var orig=node;node&&$_5oonaz1qjh8lywhz.isText(node)&&0===node.length;)node=forwards?node.nextSibling:node.previousSibling;return node||orig},getNode$1=function(root,rng){var elm,startContainer,endContainer,startOffset,endOffset;return rng?(startContainer=rng.startContainer,endContainer=rng.endContainer,startOffset=rng.startOffset,endOffset=rng.endOffset,elm=rng.commonAncestorContainer,!rng.collapsed&&(startContainer===endContainer&&endOffset-startOffset<2&&startContainer.hasChildNodes()&&(elm=startContainer.childNodes[startOffset]),3===startContainer.nodeType&&3===endContainer.nodeType&&(startContainer=startContainer.length===startOffset?skipEmptyTextNodes(startContainer.nextSibling,!0):startContainer.parentNode,endContainer=0===endOffset?skipEmptyTextNodes(endContainer.previousSibling,!1):endContainer.parentNode,startContainer&&startContainer===endContainer))?startContainer:elm&&3===elm.nodeType?elm.parentNode:elm):root},getSelectedBlocks=function(dom,rng,startElm,endElm){var node,root,selectedBlocks=[];if(root=dom.getRoot(),startElm=dom.getParent(startElm||getStart$2(root,rng,!1),dom.isBlock),endElm=dom.getParent(endElm||getEnd(root,rng,!1),dom.isBlock),startElm&&startElm!==root&&selectedBlocks.push(startElm),startElm&&endElm&&startElm!==endElm){node=startElm;for(var walker=new TreeWalker(startElm,root);(node=walker.next())&&node!==endElm;)dom.isBlock(node)&&selectedBlocks.push(node)}return endElm&&startElm!==endElm&&endElm!==root&&selectedBlocks.push(endElm),selectedBlocks},select$1=function(dom,node,content){return Option.from(node).map(function(node){var idx=dom.nodeIndex(node),rng=dom.createRng();return rng.setStart(node.parentNode,idx),rng.setEnd(node.parentNode,idx+1),content&&(moveEndPoint$1(dom,rng,node,!0),moveEndPoint$1(dom,rng,node,!1)),rng})},each$19=$_ahowuxkjh8lywbj.each,isNativeIeSelection=function(rng){return!!rng.select},isAttachedToDom=function(node){return!(!node||!node.ownerDocument)&&$_5f6gpb1djh8lywg5.contains($_cgttw3zjh8lywdq.fromDom(node.ownerDocument),$_cgttw3zjh8lywdq.fromDom(node))},isValidRange=function(rng){return!!rng&&(!!isNativeIeSelection(rng)||isAttachedToDom(rng.startContainer)&&isAttachedToDom(rng.endContainer))},Selection$1=function(dom,win,serializer,editor){var bookmarkManager,controlSelection,selectedRange,explicitRange,selectorChangedData,setCursorLocation=function(node,offset){var rng=dom.createRng();node?(rng.setStart(node,offset),rng.setEnd(node,offset),setRng(rng),collapse(!1)):(moveEndPoint$1(dom,rng,editor.getBody(),!0),setRng(rng))},getContent=function(args){return $_dxvi8w6ljh8lyxik.getContent(editor,args)},setContent=function(content,args){return $_8s2a5k6qjh8lyxk1.setContent(editor,content,args)},getStart=function(real){return getStart$2(editor.getBody(),getRng(),real)},getEnd$$1=function(real){return getEnd(editor.getBody(),getRng(),real)},getBookmark=function(type,normalized){return bookmarkManager.getBookmark(type,normalized)},moveToBookmark=function(bookmark){return bookmarkManager.moveToBookmark(bookmark)},select=function(node,content){return select$1(dom,node,content).each(setRng),node},isCollapsed=function(){var rng=getRng(),sel=getSel();return!(!rng||rng.item)&&(rng.compareEndPoints?0===rng.compareEndPoints("StartToEnd",rng):!sel||rng.collapsed)},collapse=function(toStart){var rng=getRng();rng.collapse(!!toStart),setRng(rng)},getSel=function(){return win.getSelection?win.getSelection():win.document.selection},getRng=function(){var selection,rng,elm,doc,tryCompareBoundaryPoints=function(how,sourceRange,destinationRange){try{return sourceRange.compareBoundaryPoints(how,destinationRange)}catch(ex){return-1}};if(!win)return null;if(doc=win.document,"undefined"==typeof doc||null===doc)return null;if(void 0!==editor.bookmark&&$_cnu79r4ejh8lyx4x.hasFocus(editor)===!1){var bookmark=$_eqs11m40jh8lyx31.getRng(editor);if(bookmark.isSome())return bookmark.map(function(r){return $_8o0eax6kjh8lyxii.processRanges(editor,[r])[0]}).getOr(doc.createRange())}try{(selection=getSel())&&(rng=selection.rangeCount>0?selection.getRangeAt(0):selection.createRange?selection.createRange():doc.createRange())}catch(ex){}return rng=$_8o0eax6kjh8lyxii.processRanges(editor,[rng])[0],rng||(rng=doc.createRange?doc.createRange():doc.body.createTextRange()),rng.setStart&&9===rng.startContainer.nodeType&&rng.collapsed&&(elm=dom.getRoot(),rng.setStart(elm,0),rng.setEnd(elm,0)),selectedRange&&explicitRange&&(0===tryCompareBoundaryPoints(rng.START_TO_START,rng,selectedRange)&&0===tryCompareBoundaryPoints(rng.END_TO_END,rng,selectedRange)?rng=explicitRange:(selectedRange=null,explicitRange=null)),rng},setRng=function(rng,forward){var sel,node,evt;if(isValidRange(rng)){var ieRange=isNativeIeSelection(rng)?rng:null;if(ieRange){explicitRange=null;try{ieRange.select()}catch(ex){}}else{if(sel=getSel(),evt=editor.fire("SetSelectionRange",{range:rng,forward:forward}),rng=evt.range,sel){explicitRange=rng;try{sel.removeAllRanges(),sel.addRange(rng)}catch(ex){}forward===!1&&sel.extend&&(sel.collapse(rng.endContainer,rng.endOffset),sel.extend(rng.startContainer,rng.startOffset)),selectedRange=sel.rangeCount>0?sel.getRangeAt(0):null}rng.collapsed||rng.startContainer!==rng.endContainer||!sel.setBaseAndExtent||$_9bpim8ajh8lyw68.ie||rng.endOffset-rng.startOffset<2&&rng.startContainer.hasChildNodes()&&(node=rng.startContainer.childNodes[rng.startOffset],node&&"IMG"===node.tagName&&(sel.setBaseAndExtent(rng.startContainer,rng.startOffset,rng.endContainer,rng.endOffset),sel.anchorNode===rng.startContainer&&sel.focusNode===rng.endContainer||sel.setBaseAndExtent(node,0,node,1))),editor.fire("AfterSetSelectionRange",{range:rng,forward:forward})}}},setNode=function(elm){return setContent(dom.getOuterHTML(elm)),elm},getNode=function(){return getNode$1(editor.getBody(),getRng())},getSelectedBlocks$$1=function(startElm,endElm){return getSelectedBlocks(dom,getRng(),startElm,endElm)},isForward=function(){var anchorRange,focusRange,sel=getSel();return!(sel&&sel.anchorNode&&sel.focusNode)||(anchorRange=dom.createRng(),anchorRange.setStart(sel.anchorNode,sel.anchorOffset),anchorRange.collapse(!0),focusRange=dom.createRng(),focusRange.setStart(sel.focusNode,sel.focusOffset),focusRange.collapse(!0),anchorRange.compareBoundaryPoints(anchorRange.START_TO_START,focusRange)<=0)},normalize=function(){var rng=getRng(),sel=getSel();if(!$_d1o8uj3ujh8lyx1u.hasMultipleRanges(sel)&&hasAnyRanges(editor)){var normRng=$_4v2pn63yjh8lyx2s.normalize(dom,rng);return normRng.each(function(normRng){setRng(normRng,isForward())}),normRng.getOr(rng)}return rng},selectorChanged=function(selector,callback){var currentSelectors;return selectorChangedData||(selectorChangedData={},currentSelectors={},editor.on("NodeChange",function(e){var node=e.element,parents=dom.getParents(node,null,dom.getRoot()),matchedSelectors={};each$19(selectorChangedData,function(callbacks,selector){each$19(parents,function(node){if(dom.is(node,selector))return currentSelectors[selector]||(each$19(callbacks,function(callback){callback(!0,{node:node,selector:selector,parents:parents})}),currentSelectors[selector]=callbacks),matchedSelectors[selector]=callbacks,!1})}),each$19(currentSelectors,function(callbacks,selector){matchedSelectors[selector]||(delete currentSelectors[selector],each$19(callbacks,function(callback){callback(!1,{node:node,selector:selector,parents:parents})}))})})),selectorChangedData[selector]||(selectorChangedData[selector]=[]),selectorChangedData[selector].push(callback),exports},getScrollContainer=function(){for(var scrollContainer,node=dom.getRoot();node&&"BODY"!==node.nodeName;){if(node.scrollHeight>node.clientHeight){scrollContainer=node;break}node=node.parentNode}return scrollContainer},scrollIntoView=function(elm,alignToTop){return $_cosk3k2ijh8lywpa.scrollElementIntoView(editor,elm,alignToTop)},placeCaretAt=function(clientX,clientY){return setRng($_ct0ht56jjh8lyxif.fromPoint(clientX,clientY,editor.getDoc()))},getBoundingClientRect=function(){var rng=getRng();return rng.collapsed?CaretPosition$1.fromRangeStart(rng).getClientRects()[0]:rng.getBoundingClientRect()},destroy=function(){win=selectedRange=explicitRange=null,controlSelection.destroy()},exports={bookmarkManager:null,controlSelection:null,dom:dom,win:win,serializer:serializer,editor:editor,collapse:collapse,setCursorLocation:setCursorLocation,getContent:getContent,setContent:setContent,getBookmark:getBookmark,moveToBookmark:moveToBookmark,select:select,isCollapsed:isCollapsed,isForward:isForward,setNode:setNode,getNode:getNode,getSel:getSel,setRng:setRng,getRng:getRng,getStart:getStart,getEnd:getEnd$$1,getSelectedBlocks:getSelectedBlocks$$1,normalize:normalize,selectorChanged:selectorChanged,getScrollContainer:getScrollContainer,scrollIntoView:scrollIntoView,placeCaretAt:placeCaretAt,getBoundingClientRect:getBoundingClientRect,destroy:destroy};return bookmarkManager=BookmarkManager$1(exports),controlSelection=ControlSelection(exports,editor),exports.bookmarkManager=bookmarkManager,exports.controlSelection=controlSelection,exports},isContentEditableFalse$11=$_5oonaz1qjh8lywhz.isContentEditableFalse,getSelectedNode$1=getSelectedNode,isAfterContentEditableFalse$2=isAfterContentEditableFalse,isBeforeContentEditableFalse$2=isBeforeContentEditableFalse,getVisualCaretPosition=function(walkFn,caretPosition){for(;caretPosition=walkFn(caretPosition);)if(caretPosition.isVisible())return caretPosition;return caretPosition},isMoveInsideSameBlock=function(from,to){var inSameBlock=isInSameBlock(from,to);return!(inSameBlock||!$_5oonaz1qjh8lywhz.isBr(from.getNode()))||inSameBlock},moveToCeFalseHorizontally=function(direction,editor,getNextPosFn,range){var node,caretPosition,peekCaretPosition,rangeIsInContainerBlock,forwards=direction===HDirection.Forwards,isBeforeContentEditableFalseFn=forwards?isBeforeContentEditableFalse$2:isAfterContentEditableFalse$2;return!range.collapsed&&(node=getSelectedNode$1(range),isContentEditableFalse$11(node))?showCaret(direction,editor,node,direction===HDirection.Backwards,!0):(rangeIsInContainerBlock=isRangeInCaretContainerBlock(range),caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range),isBeforeContentEditableFalseFn(caretPosition)?selectNode(editor,caretPosition.getNode(!forwards)):(caretPosition=getNextPosFn(caretPosition))?isBeforeContentEditableFalseFn(caretPosition)?showCaret(direction,editor,caretPosition.getNode(!forwards),forwards,!0):(peekCaretPosition=getNextPosFn(caretPosition),isBeforeContentEditableFalseFn(peekCaretPosition)&&isMoveInsideSameBlock(caretPosition,peekCaretPosition)?showCaret(direction,editor,peekCaretPosition.getNode(!forwards),forwards,!0):rangeIsInContainerBlock?renderRangeCaret(editor,caretPosition.toRange(),!0):null):rangeIsInContainerBlock?range:null)},moveToCeFalseVertically=function(direction,editor,walkerFn,range){var caretPosition,linePositions,nextLinePositions,closestNextLineRect,caretClientRect,clientX,dist1,dist2,contentEditableFalseNode;if(contentEditableFalseNode=getSelectedNode$1(range),caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range),linePositions=walkerFn(editor.getBody(),isAboveLine(1),caretPosition),nextLinePositions=$_9tjm51ljh8lywbq.filter(linePositions,isLine(1)),caretClientRect=$_9tjm51ljh8lywbq.last(caretPosition.getClientRects()),(isBeforeContentEditableFalse$2(caretPosition)||isBeforeTable(caretPosition))&&(contentEditableFalseNode=caretPosition.getNode()),(isAfterContentEditableFalse$2(caretPosition)||isAfterTable(caretPosition))&&(contentEditableFalseNode=caretPosition.getNode(!0)),!caretClientRect)return null;if(clientX=caretClientRect.left,closestNextLineRect=findClosestClientRect(nextLinePositions,clientX),closestNextLineRect&&isContentEditableFalse$11(closestNextLineRect.node))return dist1=Math.abs(clientX-closestNextLineRect.left),dist2=Math.abs(clientX-closestNextLineRect.right),showCaret(direction,editor,closestNextLineRect.node,dist1<dist2,!0);if(contentEditableFalseNode){var caretPositions=positionsUntil(direction,editor.getBody(),isAboveLine(1),contentEditableFalseNode);if(closestNextLineRect=findClosestClientRect($_9tjm51ljh8lywbq.filter(caretPositions,isLine(1)),clientX))return renderRangeCaret(editor,closestNextLineRect.position.toRange(),!0);if(closestNextLineRect=$_9tjm51ljh8lywbq.last($_9tjm51ljh8lywbq.filter(caretPositions,isLine(0))))return renderRangeCaret(editor,closestNextLineRect.position.toRange(),!0)}},createTextBlock=function(editor){var textBlock=editor.dom.create(editor.settings.forced_root_block);return(!$_9bpim8ajh8lyw68.ie||$_9bpim8ajh8lyw68.ie>=11)&&(textBlock.innerHTML='<br data-mce-bogus="1">'),textBlock},exitPreBlock=function(editor,direction,range){var pre,caretPos,newBlock,caretWalker=CaretWalker(editor.getBody()),getNextVisualCaretPosition=$_8aqzj925jh8lywmj.curry(getVisualCaretPosition,caretWalker.next),getPrevVisualCaretPosition=$_8aqzj925jh8lywmj.curry(getVisualCaretPosition,caretWalker.prev);if(range.collapsed&&editor.settings.forced_root_block){if(pre=editor.dom.getParent(range.startContainer,"PRE"),!pre)return;caretPos=1===direction?getNextVisualCaretPosition(CaretPosition$1.fromRangeStart(range)):getPrevVisualCaretPosition(CaretPosition$1.fromRangeStart(range)),caretPos||(newBlock=createTextBlock(editor),1===direction?editor.$(pre).after(newBlock):editor.$(pre).before(newBlock),editor.selection.select(newBlock,!0),editor.selection.collapse())}},getHorizontalRange=function(editor,forward){var newRange,caretWalker=CaretWalker(editor.getBody()),getNextVisualCaretPosition=$_8aqzj925jh8lywmj.curry(getVisualCaretPosition,caretWalker.next),getPrevVisualCaretPosition=$_8aqzj925jh8lywmj.curry(getVisualCaretPosition,caretWalker.prev),direction=forward?HDirection.Forwards:HDirection.Backwards,getNextPosFn=forward?getNextVisualCaretPosition:getPrevVisualCaretPosition,range=editor.selection.getRng();return(newRange=moveToCeFalseHorizontally(direction,editor,getNextPosFn,range))?newRange:(newRange=exitPreBlock(editor,direction,range),newRange?newRange:null)},getVerticalRange=function(editor,down){var newRange,direction=down?1:-1,walkerFn=down?downUntil:upUntil,range=editor.selection.getRng();return(newRange=moveToCeFalseVertically(direction,editor,walkerFn,range))?newRange:(newRange=exitPreBlock(editor,direction,range),newRange?newRange:null)},moveH$1=function(editor,forward){return function(){var newRng=getHorizontalRange(editor,forward);return!!newRng&&(editor.selection.setRng(newRng),!0)}},moveV$1=function(editor,down){return function(){var newRng=getVerticalRange(editor,down);return!!newRng&&(editor.selection.setRng(newRng),!0)}},defaultPatterns=function(patterns){return $_5wjzy24jh8lyw2t.map(patterns,function(pattern){return $_7ffry568jh8lyxfy.merge({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:$_eqpqvr6jh8lyw3s.noop},pattern)})},matchesEvent=function(pattern,evt){return evt.keyCode===pattern.keyCode&&evt.shiftKey===pattern.shiftKey&&evt.altKey===pattern.altKey&&evt.ctrlKey===pattern.ctrlKey&&evt.metaKey===pattern.metaKey},match$1=function(patterns,evt){return $_5wjzy24jh8lyw2t.bind(defaultPatterns(patterns),function(pattern){return matchesEvent(pattern,evt)?[pattern]:[]})},action=function(f){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}},execute=function(patterns,evt){return $_5wjzy24jh8lyw2t.find(match$1(patterns,evt),function(pattern){return pattern.action()})},$_8um8ta6vjh8lyxko={match:match$1,action:action,execute:execute},executeKeydownOverride=function(editor,caret,evt){var os=$_9hkktfnjh8lywc6.detect().os;$_8um8ta6vjh8lyxko.execute([{keyCode:$_6lsk4i5gjh8lyxau.RIGHT,action:moveH$1(editor,!0)},{keyCode:$_6lsk4i5gjh8lyxau.LEFT,action:moveH$1(editor,!1)},{keyCode:$_6lsk4i5gjh8lyxau.UP,action:moveV$1(editor,!1)},{keyCode:$_6lsk4i5gjh8lyxau.DOWN,action:moveV$1(editor,!0)},{keyCode:$_6lsk4i5gjh8lyxau.RIGHT,action:moveH(editor,!0)},{keyCode:$_6lsk4i5gjh8lyxau.LEFT,action:moveH(editor,!1)},{keyCode:$_6lsk4i5gjh8lyxau.UP,action:moveV(editor,!1)},{keyCode:$_6lsk4i5gjh8lyxau.DOWN,action:moveV(editor,!0)},{keyCode:$_6lsk4i5gjh8lyxau.RIGHT,action:$_65xx7w3pjh8lyx0d.move(editor,caret,!0)},{keyCode:$_6lsk4i5gjh8lyxau.LEFT,action:$_65xx7w3pjh8lyx0d.move(editor,caret,!1)},{keyCode:$_6lsk4i5gjh8lyxau.RIGHT,ctrlKey:!os.isOSX(),altKey:os.isOSX(),action:$_65xx7w3pjh8lyx0d.moveNextWord(editor,caret)},{keyCode:$_6lsk4i5gjh8lyxau.LEFT,ctrlKey:!os.isOSX(),altKey:os.isOSX(),action:$_65xx7w3pjh8lyx0d.movePrevWord(editor,caret)}],evt).each(function(_){evt.preventDefault()})},setup$5=function(editor,caret){editor.on("keydown",function(evt){evt.isDefaultPrevented()===!1&&executeKeydownOverride(editor,caret,evt)})},$_8m3to56tjh8lyxkd={setup:setup$5},getParentInlines=function(rootElm,startElm){var parents=$_dyxtub3ejh8lywxq.parentsAndSelf(startElm,rootElm);return $_5wjzy24jh8lyw2t.findIndex(parents,isBlock).fold($_eqpqvr6jh8lyw3s.constant(parents),function(index){return parents.slice(0,index)})},hasOnlyOneChild$1=function(elm){return 1===$_a43q0i17jh8lywfe.children(elm).length},deleteLastPosition=function(forward,editor,target,parentInlines){var isFormatElement$$1=$_eqpqvr6jh8lyw3s.curry(isFormatElement,editor),formatNodes=$_5wjzy24jh8lyw2t.map($_5wjzy24jh8lyw2t.filter(parentInlines,isFormatElement$$1),function(elm){return elm.dom()});if(0===formatNodes.length)$_1al0sh3jjh8lywyv.deleteElement(editor,forward,target);else{var pos=replaceWithCaretFormat(target.dom(),formatNodes);editor.selection.setRng(pos.toRange())}},deleteCaret$1=function(editor,forward){var rootElm=$_cgttw3zjh8lywdq.fromDom(editor.getBody()),startElm=$_cgttw3zjh8lywdq.fromDom(editor.selection.getStart()),parentInlines=$_5wjzy24jh8lyw2t.filter(getParentInlines(rootElm,startElm),hasOnlyOneChild$1);return $_5wjzy24jh8lyw2t.last(parentInlines).map(function(target){var fromPos=CaretPosition$1.fromRangeStart(editor.selection.getRng());return!!$_aj8isd34jh8lyws4.willDeleteLastPositionInElement(forward,fromPos,target.dom())&&(deleteLastPosition(forward,editor,target,parentInlines),!0)}).getOr(!1)},backspaceDelete$5=function(editor,forward){return!!editor.selection.isCollapsed()&&deleteCaret$1(editor,forward)},$_vald86xjh8lyxkw={backspaceDelete:backspaceDelete$5},executeKeydownOverride$1=function(editor,caret,evt){$_8um8ta6vjh8lyxko.execute([{keyCode:$_6lsk4i5gjh8lyxau.BACKSPACE,action:$_8um8ta6vjh8lyxko.action($_ar80r13gjh8lywy7.backspaceDelete,editor,!1)
},{keyCode:$_6lsk4i5gjh8lyxau.DELETE,action:$_8um8ta6vjh8lyxko.action($_ar80r13gjh8lywy7.backspaceDelete,editor,!0)},{keyCode:$_6lsk4i5gjh8lyxau.BACKSPACE,action:$_8um8ta6vjh8lyxko.action($_ej9d8d3kjh8lywzc.backspaceDelete,editor,caret,!1)},{keyCode:$_6lsk4i5gjh8lyxau.DELETE,action:$_8um8ta6vjh8lyxko.action($_ej9d8d3kjh8lywzc.backspaceDelete,editor,caret,!0)},{keyCode:$_6lsk4i5gjh8lyxau.BACKSPACE,action:$_8um8ta6vjh8lyxko.action($_lcy1p3fjh8lywxx.backspaceDelete,editor,!1)},{keyCode:$_6lsk4i5gjh8lyxau.DELETE,action:$_8um8ta6vjh8lyxko.action($_lcy1p3fjh8lywxx.backspaceDelete,editor,!0)},{keyCode:$_6lsk4i5gjh8lyxau.BACKSPACE,action:$_8um8ta6vjh8lyxko.action($_5jmwsv32jh8lywrr.backspaceDelete,editor,!1)},{keyCode:$_6lsk4i5gjh8lyxau.DELETE,action:$_8um8ta6vjh8lyxko.action($_5jmwsv32jh8lywrr.backspaceDelete,editor,!0)},{keyCode:$_6lsk4i5gjh8lyxau.BACKSPACE,action:$_8um8ta6vjh8lyxko.action($_746feo3rjh8lyx0o.backspaceDelete,editor,!1)},{keyCode:$_6lsk4i5gjh8lyxau.DELETE,action:$_8um8ta6vjh8lyxko.action($_746feo3rjh8lyx0o.backspaceDelete,editor,!0)},{keyCode:$_6lsk4i5gjh8lyxau.BACKSPACE,action:$_8um8ta6vjh8lyxko.action($_vald86xjh8lyxkw.backspaceDelete,editor,!1)},{keyCode:$_6lsk4i5gjh8lyxau.DELETE,action:$_8um8ta6vjh8lyxko.action($_vald86xjh8lyxkw.backspaceDelete,editor,!0)}],evt).each(function(_){evt.preventDefault()})},executeKeyupOverride=function(editor,evt){$_8um8ta6vjh8lyxko.execute([{keyCode:$_6lsk4i5gjh8lyxau.BACKSPACE,action:$_8um8ta6vjh8lyxko.action($_ar80r13gjh8lywy7.paddEmptyElement,editor)},{keyCode:$_6lsk4i5gjh8lyxau.DELETE,action:$_8um8ta6vjh8lyxko.action($_ar80r13gjh8lywy7.paddEmptyElement,editor)}],evt)},setup$6=function(editor,caret){editor.on("keydown",function(evt){evt.isDefaultPrevented()===!1&&executeKeydownOverride$1(editor,caret,evt)}),editor.on("keyup",function(evt){evt.isDefaultPrevented()===!1&&executeKeyupOverride(editor,evt)})},$_4ow4756wjh8lyxkt={setup:setup$6},firstNonWhiteSpaceNodeSibling=function(node){for(;node;){if(1===node.nodeType||3===node.nodeType&&node.data&&/[\r\n\s]/.test(node.data))return node;node=node.nextSibling}},moveToCaretPosition=function(editor,root){var walker,node,rng,tempElm,lastNode=root,dom=editor.dom,moveCaretBeforeOnEnterElementsMap=editor.schema.getMoveCaretBeforeOnEnterElements();if(root){if(/^(LI|DT|DD)$/.test(root.nodeName)){var firstChild=firstNonWhiteSpaceNodeSibling(root.firstChild);firstChild&&/^(UL|OL|DL)$/.test(firstChild.nodeName)&&root.insertBefore(dom.doc.createTextNode(" "),root.firstChild)}if(rng=dom.createRng(),root.normalize(),root.hasChildNodes()){for(walker=new TreeWalker(root,root);node=walker.current();){if($_5oonaz1qjh8lywhz.isText(node)){rng.setStart(node,0),rng.setEnd(node,0);break}if(moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]){rng.setStartBefore(node),rng.setEndBefore(node);break}lastNode=node,node=walker.next()}node||(rng.setStart(lastNode,0),rng.setEnd(lastNode,0))}else $_5oonaz1qjh8lywhz.isBr(root)?root.nextSibling&&dom.isBlock(root.nextSibling)?(rng.setStartBefore(root),rng.setEndBefore(root)):(rng.setStartAfter(root),rng.setEndAfter(root)):(rng.setStart(root,0),rng.setEnd(root,0));editor.selection.setRng(rng),dom.remove(tempElm),editor.selection.scrollIntoView(root)}},getEditableRoot=function(dom,node){var parent,editableRoot,root=dom.getRoot();for(parent=node;parent!==root&&"false"!==dom.getContentEditable(parent);)"true"===dom.getContentEditable(parent)&&(editableRoot=parent),parent=parent.parentNode;return parent!==root?editableRoot:root},getParentBlock$2=function(editor){return Option.from(editor.dom.getParent(editor.selection.getStart(!0),editor.dom.isBlock))},getParentBlockName=function(editor){return getParentBlock$2(editor).fold($_eqpqvr6jh8lyw3s.constant(""),function(parentBlock){return parentBlock.nodeName.toUpperCase()})},isListItemParentBlock=function(editor){return getParentBlock$2(editor).filter(function(elm){return isListItem($_cgttw3zjh8lywdq.fromDom(elm))}).isSome()},$_83wjn572jh8lyxlu={moveToCaretPosition:moveToCaretPosition,getEditableRoot:getEditableRoot,getParentBlock:getParentBlock$2,getParentBlockName:getParentBlockName,isListItemParentBlock:isListItemParentBlock},hasFirstChild=function(elm,name){return elm.firstChild&&elm.firstChild.nodeName===name},hasParent$1=function(elm,parentName){return elm&&elm.parentNode&&elm.parentNode.nodeName===parentName},isListBlock=function(elm){return elm&&/^(OL|UL|LI)$/.test(elm.nodeName)},isNestedList=function(elm){return isListBlock(elm)&&isListBlock(elm.parentNode)},getContainerBlock=function(containerBlock){var containerBlockParent=containerBlock.parentNode;return/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)?containerBlockParent:containerBlock},isFirstOrLastLi=function(containerBlock,parentBlock,first){for(var node=containerBlock[first?"firstChild":"lastChild"];node&&!$_5oonaz1qjh8lywhz.isElement(node);)node=node[first?"nextSibling":"previousSibling"];return node===parentBlock},insert$1=function(editor,createNewBlock,containerBlock,parentBlock,newBlockName){var dom=editor.dom,rng=editor.selection.getRng();if(containerBlock!==editor.getBody()){isNestedList(containerBlock)&&(newBlockName="LI");var newBlock=newBlockName?createNewBlock(newBlockName):dom.create("BR");if(isFirstOrLastLi(containerBlock,parentBlock,!0)&&isFirstOrLastLi(containerBlock,parentBlock,!1))hasParent$1(containerBlock,"LI")?dom.insertAfter(newBlock,getContainerBlock(containerBlock)):dom.replace(newBlock,containerBlock);else if(isFirstOrLastLi(containerBlock,parentBlock,!0))hasParent$1(containerBlock,"LI")?(dom.insertAfter(newBlock,getContainerBlock(containerBlock)),newBlock.appendChild(dom.doc.createTextNode(" ")),newBlock.appendChild(containerBlock)):containerBlock.parentNode.insertBefore(newBlock,containerBlock);else if(isFirstOrLastLi(containerBlock,parentBlock,!1))dom.insertAfter(newBlock,getContainerBlock(containerBlock));else{containerBlock=getContainerBlock(containerBlock);var tmpRng=rng.cloneRange();tmpRng.setStartAfter(parentBlock),tmpRng.setEndAfter(containerBlock);var fragment=tmpRng.extractContents();"LI"===newBlockName&&hasFirstChild(fragment,"LI")?(newBlock=fragment.firstChild,dom.insertAfter(fragment,containerBlock)):(dom.insertAfter(fragment,containerBlock),dom.insertAfter(newBlock,containerBlock))}dom.remove(parentBlock),$_83wjn572jh8lyxlu.moveToCaretPosition(editor,newBlock)}},$_5pzeb371jh8lyxlr={insert:insert$1},isEmptyAnchor=function(elm){return elm&&"A"===elm.nodeName&&0===$_ahowuxkjh8lywbj.trim($_d383mr21jh8lywlv.trim(elm.innerText||elm.textContent)).length},isTableCell$5=function(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName)},emptyBlock=function(elm){elm.innerHTML='<br data-mce-bogus="1">'},containerAndSiblingName=function(container,nodeName){return container.nodeName===nodeName||container.previousSibling&&container.previousSibling.nodeName===nodeName},canSplitBlock=function(dom,node){return node&&dom.isBlock(node)&&!/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName)&&!/^(fixed|absolute)/i.test(node.style.position)&&"true"!==dom.getContentEditable(node)},trimInlineElementsOnLeftSideOfBlock=function(dom,nonEmptyElementsMap,block){var i,node=block,firstChilds=[];if(node){for(;node=node.firstChild;){if(dom.isBlock(node))return;$_5oonaz1qjh8lywhz.isElement(node)&&!nonEmptyElementsMap[node.nodeName.toLowerCase()]&&firstChilds.push(node)}for(i=firstChilds.length;i--;)node=firstChilds[i],!node.hasChildNodes()||node.firstChild===node.lastChild&&""===node.firstChild.nodeValue?dom.remove(node):isEmptyAnchor(node)&&dom.remove(node)}},normalizeZwspOffset=function(start,container,offset){return $_5oonaz1qjh8lywhz.isText(container)===!1?offset:start?1===offset&&container.data.charAt(offset-1)===$_d383mr21jh8lywlv.ZWSP?0:offset:offset===container.data.length-1&&container.data.charAt(offset)===$_d383mr21jh8lywlv.ZWSP?container.data.length:offset},includeZwspInRange=function(rng){var newRng=rng.cloneRange();return newRng.setStart(rng.startContainer,normalizeZwspOffset(!0,rng.startContainer,rng.startOffset)),newRng.setEnd(rng.endContainer,normalizeZwspOffset(!1,rng.endContainer,rng.endOffset)),newRng},trimLeadingLineBreaks=function(node){do $_5oonaz1qjh8lywhz.isText(node)&&(node.nodeValue=node.nodeValue.replace(/^[\r\n]+/,"")),node=node.firstChild;while(node)},getEditableRoot$1=function(dom,node){var parent,editableRoot,root=dom.getRoot();for(parent=node;parent!==root&&"false"!==dom.getContentEditable(parent);)"true"===dom.getContentEditable(parent)&&(editableRoot=parent),parent=parent.parentNode;return parent!==root?editableRoot:root},setForcedBlockAttrs=function(editor,node){var forcedRootBlockName=$_66vr6g2jjh8lywpf.getForcedRootBlock(editor);forcedRootBlockName&&forcedRootBlockName.toLowerCase()===node.tagName.toLowerCase()&&editor.dom.setAttribs(node,$_66vr6g2jjh8lywpf.getForcedRootBlockAttrs(editor))},wrapSelfAndSiblingsInDefaultBlock=function(editor,newBlockName,rng,container,offset){var newBlock,parentBlock,startNode,node,next,rootBlockName,blockName=newBlockName||"P",dom=editor.dom,editableRoot=getEditableRoot$1(dom,container);if(parentBlock=dom.getParent(container,dom.isBlock),!parentBlock||!canSplitBlock(dom,parentBlock)){if(parentBlock=parentBlock||editableRoot,rootBlockName=parentBlock===editor.getBody()||isTableCell$5(parentBlock)?parentBlock.nodeName.toLowerCase():parentBlock.parentNode.nodeName.toLowerCase(),!parentBlock.hasChildNodes())return newBlock=dom.create(blockName),setForcedBlockAttrs(editor,newBlock),parentBlock.appendChild(newBlock),rng.setStart(newBlock,0),rng.setEnd(newBlock,0),newBlock;for(node=container;node.parentNode!==parentBlock;)node=node.parentNode;for(;node&&!dom.isBlock(node);)startNode=node,node=node.previousSibling;if(startNode&&editor.schema.isValidChild(rootBlockName,blockName.toLowerCase())){for(newBlock=dom.create(blockName),setForcedBlockAttrs(editor,newBlock),startNode.parentNode.insertBefore(newBlock,startNode),node=startNode;node&&!dom.isBlock(node);)next=node.nextSibling,newBlock.appendChild(node),node=next;rng.setStart(container,offset),rng.setEnd(container,offset)}}return container},addBrToBlockIfNeeded=function(dom,block){var lastChild;block.normalize(),lastChild=block.lastChild,lastChild&&!/^(left|right)$/gi.test(dom.getStyle(lastChild,"float",!0))||dom.add(block,"br")},insert$2=function(editor,evt){var tmpRng,editableRoot,container,offset,parentBlock,shiftKey,newBlock,fragment,containerBlock,parentBlockName,containerBlockName,newBlockName,isAfterLastNodeInContainer,dom=editor.dom,schema=editor.schema,nonEmptyElementsMap=schema.getNonEmptyElements(),rng=editor.selection.getRng(),createNewBlock=function(name){var block,clonedNode,caretNode,node=container,textInlineElements=schema.getTextInlineElements();if(name||"TABLE"===parentBlockName||"HR"===parentBlockName?(block=dom.create(name||newBlockName),setForcedBlockAttrs(editor,block)):block=parentBlock.cloneNode(!1),caretNode=block,$_66vr6g2jjh8lywpf.shouldKeepStyles(editor)===!1)dom.setAttrib(block,"style",null),dom.setAttrib(block,"class",null);else do if(textInlineElements[node.nodeName]){if(isCaretNode(node))continue;clonedNode=node.cloneNode(!1),dom.setAttrib(clonedNode,"id",""),block.hasChildNodes()?(clonedNode.appendChild(block.firstChild),block.appendChild(clonedNode)):(caretNode=clonedNode,block.appendChild(clonedNode))}while((node=node.parentNode)&&node!==editableRoot);return emptyBlock(caretNode),block},isCaretAtStartOrEndOfBlock=function(start){var walker,node,name,normalizedOffset;if(normalizedOffset=normalizeZwspOffset(start,container,offset),$_5oonaz1qjh8lywhz.isText(container)&&(start?normalizedOffset>0:normalizedOffset<container.nodeValue.length))return!1;if(container.parentNode===parentBlock&&isAfterLastNodeInContainer&&!start)return!0;if(start&&$_5oonaz1qjh8lywhz.isElement(container)&&container===parentBlock.firstChild)return!0;if(containerAndSiblingName(container,"TABLE")||containerAndSiblingName(container,"HR"))return isAfterLastNodeInContainer&&!start||!isAfterLastNodeInContainer&&start;for(walker=new TreeWalker(container,parentBlock),$_5oonaz1qjh8lywhz.isText(container)&&(start&&0===normalizedOffset?walker.prev():start||normalizedOffset!==container.nodeValue.length||walker.next());node=walker.current();){if($_5oonaz1qjh8lywhz.isElement(node)){if(!node.getAttribute("data-mce-bogus")&&(name=node.nodeName.toLowerCase(),nonEmptyElementsMap[name]&&"br"!==name))return!1}else if($_5oonaz1qjh8lywhz.isText(node)&&!/^[ \t\r\n]*$/.test(node.nodeValue))return!1;start?walker.prev():walker.next()}return!0},insertNewBlockAfter=function(){newBlock=/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName)&&"HGROUP"!==containerBlockName?createNewBlock(newBlockName):createNewBlock(),$_66vr6g2jjh8lywpf.shouldEndContainerOnEmptyBlock(editor)&&canSplitBlock(dom,containerBlock)&&dom.isEmpty(parentBlock)?newBlock=dom.split(containerBlock,parentBlock):dom.insertAfter(newBlock,parentBlock),$_83wjn572jh8lyxlu.moveToCaretPosition(editor,newBlock)};if($_4v2pn63yjh8lyx2s.normalize(dom,rng).each(function(normRng){rng.setStart(normRng.startContainer,normRng.startOffset),rng.setEnd(normRng.endContainer,normRng.endOffset)}),container=rng.startContainer,offset=rng.startOffset,newBlockName=$_66vr6g2jjh8lywpf.getForcedRootBlock(editor),shiftKey=evt.shiftKey,$_5oonaz1qjh8lywhz.isElement(container)&&container.hasChildNodes()&&(isAfterLastNodeInContainer=offset>container.childNodes.length-1,container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container,offset=isAfterLastNodeInContainer&&$_5oonaz1qjh8lywhz.isText(container)?container.nodeValue.length:0),editableRoot=getEditableRoot$1(dom,container))return(newBlockName&&!shiftKey||!newBlockName&&shiftKey)&&(container=wrapSelfAndSiblingsInDefaultBlock(editor,newBlockName,rng,container,offset)),parentBlock=dom.getParent(container,dom.isBlock),containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null,parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():"",containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"","LI"!==containerBlockName||evt.ctrlKey||(parentBlock=containerBlock,containerBlock=containerBlock.parentNode,parentBlockName=containerBlockName),/^(LI|DT|DD)$/.test(parentBlockName)&&dom.isEmpty(parentBlock)?void $_5pzeb371jh8lyxlr.insert(editor,createNewBlock,containerBlock,parentBlock,newBlockName):void(newBlockName&&parentBlock===editor.getBody()||(newBlockName=newBlockName||"P",isCaretContainerBlock(parentBlock)?(newBlock=showCaretContainerBlock(parentBlock),dom.isEmpty(parentBlock)&&emptyBlock(parentBlock),$_83wjn572jh8lyxlu.moveToCaretPosition(editor,newBlock)):isCaretAtStartOrEndOfBlock()?insertNewBlockAfter():isCaretAtStartOrEndOfBlock(!0)?(newBlock=parentBlock.parentNode.insertBefore(createNewBlock(),parentBlock),$_83wjn572jh8lyxlu.moveToCaretPosition(editor,containerAndSiblingName(parentBlock,"HR")?newBlock:parentBlock)):(tmpRng=includeZwspInRange(rng).cloneRange(),tmpRng.setEndAfter(parentBlock),fragment=tmpRng.extractContents(),trimLeadingLineBreaks(fragment),newBlock=fragment.firstChild,dom.insertAfter(fragment,parentBlock),trimInlineElementsOnLeftSideOfBlock(dom,nonEmptyElementsMap,newBlock),addBrToBlockIfNeeded(dom,parentBlock),dom.isEmpty(parentBlock)&&emptyBlock(parentBlock),newBlock.normalize(),dom.isEmpty(newBlock)?(dom.remove(newBlock),insertNewBlockAfter()):$_83wjn572jh8lyxlu.moveToCaretPosition(editor,newBlock)),dom.setAttrib(newBlock,"id",""),editor.fire("NewBlock",{newBlock:newBlock})))},$_apcs0t70jh8lyxlh={insert:insert$2},matchesSelector=function(editor,selector){return $_83wjn572jh8lyxlu.getParentBlock(editor).filter(function(parentBlock){return selector.length>0&&$_5h4ipt1fjh8lywgi.is($_cgttw3zjh8lywdq.fromDom(parentBlock),selector)}).isSome()},shouldInsertBr=function(editor){return matchesSelector(editor,$_66vr6g2jjh8lywpf.getBrNewLineSelector(editor))},shouldBlockNewLine=function(editor){return matchesSelector(editor,$_66vr6g2jjh8lywpf.getNoNewLineSelector(editor))},$_5mj33174jh8lyxm9={shouldInsertBr:shouldInsertBr,shouldBlockNewLine:shouldBlockNewLine},newLineAction=$_1ml90g3ijh8lywyp.generate([{br:[]},{block:[]},{none:[]}]),shouldBlockNewLine$1=function(editor,shiftKey){return $_5mj33174jh8lyxm9.shouldBlockNewLine(editor)},isBrMode=function(requiredState){return function(editor,shiftKey){var brMode=""===$_66vr6g2jjh8lywpf.getForcedRootBlock(editor);return brMode===requiredState}},inListBlock=function(requiredState){return function(editor,shiftKey){return $_83wjn572jh8lyxlu.isListItemParentBlock(editor)===requiredState}},inBlock=function(blockName,requiredState){return function(editor,shiftKey){var state=$_83wjn572jh8lyxlu.getParentBlockName(editor)===blockName.toUpperCase();return state===requiredState}},inPreBlock=function(requiredState){return inBlock("pre",requiredState)},inSummaryBlock=function(){return inBlock("summary",!0)},shouldPutBrInPre$1=function(requiredState){return function(editor,shiftKey){return $_66vr6g2jjh8lywpf.shouldPutBrInPre(editor)===requiredState}},inBrContext=function(editor,shiftKey){return $_5mj33174jh8lyxm9.shouldInsertBr(editor)},hasShiftKey=function(editor,shiftKey){return shiftKey},canInsertIntoEditableRoot=function(editor){var forcedRootBlock=$_66vr6g2jjh8lywpf.getForcedRootBlock(editor),rootEditable=$_83wjn572jh8lyxlu.getEditableRoot(editor.dom,editor.selection.getStart());return rootEditable&&editor.schema.isValidChild(rootEditable.nodeName,forcedRootBlock?forcedRootBlock:"P")},match$2=function(predicates,action){return function(editor,shiftKey){var isMatch=$_5wjzy24jh8lyw2t.foldl(predicates,function(res,p){return res&&p(editor,shiftKey)},!0);return isMatch?Option.some(action):Option.none()}},getAction$1=function(editor,evt){return $_7r5om73ojh8lyx09.evaluateUntil([match$2([shouldBlockNewLine$1],newLineAction.none()),match$2([inSummaryBlock()],newLineAction.br()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!1),hasShiftKey],newLineAction.br()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!1)],newLineAction.block()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!0),hasShiftKey],newLineAction.block()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!0)],newLineAction.br()),match$2([inListBlock(!0),hasShiftKey],newLineAction.br()),match$2([inListBlock(!0)],newLineAction.block()),match$2([isBrMode(!0),hasShiftKey,canInsertIntoEditableRoot],newLineAction.block()),match$2([isBrMode(!0)],newLineAction.br()),match$2([inBrContext],newLineAction.br()),match$2([isBrMode(!1),hasShiftKey],newLineAction.br()),match$2([canInsertIntoEditableRoot],newLineAction.block())],[editor,evt.shiftKey]).getOr(newLineAction.none())},$_efe7kj73jh8lyxm2={getAction:getAction$1},insert$3=function(editor,evt){$_efe7kj73jh8lyxm2.getAction(editor,evt).fold(function(){$_cg4dz53xjh8lyx2g.insert(editor,evt)},function(){$_apcs0t70jh8lyxlh.insert(editor,evt)},$_eqpqvr6jh8lyw3s.noop)},$_5e167p6zjh8lyxlc={insert:insert$3},endTypingLevel=function(undoManager){undoManager.typing&&(undoManager.typing=!1,undoManager.add())},handleEnterKeyEvent=function(editor,event){event.isDefaultPrevented()||(event.preventDefault(),endTypingLevel(editor.undoManager),editor.undoManager.transact(function(){editor.selection.isCollapsed()===!1&&editor.execCommand("Delete"),$_5e167p6zjh8lyxlc.insert(editor,event)}))},setup$7=function(editor){editor.on("keydown",function(event){event.keyCode===$_6lsk4i5gjh8lyxau.ENTER&&handleEnterKeyEvent(editor,event)})},$_5ff4w26yjh8lyxl3={setup:setup$7},isValidInsertPoint=function(location,caretPosition){return isAtStartOrEnd(location)&&$_5oonaz1qjh8lywhz.isText(caretPosition.container())},insertNbspAtPosition=function(editor,caretPosition){var container=caretPosition.container(),offset=caretPosition.offset();container.insertData(offset," "),editor.selection.setCursorLocation(container,offset+1)},insertAtLocation=function(editor,caretPosition,location){return!!isValidInsertPoint(location,caretPosition)&&(insertNbspAtPosition(editor,caretPosition),!0)},insertAtCaret$2=function(editor){var isInlineTarget=$_eqpqvr6jh8lyw3s.curry($_231v7s37jh8lywt3.isInlineTarget,editor),caretPosition=CaretPosition$1.fromRangeStart(editor.selection.getRng()),boundaryLocation=$_6kjy7r3njh8lywzz.readLocation(isInlineTarget,editor.getBody(),caretPosition);return boundaryLocation.map($_eqpqvr6jh8lyw3s.curry(insertAtLocation,editor,caretPosition)).getOr(!1)},isAtStartOrEnd=function(location){return location.fold($_eqpqvr6jh8lyw3s.constant(!1),$_eqpqvr6jh8lyw3s.constant(!0),$_eqpqvr6jh8lyw3s.constant(!0),$_eqpqvr6jh8lyw3s.constant(!1))},insertAtSelection=function(editor){return!!editor.selection.isCollapsed()&&insertAtCaret$2(editor)},$_aptbve76jh8lyxme={insertAtSelection:insertAtSelection},executeKeydownOverride$2=function(editor,evt){$_8um8ta6vjh8lyxko.execute([{keyCode:$_6lsk4i5gjh8lyxau.SPACEBAR,action:$_8um8ta6vjh8lyxko.action($_aptbve76jh8lyxme.insertAtSelection,editor)}],evt).each(function(_){evt.preventDefault()})},setup$8=function(editor){editor.on("keydown",function(evt){evt.isDefaultPrevented()===!1&&executeKeydownOverride$2(editor,evt)})},$_50nb7z75jh8lyxmd={setup:setup$8},findBlockCaretContainer=function(editor){return $_7sg18r3cjh8lywu1.descendant($_cgttw3zjh8lywdq.fromDom(editor.getBody()),"*[data-mce-caret]").fold($_eqpqvr6jh8lyw3s.constant(null),function(elm){return elm.dom()})},removeIeControlRect=function(editor){editor.selection.setRng(editor.selection.getRng())},showBlockCaretContainer=function(editor,blockCaretContainer){blockCaretContainer.hasAttribute("data-mce-caret")&&(showCaretContainerBlock(blockCaretContainer),removeIeControlRect(editor),editor.selection.scrollIntoView(blockCaretContainer))},handleBlockContainer=function(editor,e){var blockCaretContainer=findBlockCaretContainer(editor);if(blockCaretContainer)return"compositionstart"===e.type?(e.preventDefault(),e.stopPropagation(),void showBlockCaretContainer(editor,blockCaretContainer)):void(hasContent(blockCaretContainer)&&(showBlockCaretContainer(editor,blockCaretContainer),editor.undoManager.add()))},setup$9=function(editor){editor.on("keyup compositionstart",$_eqpqvr6jh8lyw3s.curry(handleBlockContainer,editor))},$_98x1lt77jh8lyxmi={setup:setup$9},setup$10=function(editor){var caret=$_65xx7w3pjh8lyx0d.setupSelectedState(editor);$_98x1lt77jh8lyxmi.setup(editor),$_8m3to56tjh8lyxkd.setup(editor,caret),$_4ow4756wjh8lyxkt.setup(editor,caret),$_5ff4w26yjh8lyxl3.setup(editor),$_50nb7z75jh8lyxmd.setup(editor)},$_btkj596sjh8lyxkc={setup:setup$10},isTextBlockNode=function(node){return $_5oonaz1qjh8lywhz.isElement(node)&&isTextBlock($_cgttw3zjh8lywdq.fromDom(node))},normalizeSelection$1=function(editor){var rng=editor.selection.getRng(),startPos=CaretPosition.fromRangeStart(rng),endPos=CaretPosition.fromRangeEnd(rng);if(CaretPosition.isElementPosition(startPos)){var container=startPos.container();isTextBlockNode(container)&&$_9kvypj2cjh8lywnz.firstPositionIn(container).each(function(pos){return rng.setStart(pos.container(),pos.offset())})}if(CaretPosition.isElementPosition(endPos)){var container=startPos.container();isTextBlockNode(container)&&$_9kvypj2cjh8lywnz.lastPositionIn(container).each(function(pos){return rng.setEnd(pos.container(),pos.offset())})}editor.selection.setRng($_cnbluh30jh8lywrn.normalize(rng))},setup$11=function(editor){editor.on("click",function(e){3===e.detail&&normalizeSelection$1(editor)})},$_1nhbc479jh8lyxn0={setup:setup$11},preventSummaryToggle=function(editor){editor.on("click",function(e){editor.dom.getParent(e.target,"details")&&e.preventDefault()})},filterDetails=function(editor){editor.parser.addNodeFilter("details",function(elms){$_5wjzy24jh8lyw2t.each(elms,function(details){details.attr("data-mce-open",details.attr("open")),details.attr("open","open")})}),editor.serializer.addNodeFilter("details",function(elms){$_5wjzy24jh8lyw2t.each(elms,function(details){var open=details.attr("data-mce-open");details.attr("open",$_dp4g6d7jh8lyw3y.isString(open)?open:null),details.attr("data-mce-open",null)})})},setup$12=function(editor){preventSummaryToggle(editor),filterDetails(editor)},DOM$2=DOMUtils$1.DOM,appendStyle=function(editor,text){var head=$_cgttw3zjh8lywdq.fromDom(editor.getDoc().head),tag=$_cgttw3zjh8lywdq.fromTag("style");$_3da62i14jh8lyweo.set(tag,"type","text/css"),$_4m7u2e2kjh8lywpi.append(tag,$_cgttw3zjh8lywdq.fromText(text)),$_4m7u2e2kjh8lywpi.append(head,tag)},createParser=function(editor){var parser=DomParser(editor.settings,editor.schema);return parser.addAttributeFilter("src,href,style,tabindex",function(nodes,name){for(var node,value,internalName,i=nodes.length,dom=editor.dom;i--;)if(node=nodes[i],value=node.attr(name),internalName="data-mce-"+name,!node.attributes.map[internalName]){if(0===value.indexOf("data:")||0===value.indexOf("blob:"))continue;"style"===name?(value=dom.serializeStyle(dom.parseStyle(value),node.name),value.length||(value=null),node.attr(internalName,value),node.attr(name,value)):"tabindex"===name?(node.attr(internalName,value),node.attr(name,null)):node.attr(internalName,editor.convertURL(value,name,node.name))}}),parser.addNodeFilter("script",function(nodes){for(var node,type,i=nodes.length;i--;)node=nodes[i],type=node.attr("type")||"no/type",0!==type.indexOf("mce-")&&node.attr("type","mce-"+type)}),parser.addNodeFilter("#cdata",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],node.type=8,node.name="#comment",node.value="[CDATA["+node.value+"]]"}),parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(nodes){for(var node,i=nodes.length,nonEmptyElements=editor.schema.getNonEmptyElements();i--;)node=nodes[i],node.isEmpty(nonEmptyElements)&&0===node.getAll("br").length&&(node.append(new Node$2("br",1)).shortEnded=!0)}),parser},autoFocus=function(editor){editor.settings.auto_focus&&$_8sy3pfhjh8lyw95.setEditorTimeout(editor,function(){var focusEditor;focusEditor=editor.settings.auto_focus===!0?editor:editor.editorManager.get(editor.settings.auto_focus),focusEditor.destroyed||focusEditor.focus()},100)},initEditor=function(editor){editor.bindPendingEventDelegates(),editor.initialized=!0,editor.fire("init"),editor.focus(!0),editor.nodeChanged({initial:!0}),editor.execCallback("init_instance_callback",editor),autoFocus(editor)},getStyleSheetLoader=function(editor){return editor.inline?DOM$2.styleSheetLoader:editor.dom.styleSheetLoader},initContentBody=function(editor,skipWrite){var body,contentCssText,settings=editor.settings,targetElm=editor.getElement(),doc=editor.getDoc();settings.inline||(editor.getElement().style.visibility=editor.orgVisibility),skipWrite||settings.content_editable||(doc.open(),doc.write(editor.iframeHTML),doc.close()),settings.content_editable&&(editor.on("remove",function(){var bodyEl=this.getBody();DOM$2.removeClass(bodyEl,"mce-content-body"),DOM$2.removeClass(bodyEl,"mce-edit-focus"),DOM$2.setAttrib(bodyEl,"contentEditable",null)}),DOM$2.addClass(targetElm,"mce-content-body"),editor.contentDocument=doc=settings.content_document||document,editor.contentWindow=settings.content_window||window,editor.bodyElement=targetElm,settings.content_document=settings.content_window=null,settings.root_name=targetElm.nodeName.toLowerCase()),body=editor.getBody(),body.disabled=!0,editor.readonly=settings.readonly,editor.readonly||(editor.inline&&"static"===DOM$2.getStyle(body,"position",!0)&&(body.style.position="relative"),body.contentEditable=editor.getParam("content_editable_state",!0)),body.disabled=!1,editor.editorUpload=EditorUpload(editor),editor.schema=Schema(settings),editor.dom=DOMUtils$1(doc,{keep_values:!0,url_converter:editor.convertURL,url_converter_scope:editor,hex_colors:settings.force_hex_style_colors,class_filter:settings.class_filter,update_styles:!0,root_element:editor.inline?editor.getBody():null,collect:settings.content_editable,schema:editor.schema,onSetAttrib:function(e){editor.fire("SetAttrib",e)}}),editor.parser=createParser(editor),editor.serializer=DomSerializer$1(settings,editor),editor.selection=Selection$1(editor.dom,editor.getWin(),editor.serializer,editor),editor.formatter=Formatter(editor),editor.undoManager=UndoManager(editor),editor._nodeChangeDispatcher=new NodeChange(editor),editor._selectionOverrides=SelectionOverrides(editor),setup$12(editor),$_1nhbc479jh8lyxn0.setup(editor),$_btkj596sjh8lyxkc.setup(editor),$_85z7kh54jh8lyx8j.setup(editor),editor.fire("PreInit"),settings.browser_spellcheck||settings.gecko_spellcheck||(doc.body.spellcheck=!1,DOM$2.setAttrib(body,"spellcheck","false")),editor.quirks=Quirks(editor),editor.fire("PostRender"),settings.directionality&&(body.dir=settings.directionality),settings.nowrap&&(body.style.whiteSpace="nowrap"),settings.protect&&editor.on("BeforeSetContent",function(e){$_ahowuxkjh8lywbj.each(settings.protect,function(pattern){e.content=e.content.replace(pattern,function(str){return"<!--mce:protected "+escape(str)+"-->"})})}),editor.on("SetContent",function(){editor.addVisual(editor.getBody())}),editor.load({initial:!0,format:"html"}),editor.startContent=editor.getContent({format:"raw"}),editor.on("compositionstart compositionend",function(e){editor.composing="compositionstart"===e.type}),editor.contentStyles.length>0&&(contentCssText="",$_ahowuxkjh8lywbj.each(editor.contentStyles,function(style){contentCssText+=style+"\r\n"}),editor.dom.addStyle(contentCssText)),getStyleSheetLoader(editor).loadAll(editor.contentCSS,function(_){initEditor(editor)},function(urls){initEditor(editor)}),settings.content_style&&appendStyle(editor,settings.content_style)},$_g84rjb4rjh8lyx6v={initContentBody:initContentBody},DOM$3=DOMUtils$1.DOM,relaxDomain=function(editor,ifr){if(document.domain!==window.location.hostname&&$_9bpim8ajh8lyw68.ie&&$_9bpim8ajh8lyw68.ie<12){var bodyUuid=$_co2y7g52jh8lyx8f.uuid("mce");editor[bodyUuid]=function(){$_g84rjb4rjh8lyx6v.initContentBody(editor)};var domainRelaxUrl='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+editor.id+'");document.write(ed.iframeHTML);document.close();ed.'+bodyUuid+"(true);})()";return DOM$3.setAttrib(ifr,"src",domainRelaxUrl),!0}return!1},normalizeHeight=function(height){var normalizedHeight="number"==typeof height?height+"px":height;return normalizedHeight?normalizedHeight:""},createIframeElement=function(id,title,height,customAttrs){var iframe=$_cgttw3zjh8lywdq.fromTag("iframe");return $_3da62i14jh8lyweo.setAll(iframe,customAttrs),$_3da62i14jh8lyweo.setAll(iframe,{id:id+"_ifr",frameBorder:"0",allowTransparency:"true",title:title}),$_36knnd12jh8lywe1.setAll(iframe,{width:"100%",height:normalizeHeight(height),display:"block"}),iframe},getIframeHtml=function(editor){var bodyId,bodyClass,iframeHTML;return iframeHTML=$_66vr6g2jjh8lywpf.getDocType(editor)+"<html><head>",$_66vr6g2jjh8lywpf.getDocumentBaseUrl(editor)!==editor.documentBaseUrl&&(iframeHTML+='<base href="'+editor.documentBaseURI.getURI()+'" />'),iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',bodyId=$_66vr6g2jjh8lywpf.getBodyId(editor),bodyClass=$_66vr6g2jjh8lywpf.getBodyClass(editor),$_66vr6g2jjh8lywpf.getContentSecurityPolicy(editor)&&(iframeHTML+='<meta http-equiv="Content-Security-Policy" content="'+$_66vr6g2jjh8lywpf.getContentSecurityPolicy(editor)+'" />'),iframeHTML+='</head><body id="'+bodyId+'" class="mce-content-body '+bodyClass+'" data-id="'+editor.id+'"><br></body></html>'},createIframe=function(editor,o){var title=editor.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"),ifr=createIframeElement(editor.id,title,o.height,$_66vr6g2jjh8lywpf.getIframeAttrs(editor)).dom();ifr.onload=function(){ifr.onload=null,editor.fire("load")};var isDomainRelaxed=relaxDomain(editor,ifr);return editor.contentAreaContainer=o.iframeContainer,editor.iframeElement=ifr,editor.iframeHTML=getIframeHtml(editor),DOM$3.add(o.iframeContainer,ifr),isDomainRelaxed},init$1=function(editor,boxInfo){var isDomainRelaxed=createIframe(editor,boxInfo);boxInfo.editorContainer&&(DOM$3.get(boxInfo.editorContainer).style.display=editor.orgDisplay,editor.hidden=DOM$3.isHidden(boxInfo.editorContainer)),
editor.getElement().style.display="none",DOM$3.setAttrib(editor.id,"aria-hidden","true"),isDomainRelaxed||$_g84rjb4rjh8lyx6v.initContentBody(editor)},$_9i7a4m7bjh8lyxnf={init:init$1},DOM$4=DOMUtils$1.DOM,initPlugin=function(editor,initializedPlugins,plugin){var pluginUrl,pluginInstance,Plugin=PluginManager$1.get(plugin);if(pluginUrl=PluginManager$1.urls[plugin]||editor.documentBaseUrl.replace(/\/$/,""),plugin=$_ahowuxkjh8lywbj.trim(plugin),Plugin&&$_ahowuxkjh8lywbj.inArray(initializedPlugins,plugin)===-1){if($_ahowuxkjh8lywbj.each(PluginManager$1.dependencies(plugin),function(dep){initPlugin(editor,initializedPlugins,dep)}),editor.plugins[plugin])return;pluginInstance=new Plugin(editor,pluginUrl,editor.$),editor.plugins[plugin]=pluginInstance,pluginInstance.init&&(pluginInstance.init(editor,pluginUrl),initializedPlugins.push(plugin))}},trimLegacyPrefix=function(name){return name.replace(/^\-/,"")},initPlugins=function(editor){var initializedPlugins=[];$_ahowuxkjh8lywbj.each(editor.settings.plugins.split(/[ ,]/),function(name){initPlugin(editor,initializedPlugins,trimLegacyPrefix(name))})},initTheme=function(editor){var Theme,theme=editor.settings.theme;$_dp4g6d7jh8lyw3y.isString(theme)?(editor.settings.theme=trimLegacyPrefix(theme),Theme=ThemeManager.get(theme),editor.theme=new Theme(editor,ThemeManager.urls[theme]),editor.theme.init&&editor.theme.init(editor,ThemeManager.urls[theme]||editor.documentBaseUrl.replace(/\/$/,""),editor.$)):editor.theme={}},renderFromLoadedTheme=function(editor){var w,h,minHeight,re,info,settings=editor.settings,elm=editor.getElement();return w=settings.width||DOM$4.getStyle(elm,"width")||"100%",h=settings.height||DOM$4.getStyle(elm,"height")||elm.offsetHeight,minHeight=settings.min_height||100,re=/^[0-9\.]+(|px)$/i,re.test(""+w)&&(w=Math.max(parseInt(w,10),100)),re.test(""+h)&&(h=Math.max(parseInt(h,10),minHeight)),info=editor.theme.renderUI({targetNode:elm,width:w,height:h,deltaWidth:settings.delta_width,deltaHeight:settings.delta_height}),settings.content_editable||(h=(info.iframeHeight||h)+("number"==typeof h?info.deltaHeight||0:""),h<minHeight&&(h=minHeight)),info.height=h,info},renderFromThemeFunc=function(editor){var info,elm=editor.getElement();return info=editor.settings.theme(editor,elm),info.editorContainer.nodeType&&(info.editorContainer.id=info.editorContainer.id||editor.id+"_parent"),info.iframeContainer&&info.iframeContainer.nodeType&&(info.iframeContainer.id=info.iframeContainer.id||editor.id+"_iframecontainer"),info.height=info.iframeHeight?info.iframeHeight:elm.offsetHeight,info},createThemeFalseResult=function(element){return{editorContainer:element,iframeContainer:element}},renderThemeFalseIframe=function(targetElement){var iframeContainer=DOM$4.create("div");return DOM$4.insertAfter(iframeContainer,targetElement),createThemeFalseResult(iframeContainer)},renderThemeFalse=function(editor){var targetElement=editor.getElement();return editor.inline?createThemeFalseResult(null):renderThemeFalseIframe(targetElement)},renderThemeUi=function(editor){var settings=editor.settings,elm=editor.getElement();return editor.orgDisplay=elm.style.display,$_dp4g6d7jh8lyw3y.isString(settings.theme)?renderFromLoadedTheme(editor):$_dp4g6d7jh8lyw3y.isFunction(settings.theme)?renderFromThemeFunc(editor):renderThemeFalse(editor)},init$2=function(editor){var boxInfo,settings=editor.settings,elm=editor.getElement();return editor.rtl=settings.rtl_ui||editor.editorManager.i18n.rtl,editor.editorManager.i18n.setCode(settings.language),settings.aria_label=settings.aria_label||DOM$4.getAttrib(elm,"aria-label",editor.getLang("aria.rich_text_area")),editor.fire("ScriptsLoaded"),initTheme(editor),initPlugins(editor),boxInfo=renderThemeUi(editor),editor.editorContainer=boxInfo.editorContainer?boxInfo.editorContainer:null,settings.content_css&&$_ahowuxkjh8lywbj.each($_ahowuxkjh8lywbj.explode(settings.content_css),function(u){editor.contentCSS.push(editor.documentBaseURI.toAbsolute(u))}),settings.content_editable?$_g84rjb4rjh8lyx6v.initContentBody(editor):$_9i7a4m7bjh8lyxnf.init(editor,boxInfo)},$_bynk2f4ojh8lyx6l={init:init$2},DOM$5=DOMUtils$1.DOM,hasSkipLoadPrefix=function(name){return"-"===name.charAt(0)},loadLanguage=function(scriptLoader,editor){var settings=editor.settings;settings.language&&"en"!==settings.language&&!settings.language_url&&(settings.language_url=editor.editorManager.baseURL+"/langs/"+settings.language+".js"),settings.language_url&&!editor.editorManager.i18n.data[settings.language]&&scriptLoader.add(settings.language_url)},loadTheme=function(scriptLoader,editor,suffix,callback){var settings=editor.settings,theme=settings.theme;if($_dp4g6d7jh8lyw3y.isString(theme)){if(!hasSkipLoadPrefix(theme)&&!ThemeManager.urls.hasOwnProperty(theme)){var themeUrl=settings.theme_url;themeUrl?ThemeManager.load(theme,editor.documentBaseURI.toAbsolute(themeUrl)):ThemeManager.load(theme,"themes/"+theme+"/theme"+suffix+".js")}scriptLoader.loadQueue(function(){ThemeManager.waitFor(theme,callback)})}else callback()},loadPlugins=function(settings,suffix){$_ahowuxkjh8lywbj.isArray(settings.plugins)&&(settings.plugins=settings.plugins.join(" ")),$_ahowuxkjh8lywbj.each(settings.external_plugins,function(url,name){PluginManager$1.load(name,url),settings.plugins+=" "+name}),$_ahowuxkjh8lywbj.each(settings.plugins.split(/[ ,]/),function(plugin){if(plugin=$_ahowuxkjh8lywbj.trim(plugin),plugin&&!PluginManager$1.urls[plugin])if(hasSkipLoadPrefix(plugin)){plugin=plugin.substr(1,plugin.length);var dependencies=PluginManager$1.dependencies(plugin);$_ahowuxkjh8lywbj.each(dependencies,function(dep){var defaultSettings={prefix:"plugins/",resource:dep,suffix:"/plugin"+suffix+".js"};dep=PluginManager$1.createUrl(defaultSettings,dep),PluginManager$1.load(dep.resource,dep)})}else PluginManager$1.load(plugin,{prefix:"plugins/",resource:plugin,suffix:"/plugin"+suffix+".js"})})},loadScripts=function(editor,suffix){var scriptLoader=ScriptLoader.ScriptLoader;loadTheme(scriptLoader,editor,suffix,function(){loadLanguage(scriptLoader,editor),loadPlugins(editor.settings,suffix),scriptLoader.loadQueue(function(){editor.removed||$_bynk2f4ojh8lyx6l.init(editor)},editor,function(urls){$_5vy074njh8lyx6h.pluginLoadError(editor,urls[0]),editor.removed||$_bynk2f4ojh8lyx6l.init(editor)})})},render=function(editor){var settings=editor.settings,id=editor.id,readyHandler=function(){DOM$5.unbind(window,"ready",readyHandler),editor.render()};if(!EventUtils.Event.domLoaded)return void DOM$5.bind(window,"ready",readyHandler);if(editor.getElement()&&$_9bpim8ajh8lyw68.contentEditable){settings.inline?editor.inline=!0:(editor.orgVisibility=editor.getElement().style.visibility,editor.getElement().style.visibility="hidden");var form=editor.getElement().form||DOM$5.getParent(id,"form");form&&(editor.formElement=form,settings.hidden_input&&!/TEXTAREA|INPUT/i.test(editor.getElement().nodeName)&&(DOM$5.insertAfter(DOM$5.create("input",{type:"hidden",name:id}),id),editor.hasHiddenInput=!0),editor.formEventDelegate=function(e){editor.fire(e.type,e)},DOM$5.bind(form,"submit reset",editor.formEventDelegate),editor.on("reset",function(){editor.setContent(editor.startContent,{format:"raw"})}),!settings.submit_patch||form.submit.nodeType||form.submit.length||form._mceOldSubmit||(form._mceOldSubmit=form.submit,form.submit=function(){return editor.editorManager.triggerSave(),editor.setDirty(!1),form._mceOldSubmit(form)})),editor.windowManager=WindowManager(editor),editor.notificationManager=NotificationManager(editor),"xml"===settings.encoding&&editor.on("GetContent",function(e){e.save&&(e.content=DOM$5.encode(e.content))}),settings.add_form_submit_trigger&&editor.on("submit",function(){editor.initialized&&editor.save()}),settings.add_unload_trigger&&(editor._beforeUnload=function(){!editor.initialized||editor.destroyed||editor.isHidden()||editor.save({format:"raw",no_events:!0,set_dirty:!1})},editor.editorManager.on("BeforeUnload",editor._beforeUnload)),editor.editorManager.add(editor),loadScripts(editor,editor.suffix)}},$_64g0n44hjh8lyx5e={render:render},add$3=function(editor,name,settings){var sidebars=editor.sidebars?editor.sidebars:[];sidebars.push({name:name,settings:settings}),editor.sidebars=sidebars},$_67cz5d7cjh8lyxnm={add:add$3},each$20=$_ahowuxkjh8lywbj.each,trim$4=$_ahowuxkjh8lywbj.trim,queryParts="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),DEFAULT_PORTS={ftp:21,http:80,https:443,mailto:25},URI=function(url,settings){var baseUri,baseUrl,self=this;if(url=trim$4(url),settings=self.settings=settings||{},baseUri=settings.base_uri,/^([\w\-]+):([^\/]{2})/i.test(url)||/^\s*#/.test(url))return void(self.source=url);var isProtocolRelative=0===url.indexOf("//");0!==url.indexOf("/")||isProtocolRelative||(url=(baseUri?baseUri.protocol||"http":"http")+"://mce_host"+url),/^[\w\-]*:?\/\//.test(url)||(baseUrl=settings.base_uri?settings.base_uri.path:new URI(document.location.href).directory,""==settings.base_uri.protocol?url="//mce_host"+self.toAbsPath(baseUrl,url):(url=/([^#?]*)([#?]?.*)/.exec(url),url=(baseUri&&baseUri.protocol||"http")+"://mce_host"+self.toAbsPath(baseUrl,url[1])+url[2])),url=url.replace(/@@/g,"(mce_at)"),url=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(url),each$20(queryParts,function(v,i){var part=url[i];part&&(part=part.replace(/\(mce_at\)/g,"@@")),self[v]=part}),baseUri&&(self.protocol||(self.protocol=baseUri.protocol),self.userInfo||(self.userInfo=baseUri.userInfo),self.port||"mce_host"!==self.host||(self.port=baseUri.port),self.host&&"mce_host"!==self.host||(self.host=baseUri.host),self.source=""),isProtocolRelative&&(self.protocol="")};URI.prototype={setPath:function(path){var self=this;path=/^(.*?)\/?(\w+)?$/.exec(path),self.path=path[0],self.directory=path[1],self.file=path[2],self.source="",self.getURI()},toRelative:function(uri){var output,self=this;if("./"===uri)return uri;if(uri=new URI(uri,{base_uri:self}),"mce_host"!==uri.host&&self.host!==uri.host&&uri.host||self.port!==uri.port||self.protocol!==uri.protocol&&""!==uri.protocol)return uri.getURI();var tu=self.getURI(),uu=uri.getURI();return tu===uu||"/"===tu.charAt(tu.length-1)&&tu.substr(0,tu.length-1)===uu?tu:(output=self.toRelPath(self.path,uri.path),uri.query&&(output+="?"+uri.query),uri.anchor&&(output+="#"+uri.anchor),output)},toAbsolute:function(uri,noHost){return uri=new URI(uri,{base_uri:this}),uri.getURI(noHost&&this.isSameOrigin(uri))},isSameOrigin:function(uri){if(this.host==uri.host&&this.protocol==uri.protocol){if(this.port==uri.port)return!0;var defaultPort=DEFAULT_PORTS[this.protocol];if(defaultPort&&(this.port||defaultPort)==(uri.port||defaultPort))return!0}return!1},toRelPath:function(base,path){var items,i,l,breakPoint=0,out="";if(base=base.substring(0,base.lastIndexOf("/")),base=base.split("/"),items=path.split("/"),base.length>=items.length)for(i=0,l=base.length;i<l;i++)if(i>=items.length||base[i]!==items[i]){breakPoint=i+1;break}if(base.length<items.length)for(i=0,l=items.length;i<l;i++)if(i>=base.length||base[i]!==items[i]){breakPoint=i+1;break}if(1===breakPoint)return path;for(i=0,l=base.length-(breakPoint-1);i<l;i++)out+="../";for(i=breakPoint-1,l=items.length;i<l;i++)out+=i!==breakPoint-1?"/"+items[i]:items[i];return out},toAbsPath:function(base,path){var i,tr,outPath,nb=0,o=[];for(tr=/\/$/.test(path)?"/":"",base=base.split("/"),path=path.split("/"),each$20(base,function(k){k&&o.push(k)}),base=o,i=path.length-1,o=[];i>=0;i--)0!==path[i].length&&"."!==path[i]&&(".."!==path[i]?nb>0?nb--:o.push(path[i]):nb++);return i=base.length-nb,outPath=i<=0?o.reverse().join("/"):base.slice(0,i).join("/")+"/"+o.reverse().join("/"),0!==outPath.indexOf("/")&&(outPath="/"+outPath),tr&&outPath.lastIndexOf("/")!==outPath.length-1&&(outPath+=tr),outPath},getURI:function(noProtoHost){var s,self=this;return self.source&&!noProtoHost||(s="",noProtoHost||(s+=self.protocol?self.protocol+"://":"//",self.userInfo&&(s+=self.userInfo+"@"),self.host&&(s+=self.host),self.port&&(s+=":"+self.port)),self.path&&(s+=self.path),self.query&&(s+="?"+self.query),self.anchor&&(s+="#"+self.anchor),self.source=s),self.source}},URI.parseDataUri=function(uri){var type,matches;return uri=decodeURIComponent(uri).split(","),matches=/data:([^;]+)/.exec(uri[0]),matches&&(type=matches[1]),{type:type,data:uri[1]}},URI.getDocumentBaseUrl=function(loc){var baseUrl;return baseUrl=0!==loc.protocol.indexOf("http")&&"file:"!==loc.protocol?loc.href:loc.protocol+"//"+loc.host+loc.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(baseUrl)&&(baseUrl=baseUrl.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(baseUrl)||(baseUrl+="/")),baseUrl};var defaultFormat="html",trimEmptyContents=function(editor,html){var blockName=$_66vr6g2jjh8lywpf.getForcedRootBlock(editor),emptyRegExp=new RegExp("^(<"+blockName+"[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/"+blockName+">[\r\n]*|<br \\/>[\r\n]*)$");return html.replace(emptyRegExp,"")},getContentFromBody=function(editor,args,body){var content;if(args.format=args.format?args.format:defaultFormat,args.get=!0,args.getInner=!0,args.no_events||editor.fire("BeforeGetContent",args),"raw"===args.format)content=$_ahowuxkjh8lywbj.trim($_8lol015jjh8lyxbf.trimExternal(editor.serializer,body.innerHTML));else if("text"===args.format)content=$_d383mr21jh8lywlv.trim(body.innerText||body.textContent);else{if("tree"===args.format)return editor.serializer.serialize(body,args);content=trimEmptyContents(editor,editor.serializer.serialize(body,args))}return"text"===args.format||isWsPreserveElement($_cgttw3zjh8lywdq.fromDom(body))?args.content=content:args.content=$_ahowuxkjh8lywbj.trim(content),args.no_events||editor.fire("GetContent",args),args.content},getContent$1=function(editor,args){return void 0===args&&(args={}),Option.from(editor.getBody()).fold($_eqpqvr6jh8lyw3s.constant("tree"===args.format?new Node$2("body",11):""),function(body){return getContentFromBody(editor,args,body)})},traverse=function(node,fn){fn(node),node.firstChild&&traverse(node.firstChild,fn),node.next&&traverse(node.next,fn)},findMatchingNodes=function(nodeFilters,attributeFilters,node){var nodeMatches={},attrMatches={},matches=[];node.firstChild&&traverse(node.firstChild,function(node){$_5wjzy24jh8lyw2t.each(nodeFilters,function(filter){filter.name===node.name&&(nodeMatches[filter.name]?nodeMatches[filter.name].nodes.push(node):nodeMatches[filter.name]={filter:filter,nodes:[node]})}),$_5wjzy24jh8lyw2t.each(attributeFilters,function(filter){"string"==typeof node.attr(filter.name)&&(attrMatches[filter.name]?attrMatches[filter.name].nodes.push(node):attrMatches[filter.name]={filter:filter,nodes:[node]})})});for(var name_1 in nodeMatches)nodeMatches.hasOwnProperty(name_1)&&matches.push(nodeMatches[name_1]);for(var name_2 in attrMatches)attrMatches.hasOwnProperty(name_2)&&matches.push(attrMatches[name_2]);return matches},filter$3=function(nodeFilters,attributeFilters,node){var matches=findMatchingNodes(nodeFilters,attributeFilters,node);$_5wjzy24jh8lyw2t.each(matches,function(match){$_5wjzy24jh8lyw2t.each(match.filter.callbacks,function(callback){callback(match.nodes,match.filter.name,{})})})},defaultFormat$1="html",isTreeNode=function(content){return content instanceof Node$2},moveSelection=function(editor){$_cnu79r4ejh8lyx4x.hasFocus(editor)&&$_9kvypj2cjh8lywnz.firstPositionIn(editor.getBody()).each(function(pos){var node=pos.getNode(),caretPos=$_5oonaz1qjh8lywhz.isTable(node)?$_9kvypj2cjh8lywnz.firstPositionIn(node).getOr(pos):pos;editor.selection.setRng(caretPos.toRange())})},setEditorHtml=function(editor,html){editor.dom.setHTML(editor.getBody(),html),moveSelection(editor)},setContentString=function(editor,body,content,args){var forcedRootBlockName,padd;return 0===content.length||/^\s+$/.test(content)?(padd='<br data-mce-bogus="1">',"TABLE"===body.nodeName?content="<tr><td>"+padd+"</td></tr>":/^(UL|OL)$/.test(body.nodeName)&&(content="<li>"+padd+"</li>"),forcedRootBlockName=$_66vr6g2jjh8lywpf.getForcedRootBlock(editor),forcedRootBlockName&&editor.schema.isValidChild(body.nodeName.toLowerCase(),forcedRootBlockName.toLowerCase())?(content=padd,content=editor.dom.createHTML(forcedRootBlockName,editor.settings.forced_root_block_attrs,content)):content||(content='<br data-mce-bogus="1">'),setEditorHtml(editor,content),editor.fire("SetContent",args)):("raw"!==args.format&&(content=HtmlSerializer({validate:editor.validate},editor.schema).serialize(editor.parser.parse(content,{isRootContent:!0,insert:!0}))),args.content=isWsPreserveElement($_cgttw3zjh8lywdq.fromDom(body))?content:$_ahowuxkjh8lywbj.trim(content),setEditorHtml(editor,args.content),args.no_events||editor.fire("SetContent",args)),args.content},setContentTree=function(editor,body,content,args){filter$3(editor.parser.getNodeFilters(),editor.parser.getAttributeFilters(),content);var html=HtmlSerializer({validate:editor.validate},editor.schema).serialize(content);return args.content=isWsPreserveElement($_cgttw3zjh8lywdq.fromDom(body))?html:$_ahowuxkjh8lywbj.trim(html),setEditorHtml(editor,args.content),args.no_events||editor.fire("SetContent",args),content},setContent$1=function(editor,content,args){return void 0===args&&(args={}),args.format=args.format?args.format:defaultFormat$1,args.set=!0,args.content=isTreeNode(content)?"":content,isTreeNode(content)||args.no_events||(editor.fire("BeforeSetContent",args),content=args.content),Option.from(editor.getBody()).fold($_eqpqvr6jh8lyw3s.constant(content),function(body){return isTreeNode(content)?setContentTree(editor,body,content,args):setContentString(editor,body,content,args)})},DOM$6=DOMUtils$1.DOM,restoreOriginalStyles=function(editor){DOM$6.setStyle(editor.id,"display",editor.orgDisplay)},safeDestroy=function(x){return Option.from(x).each(function(x){return x.destroy()})},clearDomReferences=function(editor){editor.contentAreaContainer=editor.formElement=editor.container=editor.editorContainer=null,editor.bodyElement=editor.contentDocument=editor.contentWindow=null,editor.iframeElement=editor.targetElm=null,editor.selection&&(editor.selection=editor.selection.win=editor.selection.dom=editor.selection.dom.doc=null)},restoreForm=function(editor){var form=editor.formElement;form&&(form._mceOldSubmit&&(form.submit=form._mceOldSubmit,form._mceOldSubmit=null),DOM$6.unbind(form,"submit reset",editor.formEventDelegate))},remove$8=function(editor){if(!editor.removed){var _selectionOverrides=editor._selectionOverrides,editorUpload=editor.editorUpload,body=editor.getBody(),element=editor.getElement();body&&editor.save(),editor.removed=!0,editor.unbindAllNativeEvents(),editor.hasHiddenInput&&element&&DOM$6.remove(element.nextSibling),!editor.inline&&body&&restoreOriginalStyles(editor),$_a4fgrn4cjh8lyx4q.fireRemove(editor),editor.editorManager.remove(editor),DOM$6.remove(editor.getContainer()),safeDestroy(_selectionOverrides),safeDestroy(editorUpload),editor.destroy()}},destroy=function(editor,automatic){var selection=editor.selection,dom=editor.dom;if(!editor.destroyed){if(!automatic&&!editor.removed)return void editor.remove();automatic||(editor.editorManager.off("beforeunload",editor._beforeUnload),editor.theme&&editor.theme.destroy&&editor.theme.destroy(),safeDestroy(selection),safeDestroy(dom)),restoreForm(editor),clearDomReferences(editor),editor.destroyed=!0}},DOM$7=DOMUtils$1.DOM,extend$4=$_ahowuxkjh8lywbj.extend,each$21=$_ahowuxkjh8lywbj.each,resolve$4=$_ahowuxkjh8lywbj.resolve,ie$2=$_9bpim8ajh8lyw68.ie,Editor=function(id,settings,editorManager){var self=this,documentBaseUrl=self.documentBaseUrl=editorManager.documentBaseURL,baseUri=editorManager.baseURI;settings=getEditorSettings(self,id,documentBaseUrl,editorManager.defaultSettings,settings),self.settings=settings,AddOnManager.language=settings.language||"en",AddOnManager.languageLoad=settings.language_load,AddOnManager.baseURL=editorManager.baseURL,self.id=id,self.setDirty(!1),self.plugins={},self.documentBaseURI=new URI(settings.document_base_url,{base_uri:baseUri}),self.baseURI=baseUri,self.contentCSS=[],self.contentStyles=[],self.shortcuts=new Shortcuts(self),self.loadedCSS={},self.editorCommands=new EditorCommands(self),self.suffix=editorManager.suffix,self.editorManager=editorManager,self.inline=settings.inline,self.buttons={},self.menuItems={},settings.cache_suffix&&($_9bpim8ajh8lyw68.cacheSuffix=settings.cache_suffix.replace(/^[\?\&]+/,"")),settings.override_viewport===!1&&($_9bpim8ajh8lyw68.overrideViewPort=!1),editorManager.fire("SetupEditor",{editor:self}),self.execCallback("setup",self),self.$=DomQuery.overrideDefaults(function(){return{context:self.inline?self.getBody():self.getDoc(),element:self.getBody()}})};Editor.prototype={render:function(){$_64g0n44hjh8lyx5e.render(this)},focus:function(skipFocus){$_cnu79r4ejh8lyx4x.focus(this,skipFocus)},hasFocus:function(){return $_cnu79r4ejh8lyx4x.hasFocus(this)},execCallback:function(name){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];var scope,self=this,callback=self.settings[name];if(callback)return self.callbackLookup&&(scope=self.callbackLookup[name])&&(callback=scope.func,scope=scope.scope),"string"==typeof callback&&(scope=callback.replace(/\.\w+$/,""),scope=scope?resolve$4(scope):0,callback=resolve$4(callback),self.callbackLookup=self.callbackLookup||{},self.callbackLookup[name]={func:callback,scope:scope}),callback.apply(scope||self,Array.prototype.slice.call(arguments,1))},translate:function(text){if(text&&$_ahowuxkjh8lywbj.is(text,"string")){var lang_1=this.settings.language||"en",i18n_1=this.editorManager.i18n;text=i18n_1.data[lang_1+"."+text]||text.replace(/\{\#([^\}]+)\}/g,function(a,b){return i18n_1.data[lang_1+"."+b]||"{#"+b+"}"})}return this.editorManager.translate(text)},getLang:function(name,defaultVal){return this.editorManager.i18n.data[(this.settings.language||"en")+"."+name]||(void 0!==defaultVal?defaultVal:"{#"+name+"}")},getParam:function(name,defaultVal,type){return getParam(this,name,defaultVal,type)},nodeChanged:function(args){this._nodeChangeDispatcher.nodeChanged(args)},addButton:function(name,settings){var self=this;settings.cmd&&(settings.onclick=function(){self.execCommand(settings.cmd)}),settings.stateSelector&&"undefined"==typeof settings.active&&(settings.active=!1),settings.text||settings.icon||(settings.icon=name),self.buttons=self.buttons,settings.tooltip=settings.tooltip||settings.title,self.buttons[name]=settings},addSidebar:function(name,settings){return $_67cz5d7cjh8lyxnm.add(this,name,settings)},addMenuItem:function(name,settings){var self=this;settings.cmd&&(settings.onclick=function(){self.execCommand(settings.cmd)}),self.menuItems=self.menuItems,self.menuItems[name]=settings},addContextToolbar:function(predicate,items){var selector,self=this;self.contextToolbars=self.contextToolbars||[],"string"==typeof predicate&&(selector=predicate,predicate=function(elm){return self.dom.is(elm,selector)}),self.contextToolbars.push({id:$_co2y7g52jh8lyx8f.uuid("mcet"),predicate:predicate,items:items})},addCommand:function(name,callback,scope){this.editorCommands.addCommand(name,callback,scope)},addQueryStateHandler:function(name,callback,scope){this.editorCommands.addQueryStateHandler(name,callback,scope)},addQueryValueHandler:function(name,callback,scope){this.editorCommands.addQueryValueHandler(name,callback,scope)},addShortcut:function(pattern,desc,cmdFunc,scope){this.shortcuts.add(pattern,desc,cmdFunc,scope)},execCommand:function(cmd,ui,value,args){return this.editorCommands.execCommand(cmd,ui,value,args)},queryCommandState:function(cmd){return this.editorCommands.queryCommandState(cmd)},queryCommandValue:function(cmd){return this.editorCommands.queryCommandValue(cmd)},queryCommandSupported:function(cmd){return this.editorCommands.queryCommandSupported(cmd)},show:function(){var self=this;self.hidden&&(self.hidden=!1,self.inline?self.getBody().contentEditable=!0:(DOM$7.show(self.getContainer()),DOM$7.hide(self.id)),self.load(),self.fire("show"))},hide:function(){var self=this,doc=self.getDoc();self.hidden||(ie$2&&doc&&!self.inline&&doc.execCommand("SelectAll"),self.save(),self.inline?(self.getBody().contentEditable=!1,self===self.editorManager.focusedEditor&&(self.editorManager.focusedEditor=null)):(DOM$7.hide(self.getContainer()),DOM$7.setStyle(self.id,"display",self.orgDisplay)),self.hidden=!0,self.fire("hide"))},isHidden:function(){return!!this.hidden},setProgressState:function(state,time){this.fire("ProgressState",{state:state,time:time})},load:function(args){var html,self=this,elm=self.getElement();return self.removed?"":elm?(args=args||{},args.load=!0,html=self.setContent(void 0!==elm.value?elm.value:elm.innerHTML,args),args.element=elm,args.no_events||self.fire("LoadContent",args),args.element=elm=null,html):void 0},save:function(args){var html,form,self=this,elm=self.getElement();if(elm&&self.initialized&&!self.removed)return args=args||{},args.save=!0,args.element=elm,html=args.content=self.getContent(args),args.no_events||self.fire("SaveContent",args),"raw"===args.format&&self.fire("RawSaveContent",args),html=args.content,/TEXTAREA|INPUT/i.test(elm.nodeName)?elm.value=html:(self.inline||(elm.innerHTML=html),(form=DOM$7.getParent(self.id,"form"))&&each$21(form.elements,function(elm){if(elm.name===self.id)return elm.value=html,!1})),args.element=elm=null,args.set_dirty!==!1&&self.setDirty(!1),html},setContent:function(content,args){return setContent$1(this,content,args)},getContent:function(args){return getContent$1(this,args)},insertContent:function(content,args){args&&(content=extend$4({content:content},args)),this.execCommand("mceInsertContent",!1,content)},isDirty:function(){return!this.isNotDirty},setDirty:function(state){var oldState=!this.isNotDirty;this.isNotDirty=!state,state&&state!==oldState&&this.fire("dirty")},setMode:function(mode){setMode(this,mode)},getContainer:function(){var self=this;return self.container||(self.container=DOM$7.get(self.editorContainer||self.id+"_parent")),self.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return this.targetElm||(this.targetElm=DOM$7.get(this.id)),this.targetElm},getWin:function(){var elm,self=this;return self.contentWindow||(elm=self.iframeElement,elm&&(self.contentWindow=elm.contentWindow)),self.contentWindow},getDoc:function(){var win,self=this;return self.contentDocument||(win=self.getWin(),win&&(self.contentDocument=win.document)),self.contentDocument},getBody:function(){var doc=this.getDoc();return this.bodyElement||(doc?doc.body:null)},convertURL:function(url,name,elm){var self=this,settings=self.settings;return settings.urlconverter_callback?self.execCallback("urlconverter_callback",url,elm,!0,name):!settings.convert_urls||elm&&"LINK"===elm.nodeName||0===url.indexOf("file:")||0===url.length?url:settings.relative_urls?self.documentBaseURI.toRelative(url):url=self.documentBaseURI.toAbsolute(url,settings.remove_script_host)},addVisual:function(elm){var cls,self=this,settings=self.settings,dom=self.dom;elm=elm||self.getBody(),void 0===self.hasVisual&&(self.hasVisual=settings.visual),each$21(dom.select("table,a",elm),function(elm){var value;switch(elm.nodeName){case"TABLE":return cls=settings.visual_table_class||"mce-item-table",value=dom.getAttrib(elm,"border"),void(value&&"0"!==value||!self.hasVisual?dom.removeClass(elm,cls):dom.addClass(elm,cls));case"A":return void(dom.getAttrib(elm,"href")||(value=dom.getAttrib(elm,"name")||elm.id,cls=settings.visual_anchor_class||"mce-item-anchor",value&&self.hasVisual?dom.addClass(elm,cls):dom.removeClass(elm,cls)))}}),self.fire("VisualAid",{element:elm,hasVisual:self.hasVisual})},remove:function(){remove$8(this)},destroy:function(automatic){destroy(this,automatic)},uploadImages:function(callback){return this.editorUpload.uploadImages(callback)},_scanForImages:function(){return this.editorUpload.scanForImages()}},extend$4(Editor.prototype,EditorObservable$1);var documentFocusInHandler,beforeUnloadDelegate,EditorManager,isEditorUIElement=function(elm){return elm.className.toString().indexOf("mce-")!==-1},$_bmt26v7ljh8lyxp9={isEditorUIElement:isEditorUIElement},isManualNodeChange=function(e){return"nodechange"===e.type&&e.selectionChange},registerPageMouseUp=function(editor,throttledStore){var mouseUpPage=function(){throttledStore.throttle()};DOMUtils$1.DOM.bind(document,"mouseup",mouseUpPage),editor.on("remove",function(){DOMUtils$1.DOM.unbind(document,"mouseup",mouseUpPage)})},registerFocusOut=function(editor){editor.on("focusout",function(){$_eqs11m40jh8lyx31.store(editor)})},registerMouseUp=function(editor,throttledStore){editor.on("mouseup touchend",function(e){throttledStore.throttle()})},registerEditorEvents=function(editor,throttledStore){var browser=$_9hkktfnjh8lywc6.detect().browser;browser.isIE()?registerFocusOut(editor):registerMouseUp(editor,throttledStore),editor.on("keyup nodechange",function(e){isManualNodeChange(e)||$_eqs11m40jh8lyx31.store(editor)})},register$3=function(editor){var throttledStore=$_de600j5fjh8lyxas.first(function(){$_eqs11m40jh8lyx31.store(editor)},0);editor.inline&&registerPageMouseUp(editor,throttledStore),editor.on("init",function(){registerEditorEvents(editor,throttledStore)}),editor.on("remove",function(){throttledStore.cancel()})},$_2mabdn7mjh8lyxpa={register:register$3},DOM$8=DOMUtils$1.DOM,isEditorUIElement$1=function(elm){return $_bmt26v7ljh8lyxp9.isEditorUIElement(elm)},isUIElement=function(editor,elm){var customSelector=editor?editor.settings.custom_ui_selector:"",parent=DOM$8.getParent(elm,function(elm){return isEditorUIElement$1(elm)||!!customSelector&&editor.dom.is(elm,customSelector)});return null!==parent},getActiveElement=function(){try{return document.activeElement}catch(ex){return document.body}},registerEvents=function(editorManager,e){var editor=e.editor;$_2mabdn7mjh8lyxpa.register(editor),editor.on("focusin",function(){var self=this,focusedEditor=editorManager.focusedEditor;focusedEditor!==self&&(focusedEditor&&focusedEditor.fire("blur",{focusedEditor:self}),editorManager.setActive(self),editorManager.focusedEditor=self,self.fire("focus",{blurredEditor:focusedEditor}),self.focus(!0))}),editor.on("focusout",function(){var self=this;$_8sy3pfhjh8lyw95.setEditorTimeout(self,function(){var focusedEditor=editorManager.focusedEditor;isUIElement(self,getActiveElement())||focusedEditor!==self||(self.fire("blur",{focusedEditor:null}),editorManager.focusedEditor=null)})}),documentFocusInHandler||(documentFocusInHandler=function(e){var target,activeEditor=editorManager.activeEditor;target=e.target,activeEditor&&target.ownerDocument===document&&(target===document.body||isUIElement(activeEditor,target)||editorManager.focusedEditor!==activeEditor||(activeEditor.fire("blur",{focusedEditor:null}),editorManager.focusedEditor=null))},DOM$8.bind(document,"focusin",documentFocusInHandler))},unregisterDocumentEvents=function(editorManager,e){editorManager.focusedEditor===e.editor&&(editorManager.focusedEditor=null),editorManager.activeEditor||(DOM$8.unbind(document,"focusin",documentFocusInHandler),documentFocusInHandler=null)},setup$13=function(editorManager){editorManager.on("AddEditor",$_eqpqvr6jh8lyw3s.curry(registerEvents,editorManager)),editorManager.on("RemoveEditor",$_eqpqvr6jh8lyw3s.curry(unregisterDocumentEvents,editorManager))},$_k2ieq7kjh8lyxp5={setup:setup$13,isEditorUIElement:isEditorUIElement$1,isUIElement:isUIElement},data={},code="en",$_1tjgyr7njh8lyxpg={setCode:function(newCode){newCode&&(code=newCode,this.rtl=!!this.data[newCode]&&"rtl"===this.data[newCode]._dir)},getCode:function(){return code},rtl:!1,add:function(code,items){var langData=data[code];langData||(data[code]=langData={});for(var name_1 in items)langData[name_1]=items[name_1];this.setCode(code)},translate:function(text){var langData=data[code]||{},toString=function(obj){return $_ahowuxkjh8lywbj.is(obj,"function")?Object.prototype.toString.call(obj):isEmpty(obj)?"":""+obj;
},isEmpty=function(text){return""===text||null===text||$_ahowuxkjh8lywbj.is(text,"undefined")},getLangData=function(text){return text=toString(text),$_ahowuxkjh8lywbj.hasOwn(langData,text)?toString(langData[text]):text};if(isEmpty(text))return"";if($_ahowuxkjh8lywbj.is(text,"object")&&$_ahowuxkjh8lywbj.hasOwn(text,"raw"))return toString(text.raw);if($_ahowuxkjh8lywbj.is(text,"array")){var values_1=text.slice(1);text=getLangData(text[0]).replace(/\{([0-9]+)\}/g,function($1,$2){return $_ahowuxkjh8lywbj.hasOwn(values_1,$2)?toString(values_1[$2]):$1})}return getLangData(text).replace(/{context:\w+}$/,"")},data:data},DOM$9=DOMUtils$1.DOM,explode$4=$_ahowuxkjh8lywbj.explode,each$22=$_ahowuxkjh8lywbj.each,extend$5=$_ahowuxkjh8lywbj.extend,instanceCounter=0,boundGlobalEvents=!1,legacyEditors=[],editors=[],isValidLegacyKey=function(id){return"length"!==id},globalEventDelegate=function(e){each$22(EditorManager.get(),function(editor){"scroll"===e.type?editor.fire("ScrollWindow",e):editor.fire("ResizeWindow",e)})},toggleGlobalEvents=function(state){state!==boundGlobalEvents&&(state?DomQuery(window).on("resize scroll",globalEventDelegate):DomQuery(window).off("resize scroll",globalEventDelegate),boundGlobalEvents=state)},removeEditorFromList=function(targetEditor){var oldEditors=editors;delete legacyEditors[targetEditor.id];for(var i=0;i<legacyEditors.length;i++)if(legacyEditors[i]===targetEditor){legacyEditors.splice(i,1);break}return editors=$_5wjzy24jh8lyw2t.filter(editors,function(editor){return targetEditor!==editor}),EditorManager.activeEditor===targetEditor&&(EditorManager.activeEditor=editors.length>0?editors[0]:null),EditorManager.focusedEditor===targetEditor&&(EditorManager.focusedEditor=null),oldEditors.length!==editors.length},purgeDestroyedEditor=function(editor){return editor&&editor.initialized&&!(editor.getContainer()||editor.getBody()).parentNode&&(removeEditorFromList(editor),editor.unbindAllNativeEvents(),editor.destroy(!0),editor.removed=!0,editor=null),editor};EditorManager={defaultSettings:{},$:DomQuery,majorVersion:"4",minorVersion:"7.13",releaseDate:"2018-05-16",editors:legacyEditors,i18n:$_1tjgyr7njh8lyxpg,activeEditor:null,settings:{},setup:function(){var baseURL,documentBaseURL,preInit,src,self=this,suffix="";if(documentBaseURL=URI.getDocumentBaseUrl(document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(documentBaseURL)&&(documentBaseURL=documentBaseURL.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(documentBaseURL)||(documentBaseURL+="/")),preInit=window.tinymce||window.tinyMCEPreInit)baseURL=preInit.base||preInit.baseURL,suffix=preInit.suffix;else{for(var scripts=document.getElementsByTagName("script"),i=0;i<scripts.length;i++){src=scripts[i].src;var srcScript=src.substring(src.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(src)){srcScript.indexOf(".min")!==-1&&(suffix=".min"),baseURL=src.substring(0,src.lastIndexOf("/"));break}}!baseURL&&document.currentScript&&(src=document.currentScript.src,src.indexOf(".min")!==-1&&(suffix=".min"),baseURL=src.substring(0,src.lastIndexOf("/")))}self.baseURL=new URI(documentBaseURL).toAbsolute(baseURL),self.documentBaseURL=documentBaseURL,self.baseURI=new URI(self.baseURL),self.suffix=suffix,$_k2ieq7kjh8lyxp5.setup(self)},overrideDefaults:function(defaultSettings){var baseUrl,suffix;baseUrl=defaultSettings.base_url,baseUrl&&(this.baseURL=new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\/+$/,"")),this.baseURI=new URI(this.baseURL)),suffix=defaultSettings.suffix,defaultSettings.suffix&&(this.suffix=suffix),this.defaultSettings=defaultSettings;var pluginBaseUrls=defaultSettings.plugin_base_urls;for(var name_1 in pluginBaseUrls)AddOnManager.PluginManager.urls[name_1]=pluginBaseUrls[name_1]},init:function(settings){var result,invalidInlineTargets,self=this;invalidInlineTargets=$_ahowuxkjh8lywbj.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option tbody tfoot thead tr script noscript style textarea video audio iframe object menu"," ");var isInvalidInlineTarget=function(settings,elm){return settings.inline&&elm.tagName.toLowerCase()in invalidInlineTargets},createId=function(elm){var id=elm.id;return id||(id=elm.name,id=id&&!DOM$9.get(id)?elm.name:DOM$9.uniqueId(),elm.setAttribute("id",id)),id},execCallback=function(name){var callback=settings[name];if(callback)return callback.apply(self,Array.prototype.slice.call(arguments,2))},hasClass=function(elm,className){return className.constructor===RegExp?className.test(elm.className):DOM$9.hasClass(elm,className)},findTargets=function(settings){var l,targets=[];if($_9bpim8ajh8lyw68.ie&&$_9bpim8ajh8lyw68.ie<11)return $_5vy074njh8lyx6h.initError("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(settings.types)return each$22(settings.types,function(type){targets=targets.concat(DOM$9.select(type.selector))}),targets;if(settings.selector)return DOM$9.select(settings.selector);if(settings.target)return[settings.target];switch(settings.mode){case"exact":l=settings.elements||"",l.length>0&&each$22(explode$4(l),function(id){var elm;(elm=DOM$9.get(id))?targets.push(elm):each$22(document.forms,function(f){each$22(f.elements,function(e){e.name===id&&(id="mce_editor_"+instanceCounter++,DOM$9.setAttrib(e,"id",id),targets.push(e))})})});break;case"textareas":case"specific_textareas":each$22(DOM$9.select("textarea"),function(elm){settings.editor_deselector&&hasClass(elm,settings.editor_deselector)||settings.editor_selector&&!hasClass(elm,settings.editor_selector)||targets.push(elm)})}return targets},provideResults=function(editors){result=editors},initEditors=function(){var targets,initCount=0,editors=[],createEditor=function(id,settings,targetElm){var editor=new Editor(id,settings,self);editors.push(editor),editor.on("init",function(){++initCount===targets.length&&provideResults(editors)}),editor.targetElm=editor.targetElm||targetElm,editor.render()};return DOM$9.unbind(window,"ready",initEditors),execCallback("onpageload"),targets=DomQuery.unique(findTargets(settings)),settings.types?void each$22(settings.types,function(type){$_ahowuxkjh8lywbj.each(targets,function(elm){return!DOM$9.is(elm,type.selector)||(createEditor(createId(elm),extend$5({},settings,type),elm),!1)})}):($_ahowuxkjh8lywbj.each(targets,function(elm){purgeDestroyedEditor(self.get(elm.id))}),targets=$_ahowuxkjh8lywbj.grep(targets,function(elm){return!self.get(elm.id)}),void(0===targets.length?provideResults([]):each$22(targets,function(elm){isInvalidInlineTarget(settings,elm)?$_5vy074njh8lyx6h.initError("Could not initialize inline editor on invalid inline target element",elm):createEditor(createId(elm),settings,elm)})))};return self.settings=settings,DOM$9.bind(window,"ready",initEditors),new promiseObj(function(resolve){result?resolve(result):provideResults=function(editors){resolve(editors)}})},get:function(id){return 0===arguments.length?editors.slice(0):$_dp4g6d7jh8lyw3y.isString(id)?$_5wjzy24jh8lyw2t.find(editors,function(editor){return editor.id===id}).getOr(null):$_dp4g6d7jh8lyw3y.isNumber(id)&&editors[id]?editors[id]:null},add:function(editor){var existingEditor,self=this;return existingEditor=legacyEditors[editor.id],existingEditor===editor?editor:(null===self.get(editor.id)&&(isValidLegacyKey(editor.id)&&(legacyEditors[editor.id]=editor),legacyEditors.push(editor),editors.push(editor)),toggleGlobalEvents(!0),self.activeEditor=editor,self.fire("AddEditor",{editor:editor}),beforeUnloadDelegate||(beforeUnloadDelegate=function(){self.fire("BeforeUnload")},DOM$9.bind(window,"beforeunload",beforeUnloadDelegate)),editor)},createEditor:function(id,settings){return this.add(new Editor(id,settings,this))},remove:function(selector){var i,editor,self=this;if(selector)return $_dp4g6d7jh8lyw3y.isString(selector)?(selector=selector.selector||selector,void each$22(DOM$9.select(selector),function(elm){editor=self.get(elm.id),editor&&self.remove(editor)})):(editor=selector,$_dp4g6d7jh8lyw3y.isNull(self.get(editor.id))?null:(removeEditorFromList(editor)&&self.fire("RemoveEditor",{editor:editor}),0===editors.length&&DOM$9.unbind(window,"beforeunload",beforeUnloadDelegate),editor.remove(),toggleGlobalEvents(editors.length>0),editor));for(i=editors.length-1;i>=0;i--)self.remove(editors[i])},execCommand:function(cmd,ui,value){var self=this,editor=self.get(value);switch(cmd){case"mceAddEditor":return self.get(value)||new Editor(value,self.settings,self).render(),!0;case"mceRemoveEditor":return editor&&editor.remove(),!0;case"mceToggleEditor":return editor?(editor.isHidden()?editor.show():editor.hide(),!0):(self.execCommand("mceAddEditor",0,value),!0)}return!!self.activeEditor&&self.activeEditor.execCommand(cmd,ui,value)},triggerSave:function(){each$22(editors,function(editor){editor.save()})},addI18n:function(code,items){$_1tjgyr7njh8lyxpg.add(code,items)},translate:function(text){return $_1tjgyr7njh8lyxpg.translate(text)},setActive:function(editor){var activeEditor=this.activeEditor;this.activeEditor!==editor&&(activeEditor&&activeEditor.fire("deactivate",{relatedTarget:editor}),editor.fire("activate",{relatedTarget:activeEditor})),this.activeEditor=editor}},extend$5(EditorManager,$_fuzxjg45jh8lyx45),EditorManager.setup();var EditorManager$1=EditorManager;!function(RangeUtils){RangeUtils.compareRanges=$_aayq8q3zjh8lyx2z.isEq,RangeUtils.getCaretRangeFromPoint=$_ct0ht56jjh8lyxif.fromPoint,RangeUtils.getSelectedNode=getSelectedNode,RangeUtils.getNode=getNode}(RangeUtils||(RangeUtils={}));var extendClass,initializing,RangeUtils$1=RangeUtils,min=Math.min,max=Math.max,round$2=Math.round,relativePosition=function(rect,targetRect,rel){var x,y,w,h,targetW,targetH;return x=targetRect.x,y=targetRect.y,w=rect.w,h=rect.h,targetW=targetRect.w,targetH=targetRect.h,rel=(rel||"").split(""),"b"===rel[0]&&(y+=targetH),"r"===rel[1]&&(x+=targetW),"c"===rel[0]&&(y+=round$2(targetH/2)),"c"===rel[1]&&(x+=round$2(targetW/2)),"b"===rel[3]&&(y-=h),"r"===rel[4]&&(x-=w),"c"===rel[3]&&(y-=round$2(h/2)),"c"===rel[4]&&(x-=round$2(w/2)),create$2(x,y,w,h)},findBestRelativePosition=function(rect,targetRect,constrainRect,rels){var pos,i;for(i=0;i<rels.length;i++)if(pos=relativePosition(rect,targetRect,rels[i]),pos.x>=constrainRect.x&&pos.x+pos.w<=constrainRect.w+constrainRect.x&&pos.y>=constrainRect.y&&pos.y+pos.h<=constrainRect.h+constrainRect.y)return rels[i];return null},inflate=function(rect,w,h){return create$2(rect.x-w,rect.y-h,rect.w+2*w,rect.h+2*h)},intersect=function(rect,cropRect){var x1,y1,x2,y2;return x1=max(rect.x,cropRect.x),y1=max(rect.y,cropRect.y),x2=min(rect.x+rect.w,cropRect.x+cropRect.w),y2=min(rect.y+rect.h,cropRect.y+cropRect.h),x2-x1<0||y2-y1<0?null:create$2(x1,y1,x2-x1,y2-y1)},clamp$1=function(rect,clampRect,fixedSize){var underflowX1,underflowY1,overflowX2,overflowY2,x1,y1,x2,y2,cx2,cy2;return x1=rect.x,y1=rect.y,x2=rect.x+rect.w,y2=rect.y+rect.h,cx2=clampRect.x+clampRect.w,cy2=clampRect.y+clampRect.h,underflowX1=max(0,clampRect.x-x1),underflowY1=max(0,clampRect.y-y1),overflowX2=max(0,x2-cx2),overflowY2=max(0,y2-cy2),x1+=underflowX1,y1+=underflowY1,fixedSize&&(x2+=underflowX1,y2+=underflowY1,x1-=overflowX2,y1-=overflowY2),x2-=overflowX2,y2-=overflowY2,create$2(x1,y1,x2-x1,y2-y1)},create$2=function(x,y,w,h){return{x:x,y:y,w:w,h:h}},fromClientRect=function(clientRect){return create$2(clientRect.left,clientRect.top,clientRect.width,clientRect.height)},$_fa0t9p7pjh8lyxpo={inflate:inflate,relativePosition:relativePosition,findBestRelativePosition:findBestRelativePosition,intersect:intersect,clamp:clamp$1,create:create$2,fromClientRect:fromClientRect},types={},$_fym6l27qjh8lyxpr={add:function(type,typeClass){types[type.toLowerCase()]=typeClass},has:function(type){return!!types[type.toLowerCase()]},get:function(type){var lctype=type.toLowerCase(),controlType=types.hasOwnProperty(lctype)?types[lctype]:null;if(null===controlType)throw new Error("Could not find module for type: "+type);return controlType},create:function(type,settings){var ControlType;if("string"==typeof type?(settings=settings||{},settings.type=type):(settings=type,type=settings.type),type=type.toLowerCase(),ControlType=types[type],!ControlType)throw new Error("Could not find control by type: "+type);return ControlType=new ControlType(settings),ControlType.type=type,ControlType}},each$23=$_ahowuxkjh8lywbj.each,extend$6=$_ahowuxkjh8lywbj.extend,Class$1=function(){};Class$1.extend=extendClass=function(prop){var prototype,name,member,self=this,_super=self.prototype,Class=function(){var i,mixins,mixin,self=this;if(!initializing&&(self.init&&self.init.apply(self,arguments),mixins=self.Mixins))for(i=mixins.length;i--;)mixin=mixins[i],mixin.init&&mixin.init.apply(self,arguments)},dummy=function(){return this},createMethod=function(name,fn){return function(){var ret,self=this,tmp=self._super;return self._super=_super[name],ret=fn.apply(self,arguments),self._super=tmp,ret}};initializing=!0,prototype=new self,initializing=!1,prop.Mixins&&(each$23(prop.Mixins,function(mixin){for(var name_1 in mixin)"init"!==name_1&&(prop[name_1]=mixin[name_1])}),_super.Mixins&&(prop.Mixins=_super.Mixins.concat(prop.Mixins))),prop.Methods&&each$23(prop.Methods.split(","),function(name){prop[name]=dummy}),prop.Properties&&each$23(prop.Properties.split(","),function(name){var fieldName="_"+name;prop[name]=function(value){var self=this;return void 0!==value?(self[fieldName]=value,self):self[fieldName]}}),prop.Statics&&each$23(prop.Statics,function(func,name){Class[name]=func}),prop.Defaults&&_super.Defaults&&(prop.Defaults=extend$6({},_super.Defaults,prop.Defaults));for(name in prop)member=prop[name],"function"==typeof member&&_super[name]?prototype[name]=createMethod(name,member):prototype[name]=member;return Class.prototype=prototype,Class.constructor=Class,Class.extend=extendClass,Class};var min$1=Math.min,max$1=Math.max,round$3=Math.round,Color=function(value){var self={},r=0,g=0,b=0,rgb2hsv=function(r,g,b){var h,s,v,d,minRGB,maxRGB;return h=0,s=0,v=0,r/=255,g/=255,b/=255,minRGB=min$1(r,min$1(g,b)),maxRGB=max$1(r,max$1(g,b)),minRGB===maxRGB?(v=minRGB,{h:0,s:0,v:100*v}):(d=r===minRGB?g-b:b===minRGB?r-g:b-r,h=r===minRGB?3:b===minRGB?1:5,h=60*(h-d/(maxRGB-minRGB)),s=(maxRGB-minRGB)/maxRGB,v=maxRGB,{h:round$3(h),s:round$3(100*s),v:round$3(100*v)})},hsvToRgb=function(hue,saturation,brightness){var side,chroma,x,match;if(hue=(parseInt(hue,10)||0)%360,saturation=parseInt(saturation,10)/100,brightness=parseInt(brightness,10)/100,saturation=max$1(0,min$1(saturation,1)),brightness=max$1(0,min$1(brightness,1)),0===saturation)return void(r=g=b=round$3(255*brightness));switch(side=hue/60,chroma=brightness*saturation,x=chroma*(1-Math.abs(side%2-1)),match=brightness-chroma,Math.floor(side)){case 0:r=chroma,g=x,b=0;break;case 1:r=x,g=chroma,b=0;break;case 2:r=0,g=chroma,b=x;break;case 3:r=0,g=x,b=chroma;break;case 4:r=x,g=0,b=chroma;break;case 5:r=chroma,g=0,b=x;break;default:r=g=b=0}r=round$3(255*(r+match)),g=round$3(255*(g+match)),b=round$3(255*(b+match))},toHex=function(){var hex=function(val){return val=parseInt(val,10).toString(16),val.length>1?val:"0"+val};return"#"+hex(r)+hex(g)+hex(b)},toRgb=function(){return{r:r,g:g,b:b}},toHsv=function(){return rgb2hsv(r,g,b)},parse=function(value){var matches;return"object"==typeof value?"r"in value?(r=value.r,g=value.g,b=value.b):"v"in value&&hsvToRgb(value.h,value.s,value.v):(matches=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(value))?(r=parseInt(matches[1],10),g=parseInt(matches[2],10),b=parseInt(matches[3],10)):(matches=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value))?(r=parseInt(matches[1],16),g=parseInt(matches[2],16),b=parseInt(matches[3],16)):(matches=/#([0-F])([0-F])([0-F])/gi.exec(value))&&(r=parseInt(matches[1]+matches[1],16),g=parseInt(matches[2]+matches[2],16),b=parseInt(matches[3]+matches[3],16)),r=r<0?0:r>255?255:r,g=g<0?0:g>255?255:g,b=b<0?0:b>255?255:b,self};return value&&parse(value),self.toRgb=toRgb,self.toHsv=toHsv,self.toHex=toHex,self.parse=parse,self},serialize=function(o,quote){var i,v,t,name;if(quote=quote||'"',null===o)return"null";if(t=typeof o,"string"===t)return v="\bb\tt\nn\ff\rr\"\"''\\\\",quote+o.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,b){return'"'===quote&&"'"===a?a:(i=v.indexOf(b),i+1?"\\"+v.charAt(i+1):(a=b.charCodeAt().toString(16),"\\u"+"0000".substring(a.length)+a))})+quote;if("object"===t){if(o.hasOwnProperty&&"[object Array]"===Object.prototype.toString.call(o)){for(i=0,v="[";i<o.length;i++)v+=(i>0?",":"")+serialize(o[i],quote);return v+"]"}v="{";for(name in o)o.hasOwnProperty(name)&&(v+="function"!=typeof o[name]?(v.length>1?","+quote:quote)+name+quote+":"+serialize(o[name],quote):"");return v+"}"}return""+o},$_7z82167tjh8lyxq1={serialize:serialize,parse:function(text){try{return JSON.parse(text)}catch(ex){}}},$_2v08kz7ujh8lyxq4={callbacks:{},count:0,send:function(settings){var self=this,dom=DOMUtils$1.DOM,count=void 0!==settings.count?settings.count:self.count,id="tinymce_jsonp_"+count;self.callbacks[count]=function(json){dom.remove(id),delete self.callbacks[count],settings.callback(json)},dom.add(dom.doc.body,"script",{id:id,src:settings.url,type:"text/javascript"}),self.count++}},XHR={send:function(settings){var xhr,count=0,ready=function(){!settings.async||4===xhr.readyState||count++>1e4?(settings.success&&count<1e4&&200===xhr.status?settings.success.call(settings.success_scope,""+xhr.responseText,xhr,settings):settings.error&&settings.error.call(settings.error_scope,count>1e4?"TIMED_OUT":"GENERAL",xhr,settings),xhr=null):setTimeout(ready,10)};if(settings.scope=settings.scope||this,settings.success_scope=settings.success_scope||settings.scope,settings.error_scope=settings.error_scope||settings.scope,settings.async=settings.async!==!1,settings.data=settings.data||"",XHR.fire("beforeInitialize",{settings:settings}),xhr=new XMLHttpRequest){if(xhr.overrideMimeType&&xhr.overrideMimeType(settings.content_type),xhr.open(settings.type||(settings.data?"POST":"GET"),settings.url,settings.async),settings.crossDomain&&(xhr.withCredentials=!0),settings.content_type&&xhr.setRequestHeader("Content-Type",settings.content_type),settings.requestheaders&&$_ahowuxkjh8lywbj.each(settings.requestheaders,function(header){xhr.setRequestHeader(header.key,header.value)}),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr=XHR.fire("beforeSend",{xhr:xhr,settings:settings}).xhr,xhr.send(settings.data),!settings.async)return ready();setTimeout(ready,10)}}};$_ahowuxkjh8lywbj.extend(XHR,$_fuzxjg45jh8lyx45);var extend$7=$_ahowuxkjh8lywbj.extend,JSONRequest=function(settings){this.settings=extend$7({},settings),this.count=0};JSONRequest.sendRPC=function(o){return(new JSONRequest).send(o)},JSONRequest.prototype={send:function(args){var ecb=args.error,scb=args.success;args=extend$7(this.settings,args),args.success=function(c,x){c=$_7z82167tjh8lyxq1.parse(c),"undefined"==typeof c&&(c={error:"JSON Parse error."}),c.error?ecb.call(args.error_scope||args.scope,c.error,x):scb.call(args.success_scope||args.scope,c.result)},args.error=function(ty,x){ecb&&ecb.call(args.error_scope||args.scope,ty,x)},args.data=$_7z82167tjh8lyxq1.serialize({id:args.id||"c"+this.count++,method:args.method,params:args.params}),args.content_type="application/json",XHR.send(args)}};var localStorage=window.localStorage,tinymce=EditorManager$1,publicApi={geom:{Rect:$_fa0t9p7pjh8lyxpo},util:{Promise:promiseObj,Delay:$_8sy3pfhjh8lyw95,Tools:$_ahowuxkjh8lywbj,VK:$_6lsk4i5gjh8lyxau,URI:URI,Class:Class$1,EventDispatcher:Dispatcher,Observable:$_fuzxjg45jh8lyx45,I18n:$_1tjgyr7njh8lyxpg,XHR:XHR,JSON:$_7z82167tjh8lyxq1,JSONRequest:JSONRequest,JSONP:$_2v08kz7ujh8lyxq4,LocalStorage:localStorage,Color:Color},dom:{EventUtils:EventUtils,Sizzle:Sizzle,DomQuery:DomQuery,TreeWalker:TreeWalker,DOMUtils:DOMUtils$1,ScriptLoader:ScriptLoader,RangeUtils:RangeUtils$1,Serializer:DomSerializer$1,ControlSelection:ControlSelection,BookmarkManager:BookmarkManager$1,Selection:Selection$1,Event:EventUtils.Event},html:{Styles:Styles,Entities:$_gex7a11rjh8lywi4,Node:Node$2,Schema:Schema,SaxParser:SaxParser$1,DomParser:DomParser,Writer:Writer,Serializer:HtmlSerializer},ui:{Factory:$_fym6l27qjh8lyxpr},Env:$_9bpim8ajh8lyw68,AddOnManager:AddOnManager,Formatter:Formatter,UndoManager:UndoManager,EditorCommands:EditorCommands,WindowManager:WindowManager,NotificationManager:NotificationManager,EditorObservable:EditorObservable$1,Shortcuts:Shortcuts,Editor:Editor,FocusManager:$_bmt26v7ljh8lyxp9,EditorManager:EditorManager$1,DOM:DOMUtils$1.DOM,ScriptLoader:ScriptLoader.ScriptLoader,PluginManager:AddOnManager.PluginManager,ThemeManager:AddOnManager.ThemeManager,trim:$_ahowuxkjh8lywbj.trim,isArray:$_ahowuxkjh8lywbj.isArray,is:$_ahowuxkjh8lywbj.is,toArray:$_ahowuxkjh8lywbj.toArray,makeMap:$_ahowuxkjh8lywbj.makeMap,each:$_ahowuxkjh8lywbj.each,map:$_ahowuxkjh8lywbj.map,grep:$_ahowuxkjh8lywbj.grep,inArray:$_ahowuxkjh8lywbj.inArray,extend:$_ahowuxkjh8lywbj.extend,create:$_ahowuxkjh8lywbj.create,walk:$_ahowuxkjh8lywbj.walk,createNS:$_ahowuxkjh8lywbj.createNS,resolve:$_ahowuxkjh8lywbj.resolve,explode:$_ahowuxkjh8lywbj.explode,_addCacheSuffix:$_ahowuxkjh8lywbj._addCacheSuffix,isOpera:$_9bpim8ajh8lyw68.opera,isWebKit:$_9bpim8ajh8lyw68.webkit,isIE:$_9bpim8ajh8lyw68.ie,isGecko:$_9bpim8ajh8lyw68.gecko,isMac:$_9bpim8ajh8lyw68.mac};tinymce=$_ahowuxkjh8lywbj.extend(tinymce,publicApi);var Tinymce=tinymce,exportToModuleLoaders=function(tinymce){if("object"==typeof module)try{module.exports=tinymce}catch(_){}},exportToWindowGlobal=function(tinymce){window.tinymce=tinymce,window.tinyMCE=tinymce};exportToWindowGlobal(Tinymce),exportToModuleLoaders(Tinymce)}()}(),function(){return this.tinyMCE.DOM.events.domLoaded=!0,this.tinyMCE}.apply(this,arguments)||window.tinyMCE}.apply(root,arguments)})}(this),define("text!mockup-patterns-tinymce-url/templates/link.xml",[],function(){return'<div>\n  <div class="linkModal">\n    <h1><%- insertHeading %></h1>\n    <% if(upload){ %>\n    <p class="info">Specify the object to link to. It can be on this site already ("Internal"), an object you upload ("Upload"), from an external site ("External"), an email address ("Email"), or an anchor on this page ("Anchor").</p>\n    <% } %>\n\n    <div class="linkTypes pat-autotoc autotabs"\n         data-pat-autotoc="section:fieldset;levels:legend;IDPrefix:tinymce-autotoc-">\n\n      <fieldset class="linkType internal" data-linkType="internal">\n        <legend id="tinylink-internal">Internal</legend>\n        <div>\n          <div class="form-group main">\n            <!-- this gives the name to the "linkType" -->\n            <input type="text" name="internal" />\n          </div>\n        </div>\n      </fieldset>\n\n      <% if(upload){ %>\n      <fieldset class="linkType upload" data-linkType="upload">\n        <legend id="tinylink-upload">Upload</legend>\n        <div class="uploadify-me"></div>\n      </fieldset>\n      <% } %>\n\n      <fieldset class="linkType external" data-linkType="external">\n        <legend id="tinylink-external">External</legend>\n        <div class="form-group main">\n          <label for="external"><%- externalText %></label>\n          <input type="text" name="external" />\n        </div>\n      </fieldset>\n\n      <fieldset class="linkType email" data-linkType="email">\n        <legend id="tinylink-email">Email</legend>\n        <div class="form-inline">\n          <div class="form-group main">\n            <label><%- emailText %></label>\n            <input type="text" name="email" />\n          </div>\n          <div class="form-group">\n            <label><%- subjectText %></label>\n            <input type="text" name="subject" />\n          </div>\n        </div>\n      </fieldset>\n\n      <fieldset class="linkType anchor" data-linkType="anchor">\n        <legend id="tinylink-anchor">Anchor</legend>\n        <div>\n          <div class="form-group main">\n            <label>Select an anchor</label>\n            <div class="input-wrapper">\n              <select name="anchor" class="pat-select2" data-pat-select2="width:500px" />\n            </div>\n          </div>\n        </div>\n      </fieldset>\n\n    </div><!-- / tabs -->\n\n    <div class="common-controls">\n      <div class="form-group">\n        <label>Target</label>\n        <select name="target">\n          <% _.each(targetList, function(target){ %>\n            <option value="<%- target.value %>"><%- target.text %></option>\n          <% }); %>\n        </select>\n      </div>\n      <div class="form-group">\n        <label><%- titleText %></label>\n        <input type="text" name="title" />\n      </div>\n    </div>\n\n    <input type="submit" class="plone-btn" name="cancel" value="<%- cancelBtn %>" />\n    <input type="submit" class="plone-btn plone-btn-primary context" name="insert" value="<%- insertBtn %>" />\n  </div>\n</div>\n'}),define("text!mockup-patterns-tinymce-url/templates/image.xml",[],function(){return'<div>\n  <div class="linkModal">\n    <h1><%- insertHeading %></h1>\n    <% if(_.contains(linkTypes, \'uploadImage\')){ %>\n    <p class="info">Specify an image. It can be on this site already ("Internal Image"), an image you upload ("Upload"), or from an external site ("External Image").</p>\n    <% } %>\n\n    <div class="linkTypes pat-autotoc autotabs"\n         data-pat-autotoc="section:fieldset;levels:legend;IDPrefix:tinymce-autotoc-">\n\n        <% if(_.contains(linkTypes, \'image\')){ %>\n      <fieldset class="linkType image" data-linkType="image">\n        <legend id="tinylink-image">Internal Image</legend>\n        <div class="form-inline">\n          <div class="form-group main">\n            <input type="text" name="image" />\n          </div>\n          <div class="form-group scale">\n            <label><%- scaleText %></label>\n            <select name="scale">\n              <option value="">Original</option>\n                <% _.each(imageScales, function(scale){ %>\n                  <option value="<%- scale.value %>" <% if(scale.value === options.defaultScale){ %>selected<% } %> >\n                    <%- scale.title %>\n                  </option>\n                <% }); %>\n            </select>\n          </div>\n        </div>\n      </fieldset>\n        <% } %>\n\n      <% if(_.contains(linkTypes, \'uploadImage\')){ %>\n      <fieldset class="linkType uploadImage" data-linkType="uploadImage">\n        <legend id="tinylink-uploadImage">Upload</legend>\n        <div class="uploadify-me"></div>\n      </fieldset>\n      <% } %>\n\n      <% if(_.contains(linkTypes, \'externalImage\')){ %>\n      <fieldset class="linkType externalImage" data-linkType="externalImage">\n        <legend id="tinylink-externalImage">External Image</legend>\n        <div>\n          <div class="form-group main">\n            <label><%- externalImageText %></label>\n            <input type="text" name="externalImage" />\n          </div>\n        </div>\n      </fieldset>\n      <% } %>\n\n    </div><!-- / tabs -->\n\n    <div class="common-controls">\n      <div class="form-group title">\n        <label><%- titleText %></label>\n        <input type="text" name="title" />\n      </div>\n      <div class="form-group text">\n        <label><%- altText %></label>\n        <input type="text" name="alt" />\n      </div>\n      <div class="form-group caption">\n        <label><%- captionText %></label>\n        <input type="text" name="caption" />\n      </div>\n      <div class="form-group align">\n        <label><%- imageAlignText %></label>\n        <select name="align">\n          <% _.each([\'inline\', \'right\', \'left\'], function(align){ %>\n              <option value="<%- align %>">\n              <%- align.charAt(0).toUpperCase() + align.slice(1) %>\n              </option>\n          <% }); %>\n        <select>\n      </div>\n    </div>\n\n    <input type="submit" class="plone-btn" name="cancel" value="<%- cancelBtn %>" />\n    <input type="submit" class="plone-btn plone-btn-primary context" name="insert" value="<%- insertBtn %>" />\n\n  </div>\n</div>\n'}),define("mockup-patterns-autotoc",["jquery","pat-base"],function($,Base){"use strict";var AutoTOC=Base.extend({name:"autotoc",trigger:".pat-autotoc",parser:"mockup",defaults:{section:"section",levels:"h1,h2,h3",IDPrefix:"autotoc-item-",classTOCName:"autotoc-nav",classSectionName:"autotoc-section",classLevelPrefixName:"autotoc-level-",classActiveName:"active",scrollDuration:"slow",scrollEasing:"swing"},init:function(){var self=this;self.$toc=$("<nav/>").addClass(self.options.classTOCName),self.options.prependTo?self.$toc.prependTo(self.options.prependTo):self.options.appendTo?self.$toc.appendTo(self.options.appendTo):self.$toc.prependTo(self.$el),self.options.className&&self.$el.addClass(self.options.className),$(self.options.section,self.$el).addClass(self.options.classSectionName);var asTabs=self.$el.hasClass("autotabs"),activeId=null;$(self.options.levels,self.$el).each(function(i){var $level=$(this),id=$level.prop("id")?$level.prop("id"):$level.parents(self.options.section).prop("id");(!id||$("#"+id).length>0)&&(id=self.options.IDPrefix+self.name+"-"+i),window.location.hash==="#"+id&&(activeId=id),$level.data("navref",id),$("<a/>").appendTo(self.$toc).text($level.text()).attr("id",id).attr("href","#"+id).addClass(self.options.classLevelPrefixName+self.getLevel($level)).on("click",function(e,options){e.stopPropagation(),e.preventDefault(),options||(options={doScroll:!0,skipHash:!1});var $el=$(this);self.$toc.children("."+self.options.classActiveName).removeClass(self.options.classActiveName),self.$el.children("."+self.options.classActiveName).removeClass(self.options.classActiveName),$(e.target).addClass(self.options.classActiveName),$level.parents(self.options.section).addClass(self.options.classActiveName),options.doScroll!==!1&&self.options.scrollDuration&&$level&&!asTabs&&$("body,html").animate({scrollTop:$level.offset().top},self.options.scrollDuration,self.options.scrollEasing),0!==self.$el.parents(".plone-modal").size()&&self.$el.trigger("resize.plone-modal.patterns"),$(this).trigger("clicked"),options.skipHash||window.history&&window.history.pushState&&window.history.pushState({},"","#"+$el.attr("id"))})}),activeId?$("a#"+activeId).trigger("click",{doScroll:!0,skipHash:!0}):self.$toc.find("a").first().trigger("click",{doScroll:!1,skipHash:!0})},getLevel:function($el){var elementLevel=0;return $.each(this.options.levels.split(","),function(level,levelSelector){if(1===$el.filter(levelSelector).size())return elementLevel=level+1,!1}),elementLevel}});return AutoTOC}),define("mockup-patterns-backdrop",["jquery","pat-base"],function($,Base){"use strict";var Backdrop=Base.extend({name:"backdrop",trigger:".pat-backdrop",parser:"mockup",defaults:{zIndex:null,opacity:.8,className:"plone-backdrop",classActiveName:"plone-backdrop-active",closeOnEsc:!0,closeOnClick:!0},init:function(){var self=this;self.$backdrop=$("> ."+self.options.className,self.$el),0===self.$backdrop.size()&&(self.$backdrop=$("<div/>").hide().appendTo(self.$el).addClass(self.options.className),null!==self.options.zIndex&&self.$backdrop.css("z-index",self.options.zIndex)),self.options.closeOnEsc===!0&&$(document).on("keydown",function(e,data){self.$el.is("."+self.options.classActiveName)&&27===e.keyCode&&self.hide()}),self.options.closeOnClick===!0&&self.$backdrop.on("click",function(){self.$el.is("."+self.options.classActiveName)&&self.hide()})},show:function(){var self=this;self.$el.hasClass(self.options.classActiveName)||(self.emit("show"),self.$backdrop.css("opacity","0").show(),self.$el.addClass(self.options.classActiveName),self.$backdrop.animate({opacity:self.options.opacity},500),self.emit("shown"))},hide:function(){var self=this;self.$el.hasClass(self.options.classActiveName)&&(self.emit("hide"),self.$backdrop.animate({opacity:"0"},500).hide(),self.$el.removeClass(self.options.classActiveName),self.emit("hidden"));
}});return Backdrop}),define("mockup-router",["underscore","backbone"],function(_,Backbone){"use strict";var regexEscape=function(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},Router=Backbone.Router.extend({actions:[],redirects:{},addRoute:function(patternName,id,callback,context,pathExp,expReplace){void 0===_.findWhere(this.patterns,{patternName:patternName,id:id})&&this.actions.push({patternName:patternName,id:id,callback:callback,context:context,pathExp:pathExp,expReplace:expReplace});var regex=new RegExp("("+regexEscape(patternName)+":"+regexEscape(id)+")");this.route(regex,"handleRoute")},addRedirect:function(pathExp,destination){this.redirects[pathExp]=destination},handleRoute:function(pattern){var parts=pattern.split(":"),patternName=parts[0],id=parts[1],action=_.findWhere(this.actions,{patternName:patternName,id:id});action&&action.callback.call(action.context)},redirect:function(){var newPath,regex,hash,path=window.parent.location.pathname;if(_.some(this.actions,function(action){if(action.pathExp&&(regex=new RegExp(action.pathExp),path.match(regex))){hash="!/"+action.patternName+":"+action.id;var replaceWith="";return action.expReplace&&(replaceWith=action.expReplace),newPath=path.replace(regex,replaceWith),!0}},this),void 0===hash)for(var pathExp in this.redirects)if(regex=new RegExp(pathExp),path.match(regex)){hash="!/"+this.redirects[pathExp],newPath=path.replace(regex,"");break}void 0!==hash&&this._changeLocation.apply(this,[newPath,hash])},_changeLocation:function(path,hash){window.parent.location.hash=hash,window.parent.location.pathname=path},start:function(){Backbone.history.start()},reset:function(){this.actions=[]}});return new Router}),function(factory){"use strict";"function"==typeof define&&define.amd?define("jquery.form",["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function($){"use strict";function doAjaxSubmit(e){var options=e.data;e.isDefaultPrevented()||(e.preventDefault(),$(e.target).ajaxSubmit(options))}function captureSubmittingElement(e){var target=e.target,$el=$(target);if(!$el.is("[type=submit],[type=image]")){var t=$el.closest("[type=submit]");if(0===t.length)return;target=t[0]}var form=this;if(form.clk=target,"image"==target.type)if(void 0!==e.offsetX)form.clk_x=e.offsetX,form.clk_y=e.offsetY;else if("function"==typeof $.fn.offset){var offset=$el.offset();form.clk_x=e.pageX-offset.left,form.clk_y=e.pageY-offset.top}else form.clk_x=e.pageX-target.offsetLeft,form.clk_y=e.pageY-target.offsetTop;setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)}function log(){if($.fn.ajaxSubmit.debug){var msg="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(msg):window.opera&&window.opera.postError&&window.opera.postError(msg)}}var feature={};feature.fileapi=void 0!==$("<input type='file'/>").get(0).files,feature.formdata=void 0!==window.FormData;var hasProp=!!$.fn.prop;$.fn.attr2=function(){if(!hasProp)return this.attr.apply(this,arguments);var val=this.prop.apply(this,arguments);return val&&val.jquery||"string"==typeof val?val:this.attr.apply(this,arguments)},$.fn.ajaxSubmit=function(options){function deepSerialize(extraData){var i,part,serialized=$.param(extraData,options.traditional).split("&"),len=serialized.length,result=[];for(i=0;i<len;i++)serialized[i]=serialized[i].replace(/\+/g," "),part=serialized[i].split("="),result.push([decodeURIComponent(part[0]),decodeURIComponent(part[1])]);return result}function fileUploadXhr(a){for(var formdata=new FormData,i=0;i<a.length;i++)formdata.append(a[i].name,a[i].value);if(options.extraData){var serializedData=deepSerialize(options.extraData);for(i=0;i<serializedData.length;i++)serializedData[i]&&formdata.append(serializedData[i][0],serializedData[i][1])}options.data=null;var s=$.extend(!0,{},$.ajaxSettings,options,{contentType:!1,processData:!1,cache:!1,type:method||"POST"});options.uploadProgress&&(s.xhr=function(){var xhr=$.ajaxSettings.xhr();return xhr.upload&&xhr.upload.addEventListener("progress",function(event){var percent=0,position=event.loaded||event.position,total=event.total;event.lengthComputable&&(percent=Math.ceil(position/total*100)),options.uploadProgress(event,position,total,percent)},!1),xhr}),s.data=null;var beforeSend=s.beforeSend;return s.beforeSend=function(xhr,o){options.formData?o.data=options.formData:o.data=formdata,beforeSend&&beforeSend.call(this,xhr,o)},$.ajax(s)}function fileUploadIframe(a){function getDoc(frame){var doc=null;try{frame.contentWindow&&(doc=frame.contentWindow.document)}catch(err){log("cannot get iframe.contentWindow document: "+err)}if(doc)return doc;try{doc=frame.contentDocument?frame.contentDocument:frame.document}catch(err){log("cannot get iframe.contentDocument: "+err),doc=frame.document}return doc}function doSubmit(){function checkState(){try{var state=getDoc(io).readyState;log("state = "+state),state&&"uninitialized"==state.toLowerCase()&&setTimeout(checkState,50)}catch(e){log("Server abort: ",e," (",e.name,")"),cb(SERVER_ABORT),timeoutHandle&&clearTimeout(timeoutHandle),timeoutHandle=void 0}}var t=$form.attr2("target"),a=$form.attr2("action"),mp="multipart/form-data",et=$form.attr("enctype")||$form.attr("encoding")||mp;form.setAttribute("target",id),method&&!/post/i.test(method)||form.setAttribute("method","POST"),a!=s.url&&form.setAttribute("action",s.url),s.skipEncodingOverride||method&&!/post/i.test(method)||$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),s.timeout&&(timeoutHandle=setTimeout(function(){timedOut=!0,cb(CLIENT_TIMEOUT_ABORT)},s.timeout));var extraInputs=[];try{if(s.extraData)for(var n in s.extraData)s.extraData.hasOwnProperty(n)&&($.isPlainObject(s.extraData[n])&&s.extraData[n].hasOwnProperty("name")&&s.extraData[n].hasOwnProperty("value")?extraInputs.push($('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value).appendTo(form)[0]):extraInputs.push($('<input type="hidden" name="'+n+'">').val(s.extraData[n]).appendTo(form)[0]));s.iframeTarget||$io.appendTo("body"),io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,!1),setTimeout(checkState,15);try{form.submit()}catch(err){var submitFn=document.createElement("form").submit;submitFn.apply(form)}}finally{form.setAttribute("action",a),form.setAttribute("enctype",et),t?form.setAttribute("target",t):$form.removeAttr("target"),$(extraInputs).remove()}}function cb(e){if(!xhr.aborted&&!callbackProcessed){if(doc=getDoc(io),doc||(log("cannot access response document"),e=SERVER_ABORT),e===CLIENT_TIMEOUT_ABORT&&xhr)return xhr.abort("timeout"),void deferred.reject(xhr,"timeout");if(e==SERVER_ABORT&&xhr)return xhr.abort("server abort"),void deferred.reject(xhr,"error","server abort");if(doc&&doc.location.href!=s.iframeSrc||timedOut){io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",cb,!1);var errMsg,status="success";try{if(timedOut)throw"timeout";var isXml="xml"==s.dataType||doc.XMLDocument||$.isXMLDoc(doc);if(log("isXml="+isXml),!isXml&&window.opera&&(null===doc.body||!doc.body.innerHTML)&&--domCheckCount)return log("requeing onLoad callback, DOM not available"),void setTimeout(cb,250);var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null,xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc,isXml&&(s.dataType="xml"),xhr.getResponseHeader=function(header){var headers={"content-type":s.dataType};return headers[header.toLowerCase()]},docRoot&&(xhr.status=Number(docRoot.getAttribute("status"))||xhr.status,xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText);var dt=(s.dataType||"").toLowerCase(),scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta)xhr.responseText=ta.value,xhr.status=Number(ta.getAttribute("status"))||xhr.status,xhr.statusText=ta.getAttribute("statusText")||xhr.statusText;else if(scr){var pre=doc.getElementsByTagName("pre")[0],b=doc.getElementsByTagName("body")[0];pre?xhr.responseText=pre.textContent?pre.textContent:pre.innerText:b&&(xhr.responseText=b.textContent?b.textContent:b.innerText)}}else"xml"==dt&&!xhr.responseXML&&xhr.responseText&&(xhr.responseXML=toXml(xhr.responseText));try{data=httpData(xhr,dt,s)}catch(err){status="parsererror",xhr.error=errMsg=err||status}}catch(err){log("error caught: ",err),status="error",xhr.error=errMsg=err||status}xhr.aborted&&(log("upload aborted"),status=null),xhr.status&&(status=xhr.status>=200&&xhr.status<300||304===xhr.status?"success":"error"),"success"===status?(s.success&&s.success.call(s.context,data,"success",xhr),deferred.resolve(xhr.responseText,"success",xhr),g&&$.event.trigger("ajaxSuccess",[xhr,s])):status&&(void 0===errMsg&&(errMsg=xhr.statusText),s.error&&s.error.call(s.context,xhr,status,errMsg),deferred.reject(xhr,"error",errMsg),g&&$.event.trigger("ajaxError",[xhr,s,errMsg])),g&&$.event.trigger("ajaxComplete",[xhr,s]),g&&!--$.active&&$.event.trigger("ajaxStop"),s.complete&&s.complete.call(s.context,xhr,status),callbackProcessed=!0,s.timeout&&clearTimeout(timeoutHandle),setTimeout(function(){s.iframeTarget?$io.attr("src",s.iframeSrc):$io.remove(),xhr.responseXML=null},100)}}}var el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle,form=$form[0],deferred=$.Deferred();if(deferred.abort=function(status){xhr.abort(status)},a)for(i=0;i<elements.length;i++)el=$(elements[i]),hasProp?el.prop("disabled",!1):el.removeAttr("disabled");if(s=$.extend(!0,{},$.ajaxSettings,options),s.context=s.context||s,id="jqFormIO"+(new Date).getTime(),s.iframeTarget?($io=$(s.iframeTarget),n=$io.attr2("name"),n?id=n:$io.attr2("name",id)):($io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />'),$io.css({position:"absolute",top:"-1000px",left:"-1000px"})),io=$io[0],xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e="timeout"===status?"timeout":"aborted";log("aborting upload... "+e),this.aborted=1;try{io.contentWindow.document.execCommand&&io.contentWindow.document.execCommand("Stop")}catch(ignore){}$io.attr("src",s.iframeSrc),xhr.error=e,s.error&&s.error.call(s.context,xhr,e,status),g&&$.event.trigger("ajaxError",[xhr,s,e]),s.complete&&s.complete.call(s.context,xhr,e)}},g=s.global,g&&0===$.active++&&$.event.trigger("ajaxStart"),g&&$.event.trigger("ajaxSend",[xhr,s]),s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===!1)return s.global&&$.active--,deferred.reject(),deferred;if(xhr.aborted)return deferred.reject(),deferred;sub=form.clk,sub&&(n=sub.name,n&&!sub.disabled&&(s.extraData=s.extraData||{},s.extraData[n]=sub.value,"image"==sub.type&&(s.extraData[n+".x"]=form.clk_x,s.extraData[n+".y"]=form.clk_y)));var CLIENT_TIMEOUT_ABORT=1,SERVER_ABORT=2,csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content");csrf_param&&csrf_token&&(s.extraData=s.extraData||{},s.extraData[csrf_param]=csrf_token),s.forceSync?doSubmit():setTimeout(doSubmit,10);var data,doc,callbackProcessed,domCheckCount=50,toXml=$.parseXML||function(s,doc){return window.ActiveXObject?(doc=new ActiveXObject("Microsoft.XMLDOM"),doc.async="false",doc.loadXML(s)):doc=(new DOMParser).parseFromString(s,"text/xml"),doc&&doc.documentElement&&"parsererror"!=doc.documentElement.nodeName?doc:null},parseJSON=$.parseJSON||function(s){return window.eval("("+s+")")},httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml="xml"===type||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;return xml&&"parsererror"===data.documentElement.nodeName&&$.error&&$.error("parsererror"),s&&s.dataFilter&&(data=s.dataFilter(data,type)),"string"==typeof data&&("json"===type||!type&&ct.indexOf("json")>=0?data=parseJSON(data):("script"===type||!type&&ct.indexOf("javascript")>=0)&&$.globalEval(data)),data};return deferred}if(!this.length)return log("ajaxSubmit: skipping submit process - no element selected"),this;var method,action,url,$form=this;"function"==typeof options?options={success:options}:void 0===options&&(options={}),method=options.type||this.attr2("method"),action=options.url||this.attr2("action"),url="string"==typeof action?$.trim(action):"",url=url||window.location.href||"",url&&(url=(url.match(/^([^#]+)/)||[])[1]),options=$.extend(!0,{url:url,success:$.ajaxSettings.success,type:method||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},options);var veto={};if(this.trigger("form-pre-serialize",[this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(options.beforeSerialize&&options.beforeSerialize(this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var traditional=options.traditional;void 0===traditional&&(traditional=$.ajaxSettings.traditional);var qx,elements=[],a=this.formToArray(options.semantic,elements);if(options.data&&(options.extraData=options.data,qx=$.param(options.data,traditional)),options.beforeSubmit&&options.beforeSubmit(a,this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[a,this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var q=$.param(a,traditional);qx&&(q=q?q+"&"+qx:qx),"GET"==options.type.toUpperCase()?(options.url+=(options.url.indexOf("?")>=0?"&":"?")+q,options.data=null):options.data=q;var callbacks=[];if(options.resetForm&&callbacks.push(function(){$form.resetForm()}),options.clearForm&&callbacks.push(function(){$form.clearForm(options.includeHidden)}),!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)})}else options.success&&callbacks.push(options.success);if(options.success=function(data,status,xhr){for(var context=options.context||this,i=0,max=callbacks.length;i<max;i++)callbacks[i].apply(context,[data,status,xhr||$form,$form])},options.error){var oldError=options.error;options.error=function(xhr,status,error){var context=options.context||this;oldError.apply(context,[xhr,status,error,$form])}}if(options.complete){var oldComplete=options.complete;options.complete=function(xhr,status){var context=options.context||this;oldComplete.apply(context,[xhr,status,$form])}}var fileInputs=$("input[type=file]:enabled",this).filter(function(){return""!==$(this).val()}),hasFileInputs=fileInputs.length>0,mp="multipart/form-data",multipart=$form.attr("enctype")==mp||$form.attr("encoding")==mp,fileAPI=feature.fileapi&&feature.formdata;log("fileAPI :"+fileAPI);var jqxhr,shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;options.iframe!==!1&&(options.iframe||shouldUseFrame)?options.closeKeepAlive?$.get(options.closeKeepAlive,function(){jqxhr=fileUploadIframe(a)}):jqxhr=fileUploadIframe(a):jqxhr=(hasFileInputs||multipart)&&fileAPI?fileUploadXhr(a):$.ajax(options),$form.removeData("jqxhr").data("jqxhr",jqxhr);for(var k=0;k<elements.length;k++)elements[k]=null;return this.trigger("form-submit-notify",[this,options]),this},$.fn.ajaxForm=function(options){if(options=options||{},options.delegation=options.delegation&&$.isFunction($.fn.on),!options.delegation&&0===this.length){var o={s:this.selector,c:this.context};return!$.isReady&&o.s?(log("DOM not ready, queuing ajaxForm"),$(function(){$(o.s,o.c).ajaxForm(options)}),this):(log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)")),this)}return options.delegation?($(document).off("submit.form-plugin",this.selector,doAjaxSubmit).off("click.form-plugin",this.selector,captureSubmittingElement).on("submit.form-plugin",this.selector,options,doAjaxSubmit).on("click.form-plugin",this.selector,options,captureSubmittingElement),this):this.ajaxFormUnbind().bind("submit.form-plugin",options,doAjaxSubmit).bind("click.form-plugin",options,captureSubmittingElement)},$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},$.fn.formToArray=function(semantic,elements){var a=[];if(0===this.length)return a;var els2,form=this[0],formId=this.attr("id"),els=semantic?form.getElementsByTagName("*"):form.elements;if(els&&!/MSIE [678]/.test(navigator.userAgent)&&(els=$(els).get()),formId&&(els2=$(':input[form="'+formId+'"]').get(),els2.length&&(els=(els||[]).concat(els2))),!els||!els.length)return a;var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++)if(el=els[i],n=el.name,n&&!el.disabled)if(semantic&&form.clk&&"image"==el.type)form.clk==el&&(a.push({name:n,value:$(el).val(),type:el.type}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}));else if(v=$.fieldValue(el,!0),v&&v.constructor==Array)for(elements&&elements.push(el),j=0,jmax=v.length;j<jmax;j++)a.push({name:n,value:v[j]});else if(feature.fileapi&&"file"==el.type){elements&&elements.push(el);var files=el.files;if(files.length)for(j=0;j<files.length;j++)a.push({name:n,value:files[j],type:el.type});else a.push({name:n,value:"",type:el.type})}else null!==v&&"undefined"!=typeof v&&(elements&&elements.push(el),a.push({name:n,value:v,type:el.type,required:el.required}));if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name,n&&!input.disabled&&"image"==input.type&&(a.push({name:n,value:$input.val()}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}))}return a},$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))},$.fn.fieldSerialize=function(successful){var a=[];return this.each(function(){var n=this.name;if(n){var v=$.fieldValue(this,successful);if(v&&v.constructor==Array)for(var i=0,max=v.length;i<max;i++)a.push({name:n,value:v[i]});else null!==v&&"undefined"!=typeof v&&a.push({name:this.name,value:v})}}),$.param(a)},$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i],v=$.fieldValue(el,successful);null===v||"undefined"==typeof v||v.constructor==Array&&!v.length||(v.constructor==Array?$.merge(val,v):val.push(v))}return val},$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(void 0===successful&&(successful=!0),successful&&(!n||el.disabled||"reset"==t||"button"==t||("checkbox"==t||"radio"==t)&&!el.checked||("submit"==t||"image"==t)&&el.form&&el.form.clk!=el||"select"==tag&&el.selectedIndex==-1))return null;if("select"==tag){var index=el.selectedIndex;if(index<0)return null;for(var a=[],ops=el.options,one="select-one"==t,max=one?index+1:ops.length,i=one?index:0;i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(v||(v=op.attributes&&op.attributes.value&&!op.attributes.value.specified?op.text:op.value),one)return v;a.push(v)}}return a}return $(el).val()},$.fn.clearForm=function(includeHidden){return this.each(function(){$("input,select,textarea",this).clearFields(includeHidden)})},$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();re.test(t)||"textarea"==tag?this.value="":"checkbox"==t||"radio"==t?this.checked=!1:"select"==tag?this.selectedIndex=-1:"file"==t?/MSIE/.test(navigator.userAgent)?$(this).replaceWith($(this).clone(!0)):$(this).val(""):includeHidden&&(includeHidden===!0&&/hidden/.test(t)||"string"==typeof includeHidden&&$(this).is(includeHidden))&&(this.value="")})},$.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},$.fn.enable=function(b){return void 0===b&&(b=!0),this.each(function(){this.disabled=!b})},$.fn.selected=function(select){return void 0===select&&(select=!0),this.each(function(){var t=this.type;if("checkbox"==t||"radio"==t)this.checked=select;else if("option"==this.tagName.toLowerCase()){var $sel=$(this).parent("select");select&&$sel[0]&&"select-one"==$sel[0].type&&$sel.find("option").selected(!1),this.selected=select}})},$.fn.ajaxSubmit.debug=!1}),define("mockup-patterns-modal",["jquery","underscore","pat-base","mockup-patterns-backdrop","pat-registry","mockup-router","mockup-utils","translate","jquery.form"],function($,_,Base,Backdrop,registry,Router,utils,_t){"use strict";var Modal=Base.extend({name:"plone-modal",trigger:".pat-plone-modal",parser:"mockup",createModal:null,$model:null,defaults:{width:"",height:"",margin:20,position:"center middle",triggers:[],zIndexSelector:".plone-modal-wrapper,.plone-modal-backdrop",backdrop:"body",backdropOptions:{zIndex:"1040",opacity:"0.85",className:"plone-modal-backdrop",classActiveName:"plone-backdrop-active",closeOnEsc:!0,closeOnClick:!0},title:null,titleSelector:"h1:first",buttons:'.formControls > input[type="submit"]',content:"#content",automaticallyAddButtonActions:!0,loadLinksWithinModal:!0,prependContent:".portalMessage",templateOptions:{className:"plone-modal fade",classDialog:"plone-modal-dialog",classModal:"plone-modal-content",classHeaderName:"plone-modal-header",classBodyName:"plone-modal-body",classFooterName:"plone-modal-footer",classWrapperName:"plone-modal-wrapper",classWrapperInnerName:"modal-wrapper-inner",classActiveName:"in",classPrependName:"",classContentName:"",template:'<div class="<%= options.className %>">  <div class="<%= options.classDialog %>">    <div class="<%= options.classModal %>">      <div class="<%= options.classHeaderName %>">        <a class="plone-modal-close">&times;</a>        <% if (title) { %><h2 class="plone-modal-title"><%= title %></h2><% } %>      </div>      <div class="<%= options.classBodyName %>">        <div class="<%= options.classPrependName %>"><%= prepend %></div>         <div class="<%= options.classContentName %>"><%= content %></div>      </div>      <div class="<%= options.classFooterName %>">         <% if (buttons) { %><%= buttons %><% } %>      </div>    </div>  </div></div>'},actions:{},actionOptions:{eventType:"click",disableAjaxFormSubmit:!1,target:null,ajaxUrl:null,modalFunction:null,isForm:!1,timeout:5e3,displayInModal:!0,reloadWindowOnClose:!0,error:".portalMessage.error",formFieldError:".field.error",onSuccess:null,onError:null,onFormError:null,onTimeout:null,redirectOnResponse:!1,redirectToUrl:function($action,response,options){var reg;return reg=/<body.*data-view-url=[\"'](.*)[\"'].*/im.exec(response),reg&&reg.length>1?reg[1].split('"')[0]:(reg=/<body.*data-base-url=[\"'](.*)[\"'].*/im.exec(response),reg&&reg.length>1?reg[1].split('"')[0]:(reg=/<base.*href=[\"'](.*)[\"'].*/im.exec(response),reg&&reg.length>1?reg[1]:""))}},routerOptions:{id:null,pathExp:null},form:function(actions){var self=this,$modal=self.$modal;self.options.automaticallyAddButtonActions&&(actions[self.options.buttons]={}),actions.a={},$.each(actions,function(action,options){var actionKeys=_.union(_.keys(self.options.actionOptions),["templateOptions"]),actionOptions=$.extend(!0,{},self.options.actionOptions,_.pick(options,actionKeys));options.templateOptions=$.extend(!0,options.templateOptions,self.options.templateOptions);var patternKeys=_.union(_.keys(self.options.actionOptions),["actions","actionOptions"]),patternOptions=$.extend(!0,_.omit(options,patternKeys),self.options);$(action,$("."+options.templateOptions.classBodyName,$modal)).each(function(action){var $action=$(this);$action.on(actionOptions.eventType,function(e){e.stopPropagation(),e.preventDefault(),self.loading.show(!1),null!==actionOptions.modalFunction?self[actionOptions.modalFunction]():$.nodeName($action[0],"input")||$.nodeName($action[0],"button")||options.isForm===!0?self.options.handleFormAction.apply(self,[$action,actionOptions,patternOptions]):(null!==options.ajaxUrl||$.nodeName($action[0],"a"))&&self.options.handleLinkAction.apply(self,[$action,actionOptions,patternOptions])})})})},handleFormAction:function($action,options,patternOptions){var self=this,extraData={};extraData[$action.attr("name")]=$action.attr("value");var $form;$form=$.nodeName($action[0],"form")?$action:$action.parents("form:not(.disableAutoSubmit)");var url;return url=null!==options.ajaxUrl?"function"==typeof options.ajaxUrl?options.ajaxUrl.apply(self,[$action,options]):options.ajaxUrl:$action.parents("form").attr("action"),options.disableAjaxFormSubmit?($action.attr("name")&&$action.attr("value")&&$form.append($('<input type="hidden" name="'+$action.attr("name")+'" value="'+$action.attr("value")+'" />')),void $form.trigger("submit")):($form.on("submit",function(e){e.preventDefault()}),$form.trigger("submit"),self.loading.show(!1),void $form.ajaxSubmit({timeout:options.timeout,data:extraData,url:url,error:function(xhr,textStatus,errorStatus){self.loading.hide(),"timeout"===textStatus&&options.onTimeout?options.onTimeout.apply(self,xhr,errorStatus):options.onError?options.onError(xhr,textStatus,errorStatus):(window.alert(_t("There was an error submitting the form.")),console.log("error happened do something")),self.emit("formActionError",[xhr,textStatus,errorStatus])},success:function(response,state,xhr,form){return self.loading.hide(),0!==$(options.error,response).size()||0!==$(options.formFieldError,response).size()?void(options.onFormError?options.onFormError(self,response,state,xhr,form):self.redraw(response,patternOptions)):options.redirectOnResponse===!0?void("function"==typeof options.redirectToUrl?window.parent.location.href=options.redirectToUrl.apply(self,[$action,response,options]):window.parent.location.href=options.redirectToUrl):(options.onSuccess&&options.onSuccess(self,response,state,xhr,form),options.displayInModal===!0?self.redraw(response,patternOptions):($action.trigger("destroy.plone-modal.patterns"),options.reloadWindowOnClose&&self.reloadWindow()),void self.emit("formActionSuccess",[response,state,xhr,form]))}}))},handleLinkAction:function($action,options,patternOptions){var url,self=this;return url=options.ajaxUrl?"function"==typeof options.ajaxUrl?options.ajaxUrl.apply(self,[$action,options]):options.ajaxUrl:$action.attr("href"),options.displayInModal===!1?void("_blank"===$action.attr("target")?(window.open(url,"_blank"),self.loading.hide()):window.location=url):void $.ajax({url:url}).fail(function(xhr,textStatus,errorStatus){"timeout"===textStatus&&options.onTimeout?options.onTimeout(self.$modal,xhr,errorStatus):options.onError?options.onError(xhr,textStatus,errorStatus):window.alert(_t("There was an error loading modal.")),self.emit("linkActionError",[xhr,textStatus,errorStatus])}).done(function(response,state,xhr){self.redraw(response,patternOptions),options.onSuccess&&options.onSuccess(self,response,state,xhr),self.emit("linkActionSuccess",[response,state,xhr])}).always(function(){self.loading.hide()})},render:function(options){var self=this;if(self.emit("before-render"),self.$raw){var $raw=self.$raw.clone();$("input:checked",$raw).each(function(){this.setAttribute&&this.setAttribute("checked","checked")});var tplObject={title:"",prepend:"<div />",content:"",buttons:'<div class="pattern-modal-buttons"></div>',options:options.templateOptions};if(null===options.title){var $title=$(options.titleSelector,$raw);tplObject.title=$title.html(),$(options.titleSelector,$raw).remove()}else tplObject.title=options.title;options.prependContent&&(tplObject.prepend=$("<div />").append($(options.prependContent,$raw).clone()).html(),$(options.prependContent,$raw).remove()),options.content?tplObject.content=$(options.content,$raw).html():tplObject.content=$raw.html(),self.$modal=$(_.template(self.options.templateOptions.template)(tplObject)),self.$modalDialog=$("> ."+self.options.templateOptions.classDialog,self.$modal),self.$modalContent=$("> ."+self.options.templateOptions.classModal,self.$modalDialog),$("form",self.$modal).on("keydown",function(event){13===event.keyCode&&"TEXTAREA"!==event.target.nodeName&&(event.preventDefault(),$("input[type=submit], button[type=submit], button:not(type)",this).eq(0).trigger("click"))}),$(options.buttons,self.$modal).each(function(){var $button=$(this);$button.on("click",function(e){e.stopPropagation(),e.preventDefault()}).clone().appendTo($(".pattern-modal-buttons",self.$modal)).off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),$button.trigger("click")}),$button.hide()}),self.emit("before-events-setup"),$(".plone-modal-header > a.plone-modal-close, .plone-modal-footer > a.plone-modal-close",self.$modal).off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),$(e.target).trigger("destroy.plone-modal.patterns")}),options.form&&options.form.apply(self,[options.actions]),self.$modal.addClass(self.options.templateOptions.className).on("destroy.plone-modal.patterns",function(e){e.stopPropagation(),self.hide()}).on("resize.plone-modal.patterns",function(e){e.stopPropagation(),e.preventDefault(),self.positionModal()}).appendTo(self.$wrapperInner),self.options.loadLinksWithinModal&&self.$modal.on("click",function(e){e.stopPropagation(),$.nodeName(e.target,"a")&&e.preventDefault(),self.$modal.trigger("modal-click")}),self.$modal.data("pattern-"+self.name,self),self.emit("after-render")}}},reloadWindow:function(){window.parent.location.reload()},init:function(){var self=this;self.options.loadLinksWithinModal=$.parseJSON(self.options.loadLinksWithinModal),null!==self.options.routerOptions.id&&Router.addRoute("modal",self.options.routerOptions.id,function(){this.show()},self,self.options.routerOptions.pathExp,self.options.routerOptions.expReplace),self.options.backdropOptions.closeOnEsc===!0&&$(document).on("keydown",function(e,data){self.$el.is("."+self.options.templateOptions.classActiveName)&&27===e.keyCode&&self.hide()}),$(window.parent).resize(function(){self.positionModal()}),self.options.triggers&&$.each(self.options.triggers,function(i,item){var e=item.substring(0,item.indexOf(" ")),selector=item.substring(item.indexOf(" "),item.length);$(selector||self.$el).on(e,function(e){e.stopPropagation(),e.preventDefault(),self.show()})}),self.$el.is("a")&&(self.$el.attr("href")&&!self.options.image&&(self.options.target||"#"!==self.$el.attr("href").substr(0,1)||(self.options.target=self.$el.attr("href"),self.options.content=""),self.options.ajaxUrl||"#"===self.$el.attr("href").substr(0,1)||(self.options.ajaxUrl=self.$el.attr("href"))),self.$el.on("click",function(e){e.stopPropagation(),e.preventDefault(),self.show()})),self.initModal()},createAjaxModal:function(){var self=this;self.emit("before-ajax"),self.loading.show(),self.ajaxXHR=$.ajax({url:self.options.ajaxUrl,type:self.options.ajaxType}).done(function(response,textStatus,xhr){self.ajaxXHR=void 0,self.$raw=$("<div />").append($(utils.parseBodyTag(response))),self.emit("after-ajax",self,textStatus,xhr),self._show()}).fail(function(xhr,textStatus,errorStatus){var options=self.options.actionOptions;"timeout"===textStatus&&options.onTimeout?options.onTimeout(self.$modal,xhr,errorStatus):options.onError?options.onError(xhr,textStatus,errorStatus):(window.alert(_t("There was an error loading modal.")),self.hide()),self.emit("linkActionError",[xhr,textStatus,errorStatus])}).always(function(){self.loading.hide()})},createTargetModal:function(){var self=this;self.$raw=$(self.options.target).clone(),self._show()},createBasicModal:function(){var self=this;self.$raw=$("<div/>").html(self.$el.clone()),self._show()},createHtmlModal:function(){var self=this,$el=$(self.options.html);self.$raw=$el,self._show()},createImageModal:function(){var self=this;self.$wrapper.addClass("image-modal");var src=self.$el.attr("href"),srcset=self.$el.attr("data-modal-srcset")||"";self.$raw=$('<div><h1>Image</h1><div id="content"><div class="modal-image"><img src="'+src+'" srcset="'+srcset+'" /></div></div></div>'),self._show()},initModal:function(){var self=this;self.options.ajaxUrl?self.createModal=self.createAjaxModal:self.options.target?self.createModal=self.createTargetModal:self.options.html?self.createModal=self.createHtmlModal:self.options.image?self.createModal=self.createImageModal:self.createModal=self.createBasicModal;
},findPosition:function(horpos,vertpos,margin,modalWidth,modalHeight,wrapperInnerWidth,wrapperInnerHeight){var absTop,absBottom,absLeft,absRight,returnpos={};return absRight=absLeft=absTop=absLeft="auto","left"===horpos?(absLeft=margin+"px",modalWidth>wrapperInnerWidth&&(absLeft="0px"),returnpos.left=absLeft):"right"===horpos?(absRight=margin+"px",modalWidth>wrapperInnerWidth&&(absRight="0px"),returnpos.right=absRight,returnpos.left="auto"):(absLeft=wrapperInnerWidth/2-modalWidth/2-margin+"px",modalWidth>wrapperInnerWidth&&(absLeft="0px"),returnpos.left=absLeft),"top"===vertpos?(absTop=margin+"px",modalHeight>wrapperInnerHeight&&(absTop="0px"),returnpos.top=absTop):"bottom"===vertpos?(absBottom=margin+"px",modalHeight>wrapperInnerHeight&&(absBottom="0px"),returnpos.bottom=absBottom,returnpos.top="auto"):(absTop=wrapperInnerHeight/2-modalHeight/2-margin+"px",modalHeight>wrapperInnerHeight&&(absTop="0px"),returnpos.top=absTop),returnpos},modalInitialized:function(){var self=this;return null!==self.$modal&&void 0!==self.$modal},positionModal:function(){var self=this;if(self.modalInitialized()){self.$modal.removeAttr("style"),self.$wrapper.parent().is("body")&&self.$wrapper.height($(window.parent).height());var margin="function"==typeof self.options.margin?self.options.margin():self.options.margin;self.$modal.css({position:"absolute",padding:margin}),self.$modalDialog.css({margin:"0",padding:"0",width:self.options.width,height:self.options.height}),self.$modalContent.css({width:self.options.width});var posopt=self.options.position.split(" "),horpos=posopt[0],vertpos=posopt[1],modalWidth=self.$modalDialog.outerWidth(!0),modalHeight=self.$modalDialog.outerHeight(!0),wrapperInnerWidth=self.$wrapperInner.width(),wrapperInnerHeight=self.$wrapperInner.height(),pos=self.findPosition(horpos,vertpos,margin,modalWidth,modalHeight,wrapperInnerWidth,wrapperInnerHeight);for(var key in pos)self.$modalDialog.css(key,pos[key])}},render:function(options){var self=this;self.emit("render"),self.options.render.apply(self,[options]),self.emit("rendered")},show:function(){var self=this;self.backdrop=self.createBackdrop(),self.createModal()},createBackdrop:function(){var self=this,backdrop=new Backdrop(self.$el.parents(self.options.backdrop),self.options.backdropOptions),zIndex=1041;return $(self.options.zIndexSelector).each(function(){zIndex=Math.max(zIndex,parseInt($(this).css("zIndex"))+1||1041)}),self.$wrapper=$("<div/>").hide().css({"z-index":zIndex,"overflow-y":"auto",position:"fixed",height:"100%",width:"100%",bottom:"0",left:"0",right:"0",top:"0"}).addClass(self.options.templateOptions.classWrapperName).insertBefore(backdrop.$backdrop).on("click",function(e){self.options.backdropOptions.closeOnClick&&(e.stopPropagation(),e.preventDefault(),backdrop.hide())}),backdrop.on("hidden",function(e){void 0!==self.$modal&&self.$modal.hasClass(self.options.templateOptions.classActiveName)&&self.hide()}),self.loading=new utils.Loading({backdrop:backdrop}),self.$wrapperInner=$("<div/>").addClass(self.options.classWrapperInnerName).css({position:"absolute",bottom:"0",left:"0",right:"0",top:"0"}).appendTo(self.$wrapper),backdrop},_show:function(){var self=this;self.render.apply(self,[self.options]),self.emit("show"),self.backdrop.show(),self.$wrapper.show(),self.loading.hide(),self.$el.addClass(self.options.templateOptions.classActiveName),self.$modal.addClass(self.options.templateOptions.classActiveName),registry.scan(self.$modal),self.positionModal(),$("img",self.$modal).load(function(){self.positionModal()}),$(window.parent).on("resize.plone-modal.patterns",function(){self.positionModal()}),$("body").addClass("plone-modal-open"),self.emit("shown")},hide:function(){var self=this;self.ajaxXHR&&self.ajaxXHR.abort(),self.emit("hide"),self._suppressHide&&!window.confirm(self._suppressHide)||(self.loading.hide(),self.$el.removeClass(self.options.templateOptions.classActiveName),void 0!==self.$modal&&(self.$modal.remove(),self.initModal()),self.$wrapper.remove(),$(".plone-modal",$("body")).size()<1&&(self.backdrop.hide(),$("body").removeClass("plone-modal-open"),$(window.parent).off("resize.plone-modal.patterns")),self.emit("hidden"))},redraw:function(response,options){var self=this;self.emit("beforeDraw"),self.$modal.remove(),self.$raw=$("<div />").append($(utils.parseBodyTag(response))),self.render.apply(self,[options||self.options]),self.$modal.addClass(self.options.templateOptions.classActiveName),self.positionModal(),registry.scan(self.$modal),self.emit("afterDraw")}});return Modal}),function(factory){"function"==typeof define&&define.amd?define("dropzone",["jquery"],factory):factory(jQuery)}(function(jQuery){var module={exports:{}};return function(){var Dropzone,Emitter,camelize,contentLoaded,detectVerticalSquash,drawImageIOSFix,noop,without,__slice=[].slice,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};noop=function(){},Emitter=function(){function Emitter(){}return Emitter.prototype.addEventListener=Emitter.prototype.on,Emitter.prototype.on=function(event,fn){return this._callbacks=this._callbacks||{},this._callbacks[event]||(this._callbacks[event]=[]),this._callbacks[event].push(fn),this},Emitter.prototype.emit=function(){var args,callback,callbacks,event,_i,_len;if(event=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],this._callbacks=this._callbacks||{},callbacks=this._callbacks[event])for(_i=0,_len=callbacks.length;_i<_len;_i++)callback=callbacks[_i],callback.apply(this,args);return this},Emitter.prototype.removeListener=Emitter.prototype.off,Emitter.prototype.removeAllListeners=Emitter.prototype.off,Emitter.prototype.removeEventListener=Emitter.prototype.off,Emitter.prototype.off=function(event,fn){var callback,callbacks,i,_i,_len;if(!this._callbacks||0===arguments.length)return this._callbacks={},this;if(callbacks=this._callbacks[event],!callbacks)return this;if(1===arguments.length)return delete this._callbacks[event],this;for(i=_i=0,_len=callbacks.length;_i<_len;i=++_i)if(callback=callbacks[i],callback===fn){callbacks.splice(i,1);break}return this},Emitter}(),Dropzone=function(_super){function Dropzone(element,options){var elementOptions,fallback,_ref;if(this.element=element,this.version=Dropzone.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(Dropzone.instances.push(this),this.element.dropzone=this,elementOptions=null!=(_ref=Dropzone.optionsForElement(this.element))?_ref:{},this.options=extend({},this.defaultOptions,elementOptions,null!=options?options:{}),this.options.forceFallback||!Dropzone.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(fallback=this.getExistingFallback())&&fallback.parentNode&&fallback.parentNode.removeChild(fallback),this.options.previewsContainer!==!1&&(this.options.previewsContainer?this.previewsContainer=Dropzone.getElement(this.options.previewsContainer,"previewsContainer"):this.previewsContainer=this.element),this.options.clickable&&(this.options.clickable===!0?this.clickableElements=[this.element]:this.clickableElements=Dropzone.getElements(this.options.clickable,"clickable")),this.init()}var extend,resolveOption;return __extends(Dropzone,_super),Dropzone.prototype.Emitter=Emitter,Dropzone.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],Dropzone.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1e3,maxFiles:null,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,hiddenInputContainer:"body",capture:null,renameFilename:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(file,done){return done()},init:function(){return noop},forceFallback:!1,fallback:function(){var child,messageElement,span,_i,_len,_ref;for(this.element.className=""+this.element.className+" dz-browser-not-supported",_ref=this.element.getElementsByTagName("div"),_i=0,_len=_ref.length;_i<_len;_i++)child=_ref[_i],/(^| )dz-message($| )/.test(child.className)&&(messageElement=child,child.className="dz-message");return messageElement||(messageElement=Dropzone.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(messageElement)),span=messageElement.getElementsByTagName("span")[0],span&&(null!=span.textContent?span.textContent=this.options.dictFallbackMessage:null!=span.innerText&&(span.innerText=this.options.dictFallbackMessage)),this.element.appendChild(this.getFallbackForm())},resize:function(file){var info,srcRatio,trgRatio;return info={srcX:0,srcY:0,srcWidth:file.width,srcHeight:file.height},srcRatio=file.width/file.height,info.optWidth=this.options.thumbnailWidth,info.optHeight=this.options.thumbnailHeight,null==info.optWidth&&null==info.optHeight?(info.optWidth=info.srcWidth,info.optHeight=info.srcHeight):null==info.optWidth?info.optWidth=srcRatio*info.optHeight:null==info.optHeight&&(info.optHeight=1/srcRatio*info.optWidth),trgRatio=info.optWidth/info.optHeight,file.height<info.optHeight||file.width<info.optWidth?(info.trgHeight=info.srcHeight,info.trgWidth=info.srcWidth):srcRatio>trgRatio?(info.srcHeight=file.height,info.srcWidth=info.srcHeight*trgRatio):(info.srcWidth=file.width,info.srcHeight=info.srcWidth/trgRatio),info.srcX=(file.width-info.srcWidth)/2,info.srcY=(file.height-info.srcHeight)/2,info},drop:function(e){return this.element.classList.remove("dz-drag-hover")},dragstart:noop,dragend:function(e){return this.element.classList.remove("dz-drag-hover")},dragenter:function(e){return this.element.classList.add("dz-drag-hover")},dragover:function(e){return this.element.classList.add("dz-drag-hover")},dragleave:function(e){return this.element.classList.remove("dz-drag-hover")},paste:noop,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(file){var node,removeFileEvent,removeLink,_i,_j,_k,_len,_len1,_len2,_ref,_ref1,_ref2,_results;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(file.previewElement=Dropzone.createElement(this.options.previewTemplate.trim()),file.previewTemplate=file.previewElement,this.previewsContainer.appendChild(file.previewElement),_ref=file.previewElement.querySelectorAll("[data-dz-name]"),_i=0,_len=_ref.length;_i<_len;_i++)node=_ref[_i],node.textContent=this._renameFilename(file.name);for(_ref1=file.previewElement.querySelectorAll("[data-dz-size]"),_j=0,_len1=_ref1.length;_j<_len1;_j++)node=_ref1[_j],node.innerHTML=this.filesize(file.size);for(this.options.addRemoveLinks&&(file._removeLink=Dropzone.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),file.previewElement.appendChild(file._removeLink)),removeFileEvent=function(_this){return function(e){return e.preventDefault(),e.stopPropagation(),file.status===Dropzone.UPLOADING?Dropzone.confirm(_this.options.dictCancelUploadConfirmation,function(){return _this.removeFile(file)}):_this.options.dictRemoveFileConfirmation?Dropzone.confirm(_this.options.dictRemoveFileConfirmation,function(){return _this.removeFile(file)}):_this.removeFile(file)}}(this),_ref2=file.previewElement.querySelectorAll("[data-dz-remove]"),_results=[],_k=0,_len2=_ref2.length;_k<_len2;_k++)removeLink=_ref2[_k],_results.push(removeLink.addEventListener("click",removeFileEvent));return _results}},removedfile:function(file){var _ref;return file.previewElement&&null!=(_ref=file.previewElement)&&_ref.parentNode.removeChild(file.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(file,dataUrl){var thumbnailElement,_i,_len,_ref;if(file.previewElement){for(file.previewElement.classList.remove("dz-file-preview"),_ref=file.previewElement.querySelectorAll("[data-dz-thumbnail]"),_i=0,_len=_ref.length;_i<_len;_i++)thumbnailElement=_ref[_i],thumbnailElement.alt=file.name,thumbnailElement.src=dataUrl;return setTimeout(function(_this){return function(){return file.previewElement.classList.add("dz-image-preview")}}(this),1)}},error:function(file,message){var node,_i,_len,_ref,_results;if(file.previewElement){for(file.previewElement.classList.add("dz-error"),"String"!=typeof message&&message.error&&(message=message.error),_ref=file.previewElement.querySelectorAll("[data-dz-errormessage]"),_results=[],_i=0,_len=_ref.length;_i<_len;_i++)node=_ref[_i],_results.push(node.textContent=message);return _results}},errormultiple:noop,processing:function(file){if(file.previewElement&&(file.previewElement.classList.add("dz-processing"),file._removeLink))return file._removeLink.textContent=this.options.dictCancelUpload},processingmultiple:noop,uploadprogress:function(file,progress,bytesSent){var node,_i,_len,_ref,_results;if(file.previewElement){for(_ref=file.previewElement.querySelectorAll("[data-dz-uploadprogress]"),_results=[],_i=0,_len=_ref.length;_i<_len;_i++)node=_ref[_i],"PROGRESS"===node.nodeName?_results.push(node.value=progress):_results.push(node.style.width=""+progress+"%");return _results}},totaluploadprogress:noop,sending:noop,sendingmultiple:noop,success:function(file){if(file.previewElement)return file.previewElement.classList.add("dz-success")},successmultiple:noop,canceled:function(file){return this.emit("error",file,"Upload canceled.")},canceledmultiple:noop,complete:function(file){if(file._removeLink&&(file._removeLink.textContent=this.options.dictRemoveFile),file.previewElement)return file.previewElement.classList.add("dz-complete")},completemultiple:noop,maxfilesexceeded:noop,maxfilesreached:noop,queuecomplete:noop,addedfiles:noop,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>'},extend=function(){var key,object,objects,target,val,_i,_len;for(target=arguments[0],objects=2<=arguments.length?__slice.call(arguments,1):[],_i=0,_len=objects.length;_i<_len;_i++){object=objects[_i];for(key in object)val=object[key],target[key]=val}return target},Dropzone.prototype.getAcceptedFiles=function(){var file,_i,_len,_ref,_results;for(_ref=this.files,_results=[],_i=0,_len=_ref.length;_i<_len;_i++)file=_ref[_i],file.accepted&&_results.push(file);return _results},Dropzone.prototype.getRejectedFiles=function(){var file,_i,_len,_ref,_results;for(_ref=this.files,_results=[],_i=0,_len=_ref.length;_i<_len;_i++)file=_ref[_i],file.accepted||_results.push(file);return _results},Dropzone.prototype.getFilesWithStatus=function(status){var file,_i,_len,_ref,_results;for(_ref=this.files,_results=[],_i=0,_len=_ref.length;_i<_len;_i++)file=_ref[_i],file.status===status&&_results.push(file);return _results},Dropzone.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(Dropzone.QUEUED)},Dropzone.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(Dropzone.UPLOADING)},Dropzone.prototype.getAddedFiles=function(){return this.getFilesWithStatus(Dropzone.ADDED)},Dropzone.prototype.getActiveFiles=function(){var file,_i,_len,_ref,_results;for(_ref=this.files,_results=[],_i=0,_len=_ref.length;_i<_len;_i++)file=_ref[_i],file.status!==Dropzone.UPLOADING&&file.status!==Dropzone.QUEUED||_results.push(file);return _results},Dropzone.prototype.init=function(){var eventName,noPropagation,setupHiddenFileInput,_i,_len,_ref,_ref1;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(Dropzone.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(setupHiddenFileInput=function(_this){return function(){return _this.hiddenFileInput&&_this.hiddenFileInput.parentNode.removeChild(_this.hiddenFileInput),_this.hiddenFileInput=document.createElement("input"),_this.hiddenFileInput.setAttribute("type","file"),(null==_this.options.maxFiles||_this.options.maxFiles>1)&&_this.hiddenFileInput.setAttribute("multiple","multiple"),_this.hiddenFileInput.className="dz-hidden-input",null!=_this.options.acceptedFiles&&_this.hiddenFileInput.setAttribute("accept",_this.options.acceptedFiles),null!=_this.options.capture&&_this.hiddenFileInput.setAttribute("capture",_this.options.capture),_this.hiddenFileInput.style.visibility="hidden",_this.hiddenFileInput.style.position="absolute",_this.hiddenFileInput.style.top="0",_this.hiddenFileInput.style.left="0",_this.hiddenFileInput.style.height="0",_this.hiddenFileInput.style.width="0",document.querySelector(_this.options.hiddenInputContainer).appendChild(_this.hiddenFileInput),_this.hiddenFileInput.addEventListener("change",function(){var file,files,_i,_len;if(files=_this.hiddenFileInput.files,files.length)for(_i=0,_len=files.length;_i<_len;_i++)file=files[_i],_this.addFile(file);return _this.emit("addedfiles",files),setupHiddenFileInput()})}}(this))(),this.URL=null!=(_ref=window.URL)?_ref:window.webkitURL,_ref1=this.events,_i=0,_len=_ref1.length;_i<_len;_i++)eventName=_ref1[_i],this.on(eventName,this.options[eventName]);return this.on("uploadprogress",function(_this){return function(){return _this.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(_this){return function(){return _this.updateTotalUploadProgress()}}(this)),this.on("canceled",function(_this){return function(file){return _this.emit("complete",file)}}(this)),this.on("complete",function(_this){return function(file){if(0===_this.getAddedFiles().length&&0===_this.getUploadingFiles().length&&0===_this.getQueuedFiles().length)return setTimeout(function(){return _this.emit("queuecomplete")},0)}}(this)),noPropagation=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(_this){return function(e){return _this.emit("dragstart",e)}}(this),dragenter:function(_this){return function(e){return noPropagation(e),_this.emit("dragenter",e)}}(this),dragover:function(_this){return function(e){var efct;try{efct=e.dataTransfer.effectAllowed}catch(_error){}return e.dataTransfer.dropEffect="move"===efct||"linkMove"===efct?"move":"copy",noPropagation(e),_this.emit("dragover",e)}}(this),dragleave:function(_this){return function(e){return _this.emit("dragleave",e)}}(this),drop:function(_this){return function(e){return noPropagation(e),_this.drop(e)}}(this),dragend:function(_this){return function(e){return _this.emit("dragend",e)}}(this)}}],this.clickableElements.forEach(function(_this){return function(clickableElement){return _this.listeners.push({element:clickableElement,events:{click:function(evt){return(clickableElement!==_this.element||evt.target===_this.element||Dropzone.elementInside(evt.target,_this.element.querySelector(".dz-message")))&&_this.hiddenFileInput.click(),!0}}})}}(this)),this.enable(),this.options.init.call(this)},Dropzone.prototype.destroy=function(){var _ref;return this.disable(),this.removeAllFiles(!0),(null!=(_ref=this.hiddenFileInput)?_ref.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,Dropzone.instances.splice(Dropzone.instances.indexOf(this),1)},Dropzone.prototype.updateTotalUploadProgress=function(){var activeFiles,file,totalBytes,totalBytesSent,totalUploadProgress,_i,_len,_ref;if(totalBytesSent=0,totalBytes=0,activeFiles=this.getActiveFiles(),activeFiles.length){for(_ref=this.getActiveFiles(),_i=0,_len=_ref.length;_i<_len;_i++)file=_ref[_i],totalBytesSent+=file.upload.bytesSent,totalBytes+=file.upload.total;totalUploadProgress=100*totalBytesSent/totalBytes}else totalUploadProgress=100;return this.emit("totaluploadprogress",totalUploadProgress,totalBytes,totalBytesSent)},Dropzone.prototype._getParamName=function(n){return"function"==typeof this.options.paramName?this.options.paramName(n):""+this.options.paramName+(this.options.uploadMultiple?"["+n+"]":"")},Dropzone.prototype._renameFilename=function(name){return"function"!=typeof this.options.renameFilename?name:this.options.renameFilename(name)},Dropzone.prototype.getFallbackForm=function(){var existingFallback,fields,fieldsString,form;return(existingFallback=this.getExistingFallback())?existingFallback:(fieldsString='<div class="dz-fallback">',this.options.dictFallbackText&&(fieldsString+="<p>"+this.options.dictFallbackText+"</p>"),fieldsString+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',fields=Dropzone.createElement(fieldsString),"FORM"!==this.element.tagName?(form=Dropzone.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),form.appendChild(fields)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=form?form:fields)},Dropzone.prototype.getExistingFallback=function(){var fallback,getFallback,tagName,_i,_len,_ref;for(getFallback=function(elements){var el,_i,_len;for(_i=0,_len=elements.length;_i<_len;_i++)if(el=elements[_i],/(^| )fallback($| )/.test(el.className))return el},_ref=["div","form"],_i=0,_len=_ref.length;_i<_len;_i++)if(tagName=_ref[_i],fallback=getFallback(this.element.getElementsByTagName(tagName)))return fallback},Dropzone.prototype.setupEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;for(_ref=this.listeners,_results=[],_i=0,_len=_ref.length;_i<_len;_i++)elementListeners=_ref[_i],_results.push(function(){var _ref1,_results1;_ref1=elementListeners.events,_results1=[];for(event in _ref1)listener=_ref1[event],_results1.push(elementListeners.element.addEventListener(event,listener,!1));return _results1}());return _results},Dropzone.prototype.removeEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;for(_ref=this.listeners,_results=[],_i=0,_len=_ref.length;_i<_len;_i++)elementListeners=_ref[_i],_results.push(function(){var _ref1,_results1;_ref1=elementListeners.events,_results1=[];for(event in _ref1)listener=_ref1[event],_results1.push(elementListeners.element.removeEventListener(event,listener,!1));return _results1}());return _results},Dropzone.prototype.disable=function(){var file,_i,_len,_ref,_results;for(this.clickableElements.forEach(function(element){return element.classList.remove("dz-clickable")}),this.removeEventListeners(),_ref=this.files,_results=[],_i=0,_len=_ref.length;_i<_len;_i++)file=_ref[_i],_results.push(this.cancelUpload(file));return _results},Dropzone.prototype.enable=function(){return this.clickableElements.forEach(function(element){return element.classList.add("dz-clickable")}),this.setupEventListeners()},Dropzone.prototype.filesize=function(size){var cutoff,i,selectedSize,selectedUnit,unit,units,_i,_len;if(selectedSize=0,selectedUnit="b",size>0){for(units=["TB","GB","MB","KB","b"],i=_i=0,_len=units.length;_i<_len;i=++_i)if(unit=units[i],cutoff=Math.pow(this.options.filesizeBase,4-i)/10,size>=cutoff){selectedSize=size/Math.pow(this.options.filesizeBase,4-i),selectedUnit=unit;break}selectedSize=Math.round(10*selectedSize)/10}return"<strong>"+selectedSize+"</strong> "+selectedUnit},Dropzone.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},Dropzone.prototype.drop=function(e){var files,items;e.dataTransfer&&(this.emit("drop",e),files=e.dataTransfer.files,this.emit("addedfiles",files),files.length&&(items=e.dataTransfer.items,items&&items.length&&null!=items[0].webkitGetAsEntry?this._addFilesFromItems(items):this.handleFiles(files)))},Dropzone.prototype.paste=function(e){var items,_ref;if(null!=(null!=e&&null!=(_ref=e.clipboardData)?_ref.items:void 0))return this.emit("paste",e),items=e.clipboardData.items,items.length?this._addFilesFromItems(items):void 0},Dropzone.prototype.handleFiles=function(files){var file,_i,_len,_results;for(_results=[],_i=0,_len=files.length;_i<_len;_i++)file=files[_i],_results.push(this.addFile(file));return _results},Dropzone.prototype._addFilesFromItems=function(items){var entry,item,_i,_len,_results;for(_results=[],_i=0,_len=items.length;_i<_len;_i++)item=items[_i],null!=item.webkitGetAsEntry&&(entry=item.webkitGetAsEntry())?entry.isFile?_results.push(this.addFile(item.getAsFile())):entry.isDirectory?_results.push(this._addFilesFromDirectory(entry,entry.name)):_results.push(void 0):null!=item.getAsFile&&(null==item.kind||"file"===item.kind)?_results.push(this.addFile(item.getAsFile())):_results.push(void 0);return _results},Dropzone.prototype._addFilesFromDirectory=function(directory,path){var dirReader,errorHandler,readEntries;return dirReader=directory.createReader(),errorHandler=function(error){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(error):void 0},(readEntries=function(_this){return function(){return dirReader.readEntries(function(entries){var entry,_i,_len;if(entries.length>0){for(_i=0,_len=entries.length;_i<_len;_i++)entry=entries[_i],entry.isFile?entry.file(function(file){if(!_this.options.ignoreHiddenFiles||"."!==file.name.substring(0,1))return file.fullPath=""+path+"/"+file.name,_this.addFile(file)}):entry.isDirectory&&_this._addFilesFromDirectory(entry,""+path+"/"+entry.name);readEntries()}return null},errorHandler)}}(this))()},Dropzone.prototype.accept=function(file,done){return file.size>1024*this.options.maxFilesize*1024?done(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(file.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):Dropzone.isValidFile(file,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(done(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",file)):this.options.accept.call(this,file,done):done(this.options.dictInvalidFileType)},Dropzone.prototype.addFile=function(file){return file.upload={progress:0,total:file.size,bytesSent:0},this.files.push(file),file.status=Dropzone.ADDED,this.emit("addedfile",file),this._enqueueThumbnail(file),this.accept(file,function(_this){return function(error){return error?(file.accepted=!1,_this._errorProcessing([file],error)):(file.accepted=!0,_this.options.autoQueue&&_this.enqueueFile(file)),_this._updateMaxFilesReachedClass()}}(this))},Dropzone.prototype.enqueueFiles=function(files){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++)file=files[_i],this.enqueueFile(file);return null},Dropzone.prototype.enqueueFile=function(file){
if(file.status!==Dropzone.ADDED||file.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");if(file.status=Dropzone.QUEUED,this.options.autoProcessQueue)return setTimeout(function(_this){return function(){return _this.processQueue()}}(this),0)},Dropzone.prototype._thumbnailQueue=[],Dropzone.prototype._processingThumbnail=!1,Dropzone.prototype._enqueueThumbnail=function(file){if(this.options.createImageThumbnails&&file.type.match(/image.*/)&&file.size<=1024*this.options.maxThumbnailFilesize*1024)return this._thumbnailQueue.push(file),setTimeout(function(_this){return function(){return _this._processThumbnailQueue()}}(this),0)},Dropzone.prototype._processThumbnailQueue=function(){if(!this._processingThumbnail&&0!==this._thumbnailQueue.length)return this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(_this){return function(){return _this._processingThumbnail=!1,_this._processThumbnailQueue()}}(this))},Dropzone.prototype.removeFile=function(file){if(file.status===Dropzone.UPLOADING&&this.cancelUpload(file),this.files=without(this.files,file),this.emit("removedfile",file),0===this.files.length)return this.emit("reset")},Dropzone.prototype.removeAllFiles=function(cancelIfNecessary){var file,_i,_len,_ref;for(null==cancelIfNecessary&&(cancelIfNecessary=!1),_ref=this.files.slice(),_i=0,_len=_ref.length;_i<_len;_i++)file=_ref[_i],(file.status!==Dropzone.UPLOADING||cancelIfNecessary)&&this.removeFile(file);return null},Dropzone.prototype.createThumbnail=function(file,callback){var fileReader;return fileReader=new FileReader,fileReader.onload=function(_this){return function(){return"image/svg+xml"===file.type?(_this.emit("thumbnail",file,fileReader.result),void(null!=callback&&callback())):_this.createThumbnailFromUrl(file,fileReader.result,callback)}}(this),fileReader.readAsDataURL(file)},Dropzone.prototype.createThumbnailFromUrl=function(file,imageUrl,callback,crossOrigin){var img;return img=document.createElement("img"),crossOrigin&&(img.crossOrigin=crossOrigin),img.onload=function(_this){return function(){var canvas,ctx,resizeInfo,thumbnail,_ref,_ref1,_ref2,_ref3;if(file.width=img.width,file.height=img.height,resizeInfo=_this.options.resize.call(_this,file),null==resizeInfo.trgWidth&&(resizeInfo.trgWidth=resizeInfo.optWidth),null==resizeInfo.trgHeight&&(resizeInfo.trgHeight=resizeInfo.optHeight),canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),canvas.width=resizeInfo.trgWidth,canvas.height=resizeInfo.trgHeight,drawImageIOSFix(ctx,img,null!=(_ref=resizeInfo.srcX)?_ref:0,null!=(_ref1=resizeInfo.srcY)?_ref1:0,resizeInfo.srcWidth,resizeInfo.srcHeight,null!=(_ref2=resizeInfo.trgX)?_ref2:0,null!=(_ref3=resizeInfo.trgY)?_ref3:0,resizeInfo.trgWidth,resizeInfo.trgHeight),thumbnail=canvas.toDataURL("image/png"),_this.emit("thumbnail",file,thumbnail),null!=callback)return callback()}}(this),null!=callback&&(img.onerror=callback),img.src=imageUrl},Dropzone.prototype.processQueue=function(){var i,parallelUploads,processingLength,queuedFiles;if(parallelUploads=this.options.parallelUploads,processingLength=this.getUploadingFiles().length,i=processingLength,!(processingLength>=parallelUploads)&&(queuedFiles=this.getQueuedFiles(),queuedFiles.length>0)){if(this.options.uploadMultiple)return this.processFiles(queuedFiles.slice(0,parallelUploads-processingLength));for(;i<parallelUploads;){if(!queuedFiles.length)return;this.processFile(queuedFiles.shift()),i++}}},Dropzone.prototype.processFile=function(file){return this.processFiles([file])},Dropzone.prototype.processFiles=function(files){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++)file=files[_i],file.processing=!0,file.status=Dropzone.UPLOADING,this.emit("processing",file);return this.options.uploadMultiple&&this.emit("processingmultiple",files),this.uploadFiles(files)},Dropzone.prototype._getFilesWithXhr=function(xhr){var file,files;return files=function(){var _i,_len,_ref,_results;for(_ref=this.files,_results=[],_i=0,_len=_ref.length;_i<_len;_i++)file=_ref[_i],file.xhr===xhr&&_results.push(file);return _results}.call(this)},Dropzone.prototype.cancelUpload=function(file){var groupedFile,groupedFiles,_i,_j,_len,_len1,_ref;if(file.status===Dropzone.UPLOADING){for(groupedFiles=this._getFilesWithXhr(file.xhr),_i=0,_len=groupedFiles.length;_i<_len;_i++)groupedFile=groupedFiles[_i],groupedFile.status=Dropzone.CANCELED;for(file.xhr.abort(),_j=0,_len1=groupedFiles.length;_j<_len1;_j++)groupedFile=groupedFiles[_j],this.emit("canceled",groupedFile);this.options.uploadMultiple&&this.emit("canceledmultiple",groupedFiles)}else(_ref=file.status)!==Dropzone.ADDED&&_ref!==Dropzone.QUEUED||(file.status=Dropzone.CANCELED,this.emit("canceled",file),this.options.uploadMultiple&&this.emit("canceledmultiple",[file]));if(this.options.autoProcessQueue)return this.processQueue()},resolveOption=function(){var args,option;return option=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],"function"==typeof option?option.apply(this,args):option},Dropzone.prototype.uploadFile=function(file){return this.uploadFiles([file])},Dropzone.prototype.uploadFiles=function(files){var file,formData,handleError,headerName,headerValue,headers,i,input,inputName,inputType,key,method,option,progressObj,response,updateProgress,url,value,xhr,_i,_j,_k,_l,_len,_len1,_len2,_len3,_m,_ref,_ref1,_ref2,_ref3,_ref4,_ref5;for(xhr=new XMLHttpRequest,_i=0,_len=files.length;_i<_len;_i++)file=files[_i],file.xhr=xhr;method=resolveOption(this.options.method,files),url=resolveOption(this.options.url,files),xhr.open(method,url,!0),xhr.withCredentials=!!this.options.withCredentials,response=null,handleError=function(_this){return function(){var _j,_len1,_results;for(_results=[],_j=0,_len1=files.length;_j<_len1;_j++)file=files[_j],_results.push(_this._errorProcessing(files,response||_this.options.dictResponseError.replace("{{statusCode}}",xhr.status),xhr));return _results}}(this),updateProgress=function(_this){return function(e){var allFilesFinished,progress,_j,_k,_l,_len1,_len2,_len3,_results;if(null!=e)for(progress=100*e.loaded/e.total,_j=0,_len1=files.length;_j<_len1;_j++)file=files[_j],file.upload={progress:progress,total:e.total,bytesSent:e.loaded};else{for(allFilesFinished=!0,progress=100,_k=0,_len2=files.length;_k<_len2;_k++)file=files[_k],100===file.upload.progress&&file.upload.bytesSent===file.upload.total||(allFilesFinished=!1),file.upload.progress=progress,file.upload.bytesSent=file.upload.total;if(allFilesFinished)return}for(_results=[],_l=0,_len3=files.length;_l<_len3;_l++)file=files[_l],_results.push(_this.emit("uploadprogress",file,progress,file.upload.bytesSent));return _results}}(this),xhr.onload=function(_this){return function(e){var _ref;if(files[0].status!==Dropzone.CANCELED&&4===xhr.readyState){if(response=xhr.responseText,xhr.getResponseHeader("content-type")&&~xhr.getResponseHeader("content-type").indexOf("application/json"))try{response=JSON.parse(response)}catch(_error){e=_error,response="Invalid JSON response from server."}return updateProgress(),200<=(_ref=xhr.status)&&_ref<300?_this._finished(files,response,e):handleError()}}}(this),xhr.onerror=function(_this){return function(){if(files[0].status!==Dropzone.CANCELED)return handleError()}}(this),progressObj=null!=(_ref=xhr.upload)?_ref:xhr,progressObj.onprogress=updateProgress,headers={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&extend(headers,this.options.headers);for(headerName in headers)headerValue=headers[headerName],headerValue&&xhr.setRequestHeader(headerName,headerValue);if(formData=new FormData,this.options.params){_ref1=this.options.params;for(key in _ref1)value=_ref1[key],formData.append(key,value)}for(_j=0,_len1=files.length;_j<_len1;_j++)file=files[_j],this.emit("sending",file,xhr,formData);if(this.options.uploadMultiple&&this.emit("sendingmultiple",files,xhr,formData),"FORM"===this.element.tagName)for(_ref2=this.element.querySelectorAll("input, textarea, select, button"),_k=0,_len2=_ref2.length;_k<_len2;_k++)if(input=_ref2[_k],inputName=input.getAttribute("name"),inputType=input.getAttribute("type"),"SELECT"===input.tagName&&input.hasAttribute("multiple"))for(_ref3=input.options,_l=0,_len3=_ref3.length;_l<_len3;_l++)option=_ref3[_l],option.selected&&formData.append(inputName,option.value);else(!inputType||"checkbox"!==(_ref4=inputType.toLowerCase())&&"radio"!==_ref4||input.checked)&&formData.append(inputName,input.value);for(i=_m=0,_ref5=files.length-1;0<=_ref5?_m<=_ref5:_m>=_ref5;i=0<=_ref5?++_m:--_m)formData.append(this._getParamName(i),files[i],this._renameFilename(files[i].name));return this.submitRequest(xhr,formData,files)},Dropzone.prototype.submitRequest=function(xhr,formData,files){return xhr.send(formData)},Dropzone.prototype._finished=function(files,responseText,e){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++)file=files[_i],file.status=Dropzone.SUCCESS,this.emit("success",file,responseText,e),this.emit("complete",file);if(this.options.uploadMultiple&&(this.emit("successmultiple",files,responseText,e),this.emit("completemultiple",files)),this.options.autoProcessQueue)return this.processQueue()},Dropzone.prototype._errorProcessing=function(files,message,xhr){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++)file=files[_i],file.status=Dropzone.ERROR,this.emit("error",file,message,xhr),this.emit("complete",file);if(this.options.uploadMultiple&&(this.emit("errormultiple",files,message,xhr),this.emit("completemultiple",files)),this.options.autoProcessQueue)return this.processQueue()},Dropzone}(Emitter),Dropzone.version="4.3.0",Dropzone.options={},Dropzone.optionsForElement=function(element){return element.getAttribute("id")?Dropzone.options[camelize(element.getAttribute("id"))]:void 0},Dropzone.instances=[],Dropzone.forElement=function(element){if("string"==typeof element&&(element=document.querySelector(element)),null==(null!=element?element.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return element.dropzone},Dropzone.autoDiscover=!0,Dropzone.discover=function(){var checkElements,dropzone,dropzones,_i,_len,_results;for(document.querySelectorAll?dropzones=document.querySelectorAll(".dropzone"):(dropzones=[],checkElements=function(elements){var el,_i,_len,_results;for(_results=[],_i=0,_len=elements.length;_i<_len;_i++)el=elements[_i],/(^| )dropzone($| )/.test(el.className)?_results.push(dropzones.push(el)):_results.push(void 0);return _results},checkElements(document.getElementsByTagName("div")),checkElements(document.getElementsByTagName("form"))),_results=[],_i=0,_len=dropzones.length;_i<_len;_i++)dropzone=dropzones[_i],Dropzone.optionsForElement(dropzone)!==!1?_results.push(new Dropzone(dropzone)):_results.push(void 0);return _results},Dropzone.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],Dropzone.isBrowserSupported=function(){var capableBrowser,regex,_i,_len,_ref;if(capableBrowser=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(_ref=Dropzone.blacklistedBrowsers,_i=0,_len=_ref.length;_i<_len;_i++)regex=_ref[_i],regex.test(navigator.userAgent)&&(capableBrowser=!1);else capableBrowser=!1;else capableBrowser=!1;return capableBrowser},without=function(list,rejectedItem){var item,_i,_len,_results;for(_results=[],_i=0,_len=list.length;_i<_len;_i++)item=list[_i],item!==rejectedItem&&_results.push(item);return _results},camelize=function(str){return str.replace(/[\-_](\w)/g,function(match){return match.charAt(1).toUpperCase()})},Dropzone.createElement=function(string){var div;return div=document.createElement("div"),div.innerHTML=string,div.childNodes[0]},Dropzone.elementInside=function(element,container){if(element===container)return!0;for(;element=element.parentNode;)if(element===container)return!0;return!1},Dropzone.getElement=function(el,name){var element;if("string"==typeof el?element=document.querySelector(el):null!=el.nodeType&&(element=el),null==element)throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector or a plain HTML element.");return element},Dropzone.getElements=function(els,name){var e,el,elements,_i,_j,_len,_len1,_ref;if(els instanceof Array){elements=[];try{for(_i=0,_len=els.length;_i<_len;_i++)el=els[_i],elements.push(this.getElement(el,name))}catch(_error){e=_error,elements=null}}else if("string"==typeof els)for(elements=[],_ref=document.querySelectorAll(els),_j=0,_len1=_ref.length;_j<_len1;_j++)el=_ref[_j],elements.push(el);else null!=els.nodeType&&(elements=[els]);if(null==elements||!elements.length)throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return elements},Dropzone.confirm=function(question,accepted,rejected){return window.confirm(question)?accepted():null!=rejected?rejected():void 0},Dropzone.isValidFile=function(file,acceptedFiles){var baseMimeType,mimeType,validType,_i,_len;if(!acceptedFiles)return!0;for(acceptedFiles=acceptedFiles.split(","),mimeType=file.type,baseMimeType=mimeType.replace(/\/.*$/,""),_i=0,_len=acceptedFiles.length;_i<_len;_i++)if(validType=acceptedFiles[_i],validType=validType.trim(),"."===validType.charAt(0)){if(file.name.toLowerCase().indexOf(validType.toLowerCase(),file.name.length-validType.length)!==-1)return!0}else if(/\/\*$/.test(validType)){if(baseMimeType===validType.replace(/\/.*$/,""))return!0}else if(mimeType===validType)return!0;return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(options){return this.each(function(){return new Dropzone(this,options)})}),"undefined"!=typeof module&&null!==module?module.exports=Dropzone:window.Dropzone=Dropzone,Dropzone.ADDED="added",Dropzone.QUEUED="queued",Dropzone.ACCEPTED=Dropzone.QUEUED,Dropzone.UPLOADING="uploading",Dropzone.PROCESSING=Dropzone.UPLOADING,Dropzone.CANCELED="canceled",Dropzone.ERROR="error",Dropzone.SUCCESS="success",detectVerticalSquash=function(img){var alpha,canvas,ctx,data,ey,ih,iw,py,ratio,sy;for(iw=img.naturalWidth,ih=img.naturalHeight,canvas=document.createElement("canvas"),canvas.width=1,canvas.height=ih,ctx=canvas.getContext("2d"),ctx.drawImage(img,0,0),data=ctx.getImageData(0,0,1,ih).data,sy=0,ey=ih,py=ih;py>sy;)alpha=data[4*(py-1)+3],0===alpha?ey=py:sy=py,py=ey+sy>>1;return ratio=py/ih,0===ratio?1:ratio},drawImageIOSFix=function(ctx,img,sx,sy,sw,sh,dx,dy,dw,dh){var vertSquashRatio;return vertSquashRatio=detectVerticalSquash(img),ctx.drawImage(img,sx,sy,sw,sh,dx,dy,dw,dh/vertSquashRatio)},contentLoaded=function(win,fn){var add,doc,done,init,poll,pre,rem,root,top;if(done=!1,top=!0,doc=win.document,root=doc.documentElement,add=doc.addEventListener?"addEventListener":"attachEvent",rem=doc.addEventListener?"removeEventListener":"detachEvent",pre=doc.addEventListener?"":"on",init=function(e){if("readystatechange"!==e.type||"complete"===doc.readyState)return("load"===e.type?win:doc)[rem](pre+e.type,init,!1),!done&&(done=!0)?fn.call(win,e.type||e):void 0},poll=function(){var e;try{root.doScroll("left")}catch(_error){return e=_error,void setTimeout(poll,50)}return init("poll")},"complete"!==doc.readyState){if(doc.createEventObject&&root.doScroll){try{top=!win.frameElement}catch(_error){}top&&poll()}return doc[add](pre+"DOMContentLoaded",init,!1),doc[add](pre+"readystatechange",init,!1),win[add](pre+"load",init,!1)}},Dropzone._autoDiscoverFunction=function(){if(Dropzone.autoDiscover)return Dropzone.discover()},contentLoaded(window,Dropzone._autoDiscoverFunction)}.call(this),module.exports}),define("text!mockup-patterns-upload-url/templates/upload.xml",[],function(){return'<div class="upload-container upload-multiple">\n    <h2 class="title"><%- _t("Upload here") %></h2>\n    <p class="help">\n        <%- _t(\'Drag and drop files from your computer onto the area below or click the "Browse" button.\') %>\n    </p>\n    <div class="upload-area">\n        <div class="fallback">\n            <input name="file" type="file" multiple />\n        </div>\n        <div class="dz-message"><p><%-_t("Drop files here...")%></p></div>\n        <div class="row browse-select">\n            <div class="col-md-9">\n                <input\n                    id="fakeUploadFile"\n                    placeholder="<%- _t("Choose File") %>"\n                    disabled="disabled"\n                    />\n            </div>\n            <div class="col-md-3">\n                <button\n                    type="button"\n                    class="btn btn-primary browse">\n                    Browse\n                </button>\n            </div>\n        </div>\n        <div class="upload-queue">\n            <div class="previews">\n            </div>\n            <div class="controls">\n                <% if (allowPathSelection) { %>\n                <div class="path">\n                    <label><%- _t("Upload to...") %></label>\n                    <p class="form-help">\n                        <%- _t("Select another destination folder or leave blank to add files to the current location.") %>\n                    </p>\n                    <input\n                        type="text"\n                        name="location"\n                        />\n                </div>\n                <% } %>\n                <div class="actions row">\n                    <div class="col-md-9">\n                        <div class="progress progress-striped active">\n                            <div class="progress-bar progress-bar-success"\n                                 role="progressbar"\n                                 aria-valuenow="0"\n                                 aria-valuemin="0"\n                                 aria-valuemax="100"\n                                 style="width: 0%">\n                                <span class="sr-only">40% Complete (success)</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-md-3 align-right">\n                        <button\n                            type="button"\n                            class="btn btn-primary upload-all">\n                            <%- _t("Upload") %>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("text!mockup-patterns-upload-url/templates/preview.xml",[],function(){return'<div class="row item form-inline">\n    <div class="col-md-1 action">\n        <button\n            type="button"\n            class="btn btn-danger btn-xs remove-item"\n            data-dz-remove=""\n            href="javascript:undefined;">\n            <span class="glyphicon glyphicon-remove"></span>\n        </button>\n    </div>\n    <div class="col-md-8 title">\n        <div class="dz-preview">\n          <div class="dz-details">\n            <div class="dz-filename"><span data-dz-name></span></div>\n          </div>\n          <div class="dz-error-message"><span data-dz-errormessage></span></div>\n        </div>\n        <div class="dz-progress">\n            <span class="dz-upload" data-dz-uploadprogress></span>\n        </div>\n    </div>\n    <div class="col-md-3 info">\n        <div class="dz-size" data-dz-size></div>\n        <img data-dz-thumbnail />\n    </div>\n</div>\n'}),define("mockup-patterns-upload",["jquery","underscore","pat-base","mockup-patterns-relateditems","dropzone","text!mockup-patterns-upload-url/templates/upload.xml","text!mockup-patterns-upload-url/templates/preview.xml","translate"],function($,_,Base,RelatedItems,Dropzone,UploadTemplate,PreviewTemplate,_t){"use strict";Dropzone.autoDiscover=!1;var UploadPattern=Base.extend({name:"upload",trigger:".pat-upload",parser:"mockup",defaults:{showTitle:!0,url:null,className:"upload",wrap:!1,wrapperTemplate:'<div class="upload-wrapper"/>',fileaddedClassName:"dropping",useTus:!1,container:"",ajaxUpload:!0,paramName:"file",addRemoveLinks:!1,autoCleanResults:!0,previewsContainer:".previews",previewTemplate:null,maxFiles:null,maxFilesize:99999999,allowPathSelection:void 0,relatedItems:{attributes:["UID","Title","Description","getURL","portal_type","path","ModificationDate"],batchSize:20,basePath:"/",vocabularyUrl:null,width:500,maximumSelectionSize:1,selectableTypes:["Folder"]}},init:function(){var self=this,template=UploadTemplate;"undefined"==typeof self.options.allowPathSelection&&(self.options.allowPathSelection=self.options.baseUrl&&self.options.relativePath),$(document).bind("paste",function(e){var oe=e.originalEvent,items=oe.clipboardData.items;if(items)for(var i=0;i<items.length;i++)if(items[i].type.indexOf("image")!==-1){var blob=items[i].getAsFile();self.dropzone.addFile(blob)}}),self.currentPath=self.options.currentPath,self.currentFile=0,template=_.template(template)({_t:_t,allowPathSelection:self.options.allowPathSelection}),self.$el.addClass(self.options.className),self.$el.append(template),self.$progress=$(".progress-bar-success",self.$el),self.options.showTitle||self.$el.find("h2.title").hide(),self.options.ajaxUpload||($(".fallback",this.$el).remove(),this.$el.hasClass(".upload-container")?this.$el.addClass("no-ajax-upload"):this.$el.closest(".upload-container").addClass("no-ajax-upload")),self.options.wrap&&(self.$el.wrap(self.options.wrapperTemplate),self.$el=self.$el.parent()),self.options.allowPathSelection?(self.$pathInput=$('input[name="location"]',self.$el),self.relatedItems=self.setupRelatedItems(self.$pathInput)):($('input[name="location"]',self.$el).parent().remove(),self.relatedItems=null),self.$dropzone=$(".upload-area",self.$el),$("div.browse-select button.browse",self.$el).click(function(e){e.preventDefault(),e.stopPropagation(),(!self.options.maxFiles||self.dropzone.files.length<self.options.maxFiles)&&self.dropzone.hiddenFileInput.click()});var dzoneOptions=this.getDzoneOptions();try{self.dropzone=new Dropzone(self.$dropzone[0],dzoneOptions)}catch(e){throw window.DEBUG&&console.log(e),e}self.dropzone.on("maxfilesreached",function(){self.showHideControls()}),self.dropzone.on("addedfile",function(){self.showHideControls()}),self.dropzone.on("removedfile",function(){self.showHideControls()}),self.dropzone.on("success",function(e,response){var data;try{data=$.parseJSON(response)}catch(ex){data=response}self.$el.trigger("uploadAllCompleted",{data:data,path_uid:self.$pathInput?self.$pathInput.val():null})}),self.options.autoCleanResults&&self.dropzone.on("complete",function(file){file.status===Dropzone.SUCCESS&&setTimeout(function(){$(file.previewElement).fadeOut()},3e3)}),self.dropzone.on("complete",function(file){file.status===Dropzone.SUCCESS&&1===self.dropzone.files.length&&self.showHideControls()}),self.dropzone.on("error",function(file,response,xmlhr){"undefined"!=typeof xmlhr&&403!==xmlhr.status&&$(".dz-error-message span",file.previewElement).html(_t("The file transfer failed"))}),self.dropzone.on("totaluploadprogress",function(pct){pct=(100*(self.currentFile-1)+pct)/(100*self.dropzone.files.length)*100,self.$progress.attr("aria-valuenow",pct).css("width",pct+"%")}),$(".upload-all",self.$el).click(function(e){e.preventDefault(),e.stopPropagation(),self.processUpload({finished:function(){self.$progress.attr("aria-valuenow",0).css("width","0%")}})}),self.options.clipboardfile&&self.dropzone.addFile(self.options.clipboardfile)},showHideControls:function(){var self=this;self._showHideTimeout&&clearTimeout(self._showHideTimeout),self._showHideTimeout=setTimeout(function(){self._showHideControls()},50)},_showHideControls:function(){var self=this,$controls=$(".controls",self.$el),$browse=$(".browse-select",self.$el),$input=$(".dz-hidden-input");if(self.options.maxFiles&&(self.dropzone.files.length<self.options.maxFiles?($browse.show(),$input.prop("disabled",!1)):($browse.hide(),$input.prop("disabled",!0))),self.dropzone.files.length>0){$controls.fadeIn("slow");var file=self.dropzone.files[0];$(".dz-error-message span",file.previewElement).html("")}else $controls.fadeOut("slow")},pathJoin:function(){var parts=[];return _.each(arguments,function(part){part&&("/"===part[0]&&(part=part.substring(1)),"/"===part[part.length-1]&&(part=part.substring(0,part.length-1)),parts.push(part))}),parts.join("/")},getUrl:function(){var self=this,url=self.options.url;if(!url)if(self.options.baseUrl&&self.options.relativePath)url=self.options.baseUrl,"/"!==url[url.length-1]&&(url+="/"),url+=self.pathJoin(self.currentPath,self.options.relativePath);else{var $form=self.$el.parents("form");url=$form.length>0?$form.attr("action"):window.location.href}return url},getDzoneOptions:function(){var self=this;self.options.clickable=!0;var options=$.extend({},self.options);if(options.url=self.getUrl(),options.uploadMultiple=!1,delete options.wrap,delete options.wrapperTemplate,delete options.resultTemplate,delete options.autoCleanResults,delete options.fileaddedClassName,delete options.useTus,self.options.previewsContainer){var $preview=self.$el.find(self.options.previewsContainer);$preview.length>0&&(options.previewsContainer=$preview[0])}return options.autoProcessQueue=!1,options.previewTemplate=PreviewTemplate,options},processUpload:function(options){function process(){processing=!0,0===self.dropzone.files.length&&(processing=!1);var file=self.dropzone.files[0];return processing&&file.status===Dropzone.ERROR&&(file.status=Dropzone.QUEUED,processing=!1),processing?void([Dropzone.SUCCESS,Dropzone.CANCELED].indexOf(file.status)!==-1?(self.dropzone.removeFile(file),process()):file.status!==Dropzone.UPLOADING?(useTus&&window.tus?self.handleTusUpload(file):(self.currentFile+=1,self.dropzone.processFile(file)),setTimeout(process,100)):setTimeout(process,100)):(self.$el.removeClass(fileaddedClassName),void(void 0!==finished&&"function"==typeof finished&&finished()))}options||(options={});var self=this,processing=!1,useTus=self.options.useTus,fileaddedClassName=self.options.fileaddedClassName,finished=options.finished;self.currentFile=0,process()},handleTusUpload:function(file){var self=this,chunkSize=($(file.previewElement),5242880);file.status=Dropzone.UPLOADING,window.tus.upload(file,{endpoint:self.dropzone.options.url,headers:{FILENAME:file.name},chunkSize:chunkSize}).fail(function(){window.DEBUG&&console.alert(_t("Error uploading with TUS resumable uploads")),file.status=Dropzone.ERROR}).progress(function(e,bytesUploaded,bytesTotal){var percentage=bytesUploaded/bytesTotal*100;self.$progress.attr("aria-valuenow",percentage).css("width",percentage+"%"),self.$progress.html(_t("uploading...")+"<br />"+self.formatBytes(bytesUploaded)+" / "+self.formatBytes(bytesTotal))}).done(function(url,file){file.status=Dropzone.SUCCESS,self.dropzone.emit("success",file),self.dropzone.emit("complete",file)})},formatBytes:function(bytes){var kb=Math.round(bytes/1024);if(kb<1024)return kb+" KiB";var mb=Math.round(kb/1024);return mb<1024?mb+" MB":Math.round(mb/1024)+" GB"},setPath:function(path){var self=this;self.currentPath=path,self.options.url=null,self.options.url=self.dropzone.options.url=self.getUrl()},setupRelatedItems:function($input){var self=this,options=self.options.relatedItems;options.upload=!1,self.options.initialFolder&&$input.attr("value",self.options.initialFolder);var ri=new RelatedItems($input,options);return ri.$el.on("change",function(){var result=$(this).select2("data"),path=null;result.length>0&&(path=result[0].path),self.setPath(path)}),ri}});return UploadPattern}),define("mockup-patterns-tinymce-url/js/links",["jquery","underscore","pat-registry","pat-base","tinymce","text!mockup-patterns-tinymce-url/templates/link.xml","text!mockup-patterns-tinymce-url/templates/image.xml","mockup-patterns-relateditems","mockup-patterns-autotoc","mockup-patterns-modal","mockup-patterns-upload"],function($,_,registry,Base,tinymce,LinkTemplate,ImageTemplate,RelatedItems){"use strict";var LinkType=Base.extend({defaults:{linkModal:null},init:function(){this.linkModal=this.options.linkModal,this.tinypattern=this.options.tinypattern,this.tiny=this.tinypattern.tiny,this.dom=this.tiny.dom},getEl:function(){return this.$el.find("input")},value:function(){return $.trim(this.getEl().val())},toUrl:function(){return this.value()},load:function(element){this.getEl().attr("value",this.tiny.dom.getAttrib(element,"data-val"))},set:function(val){var $el=this.getEl();$el.attr("value",val),$el.val(val)},attributes:function(){return{"data-val":this.value()}}}),ExternalLink=LinkType.extend({init:function(){LinkType.prototype.init.call(this),this.getEl().on("change",function(){var val=$(this).val();if(!new RegExp("https?://").test(val)){var domain=$(this).val().split("/")[0];domain.indexOf(".")!==-1&&$(this).val("http://"+val)}})}}),InternalLink=LinkType.extend({init:function(){LinkType.prototype.init.call(this),this.getEl().addClass("pat-relateditems"),this.createRelatedItems()},getEl:function(){return this.$el.find("input:not(.select2-input)")},createRelatedItems:function(){var options=this.tinypattern.options.relatedItems;options.upload=!1,this.relatedItems=new RelatedItems(this.getEl(),options)},value:function(){var val=this.getEl().select2("data");return val&&"object"==typeof val&&(val=val[0]),val},toUrl:function(){var value=this.value();return value?this.tinypattern.generateUrl(value):null},load:function(element){var val=this.tiny.dom.getAttrib(element,"data-val");val&&this.set(val)},set:function(val){var $el=this.getEl();$el.select2("destroy"),$el.removeData("pattern-relateditems"),$el.parent().replaceWith($el),$el.attr("value",val),$el.val(val),this.createRelatedItems()},attributes:function(){var val=this.value();return val?{"data-val":val.UID}:{}}}),UploadLink=LinkType.extend({getDelegatedLinkType:function(){return"uploadImage"===this.linkModal.linkType?this.linkModal.linkTypes.image:this.linkModal.linkTypes.internal},toUrl:function(){return this.getDelegatedLinkType().toUrl()},attributes:function(){return this.getDelegatedLinkType().attributes()},set:function(val){return this.getDelegatedLinkType().set(val)},load:function(element){return this.getDelegatedLinkType().load(element)},value:function(){return this.getDelegatedLinkType().value()}}),ImageLink=InternalLink.extend({toUrl:function(){var value=this.value();return this.tinypattern.generateImageUrl(value,this.linkModal.$scale.val())}}),EmailLink=LinkType.extend({toUrl:function(){var self=this,val=self.value();if(val){var subject=self.getSubject(),href="mailto:"+val;return subject&&(href+="?subject="+subject),href}return null},load:function(element){LinkType.prototype.load.apply(this,[element]),this.linkModal.$subject.val(this.tiny.dom.getAttrib(element,"data-subject"))},getSubject:function(){return this.linkModal.$subject.val()},attributes:function(){var attribs=LinkType.prototype.attributes.call(this);return attribs["data-subject"]=this.getSubject(),attribs}}),AnchorLink=LinkType.extend({init:function(){LinkType.prototype.init.call(this),this.$select=this.$el.find("select"),this.anchorNodes=[],this.anchorData=[],this.populate()},value:function(){var val=this.$select.select2("data");return val&&"object"==typeof val&&(val=val.id),val},populate:function(){var self=this;self.$select.find("option").remove(),self.anchorNodes=[],self.anchorData=[];var node,i,j,name,title,nodes=self.tiny.dom.select("a.mceItemAnchor,img.mceItemAnchor,a.mce-item-anchor,img.mce-item-anchor");for(i=0;i<nodes.length;i+=1)node=nodes[i],name=self.tiny.dom.getAttrib(node,"name"),name||(name=self.tiny.dom.getAttrib(node,"id")),""!==name&&(self.anchorNodes.push(node),self.anchorData.push({name:name,title:name}));if(nodes=self.tiny.dom.select(self.linkModal.options.anchorSelector),nodes.length>0)for(i=0;i<nodes.length;i+=1)if(node=nodes[i],title=$(node).text().replace(/^\s+|\s+$/g,""),
""!==title){name=title.toLowerCase().substring(0,1024),name=name.replace(/[^a-z0-9]/g,"-");var found=!1;for(j=0;j<self.anchorNodes.length;j+=1){var anode=self.anchorData[j];if(anode.name===name){found=!0,anode.title=title;break}}found||(self.anchorData.push({name:name,title:title,newAnchor:!0}),self.anchorNodes.push(node))}if(self.anchorNodes.length>0)for(i=0;i<self.anchorData.length;i+=1){var data=self.anchorData[i];self.$select.append('<option value="'+i+'">'+data.title+"</option>")}else self.$select.append("<option>No anchors found..</option>")},getIndex:function(name){for(var i=0;i<this.anchorData.length;i+=1){var data=this.anchorData[i];if(data.name===name)return i}return 0},toUrl:function(){var val=this.value();if(val){var index=parseInt(val,10),node=this.anchorNodes[index],data=this.anchorData[index];return data.newAnchor&&(node.innerHTML='<a name="'+data.name+'" class="mce-item-anchor"></a>'+node.innerHTML),"#"+data.name}return null},set:function(val){var anchor=this.getIndex(val);this.$select.select2("data",""+anchor)}});tinymce.PluginManager.add("ploneimage",function(editor){editor.addButton("ploneimage",{icon:"image",tooltip:"Insert/edit image",onclick:editor.settings.addImageClicked,stateSelector:"img:not([data-mce-object])"}),editor.addMenuItem("ploneimage",{icon:"image",text:"Insert image",onclick:editor.settings.addImageClicked,context:"insert",prependToContext:!0})}),tinymce.PluginManager.add("plonelink",function(editor){editor.addButton("plonelink",{icon:"link",tooltip:"Insert/edit link",shortcut:"Ctrl+K",onclick:editor.settings.addLinkClicked,stateSelector:"a[href]"}),editor.addButton("unlink",{icon:"unlink",tooltip:"Remove link(s)",cmd:"unlink",stateSelector:"a[href]"}),editor.addShortcut("Ctrl+K","",editor.settings.addLinkClicked),editor.addMenuItem("plonelink",{icon:"link",text:"Insert link",shortcut:"Ctrl+K",onclick:editor.settings.addLinkClicked,stateSelector:"a[href]",context:"insert",prependToContext:!0})});var LinkModal=Base.extend({name:"linkmodal",trigger:".pat-linkmodal",defaults:{anchorSelector:"h1,h2,h3",linkTypes:[],initialLinkType:"internal",text:{insertHeading:"Insert Link"},linkTypeClassMapping:{internal:InternalLink,upload:UploadLink,external:ExternalLink,email:EmailLink,anchor:AnchorLink,image:ImageLink,uploadImage:UploadLink,externalImage:LinkType}},linkTypeTemplateMapping:{internal:LinkTemplate,upload:LinkTemplate,external:LinkTemplate,email:LinkTemplate,anchor:LinkTemplate,image:ImageTemplate,uploadImage:ImageTemplate,externalImage:ImageTemplate},template:function(data){return _.template(this.linkTypeTemplateMapping[this.linkType])(data)},init:function(){var self=this;self.tinypattern=self.options.tinypattern,self.tinypattern.options.anchorSelector&&(self.options.anchorSelector=self.tinypattern.options.anchorSelector),self.tiny=self.tinypattern.tiny,self.dom=self.tiny.dom,self.linkType=self.options.initialLinkType,self.linkTypes={},self.modal=registry.patterns["plone-modal"].init(self.$el,{html:self.generateModalHtml(),content:null,buttons:".plone-btn"}),self.modal.on("shown",function(e){self.modalShown.apply(self,[e])})},isOnlyTextSelected:function(){var html=this.tiny.selection.getContent();if(/</.test(html)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(html)||html.indexOf("href=")===-1))return!1;if(this.anchorElm){var nodes=this.anchorElm.childNodes;if(0===nodes.length)return!1;for(var ii=nodes.length-1;ii>=0;ii--)if(3!==nodes[ii].nodeType)return!1}return!0},generateModalHtml:function(){return this.template({options:this.options,upload:this.options.upload,text:this.options.text,insertHeading:this.options.text.insertHeading,linkTypes:this.options.linkTypes,externalText:this.options.text.external,emailText:this.options.text.email,subjectText:this.options.text.subject,targetList:this.options.targetList,titleText:this.options.text.title,externalImageText:this.options.text.externalImage,altText:this.options.text.alt,captionText:this.options.text.caption,imageAlignText:this.options.text.imageAlign,scaleText:this.options.text.scale,imageScales:this.options.imageScales,cancelBtn:this.options.text.cancelBtn,insertBtn:this.options.text.insertBtn})},isImageMode:function(){return["image","uploadImage","externalImage"].indexOf(this.linkType)!==-1},initElements:function(){var self=this;self.$target=$('select[name="target"]',self.modal.$modal),self.$button=$('.plone-modal-footer input[name="insert"]',self.modal.$modal),self.$title=$('input[name="title"]',self.modal.$modal),self.$subject=$('input[name="subject"]',self.modal.$modal),self.$alt=$('input[name="alt"]',self.modal.$modal),self.$caption=$('input[name="caption"]',self.modal.$modal),self.$align=$('select[name="align"]',self.modal.$modal),self.$scale=$('select[name="scale"]',self.modal.$modal),_.each(self.options.linkTypes,function(type){var $container=$(".linkType."+type+" .main",self.modal.$modal);self.linkTypes[type]=new self.options.linkTypeClassMapping[type]($container,{linkModal:self,tinypattern:self.tinypattern})}),$(".autotoc-nav a",self.modal.$modal).click(function(){var $fieldset=$("fieldset.linkType",self.modal.$modal).eq($(this).index()),classes=$fieldset[0].className.split(/\s+/);_.each(classes,function(val){_.indexOf(self.options.linkTypes,val)!==-1&&(self.linkType=val)})})},getLinkUrl:function(){return this.linkTypes[this.linkType].toUrl()},getValue:function(){return this.linkTypes[this.linkType].value()},updateAnchor:function(href){var self=this;self.tiny.focus(),self.tiny.selection.setRng(self.rng);var target=self.$target.val(),title=self.$title.val(),linkAttrs=$.extend(!0,self.data,{title:title?title:null,target:target?target:null,"data-linkType":self.linkType,href:href},self.linkTypes[self.linkType].attributes());self.anchorElm?(self.onlyText&&linkAttrs.text!==self.initialText&&("innerText"in self.anchorElm?self.anchorElm.innerText=self.data.text:self.anchorElm.textContent=self.data.text),self.tiny.dom.setAttribs(self.anchorElm,linkAttrs),self.tiny.selection.select(self.anchorElm),self.tiny.undoManager.add()):self.onlyText?self.tiny.insertContent(self.tiny.dom.createHTML("a",linkAttrs,self.tiny.dom.encode(self.data.text))):self.tiny.execCommand("mceInsertLink",!1,linkAttrs)},focusElement:function(elm){this.tiny.focus(),this.tiny.selection.select(elm),this.tiny.nodeChanged()},updateImage:function(src){function waitLoad(imgElm){imgElm.onload=imgElm.onerror=function(){imgElm.onload=imgElm.onerror=null,self.focusElement(imgElm)}}var self=this,title=self.$title.val();self.tiny.focus(),self.tiny.selection.setRng(self.rng);var data=$.extend(!0,{},{src:src,title:title?title:null,alt:self.$alt.val(),"class":"image-"+self.$align.val(),"data-linkType":self.linkType,"data-scale":self.$scale.val()},self.linkTypes[self.linkType].attributes());""!==self.$caption.val()&&$.extend(data,{"class":"image-"+self.$align.val()+" captioned","data-caption":self.$caption.val()}),self.imgElm&&!self.imgElm.getAttribute("data-mce-object")?(data.width=self.dom.getAttrib(self.imgElm,"width"),data.height=self.dom.getAttrib(self.imgElm,"height")):self.imgElm=null,self.imgElm?self.dom.setAttribs(self.imgElm,data):(data.id="__mcenew",self.tiny.insertContent(self.dom.createHTML("img",data)),self.imgElm=self.dom.get("__mcenew"),self.dom.setAttrib(self.imgElm,"id",null)),waitLoad(self.imgElm),self.imgElm.complete&&self.focusElement(self.imgElm)},modalShown:function(e){var self=this;self.initElements(),self.initData(),self.options.upload&&(self.$upload=$(".uploadify-me",self.modal.$modal),self.options.upload.relatedItems=$.extend(!0,{},self.options.relatedItems),self.options.upload.relatedItems.selectableTypes=self.options.folderTypes,self.$upload.addClass("pat-upload").patternUpload(self.options.upload),self.$upload.on("uploadAllCompleted",function(evt,data){self.linkTypes.image?(self.linkTypes.image.set(data.data.UID),$("#"+$("#tinylink-image",self.modal.$modal).data("navref")).trigger("click")):(self.linkTypes.internal.set(data.data.UID),$("#"+$("#tinylink-internal",self.modal.$modal).data("navref")).trigger("click"))})),self.$button.off("click").on("click",function(e){if(e.preventDefault(),e.stopPropagation(),self.linkType=self.modal.$modal.find("fieldset.active").data("linktype"),"uploadImage"===self.linkType||"upload"===self.linkType){var patUpload=self.$upload.data().patternUpload;patUpload.dropzone.files.length>0&&(patUpload.processUpload(),self.$upload.on("uploadAllCompleted",function(evt,data){var counter=0,checkUpload=function(){if(counter<5&&!self.linkTypes[self.linkType].value())return counter+=1,void setTimeout(checkUpload,100);var href=self.getLinkUrl();self.updateImage(href),self.hide()};checkUpload()}))}var href;try{href=self.getLinkUrl()}catch(error){return}href&&(self.isImageMode()?self.updateImage(href):self.updateAnchor(href),self.hide())}),$('.plone-modal-footer input[name="cancel"]',self.modal.$modal).click(function(e){e.preventDefault(),self.hide()})},show:function(){this.modal.show()},hide:function(){this.modal.hide()},initData:function(){var self=this;self.data={},self.initialText=null;var value;self.rng=self.tiny.selection.getRng(),self.selectedElm=self.tiny.selection.getNode(),self.anchorElm=self.tiny.dom.getParent(self.selectedElm,"a[href]"),self.onlyText=self.isOnlyTextSelected(),self.data.text=self.initialText=self.anchorElm?self.anchorElm.innerText||self.anchorElm.textContent:self.tiny.selection.getContent({format:"text"}),self.data.href=self.anchorElm?self.tiny.dom.getAttrib(self.anchorElm,"href"):"",self.anchorElm?self.data.target=self.tiny.dom.getAttrib(self.anchorElm,"target"):self.tiny.settings.default_link_target&&(self.data.target=self.tiny.settings.default_link_target),(value=self.tiny.dom.getAttrib(self.anchorElm,"rel"))&&(self.data.rel=value),(value=self.tiny.dom.getAttrib(self.anchorElm,"class"))&&(self.data["class"]=value),(value=self.tiny.dom.getAttrib(self.anchorElm,"title"))&&(self.data.title=value),self.selection=self.tiny.selection,self.tiny.focus();var selectedElm=self.imgElm=self.selection.getNode();self.anchorElm=self.dom.getParent(selectedElm,"a[href]");var linkType;if(self.isImageMode()){if("IMG"!==self.imgElm.nodeName&&self.anchorElm){var imgs=self.anchorElm.getElementsByTagName("img");imgs.length>0&&(self.imgElm=imgs[0],self.focusElement(self.imgElm))}if("IMG"!==self.imgElm.nodeName&&(self.imgElm=null),self.imgElm){var src=self.dom.getAttrib(self.imgElm,"src");if(self.$title.val(self.dom.getAttrib(self.imgElm,"title")),self.$alt.val(self.dom.getAttrib(self.imgElm,"alt")),self.$caption.val(self.dom.getAttrib(self.imgElm,"data-caption")),linkType=self.dom.getAttrib(self.imgElm,"data-linktype")){self.linkType=linkType,self.linkTypes[self.linkType].load(self.imgElm);var scale=self.dom.getAttrib(self.imgElm,"data-scale");scale&&self.$scale.val(scale),$("#tinylink-"+self.linkType,self.modal.$modal).trigger("click")}else src&&self.guessImageLink(src);for(var className=self.dom.getAttrib(self.imgElm,"class"),klasses=className.split(" "),i=0;i<klasses.length;i+=1){var klass=klasses[i];klass.indexOf("image-")!==-1&&self.$align.val(klass.replace("image-",""))}}}else if(self.anchorElm){self.focusElement(self.anchorElm);var href="";href=self.dom.getAttrib(self.anchorElm,"href"),self.$target.val(self.dom.getAttrib(self.anchorElm,"target")),self.$title.val(self.dom.getAttrib(self.anchorElm,"title")),linkType=self.dom.getAttrib(self.anchorElm,"data-linktype"),linkType?(self.linkType=linkType,self.linkTypes[self.linkType].load(self.anchorElm),$("#tinylink-"+self.linkType,self.modal.$modal).trigger("click")):href&&self.guessAnchorLink(href)}},guessImageLink:function(src){src.indexOf(this.options.prependToScalePart)!==-1?(this.linkType="image",this.$scale.val(this.tinypattern.getScaleFromUrl(src)),this.linkTypes.image.set(this.tinypattern.stripGeneratedUrl(src))):(this.linkType="externalImage",this.linkTypes.externalImage.set(src))},guessAnchorLink:function(href){if(this.options.prependToUrl&&href.indexOf(this.options.prependToUrl)!==-1)this.linkType="internal",this.linkTypes.internal.set(this.tinypattern.stripGeneratedUrl(href));else if(href.indexOf("mailto:")!==-1){this.linkType="email";var email=href.substring("mailto:".length,href.length),split=email.split("?subject=");this.linkTypes.email.set(split[0]),split.length>1&&this.$subject.val(decodeURIComponent(split[1]))}else"#"===href[0]?(this.linkType="anchor",this.linkTypes.anchor.set(href.substring(1))):(this.linkType="external",this.linkTypes.external.set(href))},setSelectElement:function($el,val){$el.find("option:selected").prop("selected",!1),val&&$el.find('option[value="'+val+'"]').prop("selected",!0)},reinitialize:function(){this.modal.options.html=this.generateModalHtml()}});return LinkModal}),function(root){define("tinymce-modern-theme",["tinymce"],function(){return function(){!function(){(function(){"use strict";function calculateRelativePosition(ctrl,targetElm,rel){var ctrlElm,pos,x,y,selfW,selfH,targetW,targetH,viewport,size;return viewport=getWindowViewPort(),pos=funcs.getPos(targetElm,$_1jk3jvtcjh8lz3jy.getUiContainer(ctrl)),x=pos.x,y=pos.y,isFixed(ctrl)&&isStatic(document.body)&&(x-=viewport.x,y-=viewport.y),ctrlElm=ctrl.getEl(),size=funcs.getSize(ctrlElm),selfW=size.width,selfH=size.height,size=funcs.getSize(targetElm),targetW=size.width,targetH=size.height,rel=(rel||"").split(""),"b"===rel[0]&&(y+=targetH),"r"===rel[1]&&(x+=targetW),"c"===rel[0]&&(y+=Math.round(targetH/2)),"c"===rel[1]&&(x+=Math.round(targetW/2)),"b"===rel[3]&&(y-=selfH),"r"===rel[4]&&(x-=selfW),"c"===rel[3]&&(y-=Math.round(selfH/2)),"c"===rel[4]&&(x-=Math.round(selfW/2)),{x:x,y:y,w:selfW,h:selfH}}function noop$1(){}function ClassList(onchange){this.cls=[],this.cls._map={},this.onchange=onchange||noop$1,this.prefix=""}function unique(array){for(var item,uniqueItems=[],i=array.length;i--;)item=array[i],item.__checked||(uniqueItems.push(item),item.__checked=1);for(i=uniqueItems.length;i--;)delete uniqueItems[i].__checked;return uniqueItems}function isNode(node){return node.nodeType>0}function isEqual(a,b){var k,checked;if(a===b)return!0;if(null===a||null===b)return a===b;if("object"!=typeof a||"object"!=typeof b)return a===b;if(global$2.isArray(b)){if(a.length!==b.length)return!1;for(k=a.length;k--;)if(!isEqual(a[k],b[k]))return!1}if(isNode(a)||isNode(b))return a===b;checked={};for(k in b){if(!isEqual(a[k],b[k]))return!1;checked[k]=!0}for(k in a)if(!checked[k]&&!isEqual(a[k],b[k]))return!1;return!0}function getEventDispatcher(obj){return obj._eventDispatcher||(obj._eventDispatcher=new global$11({scope:obj,toggleEvent:function(name,state){state&&global$11.isNative(name)&&(obj._nativeEvents||(obj._nativeEvents={}),obj._nativeEvents[name]=!0,obj.state.get("rendered")&&bindPendingEvents(obj))}})),obj._eventDispatcher}function bindPendingEvents(eventCtrl){function delegate(e){var control=eventCtrl.getParentCtrl(e.target);control&&control.fire(e.type,e)}function mouseLeaveHandler(){var ctrl=eventRootCtrl._lastHoverCtrl;ctrl&&(ctrl.fire("mouseleave",{target:ctrl.getEl()}),ctrl.parents().each(function(ctrl){ctrl.fire("mouseleave",{target:ctrl.getEl()})}),eventRootCtrl._lastHoverCtrl=null)}function mouseEnterHandler(e){var i,parents,lastParents,ctrl=eventCtrl.getParentCtrl(e.target),lastCtrl=eventRootCtrl._lastHoverCtrl,idx=0;if(ctrl!==lastCtrl){if(eventRootCtrl._lastHoverCtrl=ctrl,parents=ctrl.parents().toArray().reverse(),parents.push(ctrl),lastCtrl){for(lastParents=lastCtrl.parents().toArray().reverse(),lastParents.push(lastCtrl),idx=0;idx<lastParents.length&&parents[idx]===lastParents[idx];idx++);for(i=lastParents.length-1;i>=idx;i--)lastCtrl=lastParents[i],lastCtrl.fire("mouseleave",{target:lastCtrl.getEl()})}for(i=idx;i<parents.length;i++)ctrl=parents[i],ctrl.fire("mouseenter",{target:ctrl.getEl()})}}function fixWheelEvent(e){e.preventDefault(),"mousewheel"===e.type?(e.deltaY=-.025*e.wheelDelta,e.wheelDeltaX&&(e.deltaX=-.025*e.wheelDeltaX)):(e.deltaX=0,e.deltaY=e.detail),e=eventCtrl.fire("wheel",e)}var i,l,parents,eventRootCtrl,nativeEvents,name;if(nativeEvents=eventCtrl._nativeEvents){for(parents=eventCtrl.parents().toArray(),parents.unshift(eventCtrl),i=0,l=parents.length;!eventRootCtrl&&i<l;i++)eventRootCtrl=parents[i]._eventsRoot;for(eventRootCtrl||(eventRootCtrl=parents[parents.length-1]||eventCtrl),eventCtrl._eventsRoot=eventRootCtrl,l=i,i=0;i<l;i++)parents[i]._eventsRoot=eventRootCtrl;var eventRootDelegates=eventRootCtrl._delegates;eventRootDelegates||(eventRootDelegates=eventRootCtrl._delegates={});for(name in nativeEvents){if(!nativeEvents)return!1;"wheel"!==name||hasWheelEventSupport?("mouseenter"===name||"mouseleave"===name?eventRootCtrl._hasMouseEnter||(global$9(eventRootCtrl.getEl()).on("mouseleave",mouseLeaveHandler).on("mouseover",mouseEnterHandler),eventRootCtrl._hasMouseEnter=1):eventRootDelegates[name]||(global$9(eventRootCtrl.getEl()).on(name,delegate),eventRootDelegates[name]=!0),nativeEvents[name]=!1):hasMouseWheelEventSupport?global$9(eventCtrl.getEl()).on("mousewheel",fixWheelEvent):global$9(eventCtrl.getEl()).on("DOMMouseScroll",fixWheelEvent)}}}function KeyboardNavigation(settings){function isElement(node){return node&&1===node.nodeType}function getRole(elm){return elm=elm||focusedElement,isElement(elm)?elm.getAttribute("role"):null}function getParentRole(elm){for(var role,parent=elm||focusedElement;parent=parent.parentNode;)if(role=getRole(parent))return role}function getAriaProp(name){var elm=focusedElement;if(isElement(elm))return elm.getAttribute("aria-"+name)}function isTextInputElement(elm){var tagName=elm.tagName.toUpperCase();return"INPUT"===tagName||"TEXTAREA"===tagName||"SELECT"===tagName}function canFocus(elm){return!(!isTextInputElement(elm)||elm.hidden)||(!!hasTabstopData(elm)||!!/^(button|menuitem|checkbox|tab|menuitemcheckbox|option|gridcell|slider)$/.test(getRole(elm)))}function getFocusElements(elm){function collect(elm){if(1===elm.nodeType&&"none"!==elm.style.display&&!elm.disabled){canFocus(elm)&&elements.push(elm);for(var i=0;i<elm.childNodes.length;i++)collect(elm.childNodes[i])}}var elements=[];return collect(elm||root.getEl()),elements}function getNavigationRoot(targetControl){var navigationRoot,controls;targetControl=targetControl||focusedControl,controls=targetControl.parents().toArray(),controls.unshift(targetControl);for(var i=0;i<controls.length&&(navigationRoot=controls[i],!navigationRoot.settings.ariaRoot);i++);return navigationRoot}function focusFirst(targetControl){var navigationRoot=getNavigationRoot(targetControl),focusElements=getFocusElements(navigationRoot.getEl());navigationRoot.settings.ariaRemember&&"lastAriaIndex"in navigationRoot?moveFocusToIndex(navigationRoot.lastAriaIndex,focusElements):moveFocusToIndex(0,focusElements)}function moveFocusToIndex(idx,elements){return idx<0?idx=elements.length-1:idx>=elements.length&&(idx=0),elements[idx]&&elements[idx].focus(),idx}function moveFocus(dir,elements){var idx=-1,navigationRoot=getNavigationRoot();elements=elements||getFocusElements(navigationRoot.getEl());for(var i=0;i<elements.length;i++)elements[i]===focusedElement&&(idx=i);idx+=dir,navigationRoot.lastAriaIndex=moveFocusToIndex(idx,elements)}function left(){var parentRole=getParentRole();"tablist"===parentRole?moveFocus(-1,getFocusElements(focusedElement.parentNode)):focusedControl.parent().submenu?cancel():moveFocus(-1)}function right(){var role=getRole(),parentRole=getParentRole();"tablist"===parentRole?moveFocus(1,getFocusElements(focusedElement.parentNode)):"menuitem"===role&&"menu"===parentRole&&getAriaProp("haspopup")?enter():moveFocus(1)}function up(){moveFocus(-1)}function down(){var role=getRole(),parentRole=getParentRole();"menuitem"===role&&"menubar"===parentRole?enter():"button"===role&&getAriaProp("haspopup")?enter({key:"down"}):moveFocus(1)}function tab(e){var parentRole=getParentRole();if("tablist"===parentRole){var elm=getFocusElements(focusedControl.getEl("body"))[0];elm&&elm.focus()}else moveFocus(e.shiftKey?-1:1)}function cancel(){focusedControl.fire("cancel")}function enter(aria){aria=aria||{},focusedControl.fire("click",{target:focusedElement,aria:aria})}var focusedElement,focusedControl,root=settings.root;try{focusedElement=document.activeElement}catch(ex){focusedElement=document.body}return focusedControl=root.getParentCtrl(focusedElement),root.on("keydown",function(e){function handleNonTabOrEscEvent(e,handler){isTextInputElement(focusedElement)||hasTabstopData(focusedElement)||"slider"!==getRole(focusedElement)&&handler(e)!==!1&&e.preventDefault()}if(!e.isDefaultPrevented())switch(e.keyCode){case 37:handleNonTabOrEscEvent(e,left);break;case 39:handleNonTabOrEscEvent(e,right);break;case 38:handleNonTabOrEscEvent(e,up);break;case 40:handleNonTabOrEscEvent(e,down);break;case 27:cancel();break;case 14:case 13:case 32:handleNonTabOrEscEvent(e,enter);break;case 9:tab(e),e.preventDefault()}}),root.on("focusin",function(e){focusedElement=e.target,focusedControl=e.control}),{focusFirst:focusFirst}}function getDocumentSize(doc){var documentElement,body,scrollWidth,clientWidth,offsetWidth,scrollHeight,clientHeight,offsetHeight,max=Math.max;return documentElement=doc.documentElement,body=doc.body,scrollWidth=max(documentElement.scrollWidth,body.scrollWidth),clientWidth=max(documentElement.clientWidth,body.clientWidth),offsetWidth=max(documentElement.offsetWidth,body.offsetWidth),scrollHeight=max(documentElement.scrollHeight,body.scrollHeight),clientHeight=max(documentElement.clientHeight,body.clientHeight),offsetHeight=max(documentElement.offsetHeight,body.offsetHeight),{width:scrollWidth<offsetWidth?clientWidth:scrollWidth,height:scrollHeight<offsetHeight?clientHeight:scrollHeight}}function updateWithTouchData(e){var keys,i;if(e.changedTouches)for(keys="screenX screenY pageX pageY clientX clientY".split(" "),i=0;i<keys.length;i++)e[keys[i]]=e.changedTouches[0][keys[i]]}function DragHelper(id,settings){var $eventOverlay,downButton,start,stop,drag,startX,startY,doc=settings.document||document;settings=settings||{};var handleElement=doc.getElementById(settings.handle||id);start=function(e){var handleElm,cursor,docSize=getDocumentSize(doc);updateWithTouchData(e),e.preventDefault(),downButton=e.button,handleElm=handleElement,startX=e.screenX,startY=e.screenY,cursor=window.getComputedStyle?window.getComputedStyle(handleElm,null).getPropertyValue("cursor"):handleElm.runtimeStyle.cursor,$eventOverlay=global$9("<div></div>").css({position:"absolute",top:0,left:0,width:docSize.width,height:docSize.height,zIndex:2147483647,opacity:1e-4,cursor:cursor}).appendTo(doc.body),global$9(doc).on("mousemove touchmove",drag).on("mouseup touchend",stop),settings.start(e)},drag=function(e){return updateWithTouchData(e),e.button!==downButton?stop(e):(e.deltaX=e.screenX-startX,e.deltaY=e.screenY-startY,e.preventDefault(),void settings.drag(e))},stop=function(e){updateWithTouchData(e),global$9(doc).off("mousemove touchmove",drag).off("mouseup touchend",stop),$eventOverlay.remove(),settings.stop&&settings.stop(e)},this.destroy=function(){global$9(handleElement).off()},global$9(handleElement).on("mousedown touchstart",start)}function isChildOf(ctrl,parent){for(;ctrl;){if(ctrl===parent)return!0;ctrl=ctrl.parent()}}function skipOrHidePanels(e){for(var i=visiblePanels.length;i--;){var panel=visiblePanels[i],clickCtrl=panel.getParentCtrl(e.target);if(panel.settings.autohide){if(clickCtrl&&(isChildOf(clickCtrl,panel)||panel.parent()===clickCtrl))continue;e=panel.fire("autohide",{target:e.target}),e.isDefaultPrevented()||panel.hide()}}}function bindDocumentClickHandler(){documentClickHandler||(documentClickHandler=function(e){2!==e.button&&skipOrHidePanels(e)},global$9(document).on("click touchstart",documentClickHandler))}function bindDocumentScrollHandler(){documentScrollHandler||(documentScrollHandler=function(){var i;for(i=visiblePanels.length;i--;)repositionPanel(visiblePanels[i])},global$9(window).on("scroll",documentScrollHandler))}function bindWindowResizeHandler(){if(!windowResizeHandler){var docElm_1=document.documentElement,clientWidth_1=docElm_1.clientWidth,clientHeight_1=docElm_1.clientHeight;windowResizeHandler=function(){document.all&&clientWidth_1===docElm_1.clientWidth&&clientHeight_1===docElm_1.clientHeight||(clientWidth_1=docElm_1.clientWidth,clientHeight_1=docElm_1.clientHeight,FloatPanel.hideAll())},global$9(window).on("resize",windowResizeHandler)}}function repositionPanel(panel){function toggleFixedChildPanels(fixed,deltaY){for(var parent,i=0;i<visiblePanels.length;i++)if(visiblePanels[i]!==panel)for(parent=visiblePanels[i].parent();parent&&(parent=parent.parent());)parent===panel&&visiblePanels[i].fixed(fixed).moveBy(0,deltaY).repaint()}var scrollY=funcs.getViewPort().y;panel.settings.autofix&&(panel.state.get("fixed")?panel._autoFixY>scrollY&&(panel.fixed(!1).layoutRect({y:panel._autoFixY}).repaint(),toggleFixedChildPanels(!1,panel._autoFixY-scrollY)):(panel._autoFixY=panel.layoutRect().y,panel._autoFixY<scrollY&&(panel.fixed(!0).layoutRect({y:0}).repaint(),toggleFixedChildPanels(!0,scrollY-panel._autoFixY))))}function addRemove(add,ctrl){var i,topModal,zIndex=FloatPanel.zIndex||65535;if(add)zOrder.push(ctrl);else for(i=zOrder.length;i--;)zOrder[i]===ctrl&&zOrder.splice(i,1);if(zOrder.length)for(i=0;i<zOrder.length;i++)zOrder[i].modal&&(zIndex++,topModal=zOrder[i]),zOrder[i].getEl().style.zIndex=zIndex,zOrder[i].zIndex=zIndex,zIndex++;var modalBlockEl=global$9("#"+ctrl.classPrefix+"modal-block",ctrl.getContainerElm())[0];topModal?global$9(modalBlockEl).css("z-index",topModal.zIndex-1):modalBlockEl&&(modalBlockEl.parentNode.removeChild(modalBlockEl),hasModal=!1),FloatPanel.currentZIndex=zIndex}function removeVisiblePanel(panel){var i;for(i=visiblePanels.length;i--;)visiblePanels[i]===panel&&visiblePanels.splice(i,1);for(i=zOrder.length;i--;)zOrder[i]===panel&&zOrder.splice(i,1)}function Throbber(elm,inline){var state,timer,self=this,classPrefix=Control$1.classPrefix;self.show=function(time,callback){function render(){state&&(global$9(elm).append('<div class="'+classPrefix+"throbber"+(inline?" "+classPrefix+"throbber-inline":"")+'"></div>'),callback&&callback())}return self.hide(),state=!0,time?timer=global$7.setTimeout(render,time):render(),self},self.hide=function(){var child=elm.lastChild;return global$7.clearTimeout(timer),child&&child.className.indexOf("throbber")!==-1&&child.parentNode.removeChild(child),state=!1,self}}function NotificationManagerImpl(editor){var getEditorContainer=function(editor){return editor.inline?editor.getElement():editor.getContentAreaContainer()},getContainerWidth=function(){var container=getEditorContainer(editor);return funcs.getSize(container).width},prePositionNotifications=function(notifications){$_f3qxhzthjh8lz3kg.each(notifications,function(notification){notification.moveTo(0,0)})},positionNotifications=function(notifications){if(notifications.length>0){var firstItem=notifications.slice(0,1)[0],container=getEditorContainer(editor);firstItem.moveRel(container,"tc-tc"),$_f3qxhzthjh8lz3kg.each(notifications,function(notification,index){index>0&&notification.moveRel(notifications[index-1].getEl(),"bc-tc")})}},reposition=function(notifications){prePositionNotifications(notifications),positionNotifications(notifications)},open=function(args,closeCallback){var extendedArgs=global$2.extend(args,{maxWidth:getContainerWidth()}),notif=new Notification(extendedArgs);return notif.args=extendedArgs,extendedArgs.timeout>0&&(notif.timer=setTimeout(function(){notif.close(),closeCallback()},extendedArgs.timeout)),notif.on("close",function(){closeCallback()}),notif.renderTo(),notif},close=function(notification){notification.close()},getArgs=function(notification){return notification.args};return{open:open,close:close,reposition:reposition,getArgs:getArgs}}function toggleFullScreenState(state){var contentValue,noScaleMetaValue="width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0",viewport=global$9("meta[name=viewport]")[0];global$8.overrideViewPort!==!1&&(viewport||(viewport=document.createElement("meta"),viewport.setAttribute("name","viewport"),document.getElementsByTagName("head")[0].appendChild(viewport)),contentValue=viewport.getAttribute("content"),contentValue&&"undefined"!=typeof oldMetaValue&&(oldMetaValue=contentValue),viewport.setAttribute("content",state?noScaleMetaValue:oldMetaValue))}function toggleBodyFullScreenClasses(classPrefix,state){checkFullscreenWindows()&&state===!1&&global$9([document.documentElement,document.body]).removeClass(classPrefix+"fullscreen")}function checkFullscreenWindows(){for(var i=0;i<windows.length;i++)if(windows[i]._fullscreen)return!0;return!1}function handleWindowResize(){function reposition(){var i,layoutRect,rect=funcs.getWindowSize();for(i=0;i<windows.length;i++)layoutRect=windows[i].layoutRect(),windows[i].moveTo(windows[i].settings.x||Math.max(0,rect.w/2-layoutRect.w/2),windows[i].settings.y||Math.max(0,rect.h/2-layoutRect.h/2))}if(!global$8.desktop){var lastSize_1={w:window.innerWidth,h:window.innerHeight};global$7.setInterval(function(){var w=window.innerWidth,h=window.innerHeight;lastSize_1.w===w&&lastSize_1.h===h||(lastSize_1={w:w,h:h},global$9(window).trigger("resize"))},100)}global$9(window).on("resize",reposition)}function WindowManagerImpl(editor){var open=function(args,params,closeCallback){var win;return args.title=args.title||" ",args.url=args.url||args.file,args.url&&(args.width=parseInt(args.width||320,10),args.height=parseInt(args.height||240,10)),args.body&&(args.items={defaults:args.defaults,type:args.bodyType||"form",items:args.body,data:args.data,callbacks:args.commands}),args.url||args.buttons||(args.buttons=[{text:"Ok",subtype:"primary",onclick:function(){win.find("form")[0].submit()}},{text:"Cancel",onclick:function(){win.close()}}]),win=new Window(args),win.on("close",function(){closeCallback(win)}),args.data&&win.on("postRender",function(){this.find("*").each(function(ctrl){var name=ctrl.name();name in args.data&&ctrl.value(args.data[name])})}),win.features=args||{},win.params=params||{},win=win.renderTo(document.body).reflow()},alert=function(message,choiceCallback,closeCallback){var win;return win=MessageBox.alert(message,function(){choiceCallback()}),win.on("close",function(){closeCallback(win)}),win},confirm=function(message,choiceCallback,closeCallback){var win;return win=MessageBox.confirm(message,function(state){choiceCallback(state)}),win.on("close",function(){closeCallback(win)}),win},close=function(window){window.close()},getParams=function(window){return window.params},setParams=function(window,params){window.params=params};return{open:open,alert:alert,confirm:confirm,close:close,getParams:getParams,setParams:setParams}}function Immutable(){for(var fields=[],_i=0;_i<arguments.length;_i++)fields[_i]=arguments[_i];return function(){for(var values=[],_i=0;_i<arguments.length;_i++)values[_i]=arguments[_i];if(fields.length!==values.length)throw new Error('Wrong number of arguments to struct. Expected "['+fields.length+']", got '+values.length+" arguments");var struct={};return $_f3qxhzthjh8lz3kg.each(fields,function(name,i){struct[name]=$_3pjweotejh8lz3k4.constant(values[i])}),struct}}function MixedBag(required,optional){var everything=required.concat(optional);if(0===everything.length)throw new Error("You must specify at least one required or optional field.");return $_6xoomwvijh8lz3sn.validateStrArr("required",required),$_6xoomwvijh8lz3sn.validateStrArr("optional",optional),$_6xoomwvijh8lz3sn.checkDupes(everything),function(obj){var keys=$_el35e0vhjh8lz3sl.keys(obj),allReqd=$_f3qxhzthjh8lz3kg.forall(required,function(req){return $_f3qxhzthjh8lz3kg.contains(keys,req)});allReqd||$_6xoomwvijh8lz3sn.reqMessage(required,keys);var unsupported=$_f3qxhzthjh8lz3kg.filter(keys,function(key){return!$_f3qxhzthjh8lz3kg.contains(everything,key)});unsupported.length>0&&$_6xoomwvijh8lz3sn.unsuppMessage(unsupported);var r={};return $_f3qxhzthjh8lz3kg.each(required,function(req){r[req]=$_3pjweotejh8lz3k4.constant(obj[req])}),$_f3qxhzthjh8lz3kg.each(optional,function(opt){r[opt]=$_3pjweotejh8lz3k4.constant(Object.prototype.hasOwnProperty.call(obj,opt)?Option.some(obj[opt]):Option.none());
}),r}}function DeviceType(os,browser,userAgent){var isiPad=os.isiOS()&&/ipad/i.test(userAgent)===!0,isiPhone=os.isiOS()&&!isiPad,isAndroid3=os.isAndroid()&&3===os.version.major,isAndroid4=os.isAndroid()&&4===os.version.major,isTablet=isiPad||isAndroid3||isAndroid4&&/mobile/i.test(userAgent)===!0,isTouch=os.isiOS()||os.isAndroid(),isPhone=isTouch&&!isTablet,iOSwebview=browser.isSafari()&&os.isiOS()&&/safari/i.test(userAgent)===!1;return{isiPad:$_3pjweotejh8lz3k4.constant(isiPad),isiPhone:$_3pjweotejh8lz3k4.constant(isiPhone),isTablet:$_3pjweotejh8lz3k4.constant(isTablet),isPhone:$_3pjweotejh8lz3k4.constant(isPhone),isTouch:$_3pjweotejh8lz3k4.constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:$_3pjweotejh8lz3k4.constant(iOSwebview)}}function ClosestOrAncestor(is,ancestor,scope,a,isRoot){return is(scope,a)?Option.some(scope):$_d8bie3tijh8lz3kn.isFunction(isRoot)&&isRoot(scope)?Option.none():ancestor(scope,a,isRoot)}function isChildOf$1(node,parent){for(;node;){if(parent===node)return!0;node=node.parentNode}return!1}function createOptions(options){var strOptions="";if(options)for(var i=0;i<options.length;i++)strOptions+='<option value="'+options[i]+'">'+options[i]+"</option>";return strOptions}function constrain(value,minVal,maxVal){return value<minVal&&(value=minVal),value>maxVal&&(value=maxVal),value}function setAriaProp(el,name,value){el.setAttribute("aria-"+name,value)}function updateSliderHandle(ctrl,value){var maxHandlePos,shortSizeName,sizeName,stylePosName,styleValue,handleEl;"v"===ctrl.settings.orientation?(stylePosName="top",sizeName="height",shortSizeName="h"):(stylePosName="left",sizeName="width",shortSizeName="w"),handleEl=ctrl.getEl("handle"),maxHandlePos=(ctrl.layoutRect()[shortSizeName]||100)-funcs.getSize(handleEl)[sizeName],styleValue=maxHandlePos*((value-ctrl._minValue)/(ctrl._maxValue-ctrl._minValue))+"px",handleEl.style[stylePosName]=styleValue,handleEl.style.height=ctrl.layoutRect().h+"px",setAriaProp(handleEl,"valuenow",value),setAriaProp(handleEl,"valuetext",""+ctrl.settings.previewFilter(value)),setAriaProp(handleEl,"valuemin",ctrl._minValue),setAriaProp(handleEl,"valuemax",ctrl._maxValue)}function Theme(){}var global=tinymce.util.Tools.resolve("tinymce.ThemeManager"),global$1=tinymce.util.Tools.resolve("tinymce.EditorManager"),global$2=tinymce.util.Tools.resolve("tinymce.util.Tools"),isBrandingEnabled=function(editor){return editor.getParam("branding",!0,"boolean")},hasMenubar=function(editor){return getMenubar(editor)!==!1},getMenubar=function(editor){return editor.getParam("menubar")},hasStatusbar=function(editor){return editor.getParam("statusbar",!0,"boolean")},getToolbarSize=function(editor){return editor.getParam("toolbar_items_size")},isReadOnly=function(editor){return editor.getParam("readonly",!1,"boolean")},getFixedToolbarContainer=function(editor){return editor.getParam("fixed_toolbar_container")},getInlineToolbarPositionHandler=function(editor){return editor.getParam("inline_toolbar_position_handler")},getMenu=function(editor){return editor.getParam("menu")},getRemovedMenuItems=function(editor){return editor.getParam("removed_menuitems","")},getMinWidth=function(editor){return editor.getParam("min_width",100,"number")},getMinHeight=function(editor){return editor.getParam("min_height",100,"number")},getMaxWidth=function(editor){return editor.getParam("max_width",65535,"number")},getMaxHeight=function(editor){return editor.getParam("max_height",65535,"number")},isSkinDisabled=function(editor){return editor.settings.skin===!1},isInline=function(editor){return editor.getParam("inline",!1,"boolean")},getResize=function(editor){var resize=editor.getParam("resize","vertical");return resize===!1?"none":"both"===resize?"both":"vertical"},getSkinUrl=function(editor){var settings=editor.settings,skin=settings.skin,skinUrl=settings.skin_url;if(skin!==!1){var skinName=skin?skin:"lightgray";skinUrl=skinUrl?editor.documentBaseURI.toAbsolute(skinUrl):global$1.baseURL+"/skins/"+skinName}return skinUrl},getIndexedToolbars=function(settings,defaultToolbar){for(var toolbars=[],i=1;i<10;i++){var toolbar_1=settings["toolbar"+i];if(!toolbar_1)break;toolbars.push(toolbar_1)}var mainToolbar=settings.toolbar?[settings.toolbar]:[defaultToolbar];return toolbars.length>0?toolbars:mainToolbar},getToolbars=function(editor){var toolbar=editor.getParam("toolbar"),defaultToolbar="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";return toolbar===!1?[]:global$2.isArray(toolbar)?global$2.grep(toolbar,function(toolbar){return toolbar.length>0}):getIndexedToolbars(editor.settings,defaultToolbar)},global$3=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$4=tinymce.util.Tools.resolve("tinymce.ui.Factory"),global$5=tinymce.util.Tools.resolve("tinymce.util.I18n"),fireSkinLoaded=function(editor){return editor.fire("SkinLoaded")},fireResizeEditor=function(editor){return editor.fire("ResizeEditor")},fireBeforeRenderUI=function(editor){return editor.fire("BeforeRenderUI")},$_aycuj2t7jh8lz3jp={fireSkinLoaded:fireSkinLoaded,fireResizeEditor:fireResizeEditor,fireBeforeRenderUI:fireBeforeRenderUI},focus=function(panel,type){return function(){var item=panel.find(type)[0];item&&item.focus(!0)}},addKeys=function(editor,panel){editor.shortcuts.add("Alt+F9","",focus(panel,"menubar")),editor.shortcuts.add("Alt+F10,F10","",focus(panel,"toolbar")),editor.shortcuts.add("Alt+F11","",focus(panel,"elementpath")),panel.on("cancel",function(){editor.focus()})},$_47hpztt8jh8lz3jq={addKeys:addKeys},global$6=tinymce.util.Tools.resolve("tinymce.geom.Rect"),global$7=tinymce.util.Tools.resolve("tinymce.util.Delay"),noop=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i]},noarg=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return f()}},compose=function(fa,fb){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return fa(fb.apply(null,arguments))}},constant=function(value){return function(){return value}},identity=function(x){return x},tripleEquals=function(a,b){return a===b},curry=function(f){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];for(var args=new Array(arguments.length-1),i=1;i<arguments.length;i++)args[i-1]=arguments[i];return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];for(var newArgs=new Array(arguments.length),j=0;j<newArgs.length;j++)newArgs[j]=arguments[j];var all=args.concat(newArgs);return f.apply(null,all)}},not=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return!f.apply(null,arguments)}},die=function(msg){return function(){throw new Error(msg)}},apply=function(f){return f()},call=function(f){f()},never=constant(!1),always=constant(!0),$_3pjweotejh8lz3k4={noop:noop,noarg:noarg,compose:compose,constant:constant,identity:identity,tripleEquals:tripleEquals,curry:curry,not:not,die:die,apply:apply,call:call,never:never,always:always},never$1=$_3pjweotejh8lz3k4.never,always$1=$_3pjweotejh8lz3k4.always,none=function(){return NONE},NONE=function(){var eq=function(o){return o.isNone()},call=function(thunk){return thunk()},id=function(n){return n},noop=function(){},me={fold:function(n,s){return n()},is:never$1,isSome:never$1,isNone:always$1,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},or:id,orThunk:call,map:none,ap:none,each:noop,bind:none,flatten:none,exists:never$1,forall:always$1,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:$_3pjweotejh8lz3k4.constant("none()")};return Object.freeze&&Object.freeze(me),me}(),some=function(a){var constant_a=function(){return a},self=function(){return me},map=function(f){return some(f(a))},bind=function(f){return f(a)},me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always$1,isNone:never$1,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,or:self,orThunk:self,map:map,ap:function(optfab){return optfab.fold(none,function(fab){return some(fab(a))})},each:function(f){f(a)},bind:bind,flatten:constant_a,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never$1,function(b){return elementEq(a,b)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return me},from=function(value){return null===value||void 0===value?NONE:some(value)},Option={some:some,none:none,from:from},getUiContainerDelta=function(ctrl){var uiContainer=getUiContainer(ctrl);if(uiContainer&&"static"!==global$3.DOM.getStyle(uiContainer,"position",!0)){var containerPos=global$3.DOM.getPos(uiContainer),dx=uiContainer.scrollLeft-containerPos.x,dy=uiContainer.scrollTop-containerPos.y;return Option.some({x:dx,y:dy})}return Option.none()},setUiContainer=function(editor,ctrl){var uiContainer=global$3.DOM.select(editor.settings.ui_container)[0];ctrl.getRoot().uiContainer=uiContainer},getUiContainer=function(ctrl){return ctrl?ctrl.getRoot().uiContainer:null},inheritUiContainer=function(fromCtrl,toCtrl){return toCtrl.uiContainer=getUiContainer(fromCtrl)},$_1jk3jvtcjh8lz3jy={getUiContainerDelta:getUiContainerDelta,setUiContainer:setUiContainer,getUiContainer:getUiContainer,inheritUiContainer:inheritUiContainer},createToolbar=function(editor,items,size){var buttonGroup,toolbarItems=[];if(items)return global$2.each(items.split(/[ ,]/),function(item){var itemName,bindSelectorChanged=function(){var selection=editor.selection;item.settings.stateSelector&&selection.selectorChanged(item.settings.stateSelector,function(state){item.active(state)},!0),item.settings.disabledStateSelector&&selection.selectorChanged(item.settings.disabledStateSelector,function(state){item.disabled(state)})};"|"===item?buttonGroup=null:(buttonGroup||(buttonGroup={type:"buttongroup",items:[]},toolbarItems.push(buttonGroup)),editor.buttons[item]&&(itemName=item,item=editor.buttons[itemName],"function"==typeof item&&(item=item()),item.type=item.type||"button",item.size=size,item=global$4.create(item),buttonGroup.items.push(item),editor.initialized?bindSelectorChanged():editor.on("init",bindSelectorChanged)))}),{type:"toolbar",layout:"flow",items:toolbarItems}},createToolbars=function(editor,size){var toolbars=[],addToolbar=function(items){items&&toolbars.push(createToolbar(editor,items,size))};if(global$2.each(getToolbars(editor),function(toolbar){addToolbar(toolbar)}),toolbars.length)return{type:"panel",layout:"stack",classes:"toolbar-grp",ariaRoot:!0,ariaRemember:!0,items:toolbars}},$_fudqhrtfjh8lz3k7={createToolbar:createToolbar,createToolbars:createToolbars},DOM=global$3.DOM,toClientRect=function(geomRect){return{left:geomRect.x,top:geomRect.y,width:geomRect.w,height:geomRect.h,right:geomRect.x+geomRect.w,bottom:geomRect.y+geomRect.h}},hideAllFloatingPanels=function(editor){global$2.each(editor.contextToolbars,function(toolbar){toolbar.panel&&toolbar.panel.hide()})},movePanelTo=function(panel,pos){panel.moveTo(pos.left,pos.top)},togglePositionClass=function(panel,relPos,predicate){relPos=relPos?relPos.substr(0,2):"",global$2.each({t:"down",b:"up"},function(cls,pos){panel.classes.toggle("arrow-"+cls,predicate(pos,relPos.substr(0,1)))}),global$2.each({l:"left",r:"right"},function(cls,pos){panel.classes.toggle("arrow-"+cls,predicate(pos,relPos.substr(1,1)))})},userConstrain=function(handler,x,y,elementRect,contentAreaRect,panelRect){return panelRect=toClientRect({x:x,y:y,w:panelRect.w,h:panelRect.h}),handler&&(panelRect=handler({elementRect:toClientRect(elementRect),contentAreaRect:toClientRect(contentAreaRect),panelRect:panelRect})),panelRect},addContextualToolbars=function(editor){var scrollContainer,getContextToolbars=function(){return editor.contextToolbars||[]},getElementRect=function(elm){var pos,targetRect,root;return pos=DOM.getPos(editor.getContentAreaContainer()),targetRect=editor.dom.getRect(elm),root=editor.dom.getRoot(),"BODY"===root.nodeName&&(targetRect.x-=root.ownerDocument.documentElement.scrollLeft||root.scrollLeft,targetRect.y-=root.ownerDocument.documentElement.scrollTop||root.scrollTop),targetRect.x+=pos.x,targetRect.y+=pos.y,targetRect},reposition=function(match,shouldShow){var relPos,panelRect,elementRect,contentAreaRect,panel,relRect,testPositions,smallElementWidthThreshold,handler=getInlineToolbarPositionHandler(editor);if(!editor.removed){if(!match||!match.toolbar.panel)return void hideAllFloatingPanels(editor);testPositions=["bc-tc","tc-bc","tl-bl","bl-tl","tr-br","br-tr"],panel=match.toolbar.panel,shouldShow&&panel.show(),elementRect=getElementRect(match.element),panelRect=DOM.getRect(panel.getEl()),contentAreaRect=DOM.getRect(editor.getContentAreaContainer()||editor.getBody());var delta=$_1jk3jvtcjh8lz3jy.getUiContainerDelta(panel).getOr({x:0,y:0});if(elementRect.x+=delta.x,elementRect.y+=delta.y,panelRect.x+=delta.x,panelRect.y+=delta.y,contentAreaRect.x+=delta.x,contentAreaRect.y+=delta.y,smallElementWidthThreshold=25,"inline"!==DOM.getStyle(match.element,"display",!0)){var clientRect=match.element.getBoundingClientRect();elementRect.w=clientRect.width,elementRect.h=clientRect.height}editor.inline||(contentAreaRect.w=editor.getDoc().documentElement.offsetWidth),editor.selection.controlSelection.isResizable(match.element)&&elementRect.w<smallElementWidthThreshold&&(elementRect=global$6.inflate(elementRect,0,8)),relPos=global$6.findBestRelativePosition(panelRect,elementRect,contentAreaRect,testPositions),elementRect=global$6.clamp(elementRect,contentAreaRect),relPos?(relRect=global$6.relativePosition(panelRect,elementRect,relPos),movePanelTo(panel,userConstrain(handler,relRect.x,relRect.y,elementRect,contentAreaRect,panelRect))):(contentAreaRect.h+=panelRect.h,elementRect=global$6.intersect(contentAreaRect,elementRect),elementRect?(relPos=global$6.findBestRelativePosition(panelRect,elementRect,contentAreaRect,["bc-tc","bl-tl","br-tr"]),relPos?(relRect=global$6.relativePosition(panelRect,elementRect,relPos),movePanelTo(panel,userConstrain(handler,relRect.x,relRect.y,elementRect,contentAreaRect,panelRect))):movePanelTo(panel,userConstrain(handler,elementRect.x,elementRect.y,elementRect,contentAreaRect,panelRect))):panel.hide()),togglePositionClass(panel,relPos,function(pos1,pos2){return pos1===pos2})}},repositionHandler=function(show){return function(){var execute=function(){editor.selection&&reposition(findFrontMostMatch(editor.selection.getNode()),show)};global$7.requestAnimationFrame(execute)}},bindScrollEvent=function(panel){if(!scrollContainer){var reposition_1=repositionHandler(!0),uiContainer_1=$_1jk3jvtcjh8lz3jy.getUiContainer(panel);scrollContainer=editor.selection.getScrollContainer()||editor.getWin(),DOM.bind(scrollContainer,"scroll",reposition_1),DOM.bind(uiContainer_1,"scroll",reposition_1),editor.on("remove",function(){DOM.unbind(scrollContainer,"scroll",reposition_1),DOM.unbind(uiContainer_1,"scroll",reposition_1)})}},showContextToolbar=function(match){var panel;return match.toolbar.panel?(match.toolbar.panel.show(),void reposition(match)):(panel=global$4.create({type:"floatpanel",role:"dialog",classes:"tinymce tinymce-inline arrow",ariaLabel:"Inline toolbar",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!0,border:1,items:$_fudqhrtfjh8lz3k7.createToolbar(editor,match.toolbar.items),oncancel:function(){editor.focus()}}),$_1jk3jvtcjh8lz3jy.setUiContainer(editor,panel),bindScrollEvent(panel),match.toolbar.panel=panel,panel.renderTo().reflow(),void reposition(match))},hideAllContextToolbars=function(){global$2.each(getContextToolbars(),function(toolbar){toolbar.panel&&toolbar.panel.hide()})},findFrontMostMatch=function(targetElm){var i,y,parentsAndSelf,toolbars=getContextToolbars();for(parentsAndSelf=editor.$(targetElm).parents().add(targetElm),i=parentsAndSelf.length-1;i>=0;i--)for(y=toolbars.length-1;y>=0;y--)if(toolbars[y].predicate(parentsAndSelf[i]))return{toolbar:toolbars[y],element:parentsAndSelf[i]};return null};editor.on("click keyup setContent ObjectResized",function(e){("setcontent"!==e.type||e.selection)&&global$7.setEditorTimeout(editor,function(){var match;match=findFrontMostMatch(editor.selection.getNode()),match?(hideAllContextToolbars(),showContextToolbar(match)):hideAllContextToolbars()})}),editor.on("blur hide contextmenu",hideAllContextToolbars),editor.on("ObjectResizeStart",function(){var match=findFrontMostMatch(editor.selection.getNode());match&&match.toolbar.panel&&match.toolbar.panel.hide()}),editor.on("ResizeEditor ResizeWindow",repositionHandler(!0)),editor.on("nodeChange",repositionHandler(!1)),editor.on("remove",function(){global$2.each(getContextToolbars(),function(toolbar){toolbar.panel&&toolbar.panel.remove()}),editor.contextToolbars={}}),editor.shortcuts.add("ctrl+shift+e > ctrl+shift+p","",function(){var match=findFrontMostMatch(editor.selection.getNode());match&&match.toolbar.panel&&match.toolbar.panel.items()[0].focus()})},$_5kodmdt9jh8lz3js={addContextualToolbars:addContextualToolbars},typeOf=function(x){if(null===x)return"null";var t=typeof x;return"object"===t&&Array.prototype.isPrototypeOf(x)?"array":"object"===t&&String.prototype.isPrototypeOf(x)?"string":t},isType=function(type){return function(value){return typeOf(value)===type}},$_d8bie3tijh8lz3kn={isString:isType("string"),isObject:isType("object"),isArray:isType("array"),isNull:isType("null"),isBoolean:isType("boolean"),isUndefined:isType("undefined"),isFunction:isType("function"),isNumber:isType("number")},rawIndexOf=function(){var pIndexOf=Array.prototype.indexOf,fastIndex=function(xs,x){return pIndexOf.call(xs,x)},slowIndex=function(xs,x){return slowIndexOf(xs,x)};return void 0===pIndexOf?slowIndex:fastIndex}(),indexOf=function(xs,x){var r=rawIndexOf(xs,x);return r===-1?Option.none():Option.some(r)},contains=function(xs,x){return rawIndexOf(xs,x)>-1},exists=function(xs,pred){return findIndex(xs,pred).isSome()},range=function(num,f){for(var r=[],i=0;i<num;i++)r.push(f(i));return r},chunk=function(array,size){for(var r=[],i=0;i<array.length;i+=size){var s=array.slice(i,i+size);r.push(s)}return r},map=function(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i,xs)}return r},each=function(xs,f){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];f(x,i,xs)}},eachr=function(xs,f){for(var i=xs.length-1;i>=0;i--){var x=xs[i];f(x,i,xs)}},partition=function(xs,pred){for(var pass=[],fail=[],i=0,len=xs.length;i<len;i++){var x=xs[i],arr=pred(x,i,xs)?pass:fail;arr.push(x)}return{pass:pass,fail:fail}},filter=function(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i,xs)&&r.push(x)}return r},groupBy=function(xs,f){if(0===xs.length)return[];for(var wasType=f(xs[0]),r=[],group=[],i=0,len=xs.length;i<len;i++){var x=xs[i],type=f(x);type!==wasType&&(r.push(group),group=[]),wasType=type,group.push(x)}return 0!==group.length&&r.push(group),r},foldr=function(xs,f,acc){return eachr(xs,function(x){acc=f(acc,x)}),acc},foldl=function(xs,f,acc){return each(xs,function(x){acc=f(acc,x)}),acc},find=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs))return Option.some(x)}return Option.none()},findIndex=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs))return Option.some(i)}return Option.none()},slowIndexOf=function(xs,x){for(var i=0,len=xs.length;i<len;++i)if(xs[i]===x)return i;return-1},push=Array.prototype.push,flatten=function(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!Array.prototype.isPrototypeOf(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);push.apply(r,xs[i])}return r},bind=function(xs,f){var output=map(xs,f);return flatten(output)},forall=function(xs,pred){for(var i=0,len=xs.length;i<len;++i){var x=xs[i];if(pred(x,i,xs)!==!0)return!1}return!0},equal=function(a1,a2){return a1.length===a2.length&&forall(a1,function(x,i){return x===a2[i]})},slice=Array.prototype.slice,reverse=function(xs){var r=slice.call(xs,0);return r.reverse(),r},difference=function(a1,a2){return filter(a1,function(x){return!contains(a2,x)})},mapToObject=function(xs,f){for(var r={},i=0,len=xs.length;i<len;i++){var x=xs[i];r[String(x)]=f(x,i)}return r},pure=function(x){return[x]},sort=function(xs,comparator){var copy=slice.call(xs,0);return copy.sort(comparator),copy},head=function(xs){return 0===xs.length?Option.none():Option.some(xs[0])},last=function(xs){return 0===xs.length?Option.none():Option.some(xs[xs.length-1])},from$1=$_d8bie3tijh8lz3kn.isFunction(Array.from)?Array.from:function(x){return slice.call(x)},$_f3qxhzthjh8lz3kg={map:map,each:each,eachr:eachr,partition:partition,filter:filter,groupBy:groupBy,indexOf:indexOf,foldr:foldr,foldl:foldl,find:find,findIndex:findIndex,flatten:flatten,bind:bind,forall:forall,exists:exists,contains:contains,equal:equal,reverse:reverse,chunk:chunk,difference:difference,mapToObject:mapToObject,pure:pure,sort:sort,range:range,head:head,last:last,from:from$1},defaultMenus={file:{title:"File",items:"newdocument restoredraft | preview | print"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen"},insert:{title:"Insert",items:"image link media template codesample inserttable | charmap hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | blockformats align | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code"},table:{title:"Table"},help:{title:"Help"}},delimiterMenuNamePair=function(){return{name:"|",item:{text:"|"}}},createMenuNameItemPair=function(name,item){var menuItem=item?{name:name,item:item}:null;return"|"===name?delimiterMenuNamePair():menuItem},hasItemName=function(namedMenuItems,name){return $_f3qxhzthjh8lz3kg.findIndex(namedMenuItems,function(namedMenuItem){return namedMenuItem.name===name}).isSome()},isSeparator=function(namedMenuItem){return namedMenuItem&&"|"===namedMenuItem.item.text},cleanupMenu=function(namedMenuItems,removedMenuItems){var menuItemsPass1=$_f3qxhzthjh8lz3kg.filter(namedMenuItems,function(namedMenuItem){return removedMenuItems.hasOwnProperty(namedMenuItem.name)===!1}),menuItemsPass2=$_f3qxhzthjh8lz3kg.filter(menuItemsPass1,function(namedMenuItem,i,namedMenuItems){return!isSeparator(namedMenuItem)||!isSeparator(namedMenuItems[i-1])});return $_f3qxhzthjh8lz3kg.filter(menuItemsPass2,function(namedMenuItem,i,namedMenuItems){return!isSeparator(namedMenuItem)||i>0&&i<namedMenuItems.length-1})},createMenu=function(editorMenuItems,menus,removedMenuItems,context){var menuButton,menu,namedMenuItems,isUserDefined;return menus?(menu=menus[context],isUserDefined=!0):menu=defaultMenus[context],menu&&(menuButton={text:menu.title},namedMenuItems=[],global$2.each((menu.items||"").split(/[ ,]/),function(name){var namedMenuItem=createMenuNameItemPair(name,editorMenuItems[name]);namedMenuItem&&namedMenuItems.push(namedMenuItem)}),isUserDefined||global$2.each(editorMenuItems,function(item,name){item.context!==context||hasItemName(namedMenuItems,name)||("before"===item.separator&&namedMenuItems.push(delimiterMenuNamePair()),item.prependToContext?namedMenuItems.unshift(createMenuNameItemPair(name,item)):namedMenuItems.push(createMenuNameItemPair(name,item)),"after"===item.separator&&namedMenuItems.push(delimiterMenuNamePair()))}),menuButton.menu=$_f3qxhzthjh8lz3kg.map(cleanupMenu(namedMenuItems,removedMenuItems),function(menuItem){return menuItem.item}),!menuButton.menu.length)?null:menuButton},getDefaultMenubar=function(editor){var name,defaultMenuBar=[],menu=getMenu(editor);if(menu)for(name in menu)defaultMenuBar.push(name);else for(name in defaultMenus)defaultMenuBar.push(name);return defaultMenuBar},createMenuButtons=function(editor){for(var menuButtons=[],defaultMenuBar=getDefaultMenubar(editor),removedMenuItems=global$2.makeMap(getRemovedMenuItems(editor).split(/[ ,]/)),menubar=getMenubar(editor),enabledMenuNames="string"==typeof menubar?menubar.split(/[ ,]/):defaultMenuBar,i=0;i<enabledMenuNames.length;i++){var menuItems=enabledMenuNames[i],menu=createMenu(editor.menuItems,getMenu(editor),removedMenuItems,menuItems);menu&&menuButtons.push(menu)}return menuButtons},$_8i78rftgjh8lz3ka={createMenuButtons:createMenuButtons},DOM$1=global$3.DOM,getSize=function(elm){return{width:elm.clientWidth,height:elm.clientHeight}},resizeTo=function(editor,width,height){var containerElm,iframeElm,containerSize,iframeSize;containerElm=editor.getContainer(),iframeElm=editor.getContentAreaContainer().firstChild,containerSize=getSize(containerElm),iframeSize=getSize(iframeElm),null!==width&&(width=Math.max(getMinWidth(editor),width),width=Math.min(getMaxWidth(editor),width),DOM$1.setStyle(containerElm,"width",width+(containerSize.width-iframeSize.width)),DOM$1.setStyle(iframeElm,"width",width)),height=Math.max(getMinHeight(editor),height),height=Math.min(getMaxHeight(editor),height),DOM$1.setStyle(iframeElm,"height",height),$_aycuj2t7jh8lz3jp.fireResizeEditor(editor)},resizeBy=function(editor,dw,dh){var elm=editor.getContentAreaContainer();resizeTo(editor,elm.clientWidth+dw,elm.clientHeight+dh)},$_5toavetjjh8lz3ko={resizeTo:resizeTo,resizeBy:resizeBy},global$8=tinymce.util.Tools.resolve("tinymce.Env"),api=function(elm){return{element:function(){return elm}}},trigger=function(sidebar,panel,callbackName){var callback=sidebar.settings[callbackName];callback&&callback(api(panel.getEl("body")))},hidePanels=function(name,container,sidebars){global$2.each(sidebars,function(sidebar){var panel=container.items().filter("#"+sidebar.name)[0];panel&&panel.visible()&&sidebar.name!==name&&(trigger(sidebar,panel,"onhide"),panel.visible(!1))})},deactivateButtons=function(toolbar){toolbar.items().each(function(ctrl){ctrl.active(!1)})},findSidebar=function(sidebars,name){return global$2.grep(sidebars,function(sidebar){return sidebar.name===name})[0]},showPanel=function(editor,name,sidebars){return function(e){var btnCtrl=e.control,container=btnCtrl.parents().filter("panel")[0],panel=container.find("#"+name)[0],sidebar=findSidebar(sidebars,name);hidePanels(name,container,sidebars),deactivateButtons(btnCtrl.parent()),panel&&panel.visible()?(trigger(sidebar,panel,"onhide"),panel.hide(),btnCtrl.active(!1)):(panel?(panel.show(),trigger(sidebar,panel,"onshow")):(panel=global$4.create({type:"container",name:name,layout:"stack",classes:"sidebar-panel",html:""}),container.prepend(panel),trigger(sidebar,panel,"onrender"),trigger(sidebar,panel,"onshow")),btnCtrl.active(!0)),$_aycuj2t7jh8lz3jp.fireResizeEditor(editor)}},isModernBrowser=function(){return!global$8.ie||global$8.ie>=11},hasSidebar=function(editor){return!(!isModernBrowser()||!editor.sidebars)&&editor.sidebars.length>0},createSidebar=function(editor){var buttons=global$2.map(editor.sidebars,function(sidebar){var settings=sidebar.settings;return{type:"button",icon:settings.icon,image:settings.image,tooltip:settings.tooltip,onclick:showPanel(editor,sidebar.name,editor.sidebars)}});return{type:"panel",name:"sidebar",layout:"stack",classes:"sidebar",items:[{type:"toolbar",layout:"stack",classes:"sidebar-toolbar",items:buttons}]}},$_5buua9tkjh8lz3kq={hasSidebar:hasSidebar,createSidebar:createSidebar},fireSkinLoaded$1=function(editor){var done=function(){editor._skinLoaded=!0,$_aycuj2t7jh8lz3jp.fireSkinLoaded(editor)};return function(){editor.initialized?done():editor.on("init",done)}},$_231e94tmjh8lz3ku={fireSkinLoaded:fireSkinLoaded$1},DOM$2=global$3.DOM,switchMode=function(panel){return function(e){panel.find("*").disabled("readonly"===e.mode)}},editArea=function(border){return{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",border:border,html:""}},editAreaContainer=function(editor){return{type:"panel",layout:"stack",classes:"edit-aria-container",border:"1 0 0 0",items:[editArea("0"),$_5buua9tkjh8lz3kq.createSidebar(editor)]}},render=function(editor,theme,args){var panel,resizeHandleCtrl,startSize;if(isSkinDisabled(editor)===!1&&args.skinUiCss?DOM$2.styleSheetLoader.load(args.skinUiCss,$_231e94tmjh8lz3ku.fireSkinLoaded(editor)):$_231e94tmjh8lz3ku.fireSkinLoaded(editor)(),panel=theme.panel=global$4.create({type:"panel",role:"application",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[{type:"container",classes:"top-part",items:[hasMenubar(editor)===!1?null:{type:"menubar",border:"0 0 1 0",items:$_8i78rftgjh8lz3ka.createMenuButtons(editor)},$_fudqhrtfjh8lz3k7.createToolbars(editor,getToolbarSize(editor))]},$_5buua9tkjh8lz3kq.hasSidebar(editor)?editAreaContainer(editor):editArea("1 0 0 0")]}),$_1jk3jvtcjh8lz3jy.setUiContainer(editor,panel),"none"!==getResize(editor)&&(resizeHandleCtrl={type:"resizehandle",direction:getResize(editor),onResizeStart:function(){var elm=editor.getContentAreaContainer().firstChild;startSize={width:elm.clientWidth,height:elm.clientHeight}},onResize:function(e){"both"===getResize(editor)?$_5toavetjjh8lz3ko.resizeTo(editor,startSize.width+e.deltaX,startSize.height+e.deltaY):$_5toavetjjh8lz3ko.resizeTo(editor,null,startSize.height+e.deltaY)}}),hasStatusbar(editor)){var linkHtml='<a href="https://www.tinymce.com/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce" rel="noopener" target="_blank" role="presentation" tabindex="-1">tinymce</a>',html=global$5.translate(["Powered by {0}",linkHtml]),brandingLabel=isBrandingEnabled(editor)?{type:"label",classes:"branding",html:" "+html}:null;panel.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",ariaRoot:!0,items:[{type:"elementpath",editor:editor},resizeHandleCtrl,brandingLabel]})}return $_aycuj2t7jh8lz3jp.fireBeforeRenderUI(editor),editor.on("SwitchMode",switchMode(panel)),panel.renderBefore(args.targetNode).reflow(),isReadOnly(editor)&&editor.setMode("readonly"),args.width&&DOM$2.setStyle(panel.getEl(),"width",args.width),editor.on("remove",function(){panel.remove(),panel=null}),$_47hpztt8jh8lz3jq.addKeys(editor,panel),$_5kodmdt9jh8lz3js.addContextualToolbars(editor),{iframeContainer:panel.find("#iframe")[0].getEl(),editorContainer:panel.getEl()}},$_4cj0a3t3jh8lz3jk={render:render},global$9=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),count=0,funcs={id:function(){return"mceu_"+count++},create:function(name,attrs,children){var elm=document.createElement(name);return global$3.DOM.setAttribs(elm,attrs),"string"==typeof children?elm.innerHTML=children:global$2.each(children,function(child){child.nodeType&&elm.appendChild(child)}),elm},createFragment:function(html){return global$3.DOM.createFragment(html)},getWindowSize:function(){return global$3.DOM.getViewPort()},getSize:function(elm){var width,height;if(elm.getBoundingClientRect){var rect=elm.getBoundingClientRect();width=Math.max(rect.width||rect.right-rect.left,elm.offsetWidth),height=Math.max(rect.height||rect.bottom-rect.bottom,elm.offsetHeight)}else width=elm.offsetWidth,height=elm.offsetHeight;return{width:width,height:height}},getPos:function(elm,root){return global$3.DOM.getPos(elm,root||funcs.getContainer())},getContainer:function(){return global$8.container?global$8.container:document.body},getViewPort:function(win){return global$3.DOM.getViewPort(win)},get:function(id){return document.getElementById(id)},addClass:function(elm,cls){return global$3.DOM.addClass(elm,cls)},removeClass:function(elm,cls){return global$3.DOM.removeClass(elm,cls)},hasClass:function(elm,cls){return global$3.DOM.hasClass(elm,cls)},toggleClass:function(elm,cls,state){return global$3.DOM.toggleClass(elm,cls,state)},css:function(elm,name,value){return global$3.DOM.setStyle(elm,name,value)},getRuntimeStyle:function(elm,name){return global$3.DOM.getStyle(elm,name,!0)},on:function(target,name,callback,scope){return global$3.DOM.bind(target,name,callback,scope)},off:function(target,name,callback){return global$3.DOM.unbind(target,name,callback);
},fire:function(target,name,args){return global$3.DOM.fire(target,name,args)},innerHtml:function(elm,html){global$3.DOM.setHTML(elm,html)}},isStatic=function(elm){return"static"===funcs.getRuntimeStyle(elm,"position")},isFixed=function(ctrl){return ctrl.state.get("fixed")},getUiContainerViewPort=function(customUiContainer){return{x:0,y:0,w:customUiContainer.scrollWidth-1,h:customUiContainer.scrollHeight-1}},getWindowViewPort=function(){var win=window,x=Math.max(win.pageXOffset,document.body.scrollLeft,document.documentElement.scrollLeft),y=Math.max(win.pageYOffset,document.body.scrollTop,document.documentElement.scrollTop),w=win.innerWidth||document.documentElement.clientWidth,h=win.innerHeight||document.documentElement.clientHeight;return{x:x,y:y,w:x+w,h:y+h}},getViewPortRect=function(ctrl){var customUiContainer=$_1jk3jvtcjh8lz3jy.getUiContainer(ctrl);return customUiContainer&&!isFixed(ctrl)?getUiContainerViewPort(customUiContainer):getWindowViewPort()},$_d97gfctrjh8lz3lm={testMoveRel:function(elm,rels){for(var viewPortRect=getViewPortRect(this),i=0;i<rels.length;i++){var pos=calculateRelativePosition(this,elm,rels[i]);if(isFixed(this)){if(pos.x>0&&pos.x+pos.w<viewPortRect.w&&pos.y>0&&pos.y+pos.h<viewPortRect.h)return rels[i]}else if(pos.x>viewPortRect.x&&pos.x+pos.w<viewPortRect.w&&pos.y>viewPortRect.y&&pos.y+pos.h<viewPortRect.h)return rels[i]}return rels[0]},moveRel:function(elm,rel){"string"!=typeof rel&&(rel=this.testMoveRel(elm,rel));var pos=calculateRelativePosition(this,elm,rel);return this.moveTo(pos.x,pos.y)},moveBy:function(dx,dy){var self=this,rect=self.layoutRect();return self.moveTo(rect.x+dx,rect.y+dy),self},moveTo:function(x,y){function constrain(value,max,size){return value<0?0:value+size>max?(value=max-size,value<0?0:value):value}var self=this;if(self.settings.constrainToViewport){var viewPortRect=getViewPortRect(this),layoutRect=self.layoutRect();x=constrain(x,viewPortRect.w,layoutRect.w),y=constrain(y,viewPortRect.h,layoutRect.h)}var uiContainer=$_1jk3jvtcjh8lz3jy.getUiContainer(self);return uiContainer&&isStatic(uiContainer)&&!isFixed(self)&&(x-=uiContainer.scrollLeft,y-=uiContainer.scrollTop),uiContainer&&(x+=1,y+=1),self.state.get("rendered")?self.layoutRect({x:x,y:y}).repaint():(self.settings.x=x,self.settings.y=y),self.fire("move",{x:x,y:y}),self}},global$10=tinymce.util.Tools.resolve("tinymce.util.Class"),global$11=tinymce.util.Tools.resolve("tinymce.util.EventDispatcher"),$_focdcktxjh8lz3mn={parseBox:function(value){var len,radix=10;if(value)return"number"==typeof value?(value=value||0,{top:value,left:value,bottom:value,right:value}):(value=value.split(" "),len=value.length,1===len?value[1]=value[2]=value[3]=value[0]:2===len?(value[2]=value[0],value[3]=value[1]):3===len&&(value[3]=value[1]),{top:parseInt(value[0],radix)||0,right:parseInt(value[1],radix)||0,bottom:parseInt(value[2],radix)||0,left:parseInt(value[3],radix)||0})},measureBox:function(elm,prefix){function getStyle(name){var defaultView=elm.ownerDocument.defaultView;if(defaultView){var computedStyle=defaultView.getComputedStyle(elm,null);return computedStyle?(name=name.replace(/[A-Z]/g,function(a){return"-"+a}),computedStyle.getPropertyValue(name)):null}return elm.currentStyle[name]}function getSide(name){var val=parseFloat(getStyle(name));return isNaN(val)?0:val}return{top:getSide(prefix+"TopWidth"),right:getSide(prefix+"RightWidth"),bottom:getSide(prefix+"BottomWidth"),left:getSide(prefix+"LeftWidth")}}};global$2.extend(ClassList.prototype,{add:function(cls){return cls&&!this.contains(cls)&&(this.cls._map[cls]=!0,this.cls.push(cls),this._change()),this},remove:function(cls){if(this.contains(cls)){var i=void 0;for(i=0;i<this.cls.length&&this.cls[i]!==cls;i++);this.cls.splice(i,1),delete this.cls._map[cls],this._change()}return this},toggle:function(cls,state){var curState=this.contains(cls);return curState!==state&&(curState?this.remove(cls):this.add(cls),this._change()),this},contains:function(cls){return!!this.cls._map[cls]},_change:function(){delete this.clsValue,this.onchange.call(this)}}),ClassList.prototype.toString=function(){var value;if(this.clsValue)return this.clsValue;value="";for(var i=0;i<this.cls.length;i++)i>0&&(value+=" "),value+=this.prefix+this.cls[i];return value};var Collection,Collection$1,proto,expression=/^([\w\\*]+)?(?:#([\w\-\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i,chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,whiteSpace=/^\s*|\s*$/g,Selector=global$10.extend({init:function(selector){function compileNameFilter(name){if(name)return name=name.toLowerCase(),function(item){return"*"===name||item.type===name}}function compileIdFilter(id){if(id)return function(item){return item._name===id}}function compileClassesFilter(classes){if(classes)return classes=classes.split("."),function(item){for(var i=classes.length;i--;)if(!item.classes.contains(classes[i]))return!1;return!0}}function compileAttrFilter(name,cmp,check){if(name)return function(item){var value=item[name]?item[name]():"";return cmp?"="===cmp?value===check:"*="===cmp?value.indexOf(check)>=0:"~="===cmp?(" "+value+" ").indexOf(" "+check+" ")>=0:"!="===cmp?value!==check:"^="===cmp?0===value.indexOf(check):"$="===cmp&&value.substr(value.length-check.length)===check:!!check}}function compilePsuedoFilter(name){var notSelectors;if(name)return name=/(?:not\((.+)\))|(.+)/i.exec(name),name[1]?(notSelectors=parseChunks(name[1],[]),function(item){return!match(item,notSelectors)}):(name=name[2],function(item,index,length){return"first"===name?0===index:"last"===name?index===length-1:"even"===name?index%2===0:"odd"===name?index%2===1:!!item[name]&&item[name]()})}function compile(selector,filters,direct){function add(filter){filter&&filters.push(filter)}var parts;return parts=expression.exec(selector.replace(whiteSpace,"")),add(compileNameFilter(parts[1])),add(compileIdFilter(parts[2])),add(compileClassesFilter(parts[3])),add(compileAttrFilter(parts[4],parts[5],parts[6])),add(compilePsuedoFilter(parts[7])),filters.pseudo=!!parts[7],filters.direct=direct,filters}function parseChunks(selector,selectors){var extra,matches,i,parts=[];do if(chunker.exec(""),matches=chunker.exec(selector),matches&&(selector=matches[3],parts.push(matches[1]),matches[2])){extra=matches[3];break}while(matches);for(extra&&parseChunks(extra,selectors),selector=[],i=0;i<parts.length;i++)">"!==parts[i]&&selector.push(compile(parts[i],[],">"===parts[i-1]));return selectors.push(selector),selectors}var match=this.match;this._selectors=parseChunks(selector,[])},match:function(control,selectors){var i,l,si,sl,selector,fi,fl,filters,index,length,siblings,count,item;for(selectors=selectors||this._selectors,i=0,l=selectors.length;i<l;i++){for(selector=selectors[i],sl=selector.length,item=control,count=0,si=sl-1;si>=0;si--)for(filters=selector[si];item;){if(filters.pseudo)for(siblings=item.parent().items(),index=length=siblings.length;index--&&siblings[index]!==item;);for(fi=0,fl=filters.length;fi<fl;fi++)if(!filters[fi](item,index,length)){fi=fl+1;break}if(fi===fl){count++;break}if(si===sl-1)break;item=item.parent()}if(count===sl)return!0}return!1},find:function(container){function collect(items,selector,index){var i,l,fi,fl,item,filters=selector[index];for(i=0,l=items.length;i<l;i++){for(item=items[i],fi=0,fl=filters.length;fi<fl;fi++)if(!filters[fi](item,i,l)){fi=fl+1;break}if(fi===fl)index===selector.length-1?matches.push(item):item.items&&collect(item.items(),selector,index+1);else if(filters.direct)return;item.items&&collect(item.items(),selector,index)}}var i,l,matches=[],selectors=this._selectors;if(container.items){for(i=0,l=selectors.length;i<l;i++)collect(container.items(),selectors[i],0);l>1&&(matches=unique(matches))}return Collection||(Collection=Selector.Collection),new Collection(matches)}}),push$1=Array.prototype.push,slice$1=Array.prototype.slice;proto={length:0,init:function(items){items&&this.add(items)},add:function(items){var self=this;return global$2.isArray(items)?push$1.apply(self,items):items instanceof Collection$1?self.add(items.toArray()):push$1.call(self,items),self},set:function(items){var i,self=this,len=self.length;for(self.length=0,self.add(items),i=self.length;i<len;i++)delete self[i];return self},filter:function(selector){var i,l,item,match,self=this,matches=[];for("string"==typeof selector?(selector=new Selector(selector),match=function(item){return selector.match(item)}):match=selector,i=0,l=self.length;i<l;i++)item=self[i],match(item)&&matches.push(item);return new Collection$1(matches)},slice:function(){return new Collection$1(slice$1.apply(this,arguments))},eq:function(index){return index===-1?this.slice(index):this.slice(index,+index+1)},each:function(callback){return global$2.each(this,callback),this},toArray:function(){return global$2.toArray(this)},indexOf:function(ctrl){for(var self=this,i=self.length;i--&&self[i]!==ctrl;);return i},reverse:function(){return new Collection$1(global$2.toArray(this).reverse())},hasClass:function(cls){return!!this[0]&&this[0].classes.contains(cls)},prop:function(name,value){var item,self=this;return void 0!==value?(self.each(function(item){item[name]&&item[name](value)}),self):(item=self[0],item&&item[name]?item[name]():void 0)},exec:function(name){var self=this,args=global$2.toArray(arguments).slice(1);return self.each(function(item){item[name]&&item[name].apply(item,args)}),self},remove:function(){for(var i=this.length;i--;)this[i].remove();return this},addClass:function(cls){return this.each(function(item){item.classes.add(cls)})},removeClass:function(cls){return this.each(function(item){item.classes.remove(cls)})}},global$2.each("fire on off show hide append prepend before after reflow".split(" "),function(name){proto[name]=function(){var args=global$2.toArray(arguments);return this.each(function(ctrl){name in ctrl&&ctrl[name].apply(ctrl,args)}),this}}),global$2.each("text name disabled active selected checked visible parent value data".split(" "),function(name){proto[name]=function(value){return this.prop(name,value)}}),Collection$1=global$10.extend(proto),Selector.Collection=Collection$1;var Collection$2=Collection$1,Binding=function(settings){this.create=settings.create};Binding.create=function(model,name){return new Binding({create:function(otherModel,otherName){var bindings,fromSelfToOther=function(e){otherModel.set(otherName,e.value)},fromOtherToSelf=function(e){model.set(name,e.value)};return otherModel.on("change:"+otherName,fromOtherToSelf),model.on("change:"+name,fromSelfToOther),bindings=otherModel._bindings,bindings||(bindings=otherModel._bindings=[],otherModel.on("destroy",function(){for(var i=bindings.length;i--;)bindings[i]()})),bindings.push(function(){model.off("change:"+name,fromSelfToOther)}),model.get(name)}})};var animationFrameRequested,Control,global$12=tinymce.util.Tools.resolve("tinymce.util.Observable"),ObservableObject=global$10.extend({Mixins:[global$12],init:function(data){var name,value;data=data||{};for(name in data)value=data[name],value instanceof Binding&&(data[name]=value.create(this,name));this.data=data},set:function(name,value){var key,args,oldValue=this.data[name];if(value instanceof Binding&&(value=value.create(this,name)),"object"==typeof name){for(key in name)this.set(key,name[key]);return this}return isEqual(oldValue,value)||(this.data[name]=value,args={target:this,name:name,value:value,oldValue:oldValue},this.fire("change:"+name,args),this.fire("change",args)),this},get:function(name){return this.data[name]},has:function(name){return name in this.data},bind:function(name){return Binding.create(this,name)},destroy:function(){this.fire("destroy")}}),dirtyCtrls={},$_ef12j5u4jh8lz3nl={add:function(ctrl){var parent=ctrl.parent();if(parent){if(!parent._layout||parent._layout.isNative())return;dirtyCtrls[parent._id]||(dirtyCtrls[parent._id]=parent),animationFrameRequested||(animationFrameRequested=!0,global$7.requestAnimationFrame(function(){var id,ctrl;animationFrameRequested=!1;for(id in dirtyCtrls)ctrl=dirtyCtrls[id],ctrl.state.get("rendered")&&ctrl.reflow();dirtyCtrls={}},document.body))}},remove:function(ctrl){dirtyCtrls[ctrl._id]&&delete dirtyCtrls[ctrl._id]}},hasMouseWheelEventSupport="onmousewheel"in document,hasWheelEventSupport=!1,classPrefix="mce-",idCounter=0,proto$1={Statics:{classPrefix:classPrefix},isRtl:function(){return Control.rtl},classPrefix:classPrefix,init:function(settings){function applyClasses(classes){var i;for(classes=classes.split(" "),i=0;i<classes.length;i++)self.classes.add(classes[i])}var classes,defaultClasses,self=this;self.settings=settings=global$2.extend({},self.Defaults,settings),self._id=settings.id||"mceu_"+idCounter++,self._aria={role:settings.role},self._elmCache={},self.$=global$9,self.state=new ObservableObject({visible:!0,active:!1,disabled:!1,value:""}),self.data=new ObservableObject(settings.data),self.classes=new ClassList(function(){self.state.get("rendered")&&(self.getEl().className=this.toString())}),self.classes.prefix=self.classPrefix,classes=settings.classes,classes&&(self.Defaults&&(defaultClasses=self.Defaults.classes,defaultClasses&&classes!==defaultClasses&&applyClasses(defaultClasses)),applyClasses(classes)),global$2.each("title text name visible disabled active value".split(" "),function(name){name in settings&&self[name](settings[name])}),self.on("click",function(){if(self.disabled())return!1}),self.settings=settings,self.borderBox=$_focdcktxjh8lz3mn.parseBox(settings.border),self.paddingBox=$_focdcktxjh8lz3mn.parseBox(settings.padding),self.marginBox=$_focdcktxjh8lz3mn.parseBox(settings.margin),settings.hidden&&self.hide()},Properties:"parent,name",getContainerElm:function(){var uiContainer=$_1jk3jvtcjh8lz3jy.getUiContainer(this);return uiContainer?uiContainer:funcs.getContainer()},getParentCtrl:function(elm){for(var ctrl,lookup=this.getRoot().controlIdLookup;elm&&lookup&&!(ctrl=lookup[elm.id]);)elm=elm.parentNode;return ctrl},initLayoutRect:function(){var borderBox,layoutRect,width,height,minWidth,minHeight,autoResize,startMinWidth,startMinHeight,initialSize,self=this,settings=self.settings,elm=self.getEl();borderBox=self.borderBox=self.borderBox||$_focdcktxjh8lz3mn.measureBox(elm,"border"),self.paddingBox=self.paddingBox||$_focdcktxjh8lz3mn.measureBox(elm,"padding"),self.marginBox=self.marginBox||$_focdcktxjh8lz3mn.measureBox(elm,"margin"),initialSize=funcs.getSize(elm),startMinWidth=settings.minWidth,startMinHeight=settings.minHeight,minWidth=startMinWidth||initialSize.width,minHeight=startMinHeight||initialSize.height,width=settings.width,height=settings.height,autoResize=settings.autoResize,autoResize="undefined"!=typeof autoResize?autoResize:!width&&!height,width=width||minWidth,height=height||minHeight;var deltaW=borderBox.left+borderBox.right,deltaH=borderBox.top+borderBox.bottom,maxW=settings.maxWidth||65535,maxH=settings.maxHeight||65535;return self._layoutRect=layoutRect={x:settings.x||0,y:settings.y||0,w:width,h:height,deltaW:deltaW,deltaH:deltaH,contentW:width-deltaW,contentH:height-deltaH,innerW:width-deltaW,innerH:height-deltaH,startMinWidth:startMinWidth||0,startMinHeight:startMinHeight||0,minW:Math.min(minWidth,maxW),minH:Math.min(minHeight,maxH),maxW:maxW,maxH:maxH,autoResize:autoResize,scrollW:0},self._lastLayoutRect={},layoutRect},layoutRect:function(newRect){var lastLayoutRect,size,deltaWidth,deltaHeight,repaintControls,self=this,curRect=self._layoutRect;return curRect||(curRect=self.initLayoutRect()),newRect?(deltaWidth=curRect.deltaW,deltaHeight=curRect.deltaH,void 0!==newRect.x&&(curRect.x=newRect.x),void 0!==newRect.y&&(curRect.y=newRect.y),void 0!==newRect.minW&&(curRect.minW=newRect.minW),void 0!==newRect.minH&&(curRect.minH=newRect.minH),size=newRect.w,void 0!==size&&(size=size<curRect.minW?curRect.minW:size,size=size>curRect.maxW?curRect.maxW:size,curRect.w=size,curRect.innerW=size-deltaWidth),size=newRect.h,void 0!==size&&(size=size<curRect.minH?curRect.minH:size,size=size>curRect.maxH?curRect.maxH:size,curRect.h=size,curRect.innerH=size-deltaHeight),size=newRect.innerW,void 0!==size&&(size=size<curRect.minW-deltaWidth?curRect.minW-deltaWidth:size,size=size>curRect.maxW-deltaWidth?curRect.maxW-deltaWidth:size,curRect.innerW=size,curRect.w=size+deltaWidth),size=newRect.innerH,void 0!==size&&(size=size<curRect.minH-deltaHeight?curRect.minH-deltaHeight:size,size=size>curRect.maxH-deltaHeight?curRect.maxH-deltaHeight:size,curRect.innerH=size,curRect.h=size+deltaHeight),void 0!==newRect.contentW&&(curRect.contentW=newRect.contentW),void 0!==newRect.contentH&&(curRect.contentH=newRect.contentH),lastLayoutRect=self._lastLayoutRect,lastLayoutRect.x===curRect.x&&lastLayoutRect.y===curRect.y&&lastLayoutRect.w===curRect.w&&lastLayoutRect.h===curRect.h||(repaintControls=Control.repaintControls,repaintControls&&repaintControls.map&&!repaintControls.map[self._id]&&(repaintControls.push(self),repaintControls.map[self._id]=!0),lastLayoutRect.x=curRect.x,lastLayoutRect.y=curRect.y,lastLayoutRect.w=curRect.w,lastLayoutRect.h=curRect.h),self):curRect},repaint:function(){var style,bodyStyle,bodyElm,rect,borderBox,borderW,borderH,lastRepaintRect,round,value,self=this;round=document.createRange?function(value){return value}:Math.round,style=self.getEl().style,rect=self._layoutRect,lastRepaintRect=self._lastRepaintRect||{},borderBox=self.borderBox,borderW=borderBox.left+borderBox.right,borderH=borderBox.top+borderBox.bottom,rect.x!==lastRepaintRect.x&&(style.left=round(rect.x)+"px",lastRepaintRect.x=rect.x),rect.y!==lastRepaintRect.y&&(style.top=round(rect.y)+"px",lastRepaintRect.y=rect.y),rect.w!==lastRepaintRect.w&&(value=round(rect.w-borderW),style.width=(value>=0?value:0)+"px",lastRepaintRect.w=rect.w),rect.h!==lastRepaintRect.h&&(value=round(rect.h-borderH),style.height=(value>=0?value:0)+"px",lastRepaintRect.h=rect.h),self._hasBody&&rect.innerW!==lastRepaintRect.innerW&&(value=round(rect.innerW),bodyElm=self.getEl("body"),bodyElm&&(bodyStyle=bodyElm.style,bodyStyle.width=(value>=0?value:0)+"px"),lastRepaintRect.innerW=rect.innerW),self._hasBody&&rect.innerH!==lastRepaintRect.innerH&&(value=round(rect.innerH),bodyElm=bodyElm||self.getEl("body"),bodyElm&&(bodyStyle=bodyStyle||bodyElm.style,bodyStyle.height=(value>=0?value:0)+"px"),lastRepaintRect.innerH=rect.innerH),self._lastRepaintRect=lastRepaintRect,self.fire("repaint",{},!1)},updateLayoutRect:function(){var self=this;self.parent()._lastRect=null,funcs.css(self.getEl(),{width:"",height:""}),self._layoutRect=self._lastRepaintRect=self._lastLayoutRect=null,self.initLayoutRect()},on:function(name,callback){function resolveCallbackName(name){var callback,scope;return"string"!=typeof name?name:function(e){return callback||self.parentsAndSelf().each(function(ctrl){var callbacks=ctrl.settings.callbacks;if(callbacks&&(callback=callbacks[name]))return scope=ctrl,!1}),callback?callback.call(scope,e):(e.action=name,void this.fire("execute",e))}}var self=this;return getEventDispatcher(self).on(name,resolveCallbackName(callback)),self},off:function(name,callback){return getEventDispatcher(this).off(name,callback),this},fire:function(name,args,bubble){var self=this;if(args=args||{},args.control||(args.control=self),args=getEventDispatcher(self).fire(name,args),bubble!==!1&&self.parent)for(var parent_1=self.parent();parent_1&&!args.isPropagationStopped();)parent_1.fire(name,args,!1),parent_1=parent_1.parent();return args},hasEventListeners:function(name){return getEventDispatcher(this).has(name)},parents:function(selector){var ctrl,self=this,parents=new Collection$2;for(ctrl=self.parent();ctrl;ctrl=ctrl.parent())parents.add(ctrl);return selector&&(parents=parents.filter(selector)),parents},parentsAndSelf:function(selector){return new Collection$2(this).add(this.parents(selector))},next:function(){var parentControls=this.parent().items();return parentControls[parentControls.indexOf(this)+1]},prev:function(){var parentControls=this.parent().items();return parentControls[parentControls.indexOf(this)-1]},innerHtml:function(html){return this.$el.html(html),this},getEl:function(suffix){var id=suffix?this._id+"-"+suffix:this._id;return this._elmCache[id]||(this._elmCache[id]=global$9("#"+id)[0]),this._elmCache[id]},show:function(){return this.visible(!0)},hide:function(){return this.visible(!1)},focus:function(){try{this.getEl().focus()}catch(ex){}return this},blur:function(){return this.getEl().blur(),this},aria:function(name,value){var self=this,elm=self.getEl(self.ariaTarget);return"undefined"==typeof value?self._aria[name]:(self._aria[name]=value,self.state.get("rendered")&&elm.setAttribute("role"===name?name:"aria-"+name,value),self)},encode:function(text,translate){return translate!==!1&&(text=this.translate(text)),(text||"").replace(/[&<>"]/g,function(match){return"&#"+match.charCodeAt(0)+";"})},translate:function(text){return Control.translate?Control.translate(text):text},before:function(items){var self=this,parent=self.parent();return parent&&parent.insert(items,parent.items().indexOf(self),!0),self},after:function(items){var self=this,parent=self.parent();return parent&&parent.insert(items,parent.items().indexOf(self)),self},remove:function(){var newItems,i,self=this,elm=self.getEl(),parent=self.parent();if(self.items){var controls=self.items().toArray();for(i=controls.length;i--;)controls[i].remove()}parent&&parent.items&&(newItems=[],parent.items().each(function(item){item!==self&&newItems.push(item)}),parent.items().set(newItems),parent._lastRect=null),self._eventsRoot&&self._eventsRoot===self&&global$9(elm).off();var lookup=self.getRoot().controlIdLookup;return lookup&&delete lookup[self._id],elm&&elm.parentNode&&elm.parentNode.removeChild(elm),self.state.set("rendered",!1),self.state.destroy(),self.fire("remove"),self},renderBefore:function(elm){return global$9(elm).before(this.renderHtml()),this.postRender(),this},renderTo:function(elm){return global$9(elm||this.getContainerElm()).append(this.renderHtml()),this.postRender(),this},preRender:function(){},render:function(){},renderHtml:function(){return'<div id="'+this._id+'" class="'+this.classes+'"></div>'},postRender:function(){var elm,box,parent,name,parentEventsRoot,self=this,settings=self.settings;self.$el=global$9(self.getEl()),self.state.set("rendered",!0);for(name in settings)0===name.indexOf("on")&&self.on(name.substr(2),settings[name]);if(self._eventsRoot){for(parent=self.parent();!parentEventsRoot&&parent;parent=parent.parent())parentEventsRoot=parent._eventsRoot;if(parentEventsRoot)for(name in parentEventsRoot._nativeEvents)self._nativeEvents[name]=!0}bindPendingEvents(self),settings.style&&(elm=self.getEl(),elm&&(elm.setAttribute("style",settings.style),elm.style.cssText=settings.style)),self.settings.border&&(box=self.borderBox,self.$el.css({"border-top-width":box.top,"border-right-width":box.right,"border-bottom-width":box.bottom,"border-left-width":box.left}));var root=self.getRoot();root.controlIdLookup||(root.controlIdLookup={}),root.controlIdLookup[self._id]=self;for(var key in self._aria)self.aria(key,self._aria[key]);self.state.get("visible")===!1&&(self.getEl().style.display="none"),self.bindStates(),self.state.on("change:visible",function(e){var parentCtrl,state=e.value;self.state.get("rendered")&&(self.getEl().style.display=state===!1?"none":"",self.getEl().getBoundingClientRect()),parentCtrl=self.parent(),parentCtrl&&(parentCtrl._lastRect=null),self.fire(state?"show":"hide"),$_ef12j5u4jh8lz3nl.add(self)}),self.fire("postrender",{},!1)},bindStates:function(){},scrollIntoView:function(align){function getOffset(elm,rootElm){var x,y,parent=elm;for(x=y=0;parent&&parent!==rootElm&&parent.nodeType;)x+=parent.offsetLeft||0,y+=parent.offsetTop||0,parent=parent.offsetParent;return{x:x,y:y}}var x,y,width,height,parentWidth,parentHeight,elm=this.getEl(),parentElm=elm.parentNode,pos=getOffset(elm,parentElm);return x=pos.x,y=pos.y,width=elm.offsetWidth,height=elm.offsetHeight,parentWidth=parentElm.clientWidth,parentHeight=parentElm.clientHeight,"end"===align?(x-=parentWidth-width,y-=parentHeight-height):"center"===align&&(x-=parentWidth/2-width/2,y-=parentHeight/2-height/2),parentElm.scrollLeft=x,parentElm.scrollTop=y,this},getRoot:function(){for(var rootControl,ctrl=this,parents=[];ctrl;){if(ctrl.rootControl){rootControl=ctrl.rootControl;break}parents.push(ctrl),rootControl=ctrl,ctrl=ctrl.parent()}rootControl||(rootControl=this);for(var i=parents.length;i--;)parents[i].rootControl=rootControl;return rootControl},reflow:function(){$_ef12j5u4jh8lz3nl.remove(this);var parent=this.parent();return parent&&parent._layout&&!parent._layout.isNative()&&parent.reflow(),this}};global$2.each("text title visible disabled active value".split(" "),function(name){proto$1[name]=function(value){return 0===arguments.length?this.state.get(name):("undefined"!=typeof value&&this.state.set(name,value),this)}}),Control=global$10.extend(proto$1);var documentClickHandler,documentScrollHandler,windowResizeHandler,hasModal,Control$1=Control,hasTabstopData=function(elm){return!!elm.getAttribute("data-mce-tabstop")},selectorCache={},Container=Control$1.extend({init:function(settings){var self=this;self._super(settings),settings=self.settings,settings.fixed&&self.state.set("fixed",!0),self._items=new Collection$2,self.isRtl()&&self.classes.add("rtl"),self.bodyClasses=new ClassList(function(){self.state.get("rendered")&&(self.getEl("body").className=this.toString())}),self.bodyClasses.prefix=self.classPrefix,self.classes.add("container"),self.bodyClasses.add("container-body"),settings.containerCls&&self.classes.add(settings.containerCls),self._layout=global$4.create((settings.layout||"")+"layout"),self.settings.items?self.add(self.settings.items):self.add(self.render()),self._hasBody=!0},items:function(){return this._items},find:function(selector){return selector=selectorCache[selector]=selectorCache[selector]||new Selector(selector),selector.find(this)},add:function(items){var self=this;return self.items().add(self.create(items)).parent(self),self},focus:function(keyboard){var focusCtrl,keyboardNav,items,self=this;return keyboard&&(keyboardNav=self.keyboardNav||self.parents().eq(-1)[0].keyboardNav)?void keyboardNav.focusFirst(self):(items=self.find("*"),self.statusbar&&items.add(self.statusbar.items()),items.each(function(ctrl){return ctrl.settings.autofocus?(focusCtrl=null,!1):void(ctrl.canFocus&&(focusCtrl=focusCtrl||ctrl))}),focusCtrl&&focusCtrl.focus(),self)},replace:function(oldItem,newItem){for(var ctrlElm,items=this.items(),i=items.length;i--;)if(items[i]===oldItem){items[i]=newItem;break}i>=0&&(ctrlElm=newItem.getEl(),ctrlElm&&ctrlElm.parentNode.removeChild(ctrlElm),ctrlElm=oldItem.getEl(),ctrlElm&&ctrlElm.parentNode.removeChild(ctrlElm)),newItem.parent(this)},create:function(items){var settings,self=this,ctrlItems=[];return global$2.isArray(items)||(items=[items]),global$2.each(items,function(item){item&&(item instanceof Control$1||("string"==typeof item&&(item={type:item}),settings=global$2.extend({},self.settings.defaults,item),item.type=settings.type=settings.type||item.type||self.settings.defaultType||(settings.defaults?settings.defaults.type:null),item=global$4.create(settings)),ctrlItems.push(item))}),ctrlItems},renderNew:function(){var self=this;return self.items().each(function(ctrl,index){var containerElm;ctrl.parent(self),ctrl.state.get("rendered")||(containerElm=self.getEl("body"),containerElm.hasChildNodes()&&index<=containerElm.childNodes.length-1?global$9(containerElm.childNodes[index]).before(ctrl.renderHtml()):global$9(containerElm).append(ctrl.renderHtml()),ctrl.postRender(),$_ef12j5u4jh8lz3nl.add(ctrl))}),self._layout.applyClasses(self.items().filter(":visible")),self._lastRect=null,self},append:function(items){return this.add(items).renderNew()},prepend:function(items){var self=this;return self.items().set(self.create(items).concat(self.items().toArray())),self.renderNew()},insert:function(items,index,before){var curItems,beforeItems,afterItems,self=this;return items=self.create(items),curItems=self.items(),!before&&index<curItems.length-1&&(index+=1),index>=0&&index<curItems.length&&(beforeItems=curItems.slice(0,index).toArray(),afterItems=curItems.slice(index).toArray(),curItems.set(beforeItems.concat(items,afterItems))),self.renderNew()},fromJSON:function(data){var self=this;for(var name_1 in data)self.find("#"+name_1).value(data[name_1]);return self},toJSON:function(){var self=this,data={};return self.find("*").each(function(ctrl){var name=ctrl.name(),value=ctrl.value();name&&"undefined"!=typeof value&&(data[name]=value)}),data},renderHtml:function(){var self=this,layout=self._layout,role=this.settings.role;return self.preRender(),layout.preRender(self),'<div id="'+self._id+'" class="'+self.classes+'"'+(role?' role="'+this.settings.role+'"':"")+'><div id="'+self._id+'-body" class="'+self.bodyClasses+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></div>"},postRender:function(){var box,self=this;return self.items().exec("postRender"),self._super(),self._layout.postRender(self),self.state.set("rendered",!0),self.settings.style&&self.$el.css(self.settings.style),self.settings.border&&(box=self.borderBox,self.$el.css({"border-top-width":box.top,"border-right-width":box.right,"border-bottom-width":box.bottom,"border-left-width":box.left})),self.parent()||(self.keyboardNav=KeyboardNavigation({root:self})),self},initLayoutRect:function(){var self=this,layoutRect=self._super();return self._layout.recalc(self),layoutRect},recalc:function(){var self=this,rect=self._layoutRect,lastRect=self._lastRect;if(!lastRect||lastRect.w!==rect.w||lastRect.h!==rect.h)return self._layout.recalc(self),rect=self.layoutRect(),self._lastRect={x:rect.x,y:rect.y,w:rect.w,h:rect.h},!0},reflow:function(){var i;if($_ef12j5u4jh8lz3nl.remove(this),this.visible()){for(Control$1.repaintControls=[],Control$1.repaintControls.map={},this.recalc(),i=Control$1.repaintControls.length;i--;)Control$1.repaintControls[i].repaint();"flow"!==this.settings.layout&&"stack"!==this.settings.layout&&this.repaint(),Control$1.repaintControls=[]}return this}}),$_4acv48u6jh8lz3ns={init:function(){var self=this;self.on("repaint",self.renderScroll)},renderScroll:function(){function repaintScroll(){function repaintAxis(axisName,posName,sizeName,contentSizeName,hasScroll,ax){var containerElm,scrollBarElm,scrollThumbElm,containerSize,scrollSize,ratio,rect,posNameLower,sizeNameLower;if(scrollBarElm=self.getEl("scroll"+axisName)){if(posNameLower=posName.toLowerCase(),sizeNameLower=sizeName.toLowerCase(),global$9(self.getEl("absend")).css(posNameLower,self.layoutRect()[contentSizeName]-1),!hasScroll)return void global$9(scrollBarElm).css("display","none");global$9(scrollBarElm).css("display","block"),containerElm=self.getEl("body"),scrollThumbElm=self.getEl("scroll"+axisName+"t"),containerSize=containerElm["client"+sizeName]-2*margin,containerSize-=hasScrollH&&hasScrollV?scrollBarElm["client"+ax]:0,scrollSize=containerElm["scroll"+sizeName],ratio=containerSize/scrollSize,rect={},rect[posNameLower]=containerElm["offset"+posName]+margin,rect[sizeNameLower]=containerSize,global$9(scrollBarElm).css(rect),rect={},rect[posNameLower]=containerElm["scroll"+posName]*ratio,rect[sizeNameLower]=containerSize*ratio,global$9(scrollThumbElm).css(rect)}}var hasScrollH,hasScrollV,bodyElm;bodyElm=self.getEl("body"),hasScrollH=bodyElm.scrollWidth>bodyElm.clientWidth,hasScrollV=bodyElm.scrollHeight>bodyElm.clientHeight,repaintAxis("h","Left","Width","contentW",hasScrollH,"Height"),repaintAxis("v","Top","Height","contentH",hasScrollV,"Width")}function addScroll(){function addScrollAxis(axisName,posName,sizeName,deltaPosName,ax){var scrollStart,axisId=self._id+"-scroll"+axisName,prefix=self.classPrefix;global$9(self.getEl()).append('<div id="'+axisId+'" class="'+prefix+"scrollbar "+prefix+"scrollbar-"+axisName+'"><div id="'+axisId+'t" class="'+prefix+'scrollbar-thumb"></div></div>'),self.draghelper=new DragHelper(axisId+"t",{
start:function(){scrollStart=self.getEl("body")["scroll"+posName],global$9("#"+axisId).addClass(prefix+"active")},drag:function(e){var ratio,hasScrollH,hasScrollV,containerSize,layoutRect=self.layoutRect();hasScrollH=layoutRect.contentW>layoutRect.innerW,hasScrollV=layoutRect.contentH>layoutRect.innerH,containerSize=self.getEl("body")["client"+sizeName]-2*margin,containerSize-=hasScrollH&&hasScrollV?self.getEl("scroll"+axisName)["client"+ax]:0,ratio=containerSize/self.getEl("body")["scroll"+sizeName],self.getEl("body")["scroll"+posName]=scrollStart+e["delta"+deltaPosName]/ratio},stop:function(){global$9("#"+axisId).removeClass(prefix+"active")}})}self.classes.add("scroll"),addScrollAxis("v","Top","Height","Y","Width"),addScrollAxis("h","Left","Width","X","Height")}var self=this,margin=2;self.settings.autoScroll&&(self._hasScroll||(self._hasScroll=!0,addScroll(),self.on("wheel",function(e){var bodyEl=self.getEl("body");bodyEl.scrollLeft+=10*(e.deltaX||0),bodyEl.scrollTop+=10*e.deltaY,repaintScroll()}),global$9(self.getEl("body")).on("scroll",repaintScroll)),repaintScroll())}},Panel=Container.extend({Defaults:{layout:"fit",containerCls:"panel"},Mixins:[$_4acv48u6jh8lz3ns],renderHtml:function(){var self=this,layout=self._layout,innerHtml=self.settings.html;return self.preRender(),layout.preRender(self),"undefined"==typeof innerHtml?innerHtml='<div id="'+self._id+'-body" class="'+self.bodyClasses+'">'+layout.renderHtml(self)+"</div>":("function"==typeof innerHtml&&(innerHtml=innerHtml.call(self)),self._hasBody=!1),'<div id="'+self._id+'" class="'+self.classes+'" hidefocus="1" tabindex="-1" role="group">'+(self._preBodyHtml||"")+innerHtml+"</div>"}}),$_8a2gtru8jh8lz3ny={resizeToContent:function(){this._layoutRect.autoResize=!0,this._lastRect=null,this.reflow()},resizeTo:function(w,h){if(w<=1||h<=1){var rect=funcs.getWindowSize();w=w<=1?w*rect.w:w,h=h<=1?h*rect.h:h}return this._layoutRect.autoResize=!1,this.layoutRect({minW:w,minH:h,w:w,h:h}).reflow()},resizeBy:function(dw,dh){var self=this,rect=self.layoutRect();return self.resizeTo(rect.w+dw,rect.h+dh)}},visiblePanels=[],zOrder=[],FloatPanel=Panel.extend({Mixins:[$_d97gfctrjh8lz3lm,$_8a2gtru8jh8lz3ny],init:function(settings){var self=this;self._super(settings),self._eventsRoot=self,self.classes.add("floatpanel"),settings.autohide&&(bindDocumentClickHandler(),bindWindowResizeHandler(),visiblePanels.push(self)),settings.autofix&&(bindDocumentScrollHandler(),self.on("move",function(){repositionPanel(this)})),self.on("postrender show",function(e){if(e.control===self){var $modalBlockEl_1,prefix_1=self.classPrefix;self.modal&&!hasModal&&($modalBlockEl_1=global$9("#"+prefix_1+"modal-block",self.getContainerElm()),$modalBlockEl_1[0]||($modalBlockEl_1=global$9('<div id="'+prefix_1+'modal-block" class="'+prefix_1+"reset "+prefix_1+'fade"></div>').appendTo(self.getContainerElm())),global$7.setTimeout(function(){$modalBlockEl_1.addClass(prefix_1+"in"),global$9(self.getEl()).addClass(prefix_1+"in")}),hasModal=!0),addRemove(!0,self)}}),self.on("show",function(){self.parents().each(function(ctrl){if(ctrl.state.get("fixed"))return self.fixed(!0),!1})}),settings.popover&&(self._preBodyHtml='<div class="'+self.classPrefix+'arrow"></div>',self.classes.add("popover").add("bottom").add(self.isRtl()?"end":"start")),self.aria("label",settings.ariaLabel),self.aria("labelledby",self._id),self.aria("describedby",self.describedBy||self._id+"-none")},fixed:function(state){var self=this;if(self.state.get("fixed")!==state){if(self.state.get("rendered")){var viewport=funcs.getViewPort();state?self.layoutRect().y-=viewport.y:self.layoutRect().y+=viewport.y}self.classes.toggle("fixed",state),self.state.set("fixed",state)}return self},show:function(){var i,self=this,state=self._super();for(i=visiblePanels.length;i--&&visiblePanels[i]!==self;);return i===-1&&visiblePanels.push(self),state},hide:function(){return removeVisiblePanel(this),addRemove(!1,this),this._super()},hideAll:function(){FloatPanel.hideAll()},close:function(){var self=this;return self.fire("close").isDefaultPrevented()||(self.remove(),addRemove(!1,self)),self},remove:function(){removeVisiblePanel(this),this._super()},postRender:function(){var self=this;return self.settings.bodyRole&&this.getEl("body").setAttribute("role",self.settings.bodyRole),self._super()}});FloatPanel.hideAll=function(){for(var i=visiblePanels.length;i--;){var panel=visiblePanels[i];panel&&panel.settings.autohide&&(panel.hide(),visiblePanels.splice(i,1))}};var isFixed$1=function(inlineToolbarContainer,editor){return!(!inlineToolbarContainer||editor.settings.ui_container)},render$1=function(editor,theme,args){var panel,inlineToolbarContainer,DOM=global$3.DOM,fixedToolbarContainer=getFixedToolbarContainer(editor);fixedToolbarContainer&&(inlineToolbarContainer=DOM.select(fixedToolbarContainer)[0]);var reposition=function(){if(panel&&panel.moveRel&&panel.visible()&&!panel._fixed){var scrollContainer=editor.selection.getScrollContainer(),body=editor.getBody(),deltaX=0,deltaY=0;if(scrollContainer){var bodyPos=DOM.getPos(body),scrollContainerPos=DOM.getPos(scrollContainer);deltaX=Math.max(0,scrollContainerPos.x-bodyPos.x),deltaY=Math.max(0,scrollContainerPos.y-bodyPos.y)}panel.fixed(!1).moveRel(body,editor.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl","tr-br"]).moveBy(deltaX,deltaY)}},show=function(){panel&&(panel.show(),reposition(),DOM.addClass(editor.getBody(),"mce-edit-focus"))},hide=function(){panel&&(panel.hide(),FloatPanel.hideAll(),DOM.removeClass(editor.getBody(),"mce-edit-focus"))},render=function(){return panel?void(panel.visible()||show()):(panel=theme.panel=global$4.create({type:inlineToolbarContainer?"panel":"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:isFixed$1(inlineToolbarContainer,editor),fixed:isFixed$1(inlineToolbarContainer,editor),border:1,items:[hasMenubar(editor)===!1?null:{type:"menubar",border:"0 0 1 0",items:$_8i78rftgjh8lz3ka.createMenuButtons(editor)},$_fudqhrtfjh8lz3k7.createToolbars(editor,getToolbarSize(editor))]}),$_1jk3jvtcjh8lz3jy.setUiContainer(editor,panel),$_aycuj2t7jh8lz3jp.fireBeforeRenderUI(editor),inlineToolbarContainer?panel.renderTo(inlineToolbarContainer).reflow():panel.renderTo().reflow(),$_47hpztt8jh8lz3jq.addKeys(editor,panel),show(),$_5kodmdt9jh8lz3js.addContextualToolbars(editor),editor.on("nodeChange",reposition),editor.on("ResizeWindow",reposition),editor.on("activate",show),editor.on("deactivate",hide),void editor.nodeChanged())};return editor.settings.content_editable=!0,editor.on("focus",function(){isSkinDisabled(editor)===!1&&args.skinUiCss?DOM.styleSheetLoader.load(args.skinUiCss,render,render):render()}),editor.on("blur hide",hide),editor.on("remove",function(){panel&&(panel.remove(),panel=null)}),isSkinDisabled(editor)===!1&&args.skinUiCss?DOM.styleSheetLoader.load(args.skinUiCss,$_231e94tmjh8lz3ku.fireSkinLoaded(editor)):$_231e94tmjh8lz3ku.fireSkinLoaded(editor)(),{}},$_7wdylstnjh8lz3kv={render:render$1},setup=function(editor,theme){var throbber;editor.on("ProgressState",function(e){throbber=throbber||new Throbber(theme.panel.getEl("body")),e.state?throbber.show(e.time):throbber.hide()})},$_e9w0qfu9jh8lz3nz={setup:setup},renderUI=function(editor,theme,args){var skinUrl=getSkinUrl(editor);return skinUrl&&(args.skinUiCss=skinUrl+"/skin.min.css",editor.contentCSS.push(skinUrl+"/content"+(editor.inline?".inline":"")+".min.css")),$_e9w0qfu9jh8lz3nz.setup(editor,theme),isInline(editor)?$_7wdylstnjh8lz3kv.render(editor,theme,args):$_4cj0a3t3jh8lz3jk.render(editor,theme,args)},$_5ent4szjh8lz3ja={renderUI:renderUI},Tooltip=Control$1.extend({Mixins:[$_d97gfctrjh8lz3lm],Defaults:{classes:"widget tooltip tooltip-n"},renderHtml:function(){var self=this,prefix=self.classPrefix;return'<div id="'+self._id+'" class="'+self.classes+'" role="presentation"><div class="'+prefix+'tooltip-arrow"></div><div class="'+prefix+'tooltip-inner">'+self.encode(self.state.get("text"))+"</div></div>"},bindStates:function(){var self=this;return self.state.on("change:text",function(e){self.getEl().lastChild.innerHTML=self.encode(e.value)}),self._super()},repaint:function(){var style,rect,self=this;style=self.getEl().style,rect=self._layoutRect,style.left=rect.x+"px",style.top=rect.y+"px",style.zIndex=131070}}),Widget=Control$1.extend({init:function(settings){var self=this;self._super(settings),settings=self.settings,self.canFocus=!0,settings.tooltip&&Widget.tooltips!==!1&&(self.on("mouseenter",function(e){var tooltip=self.tooltip().moveTo(-65535);if(e.control===self){var rel=tooltip.text(settings.tooltip).show().testMoveRel(self.getEl(),["bc-tc","bc-tl","bc-tr"]);tooltip.classes.toggle("tooltip-n","bc-tc"===rel),tooltip.classes.toggle("tooltip-nw","bc-tl"===rel),tooltip.classes.toggle("tooltip-ne","bc-tr"===rel),tooltip.moveRel(self.getEl(),rel)}else tooltip.hide()}),self.on("mouseleave mousedown click",function(){self.tooltip().remove(),self._tooltip=null})),self.aria("label",settings.ariaLabel||settings.tooltip)},tooltip:function(){return this._tooltip||(this._tooltip=new Tooltip({type:"tooltip"}),$_1jk3jvtcjh8lz3jy.inheritUiContainer(this,this._tooltip),this._tooltip.renderTo()),this._tooltip},postRender:function(){var self=this,settings=self.settings;self._super(),self.parent()||!settings.width&&!settings.height||(self.initLayoutRect(),self.repaint()),settings.autofocus&&self.focus()},bindStates:function(){function disable(state){self.aria("disabled",state),self.classes.toggle("disabled",state)}function active(state){self.aria("pressed",state),self.classes.toggle("active",state)}var self=this;return self.state.on("change:disabled",function(e){disable(e.value)}),self.state.on("change:active",function(e){active(e.value)}),self.state.get("disabled")&&disable(!0),self.state.get("active")&&active(!0),self._super()},remove:function(){this._super(),this._tooltip&&(this._tooltip.remove(),this._tooltip=null)}}),Progress=Widget.extend({Defaults:{value:0},init:function(settings){var self=this;self._super(settings),self.classes.add("progress"),self.settings.filter||(self.settings.filter=function(value){return Math.round(value)})},renderHtml:function(){var self=this,id=self._id,prefix=this.classPrefix;return'<div id="'+id+'" class="'+self.classes+'"><div class="'+prefix+'bar-container"><div class="'+prefix+'bar"></div></div><div class="'+prefix+'text">0%</div></div>'},postRender:function(){var self=this;return self._super(),self.value(self.settings.value),self},bindStates:function(){function setValue(value){value=self.settings.filter(value),self.getEl().lastChild.innerHTML=value+"%",self.getEl().firstChild.firstChild.style.width=value+"%"}var self=this;return self.state.on("change:value",function(e){setValue(e.value)}),setValue(self.state.get("value")),self._super()}}),updateLiveRegion=function(ctx,text){ctx.getEl().lastChild.textContent=text+(ctx.progressBar?" "+ctx.progressBar.value()+"%":"")},Notification=Control$1.extend({Mixins:[$_d97gfctrjh8lz3lm],Defaults:{classes:"widget notification"},init:function(settings){var self=this;self._super(settings),self.maxWidth=settings.maxWidth,settings.text&&self.text(settings.text),settings.icon&&(self.icon=settings.icon),settings.color&&(self.color=settings.color),settings.type&&self.classes.add("notification-"+settings.type),settings.timeout&&(settings.timeout<0||settings.timeout>0)&&!settings.closeButton?self.closeButton=!1:(self.classes.add("has-close"),self.closeButton=!0),settings.progressBar&&(self.progressBar=new Progress),self.on("click",function(e){e.target.className.indexOf(self.classPrefix+"close")!==-1&&self.close()})},renderHtml:function(){var self=this,prefix=self.classPrefix,icon="",closeButton="",progressBar="",notificationStyle="";return self.icon&&(icon='<i class="'+prefix+"ico "+prefix+"i-"+self.icon+'"></i>'),notificationStyle=' style="max-width: '+self.maxWidth+"px;"+(self.color?"background-color: "+self.color+';"':'"'),self.closeButton&&(closeButton='<button type="button" class="'+prefix+'close" aria-hidden="true">×</button>'),self.progressBar&&(progressBar=self.progressBar.renderHtml()),'<div id="'+self._id+'" class="'+self.classes+'"'+notificationStyle+' role="presentation">'+icon+'<div class="'+prefix+'notification-inner">'+self.state.get("text")+"</div>"+progressBar+closeButton+'<div style="clip: rect(1px, 1px, 1px, 1px);height: 1px;overflow: hidden;position: absolute;width: 1px;" aria-live="assertive" aria-relevant="additions" aria-atomic="true"></div></div>'},postRender:function(){var self=this;return global$7.setTimeout(function(){self.$el.addClass(self.classPrefix+"in"),updateLiveRegion(self,self.state.get("text"))},100),self._super()},bindStates:function(){var self=this;return self.state.on("change:text",function(e){self.getEl().firstChild.innerHTML=e.value,updateLiveRegion(self,e.value)}),self.progressBar&&(self.progressBar.bindStates(),self.progressBar.state.on("change:value",function(e){updateLiveRegion(self,self.state.get("text"))})),self._super()},close:function(){var self=this;return self.fire("close").isDefaultPrevented()||self.remove(),self},repaint:function(){var style,rect,self=this;style=self.getEl().style,rect=self._layoutRect,style.left=rect.x+"px",style.top=rect.y+"px",style.zIndex=65534}}),windows=[],oldMetaValue="",Window=FloatPanel.extend({modal:!0,Defaults:{border:1,layout:"flex",containerCls:"panel",role:"dialog",callbacks:{submit:function(){this.fire("submit",{data:this.toJSON()})},close:function(){this.close()}}},init:function(settings){var self=this;self._super(settings),self.isRtl()&&self.classes.add("rtl"),self.classes.add("window"),self.bodyClasses.add("window-body"),self.state.set("fixed",!0),settings.buttons&&(self.statusbar=new Panel({layout:"flex",border:"1 0 0 0",spacing:3,padding:10,align:"center",pack:self.isRtl()?"start":"end",defaults:{type:"button"},items:settings.buttons}),self.statusbar.classes.add("foot"),self.statusbar.parent(self)),self.on("click",function(e){var closeClass=self.classPrefix+"close";(funcs.hasClass(e.target,closeClass)||funcs.hasClass(e.target.parentNode,closeClass))&&self.close()}),self.on("cancel",function(){self.close()}),self.on("move",function(e){e.control===self&&FloatPanel.hideAll()}),self.aria("describedby",self.describedBy||self._id+"-none"),self.aria("label",settings.title),self._fullscreen=!1},recalc:function(){var layoutRect,width,x,needsRecalc,self=this,statusbar=self.statusbar;self._fullscreen&&(self.layoutRect(funcs.getWindowSize()),self.layoutRect().contentH=self.layoutRect().innerH),self._super(),layoutRect=self.layoutRect(),self.settings.title&&!self._fullscreen&&(width=layoutRect.headerW,width>layoutRect.w&&(x=layoutRect.x-Math.max(0,width/2),self.layoutRect({w:width,x:x}),needsRecalc=!0)),statusbar&&(statusbar.layoutRect({w:self.layoutRect().innerW}).recalc(),width=statusbar.layoutRect().minW+layoutRect.deltaW,width>layoutRect.w&&(x=layoutRect.x-Math.max(0,width-layoutRect.w),self.layoutRect({w:width,x:x}),needsRecalc=!0)),needsRecalc&&self.recalc()},initLayoutRect:function(){var headEl,self=this,layoutRect=self._super(),deltaH=0;if(self.settings.title&&!self._fullscreen){headEl=self.getEl("head");var size=funcs.getSize(headEl);layoutRect.headerW=size.width,layoutRect.headerH=size.height,deltaH+=layoutRect.headerH}self.statusbar&&(deltaH+=self.statusbar.layoutRect().h),layoutRect.deltaH+=deltaH,layoutRect.minH+=deltaH,layoutRect.h+=deltaH;var rect=funcs.getWindowSize();return layoutRect.x=self.settings.x||Math.max(0,rect.w/2-layoutRect.w/2),layoutRect.y=self.settings.y||Math.max(0,rect.h/2-layoutRect.h/2),layoutRect},renderHtml:function(){var self=this,layout=self._layout,id=self._id,prefix=self.classPrefix,settings=self.settings,headerHtml="",footerHtml="",html=settings.html;return self.preRender(),layout.preRender(self),settings.title&&(headerHtml='<div id="'+id+'-head" class="'+prefix+'window-head"><div id="'+id+'-title" class="'+prefix+'title">'+self.encode(settings.title)+'</div><div id="'+id+'-dragh" class="'+prefix+'dragh"></div><button type="button" class="'+prefix+'close" aria-hidden="true"><i class="mce-ico mce-i-remove"></i></button></div>'),settings.url&&(html='<iframe src="'+settings.url+'" tabindex="-1"></iframe>'),"undefined"==typeof html&&(html=layout.renderHtml(self)),self.statusbar&&(footerHtml=self.statusbar.renderHtml()),'<div id="'+id+'" class="'+self.classes+'" hidefocus="1"><div class="'+self.classPrefix+'reset" role="application">'+headerHtml+'<div id="'+id+'-body" class="'+self.bodyClasses+'">'+html+"</div>"+footerHtml+"</div></div>"},fullscreen:function(state){var slowRendering,layoutRect,self=this,documentElement=document.documentElement,prefix=self.classPrefix;if(state!==self._fullscreen)if(global$9(window).on("resize",function(){var time;if(self._fullscreen)if(slowRendering)self._timer||(self._timer=global$7.setTimeout(function(){var rect=funcs.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h),self._timer=0},50));else{time=(new Date).getTime();var rect=funcs.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h),(new Date).getTime()-time>50&&(slowRendering=!0)}}),layoutRect=self.layoutRect(),self._fullscreen=state,state){self._initial={x:layoutRect.x,y:layoutRect.y,w:layoutRect.w,h:layoutRect.h},self.borderBox=$_focdcktxjh8lz3mn.parseBox("0"),self.getEl("head").style.display="none",layoutRect.deltaH-=layoutRect.headerH+2,global$9([documentElement,document.body]).addClass(prefix+"fullscreen"),self.classes.add("fullscreen");var rect=funcs.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h)}else self.borderBox=$_focdcktxjh8lz3mn.parseBox(self.settings.border),self.getEl("head").style.display="",layoutRect.deltaH+=layoutRect.headerH,global$9([documentElement,document.body]).removeClass(prefix+"fullscreen"),self.classes.remove("fullscreen"),self.moveTo(self._initial.x,self._initial.y).resizeTo(self._initial.w,self._initial.h);return self.reflow()},postRender:function(){var startPos,self=this;setTimeout(function(){self.classes.add("in"),self.fire("open")},0),self._super(),self.statusbar&&self.statusbar.postRender(),self.focus(),this.dragHelper=new DragHelper(self._id+"-dragh",{start:function(){startPos={x:self.layoutRect().x,y:self.layoutRect().y}},drag:function(e){self.moveTo(startPos.x+e.deltaX,startPos.y+e.deltaY)}}),self.on("submit",function(e){e.isDefaultPrevented()||self.close()}),windows.push(self),toggleFullScreenState(!0)},submit:function(){return this.fire("submit",{data:this.toJSON()})},remove:function(){var i,self=this;for(self.dragHelper.destroy(),self._super(),self.statusbar&&this.statusbar.remove(),toggleBodyFullScreenClasses(self.classPrefix,!1),i=windows.length;i--;)windows[i]===self&&windows.splice(i,1);toggleFullScreenState(windows.length>0)},getContentWindow:function(){var ifr=this.getEl().getElementsByTagName("iframe")[0];return ifr?ifr.contentWindow:null}});handleWindowResize();var MessageBox=Window.extend({init:function(settings){settings={border:1,padding:20,layout:"flex",pack:"center",align:"center",containerCls:"panel",autoScroll:!0,buttons:{type:"button",text:"Ok",action:"ok"},items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200}},this._super(settings)},Statics:{OK:1,OK_CANCEL:2,YES_NO:3,YES_NO_CANCEL:4,msgBox:function(settings){function createButton(text,status,primary){return{type:"button",text:text,subtype:primary?"primary":"",onClick:function(e){e.control.parents()[1].close(),callback(status)}}}var buttons,callback=settings.callback||function(){};switch(settings.buttons){case MessageBox.OK_CANCEL:buttons=[createButton("Ok",!0,!0),createButton("Cancel",!1)];break;case MessageBox.YES_NO:case MessageBox.YES_NO_CANCEL:buttons=[createButton("Yes",1,!0),createButton("No",0)],settings.buttons===MessageBox.YES_NO_CANCEL&&buttons.push(createButton("Cancel",-1));break;default:buttons=[createButton("Ok",!0,!0)]}return new Window({padding:20,x:settings.x,y:settings.y,minWidth:300,minHeight:100,layout:"flex",pack:"center",align:"center",buttons:buttons,title:settings.title,role:"alertdialog",items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200,text:settings.text},onPostRender:function(){this.aria("describedby",this.items()[0]._id)},onClose:settings.onClose,onCancel:function(){callback(!1)}}).renderTo(document.body).reflow()},alert:function(settings,callback){return"string"==typeof settings&&(settings={text:settings}),settings.callback=callback,MessageBox.msgBox(settings)},confirm:function(settings,callback){return"string"==typeof settings&&(settings={text:settings}),settings.callback=callback,settings.buttons=MessageBox.OK_CANCEL,MessageBox.msgBox(settings)}}}),get=function(editor){var renderUI=function(args){return $_5ent4szjh8lz3ja.renderUI(editor,this,args)},resizeTo=function(w,h){return $_5toavetjjh8lz3ko.resizeTo(editor,w,h)},resizeBy=function(dw,dh){return $_5toavetjjh8lz3ko.resizeBy(editor,dw,dh)},getNotificationManagerImpl=function(){return NotificationManagerImpl(editor)},getWindowManagerImpl=function(){return WindowManagerImpl(editor)};return{renderUI:renderUI,resizeTo:resizeTo,resizeBy:resizeBy,getNotificationManagerImpl:getNotificationManagerImpl,getWindowManagerImpl:getWindowManagerImpl}},$_1os0v5syjh8lz3j9={get:get},Layout=global$10.extend({Defaults:{firstControlClass:"first",lastControlClass:"last"},init:function(settings){this.settings=global$2.extend({},this.Defaults,settings)},preRender:function(container){container.bodyClasses.add(this.settings.containerClass)},applyClasses:function(items){var firstClass,lastClass,firstItem,lastItem,self=this,settings=self.settings;firstClass=settings.firstControlClass,lastClass=settings.lastControlClass,items.each(function(item){item.classes.remove(firstClass).remove(lastClass).add(settings.controlClass),item.visible()&&(firstItem||(firstItem=item),lastItem=item)}),firstItem&&firstItem.classes.add(firstClass),lastItem&&lastItem.classes.add(lastClass)},renderHtml:function(container){var self=this,html="";return self.applyClasses(container.items()),container.items().each(function(item){html+=item.renderHtml()}),html},recalc:function(){},postRender:function(){},isNative:function(){return!1}}),AbsoluteLayout=Layout.extend({Defaults:{containerClass:"abs-layout",controlClass:"abs-layout-item"},recalc:function(container){container.items().filter(":visible").each(function(ctrl){var settings=ctrl.settings;ctrl.layoutRect({x:settings.x,y:settings.y,w:settings.w,h:settings.h}),ctrl.recalc&&ctrl.recalc()})},renderHtml:function(container){return'<div id="'+container._id+'-absend" class="'+container.classPrefix+'abs-end"></div>'+this._super(container)}}),Button=Widget.extend({Defaults:{classes:"widget btn",role:"button"},init:function(settings){var size,self=this;self._super(settings),settings=self.settings,size=self.settings.size,self.on("click mousedown",function(e){e.preventDefault()}),self.on("touchstart",function(e){self.fire("click",e),e.preventDefault()}),settings.subtype&&self.classes.add(settings.subtype),size&&self.classes.add("btn-"+size),settings.icon&&self.icon(settings.icon)},icon:function(icon){return arguments.length?(this.state.set("icon",icon),this):this.state.get("icon")},repaint:function(){var btnStyle,btnElm=this.getEl().firstChild;btnElm&&(btnStyle=btnElm.style,btnStyle.width=btnStyle.height="100%"),this._super()},renderHtml:function(){var image,ariaPressed,self=this,id=self._id,prefix=self.classPrefix,icon=self.state.get("icon"),text=self.state.get("text"),textHtml="",settings=self.settings;return image=settings.image,image?(icon="none","string"!=typeof image&&(image=window.getSelection?image[0]:image[1]),image=" style=\"background-image: url('"+image+"')\""):image="",text&&(self.classes.add("btn-has-text"),textHtml='<span class="'+prefix+'txt">'+self.encode(text)+"</span>"),icon=icon?prefix+"ico "+prefix+"i-"+icon:"",ariaPressed="boolean"==typeof settings.active?' aria-pressed="'+settings.active+'"':"",'<div id="'+id+'" class="'+self.classes+'" tabindex="-1"'+ariaPressed+'><button id="'+id+'-button" role="presentation" type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+textHtml+"</button></div>"},bindStates:function(){function setButtonText(text){var $span=$("span."+textCls,self.getEl());text?($span[0]||($("button:first",self.getEl()).append('<span class="'+textCls+'"></span>'),$span=$("span."+textCls,self.getEl())),$span.html(self.encode(text))):$span.remove(),self.classes.toggle("btn-has-text",!!text)}var self=this,$=self.$,textCls=self.classPrefix+"txt";return self.state.on("change:text",function(e){setButtonText(e.value)}),self.state.on("change:icon",function(e){var icon=e.value,prefix=self.classPrefix;self.settings.icon=icon,icon=icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"";var btnElm=self.getEl().firstChild,iconElm=btnElm.getElementsByTagName("i")[0];icon?(iconElm&&iconElm===btnElm.firstChild||(iconElm=document.createElement("i"),btnElm.insertBefore(iconElm,btnElm.firstChild)),iconElm.className=icon):iconElm&&btnElm.removeChild(iconElm),setButtonText(self.state.get("text"))}),self._super()}}),BrowseButton=Button.extend({init:function(settings){var self=this;settings=global$2.extend({text:"Browse...",multiple:!1,accept:null},settings),self._super(settings),self.classes.add("browsebutton"),settings.multiple&&self.classes.add("multiple")},postRender:function(){var self=this,input=funcs.create("input",{type:"file",id:self._id+"-browse",accept:self.settings.accept});self._super(),global$9(input).on("change",function(e){var files=e.target.files;self.value=function(){return files.length?self.settings.multiple?files:files[0]:null},e.preventDefault(),files.length&&self.fire("change",e)}),global$9(input).on("click",function(e){e.stopPropagation()}),global$9(self.getEl("button")).on("click",function(e){e.stopPropagation(),input.click()}),self.getEl().appendChild(input)},remove:function(){global$9(this.getEl("button")).off(),global$9(this.getEl("input")).off(),this._super()}}),ButtonGroup=Container.extend({Defaults:{defaultType:"button",role:"group"},renderHtml:function(){var self=this,layout=self._layout;return self.classes.add("btn-group"),self.preRender(),layout.preRender(self),'<div id="'+self._id+'" class="'+self.classes+'"><div id="'+self._id+'-body">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></div>"}}),Checkbox=Widget.extend({Defaults:{classes:"checkbox",role:"checkbox",checked:!1},init:function(settings){var self=this;self._super(settings),self.on("click mousedown",function(e){e.preventDefault()}),self.on("click",function(e){e.preventDefault(),self.disabled()||self.checked(!self.checked())}),self.checked(self.settings.checked)},checked:function(state){return arguments.length?(this.state.set("checked",state),this):this.state.get("checked")},value:function(state){return arguments.length?this.checked(state):this.checked()},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix;return'<div id="'+id+'" class="'+self.classes+'" unselectable="on" aria-labelledby="'+id+'-al" tabindex="-1"><i class="'+prefix+"ico "+prefix+'i-checkbox"></i><span id="'+id+'-al" class="'+prefix+'label">'+self.encode(self.state.get("text"))+"</span></div>"},bindStates:function(){function checked(state){self.classes.toggle("checked",state),self.aria("checked",state)}var self=this;return self.state.on("change:text",function(e){self.getEl("al").firstChild.data=self.translate(e.value)}),self.state.on("change:checked change:value",function(e){self.fire("change"),checked(e.value)}),self.state.on("change:icon",function(e){var icon=e.value,prefix=self.classPrefix;if("undefined"==typeof icon)return self.settings.icon;self.settings.icon=icon,icon=icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"";var btnElm=self.getEl().firstChild,iconElm=btnElm.getElementsByTagName("i")[0];icon?(iconElm&&iconElm===btnElm.firstChild||(iconElm=document.createElement("i"),btnElm.insertBefore(iconElm,btnElm.firstChild)),iconElm.className=icon):iconElm&&btnElm.removeChild(iconElm)}),self.state.get("checked")&&checked(!0),self._super()}}),global$13=tinymce.util.Tools.resolve("tinymce.util.VK"),ComboBox=Widget.extend({init:function(settings){var self=this;self._super(settings),settings=self.settings,self.classes.add("combobox"),self.subinput=!0,self.ariaTarget="inp",settings.menu=settings.menu||settings.values,settings.menu&&(settings.icon="caret"),self.on("click",function(e){var elm=e.target,root=self.getEl();if(global$9.contains(root,elm)||elm===root)for(;elm&&elm!==root;)elm.id&&elm.id.indexOf("-open")!==-1&&(self.fire("action"),settings.menu&&(self.showMenu(),e.aria&&self.menu.items()[0].focus())),elm=elm.parentNode}),self.on("keydown",function(e){var rootControl;13===e.keyCode&&"INPUT"===e.target.nodeName&&(e.preventDefault(),self.parents().reverse().each(function(ctrl){if(ctrl.toJSON)return rootControl=ctrl,!1}),self.fire("submit",{data:rootControl.toJSON()}))}),self.on("keyup",function(e){if("INPUT"===e.target.nodeName){var oldValue=self.state.get("value"),newValue=e.target.value;newValue!==oldValue&&(self.state.set("value",newValue),self.fire("autocomplete",e))}}),self.on("mouseover",function(e){var tooltip=self.tooltip().moveTo(-65535);if(self.statusLevel()&&e.target.className.indexOf(self.classPrefix+"status")!==-1){var statusMessage=self.statusMessage()||"Ok",rel=tooltip.text(statusMessage).show().testMoveRel(e.target,["bc-tc","bc-tl","bc-tr"]);tooltip.classes.toggle("tooltip-n","bc-tc"===rel),tooltip.classes.toggle("tooltip-nw","bc-tl"===rel),tooltip.classes.toggle("tooltip-ne","bc-tr"===rel),tooltip.moveRel(e.target,rel)}})},statusLevel:function(value){return arguments.length>0&&this.state.set("statusLevel",value),this.state.get("statusLevel")},statusMessage:function(value){return arguments.length>0&&this.state.set("statusMessage",value),this.state.get("statusMessage")},showMenu:function(){var menu,self=this,settings=self.settings;self.menu||(menu=settings.menu||[],menu.length?menu={type:"menu",items:menu}:menu.type=menu.type||"menu",self.menu=global$4.create(menu).parent(self).renderTo(self.getContainerElm()),self.fire("createmenu"),self.menu.reflow(),self.menu.on("cancel",function(e){e.control===self.menu&&self.focus()}),self.menu.on("show hide",function(e){e.control.items().each(function(ctrl){ctrl.active(ctrl.value()===self.value())})}).fire("show"),self.menu.on("select",function(e){self.value(e.control.value())}),self.on("focusin",function(e){"INPUT"===e.target.tagName.toUpperCase()&&self.menu.hide()}),self.aria("expanded",!0)),self.menu.show(),self.menu.layoutRect({w:self.layoutRect().w}),self.menu.moveRel(self.getEl(),self.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])},focus:function(){this.getEl("inp").focus()},repaint:function(){var width,lineHeight,self=this,elm=self.getEl(),openElm=self.getEl("open"),rect=self.layoutRect(),innerPadding=0,inputElm=elm.firstChild;self.statusLevel()&&"none"!==self.statusLevel()&&(innerPadding=parseInt(funcs.getRuntimeStyle(inputElm,"padding-right"),10)-parseInt(funcs.getRuntimeStyle(inputElm,"padding-left"),10)),width=openElm?rect.w-funcs.getSize(openElm).width-10:rect.w-10;var doc=document;return doc.all&&(!doc.documentMode||doc.documentMode<=8)&&(lineHeight=self.layoutRect().h-2+"px"),global$9(inputElm).css({width:width-innerPadding,lineHeight:lineHeight}),self._super(),self},postRender:function(){var self=this;return global$9(this.getEl("inp")).on("change",function(e){self.state.set("value",e.target.value),self.fire("change",e)}),self._super()},renderHtml:function(){var icon,text,self=this,id=self._id,settings=self.settings,prefix=self.classPrefix,value=self.state.get("value")||"",openBtnHtml="",extraAttrs="",statusHtml="";return"spellcheck"in settings&&(extraAttrs+=' spellcheck="'+settings.spellcheck+'"'),settings.maxLength&&(extraAttrs+=' maxlength="'+settings.maxLength+'"'),settings.size&&(extraAttrs+=' size="'+settings.size+'"'),settings.subtype&&(extraAttrs+=' type="'+settings.subtype+'"'),statusHtml='<i id="'+id+'-status" class="mce-status mce-ico" style="display: none"></i>',self.disabled()&&(extraAttrs+=' disabled="disabled"'),
icon=settings.icon,icon&&"caret"!==icon&&(icon=prefix+"ico "+prefix+"i-"+settings.icon),text=self.state.get("text"),(icon||text)&&(openBtnHtml='<div id="'+id+'-open" class="'+prefix+"btn "+prefix+'open" tabIndex="-1" role="button"><button id="'+id+'-action" type="button" hidefocus="1" tabindex="-1">'+("caret"!==icon?'<i class="'+icon+'"></i>':'<i class="'+prefix+'caret"></i>')+(text?(icon?" ":"")+text:"")+"</button></div>",self.classes.add("has-open")),'<div id="'+id+'" class="'+self.classes+'"><input id="'+id+'-inp" class="'+prefix+'textbox" value="'+self.encode(value,!1)+'" hidefocus="1"'+extraAttrs+' placeholder="'+self.encode(settings.placeholder)+'" />'+statusHtml+openBtnHtml+"</div>"},value:function(value){return arguments.length?(this.state.set("value",value),this):(this.state.get("rendered")&&this.state.set("value",this.getEl("inp").value),this.state.get("value"))},showAutoComplete:function(items,term){var self=this;if(0===items.length)return void self.hideMenu();var insert=function(value,title){return function(){self.fire("selectitem",{title:title,value:value})}};self.menu?self.menu.items().remove():self.menu=global$4.create({type:"menu",classes:"combobox-menu",layout:"flow"}).parent(self).renderTo(),global$2.each(items,function(item){self.menu.add({text:item.title,url:item.previewUrl,match:term,classes:"menu-item-ellipsis",onclick:insert(item.value,item.title)})}),self.menu.renderNew(),self.hideMenu(),self.menu.on("cancel",function(e){e.control.parent()===self.menu&&(e.stopPropagation(),self.focus(),self.hideMenu())}),self.menu.on("select",function(){self.focus()});var maxW=self.layoutRect().w;self.menu.layoutRect({w:maxW,minW:0,maxW:maxW}),self.menu.repaint(),self.menu.reflow(),self.menu.show(),self.menu.moveRel(self.getEl(),self.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])},hideMenu:function(){this.menu&&this.menu.hide()},bindStates:function(){var self=this;self.state.on("change:value",function(e){self.getEl("inp").value!==e.value&&(self.getEl("inp").value=e.value)}),self.state.on("change:disabled",function(e){self.getEl("inp").disabled=e.value}),self.state.on("change:statusLevel",function(e){var statusIconElm=self.getEl("status"),prefix=self.classPrefix,value=e.value;funcs.css(statusIconElm,"display","none"===value?"none":""),funcs.toggleClass(statusIconElm,prefix+"i-checkmark","ok"===value),funcs.toggleClass(statusIconElm,prefix+"i-warning","warn"===value),funcs.toggleClass(statusIconElm,prefix+"i-error","error"===value),self.classes.toggle("has-status","none"!==value),self.repaint()}),funcs.on(self.getEl("status"),"mouseleave",function(){self.tooltip().hide()}),self.on("cancel",function(e){self.menu&&self.menu.visible()&&(e.stopPropagation(),self.hideMenu())});var focusIdx=function(idx,menu){menu&&menu.items().length>0&&menu.items().eq(idx)[0].focus()};return self.on("keydown",function(e){var keyCode=e.keyCode;"INPUT"===e.target.nodeName&&(keyCode===global$13.DOWN?(e.preventDefault(),self.fire("autocomplete"),focusIdx(0,self.menu)):keyCode===global$13.UP&&(e.preventDefault(),focusIdx(-1,self.menu)))}),self._super()},remove:function(){global$9(this.getEl("inp")).off(),this.menu&&this.menu.remove(),this._super()}}),ColorBox=ComboBox.extend({init:function(settings){var self=this;settings.spellcheck=!1,settings.onaction&&(settings.icon="none"),self._super(settings),self.classes.add("colorbox"),self.on("change keyup postrender",function(){self.repaintColor(self.value())})},repaintColor:function(value){var openElm=this.getEl("open"),elm=openElm?openElm.getElementsByTagName("i")[0]:null;if(elm)try{elm.style.background=value}catch(ex){}},bindStates:function(){var self=this;return self.state.on("change:value",function(e){self.state.get("rendered")&&self.repaintColor(e.value)}),self._super()}}),PanelButton=Button.extend({showPanel:function(){var self=this,settings=self.settings;if(self.classes.add("opened"),self.panel)self.panel.show();else{var panelSettings=settings.panel;panelSettings.type&&(panelSettings={layout:"grid",items:panelSettings}),panelSettings.role=panelSettings.role||"dialog",panelSettings.popover=!0,panelSettings.autohide=!0,panelSettings.ariaRoot=!0,self.panel=new FloatPanel(panelSettings).on("hide",function(){self.classes.remove("opened")}).on("cancel",function(e){e.stopPropagation(),self.focus(),self.hidePanel()}).parent(self).renderTo(self.getContainerElm()),self.panel.fire("show"),self.panel.reflow()}var rtlRels=["bc-tc","bc-tl","bc-tr"],ltrRels=["bc-tc","bc-tr","bc-tl","tc-bc","tc-br","tc-bl"],rel=self.panel.testMoveRel(self.getEl(),settings.popoverAlign||(self.isRtl()?rtlRels:ltrRels));self.panel.classes.toggle("start","l"===rel.substr(-1)),self.panel.classes.toggle("end","r"===rel.substr(-1));var isTop="t"===rel.substr(0,1);self.panel.classes.toggle("bottom",!isTop),self.panel.classes.toggle("top",isTop),self.panel.moveRel(self.getEl(),rel)},hidePanel:function(){var self=this;self.panel&&self.panel.hide()},postRender:function(){var self=this;return self.aria("haspopup",!0),self.on("click",function(e){e.control===self&&(self.panel&&self.panel.visible()?self.hidePanel():(self.showPanel(),self.panel.focus(!!e.aria)))}),self._super()},remove:function(){return this.panel&&(this.panel.remove(),this.panel=null),this._super()}}),DOM$3=global$3.DOM,ColorButton=PanelButton.extend({init:function(settings){this._super(settings),this.classes.add("splitbtn"),this.classes.add("colorbutton")},color:function(color){return color?(this._color=color,this.getEl("preview").style.backgroundColor=color,this):this._color},resetColor:function(){return this._color=null,this.getEl("preview").style.backgroundColor=null,this},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix,text=self.state.get("text"),icon=self.settings.icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"",image=self.settings.image?" style=\"background-image: url('"+self.settings.image+"')\"":"",textHtml="";return text&&(self.classes.add("btn-has-text"),textHtml='<span class="'+prefix+'txt">'+self.encode(text)+"</span>"),'<div id="'+id+'" class="'+self.classes+'" role="button" tabindex="-1" aria-haspopup="true"><button role="presentation" hidefocus="1" type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+'<span id="'+id+'-preview" class="'+prefix+'preview"></span>'+textHtml+'</button><button type="button" class="'+prefix+'open" hidefocus="1" tabindex="-1"> <i class="'+prefix+'caret"></i></button></div>'},postRender:function(){var self=this,onClickHandler=self.settings.onclick;return self.on("click",function(e){e.aria&&"down"===e.aria.key||e.control!==self||DOM$3.getParent(e.target,"."+self.classPrefix+"open")||(e.stopImmediatePropagation(),onClickHandler.call(self,e))}),delete self.settings.onclick,self._super()}}),global$14=tinymce.util.Tools.resolve("tinymce.util.Color"),ColorPicker=Widget.extend({Defaults:{classes:"widget colorpicker"},init:function(settings){this._super(settings)},postRender:function(){function getPos(elm,event){var x,y,pos=funcs.getPos(elm);return x=event.pageX-pos.x,y=event.pageY-pos.y,x=Math.max(0,Math.min(x/elm.clientWidth,1)),y=Math.max(0,Math.min(y/elm.clientHeight,1)),{x:x,y:y}}function updateColor(hsv,hueUpdate){var hue=(360-hsv.h)/360;funcs.css(huePointElm,{top:100*hue+"%"}),hueUpdate||funcs.css(svPointElm,{left:hsv.s+"%",top:100-hsv.v+"%"}),svRootElm.style.background=global$14({s:100,v:100,h:hsv.h}).toHex(),self.color().parse({s:hsv.s,v:hsv.v,h:hsv.h})}function updateSaturationAndValue(e){var pos;pos=getPos(svRootElm,e),hsv.s=100*pos.x,hsv.v=100*(1-pos.y),updateColor(hsv),self.fire("change")}function updateHue(e){var pos;pos=getPos(hueRootElm,e),hsv=color.toHsv(),hsv.h=360*(1-pos.y),updateColor(hsv,!0),self.fire("change")}var hsv,hueRootElm,huePointElm,svRootElm,svPointElm,self=this,color=self.color();hueRootElm=self.getEl("h"),huePointElm=self.getEl("hp"),svRootElm=self.getEl("sv"),svPointElm=self.getEl("svp"),self._repaint=function(){hsv=color.toHsv(),updateColor(hsv)},self._super(),self._svdraghelper=new DragHelper(self._id+"-sv",{start:updateSaturationAndValue,drag:updateSaturationAndValue}),self._hdraghelper=new DragHelper(self._id+"-h",{start:updateHue,drag:updateHue}),self._repaint()},rgb:function(){return this.color().toRgb()},value:function(value){var self=this;return arguments.length?(self.color().parse(value),void(self._rendered&&self._repaint())):self.color().toHex()},color:function(){return this._color||(this._color=global$14()),this._color},renderHtml:function(){function getOldIeFallbackHtml(){var i,l,gradientPrefix,stopsList,html="";for(gradientPrefix="filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=",stopsList=stops.split(","),i=0,l=stopsList.length-1;i<l;i++)html+='<div class="'+prefix+'colorpicker-h-chunk" style="height:'+100/l+"%;"+gradientPrefix+stopsList[i]+",endColorstr="+stopsList[i+1]+");-ms-"+gradientPrefix+stopsList[i]+",endColorstr="+stopsList[i+1]+')"></div>';return html}var hueHtml,self=this,id=self._id,prefix=self.classPrefix,stops="#ff0000,#ff0080,#ff00ff,#8000ff,#0000ff,#0080ff,#00ffff,#00ff80,#00ff00,#80ff00,#ffff00,#ff8000,#ff0000",gradientCssText="background: -ms-linear-gradient(top,"+stops+");background: linear-gradient(to bottom,"+stops+");";return hueHtml='<div id="'+id+'-h" class="'+prefix+'colorpicker-h" style="'+gradientCssText+'">'+getOldIeFallbackHtml()+'<div id="'+id+'-hp" class="'+prefix+'colorpicker-h-marker"></div></div>','<div id="'+id+'" class="'+self.classes+'"><div id="'+id+'-sv" class="'+prefix+'colorpicker-sv"><div class="'+prefix+'colorpicker-overlay1"><div class="'+prefix+'colorpicker-overlay2"><div id="'+id+'-svp" class="'+prefix+'colorpicker-selector1"><div class="'+prefix+'colorpicker-selector2"></div></div></div></div></div>'+hueHtml+"</div>"}}),DropZone=Widget.extend({init:function(settings){var self=this;settings=global$2.extend({height:100,text:"Drop an image here",multiple:!1,accept:null},settings),self._super(settings),self.classes.add("dropzone"),settings.multiple&&self.classes.add("multiple")},renderHtml:function(){var attrs,elm,self=this,cfg=self.settings;return attrs={id:self._id,hidefocus:"1"},elm=funcs.create("div",attrs,"<span>"+this.translate(cfg.text)+"</span>"),cfg.height&&funcs.css(elm,"height",cfg.height+"px"),cfg.width&&funcs.css(elm,"width",cfg.width+"px"),elm.className=self.classes,elm.outerHTML},postRender:function(){var self=this,toggleDragClass=function(e){e.preventDefault(),self.classes.toggle("dragenter"),self.getEl().className=self.classes},filter=function(files){var accept=self.settings.accept;if("string"!=typeof accept)return files;var re=new RegExp("("+accept.split(/\s*,\s*/).join("|")+")$","i");return global$2.grep(files,function(file){return re.test(file.name)})};self._super(),self.$el.on("dragover",function(e){e.preventDefault()}),self.$el.on("dragenter",toggleDragClass),self.$el.on("dragleave",toggleDragClass),self.$el.on("drop",function(e){if(e.preventDefault(),!self.state.get("disabled")){var files=filter(e.dataTransfer.files);self.value=function(){return files.length?self.settings.multiple?files:files[0]:null},files.length&&self.fire("change",e)}})},remove:function(){this.$el.off(),this._super()}}),Path=Widget.extend({init:function(settings){var self=this;settings.delimiter||(settings.delimiter="»"),self._super(settings),self.classes.add("path"),self.canFocus=!0,self.on("click",function(e){var index,target=e.target;(index=target.getAttribute("data-index"))&&self.fire("select",{value:self.row()[index],index:index})}),self.row(self.settings.row)},focus:function(){var self=this;return self.getEl().firstChild.focus(),self},row:function(row){return arguments.length?(this.state.set("row",row),this):this.state.get("row")},renderHtml:function(){var self=this;return'<div id="'+self._id+'" class="'+self.classes+'">'+self._getDataPathHtml(self.state.get("row"))+"</div>"},bindStates:function(){var self=this;return self.state.on("change:row",function(e){self.innerHtml(self._getDataPathHtml(e.value))}),self._super()},_getDataPathHtml:function(data){var i,l,self=this,parts=data||[],html="",prefix=self.classPrefix;for(i=0,l=parts.length;i<l;i++)html+=(i>0?'<div class="'+prefix+'divider" aria-hidden="true"> '+self.settings.delimiter+" </div>":"")+'<div role="button" class="'+prefix+"path-item"+(i===l-1?" "+prefix+"last":"")+'" data-index="'+i+'" tabindex="-1" id="'+self._id+"-"+i+'" aria-level="'+(i+1)+'">'+parts[i].name+"</div>";return html||(html='<div class="'+prefix+'path-item"> </div>'),html}}),ElementPath=Path.extend({postRender:function(){function isHidden(elm){if(1===elm.nodeType){if("BR"===elm.nodeName||elm.getAttribute("data-mce-bogus"))return!0;if("bookmark"===elm.getAttribute("data-mce-type"))return!0}return!1}var self=this,editor=self.settings.editor;return editor.settings.elementpath!==!1&&(self.on("select",function(e){editor.focus(),editor.selection.select(this.row()[e.index].element),editor.nodeChanged()}),editor.on("nodeChange",function(e){for(var outParents=[],parents=e.parents,i=parents.length;i--;)if(1===parents[i].nodeType&&!isHidden(parents[i])){var args=editor.fire("ResolveName",{name:parents[i].nodeName.toLowerCase(),target:parents[i]});if(args.isDefaultPrevented()||outParents.push({name:args.name,element:parents[i]}),args.isPropagationStopped())break}self.row(outParents)})),self._super()}}),FormItem=Container.extend({Defaults:{layout:"flex",align:"center",defaults:{flex:1}},renderHtml:function(){var self=this,layout=self._layout,prefix=self.classPrefix;return self.classes.add("formitem"),layout.preRender(self),'<div id="'+self._id+'" class="'+self.classes+'" hidefocus="1" tabindex="-1">'+(self.settings.title?'<div id="'+self._id+'-title" class="'+prefix+'title">'+self.settings.title+"</div>":"")+'<div id="'+self._id+'-body" class="'+self.bodyClasses+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></div>"}}),Form=Container.extend({Defaults:{containerCls:"form",layout:"flex",direction:"column",align:"stretch",flex:1,padding:15,labelGap:30,spacing:10,callbacks:{submit:function(){this.submit()}}},preRender:function(){var self=this,items=self.items();self.settings.formItemDefaults||(self.settings.formItemDefaults={layout:"flex",autoResize:"overflow",defaults:{flex:1}}),items.each(function(ctrl){var formItem,label=ctrl.settings.label;label&&(formItem=new FormItem(global$2.extend({items:{type:"label",id:ctrl._id+"-l",text:label,flex:0,forId:ctrl._id,disabled:ctrl.disabled()}},self.settings.formItemDefaults)),formItem.type="formitem",ctrl.aria("labelledby",ctrl._id+"-l"),"undefined"==typeof ctrl.settings.flex&&(ctrl.settings.flex=1),self.replace(ctrl,formItem),formItem.add(ctrl))})},submit:function(){return this.fire("submit",{data:this.toJSON()})},postRender:function(){var self=this;self._super(),self.fromJSON(self.settings.data)},bindStates:function(){function recalcLabels(){var i,labelGap,items,maxLabelWidth=0,labels=[];if(self.settings.labelGapCalc!==!1)for(items="children"===self.settings.labelGapCalc?self.find("formitem"):self.items(),items.filter("formitem").each(function(item){var labelCtrl=item.items()[0],labelWidth=labelCtrl.getEl().clientWidth;maxLabelWidth=labelWidth>maxLabelWidth?labelWidth:maxLabelWidth,labels.push(labelCtrl)}),labelGap=self.settings.labelGap||0,i=labels.length;i--;)labels[i].settings.minWidth=maxLabelWidth+labelGap}var self=this;self._super(),self.on("show",recalcLabels),recalcLabels()}}),FieldSet=Form.extend({Defaults:{containerCls:"fieldset",layout:"flex",direction:"column",align:"stretch",flex:1,padding:"25 15 5 15",labelGap:30,spacing:10,border:1},renderHtml:function(){var self=this,layout=self._layout,prefix=self.classPrefix;return self.preRender(),layout.preRender(self),'<fieldset id="'+self._id+'" class="'+self.classes+'" hidefocus="1" tabindex="-1">'+(self.settings.title?'<legend id="'+self._id+'-title" class="'+prefix+'fieldset-title">'+self.settings.title+"</legend>":"")+'<div id="'+self._id+'-body" class="'+self.bodyClasses+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></fieldset>"}}),unique$1=0,generate=function(prefix){var date=new Date,time=date.getTime(),random=Math.floor(1e9*Math.random());return unique$1++,prefix+"_"+random+unique$1+String(time)},$_gdeezvv5jh8lz3rl={generate:generate},fromHtml=function(html,scope){var doc=scope||document,div=doc.createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||div.childNodes.length>1)throw console.error("HTML does not have a single root node",html),"HTML must have a single root node";return fromDom(div.childNodes[0])},fromTag=function(tag,scope){var doc=scope||document,node=doc.createElement(tag);return fromDom(node)},fromText=function(text,scope){var doc=scope||document,node=doc.createTextNode(text);return fromDom(node)},fromDom=function(node){if(null===node||void 0===node)throw new Error("Node cannot be null or undefined");return{dom:$_3pjweotejh8lz3k4.constant(node)}},fromPoint=function(doc,x,y){return Option.from(doc.dom().elementFromPoint(x,y)).map(fromDom)},$_3bkrfxv6jh8lz3rm={fromHtml:fromHtml,fromTag:fromTag,fromText:fromText,fromDom:fromDom,fromPoint:fromPoint},cached=function(f){var r,called=!1;return function(){return called||(called=!0,r=f.apply(null,arguments)),r}},$_8me1xevajh8lz3s0={cached:cached},$_8xkvw6vcjh8lz3s2={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12},name=function(element){var r=element.dom().nodeName;return r.toLowerCase()},type=function(element){return element.dom().nodeType},value=function(element){return element.dom().nodeValue},isType$1=function(t){return function(element){return type(element)===t}},isComment=function(element){return type(element)===$_8xkvw6vcjh8lz3s2.COMMENT||"#comment"===name(element)},isElement=isType$1($_8xkvw6vcjh8lz3s2.ELEMENT),isText=isType$1($_8xkvw6vcjh8lz3s2.TEXT),isDocument=isType$1($_8xkvw6vcjh8lz3s2.DOCUMENT),$_11h2nlvbjh8lz3s1={name:name,type:type,value:value,isElement:isElement,isText:isText,isDocument:isDocument,isComment:isComment},inBody=function(element){var dom=$_11h2nlvbjh8lz3s1.isText(element)?element.dom().parentNode:element.dom();return void 0!==dom&&null!==dom&&dom.ownerDocument.body.contains(dom)},body=$_8me1xevajh8lz3s0.cached(function(){return getBody($_3bkrfxv6jh8lz3rm.fromDom(document))}),getBody=function(doc){var body=doc.dom().body;if(null===body||void 0===body)throw"Body is not available yet";return $_3bkrfxv6jh8lz3rm.fromDom(body)},$_35bizev9jh8lz3rx={body:body,getBody:getBody,inBody:inBody},keys=function(){var fastKeys=Object.keys,slowKeys=function(o){var r=[];for(var i in o)o.hasOwnProperty(i)&&r.push(i);return r};return void 0===fastKeys?slowKeys:fastKeys}(),each$1=function(obj,f){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k],x=obj[i];f(x,i,obj)}},objectMap=function(obj,f){return tupleMap(obj,function(x,i,obj){return{k:i,v:f(x,i,obj)}})},tupleMap=function(obj,f){var r={};return each$1(obj,function(x,i){var tuple=f(x,i,obj);r[tuple.k]=tuple.v}),r},bifilter=function(obj,pred){var t={},f={};return each$1(obj,function(x,i){var branch=pred(x,i)?t:f;branch[i]=x}),{t:t,f:f}},mapToArray=function(obj,f){var r=[];return each$1(obj,function(value,name){r.push(f(value,name))}),r},find$1=function(obj,pred){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k],x=obj[i];if(pred(x,i,obj))return Option.some(x)}return Option.none()},values=function(obj){return mapToArray(obj,function(v){return v})},size=function(obj){return values(obj).length},$_el35e0vhjh8lz3sl={bifilter:bifilter,each:each$1,map:objectMap,mapToArray:mapToArray,tupleMap:tupleMap,find:find$1,keys:keys,values:values,size:size},sort$1=function(arr){return arr.slice(0).sort()},reqMessage=function(required,keys){throw new Error("All required keys ("+sort$1(required).join(", ")+") were not specified. Specified keys were: "+sort$1(keys).join(", ")+".")},unsuppMessage=function(unsupported){throw new Error("Unsupported keys for object: "+sort$1(unsupported).join(", "))},validateStrArr=function(label,array){if(!$_d8bie3tijh8lz3kn.isArray(array))throw new Error("The "+label+" fields must be an array. Was: "+array+".");$_f3qxhzthjh8lz3kg.each(array,function(a){if(!$_d8bie3tijh8lz3kn.isString(a))throw new Error("The value "+a+" in the "+label+" fields was not a string.")})},invalidTypeMessage=function(incorrect,type){throw new Error("All values need to be of type: "+type+". Keys ("+sort$1(incorrect).join(", ")+") were not.")},checkDupes=function(everything){var sorted=sort$1(everything),dupe=$_f3qxhzthjh8lz3kg.find(sorted,function(s,i){return i<sorted.length-1&&s===sorted[i+1]});dupe.each(function(d){throw new Error("The field: "+d+" occurs more than once in the combined fields: ["+sorted.join(", ")+"].")})},$_6xoomwvijh8lz3sn={sort:sort$1,reqMessage:reqMessage,unsuppMessage:unsuppMessage,validateStrArr:validateStrArr,invalidTypeMessage:invalidTypeMessage,checkDupes:checkDupes},$_57mdu6vejh8lz3sg={immutable:Immutable,immutableBag:MixedBag},toArray=function(target,f){var r=[],recurse=function(e){return r.push(e),f(e)},cur=f(target);do cur=cur.bind(recurse);while(cur.isSome());return r},$_861s8bvjjh8lz3sp={toArray:toArray},global$15="undefined"!=typeof window?window:Function("return this;")(),path=function(parts,scope){for(var o=void 0!==scope&&null!==scope?scope:global$15,i=0;i<parts.length&&void 0!==o&&null!==o;++i)o=o[parts[i]];return o},resolve=function(p,scope){var parts=p.split(".");return path(parts,scope)},step=function(o,part){return void 0!==o[part]&&null!==o[part]||(o[part]={}),o[part]},forge=function(parts,target){for(var o=void 0!==target?target:global$15,i=0;i<parts.length;++i)o=step(o,parts[i]);return o},namespace=function(name,target){var parts=name.split(".");return forge(parts,target)},$_1cxe7nvnjh8lz3td={path:path,resolve:resolve,forge:forge,namespace:namespace},unsafe=function(name,scope){return $_1cxe7nvnjh8lz3td.resolve(name,scope)},getOrDie=function(name,scope){var actual=unsafe(name,scope);if(void 0===actual||null===actual)throw name+" not available on this browser";return actual},$_eol4qgvmjh8lz3t9={getOrDie:getOrDie},node=function(){var f=$_eol4qgvmjh8lz3t9.getOrDie("Node");return f},compareDocumentPosition=function(a,b,match){return 0!==(a.compareDocumentPosition(b)&match)},documentPositionPreceding=function(a,b){return compareDocumentPosition(a,b,node().DOCUMENT_POSITION_PRECEDING)},documentPositionContainedBy=function(a,b){return compareDocumentPosition(a,b,node().DOCUMENT_POSITION_CONTAINED_BY)},$_7n27kvvljh8lz3t8={documentPositionPreceding:documentPositionPreceding,documentPositionContainedBy:documentPositionContainedBy},firstMatch=function(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s))return x}},find$2=function(regexes,agent){var r=firstMatch(regexes,agent);if(!r)return{major:0,minor:0};var group=function(i){return Number(agent.replace(r,"$"+i))};return nu(group(1),group(2))},detect=function(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();return 0===versionRegexes.length?unknown():find$2(versionRegexes,cleanedAgent)},unknown=function(){return nu(0,0)},nu=function(major,minor){return{major:major,minor:minor}},$_afos0kvsjh8lz3tm={nu:nu,detect:detect,unknown:unknown},edge="Edge",chrome="Chrome",ie="IE",opera="Opera",firefox="Firefox",safari="Safari",isBrowser=function(name,current){return function(){return current===name}},unknown$1=function(){return nu$1({current:void 0,version:$_afos0kvsjh8lz3tm.unknown()})},nu$1=function(info){var current=info.current,version=info.version;return{current:current,version:version,isEdge:isBrowser(edge,current),isChrome:isBrowser(chrome,current),isIE:isBrowser(ie,current),isOpera:isBrowser(opera,current),isFirefox:isBrowser(firefox,current),isSafari:isBrowser(safari,current)}},$_fidpetvrjh8lz3tj={unknown:unknown$1,nu:nu$1,edge:$_3pjweotejh8lz3k4.constant(edge),chrome:$_3pjweotejh8lz3k4.constant(chrome),ie:$_3pjweotejh8lz3k4.constant(ie),opera:$_3pjweotejh8lz3k4.constant(opera),firefox:$_3pjweotejh8lz3k4.constant(firefox),safari:$_3pjweotejh8lz3k4.constant(safari)},windows$1="Windows",ios="iOS",android="Android",linux="Linux",osx="OSX",solaris="Solaris",freebsd="FreeBSD",isOS=function(name,current){return function(){return current===name}},unknown$2=function(){return nu$2({current:void 0,version:$_afos0kvsjh8lz3tm.unknown()})},nu$2=function(info){var current=info.current,version=info.version;return{current:current,version:version,isWindows:isOS(windows$1,current),isiOS:isOS(ios,current),isAndroid:isOS(android,current),isOSX:isOS(osx,current),isLinux:isOS(linux,current),isSolaris:isOS(solaris,current),isFreeBSD:isOS(freebsd,current)}},$_1z8n9kvtjh8lz3to={unknown:unknown$2,nu:nu$2,windows:$_3pjweotejh8lz3k4.constant(windows$1),ios:$_3pjweotejh8lz3k4.constant(ios),android:$_3pjweotejh8lz3k4.constant(android),linux:$_3pjweotejh8lz3k4.constant(linux),osx:$_3pjweotejh8lz3k4.constant(osx),solaris:$_3pjweotejh8lz3k4.constant(solaris),freebsd:$_3pjweotejh8lz3k4.constant(freebsd)},detect$1=function(candidates,userAgent){var agent=String(userAgent).toLowerCase();return $_f3qxhzthjh8lz3kg.find(candidates,function(candidate){return candidate.search(agent)})},detectBrowser=function(browsers,userAgent){return detect$1(browsers,userAgent).map(function(browser){var version=$_afos0kvsjh8lz3tm.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version}})},detectOs=function(oses,userAgent){return detect$1(oses,userAgent).map(function(os){var version=$_afos0kvsjh8lz3tm.detect(os.versionRegexes,userAgent);return{current:os.name,version:version}})},$_bvrih8vvjh8lz3tv={detectBrowser:detectBrowser,detectOs:detectOs},addToStart=function(str,prefix){return prefix+str},addToEnd=function(str,suffix){return str+suffix},removeFromStart=function(str,numChars){return str.substring(numChars)},removeFromEnd=function(str,numChars){return str.substring(0,str.length-numChars)},$_enj27ovyjh8lz3u7={addToStart:addToStart,addToEnd:addToEnd,removeFromStart:removeFromStart,removeFromEnd:removeFromEnd},first=function(str,count){return str.substr(0,count)},last$1=function(str,count){return str.substr(str.length-count,str.length)},head$1=function(str){return""===str?Option.none():Option.some(str.substr(0,1))},tail=function(str){return""===str?Option.none():Option.some(str.substring(1))},$_49etxbvzjh8lz3u8={first:first,last:last$1,head:head$1,tail:tail},checkRange=function(str,substr,start){if(""===substr)return!0;if(str.length<substr.length)return!1;var x=str.substr(start,start+substr.length);return x===substr},supplant=function(str,obj){var isStringOrNumber=function(a){var t=typeof a;return"string"===t||"number"===t};return str.replace(/\${([^{}]*)}/g,function(a,b){var value=obj[b];return isStringOrNumber(value)?value:a})},removeLeading=function(str,prefix){return startsWith(str,prefix)?$_enj27ovyjh8lz3u7.removeFromStart(str,prefix.length):str},removeTrailing=function(str,prefix){return endsWith(str,prefix)?$_enj27ovyjh8lz3u7.removeFromEnd(str,prefix.length):str},ensureLeading=function(str,prefix){return startsWith(str,prefix)?str:$_enj27ovyjh8lz3u7.addToStart(str,prefix)},ensureTrailing=function(str,prefix){return endsWith(str,prefix)?str:$_enj27ovyjh8lz3u7.addToEnd(str,prefix)},contains$1=function(str,substr){return str.indexOf(substr)!==-1},capitalize=function(str){return $_49etxbvzjh8lz3u8.head(str).bind(function(head){return $_49etxbvzjh8lz3u8.tail(str).map(function(tail){return head.toUpperCase()+tail})}).getOr(str)},startsWith=function(str,prefix){return checkRange(str,prefix,0)},endsWith=function(str,suffix){return checkRange(str,suffix,str.length-suffix.length)},trim=function(str){return str.replace(/^\s+|\s+$/g,"")},lTrim=function(str){return str.replace(/^\s+/g,"")},rTrim=function(str){return str.replace(/\s+$/g,"")},$_2absfgvxjh8lz3u4={supplant:supplant,startsWith:startsWith,removeLeading:removeLeading,removeTrailing:removeTrailing,ensureLeading:ensureLeading,ensureTrailing:ensureTrailing,endsWith:endsWith,contains:contains$1,trim:trim,lTrim:lTrim,rTrim:rTrim,capitalize:capitalize},normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,checkContains=function(target){return function(uastring){return $_2absfgvxjh8lz3u4.contains(uastring,target)}},browsers=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(uastring){var monstrosity=$_2absfgvxjh8lz3u4.contains(uastring,"edge/")&&$_2absfgvxjh8lz3u4.contains(uastring,"chrome")&&$_2absfgvxjh8lz3u4.contains(uastring,"safari")&&$_2absfgvxjh8lz3u4.contains(uastring,"applewebkit");return monstrosity}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function(uastring){return $_2absfgvxjh8lz3u4.contains(uastring,"chrome")&&!$_2absfgvxjh8lz3u4.contains(uastring,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(uastring){return $_2absfgvxjh8lz3u4.contains(uastring,"msie")||$_2absfgvxjh8lz3u4.contains(uastring,"trident")}},{name:"Opera",versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(uastring){return($_2absfgvxjh8lz3u4.contains(uastring,"safari")||$_2absfgvxjh8lz3u4.contains(uastring,"mobile/"))&&$_2absfgvxjh8lz3u4.contains(uastring,"applewebkit")}}],oses=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(uastring){return $_2absfgvxjh8lz3u4.contains(uastring,"iphone")||$_2absfgvxjh8lz3u4.contains(uastring,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]}],$_dne06dvwjh8lz3ty={browsers:$_3pjweotejh8lz3k4.constant(browsers),oses:$_3pjweotejh8lz3k4.constant(oses)},detect$2=function(userAgent){var browsers=$_dne06dvwjh8lz3ty.browsers(),oses=$_dne06dvwjh8lz3ty.oses(),browser=$_bvrih8vvjh8lz3tv.detectBrowser(browsers,userAgent).fold($_fidpetvrjh8lz3tj.unknown,$_fidpetvrjh8lz3tj.nu),os=$_bvrih8vvjh8lz3tv.detectOs(oses,userAgent).fold($_1z8n9kvtjh8lz3to.unknown,$_1z8n9kvtjh8lz3to.nu),deviceType=DeviceType(os,browser,userAgent);return{browser:browser,os:os,deviceType:deviceType}},$_8gsy8vqjh8lz3ti={detect:detect$2},detect$3=$_8me1xevajh8lz3s0.cached(function(){var userAgent=navigator.userAgent;return $_8gsy8vqjh8lz3ti.detect(userAgent)}),$_2rbkegvpjh8lz3tf={detect:detect$3},ELEMENT=$_8xkvw6vcjh8lz3s2.ELEMENT,DOCUMENT=$_8xkvw6vcjh8lz3s2.DOCUMENT,is=function(element,selector){var elem=element.dom();if(elem.nodeType!==ELEMENT)return!1;if(void 0!==elem.matches)return elem.matches(selector);if(void 0!==elem.msMatchesSelector)return elem.msMatchesSelector(selector);if(void 0!==elem.webkitMatchesSelector)return elem.webkitMatchesSelector(selector);if(void 0!==elem.mozMatchesSelector)return elem.mozMatchesSelector(selector);throw new Error("Browser lacks native selectors")},bypassSelector=function(dom){return dom.nodeType!==ELEMENT&&dom.nodeType!==DOCUMENT||0===dom.childElementCount},all=function(selector,scope){var base=void 0===scope?document:scope.dom();return bypassSelector(base)?[]:$_f3qxhzthjh8lz3kg.map(base.querySelectorAll(selector),$_3bkrfxv6jh8lz3rm.fromDom)},one=function(selector,scope){var base=void 0===scope?document:scope.dom();return bypassSelector(base)?Option.none():Option.from(base.querySelector(selector)).map($_3bkrfxv6jh8lz3rm.fromDom)},$_2nczsvw0jh8lz3ua={
all:all,is:is,one:one},eq=function(e1,e2){return e1.dom()===e2.dom()},isEqualNode=function(e1,e2){return e1.dom().isEqualNode(e2.dom())},member=function(element,elements){return $_f3qxhzthjh8lz3kg.exists(elements,$_3pjweotejh8lz3k4.curry(eq,element))},regularContains=function(e1,e2){var d1=e1.dom(),d2=e2.dom();return d1!==d2&&d1.contains(d2)},ieContains=function(e1,e2){return $_7n27kvvljh8lz3t8.documentPositionContainedBy(e1.dom(),e2.dom())},browser=$_2rbkegvpjh8lz3tf.detect().browser,contains$2=browser.isIE()?ieContains:regularContains,$_9ypjy6vkjh8lz3sq={eq:eq,isEqualNode:isEqualNode,member:member,contains:contains$2,is:$_2nczsvw0jh8lz3ua.is},owner=function(element){return $_3bkrfxv6jh8lz3rm.fromDom(element.dom().ownerDocument)},documentElement=function(element){var doc=owner(element);return $_3bkrfxv6jh8lz3rm.fromDom(doc.dom().documentElement)},defaultView=function(element){var el=element.dom(),defaultView=el.ownerDocument.defaultView;return $_3bkrfxv6jh8lz3rm.fromDom(defaultView)},parent=function(element){var dom=element.dom();return Option.from(dom.parentNode).map($_3bkrfxv6jh8lz3rm.fromDom)},findIndex$1=function(element){return parent(element).bind(function(p){var kin=children(p);return $_f3qxhzthjh8lz3kg.findIndex(kin,function(elem){return $_9ypjy6vkjh8lz3sq.eq(element,elem)})})},parents=function(element,isRoot){for(var stop=$_d8bie3tijh8lz3kn.isFunction(isRoot)?isRoot:$_3pjweotejh8lz3k4.constant(!1),dom=element.dom(),ret=[];null!==dom.parentNode&&void 0!==dom.parentNode;){var rawParent=dom.parentNode,parent=$_3bkrfxv6jh8lz3rm.fromDom(rawParent);if(ret.push(parent),stop(parent)===!0)break;dom=rawParent}return ret},siblings=function(element){var filterSelf=function(elements){return $_f3qxhzthjh8lz3kg.filter(elements,function(x){return!$_9ypjy6vkjh8lz3sq.eq(element,x)})};return parent(element).map(children).map(filterSelf).getOr([])},offsetParent=function(element){var dom=element.dom();return Option.from(dom.offsetParent).map($_3bkrfxv6jh8lz3rm.fromDom)},prevSibling=function(element){var dom=element.dom();return Option.from(dom.previousSibling).map($_3bkrfxv6jh8lz3rm.fromDom)},nextSibling=function(element){var dom=element.dom();return Option.from(dom.nextSibling).map($_3bkrfxv6jh8lz3rm.fromDom)},prevSiblings=function(element){return $_f3qxhzthjh8lz3kg.reverse($_861s8bvjjh8lz3sp.toArray(element,prevSibling))},nextSiblings=function(element){return $_861s8bvjjh8lz3sp.toArray(element,nextSibling)},children=function(element){var dom=element.dom();return $_f3qxhzthjh8lz3kg.map(dom.childNodes,$_3bkrfxv6jh8lz3rm.fromDom)},child=function(element,index){var children=element.dom().childNodes;return Option.from(children[index]).map($_3bkrfxv6jh8lz3rm.fromDom)},firstChild=function(element){return child(element,0)},lastChild=function(element){return child(element,element.dom().childNodes.length-1)},childNodesCount=function(element){return element.dom().childNodes.length},hasChildNodes=function(element){return element.dom().hasChildNodes()},spot=$_57mdu6vejh8lz3sg.immutable("element","offset"),leaf=function(element,offset){var cs=children(element);return cs.length>0&&offset<cs.length?spot(cs[offset],0):spot(element,offset)},$_3jmbxmvdjh8lz3s4={owner:owner,defaultView:defaultView,documentElement:documentElement,parent:parent,findIndex:findIndex$1,parents:parents,siblings:siblings,prevSibling:prevSibling,offsetParent:offsetParent,prevSiblings:prevSiblings,nextSibling:nextSibling,nextSiblings:nextSiblings,children:children,child:child,firstChild:firstChild,lastChild:lastChild,childNodesCount:childNodesCount,hasChildNodes:hasChildNodes,leaf:leaf},all$1=function(predicate){return descendants($_35bizev9jh8lz3rx.body(),predicate)},ancestors=function(scope,predicate,isRoot){return $_f3qxhzthjh8lz3kg.filter($_3jmbxmvdjh8lz3s4.parents(scope,isRoot),predicate)},siblings$1=function(scope,predicate){return $_f3qxhzthjh8lz3kg.filter($_3jmbxmvdjh8lz3s4.siblings(scope),predicate)},children$1=function(scope,predicate){return $_f3qxhzthjh8lz3kg.filter($_3jmbxmvdjh8lz3s4.children(scope),predicate)},descendants=function(scope,predicate){var result=[];return $_f3qxhzthjh8lz3kg.each($_3jmbxmvdjh8lz3s4.children(scope),function(x){predicate(x)&&(result=result.concat([x])),result=result.concat(descendants(x,predicate))}),result},$_dz5cwuv8jh8lz3rt={all:all$1,ancestors:ancestors,siblings:siblings$1,children:children$1,descendants:descendants},all$2=function(selector){return $_2nczsvw0jh8lz3ua.all(selector)},ancestors$1=function(scope,selector,isRoot){return $_dz5cwuv8jh8lz3rt.ancestors(scope,function(e){return $_2nczsvw0jh8lz3ua.is(e,selector)},isRoot)},siblings$2=function(scope,selector){return $_dz5cwuv8jh8lz3rt.siblings(scope,function(e){return $_2nczsvw0jh8lz3ua.is(e,selector)})},children$2=function(scope,selector){return $_dz5cwuv8jh8lz3rt.children(scope,function(e){return $_2nczsvw0jh8lz3ua.is(e,selector)})},descendants$1=function(scope,selector){return $_2nczsvw0jh8lz3ua.all(selector,scope)},$_am3j0fv7jh8lz3rs={all:all$2,ancestors:ancestors$1,siblings:siblings$2,children:children$2,descendants:descendants$1},trim$1=global$2.trim,hasContentEditableState=function(value){return function(node){if(node&&1===node.nodeType){if(node.contentEditable===value)return!0;if(node.getAttribute("data-mce-contenteditable")===value)return!0}return!1}},isContentEditableTrue=hasContentEditableState("true"),isContentEditableFalse=hasContentEditableState("false"),create=function(type,title,url,level,attach){return{type:type,title:title,url:url,level:level,attach:attach}},isChildOfContentEditableTrue=function(node){for(;node=node.parentNode;){var value=node.contentEditable;if(value&&"inherit"!==value)return isContentEditableTrue(node)}return!1},select=function(selector,root){return $_f3qxhzthjh8lz3kg.map($_am3j0fv7jh8lz3rs.descendants($_3bkrfxv6jh8lz3rm.fromDom(root),selector),function(element){return element.dom()})},getElementText=function(elm){return elm.innerText||elm.textContent},getOrGenerateId=function(elm){return elm.id?elm.id:$_gdeezvv5jh8lz3rl.generate("h")},isAnchor=function(elm){return elm&&"A"===elm.nodeName&&(elm.id||elm.name)},isValidAnchor=function(elm){return isAnchor(elm)&&isEditable(elm)},isHeader=function(elm){return elm&&/^(H[1-6])$/.test(elm.nodeName)},isEditable=function(elm){return isChildOfContentEditableTrue(elm)&&!isContentEditableFalse(elm)},isValidHeader=function(elm){return isHeader(elm)&&isEditable(elm)},getLevel=function(elm){return isHeader(elm)?parseInt(elm.nodeName.substr(1),10):0},headerTarget=function(elm){var headerId=getOrGenerateId(elm),attach=function(){elm.id=headerId};return create("header",getElementText(elm),"#"+headerId,getLevel(elm),attach)},anchorTarget=function(elm){var anchorId=elm.id||elm.name,anchorText=getElementText(elm);return create("anchor",anchorText?anchorText:"#"+anchorId,"#"+anchorId,0,$_3pjweotejh8lz3k4.noop)},getHeaderTargets=function(elms){return $_f3qxhzthjh8lz3kg.map($_f3qxhzthjh8lz3kg.filter(elms,isValidHeader),headerTarget)},getAnchorTargets=function(elms){return $_f3qxhzthjh8lz3kg.map($_f3qxhzthjh8lz3kg.filter(elms,isValidAnchor),anchorTarget)},getTargetElements=function(elm){var elms=select("h1,h2,h3,h4,h5,h6,a:not([href])",elm);return elms},hasTitle=function(target){return trim$1(target.title).length>0},find$3=function(elm){var elms=getTargetElements(elm);return $_f3qxhzthjh8lz3kg.filter(getHeaderTargets(elms).concat(getAnchorTargets(elms)),hasTitle)},$_p3wpev4jh8lz3ra={find:find$3},getActiveEditor=function(){return window.tinymce?window.tinymce.activeEditor:global$1.activeEditor},history={},HISTORY_LENGTH=5,clearHistory=function(){history={}},toMenuItem=function(target){return{title:target.title,value:{title:{raw:target.title},url:target.url,attach:target.attach}}},toMenuItems=function(targets){return global$2.map(targets,toMenuItem)},staticMenuItem=function(title,url){return{title:title,value:{title:title,url:url,attach:$_3pjweotejh8lz3k4.noop}}},isUniqueUrl=function(url,targets){var foundTarget=$_f3qxhzthjh8lz3kg.exists(targets,function(target){return target.url===url});return!foundTarget},getSetting=function(editorSettings,name,defaultValue){var value=name in editorSettings?editorSettings[name]:defaultValue;return value===!1?null:value},createMenuItems=function(term,targets,fileType,editorSettings){var separator={title:"-"},fromHistoryMenuItems=function(history){var historyItems=history.hasOwnProperty(fileType)?history[fileType]:[],uniqueHistory=$_f3qxhzthjh8lz3kg.filter(historyItems,function(url){return isUniqueUrl(url,targets)});return global$2.map(uniqueHistory,function(url){return{title:url,value:{title:url,url:url,attach:$_3pjweotejh8lz3k4.noop}}})},fromMenuItems=function(type){var filteredTargets=$_f3qxhzthjh8lz3kg.filter(targets,function(target){return target.type===type});return toMenuItems(filteredTargets)},anchorMenuItems=function(){var anchorMenuItems=fromMenuItems("anchor"),topAnchor=getSetting(editorSettings,"anchor_top","#top"),bottomAchor=getSetting(editorSettings,"anchor_bottom","#bottom");return null!==topAnchor&&anchorMenuItems.unshift(staticMenuItem("<top>",topAnchor)),null!==bottomAchor&&anchorMenuItems.push(staticMenuItem("<bottom>",bottomAchor)),anchorMenuItems},join=function(items){return $_f3qxhzthjh8lz3kg.foldl(items,function(a,b){var bothEmpty=0===a.length||0===b.length;return bothEmpty?a.concat(b):a.concat(separator,b)},[])};return editorSettings.typeahead_urls===!1?[]:"file"===fileType?join([filterByQuery(term,fromHistoryMenuItems(history)),filterByQuery(term,fromMenuItems("header")),filterByQuery(term,anchorMenuItems())]):filterByQuery(term,fromHistoryMenuItems(history))},addToHistory=function(url,fileType){var items=history[fileType];/^https?/.test(url)&&(items?$_f3qxhzthjh8lz3kg.indexOf(items,url).isNone()&&(history[fileType]=items.slice(0,HISTORY_LENGTH).concat(url)):history[fileType]=[url])},filterByQuery=function(term,menuItems){var lowerCaseTerm=term.toLowerCase(),result=global$2.grep(menuItems,function(item){return item.title.toLowerCase().indexOf(lowerCaseTerm)!==-1});return 1===result.length&&result[0].title===term?[]:result},getTitle=function(linkDetails){var title=linkDetails.title;return title.raw?title.raw:title},setupAutoCompleteHandler=function(ctrl,editorSettings,bodyElm,fileType){var autocomplete=function(term){var linkTargets=$_p3wpev4jh8lz3ra.find(bodyElm),menuItems=createMenuItems(term,linkTargets,fileType,editorSettings);ctrl.showAutoComplete(menuItems,term)};ctrl.on("autocomplete",function(){autocomplete(ctrl.value())}),ctrl.on("selectitem",function(e){var linkDetails=e.value;ctrl.value(linkDetails.url);var title=getTitle(linkDetails);"image"===fileType?ctrl.fire("change",{meta:{alt:title,attach:linkDetails.attach}}):ctrl.fire("change",{meta:{text:title,attach:linkDetails.attach}}),ctrl.focus()}),ctrl.on("click",function(e){0===ctrl.value().length&&"INPUT"===e.target.nodeName&&autocomplete("")}),ctrl.on("PostRender",function(){ctrl.getRoot().on("submit",function(e){e.isDefaultPrevented()||addToHistory(ctrl.value(),fileType)})})},statusToUiState=function(result){var status=result.status,message=result.message;return"valid"===status?{status:"ok",message:message}:"unknown"===status?{status:"warn",message:message}:"invalid"===status?{status:"warn",message:message}:{status:"none",message:""}},setupLinkValidatorHandler=function(ctrl,editorSettings,fileType){var validatorHandler=editorSettings.filepicker_validator_handler;if(validatorHandler){var validateUrl_1=function(url){return 0===url.length?void ctrl.statusLevel("none"):void validatorHandler({url:url,type:fileType},function(result){var uiState=statusToUiState(result);ctrl.statusMessage(uiState.message),ctrl.statusLevel(uiState.status)})};ctrl.state.on("change:value",function(e){validateUrl_1(e.value)})}},FilePicker=ComboBox.extend({Statics:{clearHistory:clearHistory},init:function(settings){var actionCallback,fileBrowserCallback,fileBrowserCallbackTypes,self=this,editor=getActiveEditor(),editorSettings=editor.settings,fileType=settings.filetype;settings.spellcheck=!1,fileBrowserCallbackTypes=editorSettings.file_picker_types||editorSettings.file_browser_callback_types,fileBrowserCallbackTypes&&(fileBrowserCallbackTypes=global$2.makeMap(fileBrowserCallbackTypes,/[, ]/)),fileBrowserCallbackTypes&&!fileBrowserCallbackTypes[fileType]||(fileBrowserCallback=editorSettings.file_picker_callback,!fileBrowserCallback||fileBrowserCallbackTypes&&!fileBrowserCallbackTypes[fileType]?(fileBrowserCallback=editorSettings.file_browser_callback,!fileBrowserCallback||fileBrowserCallbackTypes&&!fileBrowserCallbackTypes[fileType]||(actionCallback=function(){fileBrowserCallback(self.getEl("inp").id,self.value(),fileType,window)})):actionCallback=function(){var meta=self.fire("beforecall").meta;meta=global$2.extend({filetype:fileType},meta),fileBrowserCallback.call(editor,function(value,meta){self.value(value).fire("change",{meta:meta})},self.value(),meta)}),actionCallback&&(settings.icon="browse",settings.onaction=actionCallback),self._super(settings),self.classes.add("filepicker"),setupAutoCompleteHandler(self,editorSettings,editor.getBody(),fileType),setupLinkValidatorHandler(self,editorSettings,fileType)}}),FitLayout=AbsoluteLayout.extend({recalc:function(container){var contLayoutRect=container.layoutRect(),paddingBox=container.paddingBox;container.items().filter(":visible").each(function(ctrl){ctrl.layoutRect({x:paddingBox.left,y:paddingBox.top,w:contLayoutRect.innerW-paddingBox.right-paddingBox.left,h:contLayoutRect.innerH-paddingBox.top-paddingBox.bottom}),ctrl.recalc&&ctrl.recalc()})}}),FlexLayout=AbsoluteLayout.extend({recalc:function(container){var i,l,items,contLayoutRect,contPaddingBox,contSettings,align,pack,spacing,totalFlex,availableSpace,direction,ctrl,ctrlLayoutRect,ctrlSettings,flex,size,maxSize,ratio,rect,pos,maxAlignEndPos,sizeName,minSizeName,posName,maxSizeName,beforeName,innerSizeName,deltaSizeName,contentSizeName,alignAxisName,alignInnerSizeName,alignSizeName,alignMinSizeName,alignBeforeName,alignAfterName,alignDeltaSizeName,alignContentSizeName,maxSizeItems=[],max=Math.max,min=Math.min;for(items=container.items().filter(":visible"),contLayoutRect=container.layoutRect(),contPaddingBox=container.paddingBox,contSettings=container.settings,direction=container.isRtl()?contSettings.direction||"row-reversed":contSettings.direction,align=contSettings.align,pack=container.isRtl()?contSettings.pack||"end":contSettings.pack,spacing=contSettings.spacing||0,"row-reversed"!==direction&&"column-reverse"!==direction||(items=items.set(items.toArray().reverse()),direction=direction.split("-")[0]),"column"===direction?(posName="y",sizeName="h",minSizeName="minH",maxSizeName="maxH",innerSizeName="innerH",beforeName="top",deltaSizeName="deltaH",contentSizeName="contentH",alignBeforeName="left",alignSizeName="w",alignAxisName="x",alignInnerSizeName="innerW",alignMinSizeName="minW",alignAfterName="right",alignDeltaSizeName="deltaW",alignContentSizeName="contentW"):(posName="x",sizeName="w",minSizeName="minW",maxSizeName="maxW",innerSizeName="innerW",beforeName="left",deltaSizeName="deltaW",contentSizeName="contentW",alignBeforeName="top",alignSizeName="h",alignAxisName="y",alignInnerSizeName="innerH",alignMinSizeName="minH",alignAfterName="bottom",alignDeltaSizeName="deltaH",alignContentSizeName="contentH"),availableSpace=contLayoutRect[innerSizeName]-contPaddingBox[beforeName]-contPaddingBox[beforeName],maxAlignEndPos=totalFlex=0,i=0,l=items.length;i<l;i++)ctrl=items[i],ctrlLayoutRect=ctrl.layoutRect(),ctrlSettings=ctrl.settings,flex=ctrlSettings.flex,availableSpace-=i<l-1?spacing:0,flex>0&&(totalFlex+=flex,ctrlLayoutRect[maxSizeName]&&maxSizeItems.push(ctrl),ctrlLayoutRect.flex=flex),availableSpace-=ctrlLayoutRect[minSizeName],size=contPaddingBox[alignBeforeName]+ctrlLayoutRect[alignMinSizeName]+contPaddingBox[alignAfterName],size>maxAlignEndPos&&(maxAlignEndPos=size);if(rect={},availableSpace<0?rect[minSizeName]=contLayoutRect[minSizeName]-availableSpace+contLayoutRect[deltaSizeName]:rect[minSizeName]=contLayoutRect[innerSizeName]-availableSpace+contLayoutRect[deltaSizeName],rect[alignMinSizeName]=maxAlignEndPos+contLayoutRect[alignDeltaSizeName],rect[contentSizeName]=contLayoutRect[innerSizeName]-availableSpace,rect[alignContentSizeName]=maxAlignEndPos,rect.minW=min(rect.minW,contLayoutRect.maxW),rect.minH=min(rect.minH,contLayoutRect.maxH),rect.minW=max(rect.minW,contLayoutRect.startMinWidth),rect.minH=max(rect.minH,contLayoutRect.startMinHeight),!contLayoutRect.autoResize||rect.minW===contLayoutRect.minW&&rect.minH===contLayoutRect.minH){for(ratio=availableSpace/totalFlex,i=0,l=maxSizeItems.length;i<l;i++)ctrl=maxSizeItems[i],ctrlLayoutRect=ctrl.layoutRect(),maxSize=ctrlLayoutRect[maxSizeName],size=ctrlLayoutRect[minSizeName]+ctrlLayoutRect.flex*ratio,size>maxSize?(availableSpace-=ctrlLayoutRect[maxSizeName]-ctrlLayoutRect[minSizeName],totalFlex-=ctrlLayoutRect.flex,ctrlLayoutRect.flex=0,ctrlLayoutRect.maxFlexSize=maxSize):ctrlLayoutRect.maxFlexSize=0;for(ratio=availableSpace/totalFlex,pos=contPaddingBox[beforeName],rect={},0===totalFlex&&("end"===pack?pos=availableSpace+contPaddingBox[beforeName]:"center"===pack?(pos=Math.round(contLayoutRect[innerSizeName]/2-(contLayoutRect[innerSizeName]-availableSpace)/2)+contPaddingBox[beforeName],pos<0&&(pos=contPaddingBox[beforeName])):"justify"===pack&&(pos=contPaddingBox[beforeName],spacing=Math.floor(availableSpace/(items.length-1)))),rect[alignAxisName]=contPaddingBox[alignBeforeName],i=0,l=items.length;i<l;i++)ctrl=items[i],ctrlLayoutRect=ctrl.layoutRect(),size=ctrlLayoutRect.maxFlexSize||ctrlLayoutRect[minSizeName],"center"===align?rect[alignAxisName]=Math.round(contLayoutRect[alignInnerSizeName]/2-ctrlLayoutRect[alignSizeName]/2):"stretch"===align?(rect[alignSizeName]=max(ctrlLayoutRect[alignMinSizeName]||0,contLayoutRect[alignInnerSizeName]-contPaddingBox[alignBeforeName]-contPaddingBox[alignAfterName]),rect[alignAxisName]=contPaddingBox[alignBeforeName]):"end"===align&&(rect[alignAxisName]=contLayoutRect[alignInnerSizeName]-ctrlLayoutRect[alignSizeName]-contPaddingBox.top),ctrlLayoutRect.flex>0&&(size+=ctrlLayoutRect.flex*ratio),rect[sizeName]=size,rect[posName]=pos,ctrl.layoutRect(rect),ctrl.recalc&&ctrl.recalc(),pos+=size+spacing}else if(rect.w=rect.minW,rect.h=rect.minH,container.layoutRect(rect),this.recalc(container),null===container._lastRect){var parentCtrl=container.parent();parentCtrl&&(parentCtrl._lastRect=null,parentCtrl.recalc())}}}),FlowLayout=Layout.extend({Defaults:{containerClass:"flow-layout",controlClass:"flow-layout-item",endClass:"break"},recalc:function(container){container.items().filter(":visible").each(function(ctrl){ctrl.recalc&&ctrl.recalc()})},isNative:function(){return!0}}),first$1=function(predicate){return descendant($_35bizev9jh8lz3rx.body(),predicate)},ancestor=function(scope,predicate,isRoot){for(var element=scope.dom(),stop=$_d8bie3tijh8lz3kn.isFunction(isRoot)?isRoot:$_3pjweotejh8lz3k4.constant(!1);element.parentNode;){element=element.parentNode;var el=$_3bkrfxv6jh8lz3rm.fromDom(element);if(predicate(el))return Option.some(el);if(stop(el))break}return Option.none()},closest=function(scope,predicate,isRoot){var is=function(scope){return predicate(scope)};return ClosestOrAncestor(is,ancestor,scope,predicate,isRoot)},sibling=function(scope,predicate){var element=scope.dom();return element.parentNode?child$1($_3bkrfxv6jh8lz3rm.fromDom(element.parentNode),function(x){return!$_9ypjy6vkjh8lz3sq.eq(scope,x)&&predicate(x)}):Option.none()},child$1=function(scope,predicate){var result=$_f3qxhzthjh8lz3kg.find(scope.dom().childNodes,$_3pjweotejh8lz3k4.compose(predicate,$_3bkrfxv6jh8lz3rm.fromDom));return result.map($_3bkrfxv6jh8lz3rm.fromDom)},descendant=function(scope,predicate){var descend=function(element){for(var i=0;i<element.childNodes.length;i++){if(predicate($_3bkrfxv6jh8lz3rm.fromDom(element.childNodes[i])))return Option.some($_3bkrfxv6jh8lz3rm.fromDom(element.childNodes[i]));var res=descend(element.childNodes[i]);if(res.isSome())return res}return Option.none()};return descend(scope.dom())},$_5a72sw6jh8lz3uv={first:first$1,ancestor:ancestor,closest:closest,sibling:sibling,child:child$1,descendant:descendant},first$2=function(selector){return $_2nczsvw0jh8lz3ua.one(selector)},ancestor$1=function(scope,selector,isRoot){return $_5a72sw6jh8lz3uv.ancestor(scope,function(e){return $_2nczsvw0jh8lz3ua.is(e,selector)},isRoot)},sibling$1=function(scope,selector){return $_5a72sw6jh8lz3uv.sibling(scope,function(e){return $_2nczsvw0jh8lz3ua.is(e,selector)})},child$2=function(scope,selector){return $_5a72sw6jh8lz3uv.child(scope,function(e){return $_2nczsvw0jh8lz3ua.is(e,selector)})},descendant$1=function(scope,selector){return $_2nczsvw0jh8lz3ua.one(selector,scope)},closest$1=function(scope,selector,isRoot){return ClosestOrAncestor($_2nczsvw0jh8lz3ua.is,ancestor$1,scope,selector,isRoot)},$_9rr9rgw5jh8lz3uu={first:first$2,ancestor:ancestor$1,sibling:sibling$1,child:child$2,descendant:descendant$1,closest:closest$1},toggleFormat=function(editor,fmt){return function(){editor.execCommand("mceToggleFormat",!1,fmt)}},addFormatChangedListener=function(editor,name,changed){var handler=function(state){changed(state,name)};editor.formatter?editor.formatter.formatChanged(name,handler):editor.on("init",function(){editor.formatter.formatChanged(name,handler)})},postRenderFormatToggle=function(editor,name){return function(e){addFormatChangedListener(editor,name,function(state){e.control.active(state)})}},register=function(editor){var alignFormats=["alignleft","aligncenter","alignright","alignjustify"],defaultAlign="alignleft",alignMenuItems=[{text:"Left",icon:"alignleft",onclick:toggleFormat(editor,"alignleft")},{text:"Center",icon:"aligncenter",onclick:toggleFormat(editor,"aligncenter")},{text:"Right",icon:"alignright",onclick:toggleFormat(editor,"alignright")},{text:"Justify",icon:"alignjustify",onclick:toggleFormat(editor,"alignjustify")}];editor.addMenuItem("align",{text:"Align",menu:alignMenuItems}),editor.addButton("align",{type:"menubutton",icon:defaultAlign,menu:alignMenuItems,onShowMenu:function(e){var menu=e.control.menu;global$2.each(alignFormats,function(formatName,idx){menu.items().eq(idx).each(function(item){return item.active(editor.formatter.match(formatName))})})},onPostRender:function(e){var ctrl=e.control;global$2.each(alignFormats,function(formatName,idx){addFormatChangedListener(editor,formatName,function(state){ctrl.icon(defaultAlign),state&&ctrl.icon(formatName)})})}}),global$2.each({alignleft:["Align left","JustifyLeft"],aligncenter:["Align center","JustifyCenter"],alignright:["Align right","JustifyRight"],alignjustify:["Justify","JustifyFull"],alignnone:["No alignment","JustifyNone"]},function(item,name){editor.addButton(name,{active:!1,tooltip:item[0],cmd:item[1],onPostRender:postRenderFormatToggle(editor,name)})})},$_a6x5k4w8jh8lz3vh={register:register},getFirstFont=function(fontFamily){return fontFamily?fontFamily.split(",")[0]:""},findMatchingValue=function(items,fontFamily){var value,font=fontFamily?fontFamily.toLowerCase():"";return global$2.each(items,function(item){item.value.toLowerCase()===font&&(value=item.value)}),global$2.each(items,function(item){value||getFirstFont(item.value).toLowerCase()!==getFirstFont(font).toLowerCase()||(value=item.value)}),value},createFontNameListBoxChangeHandler=function(editor,items){return function(){var self=this;editor.on("init nodeChange",function(e){var fontFamily=editor.queryCommandValue("FontName"),match=findMatchingValue(items,fontFamily);self.value(match?match:null),!match&&fontFamily&&self.text(getFirstFont(fontFamily))})}},createFormats=function(formats){formats=formats.replace(/;$/,"").split(";");for(var i=formats.length;i--;)formats[i]=formats[i].split("=");return formats},getFontItems=function(editor){var defaultFontsFormats="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",fonts=createFormats(editor.settings.font_formats||defaultFontsFormats);return global$2.map(fonts,function(font){return{text:{raw:font[0]},value:font[1],textStyle:font[1].indexOf("dings")===-1?"font-family:"+font[1]:""}})},registerButtons=function(editor){editor.addButton("fontselect",function(){var items=getFontItems(editor);return{type:"listbox",text:"Font Family",tooltip:"Font Family",values:items,fixedWidth:!0,onPostRender:createFontNameListBoxChangeHandler(editor,items),onselect:function(e){e.control.settings.value&&editor.execCommand("FontName",!1,e.control.settings.value)}}})},register$1=function(editor){registerButtons(editor)},$_4hdsyewajh8lz3vk={register:register$1},round=function(number,precision){var factor=Math.pow(10,precision);return Math.round(number*factor)/factor},toPt=function(fontSize,precision){return/[0-9.]+px$/.test(fontSize)?round(72*parseInt(fontSize,10)/96,precision||0)+"pt":fontSize},findMatchingValue$1=function(items,pt,px){var value;return global$2.each(items,function(item){item.value===px?value=px:item.value===pt&&(value=pt)}),value},createFontSizeListBoxChangeHandler=function(editor,items){return function(){var self=this;editor.on("init nodeChange",function(e){var px,pt,precision,match;if(px=editor.queryCommandValue("FontSize"))for(precision=3;!match&&precision>=0;precision--)pt=toPt(px,precision),match=findMatchingValue$1(items,pt,px);self.value(match?match:null),match||self.text(pt)})}},getFontSizeItems=function(editor){var defaultFontsizeFormats="8pt 10pt 12pt 14pt 18pt 24pt 36pt",fontsizeFormats=editor.settings.fontsize_formats||defaultFontsizeFormats;return global$2.map(fontsizeFormats.split(" "),function(item){var text=item,value=item,values=item.split("=");return values.length>1&&(text=values[0],value=values[1]),{text:text,value:value}})},registerButtons$1=function(editor){editor.addButton("fontsizeselect",function(){var items=getFontSizeItems(editor);return{type:"listbox",text:"Font Sizes",tooltip:"Font Sizes",values:items,fixedWidth:!0,onPostRender:createFontSizeListBoxChangeHandler(editor,items),onclick:function(e){e.control.settings.value&&editor.execCommand("FontSize",!1,e.control.settings.value)}}})},register$2=function(editor){registerButtons$1(editor)},$_du9atdwbjh8lz3vn={register:register$2},hideMenuObjects=function(editor,menu){var count=menu.length;return global$2.each(menu,function(item){item.menu&&(item.hidden=0===hideMenuObjects(editor,item.menu));var formatName=item.format;formatName&&(item.hidden=!editor.formatter.canApply(formatName)),item.hidden&&count--}),count},hideFormatMenuItems=function(editor,menu){var count=menu.items().length;return menu.items().each(function(item){item.menu&&item.visible(hideFormatMenuItems(editor,item.menu)>0),!item.menu&&item.settings.menu&&item.visible(hideMenuObjects(editor,item.settings.menu)>0);var formatName=item.settings.format;formatName&&item.visible(editor.formatter.canApply(formatName)),item.visible()||count--}),count},createFormatMenu=function(editor){var count=0,newFormats=[],defaultStyleFormats=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],createMenu=function(formats){var menu=[];if(formats)return global$2.each(formats,function(format){var menuItem={text:format.title,icon:format.icon};if(format.items)menuItem.menu=createMenu(format.items);else{var formatName=format.format||"custom"+count++;format.format||(format.name=formatName,newFormats.push(format)),menuItem.format=formatName,menuItem.cmd=format.cmd}menu.push(menuItem)}),menu},createStylesMenu=function(){var menu;return menu=createMenu(editor.settings.style_formats_merge?editor.settings.style_formats?defaultStyleFormats.concat(editor.settings.style_formats):defaultStyleFormats:editor.settings.style_formats||defaultStyleFormats)};return editor.on("init",function(){global$2.each(newFormats,function(format){editor.formatter.register(format.name,format)})}),{type:"menu",items:createStylesMenu(),onPostRender:function(e){editor.fire("renderFormatsMenu",{control:e.control})},itemDefaults:{preview:!0,textStyle:function(){if(this.settings.format)return editor.formatter.getCssText(this.settings.format)},onPostRender:function(){var self=this;self.parent().on("show",function(){var formatName,command;formatName=self.settings.format,formatName&&(self.disabled(!editor.formatter.canApply(formatName)),self.active(editor.formatter.match(formatName))),command=self.settings.cmd,command&&self.active(editor.queryCommandState(command))})},onclick:function(){this.settings.format&&toggleFormat(editor,this.settings.format)(),this.settings.cmd&&editor.execCommand(this.settings.cmd)}}}},registerMenuItems=function(editor,formatMenu){editor.addMenuItem("formats",{text:"Formats",menu:formatMenu})},registerButtons$2=function(editor,formatMenu){editor.addButton("styleselect",{type:"menubutton",text:"Formats",menu:formatMenu,onShowMenu:function(){editor.settings.style_formats_autohide&&hideFormatMenuItems(editor,this.menu)}})},register$3=function(editor){var formatMenu=createFormatMenu(editor);registerMenuItems(editor,formatMenu),registerButtons$2(editor,formatMenu)},$_5xlhbcwcjh8lz3vr={register:register$3},defaultBlocks="Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",createFormats$1=function(formats){formats=formats.replace(/;$/,"").split(";");for(var i=formats.length;i--;)formats[i]=formats[i].split("=");return formats},createListBoxChangeHandler=function(editor,items,formatName){return function(){var self=this;editor.on("nodeChange",function(e){var formatter=editor.formatter,value=null;global$2.each(e.parents,function(node){if(global$2.each(items,function(item){if(formatName?formatter.matchNode(node,formatName,{value:item.value})&&(value=item.value):formatter.matchNode(node,item.value)&&(value=item.value),value)return!1}),value)return!1}),self.value(value)})}},lazyFormatSelectBoxItems=function(editor,blocks){return function(){var items=[];return global$2.each(blocks,function(block){items.push({text:block[0],value:block[1],textStyle:function(){return editor.formatter.getCssText(block[1])}})}),{type:"listbox",text:blocks[0][0],values:items,fixedWidth:!0,onselect:function(e){if(e.control){var fmt=e.control.value();toggleFormat(editor,fmt)()}},onPostRender:createListBoxChangeHandler(editor,items)}}},buildMenuItems=function(editor,blocks){return global$2.map(blocks,function(block){return{text:block[0],onclick:toggleFormat(editor,block[1]),textStyle:function(){return editor.formatter.getCssText(block[1])}}})},register$4=function(editor){var blocks=createFormats$1(editor.settings.block_formats||defaultBlocks);editor.addMenuItem("blockformats",{
text:"Blocks",menu:buildMenuItems(editor,blocks)}),editor.addButton("formatselect",lazyFormatSelectBoxItems(editor,blocks))},$_bj8nxmwdjh8lz3vw={register:register$4},createCustomMenuItems=function(editor,names){var items,nameList;if("string"==typeof names)nameList=names.split(" ");else if(global$2.isArray(names))return $_f3qxhzthjh8lz3kg.flatten(global$2.map(names,function(names){return createCustomMenuItems(editor,names)}));return items=global$2.grep(nameList,function(name){return"|"===name||name in editor.menuItems}),global$2.map(items,function(name){return"|"===name?{text:"-"}:editor.menuItems[name]})},isSeparator$1=function(menuItem){return menuItem&&"-"===menuItem.text},trimMenuItems=function(menuItems){var menuItems2=$_f3qxhzthjh8lz3kg.filter(menuItems,function(menuItem,i,menuItems){return!isSeparator$1(menuItem)||!isSeparator$1(menuItems[i-1])});return $_f3qxhzthjh8lz3kg.filter(menuItems2,function(menuItem,i,menuItems){return!isSeparator$1(menuItem)||i>0&&i<menuItems.length-1})},createContextMenuItems=function(editor,context){var outputMenuItems=[{text:"-"}],menuItems=global$2.grep(editor.menuItems,function(menuItem){return menuItem.context===context});return global$2.each(menuItems,function(menuItem){"before"===menuItem.separator&&outputMenuItems.push({text:"|"}),menuItem.prependToContext?outputMenuItems.unshift(menuItem):outputMenuItems.push(menuItem),"after"===menuItem.separator&&outputMenuItems.push({text:"|"})}),outputMenuItems},createInsertMenu=function(editor){var insertButtonItems=editor.settings.insert_button_items;return trimMenuItems(insertButtonItems?createCustomMenuItems(editor,insertButtonItems):createContextMenuItems(editor,"insert"))},registerButtons$3=function(editor){editor.addButton("insert",{type:"menubutton",icon:"insert",menu:[],oncreatemenu:function(){this.menu.add(createInsertMenu(editor)),this.menu.renderNew()}})},register$5=function(editor){registerButtons$3(editor)},$_drvzmkwejh8lz3vz={register:register$5},registerFormatButtons=function(editor){global$2.each({bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript"},function(text,name){editor.addButton(name,{active:!1,tooltip:text,onPostRender:postRenderFormatToggle(editor,name),onclick:toggleFormat(editor,name)})})},registerCommandButtons=function(editor){global$2.each({outdent:["Decrease indent","Outdent"],indent:["Increase indent","Indent"],cut:["Cut","Cut"],copy:["Copy","Copy"],paste:["Paste","Paste"],help:["Help","mceHelp"],selectall:["Select all","SelectAll"],visualaid:["Visual aids","mceToggleVisualAid"],newdocument:["New document","mceNewDocument"],removeformat:["Clear formatting","RemoveFormat"],remove:["Remove","Delete"]},function(item,name){editor.addButton(name,{tooltip:item[0],cmd:item[1]})})},registerCommandToggleButtons=function(editor){global$2.each({blockquote:["Blockquote","mceBlockQuote"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"]},function(item,name){editor.addButton(name,{active:!1,tooltip:item[0],cmd:item[1],onPostRender:postRenderFormatToggle(editor,name)})})},registerButtons$4=function(editor){registerFormatButtons(editor),registerCommandButtons(editor),registerCommandToggleButtons(editor)},registerMenuItems$1=function(editor){global$2.each({bold:["Bold","Bold","Meta+B"],italic:["Italic","Italic","Meta+I"],underline:["Underline","Underline","Meta+U"],strikethrough:["Strikethrough","Strikethrough"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],removeformat:["Clear formatting","RemoveFormat"],newdocument:["New document","mceNewDocument"],cut:["Cut","Cut","Meta+X"],copy:["Copy","Copy","Meta+C"],paste:["Paste","Paste","Meta+V"],selectall:["Select all","SelectAll","Meta+A"]},function(item,name){editor.addMenuItem(name,{text:item[0],icon:name,shortcut:item[2],cmd:item[1]})}),editor.addMenuItem("codeformat",{text:"Code",icon:"code",onclick:toggleFormat(editor,"code")})},register$6=function(editor){registerButtons$4(editor),registerMenuItems$1(editor)},$_2d67dwfjh8lz3w2={register:register$6},toggleUndoRedoState=function(editor,type){return function(){var self=this,checkState=function(){var typeFn="redo"===type?"hasRedo":"hasUndo";return!!editor.undoManager&&editor.undoManager[typeFn]()};self.disabled(!checkState()),editor.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",function(){self.disabled(editor.readonly||!checkState())})}},registerMenuItems$2=function(editor){editor.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onPostRender:toggleUndoRedoState(editor,"undo"),cmd:"undo"}),editor.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onPostRender:toggleUndoRedoState(editor,"redo"),cmd:"redo"})},registerButtons$5=function(editor){editor.addButton("undo",{tooltip:"Undo",onPostRender:toggleUndoRedoState(editor,"undo"),cmd:"undo"}),editor.addButton("redo",{tooltip:"Redo",onPostRender:toggleUndoRedoState(editor,"redo"),cmd:"redo"})},register$7=function(editor){registerMenuItems$2(editor),registerButtons$5(editor)},$_cd5m9xwgjh8lz3w5={register:register$7},toggleVisualAidState=function(editor){return function(){var self=this;editor.on("VisualAid",function(e){self.active(e.hasVisual)}),self.active(editor.hasVisual)}},registerMenuItems$3=function(editor){editor.addMenuItem("visualaid",{text:"Visual aids",selectable:!0,onPostRender:toggleVisualAidState(editor),cmd:"mceToggleVisualAid"})},register$8=function(editor){registerMenuItems$3(editor)},$_1ojpofwhjh8lz3w6={register:register$8},setupEnvironment=function(){Widget.tooltips=!global$8.iOS,Control$1.translate=function(text){return global$1.translate(text)}},setupUiContainer=function(editor){editor.settings.ui_container&&(global$8.container=$_9rr9rgw5jh8lz3uu.descendant($_3bkrfxv6jh8lz3rm.fromDom(document.body),editor.settings.ui_container).fold($_3pjweotejh8lz3k4.constant(null),function(elm){return elm.dom()}))},setupRtlMode=function(editor){editor.rtl&&(Control$1.rtl=!0)},setupHideFloatPanels=function(editor){editor.on("mousedown",function(){FloatPanel.hideAll()})},setup$1=function(editor){setupRtlMode(editor),setupHideFloatPanels(editor),setupUiContainer(editor),setupEnvironment(),$_bj8nxmwdjh8lz3vw.register(editor),$_a6x5k4w8jh8lz3vh.register(editor),$_2d67dwfjh8lz3w2.register(editor),$_cd5m9xwgjh8lz3w5.register(editor),$_du9atdwbjh8lz3vn.register(editor),$_4hdsyewajh8lz3vk.register(editor),$_5xlhbcwcjh8lz3vr.register(editor),$_1ojpofwhjh8lz3w6.register(editor),$_drvzmkwejh8lz3vz.register(editor)},$_4qdht3w4jh8lz3uo={setup:setup$1},GridLayout=AbsoluteLayout.extend({recalc:function(container){var settings,rows,cols,items,contLayoutRect,width,height,rect,ctrlLayoutRect,ctrl,x,y,posX,posY,ctrlSettings,contPaddingBox,align,spacingH,spacingV,alignH,alignV,maxX,maxY,ctrlMinWidth,ctrlMinHeight,availableWidth,availableHeight,reverseRows,idx,colWidths=[],rowHeights=[];settings=container.settings,items=container.items().filter(":visible"),contLayoutRect=container.layoutRect(),cols=settings.columns||Math.ceil(Math.sqrt(items.length)),rows=Math.ceil(items.length/cols),spacingH=settings.spacingH||settings.spacing||0,spacingV=settings.spacingV||settings.spacing||0,alignH=settings.alignH||settings.align,alignV=settings.alignV||settings.align,contPaddingBox=container.paddingBox,reverseRows="reverseRows"in settings?settings.reverseRows:container.isRtl(),alignH&&"string"==typeof alignH&&(alignH=[alignH]),alignV&&"string"==typeof alignV&&(alignV=[alignV]);for(x=0;x<cols;x++)colWidths.push(0);for(y=0;y<rows;y++)rowHeights.push(0);for(y=0;y<rows;y++)for(x=0;x<cols&&(ctrl=items[y*cols+x],ctrl);x++)ctrlLayoutRect=ctrl.layoutRect(),ctrlMinWidth=ctrlLayoutRect.minW,ctrlMinHeight=ctrlLayoutRect.minH,colWidths[x]=ctrlMinWidth>colWidths[x]?ctrlMinWidth:colWidths[x],rowHeights[y]=ctrlMinHeight>rowHeights[y]?ctrlMinHeight:rowHeights[y];for(availableWidth=contLayoutRect.innerW-contPaddingBox.left-contPaddingBox.right,maxX=0,x=0;x<cols;x++)maxX+=colWidths[x]+(x>0?spacingH:0),availableWidth-=(x>0?spacingH:0)+colWidths[x];for(availableHeight=contLayoutRect.innerH-contPaddingBox.top-contPaddingBox.bottom,maxY=0,y=0;y<rows;y++)maxY+=rowHeights[y]+(y>0?spacingV:0),availableHeight-=(y>0?spacingV:0)+rowHeights[y];if(maxX+=contPaddingBox.left+contPaddingBox.right,maxY+=contPaddingBox.top+contPaddingBox.bottom,rect={},rect.minW=maxX+(contLayoutRect.w-contLayoutRect.innerW),rect.minH=maxY+(contLayoutRect.h-contLayoutRect.innerH),rect.contentW=rect.minW-contLayoutRect.deltaW,rect.contentH=rect.minH-contLayoutRect.deltaH,rect.minW=Math.min(rect.minW,contLayoutRect.maxW),rect.minH=Math.min(rect.minH,contLayoutRect.maxH),rect.minW=Math.max(rect.minW,contLayoutRect.startMinWidth),rect.minH=Math.max(rect.minH,contLayoutRect.startMinHeight),!contLayoutRect.autoResize||rect.minW===contLayoutRect.minW&&rect.minH===contLayoutRect.minH){contLayoutRect.autoResize&&(rect=container.layoutRect(rect),rect.contentW=rect.minW-contLayoutRect.deltaW,rect.contentH=rect.minH-contLayoutRect.deltaH);var flexV;flexV="start"===settings.packV?0:availableHeight>0?Math.floor(availableHeight/rows):0;var totalFlex=0,flexWidths=settings.flexWidths;if(flexWidths)for(x=0;x<flexWidths.length;x++)totalFlex+=flexWidths[x];else totalFlex=cols;var ratio=availableWidth/totalFlex;for(x=0;x<cols;x++)colWidths[x]+=flexWidths?flexWidths[x]*ratio:ratio;for(posY=contPaddingBox.top,y=0;y<rows;y++){for(posX=contPaddingBox.left,height=rowHeights[y]+flexV,x=0;x<cols&&(idx=reverseRows?y*cols+cols-1-x:y*cols+x,ctrl=items[idx],ctrl);x++)ctrlSettings=ctrl.settings,ctrlLayoutRect=ctrl.layoutRect(),width=Math.max(colWidths[x],ctrlLayoutRect.startMinWidth),ctrlLayoutRect.x=posX,ctrlLayoutRect.y=posY,align=ctrlSettings.alignH||(alignH?alignH[x]||alignH[0]:null),"center"===align?ctrlLayoutRect.x=posX+width/2-ctrlLayoutRect.w/2:"right"===align?ctrlLayoutRect.x=posX+width-ctrlLayoutRect.w:"stretch"===align&&(ctrlLayoutRect.w=width),align=ctrlSettings.alignV||(alignV?alignV[x]||alignV[0]:null),"center"===align?ctrlLayoutRect.y=posY+height/2-ctrlLayoutRect.h/2:"bottom"===align?ctrlLayoutRect.y=posY+height-ctrlLayoutRect.h:"stretch"===align&&(ctrlLayoutRect.h=height),ctrl.layoutRect(ctrlLayoutRect),posX+=width+spacingH,ctrl.recalc&&ctrl.recalc();posY+=height+spacingV}}else if(rect.w=rect.minW,rect.h=rect.minH,container.layoutRect(rect),this.recalc(container),null===container._lastRect){var parentCtrl=container.parent();parentCtrl&&(parentCtrl._lastRect=null,parentCtrl.recalc())}}}),Iframe$1=Widget.extend({renderHtml:function(){var self=this;return self.classes.add("iframe"),self.canFocus=!1,'<iframe id="'+self._id+'" class="'+self.classes+'" tabindex="-1" src="'+(self.settings.url||"javascript:''")+'" frameborder="0"></iframe>'},src:function(src){this.getEl().src=src},html:function(html,callback){var self=this,body=this.getEl().contentWindow.document.body;return body?(body.innerHTML=html,callback&&callback()):global$7.setTimeout(function(){self.html(html)}),this}}),InfoBox=Widget.extend({init:function(settings){var self=this;self._super(settings),self.classes.add("widget").add("infobox"),self.canFocus=!1},severity:function(level){this.classes.remove("error"),this.classes.remove("warning"),this.classes.remove("success"),this.classes.add(level)},help:function(state){this.state.set("help",state)},renderHtml:function(){var self=this,prefix=self.classPrefix;return'<div id="'+self._id+'" class="'+self.classes+'"><div id="'+self._id+'-body">'+self.encode(self.state.get("text"))+'<button role="button" tabindex="-1"><i class="'+prefix+"ico "+prefix+'i-help"></i></button></div></div>'},bindStates:function(){var self=this;return self.state.on("change:text",function(e){self.getEl("body").firstChild.data=self.encode(e.value),self.state.get("rendered")&&self.updateLayoutRect()}),self.state.on("change:help",function(e){self.classes.toggle("has-help",e.value),self.state.get("rendered")&&self.updateLayoutRect()}),self._super()}}),Label=Widget.extend({init:function(settings){var self=this;self._super(settings),self.classes.add("widget").add("label"),self.canFocus=!1,settings.multiline&&self.classes.add("autoscroll"),settings.strong&&self.classes.add("strong")},initLayoutRect:function(){var self=this,layoutRect=self._super();if(self.settings.multiline){var size=funcs.getSize(self.getEl());size.width>layoutRect.maxW&&(layoutRect.minW=layoutRect.maxW,self.classes.add("multiline")),self.getEl().style.width=layoutRect.minW+"px",layoutRect.startMinH=layoutRect.h=layoutRect.minH=Math.min(layoutRect.maxH,funcs.getSize(self.getEl()).height)}return layoutRect},repaint:function(){var self=this;return self.settings.multiline||(self.getEl().style.lineHeight=self.layoutRect().h+"px"),self._super()},severity:function(level){this.classes.remove("error"),this.classes.remove("warning"),this.classes.remove("success"),this.classes.add(level)},renderHtml:function(){var targetCtrl,forName,self=this,forId=self.settings.forId,text=self.settings.html?self.settings.html:self.encode(self.state.get("text"));return!forId&&(forName=self.settings.forName)&&(targetCtrl=self.getRoot().find("#"+forName)[0],targetCtrl&&(forId=targetCtrl._id)),forId?'<label id="'+self._id+'" class="'+self.classes+'"'+(forId?' for="'+forId+'"':"")+">"+text+"</label>":'<span id="'+self._id+'" class="'+self.classes+'">'+text+"</span>"},bindStates:function(){var self=this;return self.state.on("change:text",function(e){self.innerHtml(self.encode(e.value)),self.state.get("rendered")&&self.updateLayoutRect()}),self._super()}}),Toolbar$1=Container.extend({Defaults:{role:"toolbar",layout:"flow"},init:function(settings){var self=this;self._super(settings),self.classes.add("toolbar")},postRender:function(){var self=this;return self.items().each(function(ctrl){ctrl.classes.add("toolbar-item")}),self._super()}}),MenuBar=Toolbar$1.extend({Defaults:{role:"menubar",containerCls:"menubar",ariaRoot:!0,defaults:{type:"menubutton"}}}),MenuButton=Button.extend({init:function(settings){var self=this;self._renderOpen=!0,self._super(settings),settings=self.settings,self.classes.add("menubtn"),settings.fixedWidth&&self.classes.add("fixed-width"),self.aria("haspopup",!0),self.state.set("menu",settings.menu||self.render())},showMenu:function(toggle){var menu,self=this;return self.menu&&self.menu.visible()&&toggle!==!1?self.hideMenu():(self.menu||(menu=self.state.get("menu")||[],self.classes.add("opened"),menu.length?menu={type:"menu",animate:!0,items:menu}:(menu.type=menu.type||"menu",menu.animate=!0),menu.renderTo?self.menu=menu.parent(self).show().renderTo():self.menu=global$4.create(menu).parent(self).renderTo(),self.fire("createmenu"),self.menu.reflow(),self.menu.on("cancel",function(e){e.control.parent()===self.menu&&(e.stopPropagation(),self.focus(),self.hideMenu())}),self.menu.on("select",function(){self.focus()}),self.menu.on("show hide",function(e){e.control===self.menu&&(self.activeMenu("show"===e.type),self.classes.toggle("opened","show"===e.type)),self.aria("expanded","show"===e.type)}).fire("show")),self.menu.show(),self.menu.layoutRect({w:self.layoutRect().w}),self.menu.repaint(),self.menu.moveRel(self.getEl(),self.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"]),void self.fire("showmenu"))},hideMenu:function(){var self=this;self.menu&&(self.menu.items().each(function(item){item.hideMenu&&item.hideMenu()}),self.menu.hide())},activeMenu:function(state){this.classes.toggle("active",state)},renderHtml:function(){var image,self=this,id=self._id,prefix=self.classPrefix,icon=self.settings.icon,text=self.state.get("text"),textHtml="";return image=self.settings.image,image?(icon="none","string"!=typeof image&&(image=window.getSelection?image[0]:image[1]),image=" style=\"background-image: url('"+image+"')\""):image="",text&&(self.classes.add("btn-has-text"),textHtml='<span class="'+prefix+'txt">'+self.encode(text)+"</span>"),icon=self.settings.icon?prefix+"ico "+prefix+"i-"+icon:"",self.aria("role",self.parent()instanceof MenuBar?"menuitem":"button"),'<div id="'+id+'" class="'+self.classes+'" tabindex="-1" aria-labelledby="'+id+'"><button id="'+id+'-open" role="presentation" type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+textHtml+' <i class="'+prefix+'caret"></i></button></div>'},postRender:function(){var self=this;return self.on("click",function(e){e.control===self&&isChildOf$1(e.target,self.getEl())&&(self.focus(),self.showMenu(!e.aria),e.aria&&self.menu.items().filter(":visible")[0].focus())}),self.on("mouseenter",function(e){var hasVisibleSiblingMenu,overCtrl=e.control,parent=self.parent();overCtrl&&parent&&overCtrl instanceof MenuButton&&overCtrl.parent()===parent&&(parent.items().filter("MenuButton").each(function(ctrl){ctrl.hideMenu&&ctrl!==overCtrl&&(ctrl.menu&&ctrl.menu.visible()&&(hasVisibleSiblingMenu=!0),ctrl.hideMenu())}),hasVisibleSiblingMenu&&(overCtrl.focus(),overCtrl.showMenu()))}),self._super()},bindStates:function(){var self=this;return self.state.on("change:menu",function(){self.menu&&self.menu.remove(),self.menu=null}),self._super()},remove:function(){this._super(),this.menu&&this.menu.remove()}}),Menu=FloatPanel.extend({Defaults:{defaultType:"menuitem",border:1,layout:"stack",role:"application",bodyRole:"menu",ariaRoot:!0},init:function(settings){var self=this;if(settings.autohide=!0,settings.constrainToViewport=!0,"function"==typeof settings.items&&(settings.itemsFactory=settings.items,settings.items=[]),settings.itemDefaults)for(var items=settings.items,i=items.length;i--;)items[i]=global$2.extend({},settings.itemDefaults,items[i]);self._super(settings),self.classes.add("menu"),settings.animate&&11!==global$8.ie&&self.classes.add("animate")},repaint:function(){return this.classes.toggle("menu-align",!0),this._super(),this.getEl().style.height="",this.getEl("body").style.height="",this},cancel:function(){var self=this;self.hideAll(),self.fire("select")},load:function(){function hideThrobber(){self.throbber&&(self.throbber.hide(),self.throbber=null)}var time,factory,self=this;factory=self.settings.itemsFactory,factory&&(self.throbber||(self.throbber=new Throbber(self.getEl("body"),(!0)),0===self.items().length?(self.throbber.show(),self.fire("loading")):self.throbber.show(100,function(){self.items().remove(),self.fire("loading")}),self.on("hide close",hideThrobber)),self.requestTime=time=(new Date).getTime(),self.settings.itemsFactory(function(items){return 0===items.length?void self.hide():void(self.requestTime===time&&(self.getEl().style.width="",self.getEl("body").style.width="",hideThrobber(),self.items().remove(),self.getEl("body").innerHTML="",self.add(items),self.renderNew(),self.fire("loaded")))}))},hideAll:function(){var self=this;return this.find("menuitem").exec("hideMenu"),self._super()},preRender:function(){var self=this;return self.items().each(function(ctrl){var settings=ctrl.settings;if(settings.icon||settings.image||settings.selectable)return self._hasIcons=!0,!1}),self.settings.itemsFactory&&self.on("postrender",function(){self.settings.itemsFactory&&self.load()}),self.on("show hide",function(e){e.control===self&&("show"===e.type?global$7.setTimeout(function(){self.classes.add("in")},0):self.classes.remove("in"))}),self._super()}}),ListBox=MenuButton.extend({init:function(settings){function setSelected(menuValues){for(var i=0;i<menuValues.length;i++){if(selected=menuValues[i].selected||settings.value===menuValues[i].value)return selectedText=selectedText||menuValues[i].text,self.state.set("value",menuValues[i].value),!0;if(menuValues[i].menu&&setSelected(menuValues[i].menu))return!0}}var values,selected,selectedText,lastItemCtrl,self=this;self._super(settings),settings=self.settings,self._values=values=settings.values,values&&("undefined"!=typeof settings.value&&setSelected(values),!selected&&values.length>0&&(selectedText=values[0].text,self.state.set("value",values[0].value)),self.state.set("menu",values)),self.state.set("text",settings.text||selectedText),self.classes.add("listbox"),self.on("select",function(e){var ctrl=e.control;lastItemCtrl&&(e.lastControl=lastItemCtrl),settings.multiple?ctrl.active(!ctrl.active()):self.value(e.control.value()),lastItemCtrl=ctrl})},value:function(value){if(0===arguments.length)return this.state.get("value");if("undefined"==typeof value)return this;if(this.settings.values){var matchingValues=global$2.grep(this.settings.values,function(a){return a.value===value});matchingValues.length>0?this.state.set("value",value):null===value&&this.state.set("value",null)}else this.state.set("value",value);return this},bindStates:function(){function activateMenuItemsByValue(menu,value){menu instanceof Menu&&menu.items().each(function(ctrl){ctrl.hasMenus()||ctrl.active(ctrl.value()===value)})}function getSelectedItem(menuValues,value){var selectedItem;if(menuValues)for(var i=0;i<menuValues.length;i++){if(menuValues[i].value===value)return menuValues[i];if(menuValues[i].menu&&(selectedItem=getSelectedItem(menuValues[i].menu,value)))return selectedItem}}var self=this;return self.on("show",function(e){activateMenuItemsByValue(e.control,self.value())}),self.state.on("change:value",function(e){var selectedItem=getSelectedItem(self.state.get("menu"),e.value);selectedItem?self.text(selectedItem.text):self.text(self.settings.text)}),self._super()}}),toggleTextStyle=function(ctrl,state){var textStyle=ctrl._textStyle;if(textStyle){var textElm=ctrl.getEl("text");textElm.setAttribute("style",textStyle),state&&(textElm.style.color="",textElm.style.backgroundColor="")}},MenuItem=Widget.extend({Defaults:{border:0,role:"menuitem"},init:function(settings){var text,self=this;self._super(settings),settings=self.settings,self.classes.add("menu-item"),settings.menu&&self.classes.add("menu-item-expand"),settings.preview&&self.classes.add("menu-item-preview"),text=self.state.get("text"),"-"!==text&&"|"!==text||(self.classes.add("menu-item-sep"),self.aria("role","separator"),self.state.set("text","-")),settings.selectable&&(self.aria("role","menuitemcheckbox"),self.classes.add("menu-item-checkbox"),settings.icon="selected"),settings.preview||settings.selectable||self.classes.add("menu-item-normal"),self.on("mousedown",function(e){e.preventDefault()}),settings.menu&&!settings.ariaHideMenu&&self.aria("haspopup",!0)},hasMenus:function(){return!!this.settings.menu},showMenu:function(){var menu,self=this,settings=self.settings,parent=self.parent();if(parent.items().each(function(ctrl){ctrl!==self&&ctrl.hideMenu()}),settings.menu){menu=self.menu,menu?menu.show():(menu=settings.menu,menu.length?menu={type:"menu",items:menu}:menu.type=menu.type||"menu",parent.settings.itemDefaults&&(menu.itemDefaults=parent.settings.itemDefaults),menu=self.menu=global$4.create(menu).parent(self).renderTo(),menu.reflow(),menu.on("cancel",function(e){e.stopPropagation(),self.focus(),menu.hide()}),menu.on("show hide",function(e){e.control.items&&e.control.items().each(function(ctrl){ctrl.active(ctrl.settings.selected)})}).fire("show"),menu.on("hide",function(e){e.control===menu&&self.classes.remove("selected")}),menu.submenu=!0),menu._parentMenu=parent,menu.classes.add("menu-sub");var rel=menu.testMoveRel(self.getEl(),self.isRtl()?["tl-tr","bl-br","tr-tl","br-bl"]:["tr-tl","br-bl","tl-tr","bl-br"]);menu.moveRel(self.getEl(),rel),menu.rel=rel,rel="menu-sub-"+rel,menu.classes.remove(menu._lastRel).add(rel),menu._lastRel=rel,self.classes.add("selected"),self.aria("expanded",!0)}},hideMenu:function(){var self=this;return self.menu&&(self.menu.items().each(function(item){item.hideMenu&&item.hideMenu()}),self.menu.hide(),self.aria("expanded",!1)),self},renderHtml:function(){function convertShortcut(shortcut){var i,value,replace={};for(replace=global$8.mac?{alt:"&#x2325;",ctrl:"&#x2318;",shift:"&#x21E7;",meta:"&#x2318;"}:{meta:"Ctrl"},shortcut=shortcut.split("+"),i=0;i<shortcut.length;i++)value=replace[shortcut[i].toLowerCase()],value&&(shortcut[i]=value);return shortcut.join("+")}function escapeRegExp(str){return str.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function markMatches(text){var match=settings.match||"";return match?text.replace(new RegExp(escapeRegExp(match),"gi"),function(match){return"!mce~match["+match+"]mce~match!"}):text}function boldMatches(text){return text.replace(new RegExp(escapeRegExp("!mce~match["),"g"),"<b>").replace(new RegExp(escapeRegExp("]mce~match!"),"g"),"</b>")}var self=this,id=self._id,settings=self.settings,prefix=self.classPrefix,text=self.state.get("text"),icon=self.settings.icon,image="",shortcut=settings.shortcut,url=self.encode(settings.url),iconHtml="";return icon&&self.parent().classes.add("menu-has-icons"),settings.image&&(image=" style=\"background-image: url('"+settings.image+"')\""),shortcut&&(shortcut=convertShortcut(shortcut)),icon=prefix+"ico "+prefix+"i-"+(self.settings.icon||"none"),iconHtml="-"!==text?'<i class="'+icon+'"'+image+"></i> ":"",text=boldMatches(self.encode(markMatches(text))),url=boldMatches(self.encode(markMatches(url))),'<div id="'+id+'" class="'+self.classes+'" tabindex="-1">'+iconHtml+("-"!==text?'<span id="'+id+'-text" class="'+prefix+'text">'+text+"</span>":"")+(shortcut?'<div id="'+id+'-shortcut" class="'+prefix+'menu-shortcut">'+shortcut+"</div>":"")+(settings.menu?'<div class="'+prefix+'caret"></div>':"")+(url?'<div class="'+prefix+'menu-item-link">'+url+"</div>":"")+"</div>"},postRender:function(){var self=this,settings=self.settings,textStyle=settings.textStyle;if("function"==typeof textStyle&&(textStyle=textStyle.call(this)),textStyle){var textElm=self.getEl("text");textElm&&(textElm.setAttribute("style",textStyle),self._textStyle=textStyle)}return self.on("mouseenter click",function(e){e.control===self&&(settings.menu||"click"!==e.type?(self.showMenu(),e.aria&&self.menu.focus(!0)):(self.fire("select"),global$7.requestAnimationFrame(function(){self.parent().hideAll()})))}),self._super(),self},hover:function(){var self=this;return self.parent().items().each(function(ctrl){ctrl.classes.remove("selected")}),self.classes.toggle("selected",!0),self},active:function(state){return toggleTextStyle(this,state),"undefined"!=typeof state&&this.aria("checked",state),this._super(state)},remove:function(){this._super(),this.menu&&this.menu.remove()}}),Radio=Checkbox.extend({Defaults:{classes:"radio",role:"radio"}}),ResizeHandle=Widget.extend({renderHtml:function(){var self=this,prefix=self.classPrefix;return self.classes.add("resizehandle"),"both"===self.settings.direction&&self.classes.add("resizehandle-both"),self.canFocus=!1,'<div id="'+self._id+'" class="'+self.classes+'"><i class="'+prefix+"ico "+prefix+'i-resize"></i></div>'},postRender:function(){var self=this;self._super(),self.resizeDragHelper=new DragHelper(this._id,{start:function(){self.fire("ResizeStart")},drag:function(e){"both"!==self.settings.direction&&(e.deltaX=0),self.fire("Resize",e)},stop:function(){self.fire("ResizeEnd")}})},remove:function(){return this.resizeDragHelper&&this.resizeDragHelper.destroy(),this._super()}}),SelectBox=Widget.extend({Defaults:{classes:"selectbox",role:"selectbox",options:[]},init:function(settings){var self=this;self._super(settings),self.settings.size&&(self.size=self.settings.size),self.settings.options&&(self._options=self.settings.options),self.on("keydown",function(e){var rootControl;13===e.keyCode&&(e.preventDefault(),self.parents().reverse().each(function(ctrl){if(ctrl.toJSON)return rootControl=ctrl,!1}),self.fire("submit",{data:rootControl.toJSON()}))})},options:function(state){return arguments.length?(this.state.set("options",state),this):this.state.get("options")},renderHtml:function(){var options,self=this,size="";return options=createOptions(self._options),self.size&&(size=' size = "'+self.size+'"'),'<select id="'+self._id+'" class="'+self.classes+'"'+size+">"+options+"</select>"},bindStates:function(){var self=this;return self.state.on("change:options",function(e){self.getEl().innerHTML=createOptions(e.value)}),self._super()}}),Slider=Widget.extend({init:function(settings){var self=this;settings.previewFilter||(settings.previewFilter=function(value){return Math.round(100*value)/100}),self._super(settings),self.classes.add("slider"),"v"===settings.orientation&&self.classes.add("vertical"),self._minValue=$_d8bie3tijh8lz3kn.isNumber(settings.minValue)?settings.minValue:0,self._maxValue=$_d8bie3tijh8lz3kn.isNumber(settings.maxValue)?settings.maxValue:100,self._initValue=self.state.get("value")},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix;return'<div id="'+id+'" class="'+self.classes+'"><div id="'+id+'-handle" class="'+prefix+'slider-handle" role="slider" tabindex="-1"></div></div>'},reset:function(){this.value(this._initValue).repaint()},postRender:function(){function toFraction(min,max,val){return(val+min)/(max-min)}function fromFraction(min,max,val){return val*(max-min)-min}function handleKeyboard(minValue,maxValue){function alter(delta){var value;value=self.value(),value=fromFraction(minValue,maxValue,toFraction(minValue,maxValue,value)+.05*delta),value=constrain(value,minValue,maxValue),self.value(value),self.fire("dragstart",{value:value}),self.fire("drag",{value:value}),self.fire("dragend",{value:value})}self.on("keydown",function(e){switch(e.keyCode){case 37:case 38:alter(-1);break;case 39:case 40:alter(1)}})}function handleDrag(minValue,maxValue,handleEl){var startPos,startHandlePos,maxHandlePos,handlePos,value;self._dragHelper=new DragHelper(self._id,{handle:self._id+"-handle",start:function(e){startPos=e[screenCordName],startHandlePos=parseInt(self.getEl("handle").style[stylePosName],10),maxHandlePos=(self.layoutRect()[shortSizeName]||100)-funcs.getSize(handleEl)[sizeName],self.fire("dragstart",{value:value})},drag:function(e){var delta=e[screenCordName]-startPos;handlePos=constrain(startHandlePos+delta,0,maxHandlePos),handleEl.style[stylePosName]=handlePos+"px",value=minValue+handlePos/maxHandlePos*(maxValue-minValue),self.value(value),self.tooltip().text(""+self.settings.previewFilter(value)).show().moveRel(handleEl,"bc tc"),self.fire("drag",{value:value})},stop:function(){self.tooltip().hide(),self.fire("dragend",{value:value})}})}var minValue,maxValue,screenCordName,stylePosName,sizeName,shortSizeName,self=this;minValue=self._minValue,maxValue=self._maxValue,"v"===self.settings.orientation?(screenCordName="screenY",stylePosName="top",sizeName="height",shortSizeName="h"):(screenCordName="screenX",stylePosName="left",sizeName="width",shortSizeName="w"),self._super(),handleKeyboard(minValue,maxValue),handleDrag(minValue,maxValue,self.getEl("handle"))},repaint:function(){this._super(),updateSliderHandle(this,this.value())},bindStates:function(){var self=this;return self.state.on("change:value",function(e){updateSliderHandle(self,e.value)}),self._super()}}),Spacer=Widget.extend({renderHtml:function(){var self=this;return self.classes.add("spacer"),self.canFocus=!1,'<div id="'+self._id+'" class="'+self.classes+'"></div>'}}),SplitButton=MenuButton.extend({Defaults:{classes:"widget btn splitbtn",role:"button"},repaint:function(){var mainButtonElm,menuButtonElm,self=this,elm=self.getEl(),rect=self.layoutRect();return self._super(),mainButtonElm=elm.firstChild,menuButtonElm=elm.lastChild,global$9(mainButtonElm).css({width:rect.w-funcs.getSize(menuButtonElm).width,height:rect.h-2}),global$9(menuButtonElm).css({height:rect.h-2}),self},activeMenu:function(state){var self=this;global$9(self.getEl().lastChild).toggleClass(self.classPrefix+"active",state)},renderHtml:function(){var image,ariaPressed,self=this,id=self._id,prefix=self.classPrefix,icon=self.state.get("icon"),text=self.state.get("text"),settings=self.settings,textHtml="";return image=settings.image,image?(icon="none","string"!=typeof image&&(image=window.getSelection?image[0]:image[1]),image=" style=\"background-image: url('"+image+"')\""):image="",icon=settings.icon?prefix+"ico "+prefix+"i-"+icon:"",text&&(self.classes.add("btn-has-text"),textHtml='<span class="'+prefix+'txt">'+self.encode(text)+"</span>"),ariaPressed="boolean"==typeof settings.active?' aria-pressed="'+settings.active+'"':"",
'<div id="'+id+'" class="'+self.classes+'" role="button"'+ariaPressed+' tabindex="-1"><button type="button" hidefocus="1" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+textHtml+'</button><button type="button" class="'+prefix+'open" hidefocus="1" tabindex="-1">'+(self._menuBtnText?(icon?" ":"")+self._menuBtnText:"")+' <i class="'+prefix+'caret"></i></button></div>'},postRender:function(){var self=this,onClickHandler=self.settings.onclick;return self.on("click",function(e){var node=e.target;if(e.control===this)for(;node;){if(e.aria&&"down"!==e.aria.key||"BUTTON"===node.nodeName&&node.className.indexOf("open")===-1)return e.stopImmediatePropagation(),void(onClickHandler&&onClickHandler.call(this,e));node=node.parentNode}}),delete self.settings.onclick,self._super()}}),StackLayout=FlowLayout.extend({Defaults:{containerClass:"stack-layout",controlClass:"stack-layout-item",endClass:"break"},isNative:function(){return!0}}),TabPanel=Panel.extend({Defaults:{layout:"absolute",defaults:{type:"panel"}},activateTab:function(idx){var activeTabElm;this.activeTabId&&(activeTabElm=this.getEl(this.activeTabId),global$9(activeTabElm).removeClass(this.classPrefix+"active"),activeTabElm.setAttribute("aria-selected","false")),this.activeTabId="t"+idx,activeTabElm=this.getEl("t"+idx),activeTabElm.setAttribute("aria-selected","true"),global$9(activeTabElm).addClass(this.classPrefix+"active"),this.items()[idx].show().fire("showtab"),this.reflow(),this.items().each(function(item,i){idx!==i&&item.hide()})},renderHtml:function(){var self=this,layout=self._layout,tabsHtml="",prefix=self.classPrefix;return self.preRender(),layout.preRender(self),self.items().each(function(ctrl,i){var id=self._id+"-t"+i;ctrl.aria("role","tabpanel"),ctrl.aria("labelledby",id),tabsHtml+='<div id="'+id+'" class="'+prefix+'tab" unselectable="on" role="tab" aria-controls="'+ctrl._id+'" aria-selected="false" tabIndex="-1">'+self.encode(ctrl.settings.title)+"</div>"}),'<div id="'+self._id+'" class="'+self.classes+'" hidefocus="1" tabindex="-1"><div id="'+self._id+'-head" class="'+prefix+'tabs" role="tablist">'+tabsHtml+'</div><div id="'+self._id+'-body" class="'+self.bodyClasses+'">'+layout.renderHtml(self)+"</div></div>"},postRender:function(){var self=this;self._super(),self.settings.activeTab=self.settings.activeTab||0,self.activateTab(self.settings.activeTab),this.on("click",function(e){var targetParent=e.target.parentNode;if(targetParent&&targetParent.id===self._id+"-head")for(var i=targetParent.childNodes.length;i--;)targetParent.childNodes[i]===e.target&&self.activateTab(i)})},initLayoutRect:function(){var rect,minW,minH,self=this;minW=funcs.getSize(self.getEl("head")).width,minW=minW<0?0:minW,minH=0,self.items().each(function(item){minW=Math.max(minW,item.layoutRect().minW),minH=Math.max(minH,item.layoutRect().minH)}),self.items().each(function(ctrl){ctrl.settings.x=0,ctrl.settings.y=0,ctrl.settings.w=minW,ctrl.settings.h=minH,ctrl.layoutRect({x:0,y:0,w:minW,h:minH})});var headH=funcs.getSize(self.getEl("head")).height;return self.settings.minWidth=minW,self.settings.minHeight=minH+headH,rect=self._super(),rect.deltaH+=headH,rect.innerH=rect.h-rect.deltaH,rect}}),TextBox=Widget.extend({init:function(settings){var self=this;self._super(settings),self.classes.add("textbox"),settings.multiline?self.classes.add("multiline"):(self.on("keydown",function(e){var rootControl;13===e.keyCode&&(e.preventDefault(),self.parents().reverse().each(function(ctrl){if(ctrl.toJSON)return rootControl=ctrl,!1}),self.fire("submit",{data:rootControl.toJSON()}))}),self.on("keyup",function(e){self.state.set("value",e.target.value)}))},repaint:function(){var style,rect,borderBox,borderW,lastRepaintRect,self=this,borderH=0;style=self.getEl().style,rect=self._layoutRect,lastRepaintRect=self._lastRepaintRect||{};var doc=document;return!self.settings.multiline&&doc.all&&(!doc.documentMode||doc.documentMode<=8)&&(style.lineHeight=rect.h-borderH+"px"),borderBox=self.borderBox,borderW=borderBox.left+borderBox.right+8,borderH=borderBox.top+borderBox.bottom+(self.settings.multiline?8:0),rect.x!==lastRepaintRect.x&&(style.left=rect.x+"px",lastRepaintRect.x=rect.x),rect.y!==lastRepaintRect.y&&(style.top=rect.y+"px",lastRepaintRect.y=rect.y),rect.w!==lastRepaintRect.w&&(style.width=rect.w-borderW+"px",lastRepaintRect.w=rect.w),rect.h!==lastRepaintRect.h&&(style.height=rect.h-borderH+"px",lastRepaintRect.h=rect.h),self._lastRepaintRect=lastRepaintRect,self.fire("repaint",{},!1),self},renderHtml:function(){var attrs,elm,self=this,settings=self.settings;return attrs={id:self._id,hidefocus:"1"},global$2.each(["rows","spellcheck","maxLength","size","readonly","min","max","step","list","pattern","placeholder","required","multiple"],function(name){attrs[name]=settings[name]}),self.disabled()&&(attrs.disabled="disabled"),settings.subtype&&(attrs.type=settings.subtype),elm=funcs.create(settings.multiline?"textarea":"input",attrs),elm.value=self.state.get("value"),elm.className=self.classes.toString(),elm.outerHTML},value:function(value){return arguments.length?(this.state.set("value",value),this):(this.state.get("rendered")&&this.state.set("value",this.getEl().value),this.state.get("value"))},postRender:function(){var self=this;self.getEl().value=self.state.get("value"),self._super(),self.$el.on("change",function(e){self.state.set("value",e.target.value),self.fire("change",e)})},bindStates:function(){var self=this;return self.state.on("change:value",function(e){self.getEl().value!==e.value&&(self.getEl().value=e.value)}),self.state.on("change:disabled",function(e){self.getEl().disabled=e.value}),self._super()},remove:function(){this.$el.off(),this._super()}}),getApi=function(){return{Selector:Selector,Collection:Collection$2,ReflowQueue:$_ef12j5u4jh8lz3nl,Control:Control$1,Factory:global$4,KeyboardNavigation:KeyboardNavigation,Container:Container,DragHelper:DragHelper,Scrollable:$_4acv48u6jh8lz3ns,Panel:Panel,Movable:$_d97gfctrjh8lz3lm,Resizable:$_8a2gtru8jh8lz3ny,FloatPanel:FloatPanel,Window:Window,MessageBox:MessageBox,Tooltip:Tooltip,Widget:Widget,Progress:Progress,Notification:Notification,Layout:Layout,AbsoluteLayout:AbsoluteLayout,Button:Button,ButtonGroup:ButtonGroup,Checkbox:Checkbox,ComboBox:ComboBox,ColorBox:ColorBox,PanelButton:PanelButton,ColorButton:ColorButton,ColorPicker:ColorPicker,Path:Path,ElementPath:ElementPath,FormItem:FormItem,Form:Form,FieldSet:FieldSet,FilePicker:FilePicker,FitLayout:FitLayout,FlexLayout:FlexLayout,FlowLayout:FlowLayout,FormatControls:$_4qdht3w4jh8lz3uo,GridLayout:GridLayout,Iframe:Iframe$1,InfoBox:InfoBox,Label:Label,Toolbar:Toolbar$1,MenuBar:MenuBar,MenuButton:MenuButton,MenuItem:MenuItem,Throbber:Throbber,Menu:Menu,ListBox:ListBox,Radio:Radio,ResizeHandle:ResizeHandle,SelectBox:SelectBox,Slider:Slider,Spacer:Spacer,SplitButton:SplitButton,StackLayout:StackLayout,TabPanel:TabPanel,TextBox:TextBox,DropZone:DropZone,BrowseButton:BrowseButton}},appendTo=function(target){target.ui?global$2.each(getApi(),function(ref,key){target.ui[key]=ref}):target.ui=getApi()},registerToFactory=function(){global$2.each(getApi(),function(ref,key){global$4.add(key,ref)})},Api={appendTo:appendTo,registerToFactory:registerToFactory};return Api.registerToFactory(),Api.appendTo(window.tinymce?window.tinymce:{}),global.add("modern",function(editor){return $_4qdht3w4jh8lz3uo.setup(editor),$_1os0v5syjh8lz3j9.get(editor)}),Theme})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-advlist",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),applyListFormat=function(editor,listName,styleValue){var cmd="UL"===listName?"InsertUnorderedList":"InsertOrderedList";editor.execCommand(cmd,!1,styleValue===!1?null:{"list-style-type":styleValue})},$_2r1x1182jh8lyzqs={applyListFormat:applyListFormat},register=function(editor){editor.addCommand("ApplyUnorderedListStyle",function(ui,value){$_2r1x1182jh8lyzqs.applyListFormat(editor,"UL",value["list-style-type"])}),editor.addCommand("ApplyOrderedListStyle",function(ui,value){$_2r1x1182jh8lyzqs.applyListFormat(editor,"OL",value["list-style-type"])})},$_hdktl81jh8lyzqr={register:register},getNumberStyles=function(editor){var styles=editor.getParam("advlist_number_styles","default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman");return styles?styles.split(/[ ,]/):[]},getBulletStyles=function(editor){var styles=editor.getParam("advlist_bullet_styles","default,circle,disc,square");return styles?styles.split(/[ ,]/):[]},$_3fjj2e84jh8lyzqy={getNumberStyles:getNumberStyles,getBulletStyles:getBulletStyles},isChildOfBody=function(editor,elm){return editor.$.contains(editor.getBody(),elm)},isTableCellNode=function(node){return node&&/^(TH|TD)$/.test(node.nodeName)},isListNode=function(editor){return function(node){return node&&/^(OL|UL|DL)$/.test(node.nodeName)&&isChildOfBody(editor,node)}},getSelectedStyleType=function(editor){var listElm=editor.dom.getParent(editor.selection.getNode(),"ol,ul");return editor.dom.getStyle(listElm,"listStyleType")||""},$_9sbytx85jh8lyzqz={isTableCellNode:isTableCellNode,isListNode:isListNode,getSelectedStyleType:getSelectedStyleType},styleValueToText=function(styleValue){return styleValue.replace(/\-/g," ").replace(/\b\w/g,function(chr){return chr.toUpperCase()})},toMenuItems=function(styles){return global$1.map(styles,function(styleValue){var text=styleValueToText(styleValue),data="default"===styleValue?"":styleValue;return{text:text,data:data}})},$_7vq0jr86jh8lyzr1={toMenuItems:toMenuItems},findIndex=function(list,predicate){for(var index=0;index<list.length;index++){var element=list[index];if(predicate(element))return index}return-1},listState=function(editor,listName){return function(e){var ctrl=e.control;editor.on("NodeChange",function(e){var tableCellIndex=findIndex(e.parents,$_9sbytx85jh8lyzqz.isTableCellNode),parents=tableCellIndex!==-1?e.parents.slice(0,tableCellIndex):e.parents,lists=global$1.grep(parents,$_9sbytx85jh8lyzqz.isListNode(editor));ctrl.active(lists.length>0&&lists[0].nodeName===listName)})}},updateSelection=function(editor){return function(e){var listStyleType=$_9sbytx85jh8lyzqz.getSelectedStyleType(editor);e.control.items().each(function(ctrl){ctrl.active(ctrl.settings.data===listStyleType)})}},addSplitButton=function(editor,id,tooltip,cmd,nodeName,styles){editor.addButton(id,{active:!1,type:"splitbutton",tooltip:tooltip,menu:$_7vq0jr86jh8lyzr1.toMenuItems(styles),onPostRender:listState(editor,nodeName),onshow:updateSelection(editor),onselect:function(e){$_2r1x1182jh8lyzqs.applyListFormat(editor,nodeName,e.control.settings.data)},onclick:function(){editor.execCommand(cmd)}})},addButton=function(editor,id,tooltip,cmd,nodeName,styles){editor.addButton(id,{active:!1,type:"button",tooltip:tooltip,onPostRender:listState(editor,nodeName),onclick:function(){editor.execCommand(cmd)}})},addControl=function(editor,id,tooltip,cmd,nodeName,styles){styles.length>0?addSplitButton(editor,id,tooltip,cmd,nodeName,styles):addButton(editor,id,tooltip,cmd,nodeName,styles)},register$1=function(editor){addControl(editor,"numlist","Numbered list","InsertOrderedList","OL",$_3fjj2e84jh8lyzqy.getNumberStyles(editor)),addControl(editor,"bullist","Bullet list","InsertUnorderedList","UL",$_3fjj2e84jh8lyzqy.getBulletStyles(editor))},$_6bc80w83jh8lyzqu={register:register$1};return global.add("advlist",function(editor){var hasPlugin=function(editor,plugin){var plugins=editor.settings.plugins?editor.settings.plugins:"";return global$1.inArray(plugins.split(/[ ,]/),plugin)!==-1};hasPlugin(editor,"lists")&&($_6bc80w83jh8lyzqu.register(editor),$_hdktl81jh8lyzqr.register(editor))}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-anchor",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),isValidId=function(id){return/^[A-Za-z][A-Za-z0-9\-:._]*$/.test(id)},getId=function(editor){var selectedNode=editor.selection.getNode(),isAnchor="A"===selectedNode.tagName&&""===editor.dom.getAttrib(selectedNode,"href");return isAnchor?selectedNode.id||selectedNode.name:""},insert=function(editor,id){var selectedNode=editor.selection.getNode(),isAnchor="A"===selectedNode.tagName&&""===editor.dom.getAttrib(selectedNode,"href");isAnchor?(selectedNode.removeAttribute("name"),selectedNode.id=id,editor.undoManager.add()):(editor.focus(),editor.selection.collapse(!0),editor.execCommand("mceInsertContent",!1,editor.dom.createHTML("a",{id:id})))},$_3nbb0e8bjh8lyzrn={isValidId:isValidId,getId:getId,insert:insert},insertAnchor=function(editor,newId){return $_3nbb0e8bjh8lyzrn.isValidId(newId)?($_3nbb0e8bjh8lyzrn.insert(editor,newId),!1):(editor.windowManager.alert("Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores."),!0)},open=function(editor){var currentId=$_3nbb0e8bjh8lyzrn.getId(editor);editor.windowManager.open({title:"Anchor",body:{type:"textbox",name:"id",size:40,label:"Id",value:currentId},onsubmit:function(e){var newId=e.data.id;insertAnchor(editor,newId)&&e.preventDefault()}})},$_8ripo48ajh8lyzrl={open:open},register=function(editor){editor.addCommand("mceAnchor",function(){$_8ripo48ajh8lyzrl.open(editor)})},$_8icszx89jh8lyzrk={register:register},isAnchorNode=function(node){return!node.attr("href")&&(node.attr("id")||node.attr("name"))&&!node.firstChild},setContentEditable=function(state){return function(nodes){for(var i=0;i<nodes.length;i++)isAnchorNode(nodes[i])&&nodes[i].attr("contenteditable",state)}},setup=function(editor){editor.on("PreInit",function(){editor.parser.addNodeFilter("a",setContentEditable("false")),editor.serializer.addNodeFilter("a",setContentEditable(null))})},$_a3426h8cjh8lyzro={setup:setup},register$1=function(editor){editor.addButton("anchor",{icon:"anchor",tooltip:"Anchor",cmd:"mceAnchor",stateSelector:"a:not([href])"}),editor.addMenuItem("anchor",{icon:"anchor",text:"Anchor",context:"insert",cmd:"mceAnchor"})},$_afgepy8djh8lyzrq={register:register$1};return global.add("anchor",function(editor){$_a3426h8cjh8lyzro.setup(editor),$_8icszx89jh8lyzrk.register(editor),$_afgepy8djh8lyzrq.register(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-autolink",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.Env"),getAutoLinkPattern=function(editor){return editor.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i)},getDefaultLinkTarget=function(editor){return editor.getParam("default_link_target","")},$_2pqfkt8ijh8lyzs9={getAutoLinkPattern:getAutoLinkPattern,getDefaultLinkTarget:getDefaultLinkTarget},rangeEqualsDelimiterOrSpace=function(rangeString,delimiter){return rangeString===delimiter||" "===rangeString||160===rangeString.charCodeAt(0)},handleEclipse=function(editor){parseCurrentLine(editor,-1,"(")},handleSpacebar=function(editor){parseCurrentLine(editor,0,"")},handleEnter=function(editor){parseCurrentLine(editor,-1,"")},scopeIndex=function(container,index){if(index<0&&(index=0),3===container.nodeType){var len=container.data.length;index>len&&(index=len)}return index},setStart=function(rng,container,offset){1!==container.nodeType||container.hasChildNodes()?rng.setStart(container,scopeIndex(container,offset)):rng.setStartBefore(container)},setEnd=function(rng,container,offset){1!==container.nodeType||container.hasChildNodes()?rng.setEnd(container,scopeIndex(container,offset)):rng.setEndAfter(container)},parseCurrentLine=function(editor,endOffset,delimiter){var rng,end,start,endContainer,bookmark,text,matches,prev,len,rngText,autoLinkPattern=$_2pqfkt8ijh8lyzs9.getAutoLinkPattern(editor),defaultLinkTarget=$_2pqfkt8ijh8lyzs9.getDefaultLinkTarget(editor);if("A"!==editor.selection.getNode().tagName){if(rng=editor.selection.getRng(!0).cloneRange(),rng.startOffset<5){if(prev=rng.endContainer.previousSibling,!prev){if(!rng.endContainer.firstChild||!rng.endContainer.firstChild.nextSibling)return;prev=rng.endContainer.firstChild.nextSibling}if(len=prev.length,setStart(rng,prev,len),setEnd(rng,prev,len),rng.endOffset<5)return;end=rng.endOffset,endContainer=prev}else{if(endContainer=rng.endContainer,3!==endContainer.nodeType&&endContainer.firstChild){for(;3!==endContainer.nodeType&&endContainer.firstChild;)endContainer=endContainer.firstChild;3===endContainer.nodeType&&(setStart(rng,endContainer,0),setEnd(rng,endContainer,endContainer.nodeValue.length))}end=1===rng.endOffset?2:rng.endOffset-1-endOffset}start=end;do setStart(rng,endContainer,end>=2?end-2:0),setEnd(rng,endContainer,end>=1?end-1:0),end-=1,rngText=rng.toString();while(" "!==rngText&&""!==rngText&&160!==rngText.charCodeAt(0)&&end-2>=0&&rngText!==delimiter);rangeEqualsDelimiterOrSpace(rng.toString(),delimiter)?(setStart(rng,endContainer,end),setEnd(rng,endContainer,start),end+=1):0===rng.startOffset?(setStart(rng,endContainer,0),setEnd(rng,endContainer,start)):(setStart(rng,endContainer,end),setEnd(rng,endContainer,start)),text=rng.toString(),"."===text.charAt(text.length-1)&&setEnd(rng,endContainer,start-1),text=rng.toString().trim(),matches=text.match(autoLinkPattern),matches&&("www."===matches[1]?matches[1]="http://www.":/@$/.test(matches[1])&&!/^mailto:/.test(matches[1])&&(matches[1]="mailto:"+matches[1]),bookmark=editor.selection.getBookmark(),editor.selection.setRng(rng),editor.execCommand("createlink",!1,matches[1]+matches[2]),defaultLinkTarget&&editor.dom.setAttrib(editor.selection.getNode(),"target",defaultLinkTarget),editor.selection.moveToBookmark(bookmark),editor.nodeChanged())}},setup=function(editor){var autoUrlDetectState;return editor.on("keydown",function(e){if(13===e.keyCode)return handleEnter(editor)}),global$1.ie?void editor.on("focus",function(){if(!autoUrlDetectState){autoUrlDetectState=!0;try{editor.execCommand("AutoUrlDetect",!1,!0)}catch(ex){}}}):(editor.on("keypress",function(e){if(41===e.keyCode)return handleEclipse(editor)}),void editor.on("keyup",function(e){if(32===e.keyCode)return handleSpacebar(editor)}))},$_3xb5x88gjh8lyzs3={setup:setup};return global.add("autolink",function(editor){$_3xb5x88gjh8lyzs3.setup(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-autoresize",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.Env"),global$2=tinymce.util.Tools.resolve("tinymce.util.Delay"),getAutoResizeMinHeight=function(editor){return parseInt(editor.getParam("autoresize_min_height",editor.getElement().offsetHeight),10)},getAutoResizeMaxHeight=function(editor){return parseInt(editor.getParam("autoresize_max_height",0),10)},getAutoResizeOverflowPadding=function(editor){return editor.getParam("autoresize_overflow_padding",1)},getAutoResizeBottomMargin=function(editor){return editor.getParam("autoresize_bottom_margin",50)},shouldAutoResizeOnInit=function(editor){return editor.getParam("autoresize_on_init",!0)},$_gg12688qjh8lyzsz={getAutoResizeMinHeight:getAutoResizeMinHeight,getAutoResizeMaxHeight:getAutoResizeMaxHeight,getAutoResizeOverflowPadding:getAutoResizeOverflowPadding,getAutoResizeBottomMargin:getAutoResizeBottomMargin,shouldAutoResizeOnInit:shouldAutoResizeOnInit},isFullscreen=function(editor){return editor.plugins.fullscreen&&editor.plugins.fullscreen.isFullscreen()},wait=function(editor,oldSize,times,interval,callback){global$2.setEditorTimeout(editor,function(){resize(editor,oldSize),times--?wait(editor,oldSize,times,interval,callback):callback&&callback()},interval)},toggleScrolling=function(editor,state){var body=editor.getBody();body&&(body.style.overflowY=state?"":"hidden",state||(body.scrollTop=0))},resize=function(editor,oldSize){var deltaSize,doc,body,resizeHeight,myHeight,marginTop,marginBottom,paddingTop,paddingBottom,borderTop,borderBottom,dom=editor.dom;if(doc=editor.getDoc()){if(isFullscreen(editor))return void toggleScrolling(editor,!0);body=doc.body,resizeHeight=$_gg12688qjh8lyzsz.getAutoResizeMinHeight(editor),marginTop=dom.getStyle(body,"margin-top",!0),marginBottom=dom.getStyle(body,"margin-bottom",!0),paddingTop=dom.getStyle(body,"padding-top",!0),paddingBottom=dom.getStyle(body,"padding-bottom",!0),borderTop=dom.getStyle(body,"border-top-width",!0),borderBottom=dom.getStyle(body,"border-bottom-width",!0),myHeight=body.offsetHeight+parseInt(marginTop,10)+parseInt(marginBottom,10)+parseInt(paddingTop,10)+parseInt(paddingBottom,10)+parseInt(borderTop,10)+parseInt(borderBottom,10),(isNaN(myHeight)||myHeight<=0)&&(myHeight=global$1.ie?body.scrollHeight:global$1.webkit&&0===body.clientHeight?0:body.offsetHeight),myHeight>$_gg12688qjh8lyzsz.getAutoResizeMinHeight(editor)&&(resizeHeight=myHeight);var maxHeight=$_gg12688qjh8lyzsz.getAutoResizeMaxHeight(editor);maxHeight&&myHeight>maxHeight?(resizeHeight=maxHeight,toggleScrolling(editor,!0)):toggleScrolling(editor,!1),resizeHeight!==oldSize.get()&&(deltaSize=resizeHeight-oldSize.get(),dom.setStyle(editor.iframeElement,"height",resizeHeight+"px"),oldSize.set(resizeHeight),global$1.webkit&&deltaSize<0&&resize(editor,oldSize))}},setup=function(editor,oldSize){editor.on("init",function(){var overflowPadding,bottomMargin,dom=editor.dom;overflowPadding=$_gg12688qjh8lyzsz.getAutoResizeOverflowPadding(editor),bottomMargin=$_gg12688qjh8lyzsz.getAutoResizeBottomMargin(editor),overflowPadding!==!1&&dom.setStyles(editor.getBody(),{paddingLeft:overflowPadding,paddingRight:overflowPadding}),bottomMargin!==!1&&dom.setStyles(editor.getBody(),{paddingBottom:bottomMargin})}),editor.on("nodechange setcontent keyup FullscreenStateChanged",function(e){resize(editor,oldSize)}),$_gg12688qjh8lyzsz.shouldAutoResizeOnInit(editor)&&editor.on("init",function(){wait(editor,oldSize,20,100,function(){wait(editor,oldSize,5,1e3)})})},$_6ewswv8njh8lyzsu={setup:setup,resize:resize},register=function(editor,oldSize){editor.addCommand("mceAutoResize",function(){$_6ewswv8njh8lyzsu.resize(editor,oldSize)})},$_a778x48mjh8lyzss={register:register};return global.add("autoresize",function(editor){if(!editor.inline){var oldSize=Cell(0);$_a778x48mjh8lyzss.register(editor,oldSize),$_6ewswv8njh8lyzsu.setup(editor,oldSize)}}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-autosave",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),global$2=tinymce.util.Tools.resolve("tinymce.util.Tools"),fireRestoreDraft=function(editor){return editor.fire("RestoreDraft")},fireStoreDraft=function(editor){return editor.fire("StoreDraft")},fireRemoveDraft=function(editor){return editor.fire("RemoveDraft")},$_4ncezg8yjh8lyzts={fireRestoreDraft:fireRestoreDraft,fireStoreDraft:fireStoreDraft,fireRemoveDraft:fireRemoveDraft},parse=function(time,defaultTime){var multiples={s:1e3,m:6e4};return time=/^(\d+)([ms]?)$/.exec(""+(time||defaultTime)),(time[2]?multiples[time[2]]:1)*parseInt(time,10)},$_cmmlud90jh8lyztv={parse:parse},shouldAskBeforeUnload=function(editor){return editor.getParam("autosave_ask_before_unload",!0)},getAutoSavePrefix=function(editor){var prefix=editor.getParam("autosave_prefix","tinymce-autosave-{path}{query}{hash}-{id}-");return prefix=prefix.replace(/\{path\}/g,document.location.pathname),prefix=prefix.replace(/\{query\}/g,document.location.search),prefix=prefix.replace(/\{hash\}/g,document.location.hash),prefix=prefix.replace(/\{id\}/g,editor.id)},shouldRestoreWhenEmpty=function(editor){return editor.getParam("autosave_restore_when_empty",!1)},getAutoSaveInterval=function(editor){return $_cmmlud90jh8lyztv.parse(editor.settings.autosave_interval,"30s")},getAutoSaveRetention=function(editor){return $_cmmlud90jh8lyztv.parse(editor.settings.autosave_retention,"20m")},$_55sjs08zjh8lyztt={shouldAskBeforeUnload:shouldAskBeforeUnload,getAutoSavePrefix:getAutoSavePrefix,shouldRestoreWhenEmpty:shouldRestoreWhenEmpty,getAutoSaveInterval:getAutoSaveInterval,getAutoSaveRetention:getAutoSaveRetention},isEmpty=function(editor,html){var forcedRootBlockName=editor.settings.forced_root_block;return html=global$2.trim("undefined"==typeof html?editor.getBody().innerHTML:html),""===html||new RegExp("^<"+forcedRootBlockName+"[^>]*>(( |&nbsp;|[ \t]|<br[^>]*>)+?|)</"+forcedRootBlockName+">|<br>$","i").test(html)},hasDraft=function(editor){var time=parseInt(global$1.getItem($_55sjs08zjh8lyztt.getAutoSavePrefix(editor)+"time"),10)||0;return!((new Date).getTime()-time>$_55sjs08zjh8lyztt.getAutoSaveRetention(editor))||(removeDraft(editor,!1),!1)},removeDraft=function(editor,fire){var prefix=$_55sjs08zjh8lyztt.getAutoSavePrefix(editor);global$1.removeItem(prefix+"draft"),global$1.removeItem(prefix+"time"),fire!==!1&&$_4ncezg8yjh8lyzts.fireRemoveDraft(editor)},storeDraft=function(editor){var prefix=$_55sjs08zjh8lyztt.getAutoSavePrefix(editor);!isEmpty(editor)&&editor.isDirty()&&(global$1.setItem(prefix+"draft",editor.getContent({format:"raw",no_events:!0})),global$1.setItem(prefix+"time",(new Date).getTime().toString()),$_4ncezg8yjh8lyzts.fireStoreDraft(editor))},restoreDraft=function(editor){var prefix=$_55sjs08zjh8lyztt.getAutoSavePrefix(editor);hasDraft(editor)&&(editor.setContent(global$1.getItem(prefix+"draft"),{format:"raw"}),$_4ncezg8yjh8lyzts.fireRestoreDraft(editor))},startStoreDraft=function(editor,started){var interval=$_55sjs08zjh8lyztt.getAutoSaveInterval(editor);started.get()||(setInterval(function(){editor.removed||storeDraft(editor)},interval),started.set(!0))},restoreLastDraft=function(editor){editor.undoManager.transact(function(){restoreDraft(editor),removeDraft(editor)}),editor.focus()},$_fa8c2v8vjh8lyzto={isEmpty:isEmpty,hasDraft:hasDraft,removeDraft:removeDraft,storeDraft:storeDraft,restoreDraft:restoreDraft,startStoreDraft:startStoreDraft,restoreLastDraft:restoreLastDraft},curry=function(f,editor){return function(){var args=Array.prototype.slice.call(arguments);return f.apply(null,[editor].concat(args))}},get=function(editor){return{hasDraft:curry($_fa8c2v8vjh8lyzto.hasDraft,editor),storeDraft:curry($_fa8c2v8vjh8lyzto.storeDraft,editor),restoreDraft:curry($_fa8c2v8vjh8lyzto.restoreDraft,editor),removeDraft:curry($_fa8c2v8vjh8lyzto.removeDraft,editor),isEmpty:curry($_fa8c2v8vjh8lyzto.isEmpty,editor)}},$_7d5i5z8ujh8lyztn={get:get},global$3=tinymce.util.Tools.resolve("tinymce.EditorManager");global$3._beforeUnloadHandler=function(){var msg;return global$2.each(global$3.get(),function(editor){editor.plugins.autosave&&editor.plugins.autosave.storeDraft(),!msg&&editor.isDirty()&&$_55sjs08zjh8lyztt.shouldAskBeforeUnload(editor)&&(msg=editor.translate("You have unsaved changes are you sure you want to navigate away?"))}),msg};var setup=function(editor){window.onbeforeunload=global$3._beforeUnloadHandler},$_cxjwbi91jh8lyztw={setup:setup},postRender=function(editor,started){return function(e){var ctrl=e.control;ctrl.disabled(!$_fa8c2v8vjh8lyzto.hasDraft(editor)),editor.on("StoreDraft RestoreDraft RemoveDraft",function(){ctrl.disabled(!$_fa8c2v8vjh8lyzto.hasDraft(editor))}),$_fa8c2v8vjh8lyzto.startStoreDraft(editor,started)}},register=function(editor,started){editor.addButton("restoredraft",{title:"Restore last draft",onclick:function(){$_fa8c2v8vjh8lyzto.restoreLastDraft(editor)},onPostRender:postRender(editor,started)}),editor.addMenuItem("restoredraft",{text:"Restore last draft",onclick:function(){$_fa8c2v8vjh8lyzto.restoreLastDraft(editor)},onPostRender:postRender(editor,started),context:"file"})},$_dic4wy93jh8lyzty={register:register};return global.add("autosave",function(editor){var started=Cell(!1);return $_cxjwbi91jh8lyztw.setup(editor),$_dic4wy93jh8lyzty.register(editor,started),$_7d5i5z8ujh8lyztn.get(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-bbcode",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),html2bbcode=function(s){s=global$1.trim(s);var rep=function(re,str){s=s.replace(re,str)};return rep(/<a.*?href=\"(.*?)\".*?>(.*?)<\/a>/gi,"[url=$1]$2[/url]"),rep(/<font.*?color=\"(.*?)\".*?class=\"codeStyle\".*?>(.*?)<\/font>/gi,"[code][color=$1]$2[/color][/code]"),rep(/<font.*?color=\"(.*?)\".*?class=\"quoteStyle\".*?>(.*?)<\/font>/gi,"[quote][color=$1]$2[/color][/quote]"),rep(/<font.*?class=\"codeStyle\".*?color=\"(.*?)\".*?>(.*?)<\/font>/gi,"[code][color=$1]$2[/color][/code]"),rep(/<font.*?class=\"quoteStyle\".*?color=\"(.*?)\".*?>(.*?)<\/font>/gi,"[quote][color=$1]$2[/color][/quote]"),rep(/<span style=\"color: ?(.*?);\">(.*?)<\/span>/gi,"[color=$1]$2[/color]"),rep(/<font.*?color=\"(.*?)\".*?>(.*?)<\/font>/gi,"[color=$1]$2[/color]"),rep(/<span style=\"font-size:(.*?);\">(.*?)<\/span>/gi,"[size=$1]$2[/size]"),rep(/<font>(.*?)<\/font>/gi,"$1"),rep(/<img.*?src=\"(.*?)\".*?\/>/gi,"[img]$1[/img]"),rep(/<span class=\"codeStyle\">(.*?)<\/span>/gi,"[code]$1[/code]"),rep(/<span class=\"quoteStyle\">(.*?)<\/span>/gi,"[quote]$1[/quote]"),rep(/<strong class=\"codeStyle\">(.*?)<\/strong>/gi,"[code][b]$1[/b][/code]"),rep(/<strong class=\"quoteStyle\">(.*?)<\/strong>/gi,"[quote][b]$1[/b][/quote]"),rep(/<em class=\"codeStyle\">(.*?)<\/em>/gi,"[code][i]$1[/i][/code]"),rep(/<em class=\"quoteStyle\">(.*?)<\/em>/gi,"[quote][i]$1[/i][/quote]"),rep(/<u class=\"codeStyle\">(.*?)<\/u>/gi,"[code][u]$1[/u][/code]"),rep(/<u class=\"quoteStyle\">(.*?)<\/u>/gi,"[quote][u]$1[/u][/quote]"),rep(/<\/(strong|b)>/gi,"[/b]"),rep(/<(strong|b)>/gi,"[b]"),rep(/<\/(em|i)>/gi,"[/i]"),rep(/<(em|i)>/gi,"[i]"),rep(/<\/u>/gi,"[/u]"),rep(/<span style=\"text-decoration: ?underline;\">(.*?)<\/span>/gi,"[u]$1[/u]"),rep(/<u>/gi,"[u]"),rep(/<blockquote[^>]*>/gi,"[quote]"),rep(/<\/blockquote>/gi,"[/quote]"),rep(/<br \/>/gi,"\n"),rep(/<br\/>/gi,"\n"),rep(/<br>/gi,"\n"),rep(/<p>/gi,""),rep(/<\/p>/gi,"\n"),rep(/&nbsp;|\u00a0/gi," "),rep(/&quot;/gi,'"'),rep(/&lt;/gi,"<"),rep(/&gt;/gi,">"),rep(/&amp;/gi,"&"),s},bbcode2html=function(s){s=global$1.trim(s);var rep=function(re,str){s=s.replace(re,str)};return rep(/\n/gi,"<br />"),rep(/\[b\]/gi,"<strong>"),rep(/\[\/b\]/gi,"</strong>"),rep(/\[i\]/gi,"<em>"),rep(/\[\/i\]/gi,"</em>"),rep(/\[u\]/gi,"<u>"),rep(/\[\/u\]/gi,"</u>"),rep(/\[url=([^\]]+)\](.*?)\[\/url\]/gi,'<a href="$1">$2</a>'),rep(/\[url\](.*?)\[\/url\]/gi,'<a href="$1">$1</a>'),rep(/\[img\](.*?)\[\/img\]/gi,'<img src="$1" />'),rep(/\[color=(.*?)\](.*?)\[\/color\]/gi,'<font color="$1">$2</font>'),rep(/\[code\](.*?)\[\/code\]/gi,'<span class="codeStyle">$1</span>&nbsp;'),rep(/\[quote.*?\](.*?)\[\/quote\]/gi,'<span class="quoteStyle">$1</span>&nbsp;'),s},$_bryy4596jh8lyzuk={html2bbcode:html2bbcode,bbcode2html:bbcode2html};return global.add("bbcode",function(){return{init:function(editor){editor.on("beforeSetContent",function(e){e.content=$_bryy4596jh8lyzuk.bbcode2html(e.content)}),editor.on("postProcess",function(e){e.set&&(e.content=$_bryy4596jh8lyzuk.bbcode2html(e.content)),e.get&&(e.content=$_bryy4596jh8lyzuk.html2bbcode(e.content))})}}}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-charmap",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}
var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),fireInsertCustomChar=function(editor,chr){return editor.fire("insertCustomChar",{chr:chr})},$_ac4my89cjh8lyzv0={fireInsertCustomChar:fireInsertCustomChar},insertChar=function(editor,chr){var evtChr=$_ac4my89cjh8lyzv0.fireInsertCustomChar(editor,chr).chr;editor.execCommand("mceInsertContent",!1,evtChr)},$_dd5ogr9bjh8lyzv0={insertChar:insertChar},global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),getCharMap=function(editor){return editor.settings.charmap},getCharMapAppend=function(editor){return editor.settings.charmap_append},$_a2f4bk9fjh8lyzvf={getCharMap:getCharMap,getCharMapAppend:getCharMapAppend},isArray=global$1.isArray,getDefaultCharMap=function(){return[["160","no-break space"],["173","soft hyphen"],["34","quotation mark"],["162","cent sign"],["8364","euro sign"],["163","pound sign"],["165","yen sign"],["169","copyright sign"],["174","registered sign"],["8482","trade mark sign"],["8240","per mille sign"],["181","micro sign"],["183","middle dot"],["8226","bullet"],["8230","three dot leader"],["8242","minutes / feet"],["8243","seconds / inches"],["167","section sign"],["182","paragraph sign"],["223","sharp s / ess-zed"],["8249","single left-pointing angle quotation mark"],["8250","single right-pointing angle quotation mark"],["171","left pointing guillemet"],["187","right pointing guillemet"],["8216","left single quotation mark"],["8217","right single quotation mark"],["8220","left double quotation mark"],["8221","right double quotation mark"],["8218","single low-9 quotation mark"],["8222","double low-9 quotation mark"],["60","less-than sign"],["62","greater-than sign"],["8804","less-than or equal to"],["8805","greater-than or equal to"],["8211","en dash"],["8212","em dash"],["175","macron"],["8254","overline"],["164","currency sign"],["166","broken bar"],["168","diaeresis"],["161","inverted exclamation mark"],["191","turned question mark"],["710","circumflex accent"],["732","small tilde"],["176","degree sign"],["8722","minus sign"],["177","plus-minus sign"],["247","division sign"],["8260","fraction slash"],["215","multiplication sign"],["185","superscript one"],["178","superscript two"],["179","superscript three"],["188","fraction one quarter"],["189","fraction one half"],["190","fraction three quarters"],["402","function / florin"],["8747","integral"],["8721","n-ary sumation"],["8734","infinity"],["8730","square root"],["8764","similar to"],["8773","approximately equal to"],["8776","almost equal to"],["8800","not equal to"],["8801","identical to"],["8712","element of"],["8713","not an element of"],["8715","contains as member"],["8719","n-ary product"],["8743","logical and"],["8744","logical or"],["172","not sign"],["8745","intersection"],["8746","union"],["8706","partial differential"],["8704","for all"],["8707","there exists"],["8709","diameter"],["8711","backward difference"],["8727","asterisk operator"],["8733","proportional to"],["8736","angle"],["180","acute accent"],["184","cedilla"],["170","feminine ordinal indicator"],["186","masculine ordinal indicator"],["8224","dagger"],["8225","double dagger"],["192","A - grave"],["193","A - acute"],["194","A - circumflex"],["195","A - tilde"],["196","A - diaeresis"],["197","A - ring above"],["256","A - macron"],["198","ligature AE"],["199","C - cedilla"],["200","E - grave"],["201","E - acute"],["202","E - circumflex"],["203","E - diaeresis"],["274","E - macron"],["204","I - grave"],["205","I - acute"],["206","I - circumflex"],["207","I - diaeresis"],["298","I - macron"],["208","ETH"],["209","N - tilde"],["210","O - grave"],["211","O - acute"],["212","O - circumflex"],["213","O - tilde"],["214","O - diaeresis"],["216","O - slash"],["332","O - macron"],["338","ligature OE"],["352","S - caron"],["217","U - grave"],["218","U - acute"],["219","U - circumflex"],["220","U - diaeresis"],["362","U - macron"],["221","Y - acute"],["376","Y - diaeresis"],["562","Y - macron"],["222","THORN"],["224","a - grave"],["225","a - acute"],["226","a - circumflex"],["227","a - tilde"],["228","a - diaeresis"],["229","a - ring above"],["257","a - macron"],["230","ligature ae"],["231","c - cedilla"],["232","e - grave"],["233","e - acute"],["234","e - circumflex"],["235","e - diaeresis"],["275","e - macron"],["236","i - grave"],["237","i - acute"],["238","i - circumflex"],["239","i - diaeresis"],["299","i - macron"],["240","eth"],["241","n - tilde"],["242","o - grave"],["243","o - acute"],["244","o - circumflex"],["245","o - tilde"],["246","o - diaeresis"],["248","o slash"],["333","o macron"],["339","ligature oe"],["353","s - caron"],["249","u - grave"],["250","u - acute"],["251","u - circumflex"],["252","u - diaeresis"],["363","u - macron"],["253","y - acute"],["254","thorn"],["255","y - diaeresis"],["563","y - macron"],["913","Alpha"],["914","Beta"],["915","Gamma"],["916","Delta"],["917","Epsilon"],["918","Zeta"],["919","Eta"],["920","Theta"],["921","Iota"],["922","Kappa"],["923","Lambda"],["924","Mu"],["925","Nu"],["926","Xi"],["927","Omicron"],["928","Pi"],["929","Rho"],["931","Sigma"],["932","Tau"],["933","Upsilon"],["934","Phi"],["935","Chi"],["936","Psi"],["937","Omega"],["945","alpha"],["946","beta"],["947","gamma"],["948","delta"],["949","epsilon"],["950","zeta"],["951","eta"],["952","theta"],["953","iota"],["954","kappa"],["955","lambda"],["956","mu"],["957","nu"],["958","xi"],["959","omicron"],["960","pi"],["961","rho"],["962","final sigma"],["963","sigma"],["964","tau"],["965","upsilon"],["966","phi"],["967","chi"],["968","psi"],["969","omega"],["8501","alef symbol"],["982","pi symbol"],["8476","real part symbol"],["978","upsilon - hook symbol"],["8472","Weierstrass p"],["8465","imaginary part"],["8592","leftwards arrow"],["8593","upwards arrow"],["8594","rightwards arrow"],["8595","downwards arrow"],["8596","left right arrow"],["8629","carriage return"],["8656","leftwards double arrow"],["8657","upwards double arrow"],["8658","rightwards double arrow"],["8659","downwards double arrow"],["8660","left right double arrow"],["8756","therefore"],["8834","subset of"],["8835","superset of"],["8836","not a subset of"],["8838","subset of or equal to"],["8839","superset of or equal to"],["8853","circled plus"],["8855","circled times"],["8869","perpendicular"],["8901","dot operator"],["8968","left ceiling"],["8969","right ceiling"],["8970","left floor"],["8971","right floor"],["9001","left-pointing angle bracket"],["9002","right-pointing angle bracket"],["9674","lozenge"],["9824","black spade suit"],["9827","black club suit"],["9829","black heart suit"],["9830","black diamond suit"],["8194","en space"],["8195","em space"],["8201","thin space"],["8204","zero width non-joiner"],["8205","zero width joiner"],["8206","left-to-right mark"],["8207","right-to-left mark"]]},charmapFilter=function(charmap){return global$1.grep(charmap,function(item){return isArray(item)&&2===item.length})},getCharsFromSetting=function(settingValue){return isArray(settingValue)?[].concat(charmapFilter(settingValue)):"function"==typeof settingValue?settingValue():[]},extendCharMap=function(editor,charmap){var userCharMap=$_a2f4bk9fjh8lyzvf.getCharMap(editor);userCharMap&&(charmap=getCharsFromSetting(userCharMap));var userCharMapAppend=$_a2f4bk9fjh8lyzvf.getCharMapAppend(editor);return userCharMapAppend?[].concat(charmap).concat(getCharsFromSetting(userCharMapAppend)):charmap},getCharMap$1=function(editor){return extendCharMap(editor,getDefaultCharMap())},$_1gjkpm9djh8lyzv2={getCharMap:getCharMap$1},get=function(editor){var getCharMap=function(){return $_1gjkpm9djh8lyzv2.getCharMap(editor)},insertChar=function(chr){$_dd5ogr9bjh8lyzv0.insertChar(editor,chr)};return{getCharMap:getCharMap,insertChar:insertChar}},$_bms9m09ajh8lyzuy={get:get},getHtml=function(charmap){var gridHtml,x,y,width=Math.min(charmap.length,25),height=Math.ceil(charmap.length/width);for(gridHtml='<table role="presentation" cellspacing="0" class="mce-charmap"><tbody>',y=0;y<height;y++){for(gridHtml+="<tr>",x=0;x<width;x++){var index=y*width+x;if(index<charmap.length){var chr=charmap[index],charCode=parseInt(chr[0],10),chrText=chr?String.fromCharCode(charCode):"&nbsp;";gridHtml+='<td title="'+chr[1]+'"><div tabindex="-1" title="'+chr[1]+'" role="button" data-chr="'+charCode+'">'+chrText+"</div></td>"}else gridHtml+="<td />"}gridHtml+="</tr>"}return gridHtml+="</tbody></table>"},$_a7xe5b9ijh8lyzvk={getHtml:getHtml},getParentTd=function(elm){for(;elm;){if("TD"===elm.nodeName)return elm;elm=elm.parentNode}},open=function(editor){var win,charMapPanel={type:"container",html:$_a7xe5b9ijh8lyzvk.getHtml($_1gjkpm9djh8lyzv2.getCharMap(editor)),onclick:function(e){var target=e.target;if(/^(TD|DIV)$/.test(target.nodeName)){var charDiv=getParentTd(target).firstChild;if(charDiv&&charDiv.hasAttribute("data-chr")){var charCodeString=charDiv.getAttribute("data-chr"),charCode=parseInt(charCodeString,10);isNaN(charCode)||$_dd5ogr9bjh8lyzv0.insertChar(editor,String.fromCharCode(charCode)),e.ctrlKey||win.close()}}},onmouseover:function(e){var td=getParentTd(e.target);td&&td.firstChild?(win.find("#preview").text(td.firstChild.firstChild.data),win.find("#previewTitle").text(td.title)):(win.find("#preview").text(" "),win.find("#previewTitle").text(" "))}};win=editor.windowManager.open({title:"Special character",spacing:10,padding:10,items:[charMapPanel,{type:"container",layout:"flex",direction:"column",align:"center",spacing:5,minWidth:160,minHeight:160,items:[{type:"label",name:"preview",text:" ",style:"font-size: 40px; text-align: center",border:1,minWidth:140,minHeight:80},{type:"spacer",minHeight:20},{type:"label",name:"previewTitle",text:" ",style:"white-space: pre-wrap;",border:1,minWidth:140}]}],buttons:[{text:"Close",onclick:function(){win.close()}}]})},$_5dcojo9hjh8lyzvh={open:open},register=function(editor){editor.addCommand("mceShowCharmap",function(){$_5dcojo9hjh8lyzvh.open(editor)})},$_ce5y9z9gjh8lyzvg={register:register},register$1=function(editor){editor.addButton("charmap",{icon:"charmap",tooltip:"Special character",cmd:"mceShowCharmap"}),editor.addMenuItem("charmap",{icon:"charmap",text:"Special character",cmd:"mceShowCharmap",context:"insert"})},$_381q489jjh8lyzvl={register:register$1};return global.add("charmap",function(editor){return $_ce5y9z9gjh8lyzvg.register(editor),$_381q489jjh8lyzvl.register(editor),$_bms9m09ajh8lyzuy.get(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-code",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),getMinWidth=function(editor){return editor.getParam("code_dialog_width",600)},getMinHeight=function(editor){return editor.getParam("code_dialog_height",Math.min(global$1.DOM.getViewPort().h-200,500))},$_co65cu9ojh8lyzwe={getMinWidth:getMinWidth,getMinHeight:getMinHeight},setContent=function(editor,html){editor.focus(),editor.undoManager.transact(function(){editor.setContent(html)}),editor.selection.setCursorLocation(),editor.nodeChanged()},getContent=function(editor){return editor.getContent({source_view:!0})},$_foko8h9qjh8lyzwf={setContent:setContent,getContent:getContent},open=function(editor){var minWidth=$_co65cu9ojh8lyzwe.getMinWidth(editor),minHeight=$_co65cu9ojh8lyzwe.getMinHeight(editor),win=editor.windowManager.open({title:"Source code",body:{type:"textbox",name:"code",multiline:!0,minWidth:minWidth,minHeight:minHeight,spellcheck:!1,style:"direction: ltr; text-align: left"},onSubmit:function(e){$_foko8h9qjh8lyzwf.setContent(editor,e.data.code)}});win.find("#code").value($_foko8h9qjh8lyzwf.getContent(editor))},$_e52w2l9njh8lyzwc={open:open},register=function(editor){editor.addCommand("mceCodeEditor",function(){$_e52w2l9njh8lyzwc.open(editor)})},$_curgce9mjh8lyzwb={register:register},register$1=function(editor){editor.addButton("code",{icon:"code",tooltip:"Source code",onclick:function(){$_e52w2l9njh8lyzwc.open(editor)}}),editor.addMenuItem("code",{icon:"code",text:"Source code",onclick:function(){$_e52w2l9njh8lyzwc.open(editor)}})},$_y8a369rjh8lyzwg={register:register$1};return global.add("code",function(editor){return $_curgce9mjh8lyzwb.register(editor),$_y8a369rjh8lyzwg.register(editor),{}}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-colorpicker",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Color"),showPreview=function(win,hexColor){win.find("#preview")[0].getEl().style.background=hexColor},setColor=function(win,value){var color=global$1(value),rgb=color.toRgb();win.fromJSON({r:rgb.r,g:rgb.g,b:rgb.b,hex:color.toHex().substr(1)}),showPreview(win,color.toHex())},open=function(editor,callback,value){var win=editor.windowManager.open({title:"Color",items:{type:"container",layout:"flex",direction:"row",align:"stretch",padding:5,spacing:10,items:[{type:"colorpicker",value:value,onchange:function(){var rgb=this.rgb();win&&(win.find("#r").value(rgb.r),win.find("#g").value(rgb.g),win.find("#b").value(rgb.b),win.find("#hex").value(this.value().substr(1)),showPreview(win,this.value()))}},{type:"form",padding:0,labelGap:5,defaults:{type:"textbox",size:7,value:"0",flex:1,spellcheck:!1,onchange:function(){var name,value,colorPickerCtrl=win.find("colorpicker")[0];return name=this.name(),value=this.value(),"hex"===name?(value="#"+value,setColor(win,value),void colorPickerCtrl.value(value)):(value={r:win.find("#r").value(),g:win.find("#g").value(),b:win.find("#b").value()},colorPickerCtrl.value(value),void setColor(win,value))}},items:[{name:"r",label:"R",autofocus:1},{name:"g",label:"G"},{name:"b",label:"B"},{name:"hex",label:"#",value:"000000"},{name:"preview",type:"container",border:1}]}]},onSubmit:function(){callback("#"+win.toJSON().hex)}});setColor(win,value)},$_5hgtbua8jh8lyzzp={open:open};return global.add("colorpicker",function(editor){editor.settings.color_picker_callback||(editor.settings.color_picker_callback=function(callback,value){$_5hgtbua8jh8lyzzp.open(editor,callback,value)})}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-contextmenu",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),get=function(visibleState){var isContextMenuVisible=function(){return visibleState.get()};return{isContextMenuVisible:isContextMenuVisible}},$_c2oibgadjh8lz004={get:get},shouldNeverUseNative=function(editor){return editor.settings.contextmenu_never_use_native},getContextMenu=function(editor){return editor.getParam("contextmenu","link openlink image inserttable | cell row column deletetable")},$_gduzdnafjh8lz006={shouldNeverUseNative:shouldNeverUseNative,getContextMenu:getContextMenu},global$1=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),getUiContainer=function(editor){return global$1.DOM.select(editor.settings.ui_container)[0]},nu=function(x,y){return{x:x,y:y}},transpose=function(pos,dx,dy){return nu(pos.x+dx,pos.y+dy)},fromPageXY=function(e){return nu(e.pageX,e.pageY)},fromClientXY=function(e){return nu(e.clientX,e.clientY)},transposeUiContainer=function(element,pos){if(element&&"static"!==global$1.DOM.getStyle(element,"position",!0)){var containerPos=global$1.DOM.getPos(element),dx=containerPos.x-element.scrollLeft,dy=containerPos.y-element.scrollTop;return transpose(pos,-dx,-dy)}return transpose(pos,0,0)},transposeContentAreaContainer=function(element,pos){var containerPos=global$1.DOM.getPos(element);return transpose(pos,containerPos.x,containerPos.y)},getPos=function(editor,e){if(editor.inline)return transposeUiContainer(getUiContainer(editor),fromPageXY(e));var iframePos=transposeContentAreaContainer(editor.getContentAreaContainer(),fromClientXY(e));return transposeUiContainer(getUiContainer(editor),iframePos)},$_712j2vagjh8lz007={getPos:getPos},global$2=tinymce.util.Tools.resolve("tinymce.ui.Factory"),global$3=tinymce.util.Tools.resolve("tinymce.util.Tools"),renderMenu=function(editor,visibleState){var menu,contextmenu,items=[];contextmenu=$_gduzdnafjh8lz006.getContextMenu(editor),global$3.each(contextmenu.split(/[ ,]/),function(name){var item=editor.menuItems[name];"|"===name&&(item={text:name}),item&&(item.shortcut="",items.push(item))});for(var i=0;i<items.length;i++)"|"===items[i].text&&(0!==i&&i!==items.length-1||items.splice(i,1));return menu=global$2.create("menu",{items:items,context:"contextmenu",classes:"contextmenu"}),menu.uiContainer=getUiContainer(editor),menu.renderTo(getUiContainer(editor)),menu.on("hide",function(e){e.control===this&&visibleState.set(!1)}),editor.on("remove",function(){menu.remove(),menu=null}),menu},show=function(editor,pos,visibleState,menu){null===menu.get()?menu.set(renderMenu(editor,visibleState)):menu.get().show(),menu.get().moveTo(pos.x,pos.y),visibleState.set(!0)},$_6to3u5ajjh8lz00c={show:show},isNativeOverrideKeyEvent=function(editor,e){return e.ctrlKey&&!$_gduzdnafjh8lz006.shouldNeverUseNative(editor)},setup=function(editor,visibleState,menu){editor.on("contextmenu",function(e){isNativeOverrideKeyEvent(editor,e)||(e.preventDefault(),$_6to3u5ajjh8lz00c.show(editor,$_712j2vagjh8lz007.getPos(editor,e),visibleState,menu))})},$_6rkqhnaejh8lz005={setup:setup};return global.add("contextmenu",function(editor){var menu=Cell(null),visibleState=Cell(!1);return $_6rkqhnaejh8lz005.setup(editor,visibleState,menu),$_c2oibgadjh8lz004.get(visibleState)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-directionality",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),setDir=function(editor,dir){var curDir,dom=editor.dom,blocks=editor.selection.getSelectedBlocks();blocks.length&&(curDir=dom.getAttrib(blocks[0],"dir"),global$1.each(blocks,function(block){dom.getParent(block.parentNode,'*[dir="'+dir+'"]',dom.getRoot())||dom.setAttrib(block,"dir",curDir!==dir?dir:null)}),editor.nodeChanged())},$_805jwcapjh8lz00w={setDir:setDir},register=function(editor){editor.addCommand("mceDirectionLTR",function(){$_805jwcapjh8lz00w.setDir(editor,"ltr")}),editor.addCommand("mceDirectionRTL",function(){$_805jwcapjh8lz00w.setDir(editor,"rtl")})},$_bg4nrvaojh8lz00v={register:register},generateSelector=function(dir){var selector=[];return global$1.each("h1 h2 h3 h4 h5 h6 div p".split(" "),function(name){selector.push(name+"[dir="+dir+"]")}),selector.join(",")},register$1=function(editor){editor.addButton("ltr",{title:"Left to right",cmd:"mceDirectionLTR",stateSelector:generateSelector("ltr")}),editor.addButton("rtl",{title:"Right to left",cmd:"mceDirectionRTL",stateSelector:generateSelector("rtl")})},$_gcdqcharjh8lz015={register:register$1};return global.add("directionality",function(editor){$_bg4nrvaojh8lz00v.register(editor),$_gcdqcharjh8lz015.register(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-emoticons",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),emoticons=[["cool","cry","embarassed","foot-in-mouth"],["frown","innocent","kiss","laughing"],["money-mouth","sealed","smile","surprised"],["tongue-out","undecided","wink","yell"]],getHtml=function(pluginUrl){var emoticonsHtml;return emoticonsHtml='<table role="list" class="mce-grid">',global$1.each(emoticons,function(row){emoticonsHtml+="<tr>",global$1.each(row,function(icon){var emoticonUrl=pluginUrl+"/img/smiley-"+icon+".gif";emoticonsHtml+='<td><a href="#" data-mce-url="'+emoticonUrl+'" data-mce-alt="'+icon+'" tabindex="-1" role="option" aria-label="'+icon+'"><img src="'+emoticonUrl+'" style="width: 18px; height: 18px" role="presentation" /></a></td>'}),emoticonsHtml+="</tr>"}),emoticonsHtml+="</table>"},$_1r8x6javjh8lz01h={getHtml:getHtml},insertEmoticon=function(editor,src,alt){editor.insertContent(editor.dom.createHTML("img",{src:src,alt:alt}))},register=function(editor,pluginUrl){var panelHtml=$_1r8x6javjh8lz01h.getHtml(pluginUrl);editor.addButton("emoticons",{type:"panelbutton",panel:{role:"application",autohide:!0,html:panelHtml,onclick:function(e){var linkElm=editor.dom.getParent(e.target,"a");linkElm&&(insertEmoticon(editor,linkElm.getAttribute("data-mce-url"),linkElm.getAttribute("data-mce-alt")),this.hide())}},tooltip:"Emoticons"})},$_eu4hs8aujh8lz01e={register:register};return global.add("emoticons",function(editor,pluginUrl){$_eu4hs8aujh8lz01e.register(editor,pluginUrl)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-fullpage",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),global$2=tinymce.util.Tools.resolve("tinymce.html.DomParser"),global$3=tinymce.util.Tools.resolve("tinymce.html.Node"),global$4=tinymce.util.Tools.resolve("tinymce.html.Serializer"),shouldHideInSourceView=function(editor){return editor.getParam("fullpage_hide_in_source_view")},getDefaultXmlPi=function(editor){return editor.getParam("fullpage_default_xml_pi")},getDefaultEncoding=function(editor){return editor.getParam("fullpage_default_encoding")},getDefaultFontFamily=function(editor){return editor.getParam("fullpage_default_font_family")},getDefaultFontSize=function(editor){return editor.getParam("fullpage_default_font_size")},getDefaultTextColor=function(editor){return editor.getParam("fullpage_default_text_color")},getDefaultTitle=function(editor){return editor.getParam("fullpage_default_title")},getDefaultDocType=function(editor){return editor.getParam("fullpage_default_doctype","<!DOCTYPE html>")},$_g0xiuvbsjh8lz05n={shouldHideInSourceView:shouldHideInSourceView,getDefaultXmlPi:getDefaultXmlPi,getDefaultEncoding:getDefaultEncoding,getDefaultFontFamily:getDefaultFontFamily,getDefaultFontSize:getDefaultFontSize,getDefaultTextColor:getDefaultTextColor,getDefaultTitle:getDefaultTitle,getDefaultDocType:getDefaultDocType},parseHeader=function(head){return global$2({validate:!1,root_name:"#document"}).parse(head)},htmlToData=function(editor,head){function getAttr(elm,name){var value=elm.attr(name);return value||""}var elm,matches,headerFragment=parseHeader(head),data={};return data.fontface=$_g0xiuvbsjh8lz05n.getDefaultFontFamily(editor),data.fontsize=$_g0xiuvbsjh8lz05n.getDefaultFontSize(editor),elm=headerFragment.firstChild,7===elm.type&&(data.xml_pi=!0,matches=/encoding="([^"]+)"/.exec(elm.value),matches&&(data.docencoding=matches[1])),elm=headerFragment.getAll("#doctype")[0],elm&&(data.doctype="<!DOCTYPE"+elm.value+">"),elm=headerFragment.getAll("title")[0],elm&&elm.firstChild&&(data.title=elm.firstChild.value),global$1.each(headerFragment.getAll("meta"),function(meta){var matches,name=meta.attr("name"),httpEquiv=meta.attr("http-equiv");name?data[name.toLowerCase()]=meta.attr("content"):"Content-Type"===httpEquiv&&(matches=/charset\s*=\s*(.*)\s*/gi.exec(meta.attr("content")),matches&&(data.docencoding=matches[1]))}),elm=headerFragment.getAll("html")[0],elm&&(data.langcode=getAttr(elm,"lang")||getAttr(elm,"xml:lang")),data.stylesheets=[],global$1.each(headerFragment.getAll("link"),function(link){"stylesheet"===link.attr("rel")&&data.stylesheets.push(link.attr("href"))}),elm=headerFragment.getAll("body")[0],elm&&(data.langdir=getAttr(elm,"dir"),data.style=getAttr(elm,"style"),data.visited_color=getAttr(elm,"vlink"),data.link_color=getAttr(elm,"link"),data.active_color=getAttr(elm,"alink")),data},dataToHtml=function(editor,data,head){function setAttr(elm,name,value){elm.attr(name,value?value:void 0)}function addHeadNode(node){headElement.firstChild?headElement.insert(node,headElement.firstChild):headElement.append(node)}var headerFragment,headElement,html,elm,value,dom=editor.dom;headerFragment=parseHeader(head),headElement=headerFragment.getAll("head")[0],headElement||(elm=headerFragment.getAll("html")[0],headElement=new global$3("head",1),elm.firstChild?elm.insert(headElement,elm.firstChild,!0):elm.append(headElement)),elm=headerFragment.firstChild,data.xml_pi?(value='version="1.0"',data.docencoding&&(value+=' encoding="'+data.docencoding+'"'),7!==elm.type&&(elm=new global$3("xml",7),headerFragment.insert(elm,headerFragment.firstChild,!0)),elm.value=value):elm&&7===elm.type&&elm.remove(),elm=headerFragment.getAll("#doctype")[0],data.doctype?(elm||(elm=new global$3("#doctype",10),data.xml_pi?headerFragment.insert(elm,headerFragment.firstChild):addHeadNode(elm)),elm.value=data.doctype.substring(9,data.doctype.length-1)):elm&&elm.remove(),elm=null,global$1.each(headerFragment.getAll("meta"),function(meta){"Content-Type"===meta.attr("http-equiv")&&(elm=meta)}),data.docencoding?(elm||(elm=new global$3("meta",1),elm.attr("http-equiv","Content-Type"),elm.shortEnded=!0,addHeadNode(elm)),elm.attr("content","text/html; charset="+data.docencoding)):elm&&elm.remove(),elm=headerFragment.getAll("title")[0],data.title?(elm?elm.empty():(elm=new global$3("title",1),addHeadNode(elm)),elm.append(new global$3("#text",3)).value=data.title):elm&&elm.remove(),global$1.each("keywords,description,author,copyright,robots".split(","),function(name){var i,meta,nodes=headerFragment.getAll("meta"),value=data[name];for(i=0;i<nodes.length;i++)if(meta=nodes[i],meta.attr("name")===name)return void(value?meta.attr("content",value):meta.remove());value&&(elm=new global$3("meta",1),elm.attr("name",name),elm.attr("content",value),elm.shortEnded=!0,addHeadNode(elm))});var currentStyleSheetsMap={};return global$1.each(headerFragment.getAll("link"),function(stylesheet){"stylesheet"===stylesheet.attr("rel")&&(currentStyleSheetsMap[stylesheet.attr("href")]=stylesheet)}),global$1.each(data.stylesheets,function(stylesheet){currentStyleSheetsMap[stylesheet]||(elm=new global$3("link",1),elm.attr({rel:"stylesheet",text:"text/css",href:stylesheet}),elm.shortEnded=!0,addHeadNode(elm)),delete currentStyleSheetsMap[stylesheet]}),global$1.each(currentStyleSheetsMap,function(stylesheet){stylesheet.remove()}),elm=headerFragment.getAll("body")[0],elm&&(setAttr(elm,"dir",data.langdir),setAttr(elm,"style",data.style),setAttr(elm,"vlink",data.visited_color),setAttr(elm,"link",data.link_color),setAttr(elm,"alink",data.active_color),dom.setAttribs(editor.getBody(),{style:data.style,dir:data.dir,vLink:data.visited_color,link:data.link_color,aLink:data.active_color})),elm=headerFragment.getAll("html")[0],elm&&(setAttr(elm,"lang",data.langcode),setAttr(elm,"xml:lang",data.langcode)),headElement.firstChild||headElement.remove(),html=global$4({validate:!1,indent:!0,apply_source_formatting:!0,indent_before:"head,html,body,meta,title,script,link,style",indent_after:"head,html,body,meta,title,script,link,style"}).serialize(headerFragment),html.substring(0,html.indexOf("</body>"))},$_28en95bojh8lz05g={parseHeader:parseHeader,htmlToData:htmlToData,dataToHtml:dataToHtml},open=function(editor,headState){var data=$_28en95bojh8lz05g.htmlToData(editor,headState.get());editor.windowManager.open({title:"Document properties",data:data,defaults:{type:"textbox",size:40},body:[{name:"title",label:"Title"},{name:"keywords",label:"Keywords"},{name:"description",label:"Description"},{name:"robots",label:"Robots"},{name:"author",label:"Author"},{name:"docencoding",label:"Encoding"}],onSubmit:function(e){var headHtml=$_28en95bojh8lz05g.dataToHtml(editor,global$1.extend(data,e.data),headState.get());headState.set(headHtml)}})},$_ekcxiubmjh8lz05d={open:open},register=function(editor,headState){editor.addCommand("mceFullPageProperties",function(){$_ekcxiubmjh8lz05d.open(editor,headState)})},$_8prs3sbljh8lz05c={register:register},protectHtml=function(protect,html){return global$1.each(protect,function(pattern){html=html.replace(pattern,function(str){return"<!--mce:protected "+escape(str)+"-->"})}),html},unprotectHtml=function(html){return html.replace(/<!--mce:protected ([\s\S]*?)-->/g,function(a,m){return unescape(m)})},$_e8blxibujh8lz05v={protectHtml:protectHtml,unprotectHtml:unprotectHtml},each=global$1.each,low=function(s){return s.replace(/<\/?[A-Z]+/g,function(a){return a.toLowerCase()})},handleSetContent=function(editor,headState,footState,evt){var startPos,endPos,content,headerFragment,elm,styles="",dom=editor.dom;if(!(evt.selection||(content=$_e8blxibujh8lz05v.protectHtml(editor.settings.protect,evt.content),"raw"===evt.format&&headState.get()||evt.source_view&&$_g0xiuvbsjh8lz05n.shouldHideInSourceView(editor)))){0!==content.length||evt.source_view||(content=global$1.trim(headState.get())+"\n"+global$1.trim(content)+"\n"+global$1.trim(footState.get())),content=content.replace(/<(\/?)BODY/gi,"<$1body"),startPos=content.indexOf("<body"),startPos!==-1?(startPos=content.indexOf(">",startPos),headState.set(low(content.substring(0,startPos+1))),endPos=content.indexOf("</body",startPos),endPos===-1&&(endPos=content.length),evt.content=global$1.trim(content.substring(startPos+1,endPos)),footState.set(low(content.substring(endPos)))):(headState.set(getDefaultHeader(editor)),footState.set("\n</body>\n</html>")),headerFragment=$_28en95bojh8lz05g.parseHeader(headState.get()),each(headerFragment.getAll("style"),function(node){node.firstChild&&(styles+=node.firstChild.value)}),elm=headerFragment.getAll("body")[0],elm&&dom.setAttribs(editor.getBody(),{style:elm.attr("style")||"",dir:elm.attr("dir")||"",vLink:elm.attr("vlink")||"",link:elm.attr("link")||"",aLink:elm.attr("alink")||""}),dom.remove("fullpage_styles");var headElm=editor.getDoc().getElementsByTagName("head")[0];styles&&(dom.add(headElm,"style",{id:"fullpage_styles"},styles),elm=dom.get("fullpage_styles"),elm.styleSheet&&(elm.styleSheet.cssText=styles));var currentStyleSheetsMap={};global$1.each(headElm.getElementsByTagName("link"),function(stylesheet){"stylesheet"===stylesheet.rel&&stylesheet.getAttribute("data-mce-fullpage")&&(currentStyleSheetsMap[stylesheet.href]=stylesheet)}),global$1.each(headerFragment.getAll("link"),function(stylesheet){var href=stylesheet.attr("href");return!href||(currentStyleSheetsMap[href]||"stylesheet"!==stylesheet.attr("rel")||dom.add(headElm,"link",{rel:"stylesheet",text:"text/css",href:href,"data-mce-fullpage":"1"}),void delete currentStyleSheetsMap[href])}),global$1.each(currentStyleSheetsMap,function(stylesheet){stylesheet.parentNode.removeChild(stylesheet)})}},getDefaultHeader=function(editor){var value,header="",styles="";if($_g0xiuvbsjh8lz05n.getDefaultXmlPi(editor)){var piEncoding=$_g0xiuvbsjh8lz05n.getDefaultEncoding(editor);header+='<?xml version="1.0" encoding="'+(piEncoding?piEncoding:"ISO-8859-1")+'" ?>\n'}return header+=$_g0xiuvbsjh8lz05n.getDefaultDocType(editor),header+="\n<html>\n<head>\n",(value=$_g0xiuvbsjh8lz05n.getDefaultTitle(editor))&&(header+="<title>"+value+"</title>\n"),(value=$_g0xiuvbsjh8lz05n.getDefaultEncoding(editor))&&(header+='<meta http-equiv="Content-Type" content="text/html; charset='+value+'" />\n'),(value=$_g0xiuvbsjh8lz05n.getDefaultFontFamily(editor))&&(styles+="font-family: "+value+";"),(value=$_g0xiuvbsjh8lz05n.getDefaultFontSize(editor))&&(styles+="font-size: "+value+";"),(value=$_g0xiuvbsjh8lz05n.getDefaultTextColor(editor))&&(styles+="color: "+value+";"),header+="</head>\n<body"+(styles?' style="'+styles+'"':"")+">\n"},handleGetContent=function(editor,head,foot,evt){evt.selection||evt.source_view&&$_g0xiuvbsjh8lz05n.shouldHideInSourceView(editor)||(evt.content=$_e8blxibujh8lz05v.unprotectHtml(global$1.trim(head)+"\n"+global$1.trim(evt.content)+"\n"+global$1.trim(foot)));
},setup=function(editor,headState,footState){editor.on("BeforeSetContent",function(evt){handleSetContent(editor,headState,footState,evt)}),editor.on("GetContent",function(evt){handleGetContent(editor,headState.get(),footState.get(),evt)})},$_56p36sbtjh8lz05p={setup:setup},register$1=function(editor){editor.addButton("fullpage",{title:"Document properties",cmd:"mceFullPageProperties"}),editor.addMenuItem("fullpage",{text:"Document properties",cmd:"mceFullPageProperties",context:"file"})},$_bqab8cbvjh8lz05w={register:register$1};return global.add("fullpage",function(editor){var headState=Cell(""),footState=Cell("");$_8prs3sbljh8lz05c.register(editor,headState),$_bqab8cbvjh8lz05w.register(editor),$_56p36sbtjh8lz05p.setup(editor,headState,footState)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-fullscreen",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),get=function(fullscreenState){return{isFullscreen:function(){return null!==fullscreenState.get()}}},$_1rpb71bzjh8lz06v={get:get},global$1=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),fireFullscreenStateChanged=function(editor,state){editor.fire("FullscreenStateChanged",{state:state})},$_1d2nfac3jh8lz070={fireFullscreenStateChanged:fireFullscreenStateChanged},DOM=global$1.DOM,getWindowSize=function(){var w,h,win=window,doc=document,body=doc.body;return body.offsetWidth&&(w=body.offsetWidth,h=body.offsetHeight),win.innerWidth&&win.innerHeight&&(w=win.innerWidth,h=win.innerHeight),{w:w,h:h}},getScrollPos=function(){var vp=DOM.getViewPort();return{x:vp.x,y:vp.y}},setScrollPos=function(pos){window.scrollTo(pos.x,pos.y)},toggleFullscreen=function(editor,fullscreenState){var editorContainerStyle,editorContainer,iframe,iframeStyle,body=document.body,documentElement=document.documentElement,fullscreenInfo=fullscreenState.get(),resize=function(){DOM.setStyle(iframe,"height",getWindowSize().h-(editorContainer.clientHeight-iframe.clientHeight))},removeResize=function(){DOM.unbind(window,"resize",resize)};if(editorContainer=editor.getContainer(),editorContainerStyle=editorContainer.style,iframe=editor.getContentAreaContainer().firstChild,iframeStyle=iframe.style,fullscreenInfo)iframeStyle.width=fullscreenInfo.iframeWidth,iframeStyle.height=fullscreenInfo.iframeHeight,fullscreenInfo.containerWidth&&(editorContainerStyle.width=fullscreenInfo.containerWidth),fullscreenInfo.containerHeight&&(editorContainerStyle.height=fullscreenInfo.containerHeight),DOM.removeClass(body,"mce-fullscreen"),DOM.removeClass(documentElement,"mce-fullscreen"),DOM.removeClass(editorContainer,"mce-fullscreen"),setScrollPos(fullscreenInfo.scrollPos),DOM.unbind(window,"resize",fullscreenInfo.resizeHandler),editor.off("remove",fullscreenInfo.removeHandler),fullscreenState.set(null),$_1d2nfac3jh8lz070.fireFullscreenStateChanged(editor,!1);else{var newFullScreenInfo={scrollPos:getScrollPos(),containerWidth:editorContainerStyle.width,containerHeight:editorContainerStyle.height,iframeWidth:iframeStyle.width,iframeHeight:iframeStyle.height,resizeHandler:resize,removeHandler:removeResize};iframeStyle.width=iframeStyle.height="100%",editorContainerStyle.width=editorContainerStyle.height="",DOM.addClass(body,"mce-fullscreen"),DOM.addClass(documentElement,"mce-fullscreen"),DOM.addClass(editorContainer,"mce-fullscreen"),DOM.bind(window,"resize",resize),editor.on("remove",removeResize),resize(),fullscreenState.set(newFullScreenInfo),$_1d2nfac3jh8lz070.fireFullscreenStateChanged(editor,!0)}},$_7tc4jhc1jh8lz06x={toggleFullscreen:toggleFullscreen},register=function(editor,fullscreenState){editor.addCommand("mceFullScreen",function(){$_7tc4jhc1jh8lz06x.toggleFullscreen(editor,fullscreenState)})},$_em8om1c0jh8lz06w={register:register},postRender=function(editor){return function(e){var ctrl=e.control;editor.on("FullscreenStateChanged",function(e){ctrl.active(e.state)})}},register$1=function(editor){editor.addMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Ctrl+Shift+F",selectable:!0,cmd:"mceFullScreen",onPostRender:postRender(editor),context:"view"}),editor.addButton("fullscreen",{active:!1,tooltip:"Fullscreen",cmd:"mceFullScreen",onPostRender:postRender(editor)})},$_f8ip0cc4jh8lz071={register:register$1};return global.add("fullscreen",function(editor){var fullscreenState=Cell(null);return editor.settings.inline?$_1rpb71bzjh8lz06v.get(fullscreenState):($_em8om1c0jh8lz06w.register(editor,fullscreenState),$_f8ip0cc4jh8lz071.register(editor),editor.addShortcut("Ctrl+Shift+F","","mceFullScreen"),$_1rpb71bzjh8lz06v.get(fullscreenState))}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-hr",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),register=function(editor){editor.addCommand("InsertHorizontalRule",function(){editor.execCommand("mceInsertContent",!1,"<hr />")})},$_dxcs8yc7jh8lz07d={register:register},register$1=function(editor){editor.addButton("hr",{icon:"hr",tooltip:"Horizontal line",cmd:"InsertHorizontalRule"}),editor.addMenuItem("hr",{icon:"hr",text:"Horizontal line",cmd:"InsertHorizontalRule",context:"insert"})},$_dmdtoxc8jh8lz07e={register:register$1};return global.add("hr",function(editor){$_dxcs8yc7jh8lz07d.register(editor),$_dmdtoxc8jh8lz07e.register(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-image",["tinymce"],function(){return function(){!function(){(function(){"use strict";function FileReader(){var f=$_8d9gbscgjh8lz089.getOrDie("FileReader");return new f}function XMLHttpRequest(){var f=$_8d9gbscgjh8lz089.getOrDie("XMLHttpRequest");return new f}function Uploader(settings){var defaultHandler=function(blobInfo,success,failure,progress){var xhr,formData;xhr=new XMLHttpRequest,xhr.open("POST",settings.url),xhr.withCredentials=settings.credentials,xhr.upload.onprogress=function(e){progress(e.loaded/e.total*100)},xhr.onerror=function(){failure("Image upload failed due to a XHR Transport error. Code: "+xhr.status)},xhr.onload=function(){var json;return xhr.status<200||xhr.status>=300?void failure("HTTP Error: "+xhr.status):(json=JSON.parse(xhr.responseText),json&&"string"==typeof json.location?void success(pathJoin(settings.basePath,json.location)):void failure("Invalid JSON: "+xhr.responseText))},formData=new FormData,formData.append("file",blobInfo.blob(),blobInfo.filename()),xhr.send(formData)},uploadBlob=function(blobInfo,handler){return new global$2(function(resolve,reject){try{handler(blobInfo,resolve,reject,noop)}catch(ex){reject(ex.message)}})},isDefaultHandler=function(handler){return handler===defaultHandler},upload=function(blobInfo){return!settings.url&&isDefaultHandler(settings.handler)?global$2.reject("Upload url missing from the settings."):uploadBlob(blobInfo,settings.handler)};return settings=global$3.extend({credentials:!1,handler:defaultHandler},settings),{upload:upload}}function Dialog(editor){function showDialog(imageList){var win,imageListCtrl,data=readImageDataFromSelection(editor);if(imageList&&(imageListCtrl={type:"listbox",label:"Image list",name:"image-list",values:$_5m5ooacejh8lz07v.buildListItems(imageList,function(item){item.value=editor.convertURL(item.value||item.url,"src")},[{text:"None",value:""}]),value:data.src&&editor.convertURL(data.src,"src"),onselect:function(e){var altCtrl=win.find("#alt");(!altCtrl.value()||e.lastControl&&altCtrl.value()===e.lastControl.text())&&altCtrl.value(e.control.text()),win.find("#src").value(e.control.value()).fire("change")},onPostRender:function(){imageListCtrl=this}}),$_crxcnscdjh8lz07s.hasAdvTab(editor)||$_crxcnscdjh8lz07s.hasUploadUrl(editor)||$_crxcnscdjh8lz07s.hasUploadHandler(editor)){var body=[$_586d0gcsjh8lz091.makeTab(editor,imageListCtrl)];$_crxcnscdjh8lz07s.hasAdvTab(editor)&&body.push($_546vuxcmjh8lz08g.makeTab(editor)),($_crxcnscdjh8lz07s.hasUploadUrl(editor)||$_crxcnscdjh8lz07s.hasUploadHandler(editor))&&body.push($_3w774acujh8lz097.makeTab(editor)),win=editor.windowManager.open({title:"Insert/edit image",data:data,bodyType:"tabpanel",body:body,onSubmit:$_8rhdleczjh8lz09i.curry(submitForm,editor)})}else win=editor.windowManager.open({title:"Insert/edit image",data:data,body:$_586d0gcsjh8lz091.getGeneralItems(editor,imageListCtrl),onSubmit:$_8rhdleczjh8lz09i.curry(submitForm,editor)});$_8agebqctjh8lz094.syncSize(win)}function open(){$_5m5ooacejh8lz07v.createImageList(editor,showDialog)}return{open:open}}function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),hasDimensions=function(editor){return editor.settings.image_dimensions!==!1},hasAdvTab=function(editor){return editor.settings.image_advtab===!0},getPrependUrl=function(editor){return editor.getParam("image_prepend_url","")},getClassList=function(editor){return editor.getParam("image_class_list")},hasDescription=function(editor){return editor.settings.image_description!==!1},hasImageTitle=function(editor){return editor.settings.image_title===!0},hasImageCaption=function(editor){return editor.settings.image_caption===!0},getImageList=function(editor){return editor.getParam("image_list",!1)},hasUploadUrl=function(editor){return editor.getParam("images_upload_url",!1)},hasUploadHandler=function(editor){return editor.getParam("images_upload_handler",!1)},getUploadUrl=function(editor){return editor.getParam("images_upload_url")},getUploadHandler=function(editor){return editor.getParam("images_upload_handler")},getUploadBasePath=function(editor){return editor.getParam("images_upload_base_path")},getUploadCredentials=function(editor){return editor.getParam("images_upload_credentials")},$_crxcnscdjh8lz07s={hasDimensions:hasDimensions,hasAdvTab:hasAdvTab,getPrependUrl:getPrependUrl,getClassList:getClassList,hasDescription:hasDescription,hasImageTitle:hasImageTitle,hasImageCaption:hasImageCaption,getImageList:getImageList,hasUploadUrl:hasUploadUrl,hasUploadHandler:hasUploadHandler,getUploadUrl:getUploadUrl,getUploadHandler:getUploadHandler,getUploadBasePath:getUploadBasePath,getUploadCredentials:getUploadCredentials},global$1="undefined"!=typeof window?window:Function("return this;")(),path=function(parts,scope){for(var o=void 0!==scope&&null!==scope?scope:global$1,i=0;i<parts.length&&void 0!==o&&null!==o;++i)o=o[parts[i]];return o},resolve=function(p,scope){var parts=p.split(".");return path(parts,scope)},step=function(o,part){return void 0!==o[part]&&null!==o[part]||(o[part]={}),o[part]},forge=function(parts,target){for(var o=void 0!==target?target:global$1,i=0;i<parts.length;++i)o=step(o,parts[i]);return o},namespace=function(name,target){var parts=name.split(".");return forge(parts,target)},$_9gheychjh8lz08c={path:path,resolve:resolve,forge:forge,namespace:namespace},unsafe=function(name,scope){return $_9gheychjh8lz08c.resolve(name,scope)},getOrDie=function(name,scope){var actual=unsafe(name,scope);if(void 0===actual||null===actual)throw name+" not available on this browser";return actual},$_8d9gbscgjh8lz089={getOrDie:getOrDie},global$2=tinymce.util.Tools.resolve("tinymce.util.Promise"),global$3=tinymce.util.Tools.resolve("tinymce.util.Tools"),global$4=tinymce.util.Tools.resolve("tinymce.util.XHR"),parseIntAndGetMax=function(val1,val2){return Math.max(parseInt(val1,10),parseInt(val2,10))},getImageSize=function(url,callback){function done(width,height){img.parentNode&&img.parentNode.removeChild(img),callback({width:width,height:height})}var img=document.createElement("img");img.onload=function(){var width=parseIntAndGetMax(img.width,img.clientWidth),height=parseIntAndGetMax(img.height,img.clientHeight);done(width,height)},img.onerror=function(){done(0,0)};var style=img.style;style.visibility="hidden",style.position="fixed",style.bottom=style.left="0px",style.width=style.height="auto",document.body.appendChild(img),img.src=url},buildListItems=function(inputList,itemCallback,startItems){function appendItems(values,output){return output=output||[],global$3.each(values,function(item){var menuItem={text:item.text||item.title};item.menu?menuItem.menu=appendItems(item.menu):(menuItem.value=item.value,itemCallback(menuItem)),output.push(menuItem)}),output}return appendItems(inputList,startItems||[])},removePixelSuffix=function(value){return value&&(value=value.replace(/px$/,"")),value},addPixelSuffix=function(value){return value.length>0&&/^[0-9]+$/.test(value)&&(value+="px"),value},mergeMargins=function(css){if(css.margin){var splitMargin=css.margin.split(" ");switch(splitMargin.length){case 1:css["margin-top"]=css["margin-top"]||splitMargin[0],css["margin-right"]=css["margin-right"]||splitMargin[0],css["margin-bottom"]=css["margin-bottom"]||splitMargin[0],css["margin-left"]=css["margin-left"]||splitMargin[0];break;case 2:css["margin-top"]=css["margin-top"]||splitMargin[0],css["margin-right"]=css["margin-right"]||splitMargin[1],css["margin-bottom"]=css["margin-bottom"]||splitMargin[0],css["margin-left"]=css["margin-left"]||splitMargin[1];break;case 3:css["margin-top"]=css["margin-top"]||splitMargin[0],css["margin-right"]=css["margin-right"]||splitMargin[1],css["margin-bottom"]=css["margin-bottom"]||splitMargin[2],css["margin-left"]=css["margin-left"]||splitMargin[1];break;case 4:css["margin-top"]=css["margin-top"]||splitMargin[0],css["margin-right"]=css["margin-right"]||splitMargin[1],css["margin-bottom"]=css["margin-bottom"]||splitMargin[2],css["margin-left"]=css["margin-left"]||splitMargin[3]}delete css.margin}return css},createImageList=function(editor,callback){var imageList=$_crxcnscdjh8lz07s.getImageList(editor);"string"==typeof imageList?global$4.send({url:imageList,success:function(text){callback(JSON.parse(text))}}):"function"==typeof imageList?imageList(callback):callback(imageList)},waitLoadImage=function(editor,data,imgElm){function selectImage(){imgElm.onload=imgElm.onerror=null,editor.selection&&(editor.selection.select(imgElm),editor.nodeChanged())}imgElm.onload=function(){data.width||data.height||!$_crxcnscdjh8lz07s.hasDimensions(editor)||editor.dom.setAttribs(imgElm,{width:imgElm.clientWidth,height:imgElm.clientHeight}),selectImage()},imgElm.onerror=selectImage},blobToDataUri=function(blob){return new global$2(function(resolve,reject){var reader=new FileReader;reader.onload=function(){resolve(reader.result)},reader.onerror=function(){reject(FileReader.error.message)},reader.readAsDataURL(blob)})},$_5m5ooacejh8lz07v={getImageSize:getImageSize,buildListItems:buildListItems,removePixelSuffix:removePixelSuffix,addPixelSuffix:addPixelSuffix,mergeMargins:mergeMargins,createImageList:createImageList,waitLoadImage:waitLoadImage,blobToDataUri:blobToDataUri},global$5=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),typeOf=function(x){if(null===x)return"null";var t=typeof x;return"object"===t&&Array.prototype.isPrototypeOf(x)?"array":"object"===t&&String.prototype.isPrototypeOf(x)?"string":t},isType=function(type){return function(value){return typeOf(value)===type}},$_8actkxcrjh8lz08z={isString:isType("string"),isObject:isType("object"),isArray:isType("array"),isNull:isType("null"),isBoolean:isType("boolean"),isUndefined:isType("undefined"),isFunction:isType("function"),isNumber:isType("number")},shallow=function(old,nu){return nu},deep=function(old,nu){var bothObjects=$_8actkxcrjh8lz08z.isObject(old)&&$_8actkxcrjh8lz08z.isObject(nu);return bothObjects?deepMerge(old,nu):nu},baseMerge=function(merger){return function(){for(var objects=new Array(arguments.length),i=0;i<objects.length;i++)objects[i]=arguments[i];if(0===objects.length)throw new Error("Can't merge zero objects");for(var ret={},j=0;j<objects.length;j++){var curObject=objects[j];for(var key in curObject)curObject.hasOwnProperty(key)&&(ret[key]=merger(ret[key],curObject[key]))}return ret}},deepMerge=baseMerge(deep),merge=baseMerge(shallow),$_kivhlcqjh8lz08x={deepMerge:deepMerge,merge:merge},DOM=global$5.DOM,getHspace=function(image){return image.style.marginLeft&&image.style.marginRight&&image.style.marginLeft===image.style.marginRight?$_5m5ooacejh8lz07v.removePixelSuffix(image.style.marginLeft):""},getVspace=function(image){return image.style.marginTop&&image.style.marginBottom&&image.style.marginTop===image.style.marginBottom?$_5m5ooacejh8lz07v.removePixelSuffix(image.style.marginTop):""},getBorder=function(image){return image.style.borderWidth?$_5m5ooacejh8lz07v.removePixelSuffix(image.style.borderWidth):""},getAttrib=function(image,name){return image.hasAttribute(name)?image.getAttribute(name):""},getStyle=function(image,name){return image.style[name]?image.style[name]:""},hasCaption=function(image){return null!==image.parentNode&&"FIGURE"===image.parentNode.nodeName},setAttrib=function(image,name,value){image.setAttribute(name,value)},wrapInFigure=function(image){var figureElm=DOM.create("figure",{"class":"image"});DOM.insertAfter(figureElm,image),figureElm.appendChild(image),figureElm.appendChild(DOM.create("figcaption",{contentEditable:!0},"Caption")),figureElm.contentEditable="false"},removeFigure=function(image){var figureElm=image.parentNode;DOM.insertAfter(image,figureElm),DOM.remove(figureElm)},toggleCaption=function(image){hasCaption(image)?removeFigure(image):wrapInFigure(image)},normalizeStyle=function(image,normalizeCss){var attrValue=image.getAttribute("style"),value=normalizeCss(null!==attrValue?attrValue:"");value.length>0?(image.setAttribute("style",value),image.setAttribute("data-mce-style",value)):image.removeAttribute("style")},setSize=function(name,normalizeCss){return function(image,name,value){image.style[name]?(image.style[name]=$_5m5ooacejh8lz07v.addPixelSuffix(value),normalizeStyle(image,normalizeCss)):setAttrib(image,name,value)}},getSize=function(image,name){return image.style[name]?$_5m5ooacejh8lz07v.removePixelSuffix(image.style[name]):getAttrib(image,name)},setHspace=function(image,value){var pxValue=$_5m5ooacejh8lz07v.addPixelSuffix(value);image.style.marginLeft=pxValue,image.style.marginRight=pxValue},setVspace=function(image,value){var pxValue=$_5m5ooacejh8lz07v.addPixelSuffix(value);image.style.marginTop=pxValue,image.style.marginBottom=pxValue},setBorder=function(image,value){var pxValue=$_5m5ooacejh8lz07v.addPixelSuffix(value);image.style.borderWidth=pxValue},setBorderStyle=function(image,value){image.style.borderStyle=value},getBorderStyle=function(image){return getStyle(image,"borderStyle")},isFigure=function(elm){return"FIGURE"===elm.nodeName},defaultData=function(){return{src:"",alt:"",title:"",width:"",height:"","class":"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:""}},getStyleValue=function(normalizeCss,data){var image=document.createElement("img");return setAttrib(image,"style",data.style),(getHspace(image)||""!==data.hspace)&&setHspace(image,data.hspace),(getVspace(image)||""!==data.vspace)&&setVspace(image,data.vspace),(getBorder(image)||""!==data.border)&&setBorder(image,data.border),(getBorderStyle(image)||""!==data.borderStyle)&&setBorderStyle(image,data.borderStyle),normalizeCss(image.getAttribute("style"))},create=function(normalizeCss,data){var image=document.createElement("img");if(write(normalizeCss,$_kivhlcqjh8lz08x.merge(data,{caption:!1}),image),setAttrib(image,"alt",data.alt),data.caption){var figure=DOM.create("figure",{"class":"image"});return figure.appendChild(image),figure.appendChild(DOM.create("figcaption",{contentEditable:!0},"Caption")),figure.contentEditable="false",figure}return image},read=function(normalizeCss,image){return{src:getAttrib(image,"src"),alt:getAttrib(image,"alt"),title:getAttrib(image,"title"),width:getSize(image,"width"),height:getSize(image,"height"),"class":getAttrib(image,"class"),style:normalizeCss(getAttrib(image,"style")),caption:hasCaption(image),hspace:getHspace(image),vspace:getVspace(image),border:getBorder(image),borderStyle:getStyle(image,"borderStyle")}},updateProp=function(image,oldData,newData,name,set){newData[name]!==oldData[name]&&set(image,name,newData[name])},normalized=function(set,normalizeCss){return function(image,name,value){set(image,value),normalizeStyle(image,normalizeCss)}},write=function(normalizeCss,newData,image){var oldData=read(normalizeCss,image);updateProp(image,oldData,newData,"caption",function(image,_name,_value){return toggleCaption(image)}),updateProp(image,oldData,newData,"src",setAttrib),updateProp(image,oldData,newData,"alt",setAttrib),updateProp(image,oldData,newData,"title",setAttrib),updateProp(image,oldData,newData,"width",setSize("width",normalizeCss)),updateProp(image,oldData,newData,"height",setSize("height",normalizeCss)),updateProp(image,oldData,newData,"class",setAttrib),updateProp(image,oldData,newData,"style",normalized(function(image,value){return setAttrib(image,"style",value)},normalizeCss)),updateProp(image,oldData,newData,"hspace",normalized(setHspace,normalizeCss)),updateProp(image,oldData,newData,"vspace",normalized(setVspace,normalizeCss)),updateProp(image,oldData,newData,"border",normalized(setBorder,normalizeCss)),updateProp(image,oldData,newData,"borderStyle",normalized(setBorderStyle,normalizeCss))},normalizeCss=function(editor,cssText){var css=editor.dom.styles.parse(cssText),mergedCss=$_5m5ooacejh8lz07v.mergeMargins(css),compressed=editor.dom.styles.parse(editor.dom.styles.serialize(mergedCss));return editor.dom.styles.serialize(compressed)},getSelectedImage=function(editor){var imgElm=editor.selection.getNode(),figureElm=editor.dom.getParent(imgElm,"figure.image");return figureElm?editor.dom.select("img",figureElm)[0]:imgElm&&("IMG"!==imgElm.nodeName||imgElm.getAttribute("data-mce-object")||imgElm.getAttribute("data-mce-placeholder"))?null:imgElm},splitTextBlock=function(editor,figure){var dom=editor.dom,textBlock=dom.getParent(figure.parentNode,function(node){return editor.schema.getTextBlockElements()[node.nodeName]});return textBlock?dom.split(textBlock,figure):figure},readImageDataFromSelection=function(editor){var image=getSelectedImage(editor);return image?read(function(css){return normalizeCss(editor,css)},image):defaultData()},insertImageAtCaret=function(editor,data){var elm=create(function(css){return normalizeCss(editor,css)},data);editor.dom.setAttrib(elm,"data-mce-id","__mcenew"),editor.focus(),editor.selection.setContent(elm.outerHTML);var insertedElm=editor.dom.select('*[data-mce-id="__mcenew"]')[0];if(editor.dom.setAttrib(insertedElm,"data-mce-id",null),isFigure(insertedElm)){var figure=splitTextBlock(editor,insertedElm);editor.selection.select(figure)}else editor.selection.select(insertedElm)},syncSrcAttr=function(editor,image){editor.dom.setAttrib(image,"src",image.getAttribute("src"))},deleteImage=function(editor,image){if(image){var elm=editor.dom.is(image.parentNode,"figure.image")?image.parentNode:image;editor.dom.remove(elm),editor.focus(),editor.nodeChanged(),editor.dom.isEmpty(editor.getBody())&&(editor.setContent(""),editor.selection.setCursorLocation())}},writeImageDataToSelection=function(editor,data){var image=getSelectedImage(editor);if(write(function(css){return normalizeCss(editor,css)},data,image),syncSrcAttr(editor,image),isFigure(image.parentNode)){var figure=image.parentNode;splitTextBlock(editor,figure),editor.selection.select(image.parentNode)}else editor.selection.select(image),$_5m5ooacejh8lz07v.waitLoadImage(editor,data,image)},insertOrUpdateImage=function(editor,data){var image=getSelectedImage(editor);image?data.src?writeImageDataToSelection(editor,data):deleteImage(editor,image):data.src&&insertImageAtCaret(editor,data)},updateVSpaceHSpaceBorder=function(editor){return function(evt){var dom=editor.dom,rootControl=evt.control.rootControl;if($_crxcnscdjh8lz07s.hasAdvTab(editor)){var data=rootControl.toJSON(),css=dom.parseStyle(data.style);rootControl.find("#vspace").value(""),rootControl.find("#hspace").value(""),css=$_5m5ooacejh8lz07v.mergeMargins(css),(css["margin-top"]&&css["margin-bottom"]||css["margin-right"]&&css["margin-left"])&&(css["margin-top"]===css["margin-bottom"]?rootControl.find("#vspace").value($_5m5ooacejh8lz07v.removePixelSuffix(css["margin-top"])):rootControl.find("#vspace").value(""),css["margin-right"]===css["margin-left"]?rootControl.find("#hspace").value($_5m5ooacejh8lz07v.removePixelSuffix(css["margin-right"])):rootControl.find("#hspace").value("")),css["border-width"]?rootControl.find("#border").value($_5m5ooacejh8lz07v.removePixelSuffix(css["border-width"])):rootControl.find("#border").value(""),css["border-style"]?rootControl.find("#borderStyle").value(css["border-style"]):rootControl.find("#borderStyle").value(""),rootControl.find("#style").value(dom.serializeStyle(dom.parseStyle(dom.serializeStyle(css))))}}},updateStyle=function(editor,win){win.find("#style").each(function(ctrl){var value=getStyleValue(function(css){return normalizeCss(editor,css)},$_kivhlcqjh8lz08x.merge(defaultData(),win.toJSON()));ctrl.value(value)})},makeTab=function(editor){return{title:"Advanced",type:"form",pack:"start",items:[{label:"Style",name:"style",type:"textbox",onchange:updateVSpaceHSpaceBorder(editor)},{type:"form",layout:"grid",packV:"start",columns:2,padding:0,defaults:{type:"textbox",maxWidth:50,onchange:function(evt){updateStyle(editor,evt.control.rootControl)}},items:[{label:"Vertical space",name:"vspace"},{label:"Border width",name:"border"},{label:"Horizontal space",name:"hspace"},{label:"Border style",type:"listbox",name:"borderStyle",width:90,maxWidth:90,onselect:function(evt){updateStyle(editor,evt.control.rootControl)},values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]}},$_546vuxcmjh8lz08g={makeTab:makeTab},doSyncSize=function(widthCtrl,heightCtrl){widthCtrl.state.set("oldVal",widthCtrl.value()),heightCtrl.state.set("oldVal",heightCtrl.value())},doSizeControls=function(win,f){var widthCtrl=win.find("#width")[0],heightCtrl=win.find("#height")[0],constrained=win.find("#constrain")[0];widthCtrl&&heightCtrl&&constrained&&f(widthCtrl,heightCtrl,constrained.checked())},doUpdateSize=function(widthCtrl,heightCtrl,isContrained){var oldWidth=widthCtrl.state.get("oldVal"),oldHeight=heightCtrl.state.get("oldVal"),newWidth=widthCtrl.value(),newHeight=heightCtrl.value();isContrained&&oldWidth&&oldHeight&&newWidth&&newHeight&&(newWidth!==oldWidth?(newHeight=Math.round(newWidth/oldWidth*newHeight),isNaN(newHeight)||heightCtrl.value(newHeight)):(newWidth=Math.round(newHeight/oldHeight*newWidth),isNaN(newWidth)||widthCtrl.value(newWidth))),doSyncSize(widthCtrl,heightCtrl)},syncSize=function(win){doSizeControls(win,doSyncSize)},updateSize=function(win){doSizeControls(win,doUpdateSize)},createUi=function(){var recalcSize=function(evt){updateSize(evt.control.rootControl)};return{type:"container",label:"Dimensions",layout:"flex",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:5,size:5,onchange:recalcSize,ariaLabel:"Width"},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:5,size:5,onchange:recalcSize,ariaLabel:"Height"},{name:"constrain",type:"checkbox",checked:!0,text:"Constrain proportions"}]}},$_8agebqctjh8lz094={createUi:createUi,syncSize:syncSize,updateSize:updateSize},onSrcChange=function(evt,editor){var srcURL,prependURL,absoluteURLPattern,meta=evt.meta||{},control=evt.control,rootControl=control.rootControl,imageListCtrl=rootControl.find("#image-list")[0];imageListCtrl&&imageListCtrl.value(editor.convertURL(control.value(),"src")),global$3.each(meta,function(value,key){rootControl.find("#"+key).value(value)}),meta.width||meta.height||(srcURL=editor.convertURL(control.value(),"src"),prependURL=$_crxcnscdjh8lz07s.getPrependUrl(editor),absoluteURLPattern=new RegExp("^(?:[a-z]+:)?//","i"),prependURL&&!absoluteURLPattern.test(srcURL)&&srcURL.substring(0,prependURL.length)!==prependURL&&(srcURL=prependURL+srcURL),control.value(srcURL),$_5m5ooacejh8lz07v.getImageSize(editor.documentBaseURI.toAbsolute(control.value()),function(data){data.width&&data.height&&$_crxcnscdjh8lz07s.hasDimensions(editor)&&(rootControl.find("#width").value(data.width),rootControl.find("#height").value(data.height),$_8agebqctjh8lz094.syncSize(rootControl))}))},onBeforeCall=function(evt){evt.meta=evt.control.rootControl.toJSON()},getGeneralItems=function(editor,imageListCtrl){var generalFormItems=[{name:"src",type:"filepicker",filetype:"image",label:"Source",autofocus:!0,onchange:function(evt){onSrcChange(evt,editor)},onbeforecall:onBeforeCall},imageListCtrl];return $_crxcnscdjh8lz07s.hasDescription(editor)&&generalFormItems.push({name:"alt",type:"textbox",label:"Image description"}),$_crxcnscdjh8lz07s.hasImageTitle(editor)&&generalFormItems.push({name:"title",type:"textbox",label:"Image Title"}),$_crxcnscdjh8lz07s.hasDimensions(editor)&&generalFormItems.push($_8agebqctjh8lz094.createUi()),$_crxcnscdjh8lz07s.getClassList(editor)&&generalFormItems.push({name:"class",type:"listbox",label:"Class",values:$_5m5ooacejh8lz07v.buildListItems($_crxcnscdjh8lz07s.getClassList(editor),function(item){item.value&&(item.textStyle=function(){return editor.formatter.getCssText({inline:"img",classes:[item.value]})})})}),$_crxcnscdjh8lz07s.hasImageCaption(editor)&&generalFormItems.push({name:"caption",type:"checkbox",label:"Caption"}),generalFormItems},makeTab$1=function(editor,imageListCtrl){return{title:"General",type:"form",items:getGeneralItems(editor,imageListCtrl)}},$_586d0gcsjh8lz091={makeTab:makeTab$1,getGeneralItems:getGeneralItems},url=function(){return $_8d9gbscgjh8lz089.getOrDie("URL")},createObjectURL=function(blob){return url().createObjectURL(blob)},revokeObjectURL=function(u){url().revokeObjectURL(u)},$_61yp4wcvjh8lz09b={createObjectURL:createObjectURL,revokeObjectURL:revokeObjectURL},global$6=tinymce.util.Tools.resolve("tinymce.ui.Factory"),noop=function(){},pathJoin=function(path1,path2){return path1?path1.replace(/\/$/,"")+"/"+path2.replace(/^\//,""):path2},onFileInput=function(editor){return function(evt){var Throbber=global$6.get("Throbber"),rootControl=evt.control.rootControl,throbber=new Throbber(rootControl.getEl()),file=evt.control.value(),blobUri=$_61yp4wcvjh8lz09b.createObjectURL(file),uploader=Uploader({url:$_crxcnscdjh8lz07s.getUploadUrl(editor),basePath:$_crxcnscdjh8lz07s.getUploadBasePath(editor),credentials:$_crxcnscdjh8lz07s.getUploadCredentials(editor),handler:$_crxcnscdjh8lz07s.getUploadHandler(editor)}),finalize=function(){throbber.hide(),$_61yp4wcvjh8lz09b.revokeObjectURL(blobUri)};return throbber.show(),$_5m5ooacejh8lz07v.blobToDataUri(file).then(function(dataUrl){var blobInfo=editor.editorUpload.blobCache.create({blob:file,blobUri:blobUri,name:file.name?file.name.replace(/\.[^\.]+$/,""):null,base64:dataUrl.split(",")[1]});return uploader.upload(blobInfo).then(function(url){var src=rootControl.find("#src");return src.value(url),rootControl.find("tabpanel")[0].activateTab(0),src.fire("change"),finalize(),url})})["catch"](function(err){editor.windowManager.alert(err),finalize()})}},acceptExts=".jpg,.jpeg,.png,.gif",makeTab$2=function(editor){return{title:"Upload",type:"form",layout:"flex",direction:"column",align:"stretch",padding:"20 20 20 20",items:[{type:"container",layout:"flex",direction:"column",align:"center",spacing:10,items:[{text:"Browse for an image",type:"browsebutton",accept:acceptExts,onchange:onFileInput(editor)},{text:"OR",type:"label"}]},{text:"Drop an image here",type:"dropzone",accept:acceptExts,height:100,onchange:onFileInput(editor)}]}},$_3w774acujh8lz097={makeTab:makeTab$2},noop$1=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i]},noarg=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];
return f()}},compose=function(fa,fb){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return fa(fb.apply(null,arguments))}},constant=function(value){return function(){return value}},identity=function(x){return x},tripleEquals=function(a,b){return a===b},curry=function(f){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];for(var args=new Array(arguments.length-1),i=1;i<arguments.length;i++)args[i-1]=arguments[i];return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];for(var newArgs=new Array(arguments.length),j=0;j<newArgs.length;j++)newArgs[j]=arguments[j];var all=args.concat(newArgs);return f.apply(null,all)}},not=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return!f.apply(null,arguments)}},die=function(msg){return function(){throw new Error(msg)}},apply=function(f){return f()},call=function(f){f()},never=constant(!1),always=constant(!0),$_8rhdleczjh8lz09i={noop:noop$1,noarg:noarg,compose:compose,constant:constant,identity:identity,tripleEquals:tripleEquals,curry:curry,not:not,die:die,apply:apply,call:call,never:never,always:always},submitForm=function(editor,evt){var win=evt.control.getRoot();$_8agebqctjh8lz094.updateSize(win),editor.undoManager.transact(function(){var data=$_kivhlcqjh8lz08x.merge(readImageDataFromSelection(editor),win.toJSON());insertOrUpdateImage(editor,data)}),editor.editorUpload.uploadImagesAuto()},register=function(editor){editor.addCommand("mceImage",Dialog(editor).open)},$_4g83a6cbjh8lz07k={register:register},hasImageClass=function(node){var className=node.attr("class");return className&&/\bimage\b/.test(className)},toggleContentEditableState=function(state){return function(nodes){for(var node,i=nodes.length,toggleContentEditable=function(node){node.attr("contenteditable",state?"true":null)};i--;)node=nodes[i],hasImageClass(node)&&(node.attr("contenteditable",state?"false":null),global$3.each(node.getAll("figcaption"),toggleContentEditable))}},setup=function(editor){editor.on("preInit",function(){editor.parser.addNodeFilter("figure",toggleContentEditableState(!0)),editor.serializer.addNodeFilter("figure",toggleContentEditableState(!1))})},$_1om65pd0jh8lz09k={setup:setup},register$1=function(editor){editor.addButton("image",{icon:"image",tooltip:"Insert/edit image",onclick:Dialog(editor).open,stateSelector:"img:not([data-mce-object],[data-mce-placeholder]),figure.image"}),editor.addMenuItem("image",{icon:"image",text:"Image",onclick:Dialog(editor).open,context:"insert",prependToContext:!0})},$_df3mmtd1jh8lz09m={register:register$1};return global.add("image",function(editor){$_1om65pd0jh8lz09k.setup(editor),$_df3mmtd1jh8lz09m.register(editor),$_4g83a6cbjh8lz07k.register(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-importcss",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$2=tinymce.util.Tools.resolve("tinymce.EditorManager"),global$3=tinymce.util.Tools.resolve("tinymce.Env"),global$4=tinymce.util.Tools.resolve("tinymce.util.Tools"),shouldMergeClasses=function(editor){return editor.getParam("importcss_merge_classes")},shouldImportExclusive=function(editor){return editor.getParam("importcss_exclusive")},getSelectorConverter=function(editor){return editor.getParam("importcss_selector_converter")},getSelectorFilter=function(editor){return editor.getParam("importcss_selector_filter")},getCssGroups=function(editor){return editor.getParam("importcss_groups")},shouldAppend=function(editor){return editor.getParam("importcss_append")},getFileFilter=function(editor){return editor.getParam("importcss_file_filter")},$_988pjferjh8lz0nn={shouldMergeClasses:shouldMergeClasses,shouldImportExclusive:shouldImportExclusive,getSelectorConverter:getSelectorConverter,getSelectorFilter:getSelectorFilter,getCssGroups:getCssGroups,shouldAppend:shouldAppend,getFileFilter:getFileFilter},removeCacheSuffix=function(url){var cacheSuffix=global$3.cacheSuffix;return"string"==typeof url&&(url=url.replace("?"+cacheSuffix,"").replace("&"+cacheSuffix,"")),url},isSkinContentCss=function(editor,href){var settings=editor.settings,skin=settings.skin!==!1&&(settings.skin||"lightgray");if(skin){var skinUrl=settings.skin_url?editor.documentBaseURI.toAbsolute(settings.skin_url):global$2.baseURL+"/skins/"+skin;return href===skinUrl+"/content"+(editor.inline?".inline":"")+".min.css"}return!1},compileFilter=function(filter){return"string"==typeof filter?function(value){return value.indexOf(filter)!==-1}:filter instanceof RegExp?function(value){return filter.test(value)}:filter},getSelectors=function(editor,doc,fileFilter){function append(styleSheet,imported){var rules,href=styleSheet.href;if(href=removeCacheSuffix(href),href&&fileFilter(href,imported)&&!isSkinContentCss(editor,href)){global$4.each(styleSheet.imports,function(styleSheet){append(styleSheet,!0)});try{rules=styleSheet.cssRules||styleSheet.rules}catch(e){}global$4.each(rules,function(cssRule){cssRule.styleSheet?append(cssRule.styleSheet,!0):cssRule.selectorText&&global$4.each(cssRule.selectorText.split(","),function(selector){selectors.push(global$4.trim(selector))})})}}var selectors=[],contentCSSUrls={};global$4.each(editor.contentCSS,function(url){contentCSSUrls[url]=!0}),fileFilter||(fileFilter=function(href,imported){return imported||contentCSSUrls[href]});try{global$4.each(doc.styleSheets,function(styleSheet){append(styleSheet)})}catch(e){}return selectors},defaultConvertSelectorToFormat=function(editor,selectorText){var format,selector=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(selectorText);if(selector){var elementName=selector[1],classes=selector[2].substr(1).split(".").join(" "),inlineSelectorElements=global$4.makeMap("a,img");return selector[1]?(format={title:selectorText},editor.schema.getTextBlockElements()[elementName]?format.block=elementName:editor.schema.getBlockElements()[elementName]||inlineSelectorElements[elementName.toLowerCase()]?format.selector=elementName:format.inline=elementName):selector[2]&&(format={inline:"span",title:selectorText.substr(1),classes:classes}),$_988pjferjh8lz0nn.shouldMergeClasses(editor)!==!1?format.classes=classes:format.attributes={"class":classes},format}},getGroupsBySelector=function(groups,selector){return global$4.grep(groups,function(group){return!group.filter||group.filter(selector)})},compileUserDefinedGroups=function(groups){return global$4.map(groups,function(group){return global$4.extend({},group,{original:group,selectors:{},filter:compileFilter(group.filter),item:{text:group.title,menu:[]}})})},isExclusiveMode=function(editor,group){return null===group||$_988pjferjh8lz0nn.shouldImportExclusive(editor)!==!1},isUniqueSelector=function(editor,selector,group,globallyUniqueSelectors){return!(isExclusiveMode(editor,group)?selector in globallyUniqueSelectors:selector in group.selectors)},markUniqueSelector=function(editor,selector,group,globallyUniqueSelectors){isExclusiveMode(editor,group)?globallyUniqueSelectors[selector]=!0:group.selectors[selector]=!0},convertSelectorToFormat=function(editor,plugin,selector,group){var selectorConverter;return selectorConverter=group&&group.selector_converter?group.selector_converter:$_988pjferjh8lz0nn.getSelectorConverter(editor)?$_988pjferjh8lz0nn.getSelectorConverter(editor):function(){return defaultConvertSelectorToFormat(editor,selector)},selectorConverter.call(plugin,selector,group)},setup=function(editor){editor.on("renderFormatsMenu",function(e){var globallyUniqueSelectors={},selectorFilter=compileFilter($_988pjferjh8lz0nn.getSelectorFilter(editor)),ctrl=e.control,groups=compileUserDefinedGroups($_988pjferjh8lz0nn.getCssGroups(editor)),processSelector=function(selector,group){if(isUniqueSelector(editor,selector,group,globallyUniqueSelectors)){markUniqueSelector(editor,selector,group,globallyUniqueSelectors);var format=convertSelectorToFormat(editor,editor.plugins.importcss,selector,group);if(format){var formatName=format.name||global$1.DOM.uniqueId();return editor.formatter.register(formatName,format),global$4.extend({},ctrl.settings.itemDefaults,{text:format.title,format:formatName})}}return null};$_988pjferjh8lz0nn.shouldAppend(editor)||ctrl.items().remove(),global$4.each(getSelectors(editor,e.doc||editor.getDoc(),compileFilter($_988pjferjh8lz0nn.getFileFilter(editor))),function(selector){if(selector.indexOf(".mce-")===-1&&(!selectorFilter||selectorFilter(selector))){var selectorGroups=getGroupsBySelector(groups,selector);if(selectorGroups.length>0)global$4.each(selectorGroups,function(group){var menuItem=processSelector(selector,group);menuItem&&group.item.menu.push(menuItem)});else{var menuItem=processSelector(selector,null);menuItem&&ctrl.add(menuItem)}}}),global$4.each(groups,function(group){group.item.menu.length>0&&ctrl.add(group.item)}),e.control.renderNew()})},$_82ojngemjh8lz0ng={defaultConvertSelectorToFormat:defaultConvertSelectorToFormat,setup:setup},get=function(editor){var convertSelectorToFormat=function(selectorText){return $_82ojngemjh8lz0ng.defaultConvertSelectorToFormat(editor,selectorText)};return{convertSelectorToFormat:convertSelectorToFormat}},$_9svv1eeljh8lz0ne={get:get};return global.add("importcss",function(editor){return $_82ojngemjh8lz0ng.setup(editor),$_9svv1eeljh8lz0ne.get(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-insertdatetime",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),getDateFormat=function(editor){return editor.getParam("insertdatetime_dateformat",editor.translate("%Y-%m-%d"))},getTimeFormat=function(editor){return editor.getParam("insertdatetime_timeformat",editor.translate("%H:%M:%S"))},getFormats=function(editor){return editor.getParam("insertdatetime_formats",["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"])},getDefaultDateTime=function(editor){var formats=getFormats(editor);return formats.length>0?formats[0]:getTimeFormat(editor)},shouldInsertTimeElement=function(editor){return editor.getParam("insertdatetime_element",!1)},$_dx1d2uewjh8lz0ob={getDateFormat:getDateFormat,getTimeFormat:getTimeFormat,getFormats:getFormats,getDefaultDateTime:getDefaultDateTime,shouldInsertTimeElement:shouldInsertTimeElement},daysShort="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),daysLong="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),monthsLong="January February March April May June July August September October November December".split(" "),addZeros=function(value,len){if(value=""+value,value.length<len)for(var i=0;i<len-value.length;i++)value="0"+value;return value},getDateTime=function(editor,fmt,date){return date=date||new Date,fmt=fmt.replace("%D","%m/%d/%Y"),fmt=fmt.replace("%r","%I:%M:%S %p"),fmt=fmt.replace("%Y",""+date.getFullYear()),fmt=fmt.replace("%y",""+date.getYear()),fmt=fmt.replace("%m",addZeros(date.getMonth()+1,2)),fmt=fmt.replace("%d",addZeros(date.getDate(),2)),fmt=fmt.replace("%H",""+addZeros(date.getHours(),2)),fmt=fmt.replace("%M",""+addZeros(date.getMinutes(),2)),fmt=fmt.replace("%S",""+addZeros(date.getSeconds(),2)),fmt=fmt.replace("%I",""+((date.getHours()+11)%12+1)),fmt=fmt.replace("%p",""+(date.getHours()<12?"AM":"PM")),fmt=fmt.replace("%B",""+editor.translate(monthsLong[date.getMonth()])),fmt=fmt.replace("%b",""+editor.translate(monthsShort[date.getMonth()])),fmt=fmt.replace("%A",""+editor.translate(daysLong[date.getDay()])),fmt=fmt.replace("%a",""+editor.translate(daysShort[date.getDay()])),fmt=fmt.replace("%%","%")},updateElement=function(editor,timeElm,computerTime,userTime){var newTimeElm=editor.dom.create("time",{datetime:computerTime},userTime);timeElm.parentNode.insertBefore(newTimeElm,timeElm),editor.dom.remove(timeElm),editor.selection.select(newTimeElm,!0),editor.selection.collapse(!1)},insertDateTime=function(editor,format){if($_dx1d2uewjh8lz0ob.shouldInsertTimeElement(editor)){var userTime=getDateTime(editor,format),computerTime=void 0;computerTime=/%[HMSIp]/.test(format)?getDateTime(editor,"%Y-%m-%dT%H:%M"):getDateTime(editor,"%Y-%m-%d");var timeElm=editor.dom.getParent(editor.selection.getStart(),"time");timeElm?updateElement(editor,timeElm,computerTime,userTime):editor.insertContent('<time datetime="'+computerTime+'">'+userTime+"</time>")}else editor.insertContent(getDateTime(editor,format))},$_6jlqe7exjh8lz0oc={insertDateTime:insertDateTime,getDateTime:getDateTime},register=function(editor){editor.addCommand("mceInsertDate",function(){$_6jlqe7exjh8lz0oc.insertDateTime(editor,$_dx1d2uewjh8lz0ob.getDateFormat(editor))}),editor.addCommand("mceInsertTime",function(){$_6jlqe7exjh8lz0oc.insertDateTime(editor,$_dx1d2uewjh8lz0ob.getTimeFormat(editor))})},$_asxg6pevjh8lz0oa={register:register},global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),createMenuItems=function(editor,lastFormatState){var formats=$_dx1d2uewjh8lz0ob.getFormats(editor);return global$1.map(formats,function(fmt){return{text:$_6jlqe7exjh8lz0oc.getDateTime(editor,fmt),onclick:function(){lastFormatState.set(fmt),$_6jlqe7exjh8lz0oc.insertDateTime(editor,fmt)}}})},register$1=function(editor,lastFormatState){var menuItems=createMenuItems(editor,lastFormatState);editor.addButton("insertdatetime",{type:"splitbutton",title:"Insert date/time",menu:menuItems,onclick:function(){var lastFormat=lastFormatState.get();$_6jlqe7exjh8lz0oc.insertDateTime(editor,lastFormat?lastFormat:$_dx1d2uewjh8lz0ob.getDefaultDateTime(editor))}}),editor.addMenuItem("insertdatetime",{icon:"date",text:"Date/time",menu:menuItems,context:"insert"})},$_3qv4wheyjh8lz0of={register:register$1};return global.add("insertdatetime",function(editor){var lastFormatState=Cell(null);$_asxg6pevjh8lz0oa.register(editor),$_3qv4wheyjh8lz0of.register(editor,lastFormatState)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-legacyoutput",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),overrideFormats=function(editor){var alignElements="p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img",fontSizes=global$1.explode(editor.settings.font_size_style_values),schema=editor.schema;editor.formatter.register({alignleft:{selector:alignElements,attributes:{align:"left"}},aligncenter:{selector:alignElements,attributes:{align:"center"}},alignright:{selector:alignElements,attributes:{align:"right"}},alignjustify:{selector:alignElements,attributes:{align:"justify"}},bold:[{inline:"b",remove:"all"},{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}}],italic:[{inline:"i",remove:"all"},{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}}],underline:[{inline:"u",remove:"all"},{inline:"span",styles:{textDecoration:"underline"},exact:!0}],strikethrough:[{inline:"strike",remove:"all"},{inline:"span",styles:{textDecoration:"line-through"},exact:!0}],fontname:{inline:"font",attributes:{face:"%value"}},fontsize:{inline:"font",attributes:{size:function(vars){return global$1.inArray(fontSizes,vars.value)+1}}},forecolor:{inline:"font",attributes:{color:"%value"}},hilitecolor:{inline:"font",styles:{backgroundColor:"%value"}}}),global$1.each("b,i,u,strike".split(","),function(name){schema.addValidElements(name+"[*]")}),schema.getElementRule("font")||schema.addValidElements("font[face|size|color|style]"),global$1.each(alignElements.split(","),function(name){var rule=schema.getElementRule(name);rule&&(rule.attributes.align||(rule.attributes.align={},rule.attributesOrder.push("align")))})},setup=function(editor){editor.settings.inline_styles=!1,editor.on("init",function(){overrideFormats(editor)})},$_1u3icsf2jh8lz0ov={setup:setup},register=function(editor){editor.addButton("fontsizeselect",function(){var items=[],defaultFontsizeFormats="8pt=1 10pt=2 12pt=3 14pt=4 18pt=5 24pt=6 36pt=7",fontsizeFormats=editor.settings.fontsizeFormats||defaultFontsizeFormats;return editor.$.each(fontsizeFormats.split(" "),function(i,item){var text=item,value=item,values=item.split("=");values.length>1&&(text=values[0],value=values[1]),items.push({text:text,value:value})}),{type:"listbox",text:"Font Sizes",tooltip:"Font Sizes",values:items,fixedWidth:!0,onPostRender:function(){var self=this;editor.on("NodeChange",function(){var fontElm;fontElm=editor.dom.getParent(editor.selection.getNode(),"font"),fontElm?self.value(fontElm.size):self.value("")})},onclick:function(e){e.control.settings.value&&editor.execCommand("FontSize",!1,e.control.settings.value)}}}),editor.addButton("fontselect",function(){function createFormats(formats){formats=formats.replace(/;$/,"").split(";");for(var i=formats.length;i--;)formats[i]=formats[i].split("=");return formats}var defaultFontsFormats="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",items=[],fonts=createFormats(editor.settings.font_formats||defaultFontsFormats);return editor.$.each(fonts,function(i,font){items.push({text:{raw:font[0]},value:font[1],textStyle:font[1].indexOf("dings")===-1?"font-family:"+font[1]:""})}),{type:"listbox",text:"Font Family",tooltip:"Font Family",values:items,fixedWidth:!0,onPostRender:function(){var self=this;editor.on("NodeChange",function(){var fontElm;fontElm=editor.dom.getParent(editor.selection.getNode(),"font"),fontElm?self.value(fontElm.face):self.value("")})},onselect:function(e){e.control.settings.value&&editor.execCommand("FontName",!1,e.control.settings.value)}}})},$_qhv2kf4jh8lz0oy={register:register};return global.add("legacyoutput",function(editor){$_1u3icsf2jh8lz0ov.setup(editor),$_qhv2kf4jh8lz0oy.register(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-link",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.VK"),assumeExternalTargets=function(editorSettings){return"boolean"==typeof editorSettings.link_assume_external_targets&&editorSettings.link_assume_external_targets},hasContextToolbar=function(editorSettings){return"boolean"==typeof editorSettings.link_context_toolbar&&editorSettings.link_context_toolbar},getLinkList=function(editorSettings){return editorSettings.link_list},hasDefaultLinkTarget=function(editorSettings){return"string"==typeof editorSettings.default_link_target},getDefaultLinkTarget=function(editorSettings){return editorSettings.default_link_target},getTargetList=function(editorSettings){return editorSettings.target_list},setTargetList=function(editor,list){editor.settings.target_list=list},shouldShowTargetList=function(editorSettings){return getTargetList(editorSettings)!==!1},getRelList=function(editorSettings){return editorSettings.rel_list},hasRelList=function(editorSettings){return void 0!==getRelList(editorSettings)},getLinkClassList=function(editorSettings){return editorSettings.link_class_list},hasLinkClassList=function(editorSettings){return void 0!==getLinkClassList(editorSettings)},shouldShowLinkTitle=function(editorSettings){return editorSettings.link_title!==!1},allowUnsafeLinkTarget=function(editorSettings){return"boolean"==typeof editorSettings.allow_unsafe_link_target&&editorSettings.allow_unsafe_link_target},$_4854y3fajh8lz0pg={assumeExternalTargets:assumeExternalTargets,hasContextToolbar:hasContextToolbar,getLinkList:getLinkList,hasDefaultLinkTarget:hasDefaultLinkTarget,getDefaultLinkTarget:getDefaultLinkTarget,getTargetList:getTargetList,setTargetList:setTargetList,shouldShowTargetList:shouldShowTargetList,getRelList:getRelList,hasRelList:hasRelList,getLinkClassList:getLinkClassList,hasLinkClassList:hasLinkClassList,shouldShowLinkTitle:shouldShowLinkTitle,allowUnsafeLinkTarget:allowUnsafeLinkTarget},global$2=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$3=tinymce.util.Tools.resolve("tinymce.Env"),appendClickRemove=function(link,evt){document.body.appendChild(link),link.dispatchEvent(evt),document.body.removeChild(link)},open=function(url){if(!global$3.ie||global$3.ie>10){var link=document.createElement("a");link.target="_blank",link.href=url,link.rel="noreferrer noopener";var evt=document.createEvent("MouseEvents");evt.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),appendClickRemove(link,evt)}else{var win=window.open("","_blank");if(win){win.opener=null;var doc=win.document;doc.open(),doc.write('<meta http-equiv="refresh" content="0; url='+global$2.DOM.encode(url)+'">'),doc.close()}}},$_1rtozzfbjh8lz0po={open:open},global$4=tinymce.util.Tools.resolve("tinymce.util.Tools"),toggleTargetRules=function(rel,isUnsafe){var rules=["noopener"],newRel=rel?rel.split(/\s+/):[],toString=function(rel){return global$4.trim(rel.sort().join(" "))},addTargetRules=function(rel){return rel=removeTargetRules(rel),rel.length?rel.concat(rules):rules},removeTargetRules=function(rel){return rel.filter(function(val){return global$4.inArray(rules,val)===-1})};return newRel=isUnsafe?addTargetRules(newRel):removeTargetRules(newRel),newRel.length?toString(newRel):null},trimCaretContainers=function(text){return text.replace(/\uFEFF/g,"")},getAnchorElement=function(editor,selectedElm){return selectedElm=selectedElm||editor.selection.getNode(),isImageFigure(selectedElm)?editor.dom.select("a[href]",selectedElm)[0]:editor.dom.getParent(selectedElm,"a[href]")},getAnchorText=function(selection,anchorElm){var text=anchorElm?anchorElm.innerText||anchorElm.textContent:selection.getContent({format:"text"});return trimCaretContainers(text)},isLink=function(elm){return elm&&"A"===elm.nodeName&&elm.href},hasLinks=function(elements){return global$4.grep(elements,isLink).length>0},isOnlyTextSelected=function(html){return!(/</.test(html)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(html)||html.indexOf("href=")===-1))},isImageFigure=function(node){return node&&"FIGURE"===node.nodeName&&/\bimage\b/i.test(node.className)},link=function(editor,attachState){return function(data){editor.undoManager.transact(function(){var selectedElm=editor.selection.getNode(),anchorElm=getAnchorElement(editor,selectedElm),linkAttrs={href:data.href,target:data.target?data.target:null,rel:data.rel?data.rel:null,"class":data["class"]?data["class"]:null,title:data.title?data.title:null};$_4854y3fajh8lz0pg.hasRelList(editor.settings)||$_4854y3fajh8lz0pg.allowUnsafeLinkTarget(editor.settings)!==!1||(linkAttrs.rel=toggleTargetRules(linkAttrs.rel,"_blank"===linkAttrs.target)),data.href===attachState.href&&(attachState.attach(),attachState={}),anchorElm?(editor.focus(),data.hasOwnProperty("text")&&("innerText"in anchorElm?anchorElm.innerText=data.text:anchorElm.textContent=data.text),editor.dom.setAttribs(anchorElm,linkAttrs),editor.selection.select(anchorElm),editor.undoManager.add()):isImageFigure(selectedElm)?linkImageFigure(editor,selectedElm,linkAttrs):data.hasOwnProperty("text")?editor.insertContent(editor.dom.createHTML("a",linkAttrs,editor.dom.encode(data.text))):editor.execCommand("mceInsertLink",!1,linkAttrs)})}},unlink=function(editor){return function(){editor.undoManager.transact(function(){var node=editor.selection.getNode();isImageFigure(node)?unlinkImageFigure(editor,node):editor.execCommand("unlink")})}},unlinkImageFigure=function(editor,fig){var a,img;img=editor.dom.select("img",fig)[0],img&&(a=editor.dom.getParents(img,"a[href]",fig)[0],a&&(a.parentNode.insertBefore(img,a),editor.dom.remove(a)))},linkImageFigure=function(editor,fig,attrs){var a,img;img=editor.dom.select("img",fig)[0],img&&(a=editor.dom.create("a",attrs),img.parentNode.insertBefore(a,img),a.appendChild(img))},$_542aayfejh8lz0pr={link:link,unlink:unlink,isLink:isLink,hasLinks:hasLinks,isOnlyTextSelected:isOnlyTextSelected,getAnchorElement:getAnchorElement,getAnchorText:getAnchorText,toggleTargetRules:toggleTargetRules},global$5=tinymce.util.Tools.resolve("tinymce.util.Delay"),global$6=tinymce.util.Tools.resolve("tinymce.util.XHR"),attachState={},createLinkList=function(editor,callback){var linkList=$_4854y3fajh8lz0pg.getLinkList(editor.settings);"string"==typeof linkList?global$6.send({url:linkList,success:function(text){callback(editor,JSON.parse(text))}}):"function"==typeof linkList?linkList(function(list){callback(editor,list)}):callback(editor,linkList)},buildListItems=function(inputList,itemCallback,startItems){var appendItems=function(values,output){return output=output||[],global$4.each(values,function(item){var menuItem={text:item.text||item.title};item.menu?menuItem.menu=appendItems(item.menu):(menuItem.value=item.value,itemCallback&&itemCallback(menuItem)),output.push(menuItem)}),output};return appendItems(inputList,startItems||[])},delayedConfirm=function(editor,message,callback){var rng=editor.selection.getRng();global$5.setEditorTimeout(editor,function(){editor.windowManager.confirm(message,function(state){editor.selection.setRng(rng),callback(state)})})},showDialog=function(editor,linkList){var anchorElm,initialText,win,onlyText,textListCtrl,linkListCtrl,relListCtrl,targetListCtrl,classListCtrl,linkTitleCtrl,value,data={},selection=editor.selection,dom=editor.dom,linkListChangeHandler=function(e){var textCtrl=win.find("#text");(!textCtrl.value()||e.lastControl&&textCtrl.value()===e.lastControl.text())&&textCtrl.value(e.control.text()),win.find("#href").value(e.control.value())},buildAnchorListControl=function(url){var anchorList=[];if(global$4.each(editor.dom.select("a:not([href])"),function(anchor){var id=anchor.name||anchor.id;id&&anchorList.push({text:id,value:"#"+id,selected:url.indexOf("#"+id)!==-1})}),anchorList.length)return anchorList.unshift({text:"None",value:""}),{name:"anchor",type:"listbox",label:"Anchors",values:anchorList,onselect:linkListChangeHandler}},updateText=function(){initialText||!onlyText||data.text||this.parent().parent().find("#text")[0].value(this.value())},urlChange=function(e){var meta=e.meta||{};linkListCtrl&&linkListCtrl.value(editor.convertURL(this.value(),"href")),global$4.each(e.meta,function(value,key){var inp=win.find("#"+key);"text"===key?0===initialText.length&&(inp.value(value),data.text=value):inp.value(value)}),meta.attach&&(attachState={href:this.value(),attach:meta.attach}),meta.text||updateText.call(this)},onBeforeCall=function(e){e.meta=win.toJSON()};onlyText=$_542aayfejh8lz0pr.isOnlyTextSelected(selection.getContent()),anchorElm=$_542aayfejh8lz0pr.getAnchorElement(editor),data.text=initialText=$_542aayfejh8lz0pr.getAnchorText(editor.selection,anchorElm),data.href=anchorElm?dom.getAttrib(anchorElm,"href"):"",anchorElm?data.target=dom.getAttrib(anchorElm,"target"):$_4854y3fajh8lz0pg.hasDefaultLinkTarget(editor.settings)&&(data.target=$_4854y3fajh8lz0pg.getDefaultLinkTarget(editor.settings)),(value=dom.getAttrib(anchorElm,"rel"))&&(data.rel=value),(value=dom.getAttrib(anchorElm,"class"))&&(data["class"]=value),(value=dom.getAttrib(anchorElm,"title"))&&(data.title=value),onlyText&&(textListCtrl={name:"text",type:"textbox",size:40,label:"Text to display",onchange:function(){data.text=this.value()}}),linkList&&(linkListCtrl={type:"listbox",label:"Link list",values:buildListItems(linkList,function(item){item.value=editor.convertURL(item.value||item.url,"href")},[{text:"None",value:""}]),onselect:linkListChangeHandler,value:editor.convertURL(data.href,"href"),onPostRender:function(){linkListCtrl=this}}),$_4854y3fajh8lz0pg.shouldShowTargetList(editor.settings)&&(void 0===$_4854y3fajh8lz0pg.getTargetList(editor.settings)&&$_4854y3fajh8lz0pg.setTargetList(editor,[{text:"None",value:""},{text:"New window",value:"_blank"}]),targetListCtrl={name:"target",type:"listbox",label:"Target",values:buildListItems($_4854y3fajh8lz0pg.getTargetList(editor.settings))}),$_4854y3fajh8lz0pg.hasRelList(editor.settings)&&(relListCtrl={name:"rel",type:"listbox",label:"Rel",values:buildListItems($_4854y3fajh8lz0pg.getRelList(editor.settings),function(item){$_4854y3fajh8lz0pg.allowUnsafeLinkTarget(editor.settings)===!1&&(item.value=$_542aayfejh8lz0pr.toggleTargetRules(item.value,"_blank"===data.target))})}),$_4854y3fajh8lz0pg.hasLinkClassList(editor.settings)&&(classListCtrl={name:"class",type:"listbox",label:"Class",values:buildListItems($_4854y3fajh8lz0pg.getLinkClassList(editor.settings),function(item){item.value&&(item.textStyle=function(){return editor.formatter.getCssText({inline:"a",classes:[item.value]})})})}),$_4854y3fajh8lz0pg.shouldShowLinkTitle(editor.settings)&&(linkTitleCtrl={name:"title",type:"textbox",label:"Title",value:data.title}),win=editor.windowManager.open({title:"Insert link",data:data,body:[{name:"href",type:"filepicker",filetype:"file",size:40,autofocus:!0,label:"Url",onchange:urlChange,onkeyup:updateText,onpaste:updateText,onbeforecall:onBeforeCall},textListCtrl,linkTitleCtrl,buildAnchorListControl(data.href),linkListCtrl,relListCtrl,targetListCtrl,classListCtrl],onSubmit:function(e){var assumeExternalTargets=$_4854y3fajh8lz0pg.assumeExternalTargets(editor.settings),insertLink=$_542aayfejh8lz0pr.link(editor,attachState),removeLink=$_542aayfejh8lz0pr.unlink(editor),resultData=global$4.extend({},data,e.data),href=resultData.href;return href?(onlyText&&resultData.text!==initialText||delete resultData.text,href.indexOf("@")>0&&href.indexOf("//")===-1&&href.indexOf("mailto:")===-1?void delayedConfirm(editor,"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",function(state){state&&(resultData.href="mailto:"+href),insertLink(resultData)}):assumeExternalTargets===!0&&!/^\w+:/i.test(href)||assumeExternalTargets===!1&&/^\s*www[\.|\d\.]/i.test(href)?void delayedConfirm(editor,"The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",function(state){state&&(resultData.href="http://"+href),insertLink(resultData)}):void insertLink(resultData)):void removeLink()}})},open$1=function(editor){createLinkList(editor,showDialog)},$_bsp827fgjh8lz0pw={open:open$1},getLink=function(editor,elm){return editor.dom.getParent(elm,"a[href]")},getSelectedLink=function(editor){return getLink(editor,editor.selection.getStart())},getHref=function(elm){var href=elm.getAttribute("data-mce-href");return href?href:elm.getAttribute("href")},isContextMenuVisible=function(editor){var contextmenu=editor.plugins.contextmenu;return!!contextmenu&&contextmenu.isContextMenuVisible()},hasOnlyAltModifier=function(e){return e.altKey===!0&&e.shiftKey===!1&&e.ctrlKey===!1&&e.metaKey===!1},gotoLink=function(editor,a){if(a){var href=getHref(a);if(/^#/.test(href)){var targetEl=editor.$(href);targetEl.length&&editor.selection.scrollIntoView(targetEl[0],!0)}else $_1rtozzfbjh8lz0po.open(a.href)}},openDialog=function(editor){return function(){$_bsp827fgjh8lz0pw.open(editor)}},gotoSelectedLink=function(editor){return function(){gotoLink(editor,getSelectedLink(editor))}},leftClickedOnAHref=function(editor){return function(elm){var sel,rng,node;return!!($_4854y3fajh8lz0pg.hasContextToolbar(editor.settings)&&!isContextMenuVisible(editor)&&$_542aayfejh8lz0pr.isLink(elm)&&(sel=editor.selection,rng=sel.getRng(),
node=rng.startContainer,3===node.nodeType&&sel.isCollapsed()&&rng.startOffset>0&&rng.startOffset<node.data.length))}},setupGotoLinks=function(editor){editor.on("click",function(e){var link=getLink(editor,e.target);link&&global$1.metaKeyPressed(e)&&(e.preventDefault(),gotoLink(editor,link))}),editor.on("keydown",function(e){var link=getSelectedLink(editor);link&&13===e.keyCode&&hasOnlyAltModifier(e)&&(e.preventDefault(),gotoLink(editor,link))})},toggleActiveState=function(editor){return function(){var self=this;editor.on("nodechange",function(e){self.active(!editor.readonly&&!!$_542aayfejh8lz0pr.getAnchorElement(editor,e.element))})}},toggleViewLinkState=function(editor){return function(){var self=this,toggleVisibility=function(e){$_542aayfejh8lz0pr.hasLinks(e.parents)?self.show():self.hide()};$_542aayfejh8lz0pr.hasLinks(editor.dom.getParents(editor.selection.getStart()))||self.hide(),editor.on("nodechange",toggleVisibility),self.on("remove",function(){editor.off("nodechange",toggleVisibility)})}},$_8d8mxaf8jh8lz0pd={openDialog:openDialog,gotoSelectedLink:gotoSelectedLink,leftClickedOnAHref:leftClickedOnAHref,setupGotoLinks:setupGotoLinks,toggleActiveState:toggleActiveState,toggleViewLinkState:toggleViewLinkState},register=function(editor){editor.addCommand("mceLink",$_8d8mxaf8jh8lz0pd.openDialog(editor))},$_3527iyf7jh8lz0pb={register:register},setup=function(editor){editor.addShortcut("Meta+K","",$_8d8mxaf8jh8lz0pd.openDialog(editor))},$_fpyya7fjjh8lz0q4={setup:setup},setupButtons=function(editor){editor.addButton("link",{active:!1,icon:"link",tooltip:"Insert/edit link",onclick:$_8d8mxaf8jh8lz0pd.openDialog(editor),onpostrender:$_8d8mxaf8jh8lz0pd.toggleActiveState(editor)}),editor.addButton("unlink",{active:!1,icon:"unlink",tooltip:"Remove link",onclick:$_542aayfejh8lz0pr.unlink(editor),onpostrender:$_8d8mxaf8jh8lz0pd.toggleActiveState(editor)}),editor.addContextToolbar&&editor.addButton("openlink",{icon:"newtab",tooltip:"Open link",onclick:$_8d8mxaf8jh8lz0pd.gotoSelectedLink(editor)})},setupMenuItems=function(editor){editor.addMenuItem("openlink",{text:"Open link",icon:"newtab",onclick:$_8d8mxaf8jh8lz0pd.gotoSelectedLink(editor),onPostRender:$_8d8mxaf8jh8lz0pd.toggleViewLinkState(editor),prependToContext:!0}),editor.addMenuItem("link",{icon:"link",text:"Link",shortcut:"Meta+K",onclick:$_8d8mxaf8jh8lz0pd.openDialog(editor),stateSelector:"a[href]",context:"insert",prependToContext:!0}),editor.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onclick:$_542aayfejh8lz0pr.unlink(editor),stateSelector:"a[href]"})},setupContextToolbars=function(editor){editor.addContextToolbar&&editor.addContextToolbar($_8d8mxaf8jh8lz0pd.leftClickedOnAHref(editor),"openlink | link unlink")},$_f27siffkjh8lz0q5={setupButtons:setupButtons,setupMenuItems:setupMenuItems,setupContextToolbars:setupContextToolbars};return global.add("link",function(editor){$_f27siffkjh8lz0q5.setupButtons(editor),$_f27siffkjh8lz0q5.setupMenuItems(editor),$_f27siffkjh8lz0q5.setupContextToolbars(editor),$_8d8mxaf8jh8lz0pd.setupGotoLinks(editor),$_3527iyf7jh8lz0pb.register(editor),$_fpyya7fjjh8lz0q4.setup(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-lists",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),global$2=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),global$3=tinymce.util.Tools.resolve("tinymce.util.VK"),global$4=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),global$5=tinymce.util.Tools.resolve("tinymce.util.Tools"),global$6=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),isTextNode=function(node){return node&&3===node.nodeType},isListNode=function(node){return node&&/^(OL|UL|DL)$/.test(node.nodeName)},isListItemNode=function(node){return node&&/^(LI|DT|DD)$/.test(node.nodeName)},isTableCellNode=function(node){return node&&/^(TH|TD)$/.test(node.nodeName)},isBr=function(node){return node&&"BR"===node.nodeName},isFirstChild=function(node){return node.parentNode.firstChild===node},isLastChild=function(node){return node.parentNode.lastChild===node},isTextBlock=function(editor,node){return node&&!!editor.schema.getTextBlockElements()[node.nodeName]},isBlock=function(node,blockElements){return node&&node.nodeName in blockElements},isBogusBr=function(dom,node){return!!isBr(node)&&!(!dom.isBlock(node.nextSibling)||isBr(node.previousSibling))},isEmpty=function(dom,elm,keepBookmarks){var empty=dom.isEmpty(elm);return!(keepBookmarks&&dom.select("span[data-mce-type=bookmark]",elm).length>0)&&empty},isChildOfBody=function(dom,elm){return dom.isChildOf(elm,dom.getRoot())},$_zhglffzjh8lz0s2={isTextNode:isTextNode,isListNode:isListNode,isListItemNode:isListItemNode,isTableCellNode:isTableCellNode,isBr:isBr,isFirstChild:isFirstChild,isLastChild:isLastChild,isTextBlock:isTextBlock,isBlock:isBlock,isBogusBr:isBogusBr,isEmpty:isEmpty,isChildOfBody:isChildOfBody},getNormalizedEndPoint=function(container,offset){var node=global$1.getNode(container,offset);if($_zhglffzjh8lz0s2.isListItemNode(container)&&$_zhglffzjh8lz0s2.isTextNode(node)){var textNodeOffset=offset>=container.childNodes.length?node.data.length:0;return{container:node,offset:textNodeOffset}}return{container:container,offset:offset}},normalizeRange=function(rng){var outRng=rng.cloneRange(),rangeStart=getNormalizedEndPoint(rng.startContainer,rng.startOffset);outRng.setStart(rangeStart.container,rangeStart.offset);var rangeEnd=getNormalizedEndPoint(rng.endContainer,rng.endOffset);return outRng.setEnd(rangeEnd.container,rangeEnd.offset),outRng},$_83g2fsfyjh8lz0s0={getNormalizedEndPoint:getNormalizedEndPoint,normalizeRange:normalizeRange},DOM=global$6.DOM,createBookmark=function(rng){var bookmark={},setupEndPoint=function(start){var offsetNode,container,offset;container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],1===container.nodeType&&(offsetNode=DOM.create("span",{"data-mce-type":"bookmark"}),container.hasChildNodes()?(offset=Math.min(offset,container.childNodes.length-1),start?container.insertBefore(offsetNode,container.childNodes[offset]):DOM.insertAfter(offsetNode,container.childNodes[offset])):container.appendChild(offsetNode),container=offsetNode,offset=0),bookmark[start?"startContainer":"endContainer"]=container,bookmark[start?"startOffset":"endOffset"]=offset};return setupEndPoint(!0),rng.collapsed||setupEndPoint(),bookmark},resolveBookmark=function(bookmark){function restoreEndPoint(start){var container,offset,node,nodeIndex=function(container){for(var node=container.parentNode.firstChild,idx=0;node;){if(node===container)return idx;1===node.nodeType&&"bookmark"===node.getAttribute("data-mce-type")||idx++,node=node.nextSibling}return-1};container=node=bookmark[start?"startContainer":"endContainer"],offset=bookmark[start?"startOffset":"endOffset"],container&&(1===container.nodeType&&(offset=nodeIndex(container),container=container.parentNode,DOM.remove(node),!container.hasChildNodes()&&DOM.isBlock(container)&&container.appendChild(DOM.create("br"))),bookmark[start?"startContainer":"endContainer"]=container,bookmark[start?"startOffset":"endOffset"]=offset)}restoreEndPoint(!0),restoreEndPoint();var rng=DOM.createRng();return rng.setStart(bookmark.startContainer,bookmark.startOffset),bookmark.endContainer&&rng.setEnd(bookmark.endContainer,bookmark.endOffset),$_83g2fsfyjh8lz0s0.normalizeRange(rng)},$_99hdjifxjh8lz0rx={createBookmark:createBookmark,resolveBookmark:resolveBookmark},DOM$1=global$6.DOM,normalizeList=function(dom,ul){var sibling,parentNode=ul.parentNode;"LI"===parentNode.nodeName&&parentNode.firstChild===ul&&(sibling=parentNode.previousSibling,sibling&&"LI"===sibling.nodeName?(sibling.appendChild(ul),$_zhglffzjh8lz0s2.isEmpty(dom,parentNode)&&DOM$1.remove(parentNode)):DOM$1.setStyle(parentNode,"listStyleType","none")),$_zhglffzjh8lz0s2.isListNode(parentNode)&&(sibling=parentNode.previousSibling,sibling&&"LI"===sibling.nodeName&&sibling.appendChild(ul))},normalizeLists=function(dom,element){global$5.each(global$5.grep(dom.select("ol,ul",element)),function(ul){normalizeList(dom,ul)})},$_emx2czg0jh8lz0s4={normalizeList:normalizeList,normalizeLists:normalizeLists},global$7=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),getParentList=function(editor){var selectionStart=editor.selection.getStart(!0);return editor.dom.getParent(selectionStart,"OL,UL,DL",getClosestListRootElm(editor,selectionStart))},isParentListSelected=function(parentList,selectedBlocks){return parentList&&1===selectedBlocks.length&&selectedBlocks[0]===parentList},findSubLists=function(parentList){return global$5.grep(parentList.querySelectorAll("ol,ul,dl"),function(elm){return $_zhglffzjh8lz0s2.isListNode(elm)})},getSelectedSubLists=function(editor){var parentList=getParentList(editor),selectedBlocks=editor.selection.getSelectedBlocks();return isParentListSelected(parentList,selectedBlocks)?findSubLists(parentList):global$5.grep(selectedBlocks,function(elm){return $_zhglffzjh8lz0s2.isListNode(elm)&&parentList!==elm})},findParentListItemsNodes=function(editor,elms){var listItemsElms=global$5.map(elms,function(elm){var parentLi=editor.dom.getParent(elm,"li,dd,dt",getClosestListRootElm(editor,elm));return parentLi?parentLi:elm});return global$7.unique(listItemsElms)},getSelectedListItems=function(editor){var selectedBlocks=editor.selection.getSelectedBlocks();return global$5.grep(findParentListItemsNodes(editor,selectedBlocks),function(block){return $_zhglffzjh8lz0s2.isListItemNode(block)})},getClosestListRootElm=function(editor,elm){var parentTableCell=editor.dom.getParents(elm,"TD,TH"),root=parentTableCell.length>0?parentTableCell[0]:editor.getBody();return root},$_ukg72g1jh8lz0s6={getParentList:getParentList,getSelectedSubLists:getSelectedSubLists,getSelectedListItems:getSelectedListItems,getClosestListRootElm:getClosestListRootElm},global$8=tinymce.util.Tools.resolve("tinymce.Env"),DOM$2=global$6.DOM,createNewTextBlock=function(editor,contentNode,blockName){var node,textBlock,hasContentNode,fragment=DOM$2.createFragment(),blockElements=editor.schema.getBlockElements();if(editor.settings.forced_root_block&&(blockName=blockName||editor.settings.forced_root_block),blockName&&(textBlock=DOM$2.create(blockName),textBlock.tagName===editor.settings.forced_root_block&&DOM$2.setAttribs(textBlock,editor.settings.forced_root_block_attrs),$_zhglffzjh8lz0s2.isBlock(contentNode.firstChild,blockElements)||fragment.appendChild(textBlock)),contentNode)for(;node=contentNode.firstChild;){var nodeName=node.nodeName;hasContentNode||"SPAN"===nodeName&&"bookmark"===node.getAttribute("data-mce-type")||(hasContentNode=!0),$_zhglffzjh8lz0s2.isBlock(node,blockElements)?(fragment.appendChild(node),textBlock=null):blockName?(textBlock||(textBlock=DOM$2.create(blockName),fragment.appendChild(textBlock)),textBlock.appendChild(node)):fragment.appendChild(node)}return editor.settings.forced_root_block?hasContentNode||global$8.ie&&!(global$8.ie>10)||textBlock.appendChild(DOM$2.create("br",{"data-mce-bogus":"1"})):fragment.appendChild(DOM$2.create("br")),fragment},$_doauksg4jh8lz0sb={createNewTextBlock:createNewTextBlock},DOM$3=global$6.DOM,splitList=function(editor,ul,li,newBlock){var tmpRng,fragment,bookmarks,node,removeAndKeepBookmarks=function(targetNode){global$5.each(bookmarks,function(node){targetNode.parentNode.insertBefore(node,li.parentNode)}),DOM$3.remove(targetNode)};for(bookmarks=DOM$3.select('span[data-mce-type="bookmark"]',ul),newBlock=newBlock||$_doauksg4jh8lz0sb.createNewTextBlock(editor,li),tmpRng=DOM$3.createRng(),tmpRng.setStartAfter(li),tmpRng.setEndAfter(ul),fragment=tmpRng.extractContents(),node=fragment.firstChild;node;node=node.firstChild)if("LI"===node.nodeName&&editor.dom.isEmpty(node)){DOM$3.remove(node);break}editor.dom.isEmpty(fragment)||DOM$3.insertAfter(fragment,ul),DOM$3.insertAfter(newBlock,ul),$_zhglffzjh8lz0s2.isEmpty(editor.dom,li.parentNode)&&removeAndKeepBookmarks(li.parentNode),DOM$3.remove(li),$_zhglffzjh8lz0s2.isEmpty(editor.dom,ul)&&DOM$3.remove(ul)},$_2pwmf9g3jh8lz0s9={splitList:splitList},DOM$4=global$6.DOM,removeEmptyLi=function(dom,li){$_zhglffzjh8lz0s2.isEmpty(dom,li)&&DOM$4.remove(li)},outdent=function(editor,li){var ulParent,newBlock,ul=li.parentNode;return ul?(ulParent=ul.parentNode,ul===editor.getBody()||("DD"===li.nodeName?(DOM$4.rename(li,"DT"),!0):$_zhglffzjh8lz0s2.isFirstChild(li)&&$_zhglffzjh8lz0s2.isLastChild(li)?("LI"===ulParent.nodeName?(DOM$4.insertAfter(li,ulParent),removeEmptyLi(editor.dom,ulParent),DOM$4.remove(ul)):$_zhglffzjh8lz0s2.isListNode(ulParent)?DOM$4.remove(ul,!0):(ulParent.insertBefore($_doauksg4jh8lz0sb.createNewTextBlock(editor,li),ul),DOM$4.remove(ul)),!0):$_zhglffzjh8lz0s2.isFirstChild(li)?("LI"===ulParent.nodeName?(DOM$4.insertAfter(li,ulParent),li.appendChild(ul),removeEmptyLi(editor.dom,ulParent)):$_zhglffzjh8lz0s2.isListNode(ulParent)?ulParent.insertBefore(li,ul):(ulParent.insertBefore($_doauksg4jh8lz0sb.createNewTextBlock(editor,li),ul),DOM$4.remove(li)),!0):$_zhglffzjh8lz0s2.isLastChild(li)?("LI"===ulParent.nodeName?DOM$4.insertAfter(li,ulParent):$_zhglffzjh8lz0s2.isListNode(ulParent)?DOM$4.insertAfter(li,ul):(DOM$4.insertAfter($_doauksg4jh8lz0sb.createNewTextBlock(editor,li),ul),DOM$4.remove(li)),!0):("LI"===ulParent.nodeName?(ul=ulParent,newBlock=$_doauksg4jh8lz0sb.createNewTextBlock(editor,li,"LI")):newBlock=$_zhglffzjh8lz0s2.isListNode(ulParent)?$_doauksg4jh8lz0sb.createNewTextBlock(editor,li,"LI"):$_doauksg4jh8lz0sb.createNewTextBlock(editor,li),$_2pwmf9g3jh8lz0s9.splitList(editor,ul,li,newBlock),$_emx2czg0jh8lz0s4.normalizeLists(editor.dom,ul.parentNode),!0))):(removeEmptyLi(editor.dom,li),!0)},outdentSelection=function(editor){var listElements=$_ukg72g1jh8lz0s6.getSelectedListItems(editor);if(listElements.length){var bookmark=$_99hdjifxjh8lz0rx.createBookmark(editor.selection.getRng()),i=void 0,y=void 0,root=$_ukg72g1jh8lz0s6.getClosestListRootElm(editor,editor.selection.getStart(!0));for(i=listElements.length;i--;)for(var node=listElements[i].parentNode;node&&node!==root;){for(y=listElements.length;y--;)if(listElements[y]===node){listElements.splice(i,1);break}node=node.parentNode}for(i=0;i<listElements.length&&(outdent(editor,listElements[i])||0!==i);i++);return editor.selection.setRng($_99hdjifxjh8lz0rx.resolveBookmark(bookmark)),editor.nodeChanged(),!0}},$_7womq3fvjh8lz0ru={outdent:outdent,outdentSelection:outdentSelection},updateListStyle=function(dom,el,detail){var type=detail["list-style-type"]?detail["list-style-type"]:null;dom.setStyle(el,"list-style-type",type)},setAttribs=function(elm,attrs){global$5.each(attrs,function(value,key){elm.setAttribute(key,value)})},updateListAttrs=function(dom,el,detail){setAttribs(el,detail["list-attributes"]),global$5.each(dom.select("li",el),function(li){setAttribs(li,detail["list-item-attributes"])})},updateListWithDetails=function(dom,el,detail){updateListStyle(dom,el,detail),updateListAttrs(dom,el,detail)},removeStyles=function(dom,element,styles){global$5.each(styles,function(style){return dom.setStyle(element,(_a={},_a[style]="",_a));var _a})},getEndPointNode=function(editor,rng,start,root){var container,offset;for(container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],1===container.nodeType&&(container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container),!start&&$_zhglffzjh8lz0s2.isBr(container.nextSibling)&&(container=container.nextSibling);container.parentNode!==root;){if($_zhglffzjh8lz0s2.isTextBlock(editor,container))return container;if(/^(TD|TH)$/.test(container.parentNode.nodeName))return container;container=container.parentNode}return container},getSelectedTextBlocks=function(editor,rng,root){for(var block,textBlocks=[],dom=editor.dom,startNode=getEndPointNode(editor,rng,!0,root),endNode=getEndPointNode(editor,rng,!1,root),siblings=[],node=startNode;node&&(siblings.push(node),node!==endNode);node=node.nextSibling);return global$5.each(siblings,function(node){if($_zhglffzjh8lz0s2.isTextBlock(editor,node))return textBlocks.push(node),void(block=null);if(dom.isBlock(node)||$_zhglffzjh8lz0s2.isBr(node))return $_zhglffzjh8lz0s2.isBr(node)&&dom.remove(node),void(block=null);var nextSibling=node.nextSibling;return global$4.isBookmarkNode(node)&&($_zhglffzjh8lz0s2.isTextBlock(editor,nextSibling)||!nextSibling&&node.parentNode===root)?void(block=null):(block||(block=dom.create("p"),node.parentNode.insertBefore(block,node),textBlocks.push(block)),void block.appendChild(node))}),textBlocks},hasCompatibleStyle=function(dom,sib,detail){var sibStyle=dom.getStyle(sib,"list-style-type"),detailStyle=detail?detail["list-style-type"]:"";return detailStyle=null===detailStyle?"":detailStyle,sibStyle===detailStyle},applyList=function(editor,listName,detail){void 0===detail&&(detail={});var bookmark,rng=editor.selection.getRng(!0),listItemName="LI",root=$_ukg72g1jh8lz0s6.getClosestListRootElm(editor,editor.selection.getStart(!0)),dom=editor.dom;"false"!==dom.getContentEditable(editor.selection.getNode())&&(listName=listName.toUpperCase(),"DL"===listName&&(listItemName="DT"),bookmark=$_99hdjifxjh8lz0rx.createBookmark(rng),global$5.each(getSelectedTextBlocks(editor,rng,root),function(block){var listBlock,sibling;sibling=block.previousSibling,sibling&&$_zhglffzjh8lz0s2.isListNode(sibling)&&sibling.nodeName===listName&&hasCompatibleStyle(dom,sibling,detail)?(listBlock=sibling,block=dom.rename(block,listItemName),sibling.appendChild(block)):(listBlock=dom.create(listName),block.parentNode.insertBefore(listBlock,block),listBlock.appendChild(block),block=dom.rename(block,listItemName)),removeStyles(dom,block,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),updateListWithDetails(dom,listBlock,detail),mergeWithAdjacentLists(editor.dom,listBlock)}),editor.selection.setRng($_99hdjifxjh8lz0rx.resolveBookmark(bookmark)))},removeList=function(editor){var bookmark=$_99hdjifxjh8lz0rx.createBookmark(editor.selection.getRng(!0)),root=$_ukg72g1jh8lz0s6.getClosestListRootElm(editor,editor.selection.getStart(!0)),listItems=$_ukg72g1jh8lz0s6.getSelectedListItems(editor),emptyListItems=global$5.grep(listItems,function(li){return editor.dom.isEmpty(li)});listItems=global$5.grep(listItems,function(li){return!editor.dom.isEmpty(li)}),global$5.each(emptyListItems,function(li){if($_zhglffzjh8lz0s2.isEmpty(editor.dom,li))return void $_7womq3fvjh8lz0ru.outdent(editor,li)}),global$5.each(listItems,function(li){var node,rootList;if(li.parentNode!==editor.getBody()){for(node=li;node&&node!==root;node=node.parentNode)$_zhglffzjh8lz0s2.isListNode(node)&&(rootList=node);$_2pwmf9g3jh8lz0s9.splitList(editor,rootList,li),$_emx2czg0jh8lz0s4.normalizeLists(editor.dom,rootList.parentNode)}}),editor.selection.setRng($_99hdjifxjh8lz0rx.resolveBookmark(bookmark))},isValidLists=function(list1,list2){return list1&&list2&&$_zhglffzjh8lz0s2.isListNode(list1)&&list1.nodeName===list2.nodeName},hasSameListStyle=function(dom,list1,list2){var targetStyle=dom.getStyle(list1,"list-style-type",!0),style=dom.getStyle(list2,"list-style-type",!0);return targetStyle===style},hasSameClasses=function(elm1,elm2){return elm1.className===elm2.className},shouldMerge=function(dom,list1,list2){return isValidLists(list1,list2)&&hasSameListStyle(dom,list1,list2)&&hasSameClasses(list1,list2)},mergeWithAdjacentLists=function(dom,listBlock){var sibling,node;if(sibling=listBlock.nextSibling,shouldMerge(dom,listBlock,sibling)){for(;node=sibling.firstChild;)listBlock.appendChild(node);dom.remove(sibling)}if(sibling=listBlock.previousSibling,shouldMerge(dom,listBlock,sibling)){for(;node=sibling.lastChild;)listBlock.insertBefore(node,listBlock.firstChild);dom.remove(sibling)}},updateList=function(dom,list,listName,detail){if(list.nodeName!==listName){var newList=dom.rename(list,listName);updateListWithDetails(dom,newList,detail)}else updateListWithDetails(dom,list,detail)},toggleMultipleLists=function(editor,parentList,lists,listName,detail){if(parentList.nodeName!==listName||hasListStyleDetail(detail)){var bookmark=$_99hdjifxjh8lz0rx.createBookmark(editor.selection.getRng(!0));global$5.each([parentList].concat(lists),function(elm){updateList(editor.dom,elm,listName,detail)}),editor.selection.setRng($_99hdjifxjh8lz0rx.resolveBookmark(bookmark))}else removeList(editor)},hasListStyleDetail=function(detail){return"list-style-type"in detail},toggleSingleList=function(editor,parentList,listName,detail){if(parentList!==editor.getBody())if(parentList)if(parentList.nodeName!==listName||hasListStyleDetail(detail)){var bookmark=$_99hdjifxjh8lz0rx.createBookmark(editor.selection.getRng(!0));updateListWithDetails(editor.dom,parentList,detail),mergeWithAdjacentLists(editor.dom,editor.dom.rename(parentList,listName)),editor.selection.setRng($_99hdjifxjh8lz0rx.resolveBookmark(bookmark))}else removeList(editor);else applyList(editor,listName,detail)},toggleList=function(editor,listName,detail){var parentList=$_ukg72g1jh8lz0s6.getParentList(editor),selectedSubLists=$_ukg72g1jh8lz0s6.getSelectedSubLists(editor);detail=detail?detail:{},parentList&&selectedSubLists.length>0?toggleMultipleLists(editor,parentList,selectedSubLists,listName,detail):toggleSingleList(editor,parentList,listName,detail)},$_8t3z1mfsjh8lz0rl={toggleList:toggleList,removeList:removeList,mergeWithAdjacentLists:mergeWithAdjacentLists},findNextCaretContainer=function(editor,rng,isForward,root){var nonEmptyBlocks,walker,node=rng.startContainer,offset=rng.startOffset;if(3===node.nodeType&&(isForward?offset<node.data.length:offset>0))return node;for(nonEmptyBlocks=editor.schema.getNonEmptyElements(),1===node.nodeType&&(node=global$1.getNode(node,offset)),walker=new global$2(node,root),isForward&&$_zhglffzjh8lz0s2.isBogusBr(editor.dom,node)&&walker.next();node=walker[isForward?"next":"prev2"]();){if("LI"===node.nodeName&&!node.hasChildNodes())return node;if(nonEmptyBlocks[node.nodeName])return node;if(3===node.nodeType&&node.data.length>0)return node}},hasOnlyOneBlockChild=function(dom,elm){var childNodes=elm.childNodes;return 1===childNodes.length&&!$_zhglffzjh8lz0s2.isListNode(childNodes[0])&&dom.isBlock(childNodes[0])},unwrapSingleBlockChild=function(dom,elm){hasOnlyOneBlockChild(dom,elm)&&dom.remove(elm.firstChild,!0)},moveChildren=function(dom,fromElm,toElm){var node,targetElm;if(targetElm=hasOnlyOneBlockChild(dom,toElm)?toElm.firstChild:toElm,unwrapSingleBlockChild(dom,fromElm),!$_zhglffzjh8lz0s2.isEmpty(dom,fromElm,!0))for(;node=fromElm.firstChild;)targetElm.appendChild(node)},mergeLiElements=function(dom,fromElm,toElm){var node,listNode,ul=fromElm.parentNode;$_zhglffzjh8lz0s2.isChildOfBody(dom,fromElm)&&$_zhglffzjh8lz0s2.isChildOfBody(dom,toElm)&&($_zhglffzjh8lz0s2.isListNode(toElm.lastChild)&&(listNode=toElm.lastChild),ul===toElm.lastChild&&$_zhglffzjh8lz0s2.isBr(ul.previousSibling)&&dom.remove(ul.previousSibling),node=toElm.lastChild,node&&$_zhglffzjh8lz0s2.isBr(node)&&fromElm.hasChildNodes()&&dom.remove(node),$_zhglffzjh8lz0s2.isEmpty(dom,toElm,!0)&&dom.$(toElm).empty(),moveChildren(dom,fromElm,toElm),listNode&&toElm.appendChild(listNode),dom.remove(fromElm),$_zhglffzjh8lz0s2.isEmpty(dom,ul)&&ul!==dom.getRoot()&&dom.remove(ul))},mergeIntoEmptyLi=function(editor,fromLi,toLi){editor.dom.$(toLi).empty(),mergeLiElements(editor.dom,fromLi,toLi),editor.selection.setCursorLocation(toLi)},mergeForward=function(editor,rng,fromLi,toLi){var dom=editor.dom;if(dom.isEmpty(toLi))mergeIntoEmptyLi(editor,fromLi,toLi);else{var bookmark=$_99hdjifxjh8lz0rx.createBookmark(rng);mergeLiElements(dom,fromLi,toLi),editor.selection.setRng($_99hdjifxjh8lz0rx.resolveBookmark(bookmark))}},mergeBackward=function(editor,rng,fromLi,toLi){var bookmark=$_99hdjifxjh8lz0rx.createBookmark(rng);mergeLiElements(editor.dom,fromLi,toLi);var resolvedBookmark=$_99hdjifxjh8lz0rx.resolveBookmark(bookmark);editor.selection.setRng(resolvedBookmark)},backspaceDeleteFromListToListCaret=function(editor,isForward){var ul,rng,otherLi,dom=editor.dom,selection=editor.selection,selectionStartElm=selection.getStart(),root=$_ukg72g1jh8lz0s6.getClosestListRootElm(editor,selectionStartElm),li=dom.getParent(selection.getStart(),"LI",root);if(li){if(ul=li.parentNode,ul===editor.getBody()&&$_zhglffzjh8lz0s2.isEmpty(dom,ul))return!0;if(rng=$_83g2fsfyjh8lz0s0.normalizeRange(selection.getRng(!0)),otherLi=dom.getParent(findNextCaretContainer(editor,rng,isForward,root),"LI",root),otherLi&&otherLi!==li)return isForward?mergeForward(editor,rng,otherLi,li):mergeBackward(editor,rng,li,otherLi),!0;if(!otherLi&&!isForward&&$_8t3z1mfsjh8lz0rl.removeList(editor))return!0}return!1},removeBlock=function(dom,block,root){var parentBlock=dom.getParent(block.parentNode,dom.isBlock,root);dom.remove(block),parentBlock&&dom.isEmpty(parentBlock)&&dom.remove(parentBlock)},backspaceDeleteIntoListCaret=function(editor,isForward){var dom=editor.dom,selectionStartElm=editor.selection.getStart(),root=$_ukg72g1jh8lz0s6.getClosestListRootElm(editor,selectionStartElm),block=dom.getParent(selectionStartElm,dom.isBlock,root);if(block&&dom.isEmpty(block)){var rng=$_83g2fsfyjh8lz0s0.normalizeRange(editor.selection.getRng(!0)),otherLi_1=dom.getParent(findNextCaretContainer(editor,rng,isForward,root),"LI",root);if(otherLi_1)return editor.undoManager.transact(function(){removeBlock(dom,block,root),$_8t3z1mfsjh8lz0rl.mergeWithAdjacentLists(dom,otherLi_1.parentNode),editor.selection.select(otherLi_1,!0),editor.selection.collapse(isForward)}),!0}return!1},backspaceDeleteCaret=function(editor,isForward){return backspaceDeleteFromListToListCaret(editor,isForward)||backspaceDeleteIntoListCaret(editor,isForward)},backspaceDeleteRange=function(editor){var selectionStartElm=editor.selection.getStart(),root=$_ukg72g1jh8lz0s6.getClosestListRootElm(editor,selectionStartElm),startListParent=editor.dom.getParent(selectionStartElm,"LI,DT,DD",root);return!!(startListParent||$_ukg72g1jh8lz0s6.getSelectedListItems(editor).length>0)&&(editor.undoManager.transact(function(){editor.execCommand("Delete"),$_emx2czg0jh8lz0s4.normalizeLists(editor.dom,editor.getBody())}),!0)},backspaceDelete=function(editor,isForward){return editor.selection.isCollapsed()?backspaceDeleteCaret(editor,isForward):backspaceDeleteRange(editor)},setup=function(editor){editor.on("keydown",function(e){e.keyCode===global$3.BACKSPACE?backspaceDelete(editor,!1)&&e.preventDefault():e.keyCode===global$3.DELETE&&backspaceDelete(editor,!0)&&e.preventDefault()})},$_fl6g5dfojh8lz0re={setup:setup,backspaceDelete:backspaceDelete},get=function(editor){return{backspaceDelete:function(isForward){$_fl6g5dfojh8lz0re.backspaceDelete(editor,isForward)}}},$_fad7jdfnjh8lz0rb={get:get},DOM$5=global$6.DOM,mergeLists=function(from,to){var node;if($_zhglffzjh8lz0s2.isListNode(from)){for(;node=from.firstChild;)to.appendChild(node);DOM$5.remove(from)}},indent=function(li){var sibling,newList,listStyle;return"DT"===li.nodeName?(DOM$5.rename(li,"DD"),!0):(sibling=li.previousSibling,sibling&&$_zhglffzjh8lz0s2.isListNode(sibling)?(sibling.appendChild(li),!0):sibling&&"LI"===sibling.nodeName&&$_zhglffzjh8lz0s2.isListNode(sibling.lastChild)?(sibling.lastChild.appendChild(li),mergeLists(li.lastChild,sibling.lastChild),!0):(sibling=li.nextSibling,sibling&&$_zhglffzjh8lz0s2.isListNode(sibling)?(sibling.insertBefore(li,sibling.firstChild),!0):(sibling=li.previousSibling,!(!sibling||"LI"!==sibling.nodeName)&&(newList=DOM$5.create(li.parentNode.nodeName),listStyle=DOM$5.getStyle(li.parentNode,"listStyleType"),listStyle&&DOM$5.setStyle(newList,"listStyleType",listStyle),sibling.appendChild(newList),newList.appendChild(li),mergeLists(li.lastChild,newList),!0))))},indentSelection=function(editor){var listElements=$_ukg72g1jh8lz0s6.getSelectedListItems(editor);if(listElements.length){for(var bookmark=$_99hdjifxjh8lz0rx.createBookmark(editor.selection.getRng(!0)),i=0;i<listElements.length&&(indent(listElements[i])||0!==i);i++);return editor.selection.setRng($_99hdjifxjh8lz0rx.resolveBookmark(bookmark)),editor.nodeChanged(),!0}},$_4rsk3ng7jh8lz0sg={indentSelection:indentSelection},queryListCommandState=function(editor,listName){return function(){var parentList=editor.dom.getParent(editor.selection.getStart(),"UL,OL,DL");return parentList&&parentList.nodeName===listName}},register=function(editor){editor.on("BeforeExecCommand",function(e){var isHandled,cmd=e.command.toLowerCase();if("indent"===cmd?$_4rsk3ng7jh8lz0sg.indentSelection(editor)&&(isHandled=!0):"outdent"===cmd&&$_7womq3fvjh8lz0ru.outdentSelection(editor)&&(isHandled=!0),isHandled)return editor.fire("ExecCommand",{command:e.command}),e.preventDefault(),!0}),editor.addCommand("InsertUnorderedList",function(ui,detail){$_8t3z1mfsjh8lz0rl.toggleList(editor,"UL",detail)}),editor.addCommand("InsertOrderedList",function(ui,detail){$_8t3z1mfsjh8lz0rl.toggleList(editor,"OL",detail)}),editor.addCommand("InsertDefinitionList",function(ui,detail){$_8t3z1mfsjh8lz0rl.toggleList(editor,"DL",detail)}),editor.addQueryStateHandler("InsertUnorderedList",queryListCommandState(editor,"UL")),editor.addQueryStateHandler("InsertOrderedList",queryListCommandState(editor,"OL")),editor.addQueryStateHandler("InsertDefinitionList",queryListCommandState(editor,"DL"))},$_1ley1og6jh8lz0se={register:register},shouldIndentOnTab=function(editor){return editor.getParam("lists_indent_on_tab",!0)},$_bkr9ckg9jh8lz0sk={shouldIndentOnTab:shouldIndentOnTab},setupTabKey=function(editor){editor.on("keydown",function(e){e.keyCode!==global$3.TAB||global$3.metaKeyPressed(e)||editor.dom.getParent(editor.selection.getStart(),"LI,DT,DD")&&(e.preventDefault(),e.shiftKey?$_7womq3fvjh8lz0ru.outdentSelection(editor):$_4rsk3ng7jh8lz0sg.indentSelection(editor))})},setup$1=function(editor){$_bkr9ckg9jh8lz0sk.shouldIndentOnTab(editor)&&setupTabKey(editor),$_fl6g5dfojh8lz0re.setup(editor)},$_2piq8jg8jh8lz0sj={setup:setup$1},findIndex=function(list,predicate){for(var index=0;index<list.length;index++){var element=list[index];if(predicate(element))return index}return-1},listState=function(editor,listName){return function(e){var ctrl=e.control;editor.on("NodeChange",function(e){var tableCellIndex=findIndex(e.parents,$_zhglffzjh8lz0s2.isTableCellNode),parents=tableCellIndex!==-1?e.parents.slice(0,tableCellIndex):e.parents,lists=global$5.grep(parents,$_zhglffzjh8lz0s2.isListNode);ctrl.active(lists.length>0&&lists[0].nodeName===listName)})}},indentPostRender=function(editor){return function(e){var ctrl=e.control;editor.on("nodechange",function(){var listItemBlocks=$_ukg72g1jh8lz0s6.getSelectedListItems(editor),disable=listItemBlocks.length>0&&$_zhglffzjh8lz0s2.isFirstChild(listItemBlocks[0]);ctrl.disabled(disable)})}},register$1=function(editor){var hasPlugin=function(editor,plugin){var plugins=editor.settings.plugins?editor.settings.plugins:"";return global$5.inArray(plugins.split(/[ ,]/),plugin)!==-1};hasPlugin(editor,"advlist")||(editor.addButton("numlist",{active:!1,title:"Numbered list",cmd:"InsertOrderedList",onPostRender:listState(editor,"OL")}),editor.addButton("bullist",{active:!1,title:"Bullet list",cmd:"InsertUnorderedList",onPostRender:listState(editor,"UL")})),editor.addButton("indent",{icon:"indent",title:"Increase indent",cmd:"Indent",onPostRender:indentPostRender(editor)})},$_60ls25gajh8lz0sl={register:register$1};return global.add("lists",function(editor){return $_2piq8jg8jh8lz0sj.setup(editor),$_60ls25gajh8lz0sl.register(editor),$_1ley1og6jh8lz0se.register(editor),$_fad7jdfnjh8lz0rb.get(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-media",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.Env"),global$2=tinymce.util.Tools.resolve("tinymce.util.Tools"),getScripts=function(editor){return editor.getParam("media_scripts");
},getAudioTemplateCallback=function(editor){return editor.getParam("audio_template_callback")},getVideoTemplateCallback=function(editor){return editor.getParam("video_template_callback")},hasLiveEmbeds=function(editor){return editor.getParam("media_live_embeds",!0)},shouldFilterHtml=function(editor){return editor.getParam("media_filter_html",!0)},getUrlResolver=function(editor){return editor.getParam("media_url_resolver")},hasAltSource=function(editor){return editor.getParam("media_alt_source",!0)},hasPoster=function(editor){return editor.getParam("media_poster",!0)},hasDimensions=function(editor){return editor.getParam("media_dimensions",!0)},$_bcg8bpghjh8lz0ut={getScripts:getScripts,getAudioTemplateCallback:getAudioTemplateCallback,getVideoTemplateCallback:getVideoTemplateCallback,hasLiveEmbeds:hasLiveEmbeds,shouldFilterHtml:shouldFilterHtml,getUrlResolver:getUrlResolver,hasAltSource:hasAltSource,hasPoster:hasPoster,hasDimensions:hasDimensions},global$3=tinymce.util.Tools.resolve("tinymce.html.SaxParser"),global$4=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),getVideoScriptMatch=function(prefixes,src){if(prefixes)for(var i=0;i<prefixes.length;i++)if(src.indexOf(prefixes[i].filter)!==-1)return prefixes[i]},$_a6mt9vgljh8lz0uz={getVideoScriptMatch:getVideoScriptMatch},trimPx=function(value){return value.replace(/px$/,"")},addPx=function(value){return/^[0-9.]+$/.test(value)?value+"px":value},getSize=function(name){return function(elm){return elm?trimPx(elm.style[name]):""}},setSize=function(name){return function(elm,value){elm&&(elm.style[name]=addPx(value))}},$_g4vsn9gmjh8lz0v1={getMaxWidth:getSize("maxWidth"),getMaxHeight:getSize("maxHeight"),setMaxWidth:setSize("maxWidth"),setMaxHeight:setSize("maxHeight")},DOM=global$4.DOM,getEphoxEmbedIri=function(elm){return DOM.getAttrib(elm,"data-ephox-embed-iri")},isEphoxEmbed=function(html){var fragment=DOM.createFragment(html);return""!==getEphoxEmbedIri(fragment.firstChild)},htmlToDataSax=function(prefixes,html){var data={};return global$3({validate:!1,allow_conditional_comments:!0,special:"script,noscript",start:function(name,attrs){if(data.source1||"param"!==name||(data.source1=attrs.map.movie),"iframe"!==name&&"object"!==name&&"embed"!==name&&"video"!==name&&"audio"!==name||(data.type||(data.type=name),data=global$2.extend(attrs.map,data)),"script"===name){var videoScript=$_a6mt9vgljh8lz0uz.getVideoScriptMatch(prefixes,attrs.map.src);if(!videoScript)return;data={type:"script",source1:attrs.map.src,width:videoScript.width,height:videoScript.height}}"source"===name&&(data.source1?data.source2||(data.source2=attrs.map.src):data.source1=attrs.map.src),"img"!==name||data.poster||(data.poster=attrs.map.src)}}).parse(html),data.source1=data.source1||data.src||data.data,data.source2=data.source2||"",data.poster=data.poster||"",data},ephoxEmbedHtmlToData=function(html){var fragment=DOM.createFragment(html),div=fragment.firstChild;return{type:"ephox-embed-iri",source1:getEphoxEmbedIri(div),source2:"",poster:"",width:$_g4vsn9gmjh8lz0v1.getMaxWidth(div),height:$_g4vsn9gmjh8lz0v1.getMaxHeight(div)}},htmlToData=function(prefixes,html){return isEphoxEmbed(html)?ephoxEmbedHtmlToData(html):htmlToDataSax(prefixes,html)},$_3nrb4rgijh8lz0uw={htmlToData:htmlToData},global$5=tinymce.util.Tools.resolve("tinymce.util.Promise"),guess=function(url){var mimes={mp3:"audio/mpeg",wav:"audio/wav",mp4:"video/mp4",webm:"video/webm",ogg:"video/ogg",swf:"application/x-shockwave-flash"},fileEnd=url.toLowerCase().split(".").pop(),mime=mimes[fileEnd];return mime?mime:""},$_fbk2jcgqjh8lz0v8={guess:guess},global$6=tinymce.util.Tools.resolve("tinymce.html.Writer"),global$7=tinymce.util.Tools.resolve("tinymce.html.Schema"),DOM$1=global$4.DOM,setAttributes=function(attrs,updatedAttrs){var name,i,value,attr;for(name in updatedAttrs)if(value=""+updatedAttrs[name],attrs.map[name])for(i=attrs.length;i--;)attr=attrs[i],attr.name===name&&(value?(attrs.map[name]=value,attr.value=value):(delete attrs.map[name],attrs.splice(i,1)));else value&&(attrs.push({name:name,value:value}),attrs.map[name]=value)},normalizeHtml=function(html){var writer=global$6(),parser=global$3(writer);return parser.parse(html),writer.getContent()},updateHtmlSax=function(html,data,updateAll){var hasImage,writer=global$6(),sourceCount=0;return global$3({validate:!1,allow_conditional_comments:!0,special:"script,noscript",comment:function(text){writer.comment(text)},cdata:function(text){writer.cdata(text)},text:function(text,raw){writer.text(text,raw)},start:function(name,attrs,empty){switch(name){case"video":case"object":case"embed":case"img":case"iframe":void 0!==data.height&&void 0!==data.width&&setAttributes(attrs,{width:data.width,height:data.height})}if(updateAll)switch(name){case"video":setAttributes(attrs,{poster:data.poster,src:""}),data.source2&&setAttributes(attrs,{src:""});break;case"iframe":setAttributes(attrs,{src:data.source1});break;case"source":if(sourceCount++,sourceCount<=2&&(setAttributes(attrs,{src:data["source"+sourceCount],type:data["source"+sourceCount+"mime"]}),!data["source"+sourceCount]))return;break;case"img":if(!data.poster)return;hasImage=!0}writer.start(name,attrs,empty)},end:function(name){if("video"===name&&updateAll)for(var index=1;index<=2;index++)if(data["source"+index]){var attrs=[];attrs.map={},sourceCount<index&&(setAttributes(attrs,{src:data["source"+index],type:data["source"+index+"mime"]}),writer.start("source",attrs,!0))}if(data.poster&&"object"===name&&updateAll&&!hasImage){var imgAttrs=[];imgAttrs.map={},setAttributes(imgAttrs,{src:data.poster,width:data.width,height:data.height}),writer.start("img",imgAttrs,!0)}writer.end(name)}},global$7({})).parse(html),writer.getContent()},isEphoxEmbed$1=function(html){var fragment=DOM$1.createFragment(html);return""!==DOM$1.getAttrib(fragment.firstChild,"data-ephox-embed-iri")},updateEphoxEmbed=function(html,data){var fragment=DOM$1.createFragment(html),div=fragment.firstChild;return $_g4vsn9gmjh8lz0v1.setMaxWidth(div,data.width),$_g4vsn9gmjh8lz0v1.setMaxHeight(div,data.height),normalizeHtml(div.outerHTML)},updateHtml=function(html,data,updateAll){return isEphoxEmbed$1(html)?updateEphoxEmbed(html,data):updateHtmlSax(html,data,updateAll)},$_ec27xygrjh8lz0va={updateHtml:updateHtml},urlPatterns=[{regex:/youtu\.be\/([\w\-_\?&=.]+)/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/youtube\.com(.+)v=([^&]+)(&([a-z0-9&=\-_]+))?/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$2?$4",allowFullscreen:!0},{regex:/youtube.com\/embed\/([a-z0-9\?&=\-_]+)/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/vimeo\.com\/([0-9]+)/,type:"iframe",w:425,h:350,url:"//player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc",allowFullscreen:!0},{regex:/vimeo\.com\/(.*)\/([0-9]+)/,type:"iframe",w:425,h:350,url:"//player.vimeo.com/video/$2?title=0&amp;byline=0",allowFullscreen:!0},{regex:/maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/,type:"iframe",w:425,h:350,url:'//maps.google.com/maps/ms?msid=$2&output=embed"',allowFullscreen:!1},{regex:/dailymotion\.com\/video\/([^_]+)/,type:"iframe",w:480,h:270,url:"//www.dailymotion.com/embed/video/$1",allowFullscreen:!0},{regex:/dai\.ly\/([^_]+)/,type:"iframe",w:480,h:270,url:"//www.dailymotion.com/embed/video/$1",allowFullscreen:!0}],getUrl=function(pattern,url){for(var match=pattern.regex.exec(url),newUrl=pattern.url,_loop_1=function(i){newUrl=newUrl.replace("$"+i,function(){return match[i]?match[i]:""})},i=0;i<match.length;i++)_loop_1(i);return newUrl.replace(/\?$/,"")},matchPattern=function(url){var pattern=urlPatterns.filter(function(pattern){return pattern.regex.test(url)});return pattern.length>0?global$2.extend({},pattern[0],{url:getUrl(pattern[0],url)}):null},getIframeHtml=function(data){var allowFullscreen=data.allowFullscreen?' allowFullscreen="1"':"";return'<iframe src="'+data.source1+'" width="'+data.width+'" height="'+data.height+'"'+allowFullscreen+"></iframe>"},getFlashHtml=function(data){var html='<object data="'+data.source1+'" width="'+data.width+'" height="'+data.height+'" type="application/x-shockwave-flash">';return data.poster&&(html+='<img src="'+data.poster+'" width="'+data.width+'" height="'+data.height+'" />'),html+="</object>"},getAudioHtml=function(data,audioTemplateCallback){return audioTemplateCallback?audioTemplateCallback(data):'<audio controls="controls" src="'+data.source1+'">'+(data.source2?'\n<source src="'+data.source2+'"'+(data.source2mime?' type="'+data.source2mime+'"':"")+" />\n":"")+"</audio>"},getVideoHtml=function(data,videoTemplateCallback){return videoTemplateCallback?videoTemplateCallback(data):'<video width="'+data.width+'" height="'+data.height+'"'+(data.poster?' poster="'+data.poster+'"':"")+' controls="controls">\n<source src="'+data.source1+'"'+(data.source1mime?' type="'+data.source1mime+'"':"")+" />\n"+(data.source2?'<source src="'+data.source2+'"'+(data.source2mime?' type="'+data.source2mime+'"':"")+" />\n":"")+"</video>"},getScriptHtml=function(data){return'<script src="'+data.source1+'"></script>'},dataToHtml=function(editor,dataIn){var data=global$2.extend({},dataIn);if(!data.source1&&(global$2.extend(data,$_3nrb4rgijh8lz0uw.htmlToData($_bcg8bpghjh8lz0ut.getScripts(editor),data.embed)),!data.source1))return"";data.source2||(data.source2=""),data.poster||(data.poster=""),data.source1=editor.convertURL(data.source1,"source"),data.source2=editor.convertURL(data.source2,"source"),data.source1mime=$_fbk2jcgqjh8lz0v8.guess(data.source1),data.source2mime=$_fbk2jcgqjh8lz0v8.guess(data.source2),data.poster=editor.convertURL(data.poster,"poster");var pattern=matchPattern(data.source1);if(pattern&&(data.source1=pattern.url,data.type=pattern.type,data.allowFullscreen=pattern.allowFullscreen,data.width=data.width||pattern.w,data.height=data.height||pattern.h),data.embed)return $_ec27xygrjh8lz0va.updateHtml(data.embed,data,!0);var videoScript=$_a6mt9vgljh8lz0uz.getVideoScriptMatch($_bcg8bpghjh8lz0ut.getScripts(editor),data.source1);videoScript&&(data.type="script",data.width=videoScript.width,data.height=videoScript.height);var audioTemplateCallback=$_bcg8bpghjh8lz0ut.getAudioTemplateCallback(editor),videoTemplateCallback=$_bcg8bpghjh8lz0ut.getVideoTemplateCallback(editor);return data.width=data.width||300,data.height=data.height||150,global$2.each(data,function(value,key){data[key]=editor.dom.encode(value)}),"iframe"===data.type?getIframeHtml(data):"application/x-shockwave-flash"===data.source1mime?getFlashHtml(data):data.source1mime.indexOf("audio")!==-1?getAudioHtml(data,audioTemplateCallback):"script"===data.type?getScriptHtml(data):getVideoHtml(data,videoTemplateCallback)},$_36z50bgpjh8lz0v5={dataToHtml:dataToHtml},cache={},embedPromise=function(data,dataToHtml,handler){return new global$5(function(res,rej){var wrappedResolve=function(response){return response.html&&(cache[data.source1]=response),res({url:data.source1,html:response.html?response.html:dataToHtml(data)})};cache[data.source1]?wrappedResolve(cache[data.source1]):handler({url:data.source1},wrappedResolve,rej)})},defaultPromise=function(data,dataToHtml){return new global$5(function(res){res({html:dataToHtml(data),url:data.source1})})},loadedData=function(editor){return function(data){return $_36z50bgpjh8lz0v5.dataToHtml(editor,data)}},getEmbedHtml=function(editor,data){var embedHandler=$_bcg8bpghjh8lz0ut.getUrlResolver(editor);return embedHandler?embedPromise(data,loadedData(editor),embedHandler):defaultPromise(data,loadedData(editor))},isCached=function(url){return cache.hasOwnProperty(url)},$_bqbbyvgnjh8lz0v2={getEmbedHtml:getEmbedHtml,isCached:isCached},doSyncSize=function(widthCtrl,heightCtrl){widthCtrl.state.set("oldVal",widthCtrl.value()),heightCtrl.state.set("oldVal",heightCtrl.value())},doSizeControls=function(win,f){var widthCtrl=win.find("#width")[0],heightCtrl=win.find("#height")[0],constrained=win.find("#constrain")[0];widthCtrl&&heightCtrl&&constrained&&f(widthCtrl,heightCtrl,constrained.checked())},doUpdateSize=function(widthCtrl,heightCtrl,isContrained){var oldWidth=widthCtrl.state.get("oldVal"),oldHeight=heightCtrl.state.get("oldVal"),newWidth=widthCtrl.value(),newHeight=heightCtrl.value();isContrained&&oldWidth&&oldHeight&&newWidth&&newHeight&&(newWidth!==oldWidth?(newHeight=Math.round(newWidth/oldWidth*newHeight),isNaN(newHeight)||heightCtrl.value(newHeight)):(newWidth=Math.round(newHeight/oldHeight*newWidth),isNaN(newWidth)||widthCtrl.value(newWidth))),doSyncSize(widthCtrl,heightCtrl)},syncSize=function(win){doSizeControls(win,doSyncSize)},updateSize=function(win){doSizeControls(win,doUpdateSize)},createUi=function(onChange){var recalcSize=function(){onChange(function(win){updateSize(win)})};return{type:"container",label:"Dimensions",layout:"flex",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:5,size:5,onchange:recalcSize,ariaLabel:"Width"},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:5,size:5,onchange:recalcSize,ariaLabel:"Height"},{name:"constrain",type:"checkbox",checked:!0,text:"Constrain proportions"}]}},$_ctm8lcgvjh8lz0vo={createUi:createUi,syncSize:syncSize,updateSize:updateSize},embedChange=global$1.ie&&global$1.ie<=8?"onChange":"onInput",handleError=function(editor){return function(error){var errorMessage=error&&error.msg?"Media embed handler error: "+error.msg:"Media embed handler threw unknown error.";editor.notificationManager.open({type:"error",text:errorMessage})}},getData=function(editor){var element=editor.selection.getNode(),dataEmbed=element.getAttribute("data-ephox-embed-iri");return dataEmbed?{source1:dataEmbed,"data-ephox-embed-iri":dataEmbed,width:$_g4vsn9gmjh8lz0v1.getMaxWidth(element),height:$_g4vsn9gmjh8lz0v1.getMaxHeight(element)}:element.getAttribute("data-mce-object")?$_3nrb4rgijh8lz0uw.htmlToData($_bcg8bpghjh8lz0ut.getScripts(editor),editor.serializer.serialize(element,{selection:!0})):{}},getSource=function(editor){var elm=editor.selection.getNode();if(elm.getAttribute("data-mce-object")||elm.getAttribute("data-ephox-embed-iri"))return editor.selection.getContent()},addEmbedHtml=function(win,editor){return function(response){var html=response.html,embed=win.find("#embed")[0],data=global$2.extend($_3nrb4rgijh8lz0uw.htmlToData($_bcg8bpghjh8lz0ut.getScripts(editor),html),{source1:response.url});win.fromJSON(data),embed&&(embed.value(html),$_ctm8lcgvjh8lz0vo.updateSize(win))}},selectPlaceholder=function(editor,beforeObjects){var i,y,afterObjects=editor.dom.select("img[data-mce-object]");for(i=0;i<beforeObjects.length;i++)for(y=afterObjects.length-1;y>=0;y--)beforeObjects[i]===afterObjects[y]&&afterObjects.splice(y,1);editor.selection.select(afterObjects[0])},handleInsert=function(editor,html){var beforeObjects=editor.dom.select("img[data-mce-object]");editor.insertContent(html),selectPlaceholder(editor,beforeObjects),editor.nodeChanged()},submitForm=function(win,editor){var data=win.toJSON();data.embed=$_ec27xygrjh8lz0va.updateHtml(data.embed,data),data.embed&&$_bqbbyvgnjh8lz0v2.isCached(data.source1)?handleInsert(editor,data.embed):$_bqbbyvgnjh8lz0v2.getEmbedHtml(editor,data).then(function(response){handleInsert(editor,response.html)})["catch"](handleError(editor))},populateMeta=function(win,meta){global$2.each(meta,function(value,key){win.find("#"+key).value(value)})},showDialog=function(editor){var win,data,generalFormItems=[{name:"source1",type:"filepicker",filetype:"media",size:40,autofocus:!0,label:"Source",onpaste:function(){setTimeout(function(){$_bqbbyvgnjh8lz0v2.getEmbedHtml(editor,win.toJSON()).then(addEmbedHtml(win,editor))["catch"](handleError(editor))},1)},onchange:function(e){$_bqbbyvgnjh8lz0v2.getEmbedHtml(editor,win.toJSON()).then(addEmbedHtml(win,editor))["catch"](handleError(editor)),populateMeta(win,e.meta)},onbeforecall:function(e){e.meta=win.toJSON()}}],advancedFormItems=[],reserialise=function(update){update(win),data=win.toJSON(),win.find("#embed").value($_ec27xygrjh8lz0va.updateHtml(data.embed,data))};if($_bcg8bpghjh8lz0ut.hasAltSource(editor)&&advancedFormItems.push({name:"source2",type:"filepicker",filetype:"media",size:40,label:"Alternative source"}),$_bcg8bpghjh8lz0ut.hasPoster(editor)&&advancedFormItems.push({name:"poster",type:"filepicker",filetype:"image",size:40,label:"Poster"}),$_bcg8bpghjh8lz0ut.hasDimensions(editor)){var control=$_ctm8lcgvjh8lz0vo.createUi(reserialise);generalFormItems.push(control)}data=getData(editor);var embedTextBox={id:"mcemediasource",type:"textbox",flex:1,name:"embed",value:getSource(editor),multiline:!0,rows:5,label:"Source"},updateValueOnChange=function(){data=global$2.extend({},$_3nrb4rgijh8lz0uw.htmlToData($_bcg8bpghjh8lz0ut.getScripts(editor),this.value())),this.parent().parent().fromJSON(data)};embedTextBox[embedChange]=updateValueOnChange;var body=[{title:"General",type:"form",items:generalFormItems},{title:"Embed",type:"container",layout:"flex",direction:"column",align:"stretch",padding:10,spacing:10,items:[{type:"label",text:"Paste your embed code below:",forId:"mcemediasource"},embedTextBox]}];advancedFormItems.length>0&&body.push({title:"Advanced",type:"form",items:advancedFormItems}),win=editor.windowManager.open({title:"Insert/edit media",data:data,bodyType:"tabpanel",body:body,onSubmit:function(){$_ctm8lcgvjh8lz0vo.updateSize(win),submitForm(win,editor)}}),$_ctm8lcgvjh8lz0vo.syncSize(win)},$_3l3va1gejh8lz0uo={showDialog:showDialog},get=function(editor){var showDialog=function(){$_3l3va1gejh8lz0uo.showDialog(editor)};return{showDialog:showDialog}},$_baju01gdjh8lz0um={get:get},register=function(editor){var showDialog=function(){$_3l3va1gejh8lz0uo.showDialog(editor)};editor.addCommand("mceMedia",showDialog)},$_bp1t92gwjh8lz0vq={register:register},global$8=tinymce.util.Tools.resolve("tinymce.html.Node"),sanitize=function(editor,html){if($_bcg8bpghjh8lz0ut.shouldFilterHtml(editor)===!1)return html;var blocked,writer=global$6();return global$3({validate:!1,allow_conditional_comments:!1,special:"script,noscript",comment:function(text){writer.comment(text)},cdata:function(text){writer.cdata(text)},text:function(text,raw){writer.text(text,raw)},start:function(name,attrs,empty){if(blocked=!0,"script"!==name&&"noscript"!==name){for(var i=0;i<attrs.length;i++){if(0===attrs[i].name.indexOf("on"))return;"style"===attrs[i].name&&(attrs[i].value=editor.dom.serializeStyle(editor.dom.parseStyle(attrs[i].value),name))}writer.start(name,attrs,empty),blocked=!1}},end:function(name){blocked||writer.end(name)}},global$7({})).parse(html),writer.getContent()},$_6qsq2eh0jh8lz0vz={sanitize:sanitize},createPlaceholderNode=function(editor,node){var placeHolder,name=node.name;return placeHolder=new global$8("img",1),placeHolder.shortEnded=!0,retainAttributesAndInnerHtml(editor,node,placeHolder),placeHolder.attr({width:node.attr("width")||"300",height:node.attr("height")||("audio"===name?"30":"150"),style:node.attr("style"),src:global$1.transparentSrc,"data-mce-object":name,"class":"mce-object mce-object-"+name}),placeHolder},createPreviewIframeNode=function(editor,node){var previewWrapper,previewNode,shimNode,name=node.name;return previewWrapper=new global$8("span",1),previewWrapper.attr({contentEditable:"false",style:node.attr("style"),"data-mce-object":name,"class":"mce-preview-object mce-object-"+name}),retainAttributesAndInnerHtml(editor,node,previewWrapper),previewNode=new global$8(name,1),previewNode.attr({src:node.attr("src"),allowfullscreen:node.attr("allowfullscreen"),style:node.attr("style"),"class":node.attr("class"),width:node.attr("width"),height:node.attr("height"),frameborder:"0"}),shimNode=new global$8("span",1),shimNode.attr("class","mce-shim"),previewWrapper.append(previewNode),previewWrapper.append(shimNode),previewWrapper},retainAttributesAndInnerHtml=function(editor,sourceNode,targetNode){var attrName,attrValue,attribs,ai,innerHtml;for(attribs=sourceNode.attributes,ai=attribs.length;ai--;)attrName=attribs[ai].name,attrValue=attribs[ai].value,"width"!==attrName&&"height"!==attrName&&"style"!==attrName&&("data"!==attrName&&"src"!==attrName||(attrValue=editor.convertURL(attrValue,attrName)),targetNode.attr("data-mce-p-"+attrName,attrValue));innerHtml=sourceNode.firstChild&&sourceNode.firstChild.value,innerHtml&&(targetNode.attr("data-mce-html",escape($_6qsq2eh0jh8lz0vz.sanitize(editor,innerHtml))),targetNode.firstChild=null)},isWithinEphoxEmbed=function(node){for(;node=node.parent;)if(node.attr("data-ephox-embed-iri"))return!0;return!1},placeHolderConverter=function(editor){return function(nodes){for(var node,videoScript,i=nodes.length;i--;)node=nodes[i],node.parent&&(node.parent.attr("data-mce-object")||("script"!==node.name||(videoScript=$_a6mt9vgljh8lz0uz.getVideoScriptMatch($_bcg8bpghjh8lz0ut.getScripts(editor),node.attr("src"))))&&(videoScript&&(videoScript.width&&node.attr("width",videoScript.width.toString()),videoScript.height&&node.attr("height",videoScript.height.toString())),"iframe"===node.name&&$_bcg8bpghjh8lz0ut.hasLiveEmbeds(editor)&&global$1.ceFalse?isWithinEphoxEmbed(node)||node.replace(createPreviewIframeNode(editor,node)):isWithinEphoxEmbed(node)||node.replace(createPlaceholderNode(editor,node))))}},$_avuyrbgzjh8lz0vv={createPreviewIframeNode:createPreviewIframeNode,createPlaceholderNode:createPlaceholderNode,placeHolderConverter:placeHolderConverter},setup=function(editor){editor.on("preInit",function(){var specialElements=editor.schema.getSpecialElements();global$2.each("video audio iframe object".split(" "),function(name){specialElements[name]=new RegExp("</"+name+"[^>]*>","gi")});var boolAttrs=editor.schema.getBoolAttrs();global$2.each("webkitallowfullscreen mozallowfullscreen allowfullscreen".split(" "),function(name){boolAttrs[name]={}}),editor.parser.addNodeFilter("iframe,video,audio,object,embed,script",$_avuyrbgzjh8lz0vv.placeHolderConverter(editor)),editor.serializer.addAttributeFilter("data-mce-object",function(nodes,name){for(var node,realElm,ai,attribs,innerHtml,innerNode,realElmName,className,i=nodes.length;i--;)if(node=nodes[i],node.parent){for(realElmName=node.attr(name),realElm=new global$8(realElmName,1),"audio"!==realElmName&&"script"!==realElmName&&(className=node.attr("class"),className&&className.indexOf("mce-preview-object")!==-1?realElm.attr({width:node.firstChild.attr("width"),height:node.firstChild.attr("height")}):realElm.attr({width:node.attr("width"),height:node.attr("height")})),realElm.attr({style:node.attr("style")}),attribs=node.attributes,ai=attribs.length;ai--;){var attrName=attribs[ai].name;0===attrName.indexOf("data-mce-p-")&&realElm.attr(attrName.substr(11),attribs[ai].value)}"script"===realElmName&&realElm.attr("type","text/javascript"),innerHtml=node.attr("data-mce-html"),innerHtml&&(innerNode=new global$8("#text",3),innerNode.raw=!0,innerNode.value=$_6qsq2eh0jh8lz0vz.sanitize(editor,unescape(innerHtml)),realElm.append(innerNode)),node.replace(realElm)}})}),editor.on("setContent",function(){editor.$("span.mce-preview-object").each(function(index,elm){var $elm=editor.$(elm);0===$elm.find("span.mce-shim",elm).length&&$elm.append('<span class="mce-shim"></span>')})})},$_3u2masgxjh8lz0vs={setup:setup},setup$1=function(editor){editor.on("ResolveName",function(e){var name;1===e.target.nodeType&&(name=e.target.getAttribute("data-mce-object"))&&(e.name=name)})},$_7e0f0eh1jh8lz0w1={setup:setup$1},setup$2=function(editor){editor.on("click keyup",function(){var selectedNode=editor.selection.getNode();selectedNode&&editor.dom.hasClass(selectedNode,"mce-preview-object")&&editor.dom.getAttrib(selectedNode,"data-mce-selected")&&selectedNode.setAttribute("data-mce-selected","2")}),editor.on("ObjectSelected",function(e){var objectType=e.target.getAttribute("data-mce-object");"audio"!==objectType&&"script"!==objectType||e.preventDefault()}),editor.on("objectResized",function(e){var html,target=e.target;target.getAttribute("data-mce-object")&&(html=target.getAttribute("data-mce-html"),html&&(html=unescape(html),target.setAttribute("data-mce-html",escape($_ec27xygrjh8lz0va.updateHtml(html,{width:e.width,height:e.height})))))})},$_firvch2jh8lz0w3={setup:setup$2},register$1=function(editor){editor.addButton("media",{tooltip:"Insert/edit media",cmd:"mceMedia",stateSelector:["img[data-mce-object]","span[data-mce-object]","div[data-ephox-embed-iri]"]}),editor.addMenuItem("media",{icon:"media",text:"Media",cmd:"mceMedia",context:"insert",prependToContext:!0})},$_2oflieh3jh8lz0w4={register:register$1};return global.add("media",function(editor){return $_bp1t92gwjh8lz0vq.register(editor),$_2oflieh3jh8lz0w4.register(editor),$_7e0f0eh1jh8lz0w1.setup(editor),$_3u2masgxjh8lz0vs.setup(editor),$_firvch2jh8lz0w3.setup(editor),$_baju01gdjh8lz0um.get(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-nonbreaking",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),stringRepeat=function(string,repeats){for(var str="",index=0;index<repeats;index++)str+=string;return str},isVisualCharsEnabled=function(editor){return!!editor.plugins.visualchars&&editor.plugins.visualchars.isEnabled()},insertNbsp=function(editor,times){var nbsp=isVisualCharsEnabled(editor)?'<span class="mce-nbsp">&nbsp;</span>':"&nbsp;";editor.insertContent(stringRepeat(nbsp,times)),editor.dom.setAttrib(editor.dom.select("span.mce-nbsp"),"data-mce-bogus","1")},$_fpypash7jh8lz0y5={insertNbsp:insertNbsp},register=function(editor){editor.addCommand("mceNonBreaking",function(){$_fpypash7jh8lz0y5.insertNbsp(editor,1)})},$_45ppimh6jh8lz0y4={register:register},global$1=tinymce.util.Tools.resolve("tinymce.util.VK"),getKeyboardSpaces=function(editor){var spaces=editor.getParam("nonbreaking_force_tab",0);return"boolean"==typeof spaces?spaces===!0?3:0:spaces},$_f73qmzhajh8lz0y7={getKeyboardSpaces:getKeyboardSpaces},setup=function(editor){var spaces=$_f73qmzhajh8lz0y7.getKeyboardSpaces(editor);spaces>0&&editor.on("keydown",function(e){if(e.keyCode===global$1.TAB&&!e.isDefaultPrevented()){if(e.shiftKey)return;e.preventDefault(),e.stopImmediatePropagation(),$_fpypash7jh8lz0y5.insertNbsp(editor,spaces)}})},$_8k27hmh8jh8lz0y6={setup:setup},register$1=function(editor){editor.addButton("nonbreaking",{title:"Nonbreaking space",cmd:"mceNonBreaking"}),editor.addMenuItem("nonbreaking",{icon:"nonbreaking",text:"Nonbreaking space",cmd:"mceNonBreaking",context:"insert"})},$_2kco2nhbjh8lz0y9={register:register$1};return global.add("nonbreaking",function(editor){$_45ppimh6jh8lz0y4.register(editor),$_2kco2nhbjh8lz0y9.register(editor),$_8k27hmh8jh8lz0y6.setup(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-noneditable",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),getNonEditableClass=function(editor){return editor.getParam("noneditable_noneditable_class","mceNonEditable")},getEditableClass=function(editor){return editor.getParam("noneditable_editable_class","mceEditable")},getNonEditableRegExps=function(editor){var nonEditableRegExps=editor.getParam("noneditable_regexp",[]);return nonEditableRegExps&&nonEditableRegExps.constructor===RegExp?[nonEditableRegExps]:nonEditableRegExps},$_9u2u4bhgjh8lz0ym={getNonEditableClass:getNonEditableClass,getEditableClass:getEditableClass,getNonEditableRegExps:getNonEditableRegExps},hasClass=function(checkClassName){return function(node){return(" "+node.attr("class")+" ").indexOf(checkClassName)!==-1}},replaceMatchWithSpan=function(editor,content,cls){return function(match){var args=arguments,index=args[args.length-2],prevChar=index>0?content.charAt(index-1):"";if('"'===prevChar)return match;if(">"===prevChar){var findStartTagIndex=content.lastIndexOf("<",index);if(findStartTagIndex!==-1){var tagHtml=content.substring(findStartTagIndex,index);if(tagHtml.indexOf('contenteditable="false"')!==-1)return match}}return'<span class="'+cls+'" data-mce-content="'+editor.dom.encode(args[0])+'">'+editor.dom.encode("string"==typeof args[1]?args[1]:args[0])+"</span>"}},convertRegExpsToNonEditable=function(editor,nonEditableRegExps,e){var i=nonEditableRegExps.length,content=e.content;if("raw"!==e.format){for(;i--;)content=content.replace(nonEditableRegExps[i],replaceMatchWithSpan(editor,content,$_9u2u4bhgjh8lz0ym.getNonEditableClass(editor)));e.content=content}},setup=function(editor){var editClass,nonEditClass,contentEditableAttrName="contenteditable";editClass=" "+global$1.trim($_9u2u4bhgjh8lz0ym.getEditableClass(editor))+" ",nonEditClass=" "+global$1.trim($_9u2u4bhgjh8lz0ym.getNonEditableClass(editor))+" ";var hasEditClass=hasClass(editClass),hasNonEditClass=hasClass(nonEditClass),nonEditableRegExps=$_9u2u4bhgjh8lz0ym.getNonEditableRegExps(editor);editor.on("PreInit",function(){nonEditableRegExps.length>0&&editor.on("BeforeSetContent",function(e){convertRegExpsToNonEditable(editor,nonEditableRegExps,e)}),editor.parser.addAttributeFilter("class",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],hasEditClass(node)?node.attr(contentEditableAttrName,"true"):hasNonEditClass(node)&&node.attr(contentEditableAttrName,"false")}),editor.serializer.addAttributeFilter(contentEditableAttrName,function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],(hasEditClass(node)||hasNonEditClass(node))&&(nonEditableRegExps.length>0&&node.attr("data-mce-content")?(node.name="#text",node.type=3,node.raw=!0,node.value=node.attr("data-mce-content")):node.attr(contentEditableAttrName,null))})})},$_bsp17lhejh8lz0yi={setup:setup};return global.add("noneditable",function(editor){$_bsp17lhejh8lz0yi.setup(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-pagebreak",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.Env"),getSeparatorHtml=function(editor){return editor.getParam("pagebreak_separator","<!-- pagebreak -->")},shouldSplitBlock=function(editor){return editor.getParam("pagebreak_split_block",!1)},$_cfcp0ehmjh8lz0z6={getSeparatorHtml:getSeparatorHtml,shouldSplitBlock:shouldSplitBlock},getPageBreakClass=function(){return"mce-pagebreak"},getPlaceholderHtml=function(){return'<img src="'+global$1.transparentSrc+'" class="'+getPageBreakClass()+'" data-mce-resize="false" data-mce-placeholder />'},setup=function(editor){var separatorHtml=$_cfcp0ehmjh8lz0z6.getSeparatorHtml(editor),pageBreakSeparatorRegExp=new RegExp(separatorHtml.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"gi");editor.on("BeforeSetContent",function(e){e.content=e.content.replace(pageBreakSeparatorRegExp,getPlaceholderHtml())}),editor.on("PreInit",function(){editor.serializer.addNodeFilter("img",function(nodes){for(var node,className,i=nodes.length;i--;)if(node=nodes[i],className=node.attr("class"),className&&className.indexOf("mce-pagebreak")!==-1){var parentNode=node.parent;if(editor.schema.getBlockElements()[parentNode.name]&&$_cfcp0ehmjh8lz0z6.shouldSplitBlock(editor)){parentNode.type=3,parentNode.value=separatorHtml,parentNode.raw=!0,node.remove();continue}node.type=3,node.value=separatorHtml,node.raw=!0}})})},$_4nscs5hkjh8lz0z3={setup:setup,getPlaceholderHtml:getPlaceholderHtml,getPageBreakClass:getPageBreakClass},register=function(editor){editor.addCommand("mcePageBreak",function(){editor.settings.pagebreak_split_block?editor.insertContent("<p>"+$_4nscs5hkjh8lz0z3.getPlaceholderHtml()+"</p>"):editor.insertContent($_4nscs5hkjh8lz0z3.getPlaceholderHtml())})},$_eeiv35hjjh8lz0z2={register:register},setup$1=function(editor){editor.on("ResolveName",function(e){"IMG"===e.target.nodeName&&editor.dom.hasClass(e.target,$_4nscs5hkjh8lz0z3.getPageBreakClass())&&(e.name="pagebreak")})},$_4vaxechnjh8lz0z7={setup:setup$1},register$1=function(editor){editor.addButton("pagebreak",{
title:"Page break",cmd:"mcePageBreak"}),editor.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"})},$_2d5h02hojh8lz0z8={register:register$1};return global.add("pagebreak",function(editor){$_eeiv35hjjh8lz0z2.register(editor),$_2d5h02hojh8lz0z8.register(editor),$_4nscs5hkjh8lz0z3.setup(editor),$_4vaxechnjh8lz0z7.setup(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-paste",["tinymce"],function(){return function(){!function(){(function(){"use strict";function filter(content,items){return global$3.each(items,function(v){content=v.constructor===RegExp?content.replace(v,""):content.replace(v[0],v[1])}),content}function innerText(html){function walk(node){var name=node.name,currentNode=node;if("br"===name)return void(text+="\n");if(shortEndedElements[name]&&(text+=" "),ignoreElements[name])return void(text+=" ");if(3===node.type&&(text+=node.value),!node.shortEnded&&(node=node.firstChild))do walk(node);while(node=node.next);blockElements[name]&&currentNode.next&&(text+="\n","p"===name&&(text+="\n"))}var schema=global$8(),domParser=global$6({},schema),text="",shortEndedElements=schema.getShortEndedElements(),ignoreElements=global$3.makeMap("script noscript style textarea video audio iframe object"," "),blockElements=schema.getBlockElements();return html=filter(html,[/<!\[[^\]]+\]>/g]),walk(domParser.parse(html)),text}function trimHtml(html){function trimSpaces(all,s1,s2){return s1||s2?" ":" "}return html=filter(html,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,trimSpaces],/<br class="Apple-interchange-newline">/g,/<br>$/i])}function createIdGenerator(prefix){var count=0;return function(){return prefix+count++}}function isWordContent(content){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(content)||/class="OutlineElement/.test(content)||/id="?docs\-internal\-guid\-/.test(content)}function isNumericList(text){var found,patterns;return patterns=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],text=text.replace(/^[\u00a0 ]+/,""),global$3.each(patterns,function(pattern){if(pattern.test(text))return found=!0,!1}),found}function isBulletList(text){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(text)}function convertFakeListsToProperLists(node){function getText(node){var txt="";if(3===node.type)return node.value;if(node=node.firstChild)do txt+=getText(node);while(node=node.next);return txt}function trimListStart(node,regExp){if(3===node.type&&regExp.test(node.value))return node.value=node.value.replace(regExp,""),!1;if(node=node.firstChild)do if(!trimListStart(node,regExp))return!1;while(node=node.next);return!0}function removeIgnoredNodes(node){if(node._listIgnore)return void node.remove();if(node=node.firstChild)do removeIgnoredNodes(node);while(node=node.next)}function convertParagraphToLi(paragraphNode,listName,start){var level=paragraphNode._listLevel||lastLevel;level!==lastLevel&&(level<lastLevel?currentListNode&&(currentListNode=currentListNode.parent.parent):(prevListNode=currentListNode,currentListNode=null)),currentListNode&&currentListNode.name===listName?currentListNode.append(paragraphNode):(prevListNode=prevListNode||currentListNode,currentListNode=new global$7(listName,1),start>1&&currentListNode.attr("start",""+start),paragraphNode.wrap(currentListNode)),paragraphNode.name="li",level>lastLevel&&prevListNode&&prevListNode.lastChild.append(currentListNode),lastLevel=level,removeIgnoredNodes(paragraphNode),trimListStart(paragraphNode,/^\u00a0+/),trimListStart(paragraphNode,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),trimListStart(paragraphNode,/^\u00a0+/)}for(var currentListNode,prevListNode,lastLevel=1,elements=[],child=node.firstChild;"undefined"!=typeof child&&null!==child;)if(elements.push(child),child=child.walk(),null!==child)for(;"undefined"!=typeof child&&child.parent!==node;)child=child.walk();for(var i=0;i<elements.length;i++)if(node=elements[i],"p"===node.name&&node.firstChild){var nodeText=getText(node);if(isBulletList(nodeText)){convertParagraphToLi(node,"ul");continue}if(isNumericList(nodeText)){var matches=/([0-9]+)\./.exec(nodeText),start=1;matches&&(start=parseInt(matches[1],10)),convertParagraphToLi(node,"ol",start);continue}if(node._listLevel){convertParagraphToLi(node,"ul",1);continue}currentListNode=null}else prevListNode=currentListNode,currentListNode=null}function filterStyles(editor,validStyles,node,styleValue){var matches,outputStyles={},styles=editor.dom.parseStyle(styleValue);return global$3.each(styles,function(value,name){switch(name){case"mso-list":matches=/\w+ \w+([0-9]+)/i.exec(styleValue),matches&&(node._listLevel=parseInt(matches[1],10)),/Ignore/i.test(value)&&node.firstChild&&(node._listIgnore=!0,node.firstChild._listIgnore=!0);break;case"horiz-align":name="text-align";break;case"vert-align":name="vertical-align";break;case"font-color":case"mso-foreground":name="color";break;case"mso-background":case"mso-highlight":name="background";break;case"font-weight":case"font-style":return void("normal"!==value&&(outputStyles[name]=value));case"mso-element":if(/^(comment|comment-list)$/i.test(value))return void node.remove()}return 0===name.indexOf("mso-comment")?void node.remove():void(0!==name.indexOf("mso-")&&("all"===$_59kbdnhxjh8lz0zr.getRetainStyleProps(editor)||validStyles&&validStyles[name])&&(outputStyles[name]=value))}),/(bold)/i.test(outputStyles["font-weight"])&&(delete outputStyles["font-weight"],node.wrap(new global$7("b",1))),/(italic)/i.test(outputStyles["font-style"])&&(delete outputStyles["font-style"],node.wrap(new global$7("i",1))),outputStyles=editor.dom.serializeStyle(outputStyles,node.name),outputStyles?outputStyles:null}function addPreProcessFilter(editor,filterFunc){editor.on("PastePreProcess",function(e){e.content=filterFunc(editor,e.content,e.internal,e.wordContent)})}function addPostProcessFilter(editor,filterFunc){editor.on("PastePostProcess",function(e){filterFunc(editor,e.node)})}function removeExplorerBrElementsAfterBlocks(editor,html){if(!$_d6zorbi8jh8lz10j.isWordContent(html))return html;var blockElements=[];global$3.each(editor.schema.getBlockElements(),function(block,blockName){blockElements.push(blockName)});var explorerBlocksRegExp=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+blockElements.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return html=$_exxhefidjh8lz10r.filter(html,[[explorerBlocksRegExp,"$1"]]),html=$_exxhefidjh8lz10r.filter(html,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function removeWebKitStyles(editor,content,internal,isWordHtml){if(isWordHtml||internal)return content;var webKitStyles,webKitStylesSetting=$_59kbdnhxjh8lz0zr.getWebkitStyles(editor);if($_59kbdnhxjh8lz0zr.shouldRemoveWebKitStyles(editor)===!1||"all"===webKitStylesSetting)return content;if(webKitStylesSetting&&(webKitStyles=webKitStylesSetting.split(/[, ]/)),webKitStyles){var dom_1=editor.dom,node_1=editor.selection.getNode();content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(all,before,value,after){var inputStyles=dom_1.parseStyle(dom_1.decode(value)),outputStyles={};if("none"===webKitStyles)return before+after;for(var i=0;i<webKitStyles.length;i++){var inputValue=inputStyles[webKitStyles[i]],currentValue=dom_1.getStyle(node_1,webKitStyles[i],!0);/color/.test(webKitStyles[i])&&(inputValue=dom_1.toHex(inputValue),currentValue=dom_1.toHex(currentValue)),currentValue!==inputValue&&(outputStyles[webKitStyles[i]]=inputValue)}return outputStyles=dom_1.serializeStyle(outputStyles,"span"),outputStyles?before+' style="'+outputStyles+'"'+after:before+after})}else content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return content=content.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(all,before,value,after){return before+' style="'+value+'"'+after})}function removeUnderlineAndFontInAnchor(editor,root){editor.$("a",root).find("font,u").each(function(i,node){editor.dom.remove(node,!0)})}function Plugin(){}var Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),hasProPlugin=function(editor){return!(!/(^|[ ,])powerpaste([, ]|$)/.test(editor.settings.plugins)||!global.get("powerpaste"))&&("undefined"!=typeof window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)},$_5zap27hsjh8lz0zl={hasProPlugin:hasProPlugin},get=function(clipboard,quirks){return{clipboard:clipboard,quirks:quirks}},$_b74kiihtjh8lz0zm={get:get},firePastePreProcess=function(editor,html,internal,isWordHtml){return editor.fire("PastePreProcess",{content:html,internal:internal,wordContent:isWordHtml})},firePastePostProcess=function(editor,node,internal,isWordHtml){return editor.fire("PastePostProcess",{node:node,internal:internal,wordContent:isWordHtml})},firePastePlainTextToggle=function(editor,state){return editor.fire("PastePlainTextToggle",{state:state})},firePaste=function(editor,ieFake){return editor.fire("paste",{ieFake:ieFake})},$_dotjevhwjh8lz0zq={firePastePreProcess:firePastePreProcess,firePastePostProcess:firePastePostProcess,firePastePlainTextToggle:firePastePlainTextToggle,firePaste:firePaste},shouldPlainTextInform=function(editor){return editor.getParam("paste_plaintext_inform",!0)},shouldBlockDrop=function(editor){return editor.getParam("paste_block_drop",!1)},shouldPasteDataImages=function(editor){return editor.getParam("paste_data_images",!1)},shouldFilterDrop=function(editor){return editor.getParam("paste_filter_drop",!0)},getPreProcess=function(editor){return editor.getParam("paste_preprocess")},getPostProcess=function(editor){return editor.getParam("paste_postprocess")},getWebkitStyles=function(editor){return editor.getParam("paste_webkit_styles")},shouldRemoveWebKitStyles=function(editor){return editor.getParam("paste_remove_styles_if_webkit",!0)},shouldMergeFormats=function(editor){return editor.getParam("paste_merge_formats",!0)},isSmartPasteEnabled=function(editor){return editor.getParam("smart_paste",!0)},isPasteAsTextEnabled=function(editor){return editor.getParam("paste_as_text",!1)},getRetainStyleProps=function(editor){return editor.getParam("paste_retain_style_properties")},getWordValidElements=function(editor){var defaultValidElements="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody";return editor.getParam("paste_word_valid_elements",defaultValidElements)},shouldConvertWordFakeLists=function(editor){return editor.getParam("paste_convert_word_fake_lists",!0)},shouldUseDefaultFilters=function(editor){return editor.getParam("paste_enable_default_filters",!0)},$_59kbdnhxjh8lz0zr={shouldPlainTextInform:shouldPlainTextInform,shouldBlockDrop:shouldBlockDrop,shouldPasteDataImages:shouldPasteDataImages,shouldFilterDrop:shouldFilterDrop,getPreProcess:getPreProcess,getPostProcess:getPostProcess,getWebkitStyles:getWebkitStyles,shouldRemoveWebKitStyles:shouldRemoveWebKitStyles,shouldMergeFormats:shouldMergeFormats,isSmartPasteEnabled:isSmartPasteEnabled,isPasteAsTextEnabled:isPasteAsTextEnabled,getRetainStyleProps:getRetainStyleProps,getWordValidElements:getWordValidElements,shouldConvertWordFakeLists:shouldConvertWordFakeLists,shouldUseDefaultFilters:shouldUseDefaultFilters},shouldInformUserAboutPlainText=function(editor,userIsInformedState){return userIsInformedState.get()===!1&&$_59kbdnhxjh8lz0zr.shouldPlainTextInform(editor)},displayNotification=function(editor,message){editor.notificationManager.open({text:editor.translate(message),type:"info"})},togglePlainTextPaste=function(editor,clipboard,userIsInformedState){"text"===clipboard.pasteFormat.get()?(clipboard.pasteFormat.set("html"),$_dotjevhwjh8lz0zq.firePastePlainTextToggle(editor,!1)):(clipboard.pasteFormat.set("text"),$_dotjevhwjh8lz0zq.firePastePlainTextToggle(editor,!0),shouldInformUserAboutPlainText(editor,userIsInformedState)&&(displayNotification(editor,"Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),userIsInformedState.set(!0))),editor.focus()},$_19uwahhvjh8lz0zo={togglePlainTextPaste:togglePlainTextPaste},register=function(editor,clipboard,userIsInformedState){editor.addCommand("mceTogglePlainTextPaste",function(){$_19uwahhvjh8lz0zo.togglePlainTextPaste(editor,clipboard,userIsInformedState)}),editor.addCommand("mceInsertClipboardContent",function(ui,value){value.content&&clipboard.pasteHtml(value.content,value.internal),value.text&&clipboard.pasteText(value.text)})},$_dw9jlohujh8lz0zn={register:register},global$1=tinymce.util.Tools.resolve("tinymce.Env"),global$2=tinymce.util.Tools.resolve("tinymce.util.Delay"),global$3=tinymce.util.Tools.resolve("tinymce.util.Tools"),global$4=tinymce.util.Tools.resolve("tinymce.util.VK"),internalMimeType="x-tinymce/html",internalMark="<!-- "+internalMimeType+" -->",mark=function(html){return internalMark+html},unmark=function(html){return html.replace(internalMark,"")},isMarked=function(html){return html.indexOf(internalMark)!==-1},$_vdmj3i4jh8lz10b={mark:mark,unmark:unmark,isMarked:isMarked,internalHtmlMime:function(){return internalMimeType}},global$5=tinymce.util.Tools.resolve("tinymce.html.Entities"),isPlainText=function(text){return!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(text)},toBRs=function(text){return text.replace(/\r?\n/g,"<br>")},openContainer=function(rootTag,rootAttrs){var key,attrs=[],tag="<"+rootTag;if("object"==typeof rootAttrs){for(key in rootAttrs)rootAttrs.hasOwnProperty(key)&&attrs.push(key+'="'+global$5.encodeAllRaw(rootAttrs[key])+'"');attrs.length&&(tag+=" "+attrs.join(" "))}return tag+">"},toBlockElements=function(text,rootTag,rootAttrs){var blocks=text.split(/\n\n/),tagOpen=openContainer(rootTag,rootAttrs),tagClose="</"+rootTag+">",paragraphs=global$3.map(blocks,function(p){return p.split(/\n/).join("<br />")}),stitch=function(p){return tagOpen+p+tagClose};return 1===paragraphs.length?paragraphs[0]:global$3.map(paragraphs,stitch).join("")},convert=function(text,rootTag,rootAttrs){return rootTag?toBlockElements(text,rootTag,rootAttrs):toBRs(text)},$_q5v7hi5jh8lz10d={isPlainText:isPlainText,convert:convert,toBRs:toBRs,toBlockElements:toBlockElements},global$6=tinymce.util.Tools.resolve("tinymce.html.DomParser"),global$7=tinymce.util.Tools.resolve("tinymce.html.Node"),global$8=tinymce.util.Tools.resolve("tinymce.html.Schema"),global$9=tinymce.util.Tools.resolve("tinymce.html.Serializer"),isMsEdge=function(){return navigator.userAgent.indexOf(" Edge/")!==-1},$_exxhefidjh8lz10r={filter:filter,innerText:innerText,trimHtml:trimHtml,createIdGenerator:createIdGenerator,isMsEdge:isMsEdge},filterWordContent=function(editor,content){var retainStyleProperties,validStyles;retainStyleProperties=$_59kbdnhxjh8lz0zr.getRetainStyleProps(editor),retainStyleProperties&&(validStyles=global$3.makeMap(retainStyleProperties.split(/[, ]/))),content=$_exxhefidjh8lz10r.filter(content,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(str,spaces){return spaces.length>0?spaces.replace(/./," ").slice(Math.floor(spaces.length/2)).split("").join(" "):""}]]);var validElements=$_59kbdnhxjh8lz0zr.getWordValidElements(editor),schema=global$8({valid_elements:validElements,valid_children:"-li[p]"});global$3.each(schema.elements,function(rule){rule.attributes["class"]||(rule.attributes["class"]={},rule.attributesOrder.push("class")),rule.attributes.style||(rule.attributes.style={},rule.attributesOrder.push("style"))});var domParser=global$6({},schema);domParser.addAttributeFilter("style",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],node.attr("style",filterStyles(editor,validStyles,node,node.attr("style"))),"span"===node.name&&node.parent&&!node.attributes.length&&node.unwrap()}),domParser.addAttributeFilter("class",function(nodes){for(var node,className,i=nodes.length;i--;)node=nodes[i],className=node.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(className)&&node.remove(),node.attr("class",null)}),domParser.addNodeFilter("del",function(nodes){for(var i=nodes.length;i--;)nodes[i].remove()}),domParser.addNodeFilter("a",function(nodes){for(var node,href,name,i=nodes.length;i--;)if(node=nodes[i],href=node.attr("href"),name=node.attr("name"),href&&href.indexOf("#_msocom_")!==-1)node.remove();else if(href&&0===href.indexOf("file://")&&(href=href.split("#")[1],href&&(href="#"+href)),href||name){if(name&&!/^_?(?:toc|edn|ftn)/i.test(name)){node.unwrap();continue}node.attr({href:href,name:name})}else node.unwrap()});var rootNode=domParser.parse(content);return $_59kbdnhxjh8lz0zr.shouldConvertWordFakeLists(editor)&&convertFakeListsToProperLists(rootNode),content=global$9({validate:editor.settings.validate},schema).serialize(rootNode)},preProcess=function(editor,content){return $_59kbdnhxjh8lz0zr.shouldUseDefaultFilters(editor)?filterWordContent(editor,content):content},$_d6zorbi8jh8lz10j={preProcess:preProcess,isWordContent:isWordContent},processResult=function(content,cancelled){return{content:content,cancelled:cancelled}},postProcessFilter=function(editor,html,internal,isWordHtml){var tempBody=editor.dom.create("div",{style:"display:none"},html),postProcessArgs=$_dotjevhwjh8lz0zq.firePastePostProcess(editor,tempBody,internal,isWordHtml);return processResult(postProcessArgs.node.innerHTML,postProcessArgs.isDefaultPrevented())},filterContent=function(editor,content,internal,isWordHtml){var preProcessArgs=$_dotjevhwjh8lz0zq.firePastePreProcess(editor,content,internal,isWordHtml);return editor.hasEventListeners("PastePostProcess")&&!preProcessArgs.isDefaultPrevented()?postProcessFilter(editor,preProcessArgs.content,internal,isWordHtml):processResult(preProcessArgs.content,preProcessArgs.isDefaultPrevented())},process=function(editor,html,internal){var isWordHtml=$_d6zorbi8jh8lz10j.isWordContent(html),content=isWordHtml?$_d6zorbi8jh8lz10j.preProcess(editor,html):html;return filterContent(editor,content,internal,isWordHtml)},$_8pb2j8i7jh8lz10f={process:process},pasteHtml=function(editor,html){return editor.insertContent(html,{merge:$_59kbdnhxjh8lz0zr.shouldMergeFormats(editor),paste:!0}),!0},isAbsoluteUrl=function(url){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(url)},isImageUrl=function(url){return isAbsoluteUrl(url)&&/.(gif|jpe?g|png)$/.test(url)},createImage=function(editor,url,pasteHtmlFn){return editor.undoManager.extra(function(){pasteHtmlFn(editor,url)},function(){editor.insertContent('<img src="'+url+'">')}),!0},createLink=function(editor,url,pasteHtmlFn){return editor.undoManager.extra(function(){pasteHtmlFn(editor,url)},function(){editor.execCommand("mceInsertLink",!1,url)}),!0},linkSelection=function(editor,html,pasteHtmlFn){return!(editor.selection.isCollapsed()!==!1||!isAbsoluteUrl(html))&&createLink(editor,html,pasteHtmlFn)},insertImage=function(editor,html,pasteHtmlFn){return!!isImageUrl(html)&&createImage(editor,html,pasteHtmlFn)},smartInsertContent=function(editor,html){global$3.each([linkSelection,insertImage,pasteHtml],function(action){return action(editor,html,pasteHtml)!==!0})},insertContent=function(editor,html){$_59kbdnhxjh8lz0zr.isSmartPasteEnabled(editor)===!1?pasteHtml(editor,html):smartInsertContent(editor,html)},$_d0259ziejh8lz10u={isImageUrl:isImageUrl,isAbsoluteUrl:isAbsoluteUrl,insertContent:insertContent},pasteHtml$1=function(editor,html,internalFlag){var internal=internalFlag?internalFlag:$_vdmj3i4jh8lz10b.isMarked(html),args=$_8pb2j8i7jh8lz10f.process(editor,$_vdmj3i4jh8lz10b.unmark(html),internal);args.cancelled===!1&&$_d0259ziejh8lz10u.insertContent(editor,args.content)},pasteText=function(editor,text){text=editor.dom.encode(text).replace(/\r\n/g,"\n"),text=$_q5v7hi5jh8lz10d.convert(text,editor.settings.forced_root_block,editor.settings.forced_root_block_attrs),pasteHtml$1(editor,text,!1)},getDataTransferItems=function(dataTransfer){var items={},mceInternalUrlPrefix="data:text/mce-internal,";if(dataTransfer){if(dataTransfer.getData){var legacyText=dataTransfer.getData("Text");legacyText&&legacyText.length>0&&legacyText.indexOf(mceInternalUrlPrefix)===-1&&(items["text/plain"]=legacyText)}if(dataTransfer.types)for(var i=0;i<dataTransfer.types.length;i++){var contentType=dataTransfer.types[i];try{items[contentType]=dataTransfer.getData(contentType)}catch(ex){items[contentType]=""}}}return items},getClipboardContent=function(editor,clipboardEvent){var content=getDataTransferItems(clipboardEvent.clipboardData||editor.getDoc().dataTransfer);return $_exxhefidjh8lz10r.isMsEdge()?global$3.extend(content,{"text/html":""}):content},hasContentType=function(clipboardContent,mimeType){return mimeType in clipboardContent&&clipboardContent[mimeType].length>0},hasHtmlOrText=function(content){return hasContentType(content,"text/html")||hasContentType(content,"text/plain")},getBase64FromUri=function(uri){var idx;return idx=uri.indexOf(","),idx!==-1?uri.substr(idx+1):null},isValidDataUriImage=function(settings,imgElm){return!settings.images_dataimg_filter||settings.images_dataimg_filter(imgElm)},extractFilename=function(editor,str){var m=str.match(/([\s\S]+?)\.(?:jpeg|jpg|png|gif)$/i);return m?editor.dom.encode(m[1]):null},uniqueId=$_exxhefidjh8lz10r.createIdGenerator("mceclip"),pasteImage=function(editor,rng,reader,blob){rng&&(editor.selection.setRng(rng),rng=null);var dataUri=reader.result,base64=getBase64FromUri(dataUri),id=uniqueId(),name=editor.settings.images_reuse_filename&&blob.name?extractFilename(editor,blob.name):id,img=new Image;if(img.src=dataUri,isValidDataUriImage(editor.settings,img)){var blobCache=editor.editorUpload.blobCache,blobInfo=void 0,existingBlobInfo=void 0;existingBlobInfo=blobCache.findFirst(function(cachedBlobInfo){return cachedBlobInfo.base64()===base64}),existingBlobInfo?blobInfo=existingBlobInfo:(blobInfo=blobCache.create(id,blob,base64,name),blobCache.add(blobInfo)),pasteHtml$1(editor,'<img src="'+blobInfo.blobUri()+'">',!1)}else pasteHtml$1(editor,'<img src="'+dataUri+'">',!1)},isClipboardEvent=function(event){return"paste"===event.type},pasteImageData=function(editor,e,rng){function processItems(items){var i,item,reader,hadImage=!1;if(items)for(i=0;i<items.length;i++)if(item=items[i],/^image\/(jpeg|png|gif|bmp)$/.test(item.type)){var blob=item.getAsFile?item.getAsFile():item;reader=new window.FileReader,reader.onload=pasteImage.bind(null,editor,rng,reader,blob),reader.readAsDataURL(blob),e.preventDefault(),hadImage=!0}return hadImage}var dataTransfer=isClipboardEvent(e)?e.clipboardData:e.dataTransfer;if(editor.settings.paste_data_images&&dataTransfer)return processItems(dataTransfer.items)||processItems(dataTransfer.files)},isBrokenAndroidClipboardEvent=function(e){var clipboardData=e.clipboardData;return navigator.userAgent.indexOf("Android")!==-1&&clipboardData&&clipboardData.items&&0===clipboardData.items.length},isKeyboardPasteEvent=function(e){return global$4.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode},registerEventHandlers=function(editor,pasteBin,pasteFormat){function insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode,internal){var content,isPlainTextHtml;return hasContentType(clipboardContent,"text/html")?content=clipboardContent["text/html"]:(content=pasteBin.getHtml(),internal=internal?internal:$_vdmj3i4jh8lz10b.isMarked(content),pasteBin.isDefaultContent(content)&&(plainTextMode=!0)),content=$_exxhefidjh8lz10r.trimHtml(content),pasteBin.remove(),isPlainTextHtml=internal===!1&&$_q5v7hi5jh8lz10d.isPlainText(content),content.length&&!isPlainTextHtml||(plainTextMode=!0),plainTextMode&&(content=hasContentType(clipboardContent,"text/plain")&&isPlainTextHtml?clipboardContent["text/plain"]:$_exxhefidjh8lz10r.innerText(content)),pasteBin.isDefaultContent(content)?void(isKeyBoardPaste||editor.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")):void(plainTextMode?pasteText(editor,content):pasteHtml$1(editor,content,internal))}var keyboardPastePlainTextState,keyboardPasteTimeStamp=0;editor.on("keydown",function(e){function removePasteBinOnKeyUp(e){isKeyboardPasteEvent(e)&&!e.isDefaultPrevented()&&pasteBin.remove()}if(isKeyboardPasteEvent(e)&&!e.isDefaultPrevented()){if(keyboardPastePlainTextState=e.shiftKey&&86===e.keyCode,keyboardPastePlainTextState&&global$1.webkit&&navigator.userAgent.indexOf("Version/")!==-1)return;if(e.stopImmediatePropagation(),keyboardPasteTimeStamp=(new Date).getTime(),global$1.ie&&keyboardPastePlainTextState)return e.preventDefault(),void $_dotjevhwjh8lz0zq.firePaste(editor,!0);pasteBin.remove(),pasteBin.create(),editor.once("keyup",removePasteBinOnKeyUp),editor.once("paste",function(){editor.off("keyup",removePasteBinOnKeyUp)})}});var getLastRng=function(){return pasteBin.getLastRng()||editor.selection.getRng()};editor.on("paste",function(e){var clipboardTimer=(new Date).getTime(),clipboardContent=getClipboardContent(editor,e),clipboardDelay=(new Date).getTime()-clipboardTimer,isKeyBoardPaste=(new Date).getTime()-keyboardPasteTimeStamp-clipboardDelay<1e3,plainTextMode="text"===pasteFormat.get()||keyboardPastePlainTextState,internal=hasContentType(clipboardContent,$_vdmj3i4jh8lz10b.internalHtmlMime());return keyboardPastePlainTextState=!1,e.isDefaultPrevented()||isBrokenAndroidClipboardEvent(e)?void pasteBin.remove():!hasHtmlOrText(clipboardContent)&&pasteImageData(editor,e,getLastRng())?void pasteBin.remove():(isKeyBoardPaste||e.preventDefault(),!global$1.ie||isKeyBoardPaste&&!e.ieFake||hasContentType(clipboardContent,"text/html")||(pasteBin.create(),editor.dom.bind(pasteBin.getEl(),"paste",function(e){e.stopPropagation()}),editor.getDoc().execCommand("Paste",!1,null),clipboardContent["text/html"]=pasteBin.getHtml()),void(hasContentType(clipboardContent,"text/html")?(e.preventDefault(),internal||(internal=$_vdmj3i4jh8lz10b.isMarked(clipboardContent["text/html"])),insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode,internal)):global$2.setEditorTimeout(editor,function(){insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode,internal)},0)))})},registerEventsAndFilters=function(editor,pasteBin,pasteFormat){registerEventHandlers(editor,pasteBin,pasteFormat);var src;editor.parser.addNodeFilter("img",function(nodes,name,args){var isPasteInsert=function(args){return args.data&&args.data.paste===!0},remove=function(node){node.attr("data-mce-object")||src===global$1.transparentSrc||node.remove()},isWebKitFakeUrl=function(src){return 0===src.indexOf("webkit-fake-url")},isDataUri=function(src){return 0===src.indexOf("data:")};if(!editor.settings.paste_data_images&&isPasteInsert(args))for(var i=nodes.length;i--;)src=nodes[i].attributes.map.src,src&&(isWebKitFakeUrl(src)?remove(nodes[i]):!editor.settings.allow_html_data_urls&&isDataUri(src)&&remove(nodes[i]))})},getPasteBinParent=function(editor){return global$1.ie&&editor.inline?document.body:editor.getBody()},isExternalPasteBin=function(editor){return getPasteBinParent(editor)!==editor.getBody()},delegatePasteEvents=function(editor,pasteBinElm){isExternalPasteBin(editor)&&editor.dom.bind(pasteBinElm,"paste keyup",function(e){setTimeout(function(){editor.fire("paste")},0)})},create=function(editor,lastRngCell,pasteBinDefaultContent){var pasteBinElm,dom=editor.dom,body=editor.getBody();lastRngCell.set(editor.selection.getRng()),pasteBinElm=editor.dom.add(getPasteBinParent(editor),"div",{id:"mcepastebin","class":"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},pasteBinDefaultContent),(global$1.ie||global$1.gecko)&&dom.setStyle(pasteBinElm,"left","rtl"===dom.getStyle(body,"direction",!0)?65535:-65535),dom.bind(pasteBinElm,"beforedeactivate focusin focusout",function(e){e.stopPropagation()}),delegatePasteEvents(editor,pasteBinElm),pasteBinElm.focus(),editor.selection.select(pasteBinElm,!0)},remove=function(editor,lastRngCell){if(getEl(editor)){for(var pasteBinClone=void 0,lastRng=lastRngCell.get();pasteBinClone=editor.dom.get("mcepastebin");)editor.dom.remove(pasteBinClone),editor.dom.unbind(pasteBinClone);lastRng&&editor.selection.setRng(lastRng)}lastRngCell.set(null)},getEl=function(editor){return editor.dom.get("mcepastebin")},getHtml=function(editor){var pasteBinElm,pasteBinClones,i,dirtyWrappers,cleanWrapper,copyAndRemove=function(toElm,fromElm){toElm.appendChild(fromElm),editor.dom.remove(fromElm,!0)};for(pasteBinClones=global$3.grep(getPasteBinParent(editor).childNodes,function(elm){return"mcepastebin"===elm.id}),pasteBinElm=pasteBinClones.shift(),global$3.each(pasteBinClones,function(pasteBinClone){copyAndRemove(pasteBinElm,pasteBinClone)}),dirtyWrappers=editor.dom.select("div[id=mcepastebin]",pasteBinElm),i=dirtyWrappers.length-1;i>=0;i--)cleanWrapper=editor.dom.create("div"),pasteBinElm.insertBefore(cleanWrapper,dirtyWrappers[i]),copyAndRemove(cleanWrapper,dirtyWrappers[i]);return pasteBinElm?pasteBinElm.innerHTML:""},getLastRng=function(lastRng){return lastRng.get()},isDefaultContent=function(pasteBinDefaultContent,content){return content===pasteBinDefaultContent},isPasteBin=function(elm){return elm&&"mcepastebin"===elm.id},isDefault=function(editor,pasteBinDefaultContent){var pasteBinElm=getEl(editor);return isPasteBin(pasteBinElm)&&isDefaultContent(pasteBinDefaultContent,pasteBinElm.innerHTML)},PasteBin=function(editor){var lastRng=Cell(null),pasteBinDefaultContent="%MCEPASTEBIN%";return{create:function(){return create(editor,lastRng,pasteBinDefaultContent)},remove:function(){return remove(editor,lastRng)},getEl:function(){return getEl(editor)},getHtml:function(){return getHtml(editor)},getLastRng:function(){return getLastRng(lastRng)},isDefault:function(){return isDefault(editor,pasteBinDefaultContent)},isDefaultContent:function(content){return isDefaultContent(pasteBinDefaultContent,content)}}},Clipboard=function(editor,pasteFormat){var pasteBin=PasteBin(editor);return editor.on("preInit",function(){return registerEventsAndFilters(editor,pasteBin,pasteFormat)}),{pasteFormat:pasteFormat,pasteHtml:function(html,internalFlag){return pasteHtml$1(editor,html,internalFlag)},pasteText:function(text){return pasteText(editor,text)},pasteImageData:function(e,rng){return pasteImageData(editor,e,rng)},getDataTransferItems:getDataTransferItems,hasHtmlOrText:hasHtmlOrText,hasContentType:hasContentType}},noop=function(){},hasWorkingClipboardApi=function(clipboardData){return global$1.iOS===!1&&void 0!==clipboardData&&"function"==typeof clipboardData.setData&&$_exxhefidjh8lz10r.isMsEdge()!==!0},setHtml5Clipboard=function(clipboardData,html,text){if(!hasWorkingClipboardApi(clipboardData))return!1;try{return clipboardData.clearData(),clipboardData.setData("text/html",html),clipboardData.setData("text/plain",text),clipboardData.setData($_vdmj3i4jh8lz10b.internalHtmlMime(),html),!0}catch(e){return!1}},setClipboardData=function(evt,data,fallback,done){setHtml5Clipboard(evt.clipboardData,data.html,data.text)?(evt.preventDefault(),done()):fallback(data.html,done)},fallback=function(editor){return function(html,done){var markedHtml=$_vdmj3i4jh8lz10b.mark(html),outer=editor.dom.create("div",{
contenteditable:"false","data-mce-bogus":"all"}),inner=editor.dom.create("div",{contenteditable:"true"},markedHtml);editor.dom.setStyles(outer,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),outer.appendChild(inner),editor.dom.add(editor.getBody(),outer);var range=editor.selection.getRng();inner.focus();var offscreenRange=editor.dom.createRng();offscreenRange.selectNodeContents(inner),editor.selection.setRng(offscreenRange),setTimeout(function(){editor.selection.setRng(range),outer.parentNode.removeChild(outer),done()},0)}},getData=function(editor){return{html:editor.selection.getContent({contextual:!0}),text:editor.selection.getContent({format:"text"})}},cut=function(editor){return function(evt){editor.selection.isCollapsed()===!1&&setClipboardData(evt,getData(editor),fallback(editor),function(){setTimeout(function(){editor.execCommand("Delete")},0)})}},copy=function(editor){return function(evt){editor.selection.isCollapsed()===!1&&setClipboardData(evt,getData(editor),fallback(editor),noop)}},register$1=function(editor){editor.on("cut",cut(editor)),editor.on("copy",copy(editor))},$_dic32vigjh8lz113={register:register$1},global$10=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),getCaretRangeFromEvent=function(editor,e){return global$10.getCaretRangeFromPoint(e.clientX,e.clientY,editor.getDoc())},isPlainTextFileUrl=function(content){var plainTextContent=content["text/plain"];return!!plainTextContent&&0===plainTextContent.indexOf("file://")},setFocusedRange=function(editor,rng){editor.focus(),editor.selection.setRng(rng)},setup=function(editor,clipboard,draggingInternallyState){$_59kbdnhxjh8lz0zr.shouldBlockDrop(editor)&&editor.on("dragend dragover draggesture dragdrop drop drag",function(e){e.preventDefault(),e.stopPropagation()}),$_59kbdnhxjh8lz0zr.shouldPasteDataImages(editor)||editor.on("drop",function(e){var dataTransfer=e.dataTransfer;dataTransfer&&dataTransfer.files&&dataTransfer.files.length>0&&e.preventDefault()}),editor.on("drop",function(e){var dropContent,rng;if(rng=getCaretRangeFromEvent(editor,e),!e.isDefaultPrevented()&&!draggingInternallyState.get()){dropContent=clipboard.getDataTransferItems(e.dataTransfer);var internal=clipboard.hasContentType(dropContent,$_vdmj3i4jh8lz10b.internalHtmlMime());if((clipboard.hasHtmlOrText(dropContent)&&!isPlainTextFileUrl(dropContent)||!clipboard.pasteImageData(e,rng))&&rng&&$_59kbdnhxjh8lz0zr.shouldFilterDrop(editor)){var content_1=dropContent["mce-internal"]||dropContent["text/html"]||dropContent["text/plain"];content_1&&(e.preventDefault(),global$2.setEditorTimeout(editor,function(){editor.undoManager.transact(function(){dropContent["mce-internal"]&&editor.execCommand("Delete"),setFocusedRange(editor,rng),content_1=$_exxhefidjh8lz10r.trimHtml(content_1),dropContent["text/html"]?clipboard.pasteHtml(content_1,internal):clipboard.pasteText(content_1)})}))}}}),editor.on("dragstart",function(e){draggingInternallyState.set(!0)}),editor.on("dragover dragend",function(e){$_59kbdnhxjh8lz0zr.shouldPasteDataImages(editor)&&draggingInternallyState.get()===!1&&(e.preventDefault(),setFocusedRange(editor,getCaretRangeFromEvent(editor,e))),"dragend"===e.type&&draggingInternallyState.set(!1)})},$_2b0t7zihjh8lz116={setup:setup},setup$1=function(editor){var plugin=editor.plugins.paste,preProcess=$_59kbdnhxjh8lz0zr.getPreProcess(editor);preProcess&&editor.on("PastePreProcess",function(e){preProcess.call(plugin,plugin,e)});var postProcess=$_59kbdnhxjh8lz0zr.getPostProcess(editor);postProcess&&editor.on("PastePostProcess",function(e){postProcess.call(plugin,plugin,e)})},$_3fvf8sijjh8lz119={setup:setup$1},setup$2=function(editor){global$1.webkit&&addPreProcessFilter(editor,removeWebKitStyles),global$1.ie&&(addPreProcessFilter(editor,removeExplorerBrElementsAfterBlocks),addPostProcessFilter(editor,removeUnderlineAndFontInAnchor))},$_cmw2n5ikjh8lz11b={setup:setup$2},noop$1=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i]},noarg=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return f()}},compose=function(fa,fb){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return fa(fb.apply(null,arguments))}},constant=function(value){return function(){return value}},identity=function(x){return x},tripleEquals=function(a,b){return a===b},curry=function(f){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];for(var args=new Array(arguments.length-1),i=1;i<arguments.length;i++)args[i-1]=arguments[i];return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];for(var newArgs=new Array(arguments.length),j=0;j<newArgs.length;j++)newArgs[j]=arguments[j];var all=args.concat(newArgs);return f.apply(null,all)}},not=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return!f.apply(null,arguments)}},die=function(msg){return function(){throw new Error(msg)}},apply=function(f){return f()},call=function(f){f()},never=constant(!1),always=constant(!0),$_6je1ceimjh8lz11h={noop:noop$1,noarg:noarg,compose:compose,constant:constant,identity:identity,tripleEquals:tripleEquals,curry:curry,not:not,die:die,apply:apply,call:call,never:never,always:always},stateChange=function(editor,clipboard,e){var ctrl=e.control;ctrl.active("text"===clipboard.pasteFormat.get()),editor.on("PastePlainTextToggle",function(e){ctrl.active(e.state)})},register$2=function(editor,clipboard){var postRender=$_6je1ceimjh8lz11h.curry(stateChange,editor,clipboard);editor.addButton("pastetext",{active:!1,icon:"pastetext",tooltip:"Paste as text",cmd:"mceTogglePlainTextPaste",onPostRender:postRender}),editor.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:clipboard.pasteFormat,cmd:"mceTogglePlainTextPaste",onPostRender:postRender})},$_f92o70iljh8lz11e={register:register$2};return global.add("paste",function(editor){if($_5zap27hsjh8lz0zl.hasProPlugin(editor)===!1){var userIsInformedState=Cell(!1),draggingInternallyState=Cell(!1),pasteFormat=Cell($_59kbdnhxjh8lz0zr.isPasteAsTextEnabled(editor)?"text":"html"),clipboard=Clipboard(editor,pasteFormat),quirks=$_cmw2n5ikjh8lz11b.setup(editor);return $_f92o70iljh8lz11e.register(editor,clipboard),$_dw9jlohujh8lz0zn.register(editor,clipboard,userIsInformedState),$_3fvf8sijjh8lz119.setup(editor),$_dic32vigjh8lz113.register(editor),$_2b0t7zihjh8lz116.setup(editor,clipboard,draggingInternallyState),$_b74kiihtjh8lz0zm.get(clipboard,quirks)}}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-preview",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.Env"),getPreviewDialogWidth=function(editor){return parseInt(editor.getParam("plugin_preview_width","650"),10)},getPreviewDialogHeight=function(editor){return parseInt(editor.getParam("plugin_preview_height","500"),10)},getContentStyle=function(editor){return editor.getParam("content_style","")},$_71hkk4isjh8lz146={getPreviewDialogWidth:getPreviewDialogWidth,getPreviewDialogHeight:getPreviewDialogHeight,getContentStyle:getContentStyle},global$2=tinymce.util.Tools.resolve("tinymce.util.Tools"),getPreviewHtml=function(editor){var previewHtml,headHtml="",encode=editor.dom.encode,contentStyle=$_71hkk4isjh8lz146.getContentStyle(editor);headHtml+='<base href="'+encode(editor.documentBaseURI.getURI())+'">',contentStyle&&(headHtml+='<style type="text/css">'+contentStyle+"</style>"),global$2.each(editor.contentCSS,function(url){headHtml+='<link type="text/css" rel="stylesheet" href="'+encode(editor.documentBaseURI.toAbsolute(url))+'">'});var bodyId=editor.settings.body_id||"tinymce";bodyId.indexOf("=")!==-1&&(bodyId=editor.getParam("body_id","","hash"),bodyId=bodyId[editor.id]||bodyId);var bodyClass=editor.settings.body_class||"";bodyClass.indexOf("=")!==-1&&(bodyClass=editor.getParam("body_class","","hash"),bodyClass=bodyClass[editor.id]||"");var preventClicksOnLinksScript='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);</script> ',dirAttr=editor.settings.directionality?' dir="'+editor.settings.directionality+'"':"";return previewHtml="<!DOCTYPE html><html><head>"+headHtml+'</head><body id="'+encode(bodyId)+'" class="mce-content-body '+encode(bodyClass)+'"'+encode(dirAttr)+">"+editor.getContent()+preventClicksOnLinksScript+"</body></html>"},injectIframeContent=function(editor,iframe,sandbox){var previewHtml=getPreviewHtml(editor);if(sandbox)iframe.src="data:text/html;charset=utf-8,"+encodeURIComponent(previewHtml);else{var doc=iframe.contentWindow.document;doc.open(),doc.write(previewHtml),doc.close()}},$_65q2xtitjh8lz147={getPreviewHtml:getPreviewHtml,injectIframeContent:injectIframeContent},open=function(editor){var sandbox=!global$1.ie,dialogHtml='<iframe src="" frameborder="0"'+(sandbox?' sandbox="allow-scripts"':"")+"></iframe>",dialogWidth=$_71hkk4isjh8lz146.getPreviewDialogWidth(editor),dialogHeight=$_71hkk4isjh8lz146.getPreviewDialogHeight(editor);editor.windowManager.open({title:"Preview",width:dialogWidth,height:dialogHeight,html:dialogHtml,buttons:{text:"Close",onclick:function(e){e.control.parent().parent().close()}},onPostRender:function(e){var iframeElm=e.control.getEl("body").firstChild;$_65q2xtitjh8lz147.injectIframeContent(editor,iframeElm,sandbox)}})},$_bncxn7iqjh8lz144={open:open},register=function(editor){editor.addCommand("mcePreview",function(){$_bncxn7iqjh8lz144.open(editor)})},$_5cptv5ipjh8lz143={register:register},register$1=function(editor){editor.addButton("preview",{title:"Preview",cmd:"mcePreview"}),editor.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})},$_fy0w72ivjh8lz14a={register:register$1};return global.add("preview",function(editor){$_5cptv5ipjh8lz143.register(editor),$_fy0w72ivjh8lz14a.register(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-print",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),register=function(editor){editor.addCommand("mcePrint",function(){editor.getWin().print()})},$_62cei9iyjh8lz14q={register:register},register$1=function(editor){editor.addButton("print",{title:"Print",cmd:"mcePrint"}),editor.addMenuItem("print",{text:"Print",cmd:"mcePrint",icon:"print"})},$_75d5qoizjh8lz14r={register:register$1};return global.add("print",function(editor){$_62cei9iyjh8lz14q.register(editor),$_75d5qoizjh8lz14r.register(editor),editor.addShortcut("Meta+P","","mcePrint")}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-save",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$2=tinymce.util.Tools.resolve("tinymce.util.Tools"),enableWhenDirty=function(editor){return editor.getParam("save_enablewhendirty",!0)},hasOnSaveCallback=function(editor){return!!editor.getParam("save_onsavecallback")},hasOnCancelCallback=function(editor){return!!editor.getParam("save_oncancelcallback")},$_8l09i7j6jh8lz151={enableWhenDirty:enableWhenDirty,hasOnSaveCallback:hasOnSaveCallback,hasOnCancelCallback:hasOnCancelCallback},displayErrorMessage=function(editor,message){editor.notificationManager.open({text:editor.translate(message),type:"error"})},save=function(editor){var formObj;if(formObj=global$1.DOM.getParent(editor.id,"form"),!$_8l09i7j6jh8lz151.enableWhenDirty(editor)||editor.isDirty())return editor.save(),$_8l09i7j6jh8lz151.hasOnSaveCallback(editor)?(editor.execCallback("save_onsavecallback",editor),void editor.nodeChanged()):void(formObj?(editor.setDirty(!1),formObj.onsubmit&&!formObj.onsubmit()||("function"==typeof formObj.submit?formObj.submit():displayErrorMessage(editor,"Error: Form submit field collision.")),editor.nodeChanged()):displayErrorMessage(editor,"Error: No form element found."))},cancel=function(editor){var h=global$2.trim(editor.startContent);return $_8l09i7j6jh8lz151.hasOnCancelCallback(editor)?void editor.execCallback("save_oncancelcallback",editor):(editor.setContent(h),editor.undoManager.clear(),void editor.nodeChanged())},$_9mbazj3jh8lz14y={save:save,cancel:cancel},register=function(editor){editor.addCommand("mceSave",function(){$_9mbazj3jh8lz14y.save(editor)}),editor.addCommand("mceCancel",function(){$_9mbazj3jh8lz14y.cancel(editor)})},$_eyzj6nj2jh8lz14x={register:register},stateToggle=function(editor){return function(e){var ctrl=e.control;editor.on("nodeChange dirty",function(){ctrl.disabled($_8l09i7j6jh8lz151.enableWhenDirty(editor)&&!editor.isDirty())})}},register$1=function(editor){editor.addButton("save",{icon:"save",text:"Save",cmd:"mceSave",disabled:!0,onPostRender:stateToggle(editor)}),editor.addButton("cancel",{text:"Cancel",icon:!1,cmd:"mceCancel",disabled:!0,onPostRender:stateToggle(editor)}),editor.addShortcut("Meta+S","","mceSave")},$_3t71l4j7jh8lz152={register:register$1};return global.add("save",function(editor){$_3t71l4j7jh8lz152.register(editor),$_eyzj6nj2jh8lz14x.register(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-searchreplace",["tinymce"],function(){return function(){!function(){(function(){"use strict";function isContentEditableFalse(node){return node&&1===node.nodeType&&"false"===node.contentEditable}function findAndReplaceDOMText(regex,node,replacementNode,captureGroup,schema){function getMatchIndexes(m,captureGroup){if(captureGroup=captureGroup||0,!m[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");var index=m.index;if(captureGroup>0){var cg=m[captureGroup];if(!cg)throw new Error("Invalid capture group");index+=m[0].indexOf(cg),m[0]=cg}return[index,index+m[0].length,[m[0]]]}function getText(node){var txt;if(3===node.nodeType)return node.data;if(hiddenTextElementsMap[node.nodeName]&&!blockElementsMap[node.nodeName])return"";if(txt="",isContentEditableFalse(node))return"\n";if((blockElementsMap[node.nodeName]||shortEndedElementsMap[node.nodeName])&&(txt+="\n"),node=node.firstChild)do txt+=getText(node);while(node=node.nextSibling);return txt}function stepThroughMatches(node,matches,replaceFn){var startNode,endNode,startNodeIndex,endNodeIndex,innerNodes=[],atIndex=0,curNode=node,matchLocation=matches.shift(),matchIndex=0;out:for(;;){if((blockElementsMap[curNode.nodeName]||shortEndedElementsMap[curNode.nodeName]||isContentEditableFalse(curNode))&&atIndex++,3===curNode.nodeType&&(!endNode&&curNode.length+atIndex>=matchLocation[1]?(endNode=curNode,endNodeIndex=matchLocation[1]-atIndex):startNode&&innerNodes.push(curNode),!startNode&&curNode.length+atIndex>matchLocation[0]&&(startNode=curNode,startNodeIndex=matchLocation[0]-atIndex),atIndex+=curNode.length),startNode&&endNode){if(curNode=replaceFn({startNode:startNode,startNodeIndex:startNodeIndex,endNode:endNode,endNodeIndex:endNodeIndex,innerNodes:innerNodes,match:matchLocation[2],matchIndex:matchIndex}),atIndex-=endNode.length-endNodeIndex,startNode=null,endNode=null,innerNodes=[],matchLocation=matches.shift(),matchIndex++,!matchLocation)break}else if(hiddenTextElementsMap[curNode.nodeName]&&!blockElementsMap[curNode.nodeName]||!curNode.firstChild){if(curNode.nextSibling){curNode=curNode.nextSibling;continue}}else if(!isContentEditableFalse(curNode)){curNode=curNode.firstChild;continue}for(;;){if(curNode.nextSibling){curNode=curNode.nextSibling;break}if(curNode.parentNode===node)break out;curNode=curNode.parentNode}}}function genReplacer(nodeName){var makeReplacementNode;if("function"!=typeof nodeName){var stencilNode_1=nodeName.nodeType?nodeName:doc.createElement(nodeName);makeReplacementNode=function(fill,matchIndex){var clone=stencilNode_1.cloneNode(!1);return clone.setAttribute("data-mce-index",matchIndex),fill&&clone.appendChild(doc.createTextNode(fill)),clone}}else makeReplacementNode=nodeName;return function(range){var before,after,parentNode,startNode=range.startNode,endNode=range.endNode,matchIndex=range.matchIndex;if(startNode===endNode){var node_1=startNode;parentNode=node_1.parentNode,range.startNodeIndex>0&&(before=doc.createTextNode(node_1.data.substring(0,range.startNodeIndex)),parentNode.insertBefore(before,node_1));var el=makeReplacementNode(range.match[0],matchIndex);return parentNode.insertBefore(el,node_1),range.endNodeIndex<node_1.length&&(after=doc.createTextNode(node_1.data.substring(range.endNodeIndex)),parentNode.insertBefore(after,node_1)),node_1.parentNode.removeChild(node_1),el}before=doc.createTextNode(startNode.data.substring(0,range.startNodeIndex)),after=doc.createTextNode(endNode.data.substring(range.endNodeIndex));for(var elA=makeReplacementNode(startNode.data.substring(range.startNodeIndex),matchIndex),innerEls=[],i=0,l=range.innerNodes.length;i<l;++i){var innerNode=range.innerNodes[i],innerEl=makeReplacementNode(innerNode.data,matchIndex);innerNode.parentNode.replaceChild(innerEl,innerNode),innerEls.push(innerEl)}var elB=makeReplacementNode(endNode.data.substring(0,range.endNodeIndex),matchIndex);return parentNode=startNode.parentNode,parentNode.insertBefore(before,startNode),parentNode.insertBefore(elA,startNode),parentNode.removeChild(startNode),parentNode=endNode.parentNode,parentNode.insertBefore(elB,endNode),parentNode.insertBefore(after,endNode),parentNode.removeChild(endNode),elB}}var m,text,doc,blockElementsMap,hiddenTextElementsMap,shortEndedElementsMap,matches=[],count=0;if(doc=node.ownerDocument,blockElementsMap=schema.getBlockElements(),hiddenTextElementsMap=schema.getWhiteSpaceElements(),shortEndedElementsMap=schema.getShortEndedElements(),text=getText(node)){if(regex.global)for(;m=regex.exec(text);)matches.push(getMatchIndexes(m,captureGroup));else m=text.match(regex),matches.push(getMatchIndexes(m,captureGroup));return matches.length&&(count=matches.length,stepThroughMatches(node,matches,genReplacer(replacementNode))),count}}function Plugin(){}var Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),$_fsoyimjejh8lz15q={findAndReplaceDOMText:findAndReplaceDOMText},getElmIndex=function(elm){var value=elm.getAttribute("data-mce-index");return"number"==typeof value?""+value:value},markAllMatches=function(editor,currentIndexState,regex){var node,marker;return marker=editor.dom.create("span",{"data-mce-bogus":1}),marker.className="mce-match-marker",node=editor.getBody(),done(editor,currentIndexState,!1),$_fsoyimjejh8lz15q.findAndReplaceDOMText(regex,node,marker,!1,editor.schema)},unwrap=function(node){var parentNode=node.parentNode;node.firstChild&&parentNode.insertBefore(node.firstChild,node),node.parentNode.removeChild(node)},findSpansByIndex=function(editor,index){var nodes,spans=[];if(nodes=global$1.toArray(editor.getBody().getElementsByTagName("span")),nodes.length)for(var i=0;i<nodes.length;i++){var nodeIndex=getElmIndex(nodes[i]);null!==nodeIndex&&nodeIndex.length&&nodeIndex===index.toString()&&spans.push(nodes[i])}return spans},moveSelection=function(editor,currentIndexState,forward){var testIndex=currentIndexState.get(),dom=editor.dom;forward=forward!==!1,forward?testIndex++:testIndex--,dom.removeClass(findSpansByIndex(editor,currentIndexState.get()),"mce-match-marker-selected");var spans=findSpansByIndex(editor,testIndex);return spans.length?(dom.addClass(findSpansByIndex(editor,testIndex),"mce-match-marker-selected"),editor.selection.scrollIntoView(spans[0]),testIndex):-1},removeNode=function(dom,node){var parent=node.parentNode;dom.remove(node),dom.isEmpty(parent)&&dom.remove(parent)},find=function(editor,currentIndexState,text,matchCase,wholeWord){text=text.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),text=text.replace(/\s/g,"\\s"),text=wholeWord?"\\b"+text+"\\b":text;var count=markAllMatches(editor,currentIndexState,new RegExp(text,matchCase?"g":"gi"));return count&&(currentIndexState.set(-1),currentIndexState.set(moveSelection(editor,currentIndexState,!0))),count},next=function(editor,currentIndexState){var index=moveSelection(editor,currentIndexState,!0);index!==-1&&currentIndexState.set(index)},prev=function(editor,currentIndexState){var index=moveSelection(editor,currentIndexState,!1);index!==-1&&currentIndexState.set(index)},isMatchSpan=function(node){var matchIndex=getElmIndex(node);return null!==matchIndex&&matchIndex.length>0},replace=function(editor,currentIndexState,text,forward,all){var i,nodes,node,matchIndex,currentMatchIndex,hasMore,nextIndex=currentIndexState.get();for(forward=forward!==!1,node=editor.getBody(),nodes=global$1.grep(global$1.toArray(node.getElementsByTagName("span")),isMatchSpan),i=0;i<nodes.length;i++){var nodeIndex=getElmIndex(nodes[i]);if(matchIndex=currentMatchIndex=parseInt(nodeIndex,10),all||matchIndex===currentIndexState.get()){for(text.length?(nodes[i].firstChild.nodeValue=text,unwrap(nodes[i])):removeNode(editor.dom,nodes[i]);nodes[++i];){if(matchIndex=parseInt(getElmIndex(nodes[i]),10),matchIndex!==currentMatchIndex){i--;break}removeNode(editor.dom,nodes[i])}forward&&nextIndex--}else currentMatchIndex>currentIndexState.get()&&nodes[i].setAttribute("data-mce-index",currentMatchIndex-1)}return currentIndexState.set(nextIndex),forward?(hasMore=hasNext(editor,currentIndexState),next(editor,currentIndexState)):(hasMore=hasPrev(editor,currentIndexState),prev(editor,currentIndexState)),!all&&hasMore},done=function(editor,currentIndexState,keepEditorSelection){var i,nodes,startContainer,endContainer;for(nodes=global$1.toArray(editor.getBody().getElementsByTagName("span")),i=0;i<nodes.length;i++){var nodeIndex=getElmIndex(nodes[i]);null!==nodeIndex&&nodeIndex.length&&(nodeIndex===currentIndexState.get().toString()&&(startContainer||(startContainer=nodes[i].firstChild),endContainer=nodes[i].firstChild),unwrap(nodes[i]))}if(startContainer&&endContainer){var rng=editor.dom.createRng();return rng.setStart(startContainer,0),rng.setEnd(endContainer,endContainer.data.length),keepEditorSelection!==!1&&editor.selection.setRng(rng),rng}},hasNext=function(editor,currentIndexState){return findSpansByIndex(editor,currentIndexState.get()+1).length>0},hasPrev=function(editor,currentIndexState){return findSpansByIndex(editor,currentIndexState.get()-1).length>0},$_84lfczjcjh8lz15j={done:done,find:find,next:next,prev:prev,replace:replace,hasNext:hasNext,hasPrev:hasPrev},get=function(editor,currentIndexState){var done=function(keepEditorSelection){return $_84lfczjcjh8lz15j.done(editor,currentIndexState,keepEditorSelection)},find=function(text,matchCase,wholeWord){return $_84lfczjcjh8lz15j.find(editor,currentIndexState,text,matchCase,wholeWord)},next=function(){return $_84lfczjcjh8lz15j.next(editor,currentIndexState)},prev=function(){return $_84lfczjcjh8lz15j.prev(editor,currentIndexState)},replace=function(text,forward,all){return $_84lfczjcjh8lz15j.replace(editor,currentIndexState,text,forward,all)};return{done:done,find:find,next:next,prev:prev,replace:replace}},$_9m9g6ojbjh8lz15h={get:get},open=function(editor,currentIndexState){function updateButtonStates(){win.statusbar.find("#next").disabled($_84lfczjcjh8lz15j.hasNext(editor,currentIndexState)===!1),win.statusbar.find("#prev").disabled($_84lfczjcjh8lz15j.hasPrev(editor,currentIndexState)===!1)}function notFoundAlert(){editor.windowManager.alert("Could not find the specified string.",function(){win.find("#find")[0].focus()})}var selectedText,last={};editor.undoManager.add(),selectedText=global$1.trim(editor.selection.getContent({format:"text"}));var win=editor.windowManager.open({layout:"flex",pack:"center",align:"center",onClose:function(){editor.focus(),$_84lfczjcjh8lz15j.done(editor,currentIndexState),editor.undoManager.add()},onSubmit:function(e){var count,caseState,text,wholeWord;return e.preventDefault(),caseState=win.find("#case").checked(),wholeWord=win.find("#words").checked(),text=win.find("#find").value(),text.length?last.text===text&&last.caseState===caseState&&last.wholeWord===wholeWord?$_84lfczjcjh8lz15j.hasNext(editor,currentIndexState)?($_84lfczjcjh8lz15j.next(editor,currentIndexState),void updateButtonStates()):void notFoundAlert():(count=$_84lfczjcjh8lz15j.find(editor,currentIndexState,text,caseState,wholeWord),count||notFoundAlert(),win.statusbar.items().slice(1).disabled(0===count),updateButtonStates(),void(last={text:text,caseState:caseState,wholeWord:wholeWord})):($_84lfczjcjh8lz15j.done(editor,currentIndexState,!1),void win.statusbar.items().slice(1).disabled(!0))},buttons:[{text:"Find",subtype:"primary",onclick:function(){win.submit()}},{text:"Replace",disabled:!0,onclick:function(){$_84lfczjcjh8lz15j.replace(editor,currentIndexState,win.find("#replace").value())||(win.statusbar.items().slice(1).disabled(!0),currentIndexState.set(-1),last={})}},{text:"Replace all",disabled:!0,onclick:function(){$_84lfczjcjh8lz15j.replace(editor,currentIndexState,win.find("#replace").value(),!0,!0),win.statusbar.items().slice(1).disabled(!0),last={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){$_84lfczjcjh8lz15j.prev(editor,currentIndexState),updateButtonStates()}},{text:"Next",name:"next",disabled:!0,onclick:function(){$_84lfczjcjh8lz15j.next(editor,currentIndexState),updateButtonStates()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:selectedText},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}})},$_14sx6wjgjh8lz15v={open:open},register=function(editor,currentIndexState){editor.addCommand("SearchReplace",function(){$_14sx6wjgjh8lz15v.open(editor,currentIndexState)})},$_80q66sjfjh8lz15u={register:register},showDialog=function(editor,currentIndexState){return function(){$_14sx6wjgjh8lz15v.open(editor,currentIndexState)}},register$1=function(editor,currentIndexState){editor.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Meta+F",onclick:showDialog(editor,currentIndexState),separator:"before",context:"edit"}),editor.addButton("searchreplace",{tooltip:"Find and replace",onclick:showDialog(editor,currentIndexState)}),editor.shortcuts.add("Meta+F","",showDialog(editor,currentIndexState))},$_b8zyomjhjh8lz15y={register:register$1};return global.add("searchreplace",function(editor){var currentIndexState=Cell(-1);return $_80q66sjfjh8lz15u.register(editor,currentIndexState),$_b8zyomjhjh8lz15y.register(editor,currentIndexState),$_9m9g6ojbjh8lz15h.get(editor,currentIndexState)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-spellchecker",["tinymce"],function(){return function(){!function(){(function(){"use strict";function isContentEditableFalse(node){return node&&1===node.nodeType&&"false"===node.contentEditable}function Plugin(){}var suggestionsMenu,Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),hasProPlugin=function(editor){return!(!/(^|[ ,])tinymcespellchecker([, ]|$)/.test(editor.settings.plugins)||!global.get("tinymcespellchecker"))&&("undefined"!=typeof window.console&&window.console.log&&window.console.log("Spell Checker Pro is incompatible with Spell Checker plugin! Remove 'spellchecker' from the 'plugins' option."),!0)},$_2a4jkrjljh8lz172={hasProPlugin:hasProPlugin},getLanguages=function(editor){var defaultLanguages="English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv";return editor.getParam("spellchecker_languages",defaultLanguages)},getLanguage=function(editor){var defaultLanguage=editor.getParam("language","en");return editor.getParam("spellchecker_language",defaultLanguage)},getRpcUrl=function(editor){return editor.getParam("spellchecker_rpc_url")},getSpellcheckerCallback=function(editor){return editor.getParam("spellchecker_callback")},getSpellcheckerWordcharPattern=function(editor){var defaultPattern=new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`§©«®±¶·¸»¼½¾¿×÷¤”“„    ]+',"g");return editor.getParam("spellchecker_wordchar_pattern",defaultPattern)},$_g0597ajnjh8lz176={getLanguages:getLanguages,getLanguage:getLanguage,getRpcUrl:getRpcUrl,getSpellcheckerCallback:getSpellcheckerCallback,getSpellcheckerWordcharPattern:getSpellcheckerWordcharPattern},global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),global$2=tinymce.util.Tools.resolve("tinymce.util.URI"),global$3=tinymce.util.Tools.resolve("tinymce.util.XHR"),fireSpellcheckStart=function(editor){return editor.fire("SpellcheckStart")},fireSpellcheckEnd=function(editor){return editor.fire("SpellcheckEnd")},$_91lf17jsjh8lz17g={fireSpellcheckStart:fireSpellcheckStart,fireSpellcheckEnd:fireSpellcheckEnd},DomTextMatcher=function(node,editor){function createMatch(m,data){if(!m[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return{start:m.index,end:m.index+m[0].length,text:m[0],data:data}}function getText(node){var txt;if(3===node.nodeType)return node.data;if(hiddenTextElementsMap[node.nodeName]&&!blockElementsMap[node.nodeName])return"";if(isContentEditableFalse(node))return"\n";if(txt="",(blockElementsMap[node.nodeName]||shortEndedElementsMap[node.nodeName])&&(txt+="\n"),node=node.firstChild)do txt+=getText(node);while(node=node.nextSibling);return txt}function stepThroughMatches(node,matches,replaceFn){var startNode,endNode,startNodeIndex,endNodeIndex,matchLocation,innerNodes=[],atIndex=0,curNode=node,matchIndex=0;matches=matches.slice(0),matches.sort(function(a,b){return a.start-b.start}),matchLocation=matches.shift();out:for(;;){if((blockElementsMap[curNode.nodeName]||shortEndedElementsMap[curNode.nodeName]||isContentEditableFalse(curNode))&&atIndex++,3===curNode.nodeType&&(!endNode&&curNode.length+atIndex>=matchLocation.end?(endNode=curNode,endNodeIndex=matchLocation.end-atIndex):startNode&&innerNodes.push(curNode),!startNode&&curNode.length+atIndex>matchLocation.start&&(startNode=curNode,startNodeIndex=matchLocation.start-atIndex),atIndex+=curNode.length),startNode&&endNode){if(curNode=replaceFn({startNode:startNode,startNodeIndex:startNodeIndex,endNode:endNode,endNodeIndex:endNodeIndex,innerNodes:innerNodes,match:matchLocation.text,matchIndex:matchIndex}),atIndex-=endNode.length-endNodeIndex,startNode=null,endNode=null,innerNodes=[],matchLocation=matches.shift(),matchIndex++,!matchLocation)break}else if(hiddenTextElementsMap[curNode.nodeName]&&!blockElementsMap[curNode.nodeName]||!curNode.firstChild){if(curNode.nextSibling){curNode=curNode.nextSibling;continue}}else if(!isContentEditableFalse(curNode)){curNode=curNode.firstChild;continue}for(;;){if(curNode.nextSibling){curNode=curNode.nextSibling;break}if(curNode.parentNode===node)break out;curNode=curNode.parentNode}}}function genReplacer(callback){function makeReplacementNode(fill,matchIndex){var match=matches[matchIndex];match.stencil||(match.stencil=callback(match));var clone=match.stencil.cloneNode(!1);return clone.setAttribute("data-mce-index",matchIndex),fill&&clone.appendChild(dom.doc.createTextNode(fill)),clone}return function(range){var before,after,parentNode,startNode=range.startNode,endNode=range.endNode,matchIndex=range.matchIndex,doc=dom.doc;if(startNode===endNode){var node_1=startNode;parentNode=node_1.parentNode,range.startNodeIndex>0&&(before=doc.createTextNode(node_1.data.substring(0,range.startNodeIndex)),parentNode.insertBefore(before,node_1));var el=makeReplacementNode(range.match,matchIndex);
return parentNode.insertBefore(el,node_1),range.endNodeIndex<node_1.length&&(after=doc.createTextNode(node_1.data.substring(range.endNodeIndex)),parentNode.insertBefore(after,node_1)),node_1.parentNode.removeChild(node_1),el}before=doc.createTextNode(startNode.data.substring(0,range.startNodeIndex)),after=doc.createTextNode(endNode.data.substring(range.endNodeIndex));for(var elA=makeReplacementNode(startNode.data.substring(range.startNodeIndex),matchIndex),innerEls=[],i=0,l=range.innerNodes.length;i<l;++i){var innerNode=range.innerNodes[i],innerEl=makeReplacementNode(innerNode.data,matchIndex);innerNode.parentNode.replaceChild(innerEl,innerNode),innerEls.push(innerEl)}var elB=makeReplacementNode(endNode.data.substring(0,range.endNodeIndex),matchIndex);return parentNode=startNode.parentNode,parentNode.insertBefore(before,startNode),parentNode.insertBefore(elA,startNode),parentNode.removeChild(startNode),parentNode=endNode.parentNode,parentNode.insertBefore(elB,endNode),parentNode.insertBefore(after,endNode),parentNode.removeChild(endNode),elB}}function unwrapElement(element){var parentNode=element.parentNode;parentNode.insertBefore(element.firstChild,element),element.parentNode.removeChild(element)}function hasClass(elm){return elm.className.indexOf("mce-spellchecker-word")!==-1}function getWrappersByIndex(index){var elements=node.getElementsByTagName("*"),wrappers=[];index="number"==typeof index?""+index:null;for(var i=0;i<elements.length;i++){var element=elements[i],dataIndex=element.getAttribute("data-mce-index");null!==dataIndex&&dataIndex.length&&hasClass(element)&&(dataIndex!==index&&null!==index||wrappers.push(element))}return wrappers}function indexOf(match){for(var i=matches.length;i--;)if(matches[i]===match)return i;return-1}function filter(callback){var filteredMatches=[];return each(function(match,i){callback(match,i)&&filteredMatches.push(match)}),matches=filteredMatches,this}function each(callback){for(var i=0,l=matches.length;i<l&&callback(matches[i],i)!==!1;i++);return this}function wrap(callback){return matches.length&&stepThroughMatches(node,matches,genReplacer(callback)),this}function find(regex,data){if(text&&regex.global)for(;m=regex.exec(text);)matches.push(createMatch(m,data));return this}function unwrap(match){var i,elements=getWrappersByIndex(match?indexOf(match):null);for(i=elements.length;i--;)unwrapElement(elements[i]);return this}function matchFromElement(element){return matches[element.getAttribute("data-mce-index")]}function elementFromMatch(match){return getWrappersByIndex(indexOf(match))[0]}function add(start,length,data){return matches.push({start:start,end:start+length,text:text.substr(start,length),data:data}),this}function rangeFromMatch(match){var wrappers=getWrappersByIndex(indexOf(match)),rng=editor.dom.createRng();return rng.setStartBefore(wrappers[0]),rng.setEndAfter(wrappers[wrappers.length-1]),rng}function replace(match,text){var rng=rangeFromMatch(match);return rng.deleteContents(),text.length>0&&rng.insertNode(editor.dom.doc.createTextNode(text)),rng}function reset(){return matches.splice(0,matches.length),unwrap(),this}var m,text,blockElementsMap,hiddenTextElementsMap,shortEndedElementsMap,matches=[],dom=editor.dom;return blockElementsMap=editor.schema.getBlockElements(),hiddenTextElementsMap=editor.schema.getWhiteSpaceElements(),shortEndedElementsMap=editor.schema.getShortEndedElements(),text=getText(node),{text:text,matches:matches,each:each,filter:filter,reset:reset,matchFromElement:matchFromElement,elementFromMatch:elementFromMatch,find:find,add:add,wrap:wrap,unwrap:unwrap,replace:replace,rangeFromMatch:rangeFromMatch,indexOf:indexOf}},getTextMatcher=function(editor,textMatcherState){if(!textMatcherState.get()){var textMatcher=DomTextMatcher(editor.getBody(),editor);textMatcherState.set(textMatcher)}return textMatcherState.get()},isEmpty=function(obj){for(var _ in obj)return!1;return!0},defaultSpellcheckCallback=function(editor,pluginUrl,currentLanguageState){return function(method,text,doneCallback,errorCallback){var data={method:method,lang:currentLanguageState.get()},postData="";data["addToDictionary"===method?"word":"text"]=text,global$1.each(data,function(value,key){postData&&(postData+="&"),postData+=key+"="+encodeURIComponent(value)}),global$3.send({url:new global$2(pluginUrl).toAbsolute($_g0597ajnjh8lz176.getRpcUrl(editor)),type:"post",content_type:"application/x-www-form-urlencoded",data:postData,success:function(result){if(result=JSON.parse(result))result.error?errorCallback(result.error):doneCallback(result);else{var message=editor.translate("Server response wasn't proper JSON.");errorCallback(message)}},error:function(){var message=editor.translate("The spelling service was not found: (")+$_g0597ajnjh8lz176.getRpcUrl(editor)+editor.translate(")");errorCallback(message)}})}},sendRpcCall=function(editor,pluginUrl,currentLanguageState,name,data,successCallback,errorCallback){var userSpellcheckCallback=$_g0597ajnjh8lz176.getSpellcheckerCallback(editor),spellCheckCallback=userSpellcheckCallback?userSpellcheckCallback:defaultSpellcheckCallback(editor,pluginUrl,currentLanguageState);spellCheckCallback.call(editor.plugins.spellchecker,name,data,successCallback,errorCallback)},spellcheck=function(editor,pluginUrl,startedState,textMatcherState,lastSuggestionsState,currentLanguageState){if(!finish(editor,startedState,textMatcherState)){var errorCallback=function(message){editor.notificationManager.open({text:message,type:"error"}),editor.setProgressState(!1),finish(editor,startedState,textMatcherState)},successCallback=function(data){markErrors(editor,startedState,textMatcherState,lastSuggestionsState,data)};editor.setProgressState(!0),sendRpcCall(editor,pluginUrl,currentLanguageState,"spellcheck",getTextMatcher(editor,textMatcherState).text,successCallback,errorCallback),editor.focus()}},checkIfFinished=function(editor,startedState,textMatcherState){editor.dom.select("span.mce-spellchecker-word").length||finish(editor,startedState,textMatcherState)},addToDictionary=function(editor,pluginUrl,startedState,textMatcherState,currentLanguageState,word,spans){editor.setProgressState(!0),sendRpcCall(editor,pluginUrl,currentLanguageState,"addToDictionary",word,function(){editor.setProgressState(!1),editor.dom.remove(spans,!0),checkIfFinished(editor,startedState,textMatcherState)},function(message){editor.notificationManager.open({text:message,type:"error"}),editor.setProgressState(!1)})},ignoreWord=function(editor,startedState,textMatcherState,word,spans,all){editor.selection.collapse(),all?global$1.each(editor.dom.select("span.mce-spellchecker-word"),function(span){span.getAttribute("data-mce-word")===word&&editor.dom.remove(span,!0)}):editor.dom.remove(spans,!0),checkIfFinished(editor,startedState,textMatcherState)},finish=function(editor,startedState,textMatcherState){if(getTextMatcher(editor,textMatcherState).reset(),textMatcherState.set(null),startedState.get())return startedState.set(!1),$_91lf17jsjh8lz17g.fireSpellcheckEnd(editor),!0},getElmIndex=function(elm){var value=elm.getAttribute("data-mce-index");return"number"==typeof value?""+value:value},findSpansByIndex=function(editor,index){var nodes,spans=[];if(nodes=global$1.toArray(editor.getBody().getElementsByTagName("span")),nodes.length)for(var i=0;i<nodes.length;i++){var nodeIndex=getElmIndex(nodes[i]);null!==nodeIndex&&nodeIndex.length&&nodeIndex===index.toString()&&spans.push(nodes[i])}return spans},markErrors=function(editor,startedState,textMatcherState,lastSuggestionsState,data){var suggestions,hasDictionarySupport;if("string"!=typeof data&&data.words?(hasDictionarySupport=!!data.dictionary,suggestions=data.words):suggestions=data,editor.setProgressState(!1),isEmpty(suggestions)){var message=editor.translate("No misspellings found.");return editor.notificationManager.open({text:message,type:"info"}),void startedState.set(!1)}lastSuggestionsState.set({suggestions:suggestions,hasDictionarySupport:hasDictionarySupport}),getTextMatcher(editor,textMatcherState).find($_g0597ajnjh8lz176.getSpellcheckerWordcharPattern(editor)).filter(function(match){return!!suggestions[match.text]}).wrap(function(match){return editor.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1,"data-mce-word":match.text})}),startedState.set(!0),$_91lf17jsjh8lz17g.fireSpellcheckStart(editor)},$_cw8e2ojojh8lz17a={spellcheck:spellcheck,checkIfFinished:checkIfFinished,addToDictionary:addToDictionary,ignoreWord:ignoreWord,findSpansByIndex:findSpansByIndex,getElmIndex:getElmIndex,markErrors:markErrors},get=function(editor,startedState,lastSuggestionsState,textMatcherState,currentLanguageState,url){var getLanguage=function(){return currentLanguageState.get()},getWordCharPattern=function(){return $_g0597ajnjh8lz176.getSpellcheckerWordcharPattern(editor)},markErrors=function(data){$_cw8e2ojojh8lz17a.markErrors(editor,startedState,textMatcherState,lastSuggestionsState,data)},getTextMatcher=function(){return textMatcherState.get()};return{getTextMatcher:getTextMatcher,getWordCharPattern:getWordCharPattern,markErrors:markErrors,getLanguage:getLanguage}},$_6c6maajmjh8lz174={get:get},register=function(editor,pluginUrl,startedState,textMatcherState,lastSuggestionsState,currentLanguageState){editor.addCommand("mceSpellCheck",function(){$_cw8e2ojojh8lz17a.spellcheck(editor,pluginUrl,startedState,textMatcherState,lastSuggestionsState,currentLanguageState)})},$_2adncojujh8lz17o={register:register},buildMenuItems=function(listName,languageValues){var items=[];return global$1.each(languageValues,function(languageValue){items.push({selectable:!0,text:languageValue.name,data:languageValue.value})}),items},updateSelection=function(editor,currentLanguageState){return function(e){var selectedLanguage=currentLanguageState.get();e.control.items().each(function(ctrl){ctrl.active(ctrl.settings.data===selectedLanguage)})}},getItems=function(editor){return global$1.map($_g0597ajnjh8lz176.getLanguages(editor).split(","),function(langPair){return langPair=langPair.split("="),{name:langPair[0],value:langPair[1]}})},register$1=function(editor,pluginUrl,startedState,textMatcherState,currentLanguageState,lastSuggestionsState){var languageMenuItems=buildMenuItems("Language",getItems(editor)),startSpellchecking=function(){$_cw8e2ojojh8lz17a.spellcheck(editor,pluginUrl,startedState,textMatcherState,lastSuggestionsState,currentLanguageState)},buttonArgs={tooltip:"Spellcheck",onclick:startSpellchecking,onPostRender:function(e){var ctrl=e.control;editor.on("SpellcheckStart SpellcheckEnd",function(){ctrl.active(startedState.get())})}};languageMenuItems.length>1&&(buttonArgs.type="splitbutton",buttonArgs.menu=languageMenuItems,buttonArgs.onshow=updateSelection(editor,currentLanguageState),buttonArgs.onselect=function(e){currentLanguageState.set(e.control.settings.data)}),editor.addButton("spellchecker",buttonArgs),editor.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:startSpellchecking,selectable:!0,onPostRender:function(){var self=this;self.active(startedState.get()),editor.on("SpellcheckStart SpellcheckEnd",function(){self.active(startedState.get())})}})},$_14j9gfjvjh8lz17p={register:register$1},global$4=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$5=tinymce.util.Tools.resolve("tinymce.ui.Factory"),showSuggestions=function(editor,pluginUrl,lastSuggestionsState,startedState,textMatcherState,currentLanguageState,word,spans){var items=[],suggestions=lastSuggestionsState.get().suggestions[word];global$1.each(suggestions,function(suggestion){items.push({text:suggestion,onclick:function(){editor.insertContent(editor.dom.encode(suggestion)),editor.dom.remove(spans),$_cw8e2ojojh8lz17a.checkIfFinished(editor,startedState,textMatcherState)}})}),items.push({text:"-"});var hasDictionarySupport=lastSuggestionsState.get().hasDictionarySupport;hasDictionarySupport&&items.push({text:"Add to Dictionary",onclick:function(){$_cw8e2ojojh8lz17a.addToDictionary(editor,pluginUrl,startedState,textMatcherState,currentLanguageState,word,spans)}}),items.push.apply(items,[{text:"Ignore",onclick:function(){$_cw8e2ojojh8lz17a.ignoreWord(editor,startedState,textMatcherState,word,spans)}},{text:"Ignore all",onclick:function(){$_cw8e2ojojh8lz17a.ignoreWord(editor,startedState,textMatcherState,word,spans,!0)}}]),suggestionsMenu=global$5.create("menu",{items:items,context:"contextmenu",onautohide:function(e){e.target.className.indexOf("spellchecker")!==-1&&e.preventDefault()},onhide:function(){suggestionsMenu.remove(),suggestionsMenu=null}}),suggestionsMenu.renderTo(document.body);var pos=global$4.DOM.getPos(editor.getContentAreaContainer()),targetPos=editor.dom.getPos(spans[0]),root=editor.dom.getRoot();"BODY"===root.nodeName?(targetPos.x-=root.ownerDocument.documentElement.scrollLeft||root.scrollLeft,targetPos.y-=root.ownerDocument.documentElement.scrollTop||root.scrollTop):(targetPos.x-=root.scrollLeft,targetPos.y-=root.scrollTop),pos.x+=targetPos.x,pos.y+=targetPos.y,suggestionsMenu.moveTo(pos.x,pos.y+spans[0].offsetHeight)},setup=function(editor,pluginUrl,lastSuggestionsState,startedState,textMatcherState,currentLanguageState){editor.on("click",function(e){var target=e.target;if("mce-spellchecker-word"===target.className){e.preventDefault();var spans=$_cw8e2ojojh8lz17a.findSpansByIndex(editor,$_cw8e2ojojh8lz17a.getElmIndex(target));if(spans.length>0){var rng=editor.dom.createRng();rng.setStartBefore(spans[0]),rng.setEndAfter(spans[spans.length-1]),editor.selection.setRng(rng),showSuggestions(editor,pluginUrl,lastSuggestionsState,startedState,textMatcherState,currentLanguageState,target.getAttribute("data-mce-word"),spans)}}})},$_6ic81cjwjh8lz181={setup:setup};return global.add("spellchecker",function(editor,pluginUrl){if($_2a4jkrjljh8lz172.hasProPlugin(editor)===!1){var startedState=Cell(!1),currentLanguageState=Cell($_g0597ajnjh8lz176.getLanguage(editor)),textMatcherState=Cell(null),lastSuggestionsState=Cell(null);return $_14j9gfjvjh8lz17p.register(editor,pluginUrl,startedState,textMatcherState,currentLanguageState,lastSuggestionsState),$_6ic81cjwjh8lz181.setup(editor,pluginUrl,lastSuggestionsState,startedState,textMatcherState,currentLanguageState),$_2adncojujh8lz17o.register(editor,pluginUrl,startedState,textMatcherState,lastSuggestionsState,currentLanguageState),$_6c6maajmjh8lz174.get(editor,startedState,lastSuggestionsState,textMatcherState,currentLanguageState,pluginUrl)}}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-tabfocus",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$2=tinymce.util.Tools.resolve("tinymce.EditorManager"),global$3=tinymce.util.Tools.resolve("tinymce.Env"),global$4=tinymce.util.Tools.resolve("tinymce.util.Delay"),global$5=tinymce.util.Tools.resolve("tinymce.util.Tools"),global$6=tinymce.util.Tools.resolve("tinymce.util.VK"),getTabFocusElements=function(editor){return editor.getParam("tabfocus_elements",":prev,:next")},getTabFocus=function(editor){return editor.getParam("tab_focus",getTabFocusElements(editor))},$_949n7ik8jh8lz19m={getTabFocus:getTabFocus},DOM=global$1.DOM,tabCancel=function(e){e.keyCode!==global$6.TAB||e.ctrlKey||e.altKey||e.metaKey||e.preventDefault()},setup=function(editor){function tabHandler(e){function find(direction){function canSelectRecursive(e){return"BODY"===e.nodeName||"hidden"!==e.type&&"none"!==e.style.display&&"hidden"!==e.style.visibility&&canSelectRecursive(e.parentNode)}function canSelect(el){return/INPUT|TEXTAREA|BUTTON/.test(el.tagName)&&global$2.get(e.id)&&el.tabIndex!==-1&&canSelectRecursive(el)}if(el=DOM.select(":input:enabled,*[tabindex]:not(iframe)"),global$5.each(el,function(e,i){if(e.id===editor.id)return x=i,!1}),direction>0){for(i=x+1;i<el.length;i++)if(canSelect(el[i]))return el[i]}else for(i=x-1;i>=0;i--)if(canSelect(el[i]))return el[i];return null}var x,el,v,i;if(!(e.keyCode!==global$6.TAB||e.ctrlKey||e.altKey||e.metaKey||e.isDefaultPrevented())&&(v=global$5.explode($_949n7ik8jh8lz19m.getTabFocus(editor)),1===v.length&&(v[1]=v[0],v[0]=":prev"),el=e.shiftKey?":prev"===v[0]?find(-1):DOM.get(v[0]):":next"===v[1]?find(1):DOM.get(v[1]))){var focusEditor=global$2.get(el.id||el.name);el.id&&focusEditor?focusEditor.focus():global$4.setTimeout(function(){global$3.webkit||window.focus(),el.focus()},10),e.preventDefault()}}editor.on("init",function(){editor.inline&&DOM.setAttrib(editor.getBody(),"tabIndex",null),editor.on("keyup",tabCancel),global$3.gecko?editor.on("keypress keydown",tabHandler):editor.on("keydown",tabHandler)})},$_5hsd2hk1jh8lz19f={setup:setup};return global.add("tabfocus",function(editor){$_5hsd2hk1jh8lz19f.setup(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-table",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Immutable(){for(var fields=[],_i=0;_i<arguments.length;_i++)fields[_i]=arguments[_i];return function(){for(var values=[],_i=0;_i<arguments.length;_i++)values[_i]=arguments[_i];if(fields.length!==values.length)throw new Error('Wrong number of arguments to struct. Expected "['+fields.length+']", got '+values.length+" arguments");var struct={};return $_6b0spykcjh8lz1ao.each(fields,function(name,i){struct[name]=$_bgyjg9kejh8lz1ax.constant(values[i])}),struct}}function MixedBag(required,optional){var everything=required.concat(optional);if(0===everything.length)throw new Error("You must specify at least one required or optional field.");return $_9ogtmjkljh8lz1c0.validateStrArr("required",required),$_9ogtmjkljh8lz1c0.validateStrArr("optional",optional),$_9ogtmjkljh8lz1c0.checkDupes(everything),function(obj){var keys=$_8kti2hkhjh8lz1bt.keys(obj),allReqd=$_6b0spykcjh8lz1ao.forall(required,function(req){return $_6b0spykcjh8lz1ao.contains(keys,req)});allReqd||$_9ogtmjkljh8lz1c0.reqMessage(required,keys);var unsupported=$_6b0spykcjh8lz1ao.filter(keys,function(key){return!$_6b0spykcjh8lz1ao.contains(everything,key)});unsupported.length>0&&$_9ogtmjkljh8lz1c0.unsuppMessage(unsupported);var r={};return $_6b0spykcjh8lz1ao.each(required,function(req){r[req]=$_bgyjg9kejh8lz1ax.constant(obj[req])}),$_6b0spykcjh8lz1ao.each(optional,function(opt){r[opt]=$_bgyjg9kejh8lz1ax.constant(Object.prototype.hasOwnProperty.call(obj,opt)?Option.some(obj[opt]):Option.none())}),r}}function DeviceType(os,browser,userAgent){var isiPad=os.isiOS()&&/ipad/i.test(userAgent)===!0,isiPhone=os.isiOS()&&!isiPad,isAndroid3=os.isAndroid()&&3===os.version.major,isAndroid4=os.isAndroid()&&4===os.version.major,isTablet=isiPad||isAndroid3||isAndroid4&&/mobile/i.test(userAgent)===!0,isTouch=os.isiOS()||os.isAndroid(),isPhone=isTouch&&!isTablet,iOSwebview=browser.isSafari()&&os.isiOS()&&/safari/i.test(userAgent)===!1;return{isiPad:$_bgyjg9kejh8lz1ax.constant(isiPad),isiPhone:$_bgyjg9kejh8lz1ax.constant(isiPhone),isTablet:$_bgyjg9kejh8lz1ax.constant(isTablet),isPhone:$_bgyjg9kejh8lz1ax.constant(isPhone),isTouch:$_bgyjg9kejh8lz1ax.constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:$_bgyjg9kejh8lz1ax.constant(iOSwebview)}}function ClosestOrAncestor(is,ancestor,scope,a,isRoot){return is(scope,a)?Option.some(scope):$_d1kyz8kfjh8lz1az.isFunction(isRoot)&&isRoot(scope)?Option.none():ancestor(scope,a,isRoot)}function NodeValue(is,name){var get=function(element){if(!is(element))throw new Error("Can only get "+name+" value of a "+name+" node");return getOption(element).getOr("")},getOptionIE10=function(element){try{return getOptionSafe(element)}catch(e){return Option.none()}},getOptionSafe=function(element){return is(element)?Option.from(element.dom().nodeValue):Option.none()},browser=$_a6om0dl0jh8lz1ep.detect().browser,getOption=browser.isIE()&&10===browser.version.major?getOptionIE10:getOptionSafe,set=function(element,value){if(!is(element))throw new Error("Can only set raw "+name+" value of a "+name+" node");element.dom().nodeValue=value};return{get:get,getOption:getOption,set:set}}function DomUniverse(){var clone=function(element){return $_6vo9a4krjh8lz1do.fromDom(element.dom().cloneNode(!1))},isBoundary=function(element){return!!$_a3izpgldjh8lz1fy.isElement(element)&&("body"===$_a3izpgldjh8lz1fy.name(element)||$_6b0spykcjh8lz1ao.contains(TagBoundaries,$_a3izpgldjh8lz1fy.name(element)))},isEmptyTag=function(element){return!!$_a3izpgldjh8lz1fy.isElement(element)&&$_6b0spykcjh8lz1ao.contains(["br","img","hr","input"],$_a3izpgldjh8lz1fy.name(element))},comparePosition=function(element,other){return element.dom().compareDocumentPosition(other.dom())},copyAttributesTo=function(source,destination){var as=$_1mp8lglcjh8lz1fq.clone(source);$_1mp8lglcjh8lz1fq.setAll(destination,as)};return{up:$_bgyjg9kejh8lz1ax.constant({selector:$_fiygddlhjh8lz1g7.ancestor,closest:$_fiygddlhjh8lz1g7.closest,predicate:$_aykj0glijh8lz1g9.ancestor,all:$_4hc7u2ktjh8lz1dv.parents}),down:$_bgyjg9kejh8lz1ax.constant({selector:$_coxlualejh8lz1fz.descendants,predicate:$_5a2t82lfjh8lz1g0.descendants}),styles:$_bgyjg9kejh8lz1ax.constant({get:$_3ory84lljh8lz1gx.get,getRaw:$_3ory84lljh8lz1gx.getRaw,set:$_3ory84lljh8lz1gx.set,remove:$_3ory84lljh8lz1gx.remove}),attrs:$_bgyjg9kejh8lz1ax.constant({get:$_1mp8lglcjh8lz1fq.get,set:$_1mp8lglcjh8lz1fq.set,remove:$_1mp8lglcjh8lz1fq.remove,copyTo:copyAttributesTo}),insert:$_bgyjg9kejh8lz1ax.constant({before:$_6qqu1alnjh8lz1hg.before,after:$_6qqu1alnjh8lz1hg.after,afterAll:$_d7tq5mlpjh8lz1hl.after,append:$_6qqu1alnjh8lz1hg.append,appendAll:$_d7tq5mlpjh8lz1hl.append,prepend:$_6qqu1alnjh8lz1hg.prepend,wrap:$_6qqu1alnjh8lz1hg.wrap}),remove:$_bgyjg9kejh8lz1ax.constant({unwrap:$_f2hny0lojh8lz1hi.unwrap,remove:$_f2hny0lojh8lz1hi.remove}),create:$_bgyjg9kejh8lz1ax.constant({nu:$_6vo9a4krjh8lz1do.fromTag,clone:clone,text:$_6vo9a4krjh8lz1do.fromText}),query:$_bgyjg9kejh8lz1ax.constant({comparePosition:comparePosition,prevSibling:$_4hc7u2ktjh8lz1dv.prevSibling,nextSibling:$_4hc7u2ktjh8lz1dv.nextSibling}),property:$_bgyjg9kejh8lz1ax.constant({children:$_4hc7u2ktjh8lz1dv.children,name:$_a3izpgldjh8lz1fy.name,parent:$_4hc7u2ktjh8lz1dv.parent,isText:$_a3izpgldjh8lz1fy.isText,isComment:$_a3izpgldjh8lz1fy.isComment,isElement:$_a3izpgldjh8lz1fy.isElement,getText:$_bri5anlujh8lz1in.get,setText:$_bri5anlujh8lz1in.set,isBoundary:isBoundary,isEmptyTag:isEmptyTag}),eq:$_2eywnlkvjh8lz1e8.eq,is:$_2eywnlkvjh8lz1e8.is}}function Dimension(name,getOffset){var set=function(element,h){if(!$_d1kyz8kfjh8lz1az.isNumber(h)&&!h.match(/^[0-9]+$/))throw name+".set accepts only positive integer values. Value was "+h;var dom=element.dom();$_3r8yz1lmjh8lz1hf.isSupported(dom)&&(dom.style[name]=h+"px")},get=function(element){var r=getOffset(element);if(r<=0||null===r){var css=$_3ory84lljh8lz1gx.get(element,name);return parseFloat(css)||0}return r},getOuter=get,aggregate=function(element,properties){return $_6b0spykcjh8lz1ao.foldl(properties,function(acc,property){var val=$_3ory84lljh8lz1gx.get(element,property),value=void 0===val?0:parseInt(val,10);return isNaN(value)?acc:acc+value},0)},max=function(element,value,properties){var cumulativeInclusions=aggregate(element,properties),absoluteMax=value>cumulativeInclusions?value-cumulativeInclusions:0;return absoluteMax};return{set:set,get:get,getOuter:getOuter,aggregate:aggregate,max:max}}function TableDirection(directionAt){var auto=function(table){return directionAt(table).isRtl()?$_7vn0kzmnjh8lz1p2.rtl:$_7vn0kzmnjh8lz1p2.ltr},delta=function(amount,table){return auto(table).delta(amount,table)},positions=function(cols,table){return auto(table).positions(cols,table)},edge=function(cell){return auto(cell).edge(cell)};return{delta:delta,edge:edge,positions:positions}}function Toggler(turnOff,turnOn,initial){var active=initial||!1,on=function(){turnOn(),active=!0},off=function(){turnOff(),active=!1},toggle=function(){var f=active?off:on;f()},isOn=function(){return active};return{on:on,off:off,toggle:toggle,isOn:isOn}}function onSubmitRowForm(editor,rows,oldData,evt){function setAttrib(elm,name,value){value&&dom.setAttrib(elm,name,value)}function setStyle(elm,name,value){value&&dom.setStyle(elm,name,value)}var dom=editor.dom;$_7mumlpo4jh8lz1zt.updateStyleField(editor,evt);var data=evt.control.rootControl.toJSON();editor.undoManager.transact(function(){global$2.each(rows,function(rowElm){setAttrib(rowElm,"scope",data.scope),setAttrib(rowElm,"style",data.style),setAttrib(rowElm,"class",data["class"]),setStyle(rowElm,"height",addSizeSuffix(data.height)),data.type!==rowElm.parentNode.nodeName.toLowerCase()&&switchRowType(editor.dom,rowElm,data.type),data.align!==oldData.align&&($_fmiiqro3jh8lz1zk.unApplyAlign(editor,rowElm),$_fmiiqro3jh8lz1zk.applyAlign(editor,rowElm,data.align))}),editor.focus()})}function styleTDTH(dom,elm,name,value){if("TD"===elm.tagName||"TH"===elm.tagName)dom.setStyle(elm,name,value);else if(elm.children)for(var i=0;i<elm.children.length;i++)styleTDTH(dom,elm.children[i],name,value)}function Event(fields){var struct=$_d2ojjnkijh8lz1bv.immutable.apply(null,fields),handlers=[],bind=function(handler){if(void 0===handler)throw"Event bind error: undefined handler";handlers.push(handler)},unbind=function(handler){handlers=$_6b0spykcjh8lz1ao.filter(handlers,function(h){return h!==handler})},trigger=function(){var event=struct.apply(null,arguments);$_6b0spykcjh8lz1ao.each(handlers,function(handler){handler(event)})};return{bind:bind,unbind:unbind,trigger:trigger}}function Blocker(options){var settings=$_b4x7eon1jh8lz1se.merge({layerClass:$_d4gfq4omjh8lz247.resolve("blocker")},options),div=$_6vo9a4krjh8lz1do.fromTag("div");$_1mp8lglcjh8lz1fq.set(div,"role","presentation"),$_3ory84lljh8lz1gx.setAll(div,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),$_evf7iendjh8lz1uz.add(div,$_d4gfq4omjh8lz247.resolve("blocker")),$_evf7iendjh8lz1uz.add(div,settings.layerClass);var element=function(){return div},destroy=function(){$_f2hny0lojh8lz1hi.remove(div)};return{element:element,destroy:destroy}}function InDrag(){var previous=Option.none(),reset=function(){previous=Option.none()},update=function(mode,nu){var result=previous.map(function(old){return mode.compare(old,nu)});return previous=Option.some(nu),result},onEvent=function(event,mode){var dataOption=mode.extract(event);dataOption.each(function(data){var offset=update(mode,data);offset.each(function(d){events.trigger.move(d)})})},events=$_cmo273ogjh8lz22b.create({move:Event(["info"])});return{onEvent:onEvent,reset:reset,events:events.registry}}function NoDrag(anchor){var onEvent=function(event,mode){};return{onEvent:onEvent,reset:$_bgyjg9kejh8lz1ax.noop}}function Movement(){var noDragState=NoDrag(),inDragState=InDrag(),dragState=noDragState,on=function(){dragState.reset(),dragState=inDragState},off=function(){dragState.reset(),dragState=noDragState},onEvent=function(event,mode){dragState.onEvent(event,mode)},isOn=function(){return dragState===inDragState};return{on:on,off:off,isOn:isOn,onEvent:onEvent,events:inDragState.events}}function Mutation(){var events=$_cmo273ogjh8lz22b.create({drag:Event(["xDelta","yDelta"])}),mutate=function(x,y){events.trigger.drag(x,y)};return{mutate:mutate,events:events.registry}}function BarMutation(){var events=$_cmo273ogjh8lz22b.create({drag:Event(["xDelta","yDelta","target"])}),target=Option.none(),delegate=Mutation();delegate.events.drag.bind(function(event){target.each(function(t){events.trigger.drag(event.xDelta(),event.yDelta(),t)})});var assign=function(t){target=Option.some(t)},get=function(){return target};return{assign:assign,get:get,mutate:delegate.mutate,events:events.registry}}function BarManager(wire,direction,hdirection){var mutation=BarMutation(),resizing=$_dm1jluoijh8lz23a.transform(mutation,{}),hoverTable=Option.none(),getResizer=function(element,type){return Option.from($_1mp8lglcjh8lz1fq.get(element,type))};mutation.events.drag.bind(function(event){getResizer(event.target(),"data-row").each(function(_dataRow){var currentRow=$_agh84xnrjh8lz1x6.getInt(event.target(),"top");$_3ory84lljh8lz1gx.set(event.target(),"top",currentRow+event.yDelta()+"px")}),getResizer(event.target(),"data-column").each(function(_dataCol){var currentCol=$_agh84xnrjh8lz1x6.getInt(event.target(),"left");$_3ory84lljh8lz1gx.set(event.target(),"left",currentCol+event.xDelta()+"px")})});var getDelta=function(target,direction){var newX=$_agh84xnrjh8lz1x6.getInt(target,direction),oldX=parseInt($_1mp8lglcjh8lz1fq.get(target,"data-initial-"+direction),10);return newX-oldX};resizing.events.stop.bind(function(){mutation.get().each(function(target){hoverTable.each(function(table){getResizer(target,"data-row").each(function(row){var delta=getDelta(target,"top");$_1mp8lglcjh8lz1fq.remove(target,"data-initial-top"),events.trigger.adjustHeight(table,delta,parseInt(row,10))}),getResizer(target,"data-column").each(function(column){var delta=getDelta(target,"left");$_1mp8lglcjh8lz1fq.remove(target,"data-initial-left"),events.trigger.adjustWidth(table,delta,parseInt(column,10))}),$_b9z1gin7jh8lz1tj.refresh(wire,table,hdirection,direction)})})});var handler=function(target,direction){events.trigger.startAdjust(),mutation.assign(target),$_1mp8lglcjh8lz1fq.set(target,"data-initial-"+direction,parseInt($_3ory84lljh8lz1gx.get(target,direction),10)),$_evf7iendjh8lz1uz.add(target,resizeBarDragging),$_3ory84lljh8lz1gx.set(target,"opacity","0.2"),resizing.go(wire.parent())},mousedown=$_5cpulvonjh8lz24a.bind(wire.parent(),"mousedown",function(event){$_b9z1gin7jh8lz1tj.isRowBar(event.target())&&handler(event.target(),"top"),$_b9z1gin7jh8lz1tj.isColBar(event.target())&&handler(event.target(),"left")}),isRoot=function(e){return $_2eywnlkvjh8lz1e8.eq(e,wire.view())},mouseover=$_5cpulvonjh8lz24a.bind(wire.view(),"mouseover",function(event){"table"===$_a3izpgldjh8lz1fy.name(event.target())||$_6z48nsowjh8lz25j.closest(event.target(),"table",isRoot)?(hoverTable="table"===$_a3izpgldjh8lz1fy.name(event.target())?Option.some(event.target()):$_fiygddlhjh8lz1g7.ancestor(event.target(),"table",isRoot),hoverTable.each(function(ht){$_b9z1gin7jh8lz1tj.refresh(wire,ht,hdirection,direction)})):$_brbde9lgjh8lz1g4.inBody(event.target())&&$_b9z1gin7jh8lz1tj.destroy(wire)}),destroy=function(){mousedown.unbind(),mouseover.unbind(),resizing.destroy(),$_b9z1gin7jh8lz1tj.destroy(wire)},refresh=function(tbl){$_b9z1gin7jh8lz1tj.refresh(wire,tbl,hdirection,direction)},events=$_cmo273ogjh8lz22b.create({adjustHeight:Event(["table","delta","row"]),adjustWidth:Event(["table","delta","column"]),startAdjust:Event([])});return{destroy:destroy,refresh:refresh,on:resizing.on,off:resizing.off,hideBars:$_bgyjg9kejh8lz1ax.curry($_b9z1gin7jh8lz1tj.hide,wire),showBars:$_bgyjg9kejh8lz1ax.curry($_b9z1gin7jh8lz1tj.show,wire),events:events.registry}}function TableResize(wire,vdirection){var hdirection=$_sdnutmojh8lz1p3.height,manager=BarManager(wire,vdirection,hdirection),events=$_cmo273ogjh8lz22b.create({beforeResize:Event(["table"]),afterResize:Event(["table"]),startDrag:Event([])});return manager.events.adjustHeight.bind(function(event){events.trigger.beforeResize(event.table());var delta=hdirection.delta(event.delta(),event.table());$_7x5dznnjh8lz1wh.adjustHeight(event.table(),delta,event.row(),hdirection),events.trigger.afterResize(event.table())}),manager.events.startAdjust.bind(function(event){events.trigger.startDrag()}),manager.events.adjustWidth.bind(function(event){events.trigger.beforeResize(event.table());var delta=vdirection.delta(event.delta(),event.table());$_7x5dznnjh8lz1wh.adjustWidth(event.table(),delta,event.column(),vdirection),events.trigger.afterResize(event.table())}),{on:manager.on,off:manager.off,hideBars:manager.hideBars,showBars:manager.showBars,destroy:manager.destroy,events:events.registry}}function WindowBridge(win){var elementFromPoint=function(x,y){return $_6vo9a4krjh8lz1do.fromPoint($_6vo9a4krjh8lz1do.fromDom(win.document),x,y)},getRect=function(element){return element.dom().getBoundingClientRect()},getRangedRect=function(start,soffset,finish,foffset){
var sel=$_8ehldap1jh8lz26p.exact(start,soffset,finish,foffset);return $_3efg7cp3jh8lz272.getFirstRect(win,sel).map(function(structRect){return $_8kti2hkhjh8lz1bt.map(structRect,$_bgyjg9kejh8lz1ax.apply)})},getSelection=function(){return $_3efg7cp3jh8lz272.get(win).map(function(exactAdt){return $_45u5rqpljh8lz2ah.convertToRange(win,exactAdt)})},fromSitus=function(situs){var relative=$_8ehldap1jh8lz26p.relative(situs.start(),situs.finish());return $_45u5rqpljh8lz2ah.convertToRange(win,relative)},situsFromPoint=function(x,y){return $_3efg7cp3jh8lz272.getAtPoint(win,x,y).map(function(exact){return{start:$_bgyjg9kejh8lz1ax.constant($_eviq86p2jh8lz26w.on(exact.start(),exact.soffset())),finish:$_bgyjg9kejh8lz1ax.constant($_eviq86p2jh8lz26w.on(exact.finish(),exact.foffset()))}})},clearSelection=function(){$_3efg7cp3jh8lz272.clear(win)},selectContents=function(element){$_3efg7cp3jh8lz272.setToElement(win,element)},setSelection=function(sel){$_3efg7cp3jh8lz272.setExact(win,sel.start(),sel.soffset(),sel.finish(),sel.foffset())},setRelativeSelection=function(start,finish){$_3efg7cp3jh8lz272.setRelative(win,start,finish)},getInnerHeight=function(){return win.innerHeight},getScrollY=function(){var pos=$_d8doq8pmjh8lz2ay.get($_6vo9a4krjh8lz1do.fromDom(win.document));return pos.top()},scrollBy=function(x,y){$_d8doq8pmjh8lz2ay.by(x,y,$_6vo9a4krjh8lz1do.fromDom(win.document))};return{elementFromPoint:elementFromPoint,getRect:getRect,getRangedRect:getRangedRect,getSelection:getSelection,fromSitus:fromSitus,situsFromPoint:situsFromPoint,clearSelection:clearSelection,setSelection:setSelection,setRelativeSelection:setRelativeSelection,selectContents:selectContents,getInnerHeight:getInnerHeight,getScrollY:getScrollY,scrollBy:scrollBy}}function MouseSelection(bridge,container,isRoot,annotations){var cursor=Option.none(),clearState=function(){cursor=Option.none()},mousedown=function(event){annotations.clear(container),cursor=findCell(event.target(),isRoot)},mouseover=function(event){cursor.each(function(start){annotations.clear(container),findCell(event.target(),isRoot).each(function(finish){$_5tpv0tm0jh8lz1jt.identify(start,finish,isRoot).each(function(cellSel){var boxes=cellSel.boxes().getOr([]);(boxes.length>1||1===boxes.length&&!$_2eywnlkvjh8lz1e8.eq(start,finish))&&(annotations.selectRange(container,boxes,cellSel.start(),cellSel.finish()),bridge.selectContents(finish))})})})},mouseup=function(){cursor.each(clearState)};return{mousedown:mousedown,mouseover:mouseover,mouseup:mouseup}}function CellSelection$1(editor,lazyResize){var handlerStruct=$_d2ojjnkijh8lz1bv.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),handlers=Option.none(),annotations=$_giqnj1q5jh8lz2g7.byAttr($_2yroczmcjh8lz1n4);editor.on("init",function(e){var win=editor.getWin(),body=getBody$1(editor),isRoot=getIsRoot(editor),syncSelection=function(){var sel=editor.selection,start=$_6vo9a4krjh8lz1do.fromDom(sel.getStart()),end=$_6vo9a4krjh8lz1do.fromDom(sel.getEnd()),shared=$_5glne7m1jh8lz1kg.sharedOne($_ee8pmfkojh8lz1ch.table,[start,end]);shared.fold(function(){annotations.clear(body)},$_bgyjg9kejh8lz1ax.noop)},mouseHandlers=$_5i27y1phjh8lz29m.mouse(win,body,isRoot,annotations),keyHandlers=$_5i27y1phjh8lz29m.keyboard(win,body,isRoot,annotations),hasShiftKey=function(event){return event.raw().shiftKey===!0},handleResponse=function(event,response){hasShiftKey(event)&&(response.kill()&&event.kill(),response.selection().each(function(ns){var relative=$_8ehldap1jh8lz26p.relative(ns.start(),ns.finish()),rng=$_dcfxf3p7jh8lz27p.asLtrRange(win,relative);editor.selection.setRng(rng)}))},keyup=function(event){var wrappedEvent=wrapEvent(event);if(wrappedEvent.raw().shiftKey&&$_5bctktpjjh8lz2a1.isNavigation(wrappedEvent.raw().which)){var rng=editor.selection.getRng(),start=$_6vo9a4krjh8lz1do.fromDom(rng.startContainer),end=$_6vo9a4krjh8lz1do.fromDom(rng.endContainer);keyHandlers.keyup(wrappedEvent,start,rng.startOffset,end,rng.endOffset).each(function(response){handleResponse(wrappedEvent,response)})}},keydown=function(event){var wrappedEvent=wrapEvent(event);lazyResize().each(function(resize){resize.hideBars()});var rng=editor.selection.getRng(),startContainer=$_6vo9a4krjh8lz1do.fromDom(editor.selection.getStart()),start=$_6vo9a4krjh8lz1do.fromDom(rng.startContainer),end=$_6vo9a4krjh8lz1do.fromDom(rng.endContainer),direction=$_fe2yjsnvjh8lz1y8.directionAt(startContainer).isRtl()?$_5bctktpjjh8lz2a1.rtl:$_5bctktpjjh8lz2a1.ltr;keyHandlers.keydown(wrappedEvent,start,rng.startOffset,end,rng.endOffset,direction).each(function(response){handleResponse(wrappedEvent,response)}),lazyResize().each(function(resize){resize.showBars()})},isMouseEvent=function(event){return event.hasOwnProperty("x")&&event.hasOwnProperty("y")},wrapEvent=function(event){var target=$_6vo9a4krjh8lz1do.fromDom(event.target),stop=function(){event.stopPropagation()},prevent=function(){event.preventDefault()},kill=$_bgyjg9kejh8lz1ax.compose(prevent,stop);return{target:$_bgyjg9kejh8lz1ax.constant(target),x:$_bgyjg9kejh8lz1ax.constant(isMouseEvent(event)?event.x:null),y:$_bgyjg9kejh8lz1ax.constant(isMouseEvent(event)?event.y:null),stop:stop,prevent:prevent,kill:kill,raw:$_bgyjg9kejh8lz1ax.constant(event)}},isLeftMouse=function(raw){return 0===raw.button},isLeftButtonPressed=function(raw){return void 0===raw.buttons||0!==(1&raw.buttons)},mouseDown=function(e){isLeftMouse(e)&&hasInternalTarget(e)&&mouseHandlers.mousedown(wrapEvent(e))},mouseOver=function(e){isLeftButtonPressed(e)&&hasInternalTarget(e)&&mouseHandlers.mouseover(wrapEvent(e))},mouseUp=function(e){isLeftMouse(e)&&hasInternalTarget(e)&&mouseHandlers.mouseup(wrapEvent(e))};editor.on("mousedown",mouseDown),editor.on("mouseover",mouseOver),editor.on("mouseup",mouseUp),editor.on("keyup",keyup),editor.on("keydown",keydown),editor.on("nodechange",syncSelection),handlers=Option.some(handlerStruct({mousedown:mouseDown,mouseover:mouseOver,mouseup:mouseUp,keyup:keyup,keydown:keydown}))});var destroy=function(){handlers.each(function(handlers){})};return{clear:annotations.clear,destroy:destroy}}function Plugin(editor){var resizeHandler=ResizeHandler(editor),cellSelection=CellSelection$1(editor,resizeHandler.lazyResize),actions=TableActions(editor,resizeHandler.lazyWire),selections=Selections(editor),clipboardRows=Cell(Option.none());return $_cmt2k3nzjh8lz1ym.registerCommands(editor,actions,cellSelection,selections,clipboardRows),$_3x42x9kbjh8lz1a2.registerEvents(editor,selections,actions,cellSelection),$_g08j12qajh8lz2h4.addMenuItems(editor,selections),$_7ezhclq9jh8lz2h1.addButtons(editor),$_7ezhclq9jh8lz2h1.addToolbars(editor),editor.on("PreInit",function(){editor.serializer.addTempAttr($_2yroczmcjh8lz1n4.firstSelected()),editor.serializer.addTempAttr($_2yroczmcjh8lz1n4.lastSelected())}),hasTabNavigation(editor)&&editor.on("keydown",function(e){$_4jcvbhoyjh8lz25x.handle(e,editor,actions,resizeHandler.lazyWire)}),editor.on("remove",function(){resizeHandler.destroy(),cellSelection.destroy()}),getApi(editor,clipboardRows)}function Plugin$1(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),noop=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i]},noarg=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return f()}},compose=function(fa,fb){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return fa(fb.apply(null,arguments))}},constant=function(value){return function(){return value}},identity=function(x){return x},tripleEquals=function(a,b){return a===b},curry=function(f){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];for(var args=new Array(arguments.length-1),i=1;i<arguments.length;i++)args[i-1]=arguments[i];return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];for(var newArgs=new Array(arguments.length),j=0;j<newArgs.length;j++)newArgs[j]=arguments[j];var all=args.concat(newArgs);return f.apply(null,all)}},not=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return!f.apply(null,arguments)}},die=function(msg){return function(){throw new Error(msg)}},apply=function(f){return f()},call=function(f){f()},never=constant(!1),always=constant(!0),$_bgyjg9kejh8lz1ax={noop:noop,noarg:noarg,compose:compose,constant:constant,identity:identity,tripleEquals:tripleEquals,curry:curry,not:not,die:die,apply:apply,call:call,never:never,always:always},never$1=$_bgyjg9kejh8lz1ax.never,always$1=$_bgyjg9kejh8lz1ax.always,none=function(){return NONE},NONE=function(){var eq=function(o){return o.isNone()},call=function(thunk){return thunk()},id=function(n){return n},noop=function(){},me={fold:function(n,s){return n()},is:never$1,isSome:never$1,isNone:always$1,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},or:id,orThunk:call,map:none,ap:none,each:noop,bind:none,flatten:none,exists:never$1,forall:always$1,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:$_bgyjg9kejh8lz1ax.constant("none()")};return Object.freeze&&Object.freeze(me),me}(),some=function(a){var constant_a=function(){return a},self=function(){return me},map=function(f){return some(f(a))},bind=function(f){return f(a)},me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always$1,isNone:never$1,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,or:self,orThunk:self,map:map,ap:function(optfab){return optfab.fold(none,function(fab){return some(fab(a))})},each:function(f){f(a)},bind:bind,flatten:constant_a,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never$1,function(b){return elementEq(a,b)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return me},from=function(value){return null===value||void 0===value?NONE:some(value)},Option={some:some,none:none,from:from},typeOf=function(x){if(null===x)return"null";var t=typeof x;return"object"===t&&Array.prototype.isPrototypeOf(x)?"array":"object"===t&&String.prototype.isPrototypeOf(x)?"string":t},isType=function(type){return function(value){return typeOf(value)===type}},$_d1kyz8kfjh8lz1az={isString:isType("string"),isObject:isType("object"),isArray:isType("array"),isNull:isType("null"),isBoolean:isType("boolean"),isUndefined:isType("undefined"),isFunction:isType("function"),isNumber:isType("number")},rawIndexOf=function(){var pIndexOf=Array.prototype.indexOf,fastIndex=function(xs,x){return pIndexOf.call(xs,x)},slowIndex=function(xs,x){return slowIndexOf(xs,x)};return void 0===pIndexOf?slowIndex:fastIndex}(),indexOf=function(xs,x){var r=rawIndexOf(xs,x);return r===-1?Option.none():Option.some(r)},contains=function(xs,x){return rawIndexOf(xs,x)>-1},exists=function(xs,pred){return findIndex(xs,pred).isSome()},range=function(num,f){for(var r=[],i=0;i<num;i++)r.push(f(i));return r},chunk=function(array,size){for(var r=[],i=0;i<array.length;i+=size){var s=array.slice(i,i+size);r.push(s)}return r},map=function(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i,xs)}return r},each=function(xs,f){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];f(x,i,xs)}},eachr=function(xs,f){for(var i=xs.length-1;i>=0;i--){var x=xs[i];f(x,i,xs)}},partition=function(xs,pred){for(var pass=[],fail=[],i=0,len=xs.length;i<len;i++){var x=xs[i],arr=pred(x,i,xs)?pass:fail;arr.push(x)}return{pass:pass,fail:fail}},filter=function(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i,xs)&&r.push(x)}return r},groupBy=function(xs,f){if(0===xs.length)return[];for(var wasType=f(xs[0]),r=[],group=[],i=0,len=xs.length;i<len;i++){var x=xs[i],type=f(x);type!==wasType&&(r.push(group),group=[]),wasType=type,group.push(x)}return 0!==group.length&&r.push(group),r},foldr=function(xs,f,acc){return eachr(xs,function(x){acc=f(acc,x)}),acc},foldl=function(xs,f,acc){return each(xs,function(x){acc=f(acc,x)}),acc},find=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs))return Option.some(x)}return Option.none()},findIndex=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs))return Option.some(i)}return Option.none()},slowIndexOf=function(xs,x){for(var i=0,len=xs.length;i<len;++i)if(xs[i]===x)return i;return-1},push=Array.prototype.push,flatten=function(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!Array.prototype.isPrototypeOf(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);push.apply(r,xs[i])}return r},bind=function(xs,f){var output=map(xs,f);return flatten(output)},forall=function(xs,pred){for(var i=0,len=xs.length;i<len;++i){var x=xs[i];if(pred(x,i,xs)!==!0)return!1}return!0},equal=function(a1,a2){return a1.length===a2.length&&forall(a1,function(x,i){return x===a2[i]})},slice=Array.prototype.slice,reverse=function(xs){var r=slice.call(xs,0);return r.reverse(),r},difference=function(a1,a2){return filter(a1,function(x){return!contains(a2,x)})},mapToObject=function(xs,f){for(var r={},i=0,len=xs.length;i<len;i++){var x=xs[i];r[String(x)]=f(x,i)}return r},pure=function(x){return[x]},sort=function(xs,comparator){var copy=slice.call(xs,0);return copy.sort(comparator),copy},head=function(xs){return 0===xs.length?Option.none():Option.some(xs[0])},last=function(xs){return 0===xs.length?Option.none():Option.some(xs[xs.length-1])},from$1=$_d1kyz8kfjh8lz1az.isFunction(Array.from)?Array.from:function(x){return slice.call(x)},$_6b0spykcjh8lz1ao={map:map,each:each,eachr:eachr,partition:partition,filter:filter,groupBy:groupBy,indexOf:indexOf,foldr:foldr,foldl:foldl,find:find,findIndex:findIndex,flatten:flatten,bind:bind,forall:forall,exists:exists,contains:contains,equal:equal,reverse:reverse,chunk:chunk,difference:difference,mapToObject:mapToObject,pure:pure,sort:sort,range:range,head:head,last:last,from:from$1},keys=function(){var fastKeys=Object.keys,slowKeys=function(o){var r=[];for(var i in o)o.hasOwnProperty(i)&&r.push(i);return r};return void 0===fastKeys?slowKeys:fastKeys}(),each$1=function(obj,f){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k],x=obj[i];f(x,i,obj)}},objectMap=function(obj,f){return tupleMap(obj,function(x,i,obj){return{k:i,v:f(x,i,obj)}})},tupleMap=function(obj,f){var r={};return each$1(obj,function(x,i){var tuple=f(x,i,obj);r[tuple.k]=tuple.v}),r},bifilter=function(obj,pred){var t={},f={};return each$1(obj,function(x,i){var branch=pred(x,i)?t:f;branch[i]=x}),{t:t,f:f}},mapToArray=function(obj,f){var r=[];return each$1(obj,function(value,name){r.push(f(value,name))}),r},find$1=function(obj,pred){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k],x=obj[i];if(pred(x,i,obj))return Option.some(x)}return Option.none()},values=function(obj){return mapToArray(obj,function(v){return v})},size=function(obj){return values(obj).length},$_8kti2hkhjh8lz1bt={bifilter:bifilter,each:each$1,map:objectMap,mapToArray:mapToArray,tupleMap:tupleMap,find:find$1,keys:keys,values:values,size:size},sort$1=function(arr){return arr.slice(0).sort()},reqMessage=function(required,keys){throw new Error("All required keys ("+sort$1(required).join(", ")+") were not specified. Specified keys were: "+sort$1(keys).join(", ")+".")},unsuppMessage=function(unsupported){throw new Error("Unsupported keys for object: "+sort$1(unsupported).join(", "))},validateStrArr=function(label,array){if(!$_d1kyz8kfjh8lz1az.isArray(array))throw new Error("The "+label+" fields must be an array. Was: "+array+".");$_6b0spykcjh8lz1ao.each(array,function(a){if(!$_d1kyz8kfjh8lz1az.isString(a))throw new Error("The value "+a+" in the "+label+" fields was not a string.")})},invalidTypeMessage=function(incorrect,type){throw new Error("All values need to be of type: "+type+". Keys ("+sort$1(incorrect).join(", ")+") were not.")},checkDupes=function(everything){var sorted=sort$1(everything),dupe=$_6b0spykcjh8lz1ao.find(sorted,function(s,i){return i<sorted.length-1&&s===sorted[i+1]});dupe.each(function(d){throw new Error("The field: "+d+" occurs more than once in the combined fields: ["+sorted.join(", ")+"].")})},$_9ogtmjkljh8lz1c0={sort:sort$1,reqMessage:reqMessage,unsuppMessage:unsuppMessage,validateStrArr:validateStrArr,invalidTypeMessage:invalidTypeMessage,checkDupes:checkDupes},$_d2ojjnkijh8lz1bv={immutable:Immutable,immutableBag:MixedBag},dimensions=$_d2ojjnkijh8lz1bv.immutable("width","height"),grid=$_d2ojjnkijh8lz1bv.immutable("rows","columns"),address=$_d2ojjnkijh8lz1bv.immutable("row","column"),coords=$_d2ojjnkijh8lz1bv.immutable("x","y"),detail=$_d2ojjnkijh8lz1bv.immutable("element","rowspan","colspan"),detailnew=$_d2ojjnkijh8lz1bv.immutable("element","rowspan","colspan","isNew"),extended=$_d2ojjnkijh8lz1bv.immutable("element","rowspan","colspan","row","column"),rowdata=$_d2ojjnkijh8lz1bv.immutable("element","cells","section"),elementnew=$_d2ojjnkijh8lz1bv.immutable("element","isNew"),rowdatanew=$_d2ojjnkijh8lz1bv.immutable("element","cells","section","isNew"),rowcells=$_d2ojjnkijh8lz1bv.immutable("cells","section"),rowdetails=$_d2ojjnkijh8lz1bv.immutable("details","section"),bounds=$_d2ojjnkijh8lz1bv.immutable("startRow","startCol","finishRow","finishCol"),$_g424vknjh8lz1cd={dimensions:dimensions,grid:grid,address:address,coords:coords,extended:extended,detail:detail,detailnew:detailnew,rowdata:rowdata,elementnew:elementnew,rowdatanew:rowdatanew,rowcells:rowcells,rowdetails:rowdetails,bounds:bounds},fromHtml=function(html,scope){var doc=scope||document,div=doc.createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||div.childNodes.length>1)throw console.error("HTML does not have a single root node",html),"HTML must have a single root node";return fromDom(div.childNodes[0])},fromTag=function(tag,scope){var doc=scope||document,node=doc.createElement(tag);return fromDom(node)},fromText=function(text,scope){var doc=scope||document,node=doc.createTextNode(text);return fromDom(node)},fromDom=function(node){if(null===node||void 0===node)throw new Error("Node cannot be null or undefined");return{dom:$_bgyjg9kejh8lz1ax.constant(node)}},fromPoint=function(doc,x,y){return Option.from(doc.dom().elementFromPoint(x,y)).map(fromDom)},$_6vo9a4krjh8lz1do={fromHtml:fromHtml,fromTag:fromTag,fromText:fromText,fromDom:fromDom,fromPoint:fromPoint},$_e4k979ksjh8lz1dt={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12},ELEMENT=$_e4k979ksjh8lz1dt.ELEMENT,DOCUMENT=$_e4k979ksjh8lz1dt.DOCUMENT,is=function(element,selector){var elem=element.dom();if(elem.nodeType!==ELEMENT)return!1;if(void 0!==elem.matches)return elem.matches(selector);if(void 0!==elem.msMatchesSelector)return elem.msMatchesSelector(selector);if(void 0!==elem.webkitMatchesSelector)return elem.webkitMatchesSelector(selector);if(void 0!==elem.mozMatchesSelector)return elem.mozMatchesSelector(selector);throw new Error("Browser lacks native selectors")},bypassSelector=function(dom){return dom.nodeType!==ELEMENT&&dom.nodeType!==DOCUMENT||0===dom.childElementCount},all=function(selector,scope){var base=void 0===scope?document:scope.dom();return bypassSelector(base)?[]:$_6b0spykcjh8lz1ao.map(base.querySelectorAll(selector),$_6vo9a4krjh8lz1do.fromDom)},one=function(selector,scope){var base=void 0===scope?document:scope.dom();return bypassSelector(base)?Option.none():Option.from(base.querySelector(selector)).map($_6vo9a4krjh8lz1do.fromDom)},$_62so4qkqjh8lz1di={all:all,is:is,one:one},toArray=function(target,f){var r=[],recurse=function(e){return r.push(e),f(e)},cur=f(target);do cur=cur.bind(recurse);while(cur.isSome());return r},$_4g1y8akujh8lz1e7={toArray:toArray},global$1="undefined"!=typeof window?window:Function("return this;")(),path=function(parts,scope){for(var o=void 0!==scope&&null!==scope?scope:global$1,i=0;i<parts.length&&void 0!==o&&null!==o;++i)o=o[parts[i]];return o},resolve=function(p,scope){var parts=p.split(".");return path(parts,scope)},step=function(o,part){return void 0!==o[part]&&null!==o[part]||(o[part]={}),o[part]},forge=function(parts,target){for(var o=void 0!==target?target:global$1,i=0;i<parts.length;++i)o=step(o,parts[i]);return o},namespace=function(name,target){var parts=name.split(".");return forge(parts,target)},$_4ek05lkyjh8lz1en={path:path,resolve:resolve,forge:forge,namespace:namespace},unsafe=function(name,scope){return $_4ek05lkyjh8lz1en.resolve(name,scope)},getOrDie=function(name,scope){var actual=unsafe(name,scope);if(void 0===actual||null===actual)throw name+" not available on this browser";return actual},$_f53sa7kxjh8lz1ek={getOrDie:getOrDie},node=function(){var f=$_f53sa7kxjh8lz1ek.getOrDie("Node");return f},compareDocumentPosition=function(a,b,match){return 0!==(a.compareDocumentPosition(b)&match)},documentPositionPreceding=function(a,b){return compareDocumentPosition(a,b,node().DOCUMENT_POSITION_PRECEDING)},documentPositionContainedBy=function(a,b){return compareDocumentPosition(a,b,node().DOCUMENT_POSITION_CONTAINED_BY)},$_1bck1kkwjh8lz1ej={documentPositionPreceding:documentPositionPreceding,documentPositionContainedBy:documentPositionContainedBy},cached=function(f){var r,called=!1;return function(){return called||(called=!0,r=f.apply(null,arguments)),r}},$_aela9fl1jh8lz1es={cached:cached},firstMatch=function(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s))return x}},find$2=function(regexes,agent){var r=firstMatch(regexes,agent);if(!r)return{major:0,minor:0};var group=function(i){return Number(agent.replace(r,"$"+i))};return nu(group(1),group(2))},detect=function(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();return 0===versionRegexes.length?unknown():find$2(versionRegexes,cleanedAgent)},unknown=function(){return nu(0,0)},nu=function(major,minor){return{major:major,minor:minor}},$_90grizl4jh8lz1ex={nu:nu,detect:detect,unknown:unknown},edge="Edge",chrome="Chrome",ie="IE",opera="Opera",firefox="Firefox",safari="Safari",isBrowser=function(name,current){return function(){return current===name}},unknown$1=function(){return nu$1({current:void 0,version:$_90grizl4jh8lz1ex.unknown()})},nu$1=function(info){var current=info.current,version=info.version;return{current:current,version:version,isEdge:isBrowser(edge,current),isChrome:isBrowser(chrome,current),isIE:isBrowser(ie,current),isOpera:isBrowser(opera,current),isFirefox:isBrowser(firefox,current),isSafari:isBrowser(safari,current)}},$_bu3ikfl3jh8lz1eu={unknown:unknown$1,nu:nu$1,edge:$_bgyjg9kejh8lz1ax.constant(edge),chrome:$_bgyjg9kejh8lz1ax.constant(chrome),ie:$_bgyjg9kejh8lz1ax.constant(ie),opera:$_bgyjg9kejh8lz1ax.constant(opera),firefox:$_bgyjg9kejh8lz1ax.constant(firefox),safari:$_bgyjg9kejh8lz1ax.constant(safari)},windows="Windows",ios="iOS",android="Android",linux="Linux",osx="OSX",solaris="Solaris",freebsd="FreeBSD",isOS=function(name,current){return function(){return current===name}},unknown$2=function(){return nu$2({current:void 0,version:$_90grizl4jh8lz1ex.unknown()})},nu$2=function(info){var current=info.current,version=info.version;return{current:current,version:version,isWindows:isOS(windows,current),isiOS:isOS(ios,current),isAndroid:isOS(android,current),isOSX:isOS(osx,current),isLinux:isOS(linux,current),isSolaris:isOS(solaris,current),isFreeBSD:isOS(freebsd,current)}},$_3hjylpl5jh8lz1ez={unknown:unknown$2,nu:nu$2,windows:$_bgyjg9kejh8lz1ax.constant(windows),ios:$_bgyjg9kejh8lz1ax.constant(ios),android:$_bgyjg9kejh8lz1ax.constant(android),linux:$_bgyjg9kejh8lz1ax.constant(linux),osx:$_bgyjg9kejh8lz1ax.constant(osx),solaris:$_bgyjg9kejh8lz1ax.constant(solaris),freebsd:$_bgyjg9kejh8lz1ax.constant(freebsd)},detect$1=function(candidates,userAgent){var agent=String(userAgent).toLowerCase();return $_6b0spykcjh8lz1ao.find(candidates,function(candidate){return candidate.search(agent)})},detectBrowser=function(browsers,userAgent){return detect$1(browsers,userAgent).map(function(browser){var version=$_90grizl4jh8lz1ex.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version}})},detectOs=function(oses,userAgent){return detect$1(oses,userAgent).map(function(os){var version=$_90grizl4jh8lz1ex.detect(os.versionRegexes,userAgent);return{current:os.name,version:version}})},$_ai99afl7jh8lz1f5={detectBrowser:detectBrowser,detectOs:detectOs},addToStart=function(str,prefix){return prefix+str},addToEnd=function(str,suffix){return str+suffix},removeFromStart=function(str,numChars){return str.substring(numChars)},removeFromEnd=function(str,numChars){return str.substring(0,str.length-numChars)},$_cciq56lajh8lz1fm={addToStart:addToStart,addToEnd:addToEnd,removeFromStart:removeFromStart,removeFromEnd:removeFromEnd},first=function(str,count){return str.substr(0,count)},last$1=function(str,count){return str.substr(str.length-count,str.length)},head$1=function(str){return""===str?Option.none():Option.some(str.substr(0,1))},tail=function(str){return""===str?Option.none():Option.some(str.substring(1))},$_c66x3zlbjh8lz1fo={first:first,last:last$1,head:head$1,tail:tail},checkRange=function(str,substr,start){if(""===substr)return!0;if(str.length<substr.length)return!1;var x=str.substr(start,start+substr.length);return x===substr},supplant=function(str,obj){var isStringOrNumber=function(a){var t=typeof a;return"string"===t||"number"===t};return str.replace(/\${([^{}]*)}/g,function(a,b){var value=obj[b];return isStringOrNumber(value)?value:a})},removeLeading=function(str,prefix){return startsWith(str,prefix)?$_cciq56lajh8lz1fm.removeFromStart(str,prefix.length):str},removeTrailing=function(str,prefix){return endsWith(str,prefix)?$_cciq56lajh8lz1fm.removeFromEnd(str,prefix.length):str},ensureLeading=function(str,prefix){return startsWith(str,prefix)?str:$_cciq56lajh8lz1fm.addToStart(str,prefix)},ensureTrailing=function(str,prefix){return endsWith(str,prefix)?str:$_cciq56lajh8lz1fm.addToEnd(str,prefix)},contains$1=function(str,substr){return str.indexOf(substr)!==-1},capitalize=function(str){return $_c66x3zlbjh8lz1fo.head(str).bind(function(head){return $_c66x3zlbjh8lz1fo.tail(str).map(function(tail){return head.toUpperCase()+tail})}).getOr(str)},startsWith=function(str,prefix){return checkRange(str,prefix,0)},endsWith=function(str,suffix){return checkRange(str,suffix,str.length-suffix.length)},trim=function(str){return str.replace(/^\s+|\s+$/g,"")},lTrim=function(str){return str.replace(/^\s+/g,"")},rTrim=function(str){return str.replace(/\s+$/g,"")},$_34vbjol9jh8lz1fk={supplant:supplant,startsWith:startsWith,removeLeading:removeLeading,removeTrailing:removeTrailing,ensureLeading:ensureLeading,ensureTrailing:ensureTrailing,endsWith:endsWith,contains:contains$1,trim:trim,lTrim:lTrim,rTrim:rTrim,capitalize:capitalize},normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,checkContains=function(target){return function(uastring){return $_34vbjol9jh8lz1fk.contains(uastring,target)}},browsers=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(uastring){var monstrosity=$_34vbjol9jh8lz1fk.contains(uastring,"edge/")&&$_34vbjol9jh8lz1fk.contains(uastring,"chrome")&&$_34vbjol9jh8lz1fk.contains(uastring,"safari")&&$_34vbjol9jh8lz1fk.contains(uastring,"applewebkit");return monstrosity}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function(uastring){return $_34vbjol9jh8lz1fk.contains(uastring,"chrome")&&!$_34vbjol9jh8lz1fk.contains(uastring,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(uastring){return $_34vbjol9jh8lz1fk.contains(uastring,"msie")||$_34vbjol9jh8lz1fk.contains(uastring,"trident")}},{name:"Opera",versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(uastring){return($_34vbjol9jh8lz1fk.contains(uastring,"safari")||$_34vbjol9jh8lz1fk.contains(uastring,"mobile/"))&&$_34vbjol9jh8lz1fk.contains(uastring,"applewebkit")}}],oses=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(uastring){return $_34vbjol9jh8lz1fk.contains(uastring,"iphone")||$_34vbjol9jh8lz1fk.contains(uastring,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]}],$_b5ruc3l8jh8lz1fe={browsers:$_bgyjg9kejh8lz1ax.constant(browsers),oses:$_bgyjg9kejh8lz1ax.constant(oses)},detect$2=function(userAgent){var browsers=$_b5ruc3l8jh8lz1fe.browsers(),oses=$_b5ruc3l8jh8lz1fe.oses(),browser=$_ai99afl7jh8lz1f5.detectBrowser(browsers,userAgent).fold($_bu3ikfl3jh8lz1eu.unknown,$_bu3ikfl3jh8lz1eu.nu),os=$_ai99afl7jh8lz1f5.detectOs(oses,userAgent).fold($_3hjylpl5jh8lz1ez.unknown,$_3hjylpl5jh8lz1ez.nu),deviceType=DeviceType(os,browser,userAgent);return{browser:browser,os:os,deviceType:deviceType}},$_dgywb9l2jh8lz1et={detect:detect$2},detect$3=$_aela9fl1jh8lz1es.cached(function(){var userAgent=navigator.userAgent;return $_dgywb9l2jh8lz1et.detect(userAgent)}),$_a6om0dl0jh8lz1ep={detect:detect$3},eq=function(e1,e2){return e1.dom()===e2.dom()},isEqualNode=function(e1,e2){return e1.dom().isEqualNode(e2.dom())},member=function(element,elements){return $_6b0spykcjh8lz1ao.exists(elements,$_bgyjg9kejh8lz1ax.curry(eq,element))},regularContains=function(e1,e2){var d1=e1.dom(),d2=e2.dom();return d1!==d2&&d1.contains(d2)},ieContains=function(e1,e2){return $_1bck1kkwjh8lz1ej.documentPositionContainedBy(e1.dom(),e2.dom())},browser=$_a6om0dl0jh8lz1ep.detect().browser,contains$2=browser.isIE()?ieContains:regularContains,$_2eywnlkvjh8lz1e8={eq:eq,isEqualNode:isEqualNode,member:member,contains:contains$2,is:$_62so4qkqjh8lz1di.is},owner=function(element){return $_6vo9a4krjh8lz1do.fromDom(element.dom().ownerDocument)},documentElement=function(element){var doc=owner(element);return $_6vo9a4krjh8lz1do.fromDom(doc.dom().documentElement)},defaultView=function(element){var el=element.dom(),defaultView=el.ownerDocument.defaultView;return $_6vo9a4krjh8lz1do.fromDom(defaultView)},parent=function(element){var dom=element.dom();return Option.from(dom.parentNode).map($_6vo9a4krjh8lz1do.fromDom)},findIndex$1=function(element){return parent(element).bind(function(p){var kin=children(p);return $_6b0spykcjh8lz1ao.findIndex(kin,function(elem){return $_2eywnlkvjh8lz1e8.eq(element,elem)})})},parents=function(element,isRoot){for(var stop=$_d1kyz8kfjh8lz1az.isFunction(isRoot)?isRoot:$_bgyjg9kejh8lz1ax.constant(!1),dom=element.dom(),ret=[];null!==dom.parentNode&&void 0!==dom.parentNode;){var rawParent=dom.parentNode,parent=$_6vo9a4krjh8lz1do.fromDom(rawParent);if(ret.push(parent),stop(parent)===!0)break;dom=rawParent}return ret},siblings=function(element){var filterSelf=function(elements){return $_6b0spykcjh8lz1ao.filter(elements,function(x){return!$_2eywnlkvjh8lz1e8.eq(element,x)})};return parent(element).map(children).map(filterSelf).getOr([])},offsetParent=function(element){var dom=element.dom();return Option.from(dom.offsetParent).map($_6vo9a4krjh8lz1do.fromDom)},prevSibling=function(element){var dom=element.dom();return Option.from(dom.previousSibling).map($_6vo9a4krjh8lz1do.fromDom)},nextSibling=function(element){var dom=element.dom();return Option.from(dom.nextSibling).map($_6vo9a4krjh8lz1do.fromDom)},prevSiblings=function(element){return $_6b0spykcjh8lz1ao.reverse($_4g1y8akujh8lz1e7.toArray(element,prevSibling));
},nextSiblings=function(element){return $_4g1y8akujh8lz1e7.toArray(element,nextSibling)},children=function(element){var dom=element.dom();return $_6b0spykcjh8lz1ao.map(dom.childNodes,$_6vo9a4krjh8lz1do.fromDom)},child=function(element,index){var children=element.dom().childNodes;return Option.from(children[index]).map($_6vo9a4krjh8lz1do.fromDom)},firstChild=function(element){return child(element,0)},lastChild=function(element){return child(element,element.dom().childNodes.length-1)},childNodesCount=function(element){return element.dom().childNodes.length},hasChildNodes=function(element){return element.dom().hasChildNodes()},spot=$_d2ojjnkijh8lz1bv.immutable("element","offset"),leaf=function(element,offset){var cs=children(element);return cs.length>0&&offset<cs.length?spot(cs[offset],0):spot(element,offset)},$_4hc7u2ktjh8lz1dv={owner:owner,defaultView:defaultView,documentElement:documentElement,parent:parent,findIndex:findIndex$1,parents:parents,siblings:siblings,prevSibling:prevSibling,offsetParent:offsetParent,prevSiblings:prevSiblings,nextSibling:nextSibling,nextSiblings:nextSiblings,children:children,child:child,firstChild:firstChild,lastChild:lastChild,childNodesCount:childNodesCount,hasChildNodes:hasChildNodes,leaf:leaf},firstLayer=function(scope,selector){return filterFirstLayer(scope,selector,$_bgyjg9kejh8lz1ax.constant(!0))},filterFirstLayer=function(scope,selector,predicate){return $_6b0spykcjh8lz1ao.bind($_4hc7u2ktjh8lz1dv.children(scope),function(x){return $_62so4qkqjh8lz1di.is(x,selector)?predicate(x)?[x]:[]:filterFirstLayer(x,selector,predicate)})},$_egd9zbkpjh8lz1d3={firstLayer:firstLayer,filterFirstLayer:filterFirstLayer},name=function(element){var r=element.dom().nodeName;return r.toLowerCase()},type=function(element){return element.dom().nodeType},value=function(element){return element.dom().nodeValue},isType$1=function(t){return function(element){return type(element)===t}},isComment=function(element){return type(element)===$_e4k979ksjh8lz1dt.COMMENT||"#comment"===name(element)},isElement=isType$1($_e4k979ksjh8lz1dt.ELEMENT),isText=isType$1($_e4k979ksjh8lz1dt.TEXT),isDocument=isType$1($_e4k979ksjh8lz1dt.DOCUMENT),$_a3izpgldjh8lz1fy={name:name,type:type,value:value,isElement:isElement,isText:isText,isDocument:isDocument,isComment:isComment},rawSet=function(dom,key,value){if(!($_d1kyz8kfjh8lz1az.isString(value)||$_d1kyz8kfjh8lz1az.isBoolean(value)||$_d1kyz8kfjh8lz1az.isNumber(value)))throw console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom),new Error("Attribute value was not simple");dom.setAttribute(key,value+"")},set=function(element,key,value){rawSet(element.dom(),key,value)},setAll=function(element,attrs){var dom=element.dom();$_8kti2hkhjh8lz1bt.each(attrs,function(v,k){rawSet(dom,k,v)})},get=function(element,key){var v=element.dom().getAttribute(key);return null===v?void 0:v},has=function(element,key){var dom=element.dom();return!(!dom||!dom.hasAttribute)&&dom.hasAttribute(key)},remove=function(element,key){element.dom().removeAttribute(key)},hasNone=function(element){var attrs=element.dom().attributes;return void 0===attrs||null===attrs||0===attrs.length},clone=function(element){return $_6b0spykcjh8lz1ao.foldl(element.dom().attributes,function(acc,attr){return acc[attr.name]=attr.value,acc},{})},transferOne=function(source,destination,attr){has(source,attr)&&!has(destination,attr)&&set(destination,attr,get(source,attr))},transfer=function(source,destination,attrs){$_a3izpgldjh8lz1fy.isElement(source)&&$_a3izpgldjh8lz1fy.isElement(destination)&&$_6b0spykcjh8lz1ao.each(attrs,function(attr){transferOne(source,destination,attr)})},$_1mp8lglcjh8lz1fq={clone:clone,set:set,setAll:setAll,get:get,has:has,remove:remove,hasNone:hasNone,transfer:transfer},inBody=function(element){var dom=$_a3izpgldjh8lz1fy.isText(element)?element.dom().parentNode:element.dom();return void 0!==dom&&null!==dom&&dom.ownerDocument.body.contains(dom)},body=$_aela9fl1jh8lz1es.cached(function(){return getBody($_6vo9a4krjh8lz1do.fromDom(document))}),getBody=function(doc){var body=doc.dom().body;if(null===body||void 0===body)throw"Body is not available yet";return $_6vo9a4krjh8lz1do.fromDom(body)},$_brbde9lgjh8lz1g4={body:body,getBody:getBody,inBody:inBody},all$1=function(predicate){return descendants($_brbde9lgjh8lz1g4.body(),predicate)},ancestors=function(scope,predicate,isRoot){return $_6b0spykcjh8lz1ao.filter($_4hc7u2ktjh8lz1dv.parents(scope,isRoot),predicate)},siblings$1=function(scope,predicate){return $_6b0spykcjh8lz1ao.filter($_4hc7u2ktjh8lz1dv.siblings(scope),predicate)},children$1=function(scope,predicate){return $_6b0spykcjh8lz1ao.filter($_4hc7u2ktjh8lz1dv.children(scope),predicate)},descendants=function(scope,predicate){var result=[];return $_6b0spykcjh8lz1ao.each($_4hc7u2ktjh8lz1dv.children(scope),function(x){predicate(x)&&(result=result.concat([x])),result=result.concat(descendants(x,predicate))}),result},$_5a2t82lfjh8lz1g0={all:all$1,ancestors:ancestors,siblings:siblings$1,children:children$1,descendants:descendants},all$2=function(selector){return $_62so4qkqjh8lz1di.all(selector)},ancestors$1=function(scope,selector,isRoot){return $_5a2t82lfjh8lz1g0.ancestors(scope,function(e){return $_62so4qkqjh8lz1di.is(e,selector)},isRoot)},siblings$2=function(scope,selector){return $_5a2t82lfjh8lz1g0.siblings(scope,function(e){return $_62so4qkqjh8lz1di.is(e,selector)})},children$2=function(scope,selector){return $_5a2t82lfjh8lz1g0.children(scope,function(e){return $_62so4qkqjh8lz1di.is(e,selector)})},descendants$1=function(scope,selector){return $_62so4qkqjh8lz1di.all(selector,scope)},$_coxlualejh8lz1fz={all:all$2,ancestors:ancestors$1,siblings:siblings$2,children:children$2,descendants:descendants$1},first$1=function(predicate){return descendant($_brbde9lgjh8lz1g4.body(),predicate)},ancestor=function(scope,predicate,isRoot){for(var element=scope.dom(),stop=$_d1kyz8kfjh8lz1az.isFunction(isRoot)?isRoot:$_bgyjg9kejh8lz1ax.constant(!1);element.parentNode;){element=element.parentNode;var el=$_6vo9a4krjh8lz1do.fromDom(element);if(predicate(el))return Option.some(el);if(stop(el))break}return Option.none()},closest=function(scope,predicate,isRoot){var is=function(scope){return predicate(scope)};return ClosestOrAncestor(is,ancestor,scope,predicate,isRoot)},sibling=function(scope,predicate){var element=scope.dom();return element.parentNode?child$1($_6vo9a4krjh8lz1do.fromDom(element.parentNode),function(x){return!$_2eywnlkvjh8lz1e8.eq(scope,x)&&predicate(x)}):Option.none()},child$1=function(scope,predicate){var result=$_6b0spykcjh8lz1ao.find(scope.dom().childNodes,$_bgyjg9kejh8lz1ax.compose(predicate,$_6vo9a4krjh8lz1do.fromDom));return result.map($_6vo9a4krjh8lz1do.fromDom)},descendant=function(scope,predicate){var descend=function(element){for(var i=0;i<element.childNodes.length;i++){if(predicate($_6vo9a4krjh8lz1do.fromDom(element.childNodes[i])))return Option.some($_6vo9a4krjh8lz1do.fromDom(element.childNodes[i]));var res=descend(element.childNodes[i]);if(res.isSome())return res}return Option.none()};return descend(scope.dom())},$_aykj0glijh8lz1g9={first:first$1,ancestor:ancestor,closest:closest,sibling:sibling,child:child$1,descendant:descendant},first$2=function(selector){return $_62so4qkqjh8lz1di.one(selector)},ancestor$1=function(scope,selector,isRoot){return $_aykj0glijh8lz1g9.ancestor(scope,function(e){return $_62so4qkqjh8lz1di.is(e,selector)},isRoot)},sibling$1=function(scope,selector){return $_aykj0glijh8lz1g9.sibling(scope,function(e){return $_62so4qkqjh8lz1di.is(e,selector)})},child$2=function(scope,selector){return $_aykj0glijh8lz1g9.child(scope,function(e){return $_62so4qkqjh8lz1di.is(e,selector)})},descendant$1=function(scope,selector){return $_62so4qkqjh8lz1di.one(selector,scope)},closest$1=function(scope,selector,isRoot){return ClosestOrAncestor($_62so4qkqjh8lz1di.is,ancestor$1,scope,selector,isRoot)},$_fiygddlhjh8lz1g7={first:first$2,ancestor:ancestor$1,sibling:sibling$1,child:child$2,descendant:descendant$1,closest:closest$1},lookup=function(tags,element,_isRoot){var isRoot=void 0!==_isRoot?_isRoot:$_bgyjg9kejh8lz1ax.constant(!1);if(isRoot(element))return Option.none();if($_6b0spykcjh8lz1ao.contains(tags,$_a3izpgldjh8lz1fy.name(element)))return Option.some(element);var isRootOrUpperTable=function(element){return $_62so4qkqjh8lz1di.is(element,"table")||isRoot(element)};return $_fiygddlhjh8lz1g7.ancestor(element,tags.join(","),isRootOrUpperTable)},cell=function(element,isRoot){return lookup(["td","th"],element,isRoot)},cells=function(ancestor){return $_egd9zbkpjh8lz1d3.firstLayer(ancestor,"th,td")},notCell=function(element,isRoot){return lookup(["caption","tr","tbody","tfoot","thead"],element,isRoot)},neighbours=function(selector,element){return $_4hc7u2ktjh8lz1dv.parent(element).map(function(parent){return $_coxlualejh8lz1fz.children(parent,selector)})},neighbourCells=$_bgyjg9kejh8lz1ax.curry(neighbours,"th,td"),neighbourRows=$_bgyjg9kejh8lz1ax.curry(neighbours,"tr"),firstCell=function(ancestor){return $_fiygddlhjh8lz1g7.descendant(ancestor,"th,td")},table=function(element,isRoot){return $_fiygddlhjh8lz1g7.closest(element,"table",isRoot)},row=function(element,isRoot){return lookup(["tr"],element,isRoot)},rows=function(ancestor){return $_egd9zbkpjh8lz1d3.firstLayer(ancestor,"tr")},attr=function(element,property){return parseInt($_1mp8lglcjh8lz1fq.get(element,property),10)},grid$1=function(element,rowProp,colProp){var rows=attr(element,rowProp),cols=attr(element,colProp);return $_g424vknjh8lz1cd.grid(rows,cols)},$_ee8pmfkojh8lz1ch={cell:cell,firstCell:firstCell,cells:cells,neighbourCells:neighbourCells,table:table,row:row,rows:rows,notCell:notCell,neighbourRows:neighbourRows,attr:attr,grid:grid$1},fromTable=function(table){var rows=$_ee8pmfkojh8lz1ch.rows(table);return $_6b0spykcjh8lz1ao.map(rows,function(row){var element=row,parent=$_4hc7u2ktjh8lz1dv.parent(element),parentSection=parent.bind(function(parent){var parentName=$_a3izpgldjh8lz1fy.name(parent);return"tfoot"===parentName||"thead"===parentName||"tbody"===parentName?parentName:"tbody"}),cells=$_6b0spykcjh8lz1ao.map($_ee8pmfkojh8lz1ch.cells(row),function(cell){var rowspan=$_1mp8lglcjh8lz1fq.has(cell,"rowspan")?parseInt($_1mp8lglcjh8lz1fq.get(cell,"rowspan"),10):1,colspan=$_1mp8lglcjh8lz1fq.has(cell,"colspan")?parseInt($_1mp8lglcjh8lz1fq.get(cell,"colspan"),10):1;return $_g424vknjh8lz1cd.detail(cell,rowspan,colspan)});return $_g424vknjh8lz1cd.rowdata(element,cells,parentSection)})},fromPastedRows=function(rows,example){return $_6b0spykcjh8lz1ao.map(rows,function(row){var cells=$_6b0spykcjh8lz1ao.map($_ee8pmfkojh8lz1ch.cells(row),function(cell){var rowspan=$_1mp8lglcjh8lz1fq.has(cell,"rowspan")?parseInt($_1mp8lglcjh8lz1fq.get(cell,"rowspan"),10):1,colspan=$_1mp8lglcjh8lz1fq.has(cell,"colspan")?parseInt($_1mp8lglcjh8lz1fq.get(cell,"colspan"),10):1;return $_g424vknjh8lz1cd.detail(cell,rowspan,colspan)});return $_g424vknjh8lz1cd.rowdata(row,cells,example.section())})},$_ff1h20kmjh8lz1c3={fromTable:fromTable,fromPastedRows:fromPastedRows},key=function(row,column){return row+","+column},getAt=function(warehouse,row,column){var raw=warehouse.access()[key(row,column)];return void 0!==raw?Option.some(raw):Option.none()},findItem=function(warehouse,item,comparator){var filtered=filterItems(warehouse,function(detail){return comparator(item,detail.element())});return filtered.length>0?Option.some(filtered[0]):Option.none()},filterItems=function(warehouse,predicate){var all=$_6b0spykcjh8lz1ao.bind(warehouse.all(),function(r){return r.cells()});return $_6b0spykcjh8lz1ao.filter(all,predicate)},generate=function(list){var access={},cells=[],maxRows=list.length,maxColumns=0;$_6b0spykcjh8lz1ao.each(list,function(details,r){var currentRow=[];$_6b0spykcjh8lz1ao.each(details.cells(),function(detail,c){for(var start=0;void 0!==access[key(r,start)];)start++;for(var current=$_g424vknjh8lz1cd.extended(detail.element(),detail.rowspan(),detail.colspan(),r,start),i=0;i<detail.colspan();i++)for(var j=0;j<detail.rowspan();j++){var cr=r+j,cc=start+i,newpos=key(cr,cc);access[newpos]=current,maxColumns=Math.max(maxColumns,cc+1)}currentRow.push(current)}),cells.push($_g424vknjh8lz1cd.rowdata(details.element(),currentRow,details.section()))});var grid=$_g424vknjh8lz1cd.grid(maxRows,maxColumns);return{grid:$_bgyjg9kejh8lz1ax.constant(grid),access:$_bgyjg9kejh8lz1ax.constant(access),all:$_bgyjg9kejh8lz1ax.constant(cells)}},justCells=function(warehouse){var rows=$_6b0spykcjh8lz1ao.map(warehouse.all(),function(w){return w.cells()});return $_6b0spykcjh8lz1ao.flatten(rows)},$_fxwupplkjh8lz1go={generate:generate,getAt:getAt,findItem:findItem,filterItems:filterItems,justCells:justCells},isSupported=function(dom){return void 0!==dom.style},$_3r8yz1lmjh8lz1hf={isSupported:isSupported},internalSet=function(dom,property,value){if(!$_d1kyz8kfjh8lz1az.isString(value))throw console.error("Invalid call to CSS.set. Property ",property,":: Value ",value,":: Element ",dom),new Error("CSS value must be a string: "+value);$_3r8yz1lmjh8lz1hf.isSupported(dom)&&dom.style.setProperty(property,value)},internalRemove=function(dom,property){$_3r8yz1lmjh8lz1hf.isSupported(dom)&&dom.style.removeProperty(property)},set$1=function(element,property,value){var dom=element.dom();internalSet(dom,property,value)},setAll$1=function(element,css){var dom=element.dom();$_8kti2hkhjh8lz1bt.each(css,function(v,k){internalSet(dom,k,v)})},setOptions=function(element,css){var dom=element.dom();$_8kti2hkhjh8lz1bt.each(css,function(v,k){v.fold(function(){internalRemove(dom,k)},function(value){internalSet(dom,k,value)})})},get$1=function(element,property){var dom=element.dom(),styles=window.getComputedStyle(dom),r=styles.getPropertyValue(property),v=""!==r||$_brbde9lgjh8lz1g4.inBody(element)?r:getUnsafeProperty(dom,property);return null===v?void 0:v},getUnsafeProperty=function(dom,property){return $_3r8yz1lmjh8lz1hf.isSupported(dom)?dom.style.getPropertyValue(property):""},getRaw=function(element,property){var dom=element.dom(),raw=getUnsafeProperty(dom,property);return Option.from(raw).filter(function(r){return r.length>0})},getAllRaw=function(element){var css={},dom=element.dom();if($_3r8yz1lmjh8lz1hf.isSupported(dom))for(var i=0;i<dom.style.length;i++){var ruleName=dom.style.item(i);css[ruleName]=dom.style[ruleName]}return css},isValidValue=function(tag,property,value){var element=$_6vo9a4krjh8lz1do.fromTag(tag);set$1(element,property,value);var style=getRaw(element,property);return style.isSome()},remove$1=function(element,property){var dom=element.dom();internalRemove(dom,property),$_1mp8lglcjh8lz1fq.has(element,"style")&&""===$_34vbjol9jh8lz1fk.trim($_1mp8lglcjh8lz1fq.get(element,"style"))&&$_1mp8lglcjh8lz1fq.remove(element,"style")},preserve=function(element,f){var oldStyles=$_1mp8lglcjh8lz1fq.get(element,"style"),result=f(element),restore=void 0===oldStyles?$_1mp8lglcjh8lz1fq.remove:$_1mp8lglcjh8lz1fq.set;return restore(element,"style",oldStyles),result},copy=function(source,target){var sourceDom=source.dom(),targetDom=target.dom();$_3r8yz1lmjh8lz1hf.isSupported(sourceDom)&&$_3r8yz1lmjh8lz1hf.isSupported(targetDom)&&(targetDom.style.cssText=sourceDom.style.cssText)},reflow=function(e){return e.dom().offsetWidth},transferOne$1=function(source,destination,style){getRaw(source,style).each(function(value){getRaw(destination,style).isNone()&&set$1(destination,style,value)})},transfer$1=function(source,destination,styles){$_a3izpgldjh8lz1fy.isElement(source)&&$_a3izpgldjh8lz1fy.isElement(destination)&&$_6b0spykcjh8lz1ao.each(styles,function(style){transferOne$1(source,destination,style)})},$_3ory84lljh8lz1gx={copy:copy,set:set$1,preserve:preserve,setAll:setAll$1,setOptions:setOptions,remove:remove$1,get:get$1,getRaw:getRaw,getAllRaw:getAllRaw,isValidValue:isValidValue,reflow:reflow,transfer:transfer$1},before=function(marker,element){var parent=$_4hc7u2ktjh8lz1dv.parent(marker);parent.each(function(v){v.dom().insertBefore(element.dom(),marker.dom())})},after=function(marker,element){var sibling=$_4hc7u2ktjh8lz1dv.nextSibling(marker);sibling.fold(function(){var parent=$_4hc7u2ktjh8lz1dv.parent(marker);parent.each(function(v){append(v,element)})},function(v){before(v,element)})},prepend=function(parent,element){var firstChild=$_4hc7u2ktjh8lz1dv.firstChild(parent);firstChild.fold(function(){append(parent,element)},function(v){parent.dom().insertBefore(element.dom(),v.dom())})},append=function(parent,element){parent.dom().appendChild(element.dom())},appendAt=function(parent,element,index){$_4hc7u2ktjh8lz1dv.child(parent,index).fold(function(){append(parent,element)},function(v){before(v,element)})},wrap=function(element,wrapper){before(element,wrapper),append(wrapper,element)},$_6qqu1alnjh8lz1hg={before:before,after:after,prepend:prepend,append:append,appendAt:appendAt,wrap:wrap},before$1=function(marker,elements){$_6b0spykcjh8lz1ao.each(elements,function(x){$_6qqu1alnjh8lz1hg.before(marker,x)})},after$1=function(marker,elements){$_6b0spykcjh8lz1ao.each(elements,function(x,i){var e=0===i?marker:elements[i-1];$_6qqu1alnjh8lz1hg.after(e,x)})},prepend$1=function(parent,elements){$_6b0spykcjh8lz1ao.each(elements.slice().reverse(),function(x){$_6qqu1alnjh8lz1hg.prepend(parent,x)})},append$1=function(parent,elements){$_6b0spykcjh8lz1ao.each(elements,function(x){$_6qqu1alnjh8lz1hg.append(parent,x)})},$_d7tq5mlpjh8lz1hl={before:before$1,after:after$1,prepend:prepend$1,append:append$1},empty=function(element){element.dom().textContent="",$_6b0spykcjh8lz1ao.each($_4hc7u2ktjh8lz1dv.children(element),function(rogue){remove$2(rogue)})},remove$2=function(element){var dom=element.dom();null!==dom.parentNode&&dom.parentNode.removeChild(dom)},unwrap=function(wrapper){var children=$_4hc7u2ktjh8lz1dv.children(wrapper);children.length>0&&$_d7tq5mlpjh8lz1hl.before(wrapper,children),remove$2(wrapper)},$_f2hny0lojh8lz1hi={empty:empty,remove:remove$2,unwrap:unwrap},stats=$_d2ojjnkijh8lz1bv.immutable("minRow","minCol","maxRow","maxCol"),findSelectedStats=function(house,isSelected){var totalColumns=house.grid().columns(),totalRows=house.grid().rows(),minRow=totalRows,minCol=totalColumns,maxRow=0,maxCol=0;return $_8kti2hkhjh8lz1bt.each(house.access(),function(detail){if(isSelected(detail)){var startRow=detail.row(),endRow=startRow+detail.rowspan()-1,startCol=detail.column(),endCol=startCol+detail.colspan()-1;startRow<minRow?minRow=startRow:endRow>maxRow&&(maxRow=endRow),startCol<minCol?minCol=startCol:endCol>maxCol&&(maxCol=endCol)}}),stats(minRow,minCol,maxRow,maxCol)},makeCell=function(list,seenSelected,rowIndex){var row=list[rowIndex].element(),td=$_6vo9a4krjh8lz1do.fromTag("td");$_6qqu1alnjh8lz1hg.append(td,$_6vo9a4krjh8lz1do.fromTag("br"));var f=seenSelected?$_6qqu1alnjh8lz1hg.append:$_6qqu1alnjh8lz1hg.prepend;f(row,td)},fillInGaps=function(list,house,stats,isSelected){for(var totalColumns=house.grid().columns(),totalRows=house.grid().rows(),i=0;i<totalRows;i++)for(var seenSelected=!1,j=0;j<totalColumns;j++)if(!(i<stats.minRow()||i>stats.maxRow()||j<stats.minCol()||j>stats.maxCol())){var needCell=$_fxwupplkjh8lz1go.getAt(house,i,j).filter(isSelected).isNone();needCell?makeCell(list,seenSelected,i):seenSelected=!0}},clean=function(table,stats){var emptyRows=$_6b0spykcjh8lz1ao.filter($_egd9zbkpjh8lz1d3.firstLayer(table,"tr"),function(row){return 0===row.dom().childElementCount});$_6b0spykcjh8lz1ao.each(emptyRows,$_f2hny0lojh8lz1hi.remove),stats.minCol()!==stats.maxCol()&&stats.minRow()!==stats.maxRow()||$_6b0spykcjh8lz1ao.each($_egd9zbkpjh8lz1d3.firstLayer(table,"th,td"),function(cell){$_1mp8lglcjh8lz1fq.remove(cell,"rowspan"),$_1mp8lglcjh8lz1fq.remove(cell,"colspan")}),$_1mp8lglcjh8lz1fq.remove(table,"width"),$_1mp8lglcjh8lz1fq.remove(table,"height"),$_3ory84lljh8lz1gx.remove(table,"width"),$_3ory84lljh8lz1gx.remove(table,"height")},extract=function(table,selectedSelector){var isSelected=function(detail){return $_62so4qkqjh8lz1di.is(detail.element(),selectedSelector)},list=$_ff1h20kmjh8lz1c3.fromTable(table),house=$_fxwupplkjh8lz1go.generate(list),stats=findSelectedStats(house,isSelected),selector="th:not("+selectedSelector+"),td:not("+selectedSelector+")",unselectedCells=$_egd9zbkpjh8lz1d3.filterFirstLayer(table,"th,td",function(cell){return $_62so4qkqjh8lz1di.is(cell,selector)});return $_6b0spykcjh8lz1ao.each(unselectedCells,$_f2hny0lojh8lz1hi.remove),fillInGaps(list,house,stats,isSelected),clean(table,stats),table},$_dj8mm1kgjh8lz1b3={extract:extract},clone$1=function(original,deep){return $_6vo9a4krjh8lz1do.fromDom(original.dom().cloneNode(deep))},shallow=function(original){return clone$1(original,!1)},deep=function(original){return clone$1(original,!0)},shallowAs=function(original,tag){var nu=$_6vo9a4krjh8lz1do.fromTag(tag),attributes=$_1mp8lglcjh8lz1fq.clone(original);return $_1mp8lglcjh8lz1fq.setAll(nu,attributes),nu},copy$1=function(original,tag){var nu=shallowAs(original,tag),cloneChildren=$_4hc7u2ktjh8lz1dv.children(deep(original));return $_d7tq5mlpjh8lz1hl.append(nu,cloneChildren),nu},mutate=function(original,tag){var nu=shallowAs(original,tag);$_6qqu1alnjh8lz1hg.before(original,nu);var children=$_4hc7u2ktjh8lz1dv.children(original);return $_d7tq5mlpjh8lz1hl.append(nu,children),$_f2hny0lojh8lz1hi.remove(original),nu},$_zeqq4lrjh8lz1id={shallow:shallow,shallowAs:shallowAs,deep:deep,copy:copy$1,mutate:mutate},api=NodeValue($_a3izpgldjh8lz1fy.isText,"text"),get$2=function(element){return api.get(element)},getOption=function(element){return api.getOption(element)},set$2=function(element,value){api.set(element,value)},$_bri5anlujh8lz1in={get:get$2,getOption:getOption,set:set$2},getEnd=function(element){return"img"===$_a3izpgldjh8lz1fy.name(element)?1:$_bri5anlujh8lz1in.getOption(element).fold(function(){return $_4hc7u2ktjh8lz1dv.children(element).length},function(v){return v.length})},isEnd=function(element,offset){return getEnd(element)===offset},isStart=function(element,offset){return 0===offset},NBSP=" ",isTextNodeWithCursorPosition=function(el){return $_bri5anlujh8lz1in.getOption(el).filter(function(text){return 0!==text.trim().length||text.indexOf(NBSP)>-1}).isSome()},elementsWithCursorPosition=["img","br"],isCursorPosition=function(elem){var hasCursorPosition=isTextNodeWithCursorPosition(elem);return hasCursorPosition||$_6b0spykcjh8lz1ao.contains(elementsWithCursorPosition,$_a3izpgldjh8lz1fy.name(elem))},$_6759o9ltjh8lz1ij={getEnd:getEnd,isEnd:isEnd,isStart:isStart,isCursorPosition:isCursorPosition},first$3=function(element){return $_aykj0glijh8lz1g9.descendant(element,$_6759o9ltjh8lz1ij.isCursorPosition)},last$2=function(element){return descendantRtl(element,$_6759o9ltjh8lz1ij.isCursorPosition)},descendantRtl=function(scope,predicate){var descend=function(element){for(var children=$_4hc7u2ktjh8lz1dv.children(element),i=children.length-1;i>=0;i--){var child=children[i];if(predicate(child))return Option.some(child);var res=descend(child);if(res.isSome())return res}return Option.none()};return descend(scope)},$_fpdn73lsjh8lz1ig={first:first$3,last:last$2},cell$1=function(){var td=$_6vo9a4krjh8lz1do.fromTag("td");return $_6qqu1alnjh8lz1hg.append(td,$_6vo9a4krjh8lz1do.fromTag("br")),td},replace=function(cell,tag,attrs){var replica=$_zeqq4lrjh8lz1id.copy(cell,tag);return $_8kti2hkhjh8lz1bt.each(attrs,function(v,k){null===v?$_1mp8lglcjh8lz1fq.remove(replica,k):$_1mp8lglcjh8lz1fq.set(replica,k,v)}),replica},pasteReplace=function(cellContent){return cellContent},newRow=function(doc){return function(){return $_6vo9a4krjh8lz1do.fromTag("tr",doc.dom())}},cloneFormats=function(oldCell,newCell,formats){var first=$_fpdn73lsjh8lz1ig.first(oldCell);return first.map(function(firstText){var formatSelector=formats.join(","),parents=$_coxlualejh8lz1fz.ancestors(firstText,formatSelector,function(element){return $_2eywnlkvjh8lz1e8.eq(element,oldCell)});return $_6b0spykcjh8lz1ao.foldr(parents,function(last,parent){var clonedFormat=$_zeqq4lrjh8lz1id.shallow(parent);return $_6qqu1alnjh8lz1hg.append(last,clonedFormat),clonedFormat},newCell)}).getOr(newCell)},cellOperations=function(mutate,doc,formatsToClone){var newCell=function(prev){var doc=$_4hc7u2ktjh8lz1dv.owner(prev.element()),td=$_6vo9a4krjh8lz1do.fromTag($_a3izpgldjh8lz1fy.name(prev.element()),doc.dom()),formats=formatsToClone.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),lastNode=formats.length>0?cloneFormats(prev.element(),td,formats):td;return $_6qqu1alnjh8lz1hg.append(lastNode,$_6vo9a4krjh8lz1do.fromTag("br")),$_3ory84lljh8lz1gx.copy(prev.element(),td),$_3ory84lljh8lz1gx.remove(td,"height"),1!==prev.colspan()&&$_3ory84lljh8lz1gx.remove(prev.element(),"width"),mutate(prev.element(),td),td};return{row:newRow(doc),cell:newCell,replace:replace,gap:cell$1}},paste=function(doc){return{row:newRow(doc),cell:cell$1,replace:pasteReplace,gap:cell$1}},$_3fxw02lqjh8lz1hp={cellOperations:cellOperations,paste:paste},fromHtml$1=function(html,scope){var doc=scope||document,div=doc.createElement("div");return div.innerHTML=html,$_4hc7u2ktjh8lz1dv.children($_6vo9a4krjh8lz1do.fromDom(div))},fromTags=function(tags,scope){return $_6b0spykcjh8lz1ao.map(tags,function(x){return $_6vo9a4krjh8lz1do.fromTag(x,scope)})},fromText$1=function(texts,scope){return $_6b0spykcjh8lz1ao.map(texts,function(x){return $_6vo9a4krjh8lz1do.fromText(x,scope)})},fromDom$1=function(nodes){return $_6b0spykcjh8lz1ao.map(nodes,$_6vo9a4krjh8lz1do.fromDom)},$_200no5lwjh8lz1iy={fromHtml:fromHtml$1,fromTags:fromTags,fromText:fromText$1,fromDom:fromDom$1},TagBoundaries=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],leftRight=$_d2ojjnkijh8lz1bv.immutable("left","right"),bisect=function(universe,parent,child){var children=universe.property().children(parent),index=$_6b0spykcjh8lz1ao.findIndex(children,$_bgyjg9kejh8lz1ax.curry(universe.eq,child));return index.map(function(ind){return{before:$_bgyjg9kejh8lz1ax.constant(children.slice(0,ind)),after:$_bgyjg9kejh8lz1ax.constant(children.slice(ind+1))}})},breakToRight=function(universe,parent,child){return bisect(universe,parent,child).map(function(parts){var second=universe.create().clone(parent);return universe.insert().appendAll(second,parts.after()),universe.insert().after(parent,second),leftRight(parent,second)})},breakToLeft=function(universe,parent,child){return bisect(universe,parent,child).map(function(parts){var prior=universe.create().clone(parent);return universe.insert().appendAll(prior,parts.before().concat([child])),universe.insert().appendAll(parent,parts.after()),universe.insert().before(parent,prior),leftRight(prior,parent)})},breakPath=function(universe,item,isTop,breaker){var result=$_d2ojjnkijh8lz1bv.immutable("first","second","splits"),next=function(child,group,splits){var fallback=result(child,Option.none(),splits);return isTop(child)?result(child,group,splits):universe.property().parent(child).bind(function(parent){return breaker(universe,parent,child).map(function(breakage){var extra=[{first:breakage.left,second:breakage.right}],nextChild=isTop(parent)?parent:breakage.left();return next(nextChild,Option.some(breakage.right()),splits.concat(extra))}).getOr(fallback)})};return next(item,Option.none(),[])},$_6javmwm5jh8lz1lp={breakToLeft:breakToLeft,breakToRight:breakToRight,breakPath:breakPath},all$3=function(universe,look,elements,f){var head=elements[0],tail=elements.slice(1);return f(universe,look,head,tail)},oneAll=function(universe,look,elements){return elements.length>0?all$3(universe,look,elements,unsafeOne):Option.none()},unsafeOne=function(universe,look,head,tail){var start=look(universe,head);return $_6b0spykcjh8lz1ao.foldr(tail,function(b,a){var current=look(universe,a);return commonElement(universe,b,current)},start)},commonElement=function(universe,start,end){return start.bind(function(s){return end.filter($_bgyjg9kejh8lz1ax.curry(universe.eq,s))})},$_f59pclm6jh8lz1lz={oneAll:oneAll},eq$1=function(universe,item){return $_bgyjg9kejh8lz1ax.curry(universe.eq,item)},unsafeSubset=function(universe,common,ps1,ps2){var children=universe.property().children(common);if(universe.eq(common,ps1[0]))return Option.some([ps1[0]]);if(universe.eq(common,ps2[0]))return Option.some([ps2[0]]);var finder=function(ps){var topDown=$_6b0spykcjh8lz1ao.reverse(ps),index=$_6b0spykcjh8lz1ao.findIndex(topDown,eq$1(universe,common)).getOr(-1),item=index<topDown.length-1?topDown[index+1]:topDown[index];return $_6b0spykcjh8lz1ao.findIndex(children,eq$1(universe,item))},startIndex=finder(ps1),endIndex=finder(ps2);return startIndex.bind(function(sIndex){return endIndex.map(function(eIndex){var first=Math.min(sIndex,eIndex),last=Math.max(sIndex,eIndex);return children.slice(first,last+1)})})},ancestors$2=function(universe,start,end,_isRoot){var isRoot=void 0!==_isRoot?_isRoot:$_bgyjg9kejh8lz1ax.constant(!1),ps1=[start].concat(universe.up().all(start)),ps2=[end].concat(universe.up().all(end)),prune=function(path){var index=$_6b0spykcjh8lz1ao.findIndex(path,isRoot);return index.fold(function(){return path},function(ind){return path.slice(0,ind+1)})},pruned1=prune(ps1),pruned2=prune(ps2),shared=$_6b0spykcjh8lz1ao.find(pruned1,function(x){return $_6b0spykcjh8lz1ao.exists(pruned2,eq$1(universe,x))});return{firstpath:$_bgyjg9kejh8lz1ax.constant(pruned1),secondpath:$_bgyjg9kejh8lz1ax.constant(pruned2),shared:$_bgyjg9kejh8lz1ax.constant(shared)}},subset=function(universe,start,end){var ancs=ancestors$2(universe,start,end);return ancs.shared().bind(function(shared){return unsafeSubset(universe,shared,ancs.firstpath(),ancs.secondpath())})},$_53b8yjm7jh8lz1m7={subset:subset,ancestors:ancestors$2},sharedOne=function(universe,look,elements){return $_f59pclm6jh8lz1lz.oneAll(universe,look,elements)},subset$1=function(universe,start,finish){return $_53b8yjm7jh8lz1m7.subset(universe,start,finish)},ancestors$3=function(universe,start,finish,_isRoot){return $_53b8yjm7jh8lz1m7.ancestors(universe,start,finish,_isRoot)},breakToLeft$1=function(universe,parent,child){return $_6javmwm5jh8lz1lp.breakToLeft(universe,parent,child)},breakToRight$1=function(universe,parent,child){return $_6javmwm5jh8lz1lp.breakToRight(universe,parent,child)},breakPath$1=function(universe,child,isTop,breaker){return $_6javmwm5jh8lz1lp.breakPath(universe,child,isTop,breaker)},$_dkt9bum4jh8lz1ln={sharedOne:sharedOne,subset:subset$1,ancestors:ancestors$3,breakToLeft:breakToLeft$1,breakToRight:breakToRight$1,breakPath:breakPath$1},universe=DomUniverse(),sharedOne$1=function(look,elements){return $_dkt9bum4jh8lz1ln.sharedOne(universe,function(universe,element){return look(element)},elements)},subset$2=function(start,finish){return $_dkt9bum4jh8lz1ln.subset(universe,start,finish)},ancestors$4=function(start,finish,_isRoot){return $_dkt9bum4jh8lz1ln.ancestors(universe,start,finish,_isRoot)},breakToLeft$2=function(parent,child){return $_dkt9bum4jh8lz1ln.breakToLeft(universe,parent,child)},breakToRight$2=function(parent,child){return $_dkt9bum4jh8lz1ln.breakToRight(universe,parent,child)},breakPath$2=function(child,isTop,breaker){return $_dkt9bum4jh8lz1ln.breakPath(universe,child,isTop,function(u,p,c){return breaker(p,c)})},$_5glne7m1jh8lz1kg={sharedOne:sharedOne$1,subset:subset$2,ancestors:ancestors$4,breakToLeft:breakToLeft$2,breakToRight:breakToRight$2,breakPath:breakPath$2},inSelection=function(bounds,detail){var leftEdge=detail.column(),rightEdge=detail.column()+detail.colspan()-1,topEdge=detail.row(),bottomEdge=detail.row()+detail.rowspan()-1;return leftEdge<=bounds.finishCol()&&rightEdge>=bounds.startCol()&&topEdge<=bounds.finishRow()&&bottomEdge>=bounds.startRow()},isWithin=function(bounds,detail){return detail.column()>=bounds.startCol()&&detail.column()+detail.colspan()-1<=bounds.finishCol()&&detail.row()>=bounds.startRow()&&detail.row()+detail.rowspan()-1<=bounds.finishRow()},isRectangular=function(warehouse,bounds){for(var isRect=!0,detailIsWithin=$_bgyjg9kejh8lz1ax.curry(isWithin,bounds),i=bounds.startRow();i<=bounds.finishRow();i++)for(var j=bounds.startCol();j<=bounds.finishCol();j++)isRect=isRect&&$_fxwupplkjh8lz1go.getAt(warehouse,i,j).exists(detailIsWithin);
return isRect?Option.some(bounds):Option.none()},$_bx09g1majh8lz1mt={inSelection:inSelection,isWithin:isWithin,isRectangular:isRectangular},getBounds=function(detailA,detailB){return $_g424vknjh8lz1cd.bounds(Math.min(detailA.row(),detailB.row()),Math.min(detailA.column(),detailB.column()),Math.max(detailA.row()+detailA.rowspan()-1,detailB.row()+detailB.rowspan()-1),Math.max(detailA.column()+detailA.colspan()-1,detailB.column()+detailB.colspan()-1))},getAnyBox=function(warehouse,startCell,finishCell){var startCoords=$_fxwupplkjh8lz1go.findItem(warehouse,startCell,$_2eywnlkvjh8lz1e8.eq),finishCoords=$_fxwupplkjh8lz1go.findItem(warehouse,finishCell,$_2eywnlkvjh8lz1e8.eq);return startCoords.bind(function(sc){return finishCoords.map(function(fc){return getBounds(sc,fc)})})},getBox=function(warehouse,startCell,finishCell){return getAnyBox(warehouse,startCell,finishCell).bind(function(bounds){return $_bx09g1majh8lz1mt.isRectangular(warehouse,bounds)})},$_dsxu28mbjh8lz1mz={getAnyBox:getAnyBox,getBox:getBox},moveBy=function(warehouse,cell,row,column){return $_fxwupplkjh8lz1go.findItem(warehouse,cell,$_2eywnlkvjh8lz1e8.eq).bind(function(detail){var startRow=row>0?detail.row()+detail.rowspan()-1:detail.row(),startCol=column>0?detail.column()+detail.colspan()-1:detail.column(),dest=$_fxwupplkjh8lz1go.getAt(warehouse,startRow+row,startCol+column);return dest.map(function(d){return d.element()})})},intercepts=function(warehouse,start,finish){return $_dsxu28mbjh8lz1mz.getAnyBox(warehouse,start,finish).map(function(bounds){var inside=$_fxwupplkjh8lz1go.filterItems(warehouse,$_bgyjg9kejh8lz1ax.curry($_bx09g1majh8lz1mt.inSelection,bounds));return $_6b0spykcjh8lz1ao.map(inside,function(detail){return detail.element()})})},parentCell=function(warehouse,innerCell){var isContainedBy=function(c1,c2){return $_2eywnlkvjh8lz1e8.contains(c2,c1)};return $_fxwupplkjh8lz1go.findItem(warehouse,innerCell,isContainedBy).bind(function(detail){return detail.element()})},$_cwtr9hm9jh8lz1mm={moveBy:moveBy,intercepts:intercepts,parentCell:parentCell},moveBy$1=function(cell,deltaRow,deltaColumn){return $_ee8pmfkojh8lz1ch.table(cell).bind(function(table){var warehouse=getWarehouse(table);return $_cwtr9hm9jh8lz1mm.moveBy(warehouse,cell,deltaRow,deltaColumn)})},intercepts$1=function(table,first,last){var warehouse=getWarehouse(table);return $_cwtr9hm9jh8lz1mm.intercepts(warehouse,first,last)},nestedIntercepts=function(table,first,firstTable,last,lastTable){var warehouse=getWarehouse(table),startCell=$_2eywnlkvjh8lz1e8.eq(table,firstTable)?first:$_cwtr9hm9jh8lz1mm.parentCell(warehouse,first),lastCell=$_2eywnlkvjh8lz1e8.eq(table,lastTable)?last:$_cwtr9hm9jh8lz1mm.parentCell(warehouse,last);return $_cwtr9hm9jh8lz1mm.intercepts(warehouse,startCell,lastCell)},getBox$1=function(table,first,last){var warehouse=getWarehouse(table);return $_dsxu28mbjh8lz1mz.getBox(warehouse,first,last)},getWarehouse=function(table){var list=$_ff1h20kmjh8lz1c3.fromTable(table);return $_fxwupplkjh8lz1go.generate(list)},$_7f2vlpm8jh8lz1mf={moveBy:moveBy$1,intercepts:intercepts$1,nestedIntercepts:nestedIntercepts,getBox:getBox$1},lookupTable=function(container,isRoot){return $_fiygddlhjh8lz1g7.ancestor(container,"table")},identified=$_d2ojjnkijh8lz1bv.immutableBag(["boxes","start","finish"],[]),identify=function(start,finish,isRoot){var getIsRoot=function(rootTable){return function(element){return isRoot(element)||$_2eywnlkvjh8lz1e8.eq(element,rootTable)}};return $_2eywnlkvjh8lz1e8.eq(start,finish)?Option.some(identified({boxes:Option.some([start]),start:start,finish:finish})):lookupTable(start,isRoot).bind(function(startTable){return lookupTable(finish,isRoot).bind(function(finishTable){if($_2eywnlkvjh8lz1e8.eq(startTable,finishTable))return Option.some(identified({boxes:$_7f2vlpm8jh8lz1mf.intercepts(startTable,start,finish),start:start,finish:finish}));if($_2eywnlkvjh8lz1e8.contains(startTable,finishTable)){var ancestorCells=$_coxlualejh8lz1fz.ancestors(finish,"td,th",getIsRoot(startTable)),finishCell=ancestorCells.length>0?ancestorCells[ancestorCells.length-1]:finish;return Option.some(identified({boxes:$_7f2vlpm8jh8lz1mf.nestedIntercepts(startTable,start,startTable,finish,finishTable),start:start,finish:finishCell}))}if($_2eywnlkvjh8lz1e8.contains(finishTable,startTable)){var ancestorCells=$_coxlualejh8lz1fz.ancestors(start,"td,th",getIsRoot(finishTable)),startCell=ancestorCells.length>0?ancestorCells[ancestorCells.length-1]:start;return Option.some(identified({boxes:$_7f2vlpm8jh8lz1mf.nestedIntercepts(finishTable,start,startTable,finish,finishTable),start:start,finish:startCell}))}return $_5glne7m1jh8lz1kg.ancestors(start,finish).shared().bind(function(lca){return $_fiygddlhjh8lz1g7.closest(lca,"table",isRoot).bind(function(lcaTable){var finishAncestorCells=$_coxlualejh8lz1fz.ancestors(finish,"td,th",getIsRoot(lcaTable)),finishCell=finishAncestorCells.length>0?finishAncestorCells[finishAncestorCells.length-1]:finish,startAncestorCells=$_coxlualejh8lz1fz.ancestors(start,"td,th",getIsRoot(lcaTable)),startCell=startAncestorCells.length>0?startAncestorCells[startAncestorCells.length-1]:start;return Option.some(identified({boxes:$_7f2vlpm8jh8lz1mf.nestedIntercepts(lcaTable,start,startTable,finish,finishTable),start:startCell,finish:finishCell}))})})})})},retrieve=function(container,selector){var sels=$_coxlualejh8lz1fz.descendants(container,selector);return sels.length>0?Option.some(sels):Option.none()},getLast=function(boxes,lastSelectedSelector){return $_6b0spykcjh8lz1ao.find(boxes,function(box){return $_62so4qkqjh8lz1di.is(box,lastSelectedSelector)})},getEdges=function(container,firstSelectedSelector,lastSelectedSelector){return $_fiygddlhjh8lz1g7.descendant(container,firstSelectedSelector).bind(function(first){return $_fiygddlhjh8lz1g7.descendant(container,lastSelectedSelector).bind(function(last){return $_5glne7m1jh8lz1kg.sharedOne(lookupTable,[first,last]).map(function(tbl){return{first:$_bgyjg9kejh8lz1ax.constant(first),last:$_bgyjg9kejh8lz1ax.constant(last),table:$_bgyjg9kejh8lz1ax.constant(tbl)}})})})},expandTo=function(finish,firstSelectedSelector){return $_fiygddlhjh8lz1g7.ancestor(finish,"table").bind(function(table){return $_fiygddlhjh8lz1g7.descendant(table,firstSelectedSelector).bind(function(start){return identify(start,finish).bind(function(identified){return identified.boxes().map(function(boxes){return{boxes:$_bgyjg9kejh8lz1ax.constant(boxes),start:$_bgyjg9kejh8lz1ax.constant(identified.start()),finish:$_bgyjg9kejh8lz1ax.constant(identified.finish())}})})})})},shiftSelection=function(boxes,deltaRow,deltaColumn,firstSelectedSelector,lastSelectedSelector){return getLast(boxes,lastSelectedSelector).bind(function(last){return $_7f2vlpm8jh8lz1mf.moveBy(last,deltaRow,deltaColumn).bind(function(finish){return expandTo(finish,firstSelectedSelector)})})},$_5tpv0tm0jh8lz1jt={identify:identify,retrieve:retrieve,shiftSelection:shiftSelection,getEdges:getEdges},retrieve$1=function(container,selector){return $_5tpv0tm0jh8lz1jt.retrieve(container,selector)},retrieveBox=function(container,firstSelectedSelector,lastSelectedSelector){return $_5tpv0tm0jh8lz1jt.getEdges(container,firstSelectedSelector,lastSelectedSelector).bind(function(edges){var isRoot=function(ancestor){return $_2eywnlkvjh8lz1e8.eq(container,ancestor)},firstAncestor=$_fiygddlhjh8lz1g7.ancestor(edges.first(),"thead,tfoot,tbody,table",isRoot),lastAncestor=$_fiygddlhjh8lz1g7.ancestor(edges.last(),"thead,tfoot,tbody,table",isRoot);return firstAncestor.bind(function(fA){return lastAncestor.bind(function(lA){return $_2eywnlkvjh8lz1e8.eq(fA,lA)?$_7f2vlpm8jh8lz1mf.getBox(edges.table(),edges.first(),edges.last()):Option.none()})})})},$_21toytlzjh8lz1jj={retrieve:retrieve$1,retrieveBox:retrieveBox},selected="data-mce-selected",selectedSelector="td["+selected+"],th["+selected+"]",attributeSelector="["+selected+"]",firstSelected="data-mce-first-selected",firstSelectedSelector="td["+firstSelected+"],th["+firstSelected+"]",lastSelected="data-mce-last-selected",lastSelectedSelector="td["+lastSelected+"],th["+lastSelected+"]",$_2yroczmcjh8lz1n4={selected:$_bgyjg9kejh8lz1ax.constant(selected),selectedSelector:$_bgyjg9kejh8lz1ax.constant(selectedSelector),attributeSelector:$_bgyjg9kejh8lz1ax.constant(attributeSelector),firstSelected:$_bgyjg9kejh8lz1ax.constant(firstSelected),firstSelectedSelector:$_bgyjg9kejh8lz1ax.constant(firstSelectedSelector),lastSelected:$_bgyjg9kejh8lz1ax.constant(lastSelected),lastSelectedSelector:$_bgyjg9kejh8lz1ax.constant(lastSelectedSelector)},generate$1=function(cases){if(!$_d1kyz8kfjh8lz1az.isArray(cases))throw new Error("cases must be an array");if(0===cases.length)throw new Error("there must be at least one case");var constructors=[],adt={};return $_6b0spykcjh8lz1ao.each(cases,function(acase,count){var keys=$_8kti2hkhjh8lz1bt.keys(acase);if(1!==keys.length)throw new Error("one and only one name per case");var key=keys[0],value=acase[key];if(void 0!==adt[key])throw new Error("duplicate key detected:"+key);if("cata"===key)throw new Error("cannot have a case named cata (sorry)");if(!$_d1kyz8kfjh8lz1az.isArray(value))throw new Error("case arguments must be an array");constructors.push(key),adt[key]=function(){var argLength=arguments.length;if(argLength!==value.length)throw new Error("Wrong number of arguments to case "+key+". Expected "+value.length+" ("+value+"), got "+argLength);for(var args=new Array(argLength),i=0;i<args.length;i++)args[i]=arguments[i];var match=function(branches){var branchKeys=$_8kti2hkhjh8lz1bt.keys(branches);if(constructors.length!==branchKeys.length)throw new Error("Wrong number of arguments to match. Expected: "+constructors.join(",")+"\nActual: "+branchKeys.join(","));var allReqd=$_6b0spykcjh8lz1ao.forall(constructors,function(reqKey){return $_6b0spykcjh8lz1ao.contains(branchKeys,reqKey)});if(!allReqd)throw new Error("Not all branches were specified when using match. Specified: "+branchKeys.join(", ")+"\nRequired: "+constructors.join(", "));return branches[key].apply(null,args)};return{fold:function(){if(arguments.length!==cases.length)throw new Error("Wrong number of arguments to fold. Expected "+cases.length+", got "+arguments.length);var target=arguments[count];return target.apply(null,args)},match:match,log:function(label){console.log(label,{constructors:constructors,constructor:key,params:args})}}}}),adt},$_659si2mejh8lz1n9={generate:generate$1},type$1=$_659si2mejh8lz1n9.generate([{none:[]},{multiple:["elements"]},{single:["selection"]}]),cata=function(subject,onNone,onMultiple,onSingle){return subject.fold(onNone,onMultiple,onSingle)},$_crzziemdjh8lz1n7={cata:cata,none:type$1.none,multiple:type$1.multiple,single:type$1.single},selection=function(cell,selections){return $_crzziemdjh8lz1n7.cata(selections.get(),$_bgyjg9kejh8lz1ax.constant([]),$_bgyjg9kejh8lz1ax.identity,$_bgyjg9kejh8lz1ax.constant([cell]))},unmergable=function(cell,selections){var hasSpan=function(elem){return $_1mp8lglcjh8lz1fq.has(elem,"rowspan")&&parseInt($_1mp8lglcjh8lz1fq.get(elem,"rowspan"),10)>1||$_1mp8lglcjh8lz1fq.has(elem,"colspan")&&parseInt($_1mp8lglcjh8lz1fq.get(elem,"colspan"),10)>1},candidates=selection(cell,selections);return candidates.length>0&&$_6b0spykcjh8lz1ao.forall(candidates,hasSpan)?Option.some(candidates):Option.none()},mergable=function(table,selections){return $_crzziemdjh8lz1n7.cata(selections.get(),Option.none,function(cells,_env){return 0===cells.length?Option.none():$_21toytlzjh8lz1jj.retrieveBox(table,$_2yroczmcjh8lz1n4.firstSelectedSelector(),$_2yroczmcjh8lz1n4.lastSelectedSelector()).bind(function(bounds){return cells.length>1?Option.some({bounds:$_bgyjg9kejh8lz1ax.constant(bounds),cells:$_bgyjg9kejh8lz1ax.constant(cells)}):Option.none()})},Option.none)},$_59in44lyjh8lz1j8={mergable:mergable,unmergable:unmergable,selection:selection},noMenu=function(cell){return{element:$_bgyjg9kejh8lz1ax.constant(cell),mergable:Option.none,unmergable:Option.none,selection:$_bgyjg9kejh8lz1ax.constant([cell])}},forMenu=function(selections,table,cell){return{element:$_bgyjg9kejh8lz1ax.constant(cell),mergable:$_bgyjg9kejh8lz1ax.constant($_59in44lyjh8lz1j8.mergable(table,selections)),unmergable:$_bgyjg9kejh8lz1ax.constant($_59in44lyjh8lz1j8.unmergable(cell,selections)),selection:$_bgyjg9kejh8lz1ax.constant($_59in44lyjh8lz1j8.selection(cell,selections))}},notCell$1=function(element){return noMenu(element)},paste$1=$_d2ojjnkijh8lz1bv.immutable("element","clipboard","generators"),pasteRows=function(selections,table,cell,clipboard,generators){return{element:$_bgyjg9kejh8lz1ax.constant(cell),mergable:Option.none,unmergable:Option.none,selection:$_bgyjg9kejh8lz1ax.constant($_59in44lyjh8lz1j8.selection(cell,selections)),clipboard:$_bgyjg9kejh8lz1ax.constant(clipboard),generators:$_bgyjg9kejh8lz1ax.constant(generators)}},$_3xfj7olxjh8lz1j2={noMenu:noMenu,forMenu:forMenu,notCell:notCell$1,paste:paste$1,pasteRows:pasteRows},extractSelected=function(cells){return $_ee8pmfkojh8lz1ch.table(cells[0]).map($_zeqq4lrjh8lz1id.deep).map(function(replica){return[$_dj8mm1kgjh8lz1b3.extract(replica,$_2yroczmcjh8lz1n4.attributeSelector())]})},serializeElement=function(editor,elm){return editor.selection.serializer.serialize(elm.dom(),{})},registerEvents=function(editor,selections,actions,cellSelection){editor.on("BeforeGetContent",function(e){var multiCellContext=function(cells){e.preventDefault(),extractSelected(cells).each(function(elements){e.content=$_6b0spykcjh8lz1ao.map(elements,function(elm){return serializeElement(editor,elm)}).join("")})};e.selection===!0&&$_crzziemdjh8lz1n7.cata(selections.get(),$_bgyjg9kejh8lz1ax.noop,multiCellContext,$_bgyjg9kejh8lz1ax.noop)}),editor.on("BeforeSetContent",function(e){if(e.selection===!0&&e.paste===!0){var cellOpt=Option.from(editor.dom.getParent(editor.selection.getStart(),"th,td"));cellOpt.each(function(domCell){var cell=$_6vo9a4krjh8lz1do.fromDom(domCell),table=$_ee8pmfkojh8lz1ch.table(cell);table.bind(function(table){var elements=$_6b0spykcjh8lz1ao.filter($_200no5lwjh8lz1iy.fromHtml(e.content),function(content){return"meta"!==$_a3izpgldjh8lz1fy.name(content)});if(1===elements.length&&"table"===$_a3izpgldjh8lz1fy.name(elements[0])){e.preventDefault();var doc=$_6vo9a4krjh8lz1do.fromDom(editor.getDoc()),generators=$_3fxw02lqjh8lz1hp.paste(doc),targets=$_3xfj7olxjh8lz1j2.paste(cell,elements[0],generators);actions.pasteCells(table,targets).each(function(rng){editor.selection.setRng(rng),editor.focus(),cellSelection.clear(table)})}})})}})},$_3x42x9kbjh8lz1a2={registerEvents:registerEvents},api$1=Dimension("height",function(element){return $_brbde9lgjh8lz1g4.inBody(element)?element.dom().getBoundingClientRect().height:element.dom().offsetHeight}),set$3=function(element,h){api$1.set(element,h)},get$3=function(element){return api$1.get(element)},getOuter=function(element){return api$1.getOuter(element)},setMax=function(element,value){var inclusions=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],absMax=api$1.max(element,value,inclusions);$_3ory84lljh8lz1gx.set(element,"max-height",absMax+"px")},$_dc45zsmjjh8lz1or={set:set$3,get:get$3,getOuter:getOuter,setMax:setMax},api$2=Dimension("width",function(element){return element.dom().offsetWidth}),set$4=function(element,h){api$2.set(element,h)},get$4=function(element){return api$2.get(element)},getOuter$1=function(element){return api$2.getOuter(element)},setMax$1=function(element,value){var inclusions=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],absMax=api$2.max(element,value,inclusions);$_3ory84lljh8lz1gx.set(element,"max-width",absMax+"px")},$_fu3j58mljh8lz1oz={set:set$4,get:get$4,getOuter:getOuter$1,setMax:setMax$1},platform=$_a6om0dl0jh8lz1ep.detect(),needManualCalc=function(){return platform.browser.isIE()||platform.browser.isEdge()},toNumber=function(px,fallback){var num=parseFloat(px);return isNaN(num)?fallback:num},getProp=function(elm,name,fallback){return toNumber($_3ory84lljh8lz1gx.get(elm,name),fallback)},getCalculatedHeight=function(cell){var paddingTop=getProp(cell,"padding-top",0),paddingBottom=getProp(cell,"padding-bottom",0),borderTop=getProp(cell,"border-top-width",0),borderBottom=getProp(cell,"border-bottom-width",0),height=cell.dom().getBoundingClientRect().height,boxSizing=$_3ory84lljh8lz1gx.get(cell,"box-sizing"),borders=borderTop+borderBottom;return"border-box"===boxSizing?height:height-paddingTop-paddingBottom-borders},getWidth=function(cell){return getProp(cell,"width",$_fu3j58mljh8lz1oz.get(cell))},getHeight=function(cell){return needManualCalc()?getCalculatedHeight(cell):getProp(cell,"height",$_dc45zsmjjh8lz1or.get(cell))},$_4n3vr6mijh8lz1oi={getWidth:getWidth,getHeight:getHeight},genericSizeRegex=/(\d+(\.\d+)?)(\w|%)*/,percentageBasedSizeRegex=/(\d+(\.\d+)?)%/,pixelBasedSizeRegex=/(\d+(\.\d+)?)px|em/,setPixelWidth=function(cell,amount){$_3ory84lljh8lz1gx.set(cell,"width",amount+"px")},setPercentageWidth=function(cell,amount){$_3ory84lljh8lz1gx.set(cell,"width",amount+"%")},setHeight=function(cell,amount){$_3ory84lljh8lz1gx.set(cell,"height",amount+"px")},getHeightValue=function(cell){return $_3ory84lljh8lz1gx.getRaw(cell,"height").getOrThunk(function(){return $_4n3vr6mijh8lz1oi.getHeight(cell)+"px"})},convert=function(cell,number,getter,setter){var newSize=$_ee8pmfkojh8lz1ch.table(cell).map(function(table){var total=getter(table);return Math.floor(number/100*total)}).getOr(number);return setter(cell,newSize),newSize},normalizePixelSize=function(value,cell,getter,setter){var number=parseInt(value,10);return $_34vbjol9jh8lz1fk.endsWith(value,"%")&&"table"!==$_a3izpgldjh8lz1fy.name(cell)?convert(cell,number,getter,setter):number},getTotalHeight=function(cell){var value=getHeightValue(cell);return value?normalizePixelSize(value,cell,$_dc45zsmjjh8lz1or.get,setHeight):$_dc45zsmjjh8lz1or.get(cell)},get$5=function(cell,type,f){var v=f(cell),span=getSpan(cell,type);return v/span},getSpan=function(cell,type){return $_1mp8lglcjh8lz1fq.has(cell,type)?parseInt($_1mp8lglcjh8lz1fq.get(cell,type),10):1},getRawWidth=function(element){var cssWidth=$_3ory84lljh8lz1gx.getRaw(element,"width");return cssWidth.fold(function(){return Option.from($_1mp8lglcjh8lz1fq.get(element,"width"))},function(width){return Option.some(width)})},normalizePercentageWidth=function(cellWidth,tableSize){return cellWidth/tableSize.pixelWidth()*100},choosePercentageSize=function(element,width,tableSize){if(percentageBasedSizeRegex.test(width)){var percentMatch=percentageBasedSizeRegex.exec(width);return parseFloat(percentMatch[1])}var fallbackWidth=$_fu3j58mljh8lz1oz.get(element),intWidth=parseInt(fallbackWidth,10);return normalizePercentageWidth(intWidth,tableSize)},getPercentageWidth=function(cell,tableSize){var width=getRawWidth(cell);return width.fold(function(){var width=$_fu3j58mljh8lz1oz.get(cell),intWidth=parseInt(width,10);return normalizePercentageWidth(intWidth,tableSize)},function(width){return choosePercentageSize(cell,width,tableSize)})},normalizePixelWidth=function(cellWidth,tableSize){return cellWidth/100*tableSize.pixelWidth()},choosePixelSize=function(element,width,tableSize){if(pixelBasedSizeRegex.test(width)){var pixelMatch=pixelBasedSizeRegex.exec(width);return parseInt(pixelMatch[1],10)}if(percentageBasedSizeRegex.test(width)){var percentMatch=percentageBasedSizeRegex.exec(width),floatWidth=parseFloat(percentMatch[1]);return normalizePixelWidth(floatWidth,tableSize)}var fallbackWidth=$_fu3j58mljh8lz1oz.get(element);return parseInt(fallbackWidth,10)},getPixelWidth=function(cell,tableSize){var width=getRawWidth(cell);return width.fold(function(){var width=$_fu3j58mljh8lz1oz.get(cell),intWidth=parseInt(width,10);return intWidth},function(width){return choosePixelSize(cell,width,tableSize)})},getHeight$1=function(cell){return get$5(cell,"rowspan",getTotalHeight)},getGenericWidth=function(cell){var width=getRawWidth(cell);return width.bind(function(width){if(genericSizeRegex.test(width)){var match=genericSizeRegex.exec(width);return Option.some({width:$_bgyjg9kejh8lz1ax.constant(match[1]),unit:$_bgyjg9kejh8lz1ax.constant(match[3])})}return Option.none()})},setGenericWidth=function(cell,amount,unit){$_3ory84lljh8lz1gx.set(cell,"width",amount+unit)},$_i2xtsmhjh8lz1nv={percentageBasedSizeRegex:$_bgyjg9kejh8lz1ax.constant(percentageBasedSizeRegex),pixelBasedSizeRegex:$_bgyjg9kejh8lz1ax.constant(pixelBasedSizeRegex),setPixelWidth:setPixelWidth,setPercentageWidth:setPercentageWidth,setHeight:setHeight,getPixelWidth:getPixelWidth,getPercentageWidth:getPercentageWidth,getGenericWidth:getGenericWidth,setGenericWidth:setGenericWidth,getHeight:getHeight$1,getRawWidth:getRawWidth},halve=function(main,other){var width=$_i2xtsmhjh8lz1nv.getGenericWidth(main);width.each(function(width){var newWidth=width.width()/2;$_i2xtsmhjh8lz1nv.setGenericWidth(main,newWidth,width.unit()),$_i2xtsmhjh8lz1nv.setGenericWidth(other,newWidth,width.unit())})},$_36r49rmgjh8lz1nt={halve:halve},attached=function(element,scope){var doc=scope||$_6vo9a4krjh8lz1do.fromDom(document.documentElement);return $_aykj0glijh8lz1g9.ancestor(element,$_bgyjg9kejh8lz1ax.curry($_2eywnlkvjh8lz1e8.eq,doc)).isSome()},windowOf=function(element){var dom=element.dom();return dom===dom.window?element:$_a3izpgldjh8lz1fy.isDocument(element)?dom.defaultView||dom.parentWindow:null},$_d04mvbmqjh8lz1pi={attached:attached,windowOf:windowOf},r=function(left,top){var translate=function(x,y){return r(left+x,top+y)};return{left:$_bgyjg9kejh8lz1ax.constant(left),top:$_bgyjg9kejh8lz1ax.constant(top),translate:translate}},boxPosition=function(dom){var box=dom.getBoundingClientRect();return r(box.left,box.top)},firstDefinedOrZero=function(a,b){return void 0!==a?a:void 0!==b?b:0},absolute=function(element){var doc=element.dom().ownerDocument,body=doc.body,win=$_d04mvbmqjh8lz1pi.windowOf($_6vo9a4krjh8lz1do.fromDom(doc)),html=doc.documentElement,scrollTop=firstDefinedOrZero(win.pageYOffset,html.scrollTop),scrollLeft=firstDefinedOrZero(win.pageXOffset,html.scrollLeft),clientTop=firstDefinedOrZero(html.clientTop,body.clientTop),clientLeft=firstDefinedOrZero(html.clientLeft,body.clientLeft);return viewport(element).translate(scrollLeft-clientLeft,scrollTop-clientTop)},relative=function(element){var dom=element.dom();return r(dom.offsetLeft,dom.offsetTop)},viewport=function(element){var dom=element.dom(),doc=dom.ownerDocument,body=doc.body,html=$_6vo9a4krjh8lz1do.fromDom(doc.documentElement);return body===dom?r(body.offsetLeft,body.offsetTop):$_d04mvbmqjh8lz1pi.attached(element,html)?boxPosition(dom):r(0,0)},$_6xc5idmpjh8lz1ph={absolute:absolute,relative:relative,viewport:viewport},rowInfo=$_d2ojjnkijh8lz1bv.immutable("row","y"),colInfo=$_d2ojjnkijh8lz1bv.immutable("col","x"),rtlEdge=function(cell){var pos=$_6xc5idmpjh8lz1ph.absolute(cell);return pos.left()+$_fu3j58mljh8lz1oz.getOuter(cell)},ltrEdge=function(cell){return $_6xc5idmpjh8lz1ph.absolute(cell).left()},getLeftEdge=function(index,cell){return colInfo(index,ltrEdge(cell))},getRightEdge=function(index,cell){return colInfo(index,rtlEdge(cell))},getTop=function(cell){return $_6xc5idmpjh8lz1ph.absolute(cell).top()},getTopEdge=function(index,cell){return rowInfo(index,getTop(cell))},getBottomEdge=function(index,cell){return rowInfo(index,getTop(cell)+$_dc45zsmjjh8lz1or.getOuter(cell))},findPositions=function(getInnerEdge,getOuterEdge,array){if(0===array.length)return[];var lines=$_6b0spykcjh8lz1ao.map(array.slice(1),function(cellOption,index){return cellOption.map(function(cell){return getInnerEdge(index,cell)})}),lastLine=array[array.length-1].map(function(cell){return getOuterEdge(array.length-1,cell)});return lines.concat([lastLine])},negate=function(step,_table){return-step},height={delta:$_bgyjg9kejh8lz1ax.identity,positions:$_bgyjg9kejh8lz1ax.curry(findPositions,getTopEdge,getBottomEdge),edge:getTop},ltr={delta:$_bgyjg9kejh8lz1ax.identity,edge:ltrEdge,positions:$_bgyjg9kejh8lz1ax.curry(findPositions,getLeftEdge,getRightEdge)},rtl={delta:negate,edge:rtlEdge,positions:$_bgyjg9kejh8lz1ax.curry(findPositions,getRightEdge,getLeftEdge)},$_sdnutmojh8lz1p3={height:height,rtl:rtl,ltr:ltr},$_7vn0kzmnjh8lz1p2={ltr:$_sdnutmojh8lz1p3.ltr,rtl:$_sdnutmojh8lz1p3.rtl},getGridSize=function(table){var input=$_ff1h20kmjh8lz1c3.fromTable(table),warehouse=$_fxwupplkjh8lz1go.generate(input);return warehouse.grid()},$_fpjoz7msjh8lz1pq={getGridSize:getGridSize},Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},base=function(handleUnsupported,required){return baseWith(handleUnsupported,required,{validate:$_d1kyz8kfjh8lz1az.isFunction,label:"function"})},baseWith=function(handleUnsupported,required,pred){if(0===required.length)throw new Error("You must specify at least one required field.");return $_9ogtmjkljh8lz1c0.validateStrArr("required",required),$_9ogtmjkljh8lz1c0.checkDupes(required),function(obj){var keys=$_8kti2hkhjh8lz1bt.keys(obj),allReqd=$_6b0spykcjh8lz1ao.forall(required,function(req){return $_6b0spykcjh8lz1ao.contains(keys,req)});allReqd||$_9ogtmjkljh8lz1c0.reqMessage(required,keys),handleUnsupported(required,keys);var invalidKeys=$_6b0spykcjh8lz1ao.filter(required,function(key){return!pred.validate(obj[key],key)});return invalidKeys.length>0&&$_9ogtmjkljh8lz1c0.invalidTypeMessage(invalidKeys,pred.label),obj}},handleExact=function(required,keys){var unsupported=$_6b0spykcjh8lz1ao.filter(keys,function(key){return!$_6b0spykcjh8lz1ao.contains(required,key)});unsupported.length>0&&$_9ogtmjkljh8lz1c0.unsuppMessage(unsupported)},allowExtra=$_bgyjg9kejh8lz1ax.noop,$_2qijvhmwjh8lz1qv={exactly:$_bgyjg9kejh8lz1ax.curry(base,handleExact),ensure:$_bgyjg9kejh8lz1ax.curry(base,allowExtra),ensureWith:$_bgyjg9kejh8lz1ax.curry(baseWith,allowExtra)},elementToData=function(element){var colspan=$_1mp8lglcjh8lz1fq.has(element,"colspan")?parseInt($_1mp8lglcjh8lz1fq.get(element,"colspan"),10):1,rowspan=$_1mp8lglcjh8lz1fq.has(element,"rowspan")?parseInt($_1mp8lglcjh8lz1fq.get(element,"rowspan"),10):1;return{element:$_bgyjg9kejh8lz1ax.constant(element),colspan:$_bgyjg9kejh8lz1ax.constant(colspan),rowspan:$_bgyjg9kejh8lz1ax.constant(rowspan)}},modification=function(generators,_toData){contract(generators);var position=Cell(Option.none()),toData=void 0!==_toData?_toData:elementToData,nu=function(data){return generators.cell(data)},nuFrom=function(element){var data=toData(element);return nu(data)},add=function(element){var replacement=nuFrom(element);return position.get().isNone()&&position.set(Option.some(replacement)),recent=Option.some({item:element,replacement:replacement}),replacement},recent=Option.none(),getOrInit=function(element,comparator){return recent.fold(function(){return add(element)},function(p){return comparator(element,p.item)?p.replacement:add(element)})};return{getOrInit:getOrInit,cursor:position.get}},transform=function(scope,tag){return function(generators){var position=Cell(Option.none());contract(generators);var list=[],find=function(element,comparator){return $_6b0spykcjh8lz1ao.find(list,function(x){return comparator(x.item,element)})},makeNew=function(element){var cell=generators.replace(element,tag,{scope:scope});return list.push({item:element,sub:cell}),position.get().isNone()&&position.set(Option.some(cell)),cell},replaceOrInit=function(element,comparator){return find(element,comparator).fold(function(){return makeNew(element)},function(p){return comparator(element,p.item)?p.sub:makeNew(element)})};return{replaceOrInit:replaceOrInit,cursor:position.get}}},merging=function(generators){contract(generators);var position=Cell(Option.none()),combine=function(cell){return position.get().isNone()&&position.set(Option.some(cell)),function(){var raw=generators.cell({element:$_bgyjg9kejh8lz1ax.constant(cell),colspan:$_bgyjg9kejh8lz1ax.constant(1),rowspan:$_bgyjg9kejh8lz1ax.constant(1)});return $_3ory84lljh8lz1gx.remove(raw,"width"),$_3ory84lljh8lz1gx.remove(cell,"width"),raw}};return{combine:combine,cursor:position.get}},contract=$_2qijvhmwjh8lz1qv.exactly(["cell","row","replace","gap"]),$_46iqoomujh8lz1qf={modification:modification,transform:transform,merging:merging},blockList=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],isList=function(universe,item){var tagName=universe.property().name(item);return $_6b0spykcjh8lz1ao.contains(["ol","ul"],tagName)},isBlock=function(universe,item){var tagName=universe.property().name(item);return $_6b0spykcjh8lz1ao.contains(blockList,tagName)},isFormatting=function(universe,item){var tagName=universe.property().name(item);return $_6b0spykcjh8lz1ao.contains(["address","pre","p","h1","h2","h3","h4","h5","h6"],tagName)},isHeading=function(universe,item){var tagName=universe.property().name(item);return $_6b0spykcjh8lz1ao.contains(["h1","h2","h3","h4","h5","h6"],tagName)},isContainer=function(universe,item){return $_6b0spykcjh8lz1ao.contains(["div","li","td","th","blockquote","body","caption"],universe.property().name(item))},isEmptyTag=function(universe,item){return $_6b0spykcjh8lz1ao.contains(["br","img","hr","input"],universe.property().name(item))},isFrame=function(universe,item){return"iframe"===universe.property().name(item)},isInline=function(universe,item){return!(isBlock(universe,item)||isEmptyTag(universe,item))&&"li"!==universe.property().name(item)},$_77qm98mzjh8lz1ro={isBlock:isBlock,isList:isList,isFormatting:isFormatting,isHeading:isHeading,isContainer:isContainer,isEmptyTag:isEmptyTag,isFrame:isFrame,isInline:isInline},universe$1=DomUniverse(),isBlock$1=function(element){return $_77qm98mzjh8lz1ro.isBlock(universe$1,element)},isList$1=function(element){return $_77qm98mzjh8lz1ro.isList(universe$1,element)},isFormatting$1=function(element){return $_77qm98mzjh8lz1ro.isFormatting(universe$1,element)},isHeading$1=function(element){return $_77qm98mzjh8lz1ro.isHeading(universe$1,element)},isContainer$1=function(element){return $_77qm98mzjh8lz1ro.isContainer(universe$1,element)},isEmptyTag$1=function(element){return $_77qm98mzjh8lz1ro.isEmptyTag(universe$1,element)},isFrame$1=function(element){return $_77qm98mzjh8lz1ro.isFrame(universe$1,element)},isInline$1=function(element){return $_77qm98mzjh8lz1ro.isInline(universe$1,element)},$_39l7z3myjh8lz1rk={isBlock:isBlock$1,isList:isList$1,isFormatting:isFormatting$1,isHeading:isHeading$1,isContainer:isContainer$1,isEmptyTag:isEmptyTag$1,isFrame:isFrame$1,isInline:isInline$1},merge=function(cells){var isBr=function(el){return"br"===$_a3izpgldjh8lz1fy.name(el)},advancedBr=function(children){return $_6b0spykcjh8lz1ao.forall(children,function(c){return isBr(c)||$_a3izpgldjh8lz1fy.isText(c)&&0===$_bri5anlujh8lz1in.get(c).trim().length})},isListItem=function(el){return"li"===$_a3izpgldjh8lz1fy.name(el)||$_aykj0glijh8lz1g9.ancestor(el,$_39l7z3myjh8lz1rk.isList).isSome()},siblingIsBlock=function(el){return $_4hc7u2ktjh8lz1dv.nextSibling(el).map(function(rightSibling){return!!$_39l7z3myjh8lz1rk.isBlock(rightSibling)||($_39l7z3myjh8lz1rk.isEmptyTag(rightSibling)?"img"!==$_a3izpgldjh8lz1fy.name(rightSibling):void 0)}).getOr(!1)},markCell=function(cell){return $_fpdn73lsjh8lz1ig.last(cell).bind(function(rightEdge){var rightSiblingIsBlock=siblingIsBlock(rightEdge);return $_4hc7u2ktjh8lz1dv.parent(rightEdge).map(function(parent){return rightSiblingIsBlock===!0||isListItem(parent)||isBr(rightEdge)||$_39l7z3myjh8lz1rk.isBlock(parent)&&!$_2eywnlkvjh8lz1e8.eq(cell,parent)?[]:[$_6vo9a4krjh8lz1do.fromTag("br")]})}).getOr([])},markContent=function(){var content=$_6b0spykcjh8lz1ao.bind(cells,function(cell){var children=$_4hc7u2ktjh8lz1dv.children(cell);return advancedBr(children)?[]:children.concat(markCell(cell))});return 0===content.length?[$_6vo9a4krjh8lz1do.fromTag("br")]:content},contents=markContent();$_f2hny0lojh8lz1hi.empty(cells[0]),$_d7tq5mlpjh8lz1hl.append(cells[0],contents);
},$_9305lemxjh8lz1qy={merge:merge},shallow$1=function(old,nu){return nu},deep$1=function(old,nu){var bothObjects=$_d1kyz8kfjh8lz1az.isObject(old)&&$_d1kyz8kfjh8lz1az.isObject(nu);return bothObjects?deepMerge(old,nu):nu},baseMerge=function(merger){return function(){for(var objects=new Array(arguments.length),i=0;i<objects.length;i++)objects[i]=arguments[i];if(0===objects.length)throw new Error("Can't merge zero objects");for(var ret={},j=0;j<objects.length;j++){var curObject=objects[j];for(var key in curObject)curObject.hasOwnProperty(key)&&(ret[key]=merger(ret[key],curObject[key]))}return ret}},deepMerge=baseMerge(deep$1),merge$1=baseMerge(shallow$1),$_b4x7eon1jh8lz1se={deepMerge:deepMerge,merge:merge$1},cat=function(arr){for(var r=[],push=function(x){r.push(x)},i=0;i<arr.length;i++)arr[i].each(push);return r},findMap=function(arr,f){for(var i=0;i<arr.length;i++){var r=f(arr[i],i);if(r.isSome())return r}return Option.none()},liftN=function(arr,f){for(var r=[],i=0;i<arr.length;i++){var x=arr[i];if(!x.isSome())return Option.none();r.push(x.getOrDie())}return Option.some(f.apply(null,r))},$_clgylhn2jh8lz1sg={cat:cat,findMap:findMap,liftN:liftN},addCell=function(gridRow,index,cell){var cells=gridRow.cells(),before=cells.slice(0,index),after=cells.slice(index),newCells=before.concat([cell]).concat(after);return setCells(gridRow,newCells)},mutateCell=function(gridRow,index,cell){var cells=gridRow.cells();cells[index]=cell},setCells=function(gridRow,cells){return $_g424vknjh8lz1cd.rowcells(cells,gridRow.section())},mapCells=function(gridRow,f){var cells=gridRow.cells(),r=$_6b0spykcjh8lz1ao.map(cells,f);return $_g424vknjh8lz1cd.rowcells(r,gridRow.section())},getCell=function(gridRow,index){return gridRow.cells()[index]},getCellElement=function(gridRow,index){return getCell(gridRow,index).element()},cellLength=function(gridRow){return gridRow.cells().length},$_cndk32n5jh8lz1ss={addCell:addCell,setCells:setCells,mutateCell:mutateCell,getCell:getCell,getCellElement:getCellElement,mapCells:mapCells,cellLength:cellLength},getColumn=function(grid,index){return $_6b0spykcjh8lz1ao.map(grid,function(row){return $_cndk32n5jh8lz1ss.getCell(row,index)})},getRow=function(grid,index){return grid[index]},findDiff=function(xs,comp){if(0===xs.length)return 0;var first=xs[0],index=$_6b0spykcjh8lz1ao.findIndex(xs,function(x){return!comp(first.element(),x.element())});return index.fold(function(){return xs.length},function(ind){return ind})},subgrid=function(grid,row,column,comparator){var restOfRow=getRow(grid,row).cells().slice(column),endColIndex=findDiff(restOfRow,comparator),restOfColumn=getColumn(grid,column).slice(row),endRowIndex=findDiff(restOfColumn,comparator);return{colspan:$_bgyjg9kejh8lz1ax.constant(endColIndex),rowspan:$_bgyjg9kejh8lz1ax.constant(endRowIndex)}},$_6s0r2pn4jh8lz1sn={subgrid:subgrid},toDetails=function(grid,comparator){var seen=$_6b0spykcjh8lz1ao.map(grid,function(row,ri){return $_6b0spykcjh8lz1ao.map(row.cells(),function(col,ci){return!1})}),updateSeen=function(ri,ci,rowspan,colspan){for(var r=ri;r<ri+rowspan;r++)for(var c=ci;c<ci+colspan;c++)seen[r][c]=!0};return $_6b0spykcjh8lz1ao.map(grid,function(row,ri){var details=$_6b0spykcjh8lz1ao.bind(row.cells(),function(cell,ci){if(seen[ri][ci]===!1){var result=$_6s0r2pn4jh8lz1sn.subgrid(grid,ri,ci,comparator);return updateSeen(ri,ci,result.rowspan(),result.colspan()),[$_g424vknjh8lz1cd.detailnew(cell.element(),result.rowspan(),result.colspan(),cell.isNew())]}return[]});return $_g424vknjh8lz1cd.rowdetails(details,row.section())})},toGrid=function(warehouse,generators,isNew){for(var grid=[],i=0;i<warehouse.grid().rows();i++){for(var rowCells=[],j=0;j<warehouse.grid().columns();j++){var element=$_fxwupplkjh8lz1go.getAt(warehouse,i,j).map(function(item){return $_g424vknjh8lz1cd.elementnew(item.element(),isNew)}).getOrThunk(function(){return $_g424vknjh8lz1cd.elementnew(generators.gap(),!0)});rowCells.push(element)}var row=$_g424vknjh8lz1cd.rowcells(rowCells,warehouse.all()[i].section());grid.push(row)}return grid},$_7a3bzon3jh8lz1si={toDetails:toDetails,toGrid:toGrid},setIfNot=function(element,property,value,ignore){value===ignore?$_1mp8lglcjh8lz1fq.remove(element,property):$_1mp8lglcjh8lz1fq.set(element,property,value)},render=function(table,grid){var newRows=[],newCells=[],renderSection=function(gridSection,sectionName){var section=$_fiygddlhjh8lz1g7.child(table,sectionName).getOrThunk(function(){var tb=$_6vo9a4krjh8lz1do.fromTag(sectionName,$_4hc7u2ktjh8lz1dv.owner(table).dom());return $_6qqu1alnjh8lz1hg.append(table,tb),tb});$_f2hny0lojh8lz1hi.empty(section);var rows=$_6b0spykcjh8lz1ao.map(gridSection,function(row){row.isNew()&&newRows.push(row.element());var tr=row.element();return $_f2hny0lojh8lz1hi.empty(tr),$_6b0spykcjh8lz1ao.each(row.cells(),function(cell){cell.isNew()&&newCells.push(cell.element()),setIfNot(cell.element(),"colspan",cell.colspan(),1),setIfNot(cell.element(),"rowspan",cell.rowspan(),1),$_6qqu1alnjh8lz1hg.append(tr,cell.element())}),tr});$_d7tq5mlpjh8lz1hl.append(section,rows)},removeSection=function(sectionName){$_fiygddlhjh8lz1g7.child(table,sectionName).bind($_f2hny0lojh8lz1hi.remove)},renderOrRemoveSection=function(gridSection,sectionName){gridSection.length>0?renderSection(gridSection,sectionName):removeSection(sectionName)},headSection=[],bodySection=[],footSection=[];return $_6b0spykcjh8lz1ao.each(grid,function(row){switch(row.section()){case"thead":headSection.push(row);break;case"tbody":bodySection.push(row);break;case"tfoot":footSection.push(row)}}),renderOrRemoveSection(headSection,"thead"),renderOrRemoveSection(bodySection,"tbody"),renderOrRemoveSection(footSection,"tfoot"),{newRows:$_bgyjg9kejh8lz1ax.constant(newRows),newCells:$_bgyjg9kejh8lz1ax.constant(newCells)}},copy$2=function(grid){var rows=$_6b0spykcjh8lz1ao.map(grid,function(row){var tr=$_zeqq4lrjh8lz1id.shallow(row.element());return $_6b0spykcjh8lz1ao.each(row.cells(),function(cell){var clonedCell=$_zeqq4lrjh8lz1id.deep(cell.element());setIfNot(clonedCell,"colspan",cell.colspan(),1),setIfNot(clonedCell,"rowspan",cell.rowspan(),1),$_6qqu1alnjh8lz1hg.append(tr,clonedCell)}),tr});return rows},$_2lx51jn6jh8lz1sw={render:render,copy:copy$2},repeat=function(repititions,f){for(var r=[],i=0;i<repititions;i++)r.push(f(i));return r},range$1=function(start,end){for(var r=[],i=start;i<end;i++)r.push(i);return r},unique=function(xs,comparator){var result=[];return $_6b0spykcjh8lz1ao.each(xs,function(x,i){i<xs.length-1&&!comparator(x,xs[i+1])?result.push(x):i===xs.length-1&&result.push(x)}),result},deduce=function(xs,index){if(index<0||index>=xs.length-1)return Option.none();var current=xs[index].fold(function(){var rest=$_6b0spykcjh8lz1ao.reverse(xs.slice(0,index));return $_clgylhn2jh8lz1sg.findMap(rest,function(a,i){return a.map(function(aa){return{value:aa,delta:i+1}})})},function(c){return Option.some({value:c,delta:0})}),next=xs[index+1].fold(function(){var rest=xs.slice(index+1);return $_clgylhn2jh8lz1sg.findMap(rest,function(a,i){return a.map(function(aa){return{value:aa,delta:i+1}})})},function(n){return Option.some({value:n,delta:1})});return current.bind(function(c){return next.map(function(n){var extras=n.delta+c.delta;return Math.abs(n.value-c.value)/extras})})},$_3fj5mdn9jh8lz1uf={repeat:repeat,range:range$1,unique:unique,deduce:deduce},columns=function(warehouse){var grid=warehouse.grid(),cols=$_3fj5mdn9jh8lz1uf.range(0,grid.columns()),rows=$_3fj5mdn9jh8lz1uf.range(0,grid.rows());return $_6b0spykcjh8lz1ao.map(cols,function(col){var getBlock=function(){return $_6b0spykcjh8lz1ao.bind(rows,function(r){return $_fxwupplkjh8lz1go.getAt(warehouse,r,col).filter(function(detail){return detail.column()===col}).fold($_bgyjg9kejh8lz1ax.constant([]),function(detail){return[detail]})})},isSingle=function(detail){return 1===detail.colspan()},getFallback=function(){return $_fxwupplkjh8lz1go.getAt(warehouse,0,col)};return decide(getBlock,isSingle,getFallback)})},decide=function(getBlock,isSingle,getFallback){var inBlock=getBlock(),singleInBlock=$_6b0spykcjh8lz1ao.find(inBlock,isSingle),detailOption=singleInBlock.orThunk(function(){return Option.from(inBlock[0]).orThunk(getFallback)});return detailOption.map(function(detail){return detail.element()})},rows$1=function(warehouse){var grid=warehouse.grid(),rows=$_3fj5mdn9jh8lz1uf.range(0,grid.rows()),cols=$_3fj5mdn9jh8lz1uf.range(0,grid.columns());return $_6b0spykcjh8lz1ao.map(rows,function(row){var getBlock=function(){return $_6b0spykcjh8lz1ao.bind(cols,function(c){return $_fxwupplkjh8lz1go.getAt(warehouse,row,c).filter(function(detail){return detail.row()===row}).fold($_bgyjg9kejh8lz1ax.constant([]),function(detail){return[detail]})})},isSingle=function(detail){return 1===detail.rowspan()},getFallback=function(){return $_fxwupplkjh8lz1go.getAt(warehouse,row,0)};return decide(getBlock,isSingle,getFallback)})},$_fdxhann8jh8lz1u7={columns:columns,rows:rows$1},col=function(column,x,y,w,h){var blocker=$_6vo9a4krjh8lz1do.fromTag("div");return $_3ory84lljh8lz1gx.setAll(blocker,{position:"absolute",left:x-w/2+"px",top:y+"px",height:h+"px",width:w+"px"}),$_1mp8lglcjh8lz1fq.setAll(blocker,{"data-column":column,role:"presentation"}),blocker},row$1=function(row,x,y,w,h){var blocker=$_6vo9a4krjh8lz1do.fromTag("div");return $_3ory84lljh8lz1gx.setAll(blocker,{position:"absolute",left:x+"px",top:y-h/2+"px",height:h+"px",width:w+"px"}),$_1mp8lglcjh8lz1fq.setAll(blocker,{"data-row":row,role:"presentation"}),blocker},$_eplkaenajh8lz1un={col:col,row:row$1},css=function(namespace){var dashNamespace=namespace.replace(/\./g,"-"),resolve=function(str){return dashNamespace+"-"+str};return{resolve:resolve}},$_2i90e7ncjh8lz1ux={css:css},styles=$_2i90e7ncjh8lz1ux.css("ephox-snooker"),$_ezk1iinbjh8lz1uu={resolve:styles.resolve},read=function(element,attr){var value=$_1mp8lglcjh8lz1fq.get(element,attr);return void 0===value||""===value?[]:value.split(" ")},add=function(element,attr,id){var old=read(element,attr),nu=old.concat([id]);$_1mp8lglcjh8lz1fq.set(element,attr,nu.join(" "))},remove$3=function(element,attr,id){var nu=$_6b0spykcjh8lz1ao.filter(read(element,attr),function(v){return v!==id});nu.length>0?$_1mp8lglcjh8lz1fq.set(element,attr,nu.join(" ")):$_1mp8lglcjh8lz1fq.remove(element,attr)},$_92tat7ngjh8lz1v8={read:read,add:add,remove:remove$3},supports=function(element){return void 0!==element.dom().classList},get$6=function(element){return $_92tat7ngjh8lz1v8.read(element,"class")},add$1=function(element,clazz){return $_92tat7ngjh8lz1v8.add(element,"class",clazz)},remove$4=function(element,clazz){return $_92tat7ngjh8lz1v8.remove(element,"class",clazz)},toggle=function(element,clazz){$_6b0spykcjh8lz1ao.contains(get$6(element),clazz)?remove$4(element,clazz):add$1(element,clazz)},$_7oeslpnfjh8lz1v2={get:get$6,add:add$1,remove:remove$4,toggle:toggle,supports:supports},add$2=function(element,clazz){$_7oeslpnfjh8lz1v2.supports(element)?element.dom().classList.add(clazz):$_7oeslpnfjh8lz1v2.add(element,clazz)},cleanClass=function(element){var classList=$_7oeslpnfjh8lz1v2.supports(element)?element.dom().classList:$_7oeslpnfjh8lz1v2.get(element);0===classList.length&&$_1mp8lglcjh8lz1fq.remove(element,"class")},remove$5=function(element,clazz){if($_7oeslpnfjh8lz1v2.supports(element)){var classList=element.dom().classList;classList.remove(clazz)}else $_7oeslpnfjh8lz1v2.remove(element,clazz);cleanClass(element)},toggle$1=function(element,clazz){return $_7oeslpnfjh8lz1v2.supports(element)?element.dom().classList.toggle(clazz):$_7oeslpnfjh8lz1v2.toggle(element,clazz)},toggler=function(element,clazz){var hasClasslist=$_7oeslpnfjh8lz1v2.supports(element),classList=element.dom().classList,off=function(){hasClasslist?classList.remove(clazz):$_7oeslpnfjh8lz1v2.remove(element,clazz)},on=function(){hasClasslist?classList.add(clazz):$_7oeslpnfjh8lz1v2.add(element,clazz)};return Toggler(off,on,has$1(element,clazz))},has$1=function(element,clazz){return $_7oeslpnfjh8lz1v2.supports(element)&&element.dom().classList.contains(clazz)},$_evf7iendjh8lz1uz={add:add$2,remove:remove$5,toggle:toggle$1,toggler:toggler,has:has$1},resizeBar=$_ezk1iinbjh8lz1uu.resolve("resizer-bar"),resizeRowBar=$_ezk1iinbjh8lz1uu.resolve("resizer-rows"),resizeColBar=$_ezk1iinbjh8lz1uu.resolve("resizer-cols"),BAR_THICKNESS=7,clear=function(wire){var previous=$_coxlualejh8lz1fz.descendants(wire.parent(),"."+resizeBar);$_6b0spykcjh8lz1ao.each(previous,$_f2hny0lojh8lz1hi.remove)},drawBar=function(wire,positions,create){var origin=wire.origin();$_6b0spykcjh8lz1ao.each(positions,function(cpOption,i){cpOption.each(function(cp){var bar=create(origin,cp);$_evf7iendjh8lz1uz.add(bar,resizeBar),$_6qqu1alnjh8lz1hg.append(wire.parent(),bar)})})},refreshCol=function(wire,colPositions,position,tableHeight){drawBar(wire,colPositions,function(origin,cp){var colBar=$_eplkaenajh8lz1un.col(cp.col(),cp.x()-origin.left(),position.top()-origin.top(),BAR_THICKNESS,tableHeight);return $_evf7iendjh8lz1uz.add(colBar,resizeColBar),colBar})},refreshRow=function(wire,rowPositions,position,tableWidth){drawBar(wire,rowPositions,function(origin,cp){var rowBar=$_eplkaenajh8lz1un.row(cp.row(),position.left()-origin.left(),cp.y()-origin.top(),tableWidth,BAR_THICKNESS);return $_evf7iendjh8lz1uz.add(rowBar,resizeRowBar),rowBar})},refreshGrid=function(wire,table,rows,cols,hdirection,vdirection){var position=$_6xc5idmpjh8lz1ph.absolute(table),rowPositions=rows.length>0?hdirection.positions(rows,table):[];refreshRow(wire,rowPositions,position,$_fu3j58mljh8lz1oz.getOuter(table));var colPositions=cols.length>0?vdirection.positions(cols,table):[];refreshCol(wire,colPositions,position,$_dc45zsmjjh8lz1or.getOuter(table))},refresh=function(wire,table,hdirection,vdirection){clear(wire);var list=$_ff1h20kmjh8lz1c3.fromTable(table),warehouse=$_fxwupplkjh8lz1go.generate(list),rows=$_fdxhann8jh8lz1u7.rows(warehouse),cols=$_fdxhann8jh8lz1u7.columns(warehouse);refreshGrid(wire,table,rows,cols,hdirection,vdirection)},each$2=function(wire,f){var bars=$_coxlualejh8lz1fz.descendants(wire.parent(),"."+resizeBar);$_6b0spykcjh8lz1ao.each(bars,f)},hide=function(wire){each$2(wire,function(bar){$_3ory84lljh8lz1gx.set(bar,"display","none")})},show=function(wire){each$2(wire,function(bar){$_3ory84lljh8lz1gx.set(bar,"display","block")})},isRowBar=function(element){return $_evf7iendjh8lz1uz.has(element,resizeRowBar)},isColBar=function(element){return $_evf7iendjh8lz1uz.has(element,resizeColBar)},$_b9z1gin7jh8lz1tj={refresh:refresh,hide:hide,show:show,destroy:clear,isRowBar:isRowBar,isColBar:isColBar},fromWarehouse=function(warehouse,generators){return $_7a3bzon3jh8lz1si.toGrid(warehouse,generators,!1)},deriveRows=function(rendered,generators){var findRow=function(details){var rowOfCells=$_clgylhn2jh8lz1sg.findMap(details,function(detail){return $_4hc7u2ktjh8lz1dv.parent(detail.element()).map(function(row){var isNew=$_4hc7u2ktjh8lz1dv.parent(row).isNone();return $_g424vknjh8lz1cd.elementnew(row,isNew)})});return rowOfCells.getOrThunk(function(){return $_g424vknjh8lz1cd.elementnew(generators.row(),!0)})};return $_6b0spykcjh8lz1ao.map(rendered,function(details){var row=findRow(details.details());return $_g424vknjh8lz1cd.rowdatanew(row.element(),details.details(),details.section(),row.isNew())})},toDetailList=function(grid,generators){var rendered=$_7a3bzon3jh8lz1si.toDetails(grid,$_2eywnlkvjh8lz1e8.eq);return deriveRows(rendered,generators)},findInWarehouse=function(warehouse,element){var all=$_6b0spykcjh8lz1ao.flatten($_6b0spykcjh8lz1ao.map(warehouse.all(),function(r){return r.cells()}));return $_6b0spykcjh8lz1ao.find(all,function(e){return $_2eywnlkvjh8lz1e8.eq(element,e.element())})},run=function(operation,extract,adjustment,postAction,genWrappers){return function(wire,table,target,generators,direction){var input=$_ff1h20kmjh8lz1c3.fromTable(table),warehouse=$_fxwupplkjh8lz1go.generate(input),output=extract(warehouse,target).map(function(info){var model=fromWarehouse(warehouse,generators),result=operation(model,info,$_2eywnlkvjh8lz1e8.eq,genWrappers(generators)),grid=toDetailList(result.grid(),generators);return{grid:$_bgyjg9kejh8lz1ax.constant(grid),cursor:result.cursor}});return output.fold(function(){return Option.none()},function(out){var newElements=$_2lx51jn6jh8lz1sw.render(table,out.grid());return adjustment(table,out.grid(),direction),postAction(table),$_b9z1gin7jh8lz1tj.refresh(wire,table,$_sdnutmojh8lz1p3.height,direction),Option.some({cursor:out.cursor,newRows:newElements.newRows,newCells:newElements.newCells})})}},onCell=function(warehouse,target){return $_ee8pmfkojh8lz1ch.cell(target.element()).bind(function(cell){return findInWarehouse(warehouse,cell)})},onPaste=function(warehouse,target){return $_ee8pmfkojh8lz1ch.cell(target.element()).bind(function(cell){return findInWarehouse(warehouse,cell).map(function(details){return $_b4x7eon1jh8lz1se.merge(details,{generators:target.generators,clipboard:target.clipboard})})})},onPasteRows=function(warehouse,target){var details=$_6b0spykcjh8lz1ao.map(target.selection(),function(cell){return $_ee8pmfkojh8lz1ch.cell(cell).bind(function(lc){return findInWarehouse(warehouse,lc)})}),cells=$_clgylhn2jh8lz1sg.cat(details);return cells.length>0?Option.some($_b4x7eon1jh8lz1se.merge({cells:cells},{generators:target.generators,clipboard:target.clipboard})):Option.none()},onMergable=function(warehouse,target){return target.mergable()},onUnmergable=function(warehouse,target){return target.unmergable()},onCells=function(warehouse,target){var details=$_6b0spykcjh8lz1ao.map(target.selection(),function(cell){return $_ee8pmfkojh8lz1ch.cell(cell).bind(function(lc){return findInWarehouse(warehouse,lc)})}),cells=$_clgylhn2jh8lz1sg.cat(details);return cells.length>0?Option.some(cells):Option.none()},$_1na6n8n0jh8lz1rt={run:run,toDetailList:toDetailList,onCell:onCell,onCells:onCells,onPaste:onPaste,onPasteRows:onPasteRows,onMergable:onMergable,onUnmergable:onUnmergable},value$1=function(o){var is=function(v){return o===v},or=function(opt){return value$1(o)},orThunk=function(f){return value$1(o)},map=function(f){return value$1(f(o))},each=function(f){f(o)},bind=function(f){return f(o)},fold=function(_,onValue){return onValue(o)},exists=function(f){return f(o)},forall=function(f){return f(o)},toOption=function(){return Option.some(o)};return{is:is,isValue:$_bgyjg9kejh8lz1ax.always,isError:$_bgyjg9kejh8lz1ax.never,getOr:$_bgyjg9kejh8lz1ax.constant(o),getOrThunk:$_bgyjg9kejh8lz1ax.constant(o),getOrDie:$_bgyjg9kejh8lz1ax.constant(o),or:or,orThunk:orThunk,fold:fold,map:map,each:each,bind:bind,exists:exists,forall:forall,toOption:toOption}},error=function(message){var getOrThunk=function(f){return f()},getOrDie=function(){return $_bgyjg9kejh8lz1ax.die(String(message))()},or=function(opt){return opt},orThunk=function(f){return f()},map=function(f){return error(message)},bind=function(f){return error(message)},fold=function(onError,_){return onError(message)};return{is:$_bgyjg9kejh8lz1ax.never,isValue:$_bgyjg9kejh8lz1ax.never,isError:$_bgyjg9kejh8lz1ax.always,getOr:$_bgyjg9kejh8lz1ax.identity,getOrThunk:getOrThunk,getOrDie:getOrDie,or:or,orThunk:orThunk,fold:fold,map:map,each:$_bgyjg9kejh8lz1ax.noop,bind:bind,exists:$_bgyjg9kejh8lz1ax.never,forall:$_bgyjg9kejh8lz1ax.always,toOption:Option.none}},Result={value:value$1,error:error},measure=function(startAddress,gridA,gridB){if(startAddress.row()>=gridA.length||startAddress.column()>$_cndk32n5jh8lz1ss.cellLength(gridA[0]))return Result.error("invalid start address out of table bounds, row: "+startAddress.row()+", column: "+startAddress.column());var rowRemainder=gridA.slice(startAddress.row()),colRemainder=rowRemainder[0].cells().slice(startAddress.column()),colRequired=$_cndk32n5jh8lz1ss.cellLength(gridB[0]),rowRequired=gridB.length;return Result.value({rowDelta:$_bgyjg9kejh8lz1ax.constant(rowRemainder.length-rowRequired),colDelta:$_bgyjg9kejh8lz1ax.constant(colRemainder.length-colRequired)})},measureWidth=function(gridA,gridB){var colLengthA=$_cndk32n5jh8lz1ss.cellLength(gridA[0]),colLengthB=$_cndk32n5jh8lz1ss.cellLength(gridB[0]);return{rowDelta:$_bgyjg9kejh8lz1ax.constant(0),colDelta:$_bgyjg9kejh8lz1ax.constant(colLengthA-colLengthB)}},fill=function(cells,generator){return $_6b0spykcjh8lz1ao.map(cells,function(){return $_g424vknjh8lz1cd.elementnew(generator.cell(),!0)})},rowFill=function(grid,amount,generator){return grid.concat($_3fj5mdn9jh8lz1uf.repeat(amount,function(_row){return $_cndk32n5jh8lz1ss.setCells(grid[grid.length-1],fill(grid[grid.length-1].cells(),generator))}))},colFill=function(grid,amount,generator){return $_6b0spykcjh8lz1ao.map(grid,function(row){return $_cndk32n5jh8lz1ss.setCells(row,row.cells().concat(fill($_3fj5mdn9jh8lz1uf.range(0,amount),generator)))})},tailor=function(gridA,delta,generator){var fillCols=delta.colDelta()<0?colFill:$_bgyjg9kejh8lz1ax.identity,fillRows=delta.rowDelta()<0?rowFill:$_bgyjg9kejh8lz1ax.identity,modifiedCols=fillCols(gridA,Math.abs(delta.colDelta()),generator),tailoredGrid=fillRows(modifiedCols,Math.abs(delta.rowDelta()),generator);return tailoredGrid},$_d3iwlknijh8lz1vi={measure:measure,measureWidth:measureWidth,tailor:tailor},merge$2=function(grid,bounds,comparator,substitution){if(0===grid.length)return grid;for(var i=bounds.startRow();i<=bounds.finishRow();i++)for(var j=bounds.startCol();j<=bounds.finishCol();j++)$_cndk32n5jh8lz1ss.mutateCell(grid[i],j,$_g424vknjh8lz1cd.elementnew(substitution(),!1));return grid},unmerge=function(grid,target,comparator,substitution){for(var first=!0,i=0;i<grid.length;i++)for(var j=0;j<$_cndk32n5jh8lz1ss.cellLength(grid[0]);j++){var current=$_cndk32n5jh8lz1ss.getCellElement(grid[i],j),isToReplace=comparator(current,target);isToReplace===!0&&first===!1?$_cndk32n5jh8lz1ss.mutateCell(grid[i],j,$_g424vknjh8lz1cd.elementnew(substitution(),!0)):isToReplace===!0&&(first=!1)}return grid},uniqueCells=function(row,comparator){return $_6b0spykcjh8lz1ao.foldl(row,function(rest,cell){return $_6b0spykcjh8lz1ao.exists(rest,function(currentCell){return comparator(currentCell.element(),cell.element())})?rest:rest.concat([cell])},[])},splitRows=function(grid,index,comparator,substitution){if(index>0&&index<grid.length){var rowPrevCells=grid[index-1].cells(),cells=uniqueCells(rowPrevCells,comparator);$_6b0spykcjh8lz1ao.each(cells,function(cell){for(var replacement=Option.none(),i=index;i<grid.length;i++)for(var j=0;j<$_cndk32n5jh8lz1ss.cellLength(grid[0]);j++){var current=grid[i].cells()[j],isToReplace=comparator(current.element(),cell.element());isToReplace&&(replacement.isNone()&&(replacement=Option.some(substitution())),replacement.each(function(sub){$_cndk32n5jh8lz1ss.mutateCell(grid[i],j,$_g424vknjh8lz1cd.elementnew(sub,!0))}))}})}return grid},$_6f3hexnkjh8lz1w0={merge:merge$2,unmerge:unmerge,splitRows:splitRows},isSpanning=function(grid,row,col,comparator){var candidate=$_cndk32n5jh8lz1ss.getCell(grid[row],col),matching=$_bgyjg9kejh8lz1ax.curry(comparator,candidate.element()),currentRow=grid[row];return grid.length>1&&$_cndk32n5jh8lz1ss.cellLength(currentRow)>1&&(col>0&&matching($_cndk32n5jh8lz1ss.getCellElement(currentRow,col-1))||col<currentRow.length-1&&matching($_cndk32n5jh8lz1ss.getCellElement(currentRow,col+1))||row>0&&matching($_cndk32n5jh8lz1ss.getCellElement(grid[row-1],col))||row<grid.length-1&&matching($_cndk32n5jh8lz1ss.getCellElement(grid[row+1],col)))},mergeTables=function(startAddress,gridA,gridB,generator,comparator){for(var startRow=startAddress.row(),startCol=startAddress.column(),mergeHeight=gridB.length,mergeWidth=$_cndk32n5jh8lz1ss.cellLength(gridB[0]),endRow=startRow+mergeHeight,endCol=startCol+mergeWidth,r=startRow;r<endRow;r++)for(var c=startCol;c<endCol;c++){isSpanning(gridA,r,c,comparator)&&$_6f3hexnkjh8lz1w0.unmerge(gridA,$_cndk32n5jh8lz1ss.getCellElement(gridA[r],c),comparator,generator.cell);var newCell=$_cndk32n5jh8lz1ss.getCellElement(gridB[r-startRow],c-startCol),replacement=generator.replace(newCell);$_cndk32n5jh8lz1ss.mutateCell(gridA[r],c,$_g424vknjh8lz1cd.elementnew(replacement,!0))}return gridA},merge$3=function(startAddress,gridA,gridB,generator,comparator){var result=$_d3iwlknijh8lz1vi.measure(startAddress,gridA,gridB);return result.map(function(delta){var fittedGrid=$_d3iwlknijh8lz1vi.tailor(gridA,delta,generator);return mergeTables(startAddress,fittedGrid,gridB,generator,comparator)})},insert=function(index,gridA,gridB,generator,comparator){$_6f3hexnkjh8lz1w0.splitRows(gridA,index,comparator,generator.cell);var delta=$_d3iwlknijh8lz1vi.measureWidth(gridB,gridA),fittedNewGrid=$_d3iwlknijh8lz1vi.tailor(gridB,delta,generator),secondDelta=$_d3iwlknijh8lz1vi.measureWidth(gridA,fittedNewGrid),fittedOldGrid=$_d3iwlknijh8lz1vi.tailor(gridA,secondDelta,generator);return fittedOldGrid.slice(0,index).concat(fittedNewGrid).concat(fittedOldGrid.slice(index,fittedOldGrid.length))},$_bq9moknhjh8lz1vd={merge:merge$3,insert:insert},insertRowAt=function(grid,index,example,comparator,substitution){var before=grid.slice(0,index),after=grid.slice(index),between=$_cndk32n5jh8lz1ss.mapCells(grid[example],function(ex,c){var withinSpan=index>0&&index<grid.length&&comparator($_cndk32n5jh8lz1ss.getCellElement(grid[index-1],c),$_cndk32n5jh8lz1ss.getCellElement(grid[index],c)),ret=withinSpan?$_cndk32n5jh8lz1ss.getCell(grid[index],c):$_g424vknjh8lz1cd.elementnew(substitution(ex.element(),comparator),!0);return ret});return before.concat([between]).concat(after)},insertColumnAt=function(grid,index,example,comparator,substitution){return $_6b0spykcjh8lz1ao.map(grid,function(row){var withinSpan=index>0&&index<$_cndk32n5jh8lz1ss.cellLength(row)&&comparator($_cndk32n5jh8lz1ss.getCellElement(row,index-1),$_cndk32n5jh8lz1ss.getCellElement(row,index)),sub=withinSpan?$_cndk32n5jh8lz1ss.getCell(row,index):$_g424vknjh8lz1cd.elementnew(substitution($_cndk32n5jh8lz1ss.getCellElement(row,example),comparator),!0);return $_cndk32n5jh8lz1ss.addCell(row,index,sub)})},splitCellIntoColumns=function(grid,exampleRow,exampleCol,comparator,substitution){var index=exampleCol+1;return $_6b0spykcjh8lz1ao.map(grid,function(row,i){var isTargetCell=i===exampleRow,sub=isTargetCell?$_g424vknjh8lz1cd.elementnew(substitution($_cndk32n5jh8lz1ss.getCellElement(row,exampleCol),comparator),!0):$_cndk32n5jh8lz1ss.getCell(row,exampleCol);return $_cndk32n5jh8lz1ss.addCell(row,index,sub)})},splitCellIntoRows=function(grid,exampleRow,exampleCol,comparator,substitution){var index=exampleRow+1,before=grid.slice(0,index),after=grid.slice(index),between=$_cndk32n5jh8lz1ss.mapCells(grid[exampleRow],function(ex,i){var isTargetCell=i===exampleCol;return isTargetCell?$_g424vknjh8lz1cd.elementnew(substitution(ex.element(),comparator),!0):ex});return before.concat([between]).concat(after)},deleteColumnsAt=function(grid,start,finish){var rows=$_6b0spykcjh8lz1ao.map(grid,function(row){var cells=row.cells().slice(0,start).concat(row.cells().slice(finish+1));return $_g424vknjh8lz1cd.rowcells(cells,row.section())});return $_6b0spykcjh8lz1ao.filter(rows,function(row){return row.cells().length>0})},deleteRowsAt=function(grid,start,finish){return grid.slice(0,start).concat(grid.slice(finish+1))},$_gaga3fnljh8lz1w7={insertRowAt:insertRowAt,insertColumnAt:insertColumnAt,splitCellIntoColumns:splitCellIntoColumns,splitCellIntoRows:splitCellIntoRows,deleteRowsAt:deleteRowsAt,deleteColumnsAt:deleteColumnsAt},replaceIn=function(grid,targets,comparator,substitution){var isTarget=function(cell){return $_6b0spykcjh8lz1ao.exists(targets,function(target){return comparator(cell.element(),target.element())})};return $_6b0spykcjh8lz1ao.map(grid,function(row){return $_cndk32n5jh8lz1ss.mapCells(row,function(cell){return isTarget(cell)?$_g424vknjh8lz1cd.elementnew(substitution(cell.element(),comparator),!0):cell})})},notStartRow=function(grid,rowIndex,colIndex,comparator){return void 0!==$_cndk32n5jh8lz1ss.getCellElement(grid[rowIndex],colIndex)&&rowIndex>0&&comparator($_cndk32n5jh8lz1ss.getCellElement(grid[rowIndex-1],colIndex),$_cndk32n5jh8lz1ss.getCellElement(grid[rowIndex],colIndex))},notStartColumn=function(row,index,comparator){return index>0&&comparator($_cndk32n5jh8lz1ss.getCellElement(row,index-1),$_cndk32n5jh8lz1ss.getCellElement(row,index))},replaceColumn=function(grid,index,comparator,substitution){var targets=$_6b0spykcjh8lz1ao.bind(grid,function(row,i){var alreadyAdded=notStartRow(grid,i,index,comparator)||notStartColumn(row,index,comparator);return alreadyAdded?[]:[$_cndk32n5jh8lz1ss.getCell(row,index)]});return replaceIn(grid,targets,comparator,substitution)},replaceRow=function(grid,index,comparator,substitution){var targetRow=grid[index],targets=$_6b0spykcjh8lz1ao.bind(targetRow.cells(),function(item,i){var alreadyAdded=notStartRow(grid,index,i,comparator)||notStartColumn(targetRow,i,comparator);return alreadyAdded?[]:[item]});return replaceIn(grid,targets,comparator,substitution)},$_di6efunmjh8lz1wc={replaceColumn:replaceColumn,replaceRow:replaceRow},none$1=function(){return folder(function(n,o,l,m,r){return n()})},only=function(index){return folder(function(n,o,l,m,r){return o(index)})},left=function(index,next){return folder(function(n,o,l,m,r){return l(index,next)})},middle=function(prev,index,next){return folder(function(n,o,l,m,r){return m(prev,index,next)})},right=function(prev,index){return folder(function(n,o,l,m,r){return r(prev,index)})},folder=function(fold){return{fold:fold}},$_6yfc1snpjh8lz1wv={none:none$1,only:only,left:left,middle:middle,right:right},neighbours$1=function(input,index){return 0===input.length?$_6yfc1snpjh8lz1wv.none():1===input.length?$_6yfc1snpjh8lz1wv.only(0):0===index?$_6yfc1snpjh8lz1wv.left(0,1):index===input.length-1?$_6yfc1snpjh8lz1wv.right(index-1,index):index>0&&index<input.length-1?$_6yfc1snpjh8lz1wv.middle(index-1,index,index+1):$_6yfc1snpjh8lz1wv.none()},determine=function(input,column,step,tableSize){var result=input.slice(0),context=neighbours$1(input,column),zero=function(array){return $_6b0spykcjh8lz1ao.map(array,$_bgyjg9kejh8lz1ax.constant(0))},onNone=$_bgyjg9kejh8lz1ax.constant(zero(result)),onOnly=function(index){return tableSize.singleColumnWidth(result[index],step)},onChange=function(index,next){if(step>=0){var newNext=Math.max(tableSize.minCellWidth(),result[next]-step);return zero(result.slice(0,index)).concat([step,newNext-result[next]]).concat(zero(result.slice(next+1)))}var newThis=Math.max(tableSize.minCellWidth(),result[index]+step),diffx=result[index]-newThis;return zero(result.slice(0,index)).concat([newThis-result[index],diffx]).concat(zero(result.slice(next+1)))},onLeft=onChange,onMiddle=function(prev,index,next){return onChange(index,next)},onRight=function(prev,index){if(step>=0)return zero(result.slice(0,index)).concat([step]);var size=Math.max(tableSize.minCellWidth(),result[index]+step);return zero(result.slice(0,index)).concat([size-result[index]])};return context.fold(onNone,onOnly,onLeft,onMiddle,onRight)},$_8l7lnenojh8lz1wp={determine:determine},getSpan$1=function(cell,type){return $_1mp8lglcjh8lz1fq.has(cell,type)&&parseInt($_1mp8lglcjh8lz1fq.get(cell,type),10)>1},hasColspan=function(cell){return getSpan$1(cell,"colspan")},hasRowspan=function(cell){return getSpan$1(cell,"rowspan")},getInt=function(element,property){return parseInt($_3ory84lljh8lz1gx.get(element,property),10)},$_agh84xnrjh8lz1x6={hasColspan:hasColspan,hasRowspan:hasRowspan,minWidth:$_bgyjg9kejh8lz1ax.constant(10),minHeight:$_bgyjg9kejh8lz1ax.constant(10),getInt:getInt},getRaw$1=function(cell,property,getter){return $_3ory84lljh8lz1gx.getRaw(cell,property).fold(function(){return getter(cell)+"px"},function(raw){return raw})},getRawW=function(cell){return getRaw$1(cell,"width",$_i2xtsmhjh8lz1nv.getPixelWidth)},getRawH=function(cell){return getRaw$1(cell,"height",$_i2xtsmhjh8lz1nv.getHeight)},getWidthFrom=function(warehouse,direction,getWidth,fallback,tableSize){var columns=$_fdxhann8jh8lz1u7.columns(warehouse),backups=$_6b0spykcjh8lz1ao.map(columns,function(cellOption){return cellOption.map(direction.edge)});return $_6b0spykcjh8lz1ao.map(columns,function(cellOption,c){var columnCell=cellOption.filter($_bgyjg9kejh8lz1ax.not($_agh84xnrjh8lz1x6.hasColspan));
return columnCell.fold(function(){var deduced=$_3fj5mdn9jh8lz1uf.deduce(backups,c);return fallback(deduced)},function(cell){return getWidth(cell,tableSize)})})},getDeduced=function(deduced){return deduced.map(function(d){return d+"px"}).getOr("")},getRawWidths=function(warehouse,direction){return getWidthFrom(warehouse,direction,getRawW,getDeduced)},getPercentageWidths=function(warehouse,direction,tableSize){return getWidthFrom(warehouse,direction,$_i2xtsmhjh8lz1nv.getPercentageWidth,function(deduced){return deduced.fold(function(){return tableSize.minCellWidth()},function(cellWidth){return cellWidth/tableSize.pixelWidth()*100})},tableSize)},getPixelWidths=function(warehouse,direction,tableSize){return getWidthFrom(warehouse,direction,$_i2xtsmhjh8lz1nv.getPixelWidth,function(deduced){return deduced.getOrThunk(tableSize.minCellWidth)},tableSize)},getHeightFrom=function(warehouse,direction,getHeight,fallback){var rows=$_fdxhann8jh8lz1u7.rows(warehouse),backups=$_6b0spykcjh8lz1ao.map(rows,function(cellOption){return cellOption.map(direction.edge)});return $_6b0spykcjh8lz1ao.map(rows,function(cellOption,c){var rowCell=cellOption.filter($_bgyjg9kejh8lz1ax.not($_agh84xnrjh8lz1x6.hasRowspan));return rowCell.fold(function(){var deduced=$_3fj5mdn9jh8lz1uf.deduce(backups,c);return fallback(deduced)},function(cell){return getHeight(cell)})})},getPixelHeights=function(warehouse,direction){return getHeightFrom(warehouse,direction,$_i2xtsmhjh8lz1nv.getHeight,function(deduced){return deduced.getOrThunk($_agh84xnrjh8lz1x6.minHeight)})},getRawHeights=function(warehouse,direction){return getHeightFrom(warehouse,direction,getRawH,getDeduced)},$_8h6liinqjh8lz1wx={getRawWidths:getRawWidths,getPixelWidths:getPixelWidths,getPercentageWidths:getPercentageWidths,getPixelHeights:getPixelHeights,getRawHeights:getRawHeights},total=function(start,end,measures){for(var r=0,i=start;i<end;i++)r+=void 0!==measures[i]?measures[i]:0;return r},recalculateWidth=function(warehouse,widths){var all=$_fxwupplkjh8lz1go.justCells(warehouse);return $_6b0spykcjh8lz1ao.map(all,function(cell){var width=total(cell.column(),cell.column()+cell.colspan(),widths);return{element:cell.element,width:$_bgyjg9kejh8lz1ax.constant(width),colspan:cell.colspan}})},recalculateHeight=function(warehouse,heights){var all=$_fxwupplkjh8lz1go.justCells(warehouse);return $_6b0spykcjh8lz1ao.map(all,function(cell){var height=total(cell.row(),cell.row()+cell.rowspan(),heights);return{element:cell.element,height:$_bgyjg9kejh8lz1ax.constant(height),rowspan:cell.rowspan}})},matchRowHeight=function(warehouse,heights){return $_6b0spykcjh8lz1ao.map(warehouse.all(),function(row,i){return{element:row.element,height:$_bgyjg9kejh8lz1ax.constant(heights[i])}})},$_df6hx0nsjh8lz1xd={recalculateWidth:recalculateWidth,recalculateHeight:recalculateHeight,matchRowHeight:matchRowHeight},percentageSize=function(width,element){var floatWidth=parseFloat(width),pixelWidth=$_fu3j58mljh8lz1oz.get(element),getCellDelta=function(delta){return delta/pixelWidth*100},singleColumnWidth=function(width,_delta){return[100-width]},minCellWidth=function(){return $_agh84xnrjh8lz1x6.minWidth()/pixelWidth*100},setTableWidth=function(table,_newWidths,delta){var total=floatWidth+delta;$_i2xtsmhjh8lz1nv.setPercentageWidth(table,total)};return{width:$_bgyjg9kejh8lz1ax.constant(floatWidth),pixelWidth:$_bgyjg9kejh8lz1ax.constant(pixelWidth),getWidths:$_8h6liinqjh8lz1wx.getPercentageWidths,getCellDelta:getCellDelta,singleColumnWidth:singleColumnWidth,minCellWidth:minCellWidth,setElementWidth:$_i2xtsmhjh8lz1nv.setPercentageWidth,setTableWidth:setTableWidth}},pixelSize=function(width){var intWidth=parseInt(width,10),getCellDelta=$_bgyjg9kejh8lz1ax.identity,singleColumnWidth=function(width,delta){var newNext=Math.max($_agh84xnrjh8lz1x6.minWidth(),width+delta);return[newNext-width]},setTableWidth=function(table,newWidths,_delta){var total=$_6b0spykcjh8lz1ao.foldr(newWidths,function(b,a){return b+a},0);$_i2xtsmhjh8lz1nv.setPixelWidth(table,total)};return{width:$_bgyjg9kejh8lz1ax.constant(intWidth),pixelWidth:$_bgyjg9kejh8lz1ax.constant(intWidth),getWidths:$_8h6liinqjh8lz1wx.getPixelWidths,getCellDelta:getCellDelta,singleColumnWidth:singleColumnWidth,minCellWidth:$_agh84xnrjh8lz1x6.minWidth,setElementWidth:$_i2xtsmhjh8lz1nv.setPixelWidth,setTableWidth:setTableWidth}},chooseSize=function(element,width){if($_i2xtsmhjh8lz1nv.percentageBasedSizeRegex().test(width)){var percentMatch=$_i2xtsmhjh8lz1nv.percentageBasedSizeRegex().exec(width);return percentageSize(percentMatch[1],element)}if($_i2xtsmhjh8lz1nv.pixelBasedSizeRegex().test(width)){var pixelMatch=$_i2xtsmhjh8lz1nv.pixelBasedSizeRegex().exec(width);return pixelSize(pixelMatch[1])}var fallbackWidth=$_fu3j58mljh8lz1oz.get(element);return pixelSize(fallbackWidth)},getTableSize=function(element){var width=$_i2xtsmhjh8lz1nv.getRawWidth(element);return width.fold(function(){var fallbackWidth=$_fu3j58mljh8lz1oz.get(element);return pixelSize(fallbackWidth)},function(width){return chooseSize(element,width)})},$_b9pgttntjh8lz1xk={getTableSize:getTableSize},getWarehouse$1=function(list){return $_fxwupplkjh8lz1go.generate(list)},sumUp=function(newSize){return $_6b0spykcjh8lz1ao.foldr(newSize,function(b,a){return b+a},0)},getTableWarehouse=function(table){var list=$_ff1h20kmjh8lz1c3.fromTable(table);return getWarehouse$1(list)},adjustWidth=function(table,delta,index,direction){var tableSize=$_b9pgttntjh8lz1xk.getTableSize(table),step=tableSize.getCellDelta(delta),warehouse=getTableWarehouse(table),widths=tableSize.getWidths(warehouse,direction,tableSize),deltas=$_8l7lnenojh8lz1wp.determine(widths,index,step,tableSize),newWidths=$_6b0spykcjh8lz1ao.map(deltas,function(dx,i){return dx+widths[i]}),newSizes=$_df6hx0nsjh8lz1xd.recalculateWidth(warehouse,newWidths);$_6b0spykcjh8lz1ao.each(newSizes,function(cell){tableSize.setElementWidth(cell.element(),cell.width())}),index===warehouse.grid().columns()-1&&tableSize.setTableWidth(table,newWidths,step)},adjustHeight=function(table,delta,index,direction){var warehouse=getTableWarehouse(table),heights=$_8h6liinqjh8lz1wx.getPixelHeights(warehouse,direction),newHeights=$_6b0spykcjh8lz1ao.map(heights,function(dy,i){return index===i?Math.max(delta+dy,$_agh84xnrjh8lz1x6.minHeight()):dy}),newCellSizes=$_df6hx0nsjh8lz1xd.recalculateHeight(warehouse,newHeights),newRowSizes=$_df6hx0nsjh8lz1xd.matchRowHeight(warehouse,newHeights);$_6b0spykcjh8lz1ao.each(newRowSizes,function(row){$_i2xtsmhjh8lz1nv.setHeight(row.element(),row.height())}),$_6b0spykcjh8lz1ao.each(newCellSizes,function(cell){$_i2xtsmhjh8lz1nv.setHeight(cell.element(),cell.height())});var total=sumUp(newHeights);$_i2xtsmhjh8lz1nv.setHeight(table,total)},adjustWidthTo=function(table,list,direction){var tableSize=$_b9pgttntjh8lz1xk.getTableSize(table),warehouse=getWarehouse$1(list),widths=tableSize.getWidths(warehouse,direction,tableSize),newSizes=$_df6hx0nsjh8lz1xd.recalculateWidth(warehouse,widths);$_6b0spykcjh8lz1ao.each(newSizes,function(cell){tableSize.setElementWidth(cell.element(),cell.width())});var total=$_6b0spykcjh8lz1ao.foldr(widths,function(b,a){return a+b},0);newSizes.length>0&&tableSize.setElementWidth(table,total)},$_7x5dznnjh8lz1wh={adjustWidth:adjustWidth,adjustHeight:adjustHeight,adjustWidthTo:adjustWidthTo},prune=function(table){var cells=$_ee8pmfkojh8lz1ch.cells(table);0===cells.length&&$_f2hny0lojh8lz1hi.remove(table)},outcome=$_d2ojjnkijh8lz1bv.immutable("grid","cursor"),elementFromGrid=function(grid,row,column){return findIn(grid,row,column).orThunk(function(){return findIn(grid,0,0)})},findIn=function(grid,row,column){return Option.from(grid[row]).bind(function(r){return Option.from(r.cells()[column]).bind(function(c){return Option.from(c.element())})})},bundle=function(grid,row,column){return outcome(grid,findIn(grid,row,column))},uniqueRows=function(details){return $_6b0spykcjh8lz1ao.foldl(details,function(rest,detail){return $_6b0spykcjh8lz1ao.exists(rest,function(currentDetail){return currentDetail.row()===detail.row()})?rest:rest.concat([detail])},[]).sort(function(detailA,detailB){return detailA.row()-detailB.row()})},uniqueColumns=function(details){return $_6b0spykcjh8lz1ao.foldl(details,function(rest,detail){return $_6b0spykcjh8lz1ao.exists(rest,function(currentDetail){return currentDetail.column()===detail.column()})?rest:rest.concat([detail])},[]).sort(function(detailA,detailB){return detailA.column()-detailB.column()})},insertRowBefore=function(grid,detail,comparator,genWrappers){var example=detail.row(),targetIndex=detail.row(),newGrid=$_gaga3fnljh8lz1w7.insertRowAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,targetIndex,detail.column())},insertRowsBefore=function(grid,details,comparator,genWrappers){var example=details[0].row(),targetIndex=details[0].row(),rows=uniqueRows(details),newGrid=$_6b0spykcjh8lz1ao.foldl(rows,function(newGrid,_row){return $_gaga3fnljh8lz1w7.insertRowAt(newGrid,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,targetIndex,details[0].column())},insertRowAfter=function(grid,detail,comparator,genWrappers){var example=detail.row(),targetIndex=detail.row()+detail.rowspan(),newGrid=$_gaga3fnljh8lz1w7.insertRowAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,targetIndex,detail.column())},insertRowsAfter=function(grid,details,comparator,genWrappers){var rows=uniqueRows(details),example=rows[rows.length-1].row(),targetIndex=rows[rows.length-1].row()+rows[rows.length-1].rowspan(),newGrid=$_6b0spykcjh8lz1ao.foldl(rows,function(newGrid,_row){return $_gaga3fnljh8lz1w7.insertRowAt(newGrid,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,targetIndex,details[0].column())},insertColumnBefore=function(grid,detail,comparator,genWrappers){var example=detail.column(),targetIndex=detail.column(),newGrid=$_gaga3fnljh8lz1w7.insertColumnAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),targetIndex)},insertColumnsBefore=function(grid,details,comparator,genWrappers){var columns=uniqueColumns(details),example=columns[0].column(),targetIndex=columns[0].column(),newGrid=$_6b0spykcjh8lz1ao.foldl(columns,function(newGrid,_row){return $_gaga3fnljh8lz1w7.insertColumnAt(newGrid,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,details[0].row(),targetIndex)},insertColumnAfter=function(grid,detail,comparator,genWrappers){var example=detail.column(),targetIndex=detail.column()+detail.colspan(),newGrid=$_gaga3fnljh8lz1w7.insertColumnAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),targetIndex)},insertColumnsAfter=function(grid,details,comparator,genWrappers){var example=details[details.length-1].column(),targetIndex=details[details.length-1].column()+details[details.length-1].colspan(),columns=uniqueColumns(details),newGrid=$_6b0spykcjh8lz1ao.foldl(columns,function(newGrid,_row){return $_gaga3fnljh8lz1w7.insertColumnAt(newGrid,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,details[0].row(),targetIndex)},makeRowHeader=function(grid,detail,comparator,genWrappers){var newGrid=$_di6efunmjh8lz1wc.replaceRow(grid,detail.row(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())},makeColumnHeader=function(grid,detail,comparator,genWrappers){var newGrid=$_di6efunmjh8lz1wc.replaceColumn(grid,detail.column(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())},unmakeRowHeader=function(grid,detail,comparator,genWrappers){var newGrid=$_di6efunmjh8lz1wc.replaceRow(grid,detail.row(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())},unmakeColumnHeader=function(grid,detail,comparator,genWrappers){var newGrid=$_di6efunmjh8lz1wc.replaceColumn(grid,detail.column(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())},splitCellIntoColumns$1=function(grid,detail,comparator,genWrappers){var newGrid=$_gaga3fnljh8lz1w7.splitCellIntoColumns(grid,detail.row(),detail.column(),comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),detail.column())},splitCellIntoRows$1=function(grid,detail,comparator,genWrappers){var newGrid=$_gaga3fnljh8lz1w7.splitCellIntoRows(grid,detail.row(),detail.column(),comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),detail.column())},eraseColumns=function(grid,details,comparator,_genWrappers){var columns=uniqueColumns(details),newGrid=$_gaga3fnljh8lz1w7.deleteColumnsAt(grid,columns[0].column(),columns[columns.length-1].column()),cursor=elementFromGrid(newGrid,details[0].row(),details[0].column());return outcome(newGrid,cursor)},eraseRows=function(grid,details,comparator,_genWrappers){var rows=uniqueRows(details),newGrid=$_gaga3fnljh8lz1w7.deleteRowsAt(grid,rows[0].row(),rows[rows.length-1].row()),cursor=elementFromGrid(newGrid,details[0].row(),details[0].column());return outcome(newGrid,cursor)},mergeCells=function(grid,mergable,comparator,_genWrappers){var cells=mergable.cells();$_9305lemxjh8lz1qy.merge(cells);var newGrid=$_6f3hexnkjh8lz1w0.merge(grid,mergable.bounds(),comparator,$_bgyjg9kejh8lz1ax.constant(cells[0]));return outcome(newGrid,Option.from(cells[0]))},unmergeCells=function(grid,unmergable,comparator,genWrappers){var newGrid=$_6b0spykcjh8lz1ao.foldr(unmergable,function(b,cell){return $_6f3hexnkjh8lz1w0.unmerge(b,cell,comparator,genWrappers.combine(cell))},grid);return outcome(newGrid,Option.from(unmergable[0]))},pasteCells=function(grid,pasteDetails,comparator,genWrappers){var gridify=function(table,generators){var list=$_ff1h20kmjh8lz1c3.fromTable(table),wh=$_fxwupplkjh8lz1go.generate(list);return $_7a3bzon3jh8lz1si.toGrid(wh,generators,!0)},gridB=gridify(pasteDetails.clipboard(),pasteDetails.generators()),startAddress=$_g424vknjh8lz1cd.address(pasteDetails.row(),pasteDetails.column()),mergedGrid=$_bq9moknhjh8lz1vd.merge(startAddress,grid,gridB,pasteDetails.generators(),comparator);return mergedGrid.fold(function(){return outcome(grid,Option.some(pasteDetails.element()))},function(nuGrid){var cursor=elementFromGrid(nuGrid,pasteDetails.row(),pasteDetails.column());return outcome(nuGrid,cursor)})},gridifyRows=function(rows,generators,example){var pasteDetails=$_ff1h20kmjh8lz1c3.fromPastedRows(rows,example),wh=$_fxwupplkjh8lz1go.generate(pasteDetails);return $_7a3bzon3jh8lz1si.toGrid(wh,generators,!0)},pasteRowsBefore=function(grid,pasteDetails,comparator,genWrappers){var example=grid[pasteDetails.cells[0].row()],index=pasteDetails.cells[0].row(),gridB=gridifyRows(pasteDetails.clipboard(),pasteDetails.generators(),example),mergedGrid=$_bq9moknhjh8lz1vd.insert(index,grid,gridB,pasteDetails.generators(),comparator),cursor=elementFromGrid(mergedGrid,pasteDetails.cells[0].row(),pasteDetails.cells[0].column());return outcome(mergedGrid,cursor)},pasteRowsAfter=function(grid,pasteDetails,comparator,genWrappers){var example=grid[pasteDetails.cells[0].row()],index=pasteDetails.cells[pasteDetails.cells.length-1].row()+pasteDetails.cells[pasteDetails.cells.length-1].rowspan(),gridB=gridifyRows(pasteDetails.clipboard(),pasteDetails.generators(),example),mergedGrid=$_bq9moknhjh8lz1vd.insert(index,grid,gridB,pasteDetails.generators(),comparator),cursor=elementFromGrid(mergedGrid,pasteDetails.cells[0].row(),pasteDetails.cells[0].column());return outcome(mergedGrid,cursor)},resize=$_7x5dznnjh8lz1wh.adjustWidthTo,$_68i0x8mtjh8lz1pt={insertRowBefore:$_1na6n8n0jh8lz1rt.run(insertRowBefore,$_1na6n8n0jh8lz1rt.onCell,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),insertRowsBefore:$_1na6n8n0jh8lz1rt.run(insertRowsBefore,$_1na6n8n0jh8lz1rt.onCells,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),insertRowAfter:$_1na6n8n0jh8lz1rt.run(insertRowAfter,$_1na6n8n0jh8lz1rt.onCell,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),insertRowsAfter:$_1na6n8n0jh8lz1rt.run(insertRowsAfter,$_1na6n8n0jh8lz1rt.onCells,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),insertColumnBefore:$_1na6n8n0jh8lz1rt.run(insertColumnBefore,$_1na6n8n0jh8lz1rt.onCell,resize,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),insertColumnsBefore:$_1na6n8n0jh8lz1rt.run(insertColumnsBefore,$_1na6n8n0jh8lz1rt.onCells,resize,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),insertColumnAfter:$_1na6n8n0jh8lz1rt.run(insertColumnAfter,$_1na6n8n0jh8lz1rt.onCell,resize,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),insertColumnsAfter:$_1na6n8n0jh8lz1rt.run(insertColumnsAfter,$_1na6n8n0jh8lz1rt.onCells,resize,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),splitCellIntoColumns:$_1na6n8n0jh8lz1rt.run(splitCellIntoColumns$1,$_1na6n8n0jh8lz1rt.onCell,resize,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),splitCellIntoRows:$_1na6n8n0jh8lz1rt.run(splitCellIntoRows$1,$_1na6n8n0jh8lz1rt.onCell,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),eraseColumns:$_1na6n8n0jh8lz1rt.run(eraseColumns,$_1na6n8n0jh8lz1rt.onCells,resize,prune,$_46iqoomujh8lz1qf.modification),eraseRows:$_1na6n8n0jh8lz1rt.run(eraseRows,$_1na6n8n0jh8lz1rt.onCells,$_bgyjg9kejh8lz1ax.noop,prune,$_46iqoomujh8lz1qf.modification),makeColumnHeader:$_1na6n8n0jh8lz1rt.run(makeColumnHeader,$_1na6n8n0jh8lz1rt.onCell,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.transform("row","th")),unmakeColumnHeader:$_1na6n8n0jh8lz1rt.run(unmakeColumnHeader,$_1na6n8n0jh8lz1rt.onCell,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.transform(null,"td")),makeRowHeader:$_1na6n8n0jh8lz1rt.run(makeRowHeader,$_1na6n8n0jh8lz1rt.onCell,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.transform("col","th")),unmakeRowHeader:$_1na6n8n0jh8lz1rt.run(unmakeRowHeader,$_1na6n8n0jh8lz1rt.onCell,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.transform(null,"td")),mergeCells:$_1na6n8n0jh8lz1rt.run(mergeCells,$_1na6n8n0jh8lz1rt.onMergable,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.merging),unmergeCells:$_1na6n8n0jh8lz1rt.run(unmergeCells,$_1na6n8n0jh8lz1rt.onUnmergable,resize,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.merging),pasteCells:$_1na6n8n0jh8lz1rt.run(pasteCells,$_1na6n8n0jh8lz1rt.onPaste,resize,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),pasteRowsBefore:$_1na6n8n0jh8lz1rt.run(pasteRowsBefore,$_1na6n8n0jh8lz1rt.onPasteRows,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification),pasteRowsAfter:$_1na6n8n0jh8lz1rt.run(pasteRowsAfter,$_1na6n8n0jh8lz1rt.onPasteRows,$_bgyjg9kejh8lz1ax.noop,$_bgyjg9kejh8lz1ax.noop,$_46iqoomujh8lz1qf.modification)},getBody$1=function(editor){return $_6vo9a4krjh8lz1do.fromDom(editor.getBody())},getPixelWidth$1=function(elm){return elm.getBoundingClientRect().width},getPixelHeight=function(elm){return elm.getBoundingClientRect().height},getIsRoot=function(editor){return function(element){return $_2eywnlkvjh8lz1e8.eq(element,getBody$1(editor))}},removePxSuffix=function(size){return size?size.replace(/px$/,""):""},addSizeSuffix=function(size){return/^[0-9]+$/.test(size)&&(size+="px"),size},removeDataStyle=function(table){var dataStyleCells=$_coxlualejh8lz1fz.descendants(table,"td[data-mce-style],th[data-mce-style]");$_1mp8lglcjh8lz1fq.remove(table,"data-mce-style"),$_6b0spykcjh8lz1ao.each(dataStyleCells,function(cell){$_1mp8lglcjh8lz1fq.remove(cell,"data-mce-style")})},onDirection=function(isLtr,isRtl){return function(element){return"rtl"===getDirection(element)?isRtl:isLtr}},getDirection=function(element){return"rtl"===$_3ory84lljh8lz1gx.get(element,"direction")?"rtl":"ltr"},$_5eddzznwjh8lz1yc={onDirection:onDirection,getDirection:getDirection},ltr$1={isRtl:$_bgyjg9kejh8lz1ax.constant(!1)},rtl$1={isRtl:$_bgyjg9kejh8lz1ax.constant(!0)},directionAt=function(element){var dir=$_5eddzznwjh8lz1yc.getDirection(element);return"rtl"===dir?rtl$1:ltr$1},$_fe2yjsnvjh8lz1y8={directionAt:directionAt},defaultTableToolbar=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],defaultStyles={"border-collapse":"collapse",width:"100%"},defaultAttributes={border:"1"},getDefaultAttributes=function(editor){return editor.getParam("table_default_attributes",defaultAttributes,"object")},getDefaultStyles=function(editor){return editor.getParam("table_default_styles",defaultStyles,"object")},hasTableResizeBars=function(editor){return editor.getParam("table_resize_bars",!0,"boolean")},hasTabNavigation=function(editor){return editor.getParam("table_tab_navigation",!0,"boolean")},hasAdvancedCellTab=function(editor){return editor.getParam("table_cell_advtab",!0,"boolean")},hasAdvancedRowTab=function(editor){return editor.getParam("table_row_advtab",!0,"boolean")},hasAdvancedTableTab=function(editor){return editor.getParam("table_advtab",!0,"boolean")},hasAppearanceOptions=function(editor){return editor.getParam("table_appearance_options",!0,"boolean")},hasTableGrid=function(editor){return editor.getParam("table_grid",!0,"boolean")},shouldStyleWithCss=function(editor){return editor.getParam("table_style_by_css",!1,"boolean")},getCellClassList=function(editor){return editor.getParam("table_cell_class_list",[],"array")},getRowClassList=function(editor){return editor.getParam("table_row_class_list",[],"array")},getTableClassList=function(editor){return editor.getParam("table_class_list",[],"array")},getColorPickerCallback=function(editor){return editor.getParam("color_picker_callback")},isPixelsForced=function(editor){return editor.getParam("table_responsive_width")===!1},getCloneElements=function(editor){var cloneElements=editor.getParam("table_clone_elements");return $_d1kyz8kfjh8lz1az.isString(cloneElements)?Option.some(cloneElements.split(/[ ,]/)):Array.isArray(cloneElements)?Option.some(cloneElements):Option.none()},hasObjectResizing=function(editor){var objectResizing=editor.getParam("object_resizing",!0);return"table"===objectResizing||objectResizing},getToolbar=function(editor){var toolbar=editor.getParam("table_toolbar",defaultTableToolbar);return""===toolbar||toolbar===!1?[]:$_d1kyz8kfjh8lz1az.isString(toolbar)?toolbar.split(/[ ,]/):$_d1kyz8kfjh8lz1az.isArray(toolbar)?toolbar:[]},fireNewRow=function(editor,row){return editor.fire("newrow",{node:row})},fireNewCell=function(editor,cell){return editor.fire("newcell",{node:cell})},fireObjectResizeStart=function(editor,target,width,height){editor.fire("ObjectResizeStart",{target:target,width:width,height:height})},fireObjectResized=function(editor,target,width,height){editor.fire("ObjectResized",{target:target,width:width,height:height})},TableActions=function(editor,lazyWire){var isTableBody=function(editor){return"table"===$_a3izpgldjh8lz1fy.name(getBody$1(editor))},lastRowGuard=function(table){var size=$_fpjoz7msjh8lz1pq.getGridSize(table);return isTableBody(editor)===!1||size.rows()>1},lastColumnGuard=function(table){var size=$_fpjoz7msjh8lz1pq.getGridSize(table);return isTableBody(editor)===!1||size.columns()>1},cloneFormats=getCloneElements(editor),execute=function(operation,guard,mutate,lazyWire){return function(table,target){removeDataStyle(table);var wire=lazyWire(),doc=$_6vo9a4krjh8lz1do.fromDom(editor.getDoc()),direction=TableDirection($_fe2yjsnvjh8lz1y8.directionAt),generators=$_3fxw02lqjh8lz1hp.cellOperations(mutate,doc,cloneFormats);return guard(table)?operation(wire,table,target,generators,direction).bind(function(result){return $_6b0spykcjh8lz1ao.each(result.newRows(),function(row){fireNewRow(editor,row.dom())}),$_6b0spykcjh8lz1ao.each(result.newCells(),function(cell){fireNewCell(editor,cell.dom())}),result.cursor().map(function(cell){var rng=editor.dom.createRng();return rng.setStart(cell.dom(),0),rng.setEnd(cell.dom(),0),rng})}):Option.none()}},deleteRow=execute($_68i0x8mtjh8lz1pt.eraseRows,lastRowGuard,$_bgyjg9kejh8lz1ax.noop,lazyWire),deleteColumn=execute($_68i0x8mtjh8lz1pt.eraseColumns,lastColumnGuard,$_bgyjg9kejh8lz1ax.noop,lazyWire),insertRowsBefore=execute($_68i0x8mtjh8lz1pt.insertRowsBefore,$_bgyjg9kejh8lz1ax.always,$_bgyjg9kejh8lz1ax.noop,lazyWire),insertRowsAfter=execute($_68i0x8mtjh8lz1pt.insertRowsAfter,$_bgyjg9kejh8lz1ax.always,$_bgyjg9kejh8lz1ax.noop,lazyWire),insertColumnsBefore=execute($_68i0x8mtjh8lz1pt.insertColumnsBefore,$_bgyjg9kejh8lz1ax.always,$_36r49rmgjh8lz1nt.halve,lazyWire),insertColumnsAfter=execute($_68i0x8mtjh8lz1pt.insertColumnsAfter,$_bgyjg9kejh8lz1ax.always,$_36r49rmgjh8lz1nt.halve,lazyWire),mergeCells=execute($_68i0x8mtjh8lz1pt.mergeCells,$_bgyjg9kejh8lz1ax.always,$_bgyjg9kejh8lz1ax.noop,lazyWire),unmergeCells=execute($_68i0x8mtjh8lz1pt.unmergeCells,$_bgyjg9kejh8lz1ax.always,$_bgyjg9kejh8lz1ax.noop,lazyWire),pasteRowsBefore=execute($_68i0x8mtjh8lz1pt.pasteRowsBefore,$_bgyjg9kejh8lz1ax.always,$_bgyjg9kejh8lz1ax.noop,lazyWire),pasteRowsAfter=execute($_68i0x8mtjh8lz1pt.pasteRowsAfter,$_bgyjg9kejh8lz1ax.always,$_bgyjg9kejh8lz1ax.noop,lazyWire),pasteCells=execute($_68i0x8mtjh8lz1pt.pasteCells,$_bgyjg9kejh8lz1ax.always,$_bgyjg9kejh8lz1ax.noop,lazyWire);return{deleteRow:deleteRow,deleteColumn:deleteColumn,insertRowsBefore:insertRowsBefore,insertRowsAfter:insertRowsAfter,insertColumnsBefore:insertColumnsBefore,insertColumnsAfter:insertColumnsAfter,mergeCells:mergeCells,unmergeCells:unmergeCells,pasteRowsBefore:pasteRowsBefore,pasteRowsAfter:pasteRowsAfter,pasteCells:pasteCells}},copyRows=function(table,target,generators){var list=$_ff1h20kmjh8lz1c3.fromTable(table),house=$_fxwupplkjh8lz1go.generate(list),details=$_1na6n8n0jh8lz1rt.onCells(house,target);return details.map(function(selectedCells){var grid=$_7a3bzon3jh8lz1si.toGrid(house,generators,!1),slicedGrid=grid.slice(selectedCells[0].row(),selectedCells[selectedCells.length-1].row()+selectedCells[selectedCells.length-1].rowspan()),slicedDetails=$_1na6n8n0jh8lz1rt.toDetailList(slicedGrid,generators);return $_2lx51jn6jh8lz1sw.copy(slicedDetails)})},$_1r3m04o0jh8lz1z4={copyRows:copyRows},global$2=tinymce.util.Tools.resolve("tinymce.util.Tools"),getTDTHOverallStyle=function(dom,elm,name){var firstChildStyle,cells=dom.select("td,th",elm),checkChildren=function(firstChildStyle,elms){for(var i=0;i<elms.length;i++){var currentStyle=dom.getStyle(elms[i],name);if("undefined"==typeof firstChildStyle&&(firstChildStyle=currentStyle),firstChildStyle!==currentStyle)return""}return firstChildStyle};return firstChildStyle=checkChildren(firstChildStyle,cells)},applyAlign=function(editor,elm,name){name&&editor.formatter.apply("align"+name,{},elm)},applyVAlign=function(editor,elm,name){name&&editor.formatter.apply("valign"+name,{},elm)},unApplyAlign=function(editor,elm){global$2.each("left center right".split(" "),function(name){editor.formatter.remove("align"+name,{},elm)})},unApplyVAlign=function(editor,elm){global$2.each("top middle bottom".split(" "),function(name){editor.formatter.remove("valign"+name,{},elm)})},$_fmiiqro3jh8lz1zk={applyAlign:applyAlign,applyVAlign:applyVAlign,unApplyAlign:unApplyAlign,unApplyVAlign:unApplyVAlign,getTDTHOverallStyle:getTDTHOverallStyle},buildListItems=function(inputList,itemCallback,startItems){var appendItems=function(values,output){return output=output||[],global$2.each(values,function(item){var menuItem={text:item.text||item.title};item.menu?menuItem.menu=appendItems(item.menu):(menuItem.value=item.value,itemCallback&&itemCallback(menuItem)),output.push(menuItem)}),output};return appendItems(inputList,startItems||[])},updateStyleField=function(editor,evt){var dom=editor.dom,rootControl=evt.control.rootControl,data=rootControl.toJSON(),css=dom.parseStyle(data.style);"style"===evt.control.name()?(rootControl.find("#borderStyle").value(css["border-style"]||"")[0].fire("select"),rootControl.find("#borderColor").value(css["border-color"]||"")[0].fire("change"),rootControl.find("#backgroundColor").value(css["background-color"]||"")[0].fire("change"),rootControl.find("#width").value(css.width||"").fire("change"),rootControl.find("#height").value(css.height||"").fire("change")):(css["border-style"]=data.borderStyle,css["border-color"]=data.borderColor,css["background-color"]=data.backgroundColor,css.width=data.width?addSizeSuffix(data.width):"",css.height=data.height?addSizeSuffix(data.height):""),rootControl.find("#style").value(dom.serializeStyle(dom.parseStyle(dom.serializeStyle(css))))},extractAdvancedStyles=function(dom,elm){var css=dom.parseStyle(dom.getAttrib(elm,"style")),data={};return css["border-style"]&&(data.borderStyle=css["border-style"]),css["border-color"]&&(data.borderColor=css["border-color"]),css["background-color"]&&(data.backgroundColor=css["background-color"]),data.style=dom.serializeStyle(css),data},createStyleForm=function(editor){var createColorPickAction=function(){var colorPickerCallback=getColorPickerCallback(editor);if(colorPickerCallback)return function(evt){return colorPickerCallback.call(editor,function(value){evt.control.value(value).fire("change")},evt.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:$_bgyjg9kejh8lz1ax.curry(updateStyleField,editor)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:$_bgyjg9kejh8lz1ax.curry(updateStyleField,editor),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:createColorPickAction()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:createColorPickAction()}]}]}},$_7mumlpo4jh8lz1zt={createStyleForm:createStyleForm,buildListItems:buildListItems,updateStyleField:updateStyleField,extractAdvancedStyles:extractAdvancedStyles},updateStyles=function(elm,cssText){delete elm.dataset.mceStyle,elm.style.cssText+=";"+cssText},extractDataFromElement=function(editor,elm){var dom=editor.dom,data={width:dom.getStyle(elm,"width")||dom.getAttrib(elm,"width"),height:dom.getStyle(elm,"height")||dom.getAttrib(elm,"height"),scope:dom.getAttrib(elm,"scope"),"class":dom.getAttrib(elm,"class"),type:elm.nodeName.toLowerCase(),style:"",align:"",valign:""};return global$2.each("left center right".split(" "),function(name){editor.formatter.matchNode(elm,"align"+name)&&(data.align=name)}),global$2.each("top middle bottom".split(" "),function(name){editor.formatter.matchNode(elm,"valign"+name)&&(data.valign=name)}),hasAdvancedCellTab(editor)&&global$2.extend(data,$_7mumlpo4jh8lz1zt.extractAdvancedStyles(dom,elm)),data},onSubmitCellForm=function(editor,cells,evt){function setAttrib(elm,name,value){value&&dom.setAttrib(elm,name,value)}function setStyle(elm,name,value){value&&dom.setStyle(elm,name,value)}var data,dom=editor.dom;$_7mumlpo4jh8lz1zt.updateStyleField(editor,evt),data=evt.control.rootControl.toJSON(),editor.undoManager.transact(function(){global$2.each(cells,function(cellElm){setAttrib(cellElm,"scope",data.scope),1===cells.length?setAttrib(cellElm,"style",data.style):updateStyles(cellElm,data.style),setAttrib(cellElm,"class",data["class"]),setStyle(cellElm,"width",addSizeSuffix(data.width)),setStyle(cellElm,"height",addSizeSuffix(data.height)),data.type&&cellElm.nodeName.toLowerCase()!==data.type&&(cellElm=dom.rename(cellElm,data.type)),1===cells.length&&($_fmiiqro3jh8lz1zk.unApplyAlign(editor,cellElm),$_fmiiqro3jh8lz1zk.unApplyVAlign(editor,cellElm)),data.align&&$_fmiiqro3jh8lz1zk.applyAlign(editor,cellElm,data.align),data.valign&&$_fmiiqro3jh8lz1zk.applyVAlign(editor,cellElm,data.valign);
}),editor.focus()})},open=function(editor){var cellElm,data,classListCtrl,cells=[];if(cells=editor.dom.select("td[data-mce-selected],th[data-mce-selected]"),cellElm=editor.dom.getParent(editor.selection.getStart(),"td,th"),!cells.length&&cellElm&&cells.push(cellElm),cellElm=cellElm||cells[0]){data=cells.length>1?{width:"",height:"",scope:"","class":"",align:"",valign:"",style:"",type:cellElm.nodeName.toLowerCase()}:extractDataFromElement(editor,cellElm),getCellClassList(editor).length>0&&(classListCtrl={name:"class",type:"listbox",label:"Class",values:$_7mumlpo4jh8lz1zt.buildListItems(getCellClassList(editor),function(item){item.value&&(item.textStyle=function(){return editor.formatter.getCssText({block:"td",classes:[item.value]})})})});var generalCellForm={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:$_bgyjg9kejh8lz1ax.curry($_7mumlpo4jh8lz1zt.updateStyleField,editor)},{label:"Height",name:"height",onchange:$_bgyjg9kejh8lz1ax.curry($_7mumlpo4jh8lz1zt.updateStyleField,editor)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},classListCtrl]};hasAdvancedCellTab(editor)?editor.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:data,body:[{title:"General",type:"form",items:generalCellForm},$_7mumlpo4jh8lz1zt.createStyleForm(editor)],onsubmit:$_bgyjg9kejh8lz1ax.curry(onSubmitCellForm,editor,cells)}):editor.windowManager.open({title:"Cell properties",data:data,body:generalCellForm,onsubmit:$_bgyjg9kejh8lz1ax.curry(onSubmitCellForm,editor,cells)})}},$_eo7s5go2jh8lz1ze={open:open},extractDataFromElement$1=function(editor,elm){var dom=editor.dom,data={height:dom.getStyle(elm,"height")||dom.getAttrib(elm,"height"),scope:dom.getAttrib(elm,"scope"),"class":dom.getAttrib(elm,"class"),align:"",style:"",type:elm.parentNode.nodeName.toLowerCase()};return global$2.each("left center right".split(" "),function(name){editor.formatter.matchNode(elm,"align"+name)&&(data.align=name)}),hasAdvancedRowTab(editor)&&global$2.extend(data,$_7mumlpo4jh8lz1zt.extractAdvancedStyles(dom,elm)),data},switchRowType=function(dom,rowElm,toType){var tableElm=dom.getParent(rowElm,"table"),oldParentElm=rowElm.parentNode,parentElm=dom.select(toType,tableElm)[0];parentElm||(parentElm=dom.create(toType),tableElm.firstChild?"CAPTION"===tableElm.firstChild.nodeName?dom.insertAfter(parentElm,tableElm.firstChild):tableElm.insertBefore(parentElm,tableElm.firstChild):tableElm.appendChild(parentElm)),parentElm.appendChild(rowElm),oldParentElm.hasChildNodes()||dom.remove(oldParentElm)},open$1=function(editor){var tableElm,cellElm,rowElm,classListCtrl,data,generalRowForm,dom=editor.dom,rows=[];tableElm=dom.getParent(editor.selection.getStart(),"table"),cellElm=dom.getParent(editor.selection.getStart(),"td,th"),global$2.each(tableElm.rows,function(row){global$2.each(row.cells,function(cell){if(dom.getAttrib(cell,"data-mce-selected")||cell===cellElm)return rows.push(row),!1})}),rowElm=rows[0],rowElm&&(data=rows.length>1?{height:"",scope:"",style:"","class":"",align:"",type:rowElm.parentNode.nodeName.toLowerCase()}:extractDataFromElement$1(editor,rowElm),getRowClassList(editor).length>0&&(classListCtrl={name:"class",type:"listbox",label:"Class",values:$_7mumlpo4jh8lz1zt.buildListItems(getRowClassList(editor),function(item){item.value&&(item.textStyle=function(){return editor.formatter.getCssText({block:"tr",classes:[item.value]})})})}),generalRowForm={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},classListCtrl]},hasAdvancedRowTab(editor)?editor.windowManager.open({title:"Row properties",data:data,bodyType:"tabpanel",body:[{title:"General",type:"form",items:generalRowForm},$_7mumlpo4jh8lz1zt.createStyleForm(editor)],onsubmit:$_bgyjg9kejh8lz1ax.curry(onSubmitRowForm,editor,rows,data)}):editor.windowManager.open({title:"Row properties",data:data,body:generalRowForm,onsubmit:$_bgyjg9kejh8lz1ax.curry(onSubmitRowForm,editor,rows,data)}))},$_1dfi9ho5jh8lz1zz={open:open$1},global$3=tinymce.util.Tools.resolve("tinymce.Env"),DefaultRenderOptions={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},makeTable=function(){return $_6vo9a4krjh8lz1do.fromTag("table")},tableBody=function(){return $_6vo9a4krjh8lz1do.fromTag("tbody")},tableRow=function(){return $_6vo9a4krjh8lz1do.fromTag("tr")},tableHeaderCell=function(){return $_6vo9a4krjh8lz1do.fromTag("th")},tableCell=function(){return $_6vo9a4krjh8lz1do.fromTag("td")},render$1=function(rows,columns,rowHeaders,columnHeaders,renderOpts){void 0===renderOpts&&(renderOpts=DefaultRenderOptions);var table=makeTable();$_3ory84lljh8lz1gx.setAll(table,renderOpts.styles),$_1mp8lglcjh8lz1fq.setAll(table,renderOpts.attributes);var tbody=tableBody();$_6qqu1alnjh8lz1hg.append(table,tbody);for(var trs=[],i=0;i<rows;i++){for(var tr=tableRow(),j=0;j<columns;j++){var td=i<rowHeaders||j<columnHeaders?tableHeaderCell():tableCell();j<columnHeaders&&$_1mp8lglcjh8lz1fq.set(td,"scope","row"),i<rowHeaders&&$_1mp8lglcjh8lz1fq.set(td,"scope","col"),$_6qqu1alnjh8lz1hg.append(td,$_6vo9a4krjh8lz1do.fromTag("br")),renderOpts.percentages&&$_3ory84lljh8lz1gx.set(td,"width",100/columns+"%"),$_6qqu1alnjh8lz1hg.append(tr,td)}trs.push(tr)}return $_d7tq5mlpjh8lz1hl.append(tbody,trs),table},get$7=function(element){return element.dom().innerHTML},set$5=function(element,content){var owner=$_4hc7u2ktjh8lz1dv.owner(element),docDom=owner.dom(),fragment=$_6vo9a4krjh8lz1do.fromDom(docDom.createDocumentFragment()),contentElements=$_200no5lwjh8lz1iy.fromHtml(content,docDom);$_d7tq5mlpjh8lz1hl.append(fragment,contentElements),$_f2hny0lojh8lz1hi.empty(element),$_6qqu1alnjh8lz1hg.append(element,fragment)},getOuter$2=function(element){var container=$_6vo9a4krjh8lz1do.fromTag("div"),clone=$_6vo9a4krjh8lz1do.fromDom(element.dom().cloneNode(!0));return $_6qqu1alnjh8lz1hg.append(container,clone),get$7(container)},$_1dtmigobjh8lz215={get:get$7,set:set$5,getOuter:getOuter$2},placeCaretInCell=function(editor,cell){editor.selection.select(cell.dom(),!0),editor.selection.collapse(!0)},selectFirstCellInTable=function(editor,tableElm){$_fiygddlhjh8lz1g7.descendant(tableElm,"td,th").each($_bgyjg9kejh8lz1ax.curry(placeCaretInCell,editor))},fireEvents=function(editor,table){$_6b0spykcjh8lz1ao.each($_coxlualejh8lz1fz.descendants(table,"tr"),function(row){fireNewRow(editor,row.dom()),$_6b0spykcjh8lz1ao.each($_coxlualejh8lz1fz.descendants(row,"th,td"),function(cell){fireNewCell(editor,cell.dom())})})},isPercentage=function(width){return $_d1kyz8kfjh8lz1az.isString(width)&&width.indexOf("%")!==-1},insert$1=function(editor,columns,rows){var defaultStyles=getDefaultStyles(editor),options={styles:defaultStyles,attributes:getDefaultAttributes(editor),percentages:isPercentage(defaultStyles.width)&&!isPixelsForced(editor)},table=render$1(rows,columns,0,0,options);$_1mp8lglcjh8lz1fq.set(table,"data-mce-id","__mce");var html=$_1dtmigobjh8lz215.getOuter(table);return editor.insertContent(html),$_fiygddlhjh8lz1g7.descendant(getBody$1(editor),'table[data-mce-id="__mce"]').map(function(table){return isPixelsForced(editor)&&$_3ory84lljh8lz1gx.set(table,"width",$_3ory84lljh8lz1gx.get(table,"width")),$_1mp8lglcjh8lz1fq.remove(table,"data-mce-id"),fireEvents(editor,table),selectFirstCellInTable(editor,table),table.dom()}).getOr(null)},$_7a3xgho8jh8lz20d={insert:insert$1},extractDataFromElement$2=function(editor,tableElm){var dom=editor.dom,data={width:dom.getStyle(tableElm,"width")||dom.getAttrib(tableElm,"width"),height:dom.getStyle(tableElm,"height")||dom.getAttrib(tableElm,"height"),cellspacing:dom.getStyle(tableElm,"border-spacing")||dom.getAttrib(tableElm,"cellspacing"),cellpadding:dom.getAttrib(tableElm,"data-mce-cell-padding")||dom.getAttrib(tableElm,"cellpadding")||$_fmiiqro3jh8lz1zk.getTDTHOverallStyle(editor.dom,tableElm,"padding"),border:dom.getAttrib(tableElm,"data-mce-border")||dom.getAttrib(tableElm,"border")||$_fmiiqro3jh8lz1zk.getTDTHOverallStyle(editor.dom,tableElm,"border"),borderColor:dom.getAttrib(tableElm,"data-mce-border-color"),caption:!!dom.select("caption",tableElm)[0],"class":dom.getAttrib(tableElm,"class")};return global$2.each("left center right".split(" "),function(name){editor.formatter.matchNode(tableElm,"align"+name)&&(data.align=name)}),hasAdvancedTableTab(editor)&&global$2.extend(data,$_7mumlpo4jh8lz1zt.extractAdvancedStyles(dom,tableElm)),data},applyDataToElement=function(editor,tableElm,data){var dom=editor.dom,attrs={},styles={};if(attrs["class"]=data["class"],styles.height=addSizeSuffix(data.height),dom.getAttrib(tableElm,"width")&&!shouldStyleWithCss(editor)?attrs.width=removePxSuffix(data.width):styles.width=addSizeSuffix(data.width),shouldStyleWithCss(editor)?(styles["border-width"]=addSizeSuffix(data.border),styles["border-spacing"]=addSizeSuffix(data.cellspacing),global$2.extend(attrs,{"data-mce-border-color":data.borderColor,"data-mce-cell-padding":data.cellpadding,"data-mce-border":data.border})):global$2.extend(attrs,{border:data.border,cellpadding:data.cellpadding,cellspacing:data.cellspacing}),shouldStyleWithCss(editor)&&tableElm.children)for(var i=0;i<tableElm.children.length;i++)styleTDTH(dom,tableElm.children[i],{"border-width":addSizeSuffix(data.border),"border-color":data.borderColor,padding:addSizeSuffix(data.cellpadding)});data.style?global$2.extend(styles,dom.parseStyle(data.style)):styles=global$2.extend({},dom.parseStyle(dom.getAttrib(tableElm,"style")),styles),attrs.style=dom.serializeStyle(styles),dom.setAttribs(tableElm,attrs)},onSubmitTableForm=function(editor,tableElm,evt){var captionElm,data,dom=editor.dom;$_7mumlpo4jh8lz1zt.updateStyleField(editor,evt),data=evt.control.rootControl.toJSON(),data["class"]===!1&&delete data["class"],editor.undoManager.transact(function(){tableElm||(tableElm=$_7a3xgho8jh8lz20d.insert(editor,data.cols||1,data.rows||1)),applyDataToElement(editor,tableElm,data),captionElm=dom.select("caption",tableElm)[0],captionElm&&!data.caption&&dom.remove(captionElm),!captionElm&&data.caption&&(captionElm=dom.create("caption"),captionElm.innerHTML=global$3.ie?" ":'<br data-mce-bogus="1"/>',tableElm.insertBefore(captionElm,tableElm.firstChild)),$_fmiiqro3jh8lz1zk.unApplyAlign(editor,tableElm),data.align&&$_fmiiqro3jh8lz1zk.applyAlign(editor,tableElm,data.align),editor.focus(),editor.addVisual()})},open$2=function(editor,isProps){var tableElm,colsCtrl,rowsCtrl,classListCtrl,generalTableForm,dom=editor.dom,data={};isProps===!0?(tableElm=dom.getParent(editor.selection.getStart(),"table"),tableElm&&(data=extractDataFromElement$2(editor,tableElm))):(colsCtrl={label:"Cols",name:"cols"},rowsCtrl={label:"Rows",name:"rows"}),getTableClassList(editor).length>0&&(data["class"]&&(data["class"]=data["class"].replace(/\s*mce\-item\-table\s*/g,"")),classListCtrl={name:"class",type:"listbox",label:"Class",values:$_7mumlpo4jh8lz1zt.buildListItems(getTableClassList(editor),function(item){item.value&&(item.textStyle=function(){return editor.formatter.getCssText({block:"table",classes:[item.value]})})})}),generalTableForm={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:hasAppearanceOptions(editor)?[colsCtrl,rowsCtrl,{label:"Width",name:"width",onchange:$_bgyjg9kejh8lz1ax.curry($_7mumlpo4jh8lz1zt.updateStyleField,editor)},{label:"Height",name:"height",onchange:$_bgyjg9kejh8lz1ax.curry($_7mumlpo4jh8lz1zt.updateStyleField,editor)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[colsCtrl,rowsCtrl,{label:"Width",name:"width",onchange:$_bgyjg9kejh8lz1ax.curry($_7mumlpo4jh8lz1zt.updateStyleField,editor)},{label:"Height",name:"height",onchange:$_bgyjg9kejh8lz1ax.curry($_7mumlpo4jh8lz1zt.updateStyleField,editor)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},classListCtrl]},hasAdvancedTableTab(editor)?editor.windowManager.open({title:"Table properties",data:data,bodyType:"tabpanel",body:[{title:"General",type:"form",items:generalTableForm},$_7mumlpo4jh8lz1zt.createStyleForm(editor)],onsubmit:$_bgyjg9kejh8lz1ax.curry(onSubmitTableForm,editor,tableElm)}):editor.windowManager.open({title:"Table properties",data:data,body:generalTableForm,onsubmit:$_bgyjg9kejh8lz1ax.curry(onSubmitTableForm,editor,tableElm)})},$_4ld2ndo6jh8lz205={open:open$2},each$3=global$2.each,registerCommands=function(editor,actions,cellSelection,selections,clipboardRows){var isRoot=getIsRoot(editor),eraseTable=function(){var cell=$_6vo9a4krjh8lz1do.fromDom(editor.dom.getParent(editor.selection.getStart(),"th,td")),table=$_ee8pmfkojh8lz1ch.table(cell,isRoot);table.filter($_bgyjg9kejh8lz1ax.not(isRoot)).each(function(table){var cursor=$_6vo9a4krjh8lz1do.fromText("");$_6qqu1alnjh8lz1hg.after(table,cursor),$_f2hny0lojh8lz1hi.remove(table);var rng=editor.dom.createRng();rng.setStart(cursor.dom(),0),rng.setEnd(cursor.dom(),0),editor.selection.setRng(rng)})},getSelectionStartCell=function(){return $_6vo9a4krjh8lz1do.fromDom(editor.dom.getParent(editor.selection.getStart(),"th,td"))},getTableFromCell=function(cell){return $_ee8pmfkojh8lz1ch.table(cell,isRoot)},getSize=function(table){return{width:getPixelWidth$1(table.dom()),height:getPixelWidth$1(table.dom())}},resizeChange=function(editor,oldSize,table){var newSize=getSize(table);oldSize.width===newSize.width&&oldSize.height===newSize.height||(fireObjectResizeStart(editor,table.dom(),oldSize.width,oldSize.height),fireObjectResized(editor,table.dom(),newSize.width,newSize.height))},actOnSelection=function(execute){var cell=getSelectionStartCell(),table=getTableFromCell(cell);table.each(function(table){var targets=$_3xfj7olxjh8lz1j2.forMenu(selections,table,cell),beforeSize=getSize(table);execute(table,targets).each(function(rng){resizeChange(editor,beforeSize,table),editor.selection.setRng(rng),editor.focus(),cellSelection.clear(table),removeDataStyle(table)})})},copyRowSelection=function(execute){var cell=getSelectionStartCell(),table=getTableFromCell(cell);return table.bind(function(table){var doc=$_6vo9a4krjh8lz1do.fromDom(editor.getDoc()),targets=$_3xfj7olxjh8lz1j2.forMenu(selections,table,cell),generators=$_3fxw02lqjh8lz1hp.cellOperations($_bgyjg9kejh8lz1ax.noop,doc,Option.none());return $_1r3m04o0jh8lz1z4.copyRows(table,targets,generators)})},pasteOnSelection=function(execute){clipboardRows.get().each(function(rows){var clonedRows=$_6b0spykcjh8lz1ao.map(rows,function(row){return $_zeqq4lrjh8lz1id.deep(row)}),cell=getSelectionStartCell(),table=getTableFromCell(cell);table.bind(function(table){var doc=$_6vo9a4krjh8lz1do.fromDom(editor.getDoc()),generators=$_3fxw02lqjh8lz1hp.paste(doc),targets=$_3xfj7olxjh8lz1j2.pasteRows(selections,table,cell,clonedRows,generators);execute(table,targets).each(function(rng){editor.selection.setRng(rng),editor.focus(),cellSelection.clear(table)})})})};each$3({mceTableSplitCells:function(){actOnSelection(actions.unmergeCells)},mceTableMergeCells:function(){actOnSelection(actions.mergeCells)},mceTableInsertRowBefore:function(){actOnSelection(actions.insertRowsBefore)},mceTableInsertRowAfter:function(){actOnSelection(actions.insertRowsAfter)},mceTableInsertColBefore:function(){actOnSelection(actions.insertColumnsBefore)},mceTableInsertColAfter:function(){actOnSelection(actions.insertColumnsAfter)},mceTableDeleteCol:function(){actOnSelection(actions.deleteColumn)},mceTableDeleteRow:function(){actOnSelection(actions.deleteRow)},mceTableCutRow:function(grid){clipboardRows.set(copyRowSelection()),actOnSelection(actions.deleteRow)},mceTableCopyRow:function(grid){clipboardRows.set(copyRowSelection())},mceTablePasteRowBefore:function(grid){pasteOnSelection(actions.pasteRowsBefore)},mceTablePasteRowAfter:function(grid){pasteOnSelection(actions.pasteRowsAfter)},mceTableDelete:eraseTable},function(func,name){editor.addCommand(name,func)}),each$3({mceInsertTable:$_bgyjg9kejh8lz1ax.curry($_4ld2ndo6jh8lz205.open,editor),mceTableProps:$_bgyjg9kejh8lz1ax.curry($_4ld2ndo6jh8lz205.open,editor,!0),mceTableRowProps:$_bgyjg9kejh8lz1ax.curry($_1dfi9ho5jh8lz1zz.open,editor),mceTableCellProps:$_bgyjg9kejh8lz1ax.curry($_eo7s5go2jh8lz1ze.open,editor)},function(func,name){editor.addCommand(name,function(ui,val){func(val)})})},$_cmt2k3nzjh8lz1ym={registerCommands:registerCommands},only$1=function(element){var parent=Option.from(element.dom().documentElement).map($_6vo9a4krjh8lz1do.fromDom).getOr(element);return{parent:$_bgyjg9kejh8lz1ax.constant(parent),view:$_bgyjg9kejh8lz1ax.constant(element),origin:$_bgyjg9kejh8lz1ax.constant(r(0,0))}},detached=function(editable,chrome){var origin=$_bgyjg9kejh8lz1ax.curry($_6xc5idmpjh8lz1ph.absolute,chrome);return{parent:$_bgyjg9kejh8lz1ax.constant(chrome),view:$_bgyjg9kejh8lz1ax.constant(editable),origin:origin}},body$1=function(editable,chrome){return{parent:$_bgyjg9kejh8lz1ax.constant(chrome),view:$_bgyjg9kejh8lz1ax.constant(editable),origin:$_bgyjg9kejh8lz1ax.constant(r(0,0))}},$_bdbkjodjh8lz21o={only:only$1,detached:detached,body:body$1},create=function(typeDefs){var registry=$_8kti2hkhjh8lz1bt.map(typeDefs,function(event){return{bind:event.bind,unbind:event.unbind}}),trigger=$_8kti2hkhjh8lz1bt.map(typeDefs,function(event){return event.trigger});return{registry:registry,trigger:trigger}},$_cmo273ogjh8lz22b={create:create},mode=$_2qijvhmwjh8lz1qv.exactly(["compare","extract","mutate","sink"]),sink=$_2qijvhmwjh8lz1qv.exactly(["element","start","stop","destroy"]),api$3=$_2qijvhmwjh8lz1qv.exactly(["forceDrop","drop","move","delayDrop"]),$_ay0s6wokjh8lz23r={mode:mode,sink:sink,api:api$3},styles$1=$_2i90e7ncjh8lz1ux.css("ephox-dragster"),$_d4gfq4omjh8lz247={resolve:styles$1.resolve},mkEvent=function(target,x,y,stop,prevent,kill,raw){return{target:$_bgyjg9kejh8lz1ax.constant(target),x:$_bgyjg9kejh8lz1ax.constant(x),y:$_bgyjg9kejh8lz1ax.constant(y),stop:stop,prevent:prevent,kill:kill,raw:$_bgyjg9kejh8lz1ax.constant(raw)}},handle=function(filter,handler){return function(rawEvent){if(filter(rawEvent)){var target=$_6vo9a4krjh8lz1do.fromDom(rawEvent.target),stop=function(){rawEvent.stopPropagation()},prevent=function(){rawEvent.preventDefault()},kill=$_bgyjg9kejh8lz1ax.compose(prevent,stop),evt=mkEvent(target,rawEvent.clientX,rawEvent.clientY,stop,prevent,kill,rawEvent);handler(evt)}}},binder=function(element,event,filter,handler,useCapture){var wrapped=handle(filter,handler);return element.dom().addEventListener(event,wrapped,useCapture),{unbind:$_bgyjg9kejh8lz1ax.curry(unbind,element,event,wrapped,useCapture)}},bind$1=function(element,event,filter,handler){return binder(element,event,filter,handler,!1)},capture=function(element,event,filter,handler){return binder(element,event,filter,handler,!0)},unbind=function(element,event,handler,useCapture){element.dom().removeEventListener(event,handler,useCapture)},$_8y86u3oojh8lz24e={bind:bind$1,capture:capture},filter$1=$_bgyjg9kejh8lz1ax.constant(!0),bind$2=function(element,event,handler){return $_8y86u3oojh8lz24e.bind(element,event,filter$1,handler)},capture$1=function(element,event,handler){return $_8y86u3oojh8lz24e.capture(element,event,filter$1,handler)},$_5cpulvonjh8lz24a={bind:bind$2,capture:capture$1},compare=function(old,nu){return r(nu.left()-old.left(),nu.top()-old.top())},extract$1=function(event){return Option.some(r(event.x(),event.y()))},mutate$1=function(mutation,info){mutation.mutate(info.left(),info.top())},sink$1=function(dragApi,settings){var blocker=Blocker(settings),mdown=$_5cpulvonjh8lz24a.bind(blocker.element(),"mousedown",dragApi.forceDrop),mup=$_5cpulvonjh8lz24a.bind(blocker.element(),"mouseup",dragApi.drop),mmove=$_5cpulvonjh8lz24a.bind(blocker.element(),"mousemove",dragApi.move),mout=$_5cpulvonjh8lz24a.bind(blocker.element(),"mouseout",dragApi.delayDrop),destroy=function(){blocker.destroy(),mup.unbind(),mmove.unbind(),mout.unbind(),mdown.unbind()},start=function(parent){$_6qqu1alnjh8lz1hg.append(parent,blocker.element())},stop=function(){$_f2hny0lojh8lz1hi.remove(blocker.element())};return $_ay0s6wokjh8lz23r.sink({element:blocker.element,start:start,stop:stop,destroy:destroy})},MouseDrag=$_ay0s6wokjh8lz23r.mode({compare:compare,extract:extract$1,sink:sink$1,mutate:mutate$1}),adaptable=function(fn,rate){var timer=null,args=null,cancel=function(){null!==timer&&(clearTimeout(timer),timer=null,args=null)},throttle=function(){args=arguments,null===timer&&(timer=setTimeout(function(){fn.apply(null,args),timer=null,args=null},rate))};return{cancel:cancel,throttle:throttle}},first$4=function(fn,rate){var timer=null,cancel=function(){null!==timer&&(clearTimeout(timer),timer=null)},throttle=function(){var args=arguments;null===timer&&(timer=setTimeout(function(){fn.apply(null,args),timer=null,args=null},rate))};return{cancel:cancel,throttle:throttle}},last$3=function(fn,rate){var timer=null,cancel=function(){null!==timer&&(clearTimeout(timer),timer=null)},throttle=function(){var args=arguments;null!==timer&&clearTimeout(timer),timer=setTimeout(function(){fn.apply(null,args),timer=null,args=null},rate)};return{cancel:cancel,throttle:throttle}},$_eu7wkootjh8lz251={adaptable:adaptable,first:first$4,last:last$3},setup=function(mutation,mode,settings){var active=!1,events=$_cmo273ogjh8lz22b.create({start:Event([]),stop:Event([])}),movement=Movement(),drop=function(){sink.stop(),movement.isOn()&&(movement.off(),events.trigger.stop())},throttledDrop=$_eu7wkootjh8lz251.last(drop,200),go=function(parent){sink.start(parent),movement.on(),events.trigger.start()},mousemove=function(event,ui){throttledDrop.cancel(),movement.onEvent(event,mode)};movement.events.move.bind(function(event){mode.mutate(mutation,event.info())});var on=function(){active=!0},off=function(){active=!1},runIfActive=function(f){return function(){var args=Array.prototype.slice.call(arguments,0);if(active)return f.apply(null,args)}},sink=mode.sink($_ay0s6wokjh8lz23r.api({forceDrop:drop,drop:runIfActive(drop),move:runIfActive(mousemove),delayDrop:runIfActive(throttledDrop.throttle)}),settings),destroy=function(){sink.destroy()};return{element:sink.element,go:go,on:on,off:off,destroy:destroy,events:events.registry}},$_feeb1aopjh8lz24i={setup:setup},transform$1=function(mutation,options){var settings=void 0!==options?options:{},mode=void 0!==settings.mode?settings.mode:MouseDrag;return $_feeb1aopjh8lz24i.setup(mutation,mode,options)},$_dm1jluoijh8lz23a={transform:transform$1},any=function(selector){return $_fiygddlhjh8lz1g7.first(selector).isSome()},ancestor$2=function(scope,selector,isRoot){return $_fiygddlhjh8lz1g7.ancestor(scope,selector,isRoot).isSome()},sibling$2=function(scope,selector){return $_fiygddlhjh8lz1g7.sibling(scope,selector).isSome()},child$3=function(scope,selector){return $_fiygddlhjh8lz1g7.child(scope,selector).isSome()},descendant$2=function(scope,selector){return $_fiygddlhjh8lz1g7.descendant(scope,selector).isSome()},closest$2=function(scope,selector,isRoot){return $_fiygddlhjh8lz1g7.closest(scope,selector,isRoot).isSome()},$_6z48nsowjh8lz25j={any:any,ancestor:ancestor$2,sibling:sibling$2,child:child$3,descendant:descendant$2,closest:closest$2},resizeBarDragging=$_ezk1iinbjh8lz1uu.resolve("resizer-bar-dragging"),createContainer=function(){var container=$_6vo9a4krjh8lz1do.fromTag("div");return $_3ory84lljh8lz1gx.setAll(container,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),$_6qqu1alnjh8lz1hg.append($_brbde9lgjh8lz1g4.body(),container),container},get$8=function(editor,container){return editor.inline?$_bdbkjodjh8lz21o.body(getBody$1(editor),createContainer()):$_bdbkjodjh8lz21o.only($_6vo9a4krjh8lz1do.fromDom(editor.getDoc()))},remove$6=function(editor,wire){editor.inline&&$_f2hny0lojh8lz1hi.remove(wire.parent())},$_848v6boxjh8lz25l={get:get$8,remove:remove$6},ResizeHandler=function(editor){var startW,startRawW,selectionRng=Option.none(),resize=Option.none(),wire=Option.none(),percentageBasedSizeRegex=/(\d+(\.\d+)?)%/,isTable=function(elm){return"TABLE"===elm.nodeName},getRawWidth=function(elm){return editor.dom.getStyle(elm,"width")||editor.dom.getAttrib(elm,"width")},lazyResize=function(){return resize},lazyWire=function(){return wire.getOr($_bdbkjodjh8lz21o.only($_6vo9a4krjh8lz1do.fromDom(editor.getBody())))},destroy=function(){resize.each(function(sz){sz.destroy()}),wire.each(function(w){$_848v6boxjh8lz25l.remove(editor,w)})};return editor.on("init",function(){var direction=TableDirection($_fe2yjsnvjh8lz1y8.directionAt),rawWire=$_848v6boxjh8lz25l.get(editor);if(wire=Option.some(rawWire),hasObjectResizing(editor)&&hasTableResizeBars(editor)){var sz=TableResize(rawWire,direction);sz.on(),sz.events.startDrag.bind(function(event){selectionRng=Option.some(editor.selection.getRng())}),sz.events.beforeResize.bind(function(event){var rawTable=event.table().dom();fireObjectResizeStart(editor,rawTable,getPixelWidth$1(rawTable),getPixelHeight(rawTable))}),sz.events.afterResize.bind(function(event){var table=event.table(),rawTable=table.dom();removeDataStyle(table),selectionRng.each(function(rng){editor.selection.setRng(rng),editor.focus()}),fireObjectResized(editor,rawTable,getPixelWidth$1(rawTable),getPixelHeight(rawTable)),editor.undoManager.add()}),resize=Option.some(sz)}}),editor.on("ObjectResizeStart",function(e){var targetElm=e.target;isTable(targetElm)&&(startW=e.width,startRawW=getRawWidth(targetElm))}),editor.on("ObjectResized",function(e){var targetElm=e.target;if(isTable(targetElm)){var table=targetElm;if(percentageBasedSizeRegex.test(startRawW)){var percentW=parseFloat(percentageBasedSizeRegex.exec(startRawW)[1]),targetPercentW=e.width*percentW/startW;editor.dom.setStyle(table,"width",targetPercentW+"%")}else{var newCellSizes_1=[];global$2.each(table.rows,function(row){global$2.each(row.cells,function(cell){var width=editor.dom.getStyle(cell,"width",!0);newCellSizes_1.push({cell:cell,width:width})})}),global$2.each(newCellSizes_1,function(newCellSize){editor.dom.setStyle(newCellSize.cell,"width",newCellSize.width),editor.dom.setAttrib(newCellSize.cell,"width",null)})}}}),{lazyResize:lazyResize,lazyWire:lazyWire,destroy:destroy}},none$2=function(current){return folder$1(function(n,f,m,l){return n(current)})},first$5=function(current){return folder$1(function(n,f,m,l){return f(current)})},middle$1=function(current,target){return folder$1(function(n,f,m,l){return m(current,target)})},last$4=function(current){return folder$1(function(n,f,m,l){return l(current)})},folder$1=function(fold){return{fold:fold}},$_1x3ywmp0jh8lz26n={none:none$2,first:first$5,middle:middle$1,last:last$4},detect$4=function(current,isRoot){return $_ee8pmfkojh8lz1ch.table(current,isRoot).bind(function(table){var all=$_ee8pmfkojh8lz1ch.cells(table),index=$_6b0spykcjh8lz1ao.findIndex(all,function(x){return $_2eywnlkvjh8lz1e8.eq(current,x)});return index.map(function(ind){return{index:$_bgyjg9kejh8lz1ax.constant(ind),all:$_bgyjg9kejh8lz1ax.constant(all)}})})},next=function(current,isRoot){var detection=detect$4(current,isRoot);return detection.fold(function(){return $_1x3ywmp0jh8lz26n.none(current)},function(info){return info.index()+1<info.all().length?$_1x3ywmp0jh8lz26n.middle(current,info.all()[info.index()+1]):$_1x3ywmp0jh8lz26n.last(current)})},prev=function(current,isRoot){var detection=detect$4(current,isRoot);return detection.fold(function(){return $_1x3ywmp0jh8lz26n.none()},function(info){return info.index()-1>=0?$_1x3ywmp0jh8lz26n.middle(current,info.all()[info.index()-1]):$_1x3ywmp0jh8lz26n.first(current)})},$_4luh0iozjh8lz26g={next:next,prev:prev},adt=$_659si2mejh8lz1n9.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),cata$1=function(subject,onBefore,onOn,onAfter){return subject.fold(onBefore,onOn,onAfter)},getStart=function(situ){return situ.fold($_bgyjg9kejh8lz1ax.identity,$_bgyjg9kejh8lz1ax.identity,$_bgyjg9kejh8lz1ax.identity)},$_eviq86p2jh8lz26w={before:adt.before,on:adt.on,after:adt.after,cata:cata$1,getStart:getStart},type$2=$_659si2mejh8lz1n9.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),range$2=$_d2ojjnkijh8lz1bv.immutable("start","soffset","finish","foffset"),exactFromRange=function(simRange){return type$2.exact(simRange.start(),simRange.soffset(),simRange.finish(),simRange.foffset())},getStart$1=function(selection){return selection.match({domRange:function(rng){return $_6vo9a4krjh8lz1do.fromDom(rng.startContainer)},relative:function(startSitu,finishSitu){return $_eviq86p2jh8lz26w.getStart(startSitu)},exact:function(start,soffset,finish,foffset){return start}})},getWin=function(selection){var start=getStart$1(selection);return $_4hc7u2ktjh8lz1dv.defaultView(start)},$_8ehldap1jh8lz26p={domRange:type$2.domRange,relative:type$2.relative,exact:type$2.exact,exactFromRange:exactFromRange,range:range$2,getWin:getWin},makeRange=function(start,soffset,finish,foffset){var doc=$_4hc7u2ktjh8lz1dv.owner(start),rng=doc.dom().createRange();return rng.setStart(start.dom(),soffset),rng.setEnd(finish.dom(),foffset),rng},commonAncestorContainer=function(start,soffset,finish,foffset){var r=makeRange(start,soffset,finish,foffset);return $_6vo9a4krjh8lz1do.fromDom(r.commonAncestorContainer)},after$2=function(start,soffset,finish,foffset){var r=makeRange(start,soffset,finish,foffset),same=$_2eywnlkvjh8lz1e8.eq(start,finish)&&soffset===foffset;return r.collapsed&&!same},$_2h2fhyp4jh8lz27b={after:after$2,commonAncestorContainer:commonAncestorContainer},fromElements=function(elements,scope){var doc=scope||document,fragment=doc.createDocumentFragment();return $_6b0spykcjh8lz1ao.each(elements,function(element){fragment.appendChild(element.dom())}),$_6vo9a4krjh8lz1do.fromDom(fragment)},$_7hriclp5jh8lz27d={fromElements:fromElements},selectNodeContents=function(win,element){var rng=win.document.createRange();return selectNodeContentsUsing(rng,element),rng},selectNodeContentsUsing=function(rng,element){rng.selectNodeContents(element.dom())},isWithin$1=function(outerRange,innerRange){return innerRange.compareBoundaryPoints(outerRange.END_TO_START,outerRange)<1&&innerRange.compareBoundaryPoints(outerRange.START_TO_END,outerRange)>-1},create$1=function(win){return win.document.createRange()},setStart=function(rng,situ){situ.fold(function(e){rng.setStartBefore(e.dom())},function(e,o){rng.setStart(e.dom(),o)},function(e){rng.setStartAfter(e.dom())})},setFinish=function(rng,situ){situ.fold(function(e){rng.setEndBefore(e.dom())},function(e,o){rng.setEnd(e.dom(),o)},function(e){rng.setEndAfter(e.dom())})},replaceWith=function(rng,fragment){deleteContents(rng),rng.insertNode(fragment.dom())},relativeToNative=function(win,startSitu,finishSitu){
var range=win.document.createRange();return setStart(range,startSitu),setFinish(range,finishSitu),range},exactToNative=function(win,start,soffset,finish,foffset){var rng=win.document.createRange();return rng.setStart(start.dom(),soffset),rng.setEnd(finish.dom(),foffset),rng},deleteContents=function(rng){rng.deleteContents()},cloneFragment=function(rng){var fragment=rng.cloneContents();return $_6vo9a4krjh8lz1do.fromDom(fragment)},toRect=function(rect){return{left:$_bgyjg9kejh8lz1ax.constant(rect.left),top:$_bgyjg9kejh8lz1ax.constant(rect.top),right:$_bgyjg9kejh8lz1ax.constant(rect.right),bottom:$_bgyjg9kejh8lz1ax.constant(rect.bottom),width:$_bgyjg9kejh8lz1ax.constant(rect.width),height:$_bgyjg9kejh8lz1ax.constant(rect.height)}},getFirstRect=function(rng){var rects=rng.getClientRects(),rect=rects.length>0?rects[0]:rng.getBoundingClientRect();return rect.width>0||rect.height>0?Option.some(rect).map(toRect):Option.none()},getBounds$1=function(rng){var rect=rng.getBoundingClientRect();return rect.width>0||rect.height>0?Option.some(rect).map(toRect):Option.none()},toString=function(rng){return rng.toString()},$_4fhpzqp6jh8lz27h={create:create$1,replaceWith:replaceWith,selectNodeContents:selectNodeContents,selectNodeContentsUsing:selectNodeContentsUsing,relativeToNative:relativeToNative,exactToNative:exactToNative,deleteContents:deleteContents,cloneFragment:cloneFragment,getFirstRect:getFirstRect,getBounds:getBounds$1,isWithin:isWithin$1,toString:toString},adt$1=$_659si2mejh8lz1n9.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),fromRange=function(win,type,range){return type($_6vo9a4krjh8lz1do.fromDom(range.startContainer),range.startOffset,$_6vo9a4krjh8lz1do.fromDom(range.endContainer),range.endOffset)},getRanges=function(win,selection){return selection.match({domRange:function(rng){return{ltr:$_bgyjg9kejh8lz1ax.constant(rng),rtl:Option.none}},relative:function(startSitu,finishSitu){return{ltr:$_aela9fl1jh8lz1es.cached(function(){return $_4fhpzqp6jh8lz27h.relativeToNative(win,startSitu,finishSitu)}),rtl:$_aela9fl1jh8lz1es.cached(function(){return Option.some($_4fhpzqp6jh8lz27h.relativeToNative(win,finishSitu,startSitu))})}},exact:function(start,soffset,finish,foffset){return{ltr:$_aela9fl1jh8lz1es.cached(function(){return $_4fhpzqp6jh8lz27h.exactToNative(win,start,soffset,finish,foffset)}),rtl:$_aela9fl1jh8lz1es.cached(function(){return Option.some($_4fhpzqp6jh8lz27h.exactToNative(win,finish,foffset,start,soffset))})}}})},doDiagnose=function(win,ranges){var rng=ranges.ltr();if(rng.collapsed){var reversed=ranges.rtl().filter(function(rev){return rev.collapsed===!1});return reversed.map(function(rev){return adt$1.rtl($_6vo9a4krjh8lz1do.fromDom(rev.endContainer),rev.endOffset,$_6vo9a4krjh8lz1do.fromDom(rev.startContainer),rev.startOffset)}).getOrThunk(function(){return fromRange(win,adt$1.ltr,rng)})}return fromRange(win,adt$1.ltr,rng)},diagnose=function(win,selection){var ranges=getRanges(win,selection);return doDiagnose(win,ranges)},asLtrRange=function(win,selection){var diagnosis=diagnose(win,selection);return diagnosis.match({ltr:function(start,soffset,finish,foffset){var rng=win.document.createRange();return rng.setStart(start.dom(),soffset),rng.setEnd(finish.dom(),foffset),rng},rtl:function(start,soffset,finish,foffset){var rng=win.document.createRange();return rng.setStart(finish.dom(),foffset),rng.setEnd(start.dom(),soffset),rng}})},$_dcfxf3p7jh8lz27p={ltr:adt$1.ltr,rtl:adt$1.rtl,diagnose:diagnose,asLtrRange:asLtrRange},searchForPoint=function(rectForOffset,x,y,maxX,length){if(0===length)return 0;if(x===maxX)return length-1;for(var xDelta=maxX,i=1;i<length;i++){var rect=rectForOffset(i),curDeltaX=Math.abs(x-rect.left);if(y>rect.bottom);else{if(y<rect.top||curDeltaX>xDelta)return i-1;xDelta=curDeltaX}}return 0},inRect=function(rect,x,y){return x>=rect.left&&x<=rect.right&&y>=rect.top&&y<=rect.bottom},$_audrxxpajh8lz28a={inRect:inRect,searchForPoint:searchForPoint},locateOffset=function(doc,textnode,x,y,rect){var rangeForOffset=function(offset){var r=doc.dom().createRange();return r.setStart(textnode.dom(),offset),r.collapse(!0),r},rectForOffset=function(offset){var r=rangeForOffset(offset);return r.getBoundingClientRect()},length=$_bri5anlujh8lz1in.get(textnode).length,offset=$_audrxxpajh8lz28a.searchForPoint(rectForOffset,x,y,rect.right,length);return rangeForOffset(offset)},locate=function(doc,node,x,y){var r=doc.dom().createRange();r.selectNode(node.dom());var rects=r.getClientRects(),foundRect=$_clgylhn2jh8lz1sg.findMap(rects,function(rect){return $_audrxxpajh8lz28a.inRect(rect,x,y)?Option.some(rect):Option.none()});return foundRect.map(function(rect){return locateOffset(doc,node,x,y,rect)})},$_g2tw93pbjh8lz28c={locate:locate},searchInChildren=function(doc,node,x,y){var r=doc.dom().createRange(),nodes=$_4hc7u2ktjh8lz1dv.children(node);return $_clgylhn2jh8lz1sg.findMap(nodes,function(n){return r.selectNode(n.dom()),$_audrxxpajh8lz28a.inRect(r.getBoundingClientRect(),x,y)?locateNode(doc,n,x,y):Option.none()})},locateNode=function(doc,node,x,y){var locator=$_a3izpgldjh8lz1fy.isText(node)?$_g2tw93pbjh8lz28c.locate:searchInChildren;return locator(doc,node,x,y)},locate$1=function(doc,node,x,y){var r=doc.dom().createRange();r.selectNode(node.dom());var rect=r.getBoundingClientRect(),boundedX=Math.max(rect.left,Math.min(rect.right,x)),boundedY=Math.max(rect.top,Math.min(rect.bottom,y));return locateNode(doc,node,boundedX,boundedY)},$_31ujrcp9jh8lz285={locate:locate$1},COLLAPSE_TO_LEFT=!0,COLLAPSE_TO_RIGHT=!1,getCollapseDirection=function(rect,x){return x-rect.left<rect.right-x?COLLAPSE_TO_LEFT:COLLAPSE_TO_RIGHT},createCollapsedNode=function(doc,target,collapseDirection){var r=doc.dom().createRange();return r.selectNode(target.dom()),r.collapse(collapseDirection),r},locateInElement=function(doc,node,x){var cursorRange=doc.dom().createRange();cursorRange.selectNode(node.dom());var rect=cursorRange.getBoundingClientRect(),collapseDirection=getCollapseDirection(rect,x),f=collapseDirection===COLLAPSE_TO_LEFT?$_fpdn73lsjh8lz1ig.first:$_fpdn73lsjh8lz1ig.last;return f(node).map(function(target){return createCollapsedNode(doc,target,collapseDirection)})},locateInEmpty=function(doc,node,x){var rect=node.dom().getBoundingClientRect(),collapseDirection=getCollapseDirection(rect,x);return Option.some(createCollapsedNode(doc,node,collapseDirection))},search=function(doc,node,x){var f=0===$_4hc7u2ktjh8lz1dv.children(node).length?locateInEmpty:locateInElement;return f(doc,node,x)},$_d2lo8npcjh8lz28i={search:search},caretPositionFromPoint=function(doc,x,y){return Option.from(doc.dom().caretPositionFromPoint(x,y)).bind(function(pos){if(null===pos.offsetNode)return Option.none();var r=doc.dom().createRange();return r.setStart(pos.offsetNode,pos.offset),r.collapse(),Option.some(r)})},caretRangeFromPoint=function(doc,x,y){return Option.from(doc.dom().caretRangeFromPoint(x,y))},searchTextNodes=function(doc,node,x,y){var r=doc.dom().createRange();r.selectNode(node.dom());var rect=r.getBoundingClientRect(),boundedX=Math.max(rect.left,Math.min(rect.right,x)),boundedY=Math.max(rect.top,Math.min(rect.bottom,y));return $_31ujrcp9jh8lz285.locate(doc,node,boundedX,boundedY)},searchFromPoint=function(doc,x,y){return $_6vo9a4krjh8lz1do.fromPoint(doc,x,y).bind(function(elem){var fallback=function(){return $_d2lo8npcjh8lz28i.search(doc,elem,x)};return 0===$_4hc7u2ktjh8lz1dv.children(elem).length?fallback():searchTextNodes(doc,elem,x,y).orThunk(fallback)})},availableSearch=document.caretPositionFromPoint?caretPositionFromPoint:document.caretRangeFromPoint?caretRangeFromPoint:searchFromPoint,fromPoint$1=function(win,x,y){var doc=$_6vo9a4krjh8lz1do.fromDom(win.document);return availableSearch(doc,x,y).map(function(rng){return $_8ehldap1jh8lz26p.range($_6vo9a4krjh8lz1do.fromDom(rng.startContainer),rng.startOffset,$_6vo9a4krjh8lz1do.fromDom(rng.endContainer),rng.endOffset)})},$_27o8otp8jh8lz27z={fromPoint:fromPoint$1},withinContainer=function(win,ancestor,outerRange,selector){var innerRange=$_4fhpzqp6jh8lz27h.create(win),self=$_62so4qkqjh8lz1di.is(ancestor,selector)?[ancestor]:[],elements=self.concat($_coxlualejh8lz1fz.descendants(ancestor,selector));return $_6b0spykcjh8lz1ao.filter(elements,function(elem){return $_4fhpzqp6jh8lz27h.selectNodeContentsUsing(innerRange,elem),$_4fhpzqp6jh8lz27h.isWithin(outerRange,innerRange)})},find$3=function(win,selection,selector){var outerRange=$_dcfxf3p7jh8lz27p.asLtrRange(win,selection),ancestor=$_6vo9a4krjh8lz1do.fromDom(outerRange.commonAncestorContainer);return $_a3izpgldjh8lz1fy.isElement(ancestor)?withinContainer(win,ancestor,outerRange,selector):[]},$_fia266pdjh8lz28m={find:find$3},beforeSpecial=function(element,offset){var name=$_a3izpgldjh8lz1fy.name(element);return"input"===name?$_eviq86p2jh8lz26w.after(element):$_6b0spykcjh8lz1ao.contains(["br","img"],name)?0===offset?$_eviq86p2jh8lz26w.before(element):$_eviq86p2jh8lz26w.after(element):$_eviq86p2jh8lz26w.on(element,offset)},preprocessRelative=function(startSitu,finishSitu){var start=startSitu.fold($_eviq86p2jh8lz26w.before,beforeSpecial,$_eviq86p2jh8lz26w.after),finish=finishSitu.fold($_eviq86p2jh8lz26w.before,beforeSpecial,$_eviq86p2jh8lz26w.after);return $_8ehldap1jh8lz26p.relative(start,finish)},preprocessExact=function(start,soffset,finish,foffset){var startSitu=beforeSpecial(start,soffset),finishSitu=beforeSpecial(finish,foffset);return $_8ehldap1jh8lz26p.relative(startSitu,finishSitu)},preprocess=function(selection){return selection.match({domRange:function(rng){var start=$_6vo9a4krjh8lz1do.fromDom(rng.startContainer),finish=$_6vo9a4krjh8lz1do.fromDom(rng.endContainer);return preprocessExact(start,rng.startOffset,finish,rng.endOffset)},relative:preprocessRelative,exact:preprocessExact})},$_dvaskhpejh8lz28q={beforeSpecial:beforeSpecial,preprocess:preprocess,preprocessRelative:preprocessRelative,preprocessExact:preprocessExact},doSetNativeRange=function(win,rng){Option.from(win.getSelection()).each(function(selection){selection.removeAllRanges(),selection.addRange(rng)})},doSetRange=function(win,start,soffset,finish,foffset){var rng=$_4fhpzqp6jh8lz27h.exactToNative(win,start,soffset,finish,foffset);doSetNativeRange(win,rng)},findWithin=function(win,selection,selector){return $_fia266pdjh8lz28m.find(win,selection,selector)},setRangeFromRelative=function(win,relative){return $_dcfxf3p7jh8lz27p.diagnose(win,relative).match({ltr:function(start,soffset,finish,foffset){doSetRange(win,start,soffset,finish,foffset)},rtl:function(start,soffset,finish,foffset){var selection=win.getSelection();selection.setBaseAndExtent?selection.setBaseAndExtent(start.dom(),soffset,finish.dom(),foffset):selection.extend?(selection.collapse(start.dom(),soffset),selection.extend(finish.dom(),foffset)):doSetRange(win,finish,foffset,start,soffset)}})},setExact=function(win,start,soffset,finish,foffset){var relative=$_dvaskhpejh8lz28q.preprocessExact(start,soffset,finish,foffset);setRangeFromRelative(win,relative)},setRelative=function(win,startSitu,finishSitu){var relative=$_dvaskhpejh8lz28q.preprocessRelative(startSitu,finishSitu);setRangeFromRelative(win,relative)},toNative=function(selection){var win=$_8ehldap1jh8lz26p.getWin(selection).dom(),getDomRange=function(start,soffset,finish,foffset){return $_4fhpzqp6jh8lz27h.exactToNative(win,start,soffset,finish,foffset)},filtered=$_dvaskhpejh8lz28q.preprocess(selection);return $_dcfxf3p7jh8lz27p.diagnose(win,filtered).match({ltr:getDomRange,rtl:getDomRange})},readRange=function(selection){if(selection.rangeCount>0){var firstRng=selection.getRangeAt(0),lastRng=selection.getRangeAt(selection.rangeCount-1);return Option.some($_8ehldap1jh8lz26p.range($_6vo9a4krjh8lz1do.fromDom(firstRng.startContainer),firstRng.startOffset,$_6vo9a4krjh8lz1do.fromDom(lastRng.endContainer),lastRng.endOffset))}return Option.none()},doGetExact=function(selection){var anchorNode=$_6vo9a4krjh8lz1do.fromDom(selection.anchorNode),focusNode=$_6vo9a4krjh8lz1do.fromDom(selection.focusNode);return $_2h2fhyp4jh8lz27b.after(anchorNode,selection.anchorOffset,focusNode,selection.focusOffset)?Option.some($_8ehldap1jh8lz26p.range($_6vo9a4krjh8lz1do.fromDom(selection.anchorNode),selection.anchorOffset,$_6vo9a4krjh8lz1do.fromDom(selection.focusNode),selection.focusOffset)):readRange(selection)},setToElement=function(win,element){var rng=$_4fhpzqp6jh8lz27h.selectNodeContents(win,element);doSetNativeRange(win,rng)},forElement=function(win,element){var rng=$_4fhpzqp6jh8lz27h.selectNodeContents(win,element);return $_8ehldap1jh8lz26p.range($_6vo9a4krjh8lz1do.fromDom(rng.startContainer),rng.startOffset,$_6vo9a4krjh8lz1do.fromDom(rng.endContainer),rng.endOffset)},getExact=function(win){return Option.from(win.getSelection()).filter(function(sel){return sel.rangeCount>0}).bind(doGetExact)},get$9=function(win){return getExact(win).map(function(range){return $_8ehldap1jh8lz26p.exact(range.start(),range.soffset(),range.finish(),range.foffset())})},getFirstRect$1=function(win,selection){var rng=$_dcfxf3p7jh8lz27p.asLtrRange(win,selection);return $_4fhpzqp6jh8lz27h.getFirstRect(rng)},getBounds$2=function(win,selection){var rng=$_dcfxf3p7jh8lz27p.asLtrRange(win,selection);return $_4fhpzqp6jh8lz27h.getBounds(rng)},getAtPoint=function(win,x,y){return $_27o8otp8jh8lz27z.fromPoint(win,x,y)},getAsString=function(win,selection){var rng=$_dcfxf3p7jh8lz27p.asLtrRange(win,selection);return $_4fhpzqp6jh8lz27h.toString(rng)},clear$1=function(win){var selection=win.getSelection();selection.removeAllRanges()},clone$2=function(win,selection){var rng=$_dcfxf3p7jh8lz27p.asLtrRange(win,selection);return $_4fhpzqp6jh8lz27h.cloneFragment(rng)},replace$1=function(win,selection,elements){var rng=$_dcfxf3p7jh8lz27p.asLtrRange(win,selection),fragment=$_7hriclp5jh8lz27d.fromElements(elements,win.document);$_4fhpzqp6jh8lz27h.replaceWith(rng,fragment)},deleteAt=function(win,selection){var rng=$_dcfxf3p7jh8lz27p.asLtrRange(win,selection);$_4fhpzqp6jh8lz27h.deleteContents(rng)},isCollapsed=function(start,soffset,finish,foffset){return $_2eywnlkvjh8lz1e8.eq(start,finish)&&soffset===foffset},$_3efg7cp3jh8lz272={setExact:setExact,getExact:getExact,get:get$9,setRelative:setRelative,toNative:toNative,setToElement:setToElement,clear:clear$1,clone:clone$2,replace:replace$1,deleteAt:deleteAt,forElement:forElement,getFirstRect:getFirstRect$1,getBounds:getBounds$2,getAtPoint:getAtPoint,findWithin:findWithin,getAsString:getAsString,isCollapsed:isCollapsed},global$4=tinymce.util.Tools.resolve("tinymce.util.VK"),forward=function(editor,isRoot,cell,lazyWire){return go(editor,isRoot,$_4luh0iozjh8lz26g.next(cell),lazyWire)},backward=function(editor,isRoot,cell,lazyWire){return go(editor,isRoot,$_4luh0iozjh8lz26g.prev(cell),lazyWire)},getCellFirstCursorPosition=function(editor,cell){var selection=$_8ehldap1jh8lz26p.exact(cell,0,cell,0);return $_3efg7cp3jh8lz272.toNative(selection)},getNewRowCursorPosition=function(editor,table){var rows=$_coxlualejh8lz1fz.descendants(table,"tr");return $_6b0spykcjh8lz1ao.last(rows).bind(function(last){return $_fiygddlhjh8lz1g7.descendant(last,"td,th").map(function(first){return getCellFirstCursorPosition(editor,first)})})},go=function(editor,isRoot,cell,actions,lazyWire){return cell.fold(Option.none,Option.none,function(current,next){return $_fpdn73lsjh8lz1ig.first(next).map(function(cell){return getCellFirstCursorPosition(editor,cell)})},function(current){return $_ee8pmfkojh8lz1ch.table(current,isRoot).bind(function(table){var targets=$_3xfj7olxjh8lz1j2.noMenu(current);return editor.undoManager.transact(function(){actions.insertRowsAfter(table,targets)}),getNewRowCursorPosition(editor,table)})})},rootElements=["table","li","dl"],handle$1=function(event,editor,actions,lazyWire){if(event.keyCode===global$4.TAB){var body_1=getBody$1(editor),isRoot_1=function(element){var name=$_a3izpgldjh8lz1fy.name(element);return $_2eywnlkvjh8lz1e8.eq(element,body_1)||$_6b0spykcjh8lz1ao.contains(rootElements,name)},rng=editor.selection.getRng();if(rng.collapsed){var start=$_6vo9a4krjh8lz1do.fromDom(rng.startContainer);$_ee8pmfkojh8lz1ch.cell(start,isRoot_1).each(function(cell){event.preventDefault();var navigation=event.shiftKey?backward:forward,rng=navigation(editor,isRoot_1,cell,actions,lazyWire);rng.each(function(range){editor.selection.setRng(range)})})}}},$_4jcvbhoyjh8lz25x={handle:handle$1},response=$_d2ojjnkijh8lz1bv.immutable("selection","kill"),$_8xnxafpijh8lz29y={response:response},isKey=function(key){return function(keycode){return keycode===key}},isUp=isKey(38),isDown=isKey(40),isNavigation=function(keycode){return keycode>=37&&keycode<=40},$_5bctktpjjh8lz2a1={ltr:{isBackward:isKey(37),isForward:isKey(39)},rtl:{isBackward:isKey(39),isForward:isKey(37)},isUp:isUp,isDown:isDown,isNavigation:isNavigation},convertToRange=function(win,selection){var rng=$_dcfxf3p7jh8lz27p.asLtrRange(win,selection);return{start:$_bgyjg9kejh8lz1ax.constant($_6vo9a4krjh8lz1do.fromDom(rng.startContainer)),soffset:$_bgyjg9kejh8lz1ax.constant(rng.startOffset),finish:$_bgyjg9kejh8lz1ax.constant($_6vo9a4krjh8lz1do.fromDom(rng.endContainer)),foffset:$_bgyjg9kejh8lz1ax.constant(rng.endOffset)}},makeSitus=function(start,soffset,finish,foffset){return{start:$_bgyjg9kejh8lz1ax.constant($_eviq86p2jh8lz26w.on(start,soffset)),finish:$_bgyjg9kejh8lz1ax.constant($_eviq86p2jh8lz26w.on(finish,foffset))}},$_45u5rqpljh8lz2ah={convertToRange:convertToRange,makeSitus:makeSitus},isSafari=$_a6om0dl0jh8lz1ep.detect().browser.isSafari(),get$10=function(_doc){var doc=void 0!==_doc?_doc.dom():document,x=doc.body.scrollLeft||doc.documentElement.scrollLeft,y=doc.body.scrollTop||doc.documentElement.scrollTop;return r(x,y)},to=function(x,y,_doc){var doc=void 0!==_doc?_doc.dom():document,win=doc.defaultView;win.scrollTo(x,y)},by=function(x,y,_doc){var doc=void 0!==_doc?_doc.dom():document,win=doc.defaultView;win.scrollBy(x,y)},setToElement$1=function(win,element){var pos=$_6xc5idmpjh8lz1ph.absolute(element),doc=$_6vo9a4krjh8lz1do.fromDom(win.document);to(pos.left(),pos.top(),doc)},preserve$1=function(doc,f){var before=get$10(doc);f();var after=get$10(doc);before.top()===after.top()&&before.left()===after.left()||to(before.left(),before.top(),doc)},capture$2=function(doc){var previous=Option.none(),save=function(){previous=Option.some(get$10(doc))},restore=function(){previous.each(function(p){to(p.left(),p.top(),doc)})};return save(),{save:save,restore:restore}},intoView=function(element,alignToTop){isSafari&&$_d1kyz8kfjh8lz1az.isFunction(element.dom().scrollIntoViewIfNeeded)?element.dom().scrollIntoViewIfNeeded(!1):element.dom().scrollIntoView(alignToTop)},intoViewIfNeeded=function(element,container){var containerBox=container.dom().getBoundingClientRect(),elementBox=element.dom().getBoundingClientRect();elementBox.top<containerBox.top?intoView(element,!0):elementBox.bottom>containerBox.bottom&&intoView(element,!1)},scrollBarWidth=function(){var scrollDiv=$_6vo9a4krjh8lz1do.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');$_6qqu1alnjh8lz1hg.after($_brbde9lgjh8lz1g4.body(),scrollDiv);var w=scrollDiv.dom().offsetWidth-scrollDiv.dom().clientWidth;return $_f2hny0lojh8lz1hi.remove(scrollDiv),w},$_d8doq8pmjh8lz2ay={get:get$10,to:to,by:by,preserve:preserve$1,capture:capture$2,intoView:intoView,intoViewIfNeeded:intoViewIfNeeded,setToElement:setToElement$1,scrollBarWidth:scrollBarWidth},sync=function(container,isRoot,start,soffset,finish,foffset,selectRange){return $_2eywnlkvjh8lz1e8.eq(start,finish)&&soffset===foffset?Option.none():$_fiygddlhjh8lz1g7.closest(start,"td,th",isRoot).bind(function(s){return $_fiygddlhjh8lz1g7.closest(finish,"td,th",isRoot).bind(function(f){return detect$5(container,isRoot,s,f,selectRange)})})},detect$5=function(container,isRoot,start,finish,selectRange){return $_2eywnlkvjh8lz1e8.eq(start,finish)?Option.none():$_5tpv0tm0jh8lz1jt.identify(start,finish,isRoot).bind(function(cellSel){var boxes=cellSel.boxes().getOr([]);return boxes.length>0?(selectRange(container,boxes,cellSel.start(),cellSel.finish()),Option.some($_8xnxafpijh8lz29y.response(Option.some($_45u5rqpljh8lz2ah.makeSitus(start,0,start,$_6759o9ltjh8lz1ij.getEnd(start))),!0))):Option.none()})},update=function(rows,columns,container,selected,annotations){var updateSelection=function(newSels){return annotations.clear(container),annotations.selectRange(container,newSels.boxes(),newSels.start(),newSels.finish()),newSels.boxes()};return $_5tpv0tm0jh8lz1jt.shiftSelection(selected,rows,columns,annotations.firstSelectedSelector(),annotations.lastSelectedSelector()).map(updateSelection)},$_2hlk4dpnjh8lz2b8={sync:sync,detect:detect$5,update:update},nu$3=$_d2ojjnkijh8lz1bv.immutableBag(["left","top","right","bottom"],[]),moveDown=function(caret,amount){return nu$3({left:caret.left(),top:caret.top()+amount,right:caret.right(),bottom:caret.bottom()+amount})},moveUp=function(caret,amount){return nu$3({left:caret.left(),top:caret.top()-amount,right:caret.right(),bottom:caret.bottom()-amount})},moveBottomTo=function(caret,bottom){var height=caret.bottom()-caret.top();return nu$3({left:caret.left(),top:bottom-height,right:caret.right(),bottom:bottom})},moveTopTo=function(caret,top){var height=caret.bottom()-caret.top();return nu$3({left:caret.left(),top:top,right:caret.right(),bottom:top+height})},translate=function(caret,xDelta,yDelta){return nu$3({left:caret.left()+xDelta,top:caret.top()+yDelta,right:caret.right()+xDelta,bottom:caret.bottom()+yDelta})},getTop$1=function(caret){return caret.top()},getBottom=function(caret){return caret.bottom()},toString$1=function(caret){return"("+caret.left()+", "+caret.top()+") -> ("+caret.right()+", "+caret.bottom()+")"},$_8hoedhpqjh8lz2ck={nu:nu$3,moveUp:moveUp,moveDown:moveDown,moveBottomTo:moveBottomTo,moveTopTo:moveTopTo,getTop:getTop$1,getBottom:getBottom,translate:translate,toString:toString$1},getPartialBox=function(bridge,element,offset){return offset>=0&&offset<$_6759o9ltjh8lz1ij.getEnd(element)?bridge.getRangedRect(element,offset,element,offset+1):offset>0?bridge.getRangedRect(element,offset-1,element,offset):Option.none()},toCaret=function(rect){return $_8hoedhpqjh8lz2ck.nu({left:rect.left,top:rect.top,right:rect.right,bottom:rect.bottom})},getElemBox=function(bridge,element){return Option.some(bridge.getRect(element))},getBoxAt=function(bridge,element,offset){return $_a3izpgldjh8lz1fy.isElement(element)?getElemBox(bridge,element).map(toCaret):$_a3izpgldjh8lz1fy.isText(element)?getPartialBox(bridge,element,offset).map(toCaret):Option.none()},getEntireBox=function(bridge,element){return $_a3izpgldjh8lz1fy.isElement(element)?getElemBox(bridge,element).map(toCaret):$_a3izpgldjh8lz1fy.isText(element)?bridge.getRangedRect(element,0,element,$_6759o9ltjh8lz1ij.getEnd(element)).map(toCaret):Option.none()},$_8dyzo9prjh8lz2ct={getBoxAt:getBoxAt,getEntireBox:getEntireBox},traverse=$_d2ojjnkijh8lz1bv.immutable("item","mode"),backtrack=function(universe,item,direction,_transition){var transition=void 0!==_transition?_transition:sidestep;return universe.property().parent(item).map(function(p){return traverse(p,transition)})},sidestep=function(universe,item,direction,_transition){var transition=void 0!==_transition?_transition:advance;return direction.sibling(universe,item).map(function(p){return traverse(p,transition)})},advance=function(universe,item,direction,_transition){var transition=void 0!==_transition?_transition:advance,children=universe.property().children(item),result=direction.first(children);return result.map(function(r){return traverse(r,transition)})},successors=[{current:backtrack,next:sidestep,fallback:Option.none()},{current:sidestep,next:advance,fallback:Option.some(backtrack)},{current:advance,next:advance,fallback:Option.some(sidestep)}],go$1=function(universe,item,mode,direction,rules){var rules=void 0!==rules?rules:successors,ruleOpt=$_6b0spykcjh8lz1ao.find(rules,function(succ){return succ.current===mode});return ruleOpt.bind(function(rule){return rule.current(universe,item,direction,rule.next).orThunk(function(){return rule.fallback.bind(function(fb){return go$1(universe,item,fb,direction)})})})},$_5v9bytpwjh8lz2dx={backtrack:backtrack,sidestep:sidestep,advance:advance,go:go$1},left$1=function(){var sibling=function(universe,item){return universe.query().prevSibling(item)},first=function(children){return children.length>0?Option.some(children[children.length-1]):Option.none()};return{sibling:sibling,first:first}},right$1=function(){var sibling=function(universe,item){return universe.query().nextSibling(item)},first=function(children){return children.length>0?Option.some(children[0]):Option.none()};return{sibling:sibling,first:first}},$_6gybyapxjh8lz2e5={left:left$1,right:right$1},hone=function(universe,item,predicate,mode,direction,isRoot){var next=$_5v9bytpwjh8lz2dx.go(universe,item,mode,direction);return next.bind(function(n){return isRoot(n.item())?Option.none():predicate(n.item())?Option.some(n.item()):hone(universe,n.item(),predicate,n.mode(),direction,isRoot)})},left$2=function(universe,item,predicate,isRoot){return hone(universe,item,predicate,$_5v9bytpwjh8lz2dx.sidestep,$_6gybyapxjh8lz2e5.left(),isRoot)},right$2=function(universe,item,predicate,isRoot){return hone(universe,item,predicate,$_5v9bytpwjh8lz2dx.sidestep,$_6gybyapxjh8lz2e5.right(),isRoot)},$_fjuczcpvjh8lz2ds={left:left$2,right:right$2},isLeaf=function(universe,element){return 0===universe.property().children(element).length},before$2=function(universe,item,isRoot){return seekLeft(universe,item,$_bgyjg9kejh8lz1ax.curry(isLeaf,universe),isRoot)},after$3=function(universe,item,isRoot){return seekRight(universe,item,$_bgyjg9kejh8lz1ax.curry(isLeaf,universe),isRoot)},seekLeft=function(universe,item,predicate,isRoot){return $_fjuczcpvjh8lz2ds.left(universe,item,predicate,isRoot)},seekRight=function(universe,item,predicate,isRoot){return $_fjuczcpvjh8lz2ds.right(universe,item,predicate,isRoot)},walkers=function(){return{left:$_6gybyapxjh8lz2e5.left,right:$_6gybyapxjh8lz2e5.right}},walk=function(universe,item,mode,direction,_rules){return $_5v9bytpwjh8lz2dx.go(universe,item,mode,direction,_rules)},$_5k1owupujh8lz2do={before:before$2,after:after$3,seekLeft:seekLeft,seekRight:seekRight,walkers:walkers,walk:walk,backtrack:$_5v9bytpwjh8lz2dx.backtrack,sidestep:$_5v9bytpwjh8lz2dx.sidestep,advance:$_5v9bytpwjh8lz2dx.advance},universe$2=DomUniverse(),gather=function(element,prune,transform){return $_5k1owupujh8lz2do.gather(universe$2,element,prune,transform)},before$3=function(element,isRoot){return $_5k1owupujh8lz2do.before(universe$2,element,isRoot)},after$4=function(element,isRoot){return $_5k1owupujh8lz2do.after(universe$2,element,isRoot)},seekLeft$1=function(element,predicate,isRoot){return $_5k1owupujh8lz2do.seekLeft(universe$2,element,predicate,isRoot)},seekRight$1=function(element,predicate,isRoot){return $_5k1owupujh8lz2do.seekRight(universe$2,element,predicate,isRoot)},walkers$1=function(){return $_5k1owupujh8lz2do.walkers()},walk$1=function(item,mode,direction,_rules){return $_5k1owupujh8lz2do.walk(universe$2,item,mode,direction,_rules)},$_fayc8dptjh8lz2dk={gather:gather,before:before$3,after:after$4,seekLeft:seekLeft$1,seekRight:seekRight$1,walkers:walkers$1,walk:walk$1},JUMP_SIZE=5,NUM_RETRIES=100,adt$2=$_659si2mejh8lz1n9.generate([{none:[]},{retry:["caret"]}]),isOutside=function(caret,box){return caret.left()<box.left()||Math.abs(box.right()-caret.left())<1||caret.left()>box.right()},inOutsideBlock=function(bridge,element,caret){return $_aykj0glijh8lz1g9.closest(element,$_39l7z3myjh8lz1rk.isBlock).fold($_bgyjg9kejh8lz1ax.constant(!1),function(cell){return $_8dyzo9prjh8lz2ct.getEntireBox(bridge,cell).exists(function(box){return isOutside(caret,box)})})},adjustDown=function(bridge,element,guessBox,original,caret){var lowerCaret=$_8hoedhpqjh8lz2ck.moveDown(caret,JUMP_SIZE);return Math.abs(guessBox.bottom()-original.bottom())<1?adt$2.retry(lowerCaret):guessBox.top()>caret.bottom()?adt$2.retry(lowerCaret):guessBox.top()===caret.bottom()?adt$2.retry($_8hoedhpqjh8lz2ck.moveDown(caret,1)):inOutsideBlock(bridge,element,caret)?adt$2.retry($_8hoedhpqjh8lz2ck.translate(lowerCaret,JUMP_SIZE,0)):adt$2.none()},adjustUp=function(bridge,element,guessBox,original,caret){var higherCaret=$_8hoedhpqjh8lz2ck.moveUp(caret,JUMP_SIZE);return Math.abs(guessBox.top()-original.top())<1?adt$2.retry(higherCaret):guessBox.bottom()<caret.top()?adt$2.retry(higherCaret):guessBox.bottom()===caret.top()?adt$2.retry($_8hoedhpqjh8lz2ck.moveUp(caret,1)):inOutsideBlock(bridge,element,caret)?adt$2.retry($_8hoedhpqjh8lz2ck.translate(higherCaret,JUMP_SIZE,0)):adt$2.none()},upMovement={point:$_8hoedhpqjh8lz2ck.getTop,adjuster:adjustUp,move:$_8hoedhpqjh8lz2ck.moveUp,gather:$_fayc8dptjh8lz2dk.before},downMovement={point:$_8hoedhpqjh8lz2ck.getBottom,adjuster:adjustDown,move:$_8hoedhpqjh8lz2ck.moveDown,gather:$_fayc8dptjh8lz2dk.after},isAtTable=function(bridge,x,y){return bridge.elementFromPoint(x,y).filter(function(elm){return"table"===$_a3izpgldjh8lz1fy.name(elm)}).isSome()},adjustForTable=function(bridge,movement,original,caret,numRetries){return adjustTil(bridge,movement,original,movement.move(caret,JUMP_SIZE),numRetries)},adjustTil=function(bridge,movement,original,caret,numRetries){return 0===numRetries?Option.some(caret):isAtTable(bridge,caret.left(),movement.point(caret))?adjustForTable(bridge,movement,original,caret,numRetries-1):bridge.situsFromPoint(caret.left(),movement.point(caret)).bind(function(guess){return guess.start().fold(Option.none,function(element,offset){return $_8dyzo9prjh8lz2ct.getEntireBox(bridge,element,offset).bind(function(guessBox){return movement.adjuster(bridge,element,guessBox,original,caret).fold(Option.none,function(newCaret){return adjustTil(bridge,movement,original,newCaret,numRetries-1)})}).orThunk(function(){return Option.some(caret)})},Option.none)})},ieTryDown=function(bridge,caret){return bridge.situsFromPoint(caret.left(),caret.bottom()+JUMP_SIZE)},ieTryUp=function(bridge,caret){return bridge.situsFromPoint(caret.left(),caret.top()-JUMP_SIZE)},checkScroll=function(movement,adjusted,bridge){return movement.point(adjusted)>bridge.getInnerHeight()?Option.some(movement.point(adjusted)-bridge.getInnerHeight()):movement.point(adjusted)<0?Option.some(-movement.point(adjusted)):Option.none()},retry=function(movement,bridge,caret){var moved=movement.move(caret,JUMP_SIZE),adjusted=adjustTil(bridge,movement,caret,moved,NUM_RETRIES).getOr(moved);return checkScroll(movement,adjusted,bridge).fold(function(){return bridge.situsFromPoint(adjusted.left(),movement.point(adjusted))},function(delta){return bridge.scrollBy(0,delta),bridge.situsFromPoint(adjusted.left(),movement.point(adjusted)-delta)})},$_djarwopsjh8lz2d1={tryUp:$_bgyjg9kejh8lz1ax.curry(retry,upMovement),tryDown:$_bgyjg9kejh8lz1ax.curry(retry,downMovement),ieTryUp:ieTryUp,ieTryDown:ieTryDown,getJumpSize:$_bgyjg9kejh8lz1ax.constant(JUMP_SIZE)},adt$3=$_659si2mejh8lz1n9.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),isOverlapping=function(bridge,before,after){var beforeBounds=bridge.getRect(before),afterBounds=bridge.getRect(after);return afterBounds.right>beforeBounds.left&&afterBounds.left<beforeBounds.right},verify=function(bridge,before,beforeOffset,after,afterOffset,failure,isRoot){return $_fiygddlhjh8lz1g7.closest(after,"td,th",isRoot).bind(function(afterCell){return $_fiygddlhjh8lz1g7.closest(before,"td,th",isRoot).map(function(beforeCell){return $_2eywnlkvjh8lz1e8.eq(afterCell,beforeCell)?$_2eywnlkvjh8lz1e8.eq(after,afterCell)&&$_6759o9ltjh8lz1ij.getEnd(afterCell)===afterOffset?failure(beforeCell):adt$3.none("in same cell"):$_5glne7m1jh8lz1kg.sharedOne(isRow,[afterCell,beforeCell]).fold(function(){return isOverlapping(bridge,beforeCell,afterCell)?adt$3.success():failure(beforeCell)},function(sharedRow){return failure(beforeCell)})})}).getOr(adt$3.none("default"))},isRow=function(elem){return $_fiygddlhjh8lz1g7.closest(elem,"tr")},cata$2=function(subject,onNone,onSuccess,onFailedUp,onFailedDown){
return subject.fold(onNone,onSuccess,onFailedUp,onFailedDown)},$_9gwioapyjh8lz2ea={verify:verify,cata:cata$2,adt:adt$3},point=$_d2ojjnkijh8lz1bv.immutable("element","offset"),delta=$_d2ojjnkijh8lz1bv.immutable("element","deltaOffset"),range$3=$_d2ojjnkijh8lz1bv.immutable("element","start","finish"),points=$_d2ojjnkijh8lz1bv.immutable("begin","end"),text=$_d2ojjnkijh8lz1bv.immutable("element","text"),$_6wu737q0jh8lz2f9={point:point,delta:delta,range:range$3,points:points,text:text},inAncestor=$_d2ojjnkijh8lz1bv.immutable("ancestor","descendants","element","index"),inParent=$_d2ojjnkijh8lz1bv.immutable("parent","children","element","index"),childOf=function(element,ancestor){return $_aykj0glijh8lz1g9.closest(element,function(elem){return $_4hc7u2ktjh8lz1dv.parent(elem).exists(function(parent){return $_2eywnlkvjh8lz1e8.eq(parent,ancestor)})})},indexInParent=function(element){return $_4hc7u2ktjh8lz1dv.parent(element).bind(function(parent){var children=$_4hc7u2ktjh8lz1dv.children(parent);return indexOf$1(children,element).map(function(index){return inParent(parent,children,element,index)})})},indexOf$1=function(elements,element){return $_6b0spykcjh8lz1ao.findIndex(elements,$_bgyjg9kejh8lz1ax.curry($_2eywnlkvjh8lz1e8.eq,element))},selectorsInParent=function(element,selector){return $_4hc7u2ktjh8lz1dv.parent(element).bind(function(parent){var children=$_coxlualejh8lz1fz.children(parent,selector);return indexOf$1(children,element).map(function(index){return inParent(parent,children,element,index)})})},descendantsInAncestor=function(element,ancestorSelector,descendantSelector){return $_fiygddlhjh8lz1g7.closest(element,ancestorSelector).bind(function(ancestor){var descendants=$_coxlualejh8lz1fz.descendants(ancestor,descendantSelector);return indexOf$1(descendants,element).map(function(index){return inAncestor(ancestor,descendants,element,index)})})},$_1jwctkq1jh8lz2fd={childOf:childOf,indexOf:indexOf$1,indexInParent:indexInParent,selectorsInParent:selectorsInParent,descendantsInAncestor:descendantsInAncestor},isBr=function(elem){return"br"===$_a3izpgldjh8lz1fy.name(elem)},gatherer=function(cand,gather,isRoot){return gather(cand,isRoot).bind(function(target){return $_a3izpgldjh8lz1fy.isText(target)&&0===$_bri5anlujh8lz1in.get(target).trim().length?gatherer(target,gather,isRoot):Option.some(target)})},handleBr=function(isRoot,element,direction){return direction.traverse(element).orThunk(function(){return gatherer(element,direction.gather,isRoot)}).map(direction.relative)},findBr=function(element,offset){return $_4hc7u2ktjh8lz1dv.child(element,offset).filter(isBr).orThunk(function(){return $_4hc7u2ktjh8lz1dv.child(element,offset-1).filter(isBr)})},handleParent=function(isRoot,element,offset,direction){return findBr(element,offset).bind(function(br){return direction.traverse(br).fold(function(){return gatherer(br,direction.gather,isRoot).map(direction.relative)},function(adjacent){return $_1jwctkq1jh8lz2fd.indexInParent(adjacent).map(function(info){return $_eviq86p2jh8lz26w.on(info.parent(),info.index())})})})},tryBr=function(isRoot,element,offset,direction){var target=isBr(element)?handleBr(isRoot,element,direction):handleParent(isRoot,element,offset,direction);return target.map(function(tgt){return{start:$_bgyjg9kejh8lz1ax.constant(tgt),finish:$_bgyjg9kejh8lz1ax.constant(tgt)}})},process=function(analysis){return $_9gwioapyjh8lz2ea.cata(analysis,function(message){return Option.none()},function(){return Option.none()},function(cell){return Option.some($_6wu737q0jh8lz2f9.point(cell,0))},function(cell){return Option.some($_6wu737q0jh8lz2f9.point(cell,$_6759o9ltjh8lz1ij.getEnd(cell)))})},$_fdx5vppzjh8lz2eq={tryBr:tryBr,process:process},MAX_RETRIES=20,platform$1=$_a6om0dl0jh8lz1ep.detect(),findSpot=function(bridge,isRoot,direction){return bridge.getSelection().bind(function(sel){return $_fdx5vppzjh8lz2eq.tryBr(isRoot,sel.finish(),sel.foffset(),direction).fold(function(){return Option.some($_6wu737q0jh8lz2f9.point(sel.finish(),sel.foffset()))},function(brNeighbour){var range=bridge.fromSitus(brNeighbour),analysis=$_9gwioapyjh8lz2ea.verify(bridge,sel.finish(),sel.foffset(),range.finish(),range.foffset(),direction.failure,isRoot);return $_fdx5vppzjh8lz2eq.process(analysis)})})},scan=function(bridge,isRoot,element,offset,direction,numRetries){return 0===numRetries?Option.none():tryCursor(bridge,isRoot,element,offset,direction).bind(function(situs){var range=bridge.fromSitus(situs),analysis=$_9gwioapyjh8lz2ea.verify(bridge,element,offset,range.finish(),range.foffset(),direction.failure,isRoot);return $_9gwioapyjh8lz2ea.cata(analysis,function(){return Option.none()},function(){return Option.some(situs)},function(cell){return $_2eywnlkvjh8lz1e8.eq(element,cell)&&0===offset?tryAgain(bridge,element,offset,$_8hoedhpqjh8lz2ck.moveUp,direction):scan(bridge,isRoot,cell,0,direction,numRetries-1)},function(cell){return $_2eywnlkvjh8lz1e8.eq(element,cell)&&offset===$_6759o9ltjh8lz1ij.getEnd(cell)?tryAgain(bridge,element,offset,$_8hoedhpqjh8lz2ck.moveDown,direction):scan(bridge,isRoot,cell,$_6759o9ltjh8lz1ij.getEnd(cell),direction,numRetries-1)})})},tryAgain=function(bridge,element,offset,move,direction){return $_8dyzo9prjh8lz2ct.getBoxAt(bridge,element,offset).bind(function(box){return tryAt(bridge,direction,move(box,$_djarwopsjh8lz2d1.getJumpSize()))})},tryAt=function(bridge,direction,box){return platform$1.browser.isChrome()||platform$1.browser.isSafari()||platform$1.browser.isFirefox()||platform$1.browser.isEdge()?direction.otherRetry(bridge,box):platform$1.browser.isIE()?direction.ieRetry(bridge,box):Option.none()},tryCursor=function(bridge,isRoot,element,offset,direction){return $_8dyzo9prjh8lz2ct.getBoxAt(bridge,element,offset).bind(function(box){return tryAt(bridge,direction,box)})},handle$2=function(bridge,isRoot,direction){return findSpot(bridge,isRoot,direction).bind(function(spot){return scan(bridge,isRoot,spot.element(),spot.offset(),direction,MAX_RETRIES).map(bridge.fromSitus)})},$_3ywvn5ppjh8lz2c7={handle:handle$2},any$1=function(predicate){return $_aykj0glijh8lz1g9.first(predicate).isSome()},ancestor$3=function(scope,predicate,isRoot){return $_aykj0glijh8lz1g9.ancestor(scope,predicate,isRoot).isSome()},closest$3=function(scope,predicate,isRoot){return $_aykj0glijh8lz1g9.closest(scope,predicate,isRoot).isSome()},sibling$3=function(scope,predicate){return $_aykj0glijh8lz1g9.sibling(scope,predicate).isSome()},child$4=function(scope,predicate){return $_aykj0glijh8lz1g9.child(scope,predicate).isSome()},descendant$3=function(scope,predicate){return $_aykj0glijh8lz1g9.descendant(scope,predicate).isSome()},$_2egcf2q2jh8lz2fq={any:any$1,ancestor:ancestor$3,closest:closest$3,sibling:sibling$3,child:child$4,descendant:descendant$3},detection=$_a6om0dl0jh8lz1ep.detect(),inSameTable=function(elem,table){return $_2egcf2q2jh8lz2fq.ancestor(elem,function(e){return $_4hc7u2ktjh8lz1dv.parent(e).exists(function(p){return $_2eywnlkvjh8lz1e8.eq(p,table)})})},simulate=function(bridge,isRoot,direction,initial,anchor){return $_fiygddlhjh8lz1g7.closest(initial,"td,th",isRoot).bind(function(start){return $_fiygddlhjh8lz1g7.closest(start,"table",isRoot).bind(function(table){return inSameTable(anchor,table)?$_3ywvn5ppjh8lz2c7.handle(bridge,isRoot,direction).bind(function(range){return $_fiygddlhjh8lz1g7.closest(range.finish(),"td,th",isRoot).map(function(finish){return{start:$_bgyjg9kejh8lz1ax.constant(start),finish:$_bgyjg9kejh8lz1ax.constant(finish),range:$_bgyjg9kejh8lz1ax.constant(range)}})}):Option.none()})})},navigate=function(bridge,isRoot,direction,initial,anchor,precheck){return detection.browser.isIE()?Option.none():precheck(initial,isRoot).orThunk(function(){return simulate(bridge,isRoot,direction,initial,anchor).map(function(info){var range=info.range();return $_8xnxafpijh8lz29y.response(Option.some($_45u5rqpljh8lz2ah.makeSitus(range.start(),range.soffset(),range.finish(),range.foffset())),!0)})})},firstUpCheck=function(initial,isRoot){return $_fiygddlhjh8lz1g7.closest(initial,"tr",isRoot).bind(function(startRow){return $_fiygddlhjh8lz1g7.closest(startRow,"table",isRoot).bind(function(table){var rows=$_coxlualejh8lz1fz.descendants(table,"tr");return $_2eywnlkvjh8lz1e8.eq(startRow,rows[0])?$_fayc8dptjh8lz2dk.seekLeft(table,function(element){return $_fpdn73lsjh8lz1ig.last(element).isSome()},isRoot).map(function(last){var lastOffset=$_6759o9ltjh8lz1ij.getEnd(last);return $_8xnxafpijh8lz29y.response(Option.some($_45u5rqpljh8lz2ah.makeSitus(last,lastOffset,last,lastOffset)),!0)}):Option.none()})})},lastDownCheck=function(initial,isRoot){return $_fiygddlhjh8lz1g7.closest(initial,"tr",isRoot).bind(function(startRow){return $_fiygddlhjh8lz1g7.closest(startRow,"table",isRoot).bind(function(table){var rows=$_coxlualejh8lz1fz.descendants(table,"tr");return $_2eywnlkvjh8lz1e8.eq(startRow,rows[rows.length-1])?$_fayc8dptjh8lz2dk.seekRight(table,function(element){return $_fpdn73lsjh8lz1ig.first(element).isSome()},isRoot).map(function(first){return $_8xnxafpijh8lz29y.response(Option.some($_45u5rqpljh8lz2ah.makeSitus(first,0,first,0)),!0)}):Option.none()})})},select=function(bridge,container,isRoot,direction,initial,anchor,selectRange){return simulate(bridge,isRoot,direction,initial,anchor).bind(function(info){return $_2hlk4dpnjh8lz2b8.detect(container,isRoot,info.start(),info.finish(),selectRange)})},$_1iwm88pojh8lz2bj={navigate:navigate,select:select,firstUpCheck:firstUpCheck,lastDownCheck:lastDownCheck},findCell=function(target,isRoot){return $_fiygddlhjh8lz1g7.closest(target,"td,th",isRoot)},$_24h2itq4jh8lz2fz={down:{traverse:$_4hc7u2ktjh8lz1dv.nextSibling,gather:$_fayc8dptjh8lz2dk.after,relative:$_eviq86p2jh8lz26w.before,otherRetry:$_djarwopsjh8lz2d1.tryDown,ieRetry:$_djarwopsjh8lz2d1.ieTryDown,failure:$_9gwioapyjh8lz2ea.adt.failedDown},up:{traverse:$_4hc7u2ktjh8lz1dv.prevSibling,gather:$_fayc8dptjh8lz2dk.before,relative:$_eviq86p2jh8lz26w.before,otherRetry:$_djarwopsjh8lz2d1.tryUp,ieRetry:$_djarwopsjh8lz2d1.ieTryUp,failure:$_9gwioapyjh8lz2ea.adt.failedUp}},rc=$_d2ojjnkijh8lz1bv.immutable("rows","cols"),mouse=function(win,container,isRoot,annotations){var bridge=WindowBridge(win),handlers=MouseSelection(bridge,container,isRoot,annotations);return{mousedown:handlers.mousedown,mouseover:handlers.mouseover,mouseup:handlers.mouseup}},keyboard=function(win,container,isRoot,annotations){var bridge=WindowBridge(win),clearToNavigate=function(){return annotations.clear(container),Option.none()},keydown=function(event,start,soffset,finish,foffset,direction){var keycode=event.raw().which,shiftKey=event.raw().shiftKey===!0,handler=$_5tpv0tm0jh8lz1jt.retrieve(container,annotations.selectedSelector()).fold(function(){return $_5bctktpjjh8lz2a1.isDown(keycode)&&shiftKey?$_bgyjg9kejh8lz1ax.curry($_1iwm88pojh8lz2bj.select,bridge,container,isRoot,$_24h2itq4jh8lz2fz.down,finish,start,annotations.selectRange):$_5bctktpjjh8lz2a1.isUp(keycode)&&shiftKey?$_bgyjg9kejh8lz1ax.curry($_1iwm88pojh8lz2bj.select,bridge,container,isRoot,$_24h2itq4jh8lz2fz.up,finish,start,annotations.selectRange):$_5bctktpjjh8lz2a1.isDown(keycode)?$_bgyjg9kejh8lz1ax.curry($_1iwm88pojh8lz2bj.navigate,bridge,isRoot,$_24h2itq4jh8lz2fz.down,finish,start,$_1iwm88pojh8lz2bj.lastDownCheck):$_5bctktpjjh8lz2a1.isUp(keycode)?$_bgyjg9kejh8lz1ax.curry($_1iwm88pojh8lz2bj.navigate,bridge,isRoot,$_24h2itq4jh8lz2fz.up,finish,start,$_1iwm88pojh8lz2bj.firstUpCheck):Option.none},function(selected){var update=function(attempts){return function(){var navigation=$_clgylhn2jh8lz1sg.findMap(attempts,function(delta){return $_2hlk4dpnjh8lz2b8.update(delta.rows(),delta.cols(),container,selected,annotations)});return navigation.fold(function(){return $_5tpv0tm0jh8lz1jt.getEdges(container,annotations.firstSelectedSelector(),annotations.lastSelectedSelector()).map(function(edges){var relative=$_5bctktpjjh8lz2a1.isDown(keycode)||direction.isForward(keycode)?$_eviq86p2jh8lz26w.after:$_eviq86p2jh8lz26w.before;return bridge.setRelativeSelection($_eviq86p2jh8lz26w.on(edges.first(),0),relative(edges.table())),annotations.clear(container),$_8xnxafpijh8lz29y.response(Option.none(),!0)})},function(_){return Option.some($_8xnxafpijh8lz29y.response(Option.none(),!0))})}};return $_5bctktpjjh8lz2a1.isDown(keycode)&&shiftKey?update([rc(1,0)]):$_5bctktpjjh8lz2a1.isUp(keycode)&&shiftKey?update([rc(-1,0)]):direction.isBackward(keycode)&&shiftKey?update([rc(0,-1),rc(-1,0)]):direction.isForward(keycode)&&shiftKey?update([rc(0,1),rc(1,0)]):$_5bctktpjjh8lz2a1.isNavigation(keycode)&&shiftKey===!1?clearToNavigate:Option.none});return handler()},keyup=function(event,start,soffset,finish,foffset){return $_5tpv0tm0jh8lz1jt.retrieve(container,annotations.selectedSelector()).fold(function(){var keycode=event.raw().which,shiftKey=event.raw().shiftKey===!0;return shiftKey===!1?Option.none():$_5bctktpjjh8lz2a1.isNavigation(keycode)?$_2hlk4dpnjh8lz2b8.sync(container,isRoot,start,soffset,finish,foffset,annotations.selectRange):Option.none()},Option.none)};return{keydown:keydown,keyup:keyup}},$_5i27y1phjh8lz29m={mouse:mouse,keyboard:keyboard},add$3=function(element,classes){$_6b0spykcjh8lz1ao.each(classes,function(x){$_evf7iendjh8lz1uz.add(element,x)})},remove$7=function(element,classes){$_6b0spykcjh8lz1ao.each(classes,function(x){$_evf7iendjh8lz1uz.remove(element,x)})},toggle$2=function(element,classes){$_6b0spykcjh8lz1ao.each(classes,function(x){$_evf7iendjh8lz1uz.toggle(element,x)})},hasAll=function(element,classes){return $_6b0spykcjh8lz1ao.forall(classes,function(clazz){return $_evf7iendjh8lz1uz.has(element,clazz)})},hasAny=function(element,classes){return $_6b0spykcjh8lz1ao.exists(classes,function(clazz){return $_evf7iendjh8lz1uz.has(element,clazz)})},getNative=function(element){for(var classList=element.dom().classList,r=new Array(classList.length),i=0;i<classList.length;i++)r[i]=classList.item(i);return r},get$11=function(element){return $_7oeslpnfjh8lz1v2.supports(element)?getNative(element):$_7oeslpnfjh8lz1v2.get(element)},$_g8lworq7jh8lz2gs={add:add$3,remove:remove$7,toggle:toggle$2,hasAll:hasAll,hasAny:hasAny,get:get$11},addClass=function(clazz){return function(element){$_evf7iendjh8lz1uz.add(element,clazz)}},removeClass=function(clazz){return function(element){$_evf7iendjh8lz1uz.remove(element,clazz)}},removeClasses=function(classes){return function(element){$_g8lworq7jh8lz2gs.remove(element,classes)}},hasClass=function(clazz){return function(element){return $_evf7iendjh8lz1uz.has(element,clazz)}},$_1e5pdaq6jh8lz2gr={addClass:addClass,removeClass:removeClass,removeClasses:removeClasses,hasClass:hasClass},byClass=function(ephemera){var addSelectionClass=$_1e5pdaq6jh8lz2gr.addClass(ephemera.selected()),removeSelectionClasses=$_1e5pdaq6jh8lz2gr.removeClasses([ephemera.selected(),ephemera.lastSelected(),ephemera.firstSelected()]),clear=function(container){var sels=$_coxlualejh8lz1fz.descendants(container,ephemera.selectedSelector());$_6b0spykcjh8lz1ao.each(sels,removeSelectionClasses)},selectRange=function(container,cells,start,finish){clear(container),$_6b0spykcjh8lz1ao.each(cells,addSelectionClass),$_evf7iendjh8lz1uz.add(start,ephemera.firstSelected()),$_evf7iendjh8lz1uz.add(finish,ephemera.lastSelected())};return{clear:clear,selectRange:selectRange,selectedSelector:ephemera.selectedSelector,firstSelectedSelector:ephemera.firstSelectedSelector,lastSelectedSelector:ephemera.lastSelectedSelector}},byAttr=function(ephemera){var removeSelectionAttributes=function(element){$_1mp8lglcjh8lz1fq.remove(element,ephemera.selected()),$_1mp8lglcjh8lz1fq.remove(element,ephemera.firstSelected()),$_1mp8lglcjh8lz1fq.remove(element,ephemera.lastSelected())},addSelectionAttribute=function(element){$_1mp8lglcjh8lz1fq.set(element,ephemera.selected(),"1")},clear=function(container){var sels=$_coxlualejh8lz1fz.descendants(container,ephemera.selectedSelector());$_6b0spykcjh8lz1ao.each(sels,removeSelectionAttributes)},selectRange=function(container,cells,start,finish){clear(container),$_6b0spykcjh8lz1ao.each(cells,addSelectionAttribute),$_1mp8lglcjh8lz1fq.set(start,ephemera.firstSelected(),"1"),$_1mp8lglcjh8lz1fq.set(finish,ephemera.lastSelected(),"1")};return{clear:clear,selectRange:selectRange,selectedSelector:ephemera.selectedSelector,firstSelectedSelector:ephemera.firstSelectedSelector,lastSelectedSelector:ephemera.lastSelectedSelector}},$_giqnj1q5jh8lz2g7={byClass:byClass,byAttr:byAttr},hasInternalTarget=function(e){return $_evf7iendjh8lz1uz.has($_6vo9a4krjh8lz1do.fromDom(e.target),"ephox-snooker-resizer-bar")===!1},Selections=function(editor){var get=function(){var body=getBody$1(editor);return $_21toytlzjh8lz1jj.retrieve(body,$_2yroczmcjh8lz1n4.selectedSelector()).fold(function(){return void 0===editor.selection.getStart()?$_crzziemdjh8lz1n7.none():$_crzziemdjh8lz1n7.single(editor.selection)},function(cells){return $_crzziemdjh8lz1n7.multiple(cells)})};return{get:get}},each$4=global$2.each,addButtons=function(editor){function cmd(command){return function(){editor.execCommand(command)}}var menuItems=[];each$4("inserttable tableprops deletetable | cell row column".split(" "),function(name){"|"===name?menuItems.push({text:"-"}):menuItems.push(editor.menuItems[name])}),editor.addButton("table",{type:"menubutton",title:"Table",menu:menuItems}),editor.addButton("tableprops",{title:"Table properties",onclick:cmd("mceTableProps"),icon:"table"}),editor.addButton("tabledelete",{title:"Delete table",onclick:cmd("mceTableDelete")}),editor.addButton("tablecellprops",{title:"Cell properties",onclick:cmd("mceTableCellProps")}),editor.addButton("tablemergecells",{title:"Merge cells",onclick:cmd("mceTableMergeCells")}),editor.addButton("tablesplitcells",{title:"Split cell",onclick:cmd("mceTableSplitCells")}),editor.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:cmd("mceTableInsertRowBefore")}),editor.addButton("tableinsertrowafter",{title:"Insert row after",onclick:cmd("mceTableInsertRowAfter")}),editor.addButton("tabledeleterow",{title:"Delete row",onclick:cmd("mceTableDeleteRow")}),editor.addButton("tablerowprops",{title:"Row properties",onclick:cmd("mceTableRowProps")}),editor.addButton("tablecutrow",{title:"Cut row",onclick:cmd("mceTableCutRow")}),editor.addButton("tablecopyrow",{title:"Copy row",onclick:cmd("mceTableCopyRow")}),editor.addButton("tablepasterowbefore",{title:"Paste row before",onclick:cmd("mceTablePasteRowBefore")}),editor.addButton("tablepasterowafter",{title:"Paste row after",onclick:cmd("mceTablePasteRowAfter")}),editor.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:cmd("mceTableInsertColBefore")}),editor.addButton("tableinsertcolafter",{title:"Insert column after",onclick:cmd("mceTableInsertColAfter")}),editor.addButton("tabledeletecol",{title:"Delete column",onclick:cmd("mceTableDeleteCol")})},addToolbars=function(editor){var isTable=function(table){var selectorMatched=editor.dom.is(table,"table")&&editor.getBody().contains(table);return selectorMatched},toolbar=getToolbar(editor);toolbar.length>0&&editor.addContextToolbar(isTable,toolbar.join(" "))},$_7ezhclq9jh8lz2h1={addButtons:addButtons,addToolbars:addToolbars},addMenuItems=function(editor,selections){function cmd(command){return function(){editor.execCommand(command)}}var targets=Option.none(),tableCtrls=[],cellCtrls=[],mergeCtrls=[],unmergeCtrls=[],noTargetDisable=function(ctrl){ctrl.disabled(!0)},ctrlEnable=function(ctrl){ctrl.disabled(!1)},pushTable=function(){var self=this;tableCtrls.push(self),targets.fold(function(){noTargetDisable(self)},function(targets){ctrlEnable(self)})},pushCell=function(){var self=this;cellCtrls.push(self),targets.fold(function(){noTargetDisable(self)},function(targets){ctrlEnable(self)})},pushMerge=function(){var self=this;mergeCtrls.push(self),targets.fold(function(){noTargetDisable(self)},function(targets){self.disabled(targets.mergable().isNone())})},pushUnmerge=function(){var self=this;unmergeCtrls.push(self),targets.fold(function(){noTargetDisable(self)},function(targets){self.disabled(targets.unmergable().isNone())})},setDisabledCtrls=function(){targets.fold(function(){$_6b0spykcjh8lz1ao.each(tableCtrls,noTargetDisable),$_6b0spykcjh8lz1ao.each(cellCtrls,noTargetDisable),$_6b0spykcjh8lz1ao.each(mergeCtrls,noTargetDisable),$_6b0spykcjh8lz1ao.each(unmergeCtrls,noTargetDisable)},function(targets){$_6b0spykcjh8lz1ao.each(tableCtrls,ctrlEnable),$_6b0spykcjh8lz1ao.each(cellCtrls,ctrlEnable),$_6b0spykcjh8lz1ao.each(mergeCtrls,function(mergeCtrl){mergeCtrl.disabled(targets.mergable().isNone())}),$_6b0spykcjh8lz1ao.each(unmergeCtrls,function(unmergeCtrl){unmergeCtrl.disabled(targets.unmergable().isNone())})})};editor.on("init",function(){editor.on("nodechange",function(e){var cellOpt=Option.from(editor.dom.getParent(editor.selection.getStart(),"th,td"));targets=cellOpt.bind(function(cellDom){var cell=$_6vo9a4krjh8lz1do.fromDom(cellDom),table=$_ee8pmfkojh8lz1ch.table(cell);return table.map(function(table){return $_3xfj7olxjh8lz1j2.forMenu(selections,table,cell)})}),setDisabledCtrls()})});var generateTableGrid=function(){var html="";html='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var y=0;y<10;y++){html+="<tr>";for(var x=0;x<10;x++)html+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*y+x)+'" href="#" data-mce-x="'+x+'" data-mce-y="'+y+'"></a></td>';html+="</tr>"}return html+="</table>",html+='<div class="mce-text-center" role="presentation">1 x 1</div>'},selectGrid=function(editor,tx,ty,control){var x,y,focusCell,cell,active,table=control.getEl().getElementsByTagName("table")[0],rtl=control.isRtl()||"tl-tr"===control.parent().rel;for(table.nextSibling.innerHTML=tx+1+" x "+(ty+1),rtl&&(tx=9-tx),y=0;y<10;y++)for(x=0;x<10;x++)cell=table.rows[y].childNodes[x].firstChild,active=(rtl?x>=tx:x<=tx)&&y<=ty,editor.dom.toggleClass(cell,"mce-active",active),active&&(focusCell=cell);return focusCell.parentNode},insertTable=hasTableGrid(editor)===!1?{text:"Table",icon:"table",context:"table",onclick:cmd("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(e){e.aria&&(this.parent().hideAll(),e.stopImmediatePropagation(),editor.execCommand("mceInsertTable"))},onshow:function(){selectGrid(editor,0,0,this.menu.items()[0])},onhide:function(){var elements=this.menu.items()[0].getEl().getElementsByTagName("a");editor.dom.removeClass(elements,"mce-active"),editor.dom.addClass(elements[0],"mce-active")},menu:[{type:"container",html:generateTableGrid(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var x,y,target=e.target;"A"===target.tagName.toUpperCase()&&(x=parseInt(target.getAttribute("data-mce-x"),10),y=parseInt(target.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(x=9-x),x===this.lastX&&y===this.lastY||(selectGrid(editor,x,y,e.control),this.lastX=x,this.lastY=y))},onclick:function(e){var self=this;"A"===e.target.tagName.toUpperCase()&&(e.preventDefault(),e.stopPropagation(),self.parent().cancel(),editor.undoManager.transact(function(){$_7a3xgho8jh8lz20d.insert(editor,self.lastX+1,self.lastY+1)}),editor.addVisual())}}]},tableProperties={text:"Table properties",context:"table",onPostRender:pushTable,onclick:cmd("mceTableProps")},deleteTable={text:"Delete table",context:"table",onPostRender:pushTable,cmd:"mceTableDelete"},row={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:cmd("mceTableInsertRowBefore"),onPostRender:pushCell},{text:"Insert row after",onclick:cmd("mceTableInsertRowAfter"),onPostRender:pushCell},{text:"Delete row",onclick:cmd("mceTableDeleteRow"),onPostRender:pushCell},{text:"Row properties",onclick:cmd("mceTableRowProps"),onPostRender:pushCell},{text:"-"},{text:"Cut row",onclick:cmd("mceTableCutRow"),onPostRender:pushCell},{text:"Copy row",onclick:cmd("mceTableCopyRow"),onPostRender:pushCell},{text:"Paste row before",onclick:cmd("mceTablePasteRowBefore"),onPostRender:pushCell},{text:"Paste row after",onclick:cmd("mceTablePasteRowAfter"),onPostRender:pushCell}]},column={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:cmd("mceTableInsertColBefore"),onPostRender:pushCell},{text:"Insert column after",onclick:cmd("mceTableInsertColAfter"),onPostRender:pushCell},{text:"Delete column",onclick:cmd("mceTableDeleteCol"),onPostRender:pushCell}]},cell={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:cmd("mceTableCellProps"),onPostRender:pushCell},{text:"Merge cells",onclick:cmd("mceTableMergeCells"),onPostRender:pushMerge},{text:"Split cell",onclick:cmd("mceTableSplitCells"),onPostRender:pushUnmerge}]};editor.addMenuItem("inserttable",insertTable),editor.addMenuItem("tableprops",tableProperties),editor.addMenuItem("deletetable",deleteTable),editor.addMenuItem("row",row),editor.addMenuItem("column",column),editor.addMenuItem("cell",cell)},$_g08j12qajh8lz2h4={addMenuItems:addMenuItems},getClipboardRows=function(clipboardRows){return clipboardRows.get().fold(function(){},function(rows){return $_6b0spykcjh8lz1ao.map(rows,function(row){return row.dom()})})},setClipboardRows=function(rows,clipboardRows){var sugarRows=$_6b0spykcjh8lz1ao.map(rows,$_6vo9a4krjh8lz1do.fromDom);clipboardRows.set(Option.from(sugarRows))},getApi=function(editor,clipboardRows){return{insertTable:function(columns,rows){return $_7a3xgho8jh8lz20d.insert(editor,columns,rows)},setClipboardRows:function(rows){return setClipboardRows(rows,clipboardRows)},getClipboardRows:function(){return getClipboardRows(clipboardRows)}}};return global.add("table",Plugin),Plugin$1})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-template",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),noop=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i]},noarg=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return f()}},compose=function(fa,fb){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return fa(fb.apply(null,arguments))}},constant=function(value){return function(){return value}},identity=function(x){return x},tripleEquals=function(a,b){return a===b},curry=function(f){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];for(var args=new Array(arguments.length-1),i=1;i<arguments.length;i++)args[i-1]=arguments[i];return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];for(var newArgs=new Array(arguments.length),j=0;j<newArgs.length;j++)newArgs[j]=arguments[j];var all=args.concat(newArgs);return f.apply(null,all)}},not=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return!f.apply(null,arguments)}},die=function(msg){return function(){throw new Error(msg)}},apply=function(f){return f()},call=function(f){f()},never=constant(!1),always=constant(!0),$_4ldd4lqfjh8lz34o={noop:noop,noarg:noarg,compose:compose,constant:constant,identity:identity,tripleEquals:tripleEquals,curry:curry,not:not,die:die,apply:apply,call:call,never:never,always:always},global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),global$2=tinymce.util.Tools.resolve("tinymce.util.XHR"),global$3=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),getCreationDateClasses=function(editor){return editor.getParam("template_cdate_classes","cdate")},getModificationDateClasses=function(editor){return editor.getParam("template_mdate_classes","mdate")},getSelectedContentClasses=function(editor){return editor.getParam("template_selected_content_classes","selcontent")},getPreviewReplaceValues=function(editor){return editor.getParam("template_preview_replace_values")},getTemplateReplaceValues=function(editor){return editor.getParam("template_replace_values")},getTemplates=function(editorSettings){return editorSettings.templates},getCdateFormat=function(editor){return editor.getParam("template_cdate_format",editor.getLang("template.cdate_format"))},getMdateFormat=function(editor){return editor.getParam("template_mdate_format",editor.getLang("template.mdate_format"))},getDialogWidth=function(editor){return editor.getParam("template_popup_width",600)},getDialogHeight=function(editor){return Math.min(global$3.DOM.getViewPort().h,editor.getParam("template_popup_height",500))},$_aakka8qjjh8lz34u={getCreationDateClasses:getCreationDateClasses,getModificationDateClasses:getModificationDateClasses,getSelectedContentClasses:getSelectedContentClasses,getPreviewReplaceValues:getPreviewReplaceValues,getTemplateReplaceValues:getTemplateReplaceValues,getTemplates:getTemplates,getCdateFormat:getCdateFormat,getMdateFormat:getMdateFormat,getDialogWidth:getDialogWidth,getDialogHeight:getDialogHeight},addZeros=function(value,len){if(value=""+value,value.length<len)for(var i=0;i<len-value.length;i++)value="0"+value;return value},getDateTime=function(editor,fmt,date){var daysShort="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),daysLong="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),monthsLong="January February March April May June July August September October November December".split(" ");return date=date||new Date,fmt=fmt.replace("%D","%m/%d/%Y"),fmt=fmt.replace("%r","%I:%M:%S %p"),fmt=fmt.replace("%Y",""+date.getFullYear()),fmt=fmt.replace("%y",""+date.getYear()),fmt=fmt.replace("%m",addZeros(date.getMonth()+1,2)),fmt=fmt.replace("%d",addZeros(date.getDate(),2)),fmt=fmt.replace("%H",""+addZeros(date.getHours(),2)),fmt=fmt.replace("%M",""+addZeros(date.getMinutes(),2)),fmt=fmt.replace("%S",""+addZeros(date.getSeconds(),2)),fmt=fmt.replace("%I",""+((date.getHours()+11)%12+1)),fmt=fmt.replace("%p",""+(date.getHours()<12?"AM":"PM")),fmt=fmt.replace("%B",""+editor.translate(monthsLong[date.getMonth()])),fmt=fmt.replace("%b",""+editor.translate(monthsShort[date.getMonth()])),fmt=fmt.replace("%A",""+editor.translate(daysLong[date.getDay()])),fmt=fmt.replace("%a",""+editor.translate(daysShort[date.getDay()])),fmt=fmt.replace("%%","%")},$_c5oa7zqljh8lz34w={getDateTime:getDateTime},createTemplateList=function(editorSettings,callback){return function(){var templateList=$_aakka8qjjh8lz34u.getTemplates(editorSettings);return"function"==typeof templateList?void templateList(callback):void("string"==typeof templateList?global$2.send({url:templateList,success:function(text){callback(JSON.parse(text))}}):callback(templateList))}},replaceTemplateValues=function(editor,html,templateValues){return global$1.each(templateValues,function(v,k){"function"==typeof v&&(v=v(k)),html=html.replace(new RegExp("\\{\\$"+k+"\\}","g"),v)}),html},replaceVals=function(editor,e){var dom=editor.dom,vl=$_aakka8qjjh8lz34u.getTemplateReplaceValues(editor);global$1.each(dom.select("*",e),function(e){global$1.each(vl,function(v,k){dom.hasClass(e,k)&&"function"==typeof vl[k]&&vl[k](e)})})},hasClass=function(n,c){return new RegExp("\\b"+c+"\\b","g").test(n.className)},insertTemplate=function(editor,ui,html){var el,n,dom=editor.dom,sel=editor.selection.getContent();html=replaceTemplateValues(editor,html,$_aakka8qjjh8lz34u.getTemplateReplaceValues(editor)),el=dom.create("div",null,html),n=dom.select(".mceTmpl",el),n&&n.length>0&&(el=dom.create("div",null),el.appendChild(n[0].cloneNode(!0))),global$1.each(dom.select("*",el),function(n){hasClass(n,$_aakka8qjjh8lz34u.getCreationDateClasses(editor).replace(/\s+/g,"|"))&&(n.innerHTML=$_c5oa7zqljh8lz34w.getDateTime(editor,$_aakka8qjjh8lz34u.getCdateFormat(editor))),hasClass(n,$_aakka8qjjh8lz34u.getModificationDateClasses(editor).replace(/\s+/g,"|"))&&(n.innerHTML=$_c5oa7zqljh8lz34w.getDateTime(editor,$_aakka8qjjh8lz34u.getMdateFormat(editor))),hasClass(n,$_aakka8qjjh8lz34u.getSelectedContentClasses(editor).replace(/\s+/g,"|"))&&(n.innerHTML=sel)}),replaceVals(editor,el),editor.execCommand("mceInsertContent",!1,el.innerHTML),editor.addVisual()},$_4rrmzqgjh8lz34q={createTemplateList:createTemplateList,replaceTemplateValues:replaceTemplateValues,
replaceVals:replaceVals,insertTemplate:insertTemplate},register=function(editor){editor.addCommand("mceInsertTemplate",$_4ldd4lqfjh8lz34o.curry($_4rrmzqgjh8lz34q.insertTemplate,editor))},$_ffyhw9qejh8lz34k={register:register},setup=function(editor){editor.on("PreProcess",function(o){var dom=editor.dom,dateFormat=$_aakka8qjjh8lz34u.getMdateFormat(editor);global$1.each(dom.select("div",o.node),function(e){dom.hasClass(e,"mceTmpl")&&(global$1.each(dom.select("*",e),function(e){dom.hasClass(e,editor.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(e.innerHTML=$_c5oa7zqljh8lz34w.getDateTime(editor,dateFormat))}),$_4rrmzqgjh8lz34q.replaceVals(editor,e))})})},$_fi8njaqmjh8lz34y={setup:setup},insertIframeHtml=function(editor,win,html){if(html.indexOf("<html>")===-1){var contentCssLinks_1="";global$1.each(editor.contentCSS,function(url){contentCssLinks_1+='<link type="text/css" rel="stylesheet" href="'+editor.documentBaseURI.toAbsolute(url)+'">'});var bodyClass=editor.settings.body_class||"";bodyClass.indexOf("=")!==-1&&(bodyClass=editor.getParam("body_class","","hash"),bodyClass=bodyClass[editor.id]||""),html="<!DOCTYPE html><html><head>"+contentCssLinks_1+'</head><body class="'+bodyClass+'">'+html+"</body></html>"}html=$_4rrmzqgjh8lz34q.replaceTemplateValues(editor,html,$_aakka8qjjh8lz34u.getPreviewReplaceValues(editor));var doc=win.find("iframe")[0].getEl().contentWindow.document;doc.open(),doc.write(html),doc.close()},open=function(editor,templateList){var win,templateHtml,values=[];if(!templateList||0===templateList.length){var message=editor.translate("No templates defined.");return void editor.notificationManager.open({text:message,type:"info"})}global$1.each(templateList,function(template){values.push({selected:!values.length,text:template.title,value:{url:template.url,content:template.content,description:template.description}})});var onSelectTemplate=function(e){var value=e.control.value();value.url?global$2.send({url:value.url,success:function(html){templateHtml=html,insertIframeHtml(editor,win,templateHtml)}}):(templateHtml=value.content,insertIframeHtml(editor,win,templateHtml)),win.find("#description")[0].text(e.control.value().description)};win=editor.windowManager.open({title:"Insert template",layout:"flex",direction:"column",align:"stretch",padding:15,spacing:10,items:[{type:"form",flex:0,padding:0,items:[{type:"container",label:"Templates",items:{type:"listbox",label:"Templates",name:"template",values:values,onselect:onSelectTemplate}}]},{type:"label",name:"description",label:"Description",text:" "},{type:"iframe",flex:1,border:1}],onsubmit:function(){$_4rrmzqgjh8lz34q.insertTemplate(editor,!1,templateHtml)},minWidth:$_aakka8qjjh8lz34u.getDialogWidth(editor),minHeight:$_aakka8qjjh8lz34u.getDialogHeight(editor)}),win.find("listbox")[0].fire("select")},$_7vfghaqojh8lz351={open:open},showDialog=function(editor){return function(templates){$_7vfghaqojh8lz351.open(editor,templates)}},register$1=function(editor){editor.addButton("template",{title:"Insert template",onclick:$_4rrmzqgjh8lz34q.createTemplateList(editor.settings,showDialog(editor))}),editor.addMenuItem("template",{text:"Template",onclick:$_4rrmzqgjh8lz34q.createTemplateList(editor.settings,showDialog(editor)),icon:"template",context:"insert"})},$_c0clk2qnjh8lz34z={register:register$1};return global.add("template",function(editor){$_c0clk2qnjh8lz34z.register(editor),$_ffyhw9qejh8lz34k.register(editor),$_fi8njaqmjh8lz34y.setup(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-textcolor",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),getCurrentColor=function(editor,format){var color;return editor.dom.getParents(editor.selection.getStart(),function(elm){var value;(value=elm.style["forecolor"===format?"color":"background-color"])&&(color=value)}),color},mapColors=function(colorMap){var i,colors=[];for(i=0;i<colorMap.length;i+=2)colors.push({text:colorMap[i+1],color:"#"+colorMap[i]});return colors},applyFormat=function(editor,format,value){editor.undoManager.transact(function(){editor.focus(),editor.formatter.apply(format,{value:value}),editor.nodeChanged()})},removeFormat=function(editor,format){editor.undoManager.transact(function(){editor.focus(),editor.formatter.remove(format,{value:null},null,!0),editor.nodeChanged()})},$_1d7gtwqsjh8lz35z={getCurrentColor:getCurrentColor,mapColors:mapColors,applyFormat:applyFormat,removeFormat:removeFormat},register=function(editor){editor.addCommand("mceApplyTextcolor",function(format,value){$_1d7gtwqsjh8lz35z.applyFormat(editor,format,value)}),editor.addCommand("mceRemoveTextcolor",function(format){$_1d7gtwqsjh8lz35z.removeFormat(editor,format)})},$_9kt0cyqrjh8lz35y={register:register},global$1=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$2=tinymce.util.Tools.resolve("tinymce.util.Tools"),defaultColorMap=["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"],getTextColorMap=function(editor){return editor.getParam("textcolor_map",defaultColorMap)},getForeColorMap=function(editor){return editor.getParam("forecolor_map",getTextColorMap(editor))},getBackColorMap=function(editor){return editor.getParam("backcolor_map",getTextColorMap(editor))},getTextColorRows=function(editor){return editor.getParam("textcolor_rows",5)},getTextColorCols=function(editor){return editor.getParam("textcolor_cols",8)},getForeColorRows=function(editor){return editor.getParam("forecolor_rows",getTextColorRows(editor))},getBackColorRows=function(editor){return editor.getParam("backcolor_rows",getTextColorRows(editor))},getForeColorCols=function(editor){return editor.getParam("forecolor_cols",getTextColorCols(editor))},getBackColorCols=function(editor){return editor.getParam("backcolor_cols",getTextColorCols(editor))},getColorPickerCallback=function(editor){return editor.getParam("color_picker_callback",null)},hasColorPicker=function(editor){return"function"==typeof getColorPickerCallback(editor)},$_cupc58qwjh8lz366={getForeColorMap:getForeColorMap,getBackColorMap:getBackColorMap,getForeColorRows:getForeColorRows,getBackColorRows:getBackColorRows,getForeColorCols:getForeColorCols,getBackColorCols:getBackColorCols,getColorPickerCallback:getColorPickerCallback,hasColorPicker:hasColorPicker},global$3=tinymce.util.Tools.resolve("tinymce.util.I18n"),getHtml=function(cols,rows,colorMap,hasColorPicker){var colors,color,html,last,x,y,i,count=0,id=global$1.DOM.uniqueId("mcearia"),getColorCellHtml=function(color,title){var isNoColor="transparent"===color;return'<td class="mce-grid-cell'+(isNoColor?" mce-colorbtn-trans":"")+'"><div id="'+id+"-"+count++ +'" data-mce-color="'+(color?color:"")+'" role="option" tabIndex="-1" style="'+(color?"background-color: "+color:"")+'" title="'+global$3.translate(title)+'">'+(isNoColor?"&#215;":"")+"</div></td>"};for(colors=$_1d7gtwqsjh8lz35z.mapColors(colorMap),colors.push({text:global$3.translate("No color"),color:"transparent"}),html='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>',last=colors.length-1,y=0;y<rows;y++){for(html+="<tr>",x=0;x<cols;x++)i=y*cols+x,i>last?html+="<td></td>":(color=colors[i],html+=getColorCellHtml(color.color,color.text));html+="</tr>"}if(hasColorPicker){for(html+='<tr><td colspan="'+cols+'" class="mce-custom-color-btn"><div id="'+id+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+id+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+global$3.translate("Custom...")+"</button></div></td></tr>",html+="<tr>",x=0;x<cols;x++)html+=getColorCellHtml("","Custom color");html+="</tr>"}return html+="</tbody></table>"},$_yigkpqxjh8lz368={getHtml:getHtml},setDivColor=function(div,value){div.style.background=value,div.setAttribute("data-mce-color",value)},onButtonClick=function(editor){return function(e){var ctrl=e.control;ctrl._color?editor.execCommand("mceApplyTextcolor",ctrl.settings.format,ctrl._color):editor.execCommand("mceRemoveTextcolor",ctrl.settings.format)}},onPanelClick=function(editor,cols){return function(e){var value,buttonCtrl=this.parent(),currentColor=$_1d7gtwqsjh8lz35z.getCurrentColor(editor,buttonCtrl.settings.format),selectColor=function(value){editor.execCommand("mceApplyTextcolor",buttonCtrl.settings.format,value),buttonCtrl.hidePanel(),buttonCtrl.color(value)},resetColor=function(){editor.execCommand("mceRemoveTextcolor",buttonCtrl.settings.format),buttonCtrl.hidePanel(),buttonCtrl.resetColor()};if(global$1.DOM.getParent(e.target,".mce-custom-color-btn")){buttonCtrl.hidePanel();var colorPickerCallback=$_cupc58qwjh8lz366.getColorPickerCallback(editor);colorPickerCallback.call(editor,function(value){var customColorCells,div,i,tableElm=buttonCtrl.panel.getEl().getElementsByTagName("table")[0];for(customColorCells=global$2.map(tableElm.rows[tableElm.rows.length-1].childNodes,function(elm){return elm.firstChild}),i=0;i<customColorCells.length&&(div=customColorCells[i],div.getAttribute("data-mce-color"));i++);if(i===cols)for(i=0;i<cols-1;i++)setDivColor(customColorCells[i],customColorCells[i+1].getAttribute("data-mce-color"));setDivColor(div,value),selectColor(value)},currentColor)}value=e.target.getAttribute("data-mce-color"),value?(this.lastId&&global$1.DOM.get(this.lastId).setAttribute("aria-selected","false"),e.target.setAttribute("aria-selected",!0),this.lastId=e.target.id,"transparent"===value?resetColor():selectColor(value)):null!==value&&buttonCtrl.hidePanel()}},renderColorPicker=function(editor,foreColor){return function(){var cols=foreColor?$_cupc58qwjh8lz366.getForeColorCols(editor):$_cupc58qwjh8lz366.getBackColorCols(editor),rows=foreColor?$_cupc58qwjh8lz366.getForeColorRows(editor):$_cupc58qwjh8lz366.getBackColorRows(editor),colorMap=foreColor?$_cupc58qwjh8lz366.getForeColorMap(editor):$_cupc58qwjh8lz366.getBackColorMap(editor),hasColorPicker=$_cupc58qwjh8lz366.hasColorPicker(editor);return $_yigkpqxjh8lz368.getHtml(cols,rows,colorMap,hasColorPicker)}},register$1=function(editor){editor.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:!0,html:renderColorPicker(editor,!0),onclick:onPanelClick(editor,$_cupc58qwjh8lz366.getForeColorCols(editor))},onclick:onButtonClick(editor)}),editor.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:!0,html:renderColorPicker(editor,!1),onclick:onPanelClick(editor,$_cupc58qwjh8lz366.getBackColorCols(editor))},onclick:onButtonClick(editor)})},$_dk5fhnqtjh8lz361={register:register$1};return global.add("textcolor",function(editor){$_9kt0cyqrjh8lz35y.register(editor),$_dk5fhnqtjh8lz361.register(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-textpattern",["tinymce"],function(){return function(){!function(){(function(){"use strict";function handleEnter(editor,patterns){var wrappedTextNode,rng;wrappedTextNode=$_gffj5fr8jh8lz379.applyInlineFormatEnter(editor,patterns),wrappedTextNode&&(rng=editor.dom.createRng(),rng.setStart(wrappedTextNode,wrappedTextNode.data.length),rng.setEnd(wrappedTextNode,wrappedTextNode.data.length),editor.selection.setRng(rng)),$_gffj5fr8jh8lz379.applyBlockFormat(editor,patterns)}function handleInlineKey(editor,patterns){var wrappedTextNode,lastChar,lastCharNode,rng,dom;wrappedTextNode=$_gffj5fr8jh8lz379.applyInlineFormatSpace(editor,patterns),wrappedTextNode&&(dom=editor.dom,lastChar=wrappedTextNode.data.slice(-1),/[\u00a0 ]/.test(lastChar)&&(wrappedTextNode.deleteData(wrappedTextNode.data.length-1,1),lastCharNode=dom.doc.createTextNode(lastChar),dom.insertAfter(lastCharNode,wrappedTextNode.parentNode),rng=dom.createRng(),rng.setStart(lastCharNode,1),rng.setEnd(lastCharNode,1),editor.selection.setRng(rng)))}function Plugin(){}var Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),get=function(patternsState){var setPatterns=function(newPatterns){patternsState.set(newPatterns)},getPatterns=function(){return patternsState.get()};return{setPatterns:setPatterns,getPatterns:getPatterns}},$_2txh6dr2jh8lz36u={get:get},defaultPatterns=[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"***",end:"***",format:["bold","italic"]},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}],getPatterns=function(editorSettings){return void 0!==editorSettings.textpattern_patterns?editorSettings.textpattern_patterns:defaultPatterns},$_2d3ibsr3jh8lz36v={getPatterns:getPatterns},global$1=tinymce.util.Tools.resolve("tinymce.util.Delay"),global$2=tinymce.util.Tools.resolve("tinymce.util.VK"),global$3=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),global$4=tinymce.util.Tools.resolve("tinymce.util.Tools"),sortPatterns=function(patterns){return patterns.sort(function(a,b){return a.start.length>b.start.length?-1:a.start.length<b.start.length?1:0})},findPattern=function(patterns,text){for(var i=0;i<patterns.length;i++)if(0===text.indexOf(patterns[i].start)&&(!patterns[i].end||text.lastIndexOf(patterns[i].end)===text.length-patterns[i].end.length))return patterns[i]},isMatchingPattern=function(pattern,text,offset,delta){var textEnd=text.substr(offset-pattern.end.length-delta,pattern.end.length);return textEnd===pattern.end},hasContent=function(offset,delta,pattern){return offset-delta-pattern.end.length-pattern.start.length>0},findEndPattern=function(patterns,text,offset,delta){var pattern,i,sortedPatterns=sortPatterns(patterns);for(i=0;i<sortedPatterns.length;i++)if(pattern=sortedPatterns[i],void 0!==pattern.end&&isMatchingPattern(pattern,text,offset,delta)&&hasContent(offset,delta,pattern))return pattern},$_el6qhwrbjh8lz37d={findPattern:findPattern,findEndPattern:findEndPattern},splitContainer=function(container,pattern,endOffset,startOffset,space){return container=startOffset>0?container.splitText(startOffset):container,container.splitText(endOffset-startOffset+pattern.end.length),container.deleteData(0,pattern.start.length),container.deleteData(container.data.length-pattern.end.length,pattern.end.length),container},patternFromRng=function(patterns,rng,space){if(rng.collapsed!==!1){var container=rng.startContainer,text=container.data,delta=space===!0?1:0;if(3===container.nodeType){var endPattern=$_el6qhwrbjh8lz37d.findEndPattern(patterns,text,rng.startOffset,delta);if(void 0!==endPattern){var endOffset=text.lastIndexOf(endPattern.end,rng.startOffset-delta),startOffset=text.lastIndexOf(endPattern.start,endOffset-endPattern.end.length);if(endOffset=text.indexOf(endPattern.end,startOffset+endPattern.start.length),startOffset!==-1){var patternRng=document.createRange();patternRng.setStart(container,startOffset),patternRng.setEnd(container,endOffset+endPattern.end.length);var startPattern=$_el6qhwrbjh8lz37d.findPattern(patterns,patternRng.toString());if(!(void 0===endPattern||startPattern!==endPattern||container.data.length<=endPattern.start.length+endPattern.end.length))return{pattern:endPattern,startOffset:startOffset,endOffset:endOffset}}}}}},splitAndApply=function(editor,container,found,space){var formatArray=global$4.isArray(found.pattern.format)?found.pattern.format:[found.pattern.format],validFormats=global$4.grep(formatArray,function(formatName){var format=editor.formatter.get(formatName);return format&&format[0].inline});if(0!==validFormats.length)return editor.undoManager.transact(function(){container=splitContainer(container,found.pattern,found.endOffset,found.startOffset,space),formatArray.forEach(function(format){editor.formatter.apply(format,{},container)})}),container},doApplyInlineFormat=function(editor,patterns,space){var rng=editor.selection.getRng(!0),foundPattern=patternFromRng(patterns,rng,space);if(foundPattern)return splitAndApply(editor,rng.startContainer,foundPattern,space)},applyInlineFormatSpace=function(editor,patterns){return doApplyInlineFormat(editor,patterns,!0)},applyInlineFormatEnter=function(editor,patterns){return doApplyInlineFormat(editor,patterns,!1)},applyBlockFormat=function(editor,patterns){var selection,dom,container,firstTextNode,node,format,textBlockElm,pattern,walker,rng,offset;if(selection=editor.selection,dom=editor.dom,selection.isCollapsed()&&(textBlockElm=dom.getParent(selection.getStart(),"p"))){for(walker=new global$3(textBlockElm,textBlockElm);node=walker.next();)if(3===node.nodeType){firstTextNode=node;break}if(firstTextNode){if(pattern=$_el6qhwrbjh8lz37d.findPattern(patterns,firstTextNode.data),!pattern)return;if(rng=selection.getRng(!0),container=rng.startContainer,offset=rng.startOffset,firstTextNode===container&&(offset=Math.max(0,offset-pattern.start.length)),global$4.trim(firstTextNode.data).length===pattern.start.length)return;pattern.format&&(format=editor.formatter.get(pattern.format),format&&format[0].block&&(firstTextNode.deleteData(0,pattern.start.length),editor.formatter.apply(pattern.format,{},firstTextNode),rng.setStart(container,offset),rng.collapse(!0),selection.setRng(rng))),pattern.cmd&&editor.undoManager.transact(function(){firstTextNode.deleteData(0,pattern.start.length),editor.execCommand(pattern.cmd)})}}},$_gffj5fr8jh8lz379={patternFromRng:patternFromRng,applyInlineFormatSpace:applyInlineFormatSpace,applyInlineFormatEnter:applyInlineFormatEnter,applyBlockFormat:applyBlockFormat},checkKeyEvent=function(codes,event,predicate){for(var i=0;i<codes.length;i++)if(predicate(codes[i],event))return!0},checkKeyCode=function(codes,event){return checkKeyEvent(codes,event,function(code,event){return code===event.keyCode&&global$2.modifierPressed(event)===!1})},checkCharCode=function(chars,event){return checkKeyEvent(chars,event,function(chr,event){return chr.charCodeAt(0)===event.charCode})},$_6uf8aer7jh8lz36z={handleEnter:handleEnter,handleInlineKey:handleInlineKey,checkCharCode:checkCharCode,checkKeyCode:checkKeyCode},setup=function(editor,patternsState){var charCodes=[",",".",";",":","!","?"],keyCodes=[32];editor.on("keydown",function(e){13!==e.keyCode||global$2.modifierPressed(e)||$_6uf8aer7jh8lz36z.handleEnter(editor,patternsState.get())},!0),editor.on("keyup",function(e){$_6uf8aer7jh8lz36z.checkKeyCode(keyCodes,e)&&$_6uf8aer7jh8lz36z.handleInlineKey(editor,patternsState.get())}),editor.on("keypress",function(e){$_6uf8aer7jh8lz36z.checkCharCode(charCodes,e)&&global$1.setEditorTimeout(editor,function(){$_6uf8aer7jh8lz36z.handleInlineKey(editor,patternsState.get())})})},$_6vgmler4jh8lz36x={setup:setup};return global.add("textpattern",function(editor){var patternsState=Cell($_2d3ibsr3jh8lz36v.getPatterns(editor.settings));return $_6vgmler4jh8lz36x.setup(editor,patternsState),$_2txh6dr2jh8lz36u.get(patternsState)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-visualblocks",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),fireVisualBlocks=function(editor,state){editor.fire("VisualBlocks",{state:state})},$_h9rpfrsjh8lz3ee={fireVisualBlocks:fireVisualBlocks},isEnabledByDefault=function(editor){return editor.getParam("visualblocks_default_state",!1)},getContentCss=function(editor){return editor.settings.visualblocks_content_css},$_t5nqwrtjh8lz3ef={isEnabledByDefault:isEnabledByDefault,getContentCss:getContentCss},global$1=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$2=tinymce.util.Tools.resolve("tinymce.util.Tools"),cssId=global$1.DOM.uniqueId(),load=function(doc,url){var linkElements=global$2.toArray(doc.getElementsByTagName("link")),matchingLinkElms=global$2.grep(linkElements,function(head){return head.id===cssId});if(0===matchingLinkElms.length){var linkElm=global$1.DOM.create("link",{id:cssId,rel:"stylesheet",href:url});doc.getElementsByTagName("head")[0].appendChild(linkElm)}},$_g7sccqrujh8lz3eg={load:load},toggleVisualBlocks=function(editor,pluginUrl,enabledState){var dom=editor.dom,contentCss=$_t5nqwrtjh8lz3ef.getContentCss(editor);$_g7sccqrujh8lz3eg.load(editor.getDoc(),contentCss?contentCss:pluginUrl+"/css/visualblocks.css"),dom.toggleClass(editor.getBody(),"mce-visualblocks"),enabledState.set(!enabledState.get()),$_h9rpfrsjh8lz3ee.fireVisualBlocks(editor,enabledState.get())},$_7ddznfrrjh8lz3ed={toggleVisualBlocks:toggleVisualBlocks},register=function(editor,pluginUrl,enabledState){editor.addCommand("mceVisualBlocks",function(){$_7ddznfrrjh8lz3ed.toggleVisualBlocks(editor,pluginUrl,enabledState)})},$_82j3kqrqjh8lz3ec={register:register},setup=function(editor,pluginUrl,enabledState){editor.on("PreviewFormats AfterPreviewFormats",function(e){enabledState.get()&&editor.dom.toggleClass(editor.getBody(),"mce-visualblocks","afterpreviewformats"===e.type)}),editor.on("init",function(){$_t5nqwrtjh8lz3ef.isEnabledByDefault(editor)&&$_7ddznfrrjh8lz3ed.toggleVisualBlocks(editor,pluginUrl,enabledState)}),editor.on("remove",function(){editor.dom.removeClass(editor.getBody(),"mce-visualblocks")})},$_cs6iq5rxjh8lz3ei={setup:setup},toggleActiveState=function(editor,enabledState){return function(e){var ctrl=e.control;ctrl.active(enabledState.get()),editor.on("VisualBlocks",function(e){ctrl.active(e.state)})}},register$1=function(editor,enabledState){editor.addButton("visualblocks",{active:!1,title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:toggleActiveState(editor,enabledState)}),editor.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:toggleActiveState(editor,enabledState),selectable:!0,context:"view",prependToContext:!0})},$_9qaw0mryjh8lz3ej={register:register$1};return global.add("visualblocks",function(editor,pluginUrl){var enabledState=Cell(!1);$_82j3kqrqjh8lz3ec.register(editor,pluginUrl,enabledState),$_9qaw0mryjh8lz3ej.register(editor,enabledState),$_cs6iq5rxjh8lz3ei.setup(editor,pluginUrl,enabledState)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-visualchars",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var Cell=function(initial){var value=initial,get=function(){return value},set=function(v){value=v},clone=function(){return Cell(get())};return{get:get,set:set,clone:clone}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),get=function(toggleState){var isEnabled=function(){return toggleState.get()};return{isEnabled:isEnabled}},$_bmmym6s2jh8lz3f4={get:get},fireVisualChars=function(editor,state){return editor.fire("VisualChars",{state:state})},$_ca1g8as5jh8lz3f7={fireVisualChars:fireVisualChars},charMap={" ":"nbsp","­":"shy"},charMapToRegExp=function(charMap,global){var key,regExp="";for(key in charMap)regExp+=key;return new RegExp("["+regExp+"]",global?"g":"")},charMapToSelector=function(charMap){var key,selector="";for(key in charMap)selector&&(selector+=","),selector+="span.mce-"+charMap[key];return selector},$_4quw9ds7jh8lz3fg={charMap:charMap,regExp:charMapToRegExp(charMap),regExpGlobal:charMapToRegExp(charMap,!0),selector:charMapToSelector(charMap),charMapToRegExp:charMapToRegExp,charMapToSelector:charMapToSelector},noop=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i]},noarg=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return f()}},compose=function(fa,fb){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return fa(fb.apply(null,arguments))}},constant=function(value){return function(){return value}},identity=function(x){return x},tripleEquals=function(a,b){return a===b},curry=function(f){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];for(var args=new Array(arguments.length-1),i=1;i<arguments.length;i++)args[i-1]=arguments[i];return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];for(var newArgs=new Array(arguments.length),j=0;j<newArgs.length;j++)newArgs[j]=arguments[j];var all=args.concat(newArgs);return f.apply(null,all)}},not=function(f){return function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];return!f.apply(null,arguments)}},die=function(msg){return function(){throw new Error(msg)}},apply=function(f){return f()},call=function(f){f()},never=constant(!1),always=constant(!0),$_7oq9iksbjh8lz3g0={noop:noop,noarg:noarg,compose:compose,constant:constant,identity:identity,tripleEquals:tripleEquals,curry:curry,not:not,die:die,apply:apply,call:call,never:never,always:always},never$1=$_7oq9iksbjh8lz3g0.never,always$1=$_7oq9iksbjh8lz3g0.always,none=function(){return NONE},NONE=function(){var eq=function(o){return o.isNone()},call=function(thunk){return thunk()},id=function(n){return n},noop=function(){},me={fold:function(n,s){return n()},is:never$1,isSome:never$1,isNone:always$1,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},or:id,orThunk:call,map:none,ap:none,each:noop,bind:none,flatten:none,exists:never$1,forall:always$1,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:$_7oq9iksbjh8lz3g0.constant("none()")};return Object.freeze&&Object.freeze(me),me}(),some=function(a){var constant_a=function(){return a},self=function(){return me},map=function(f){return some(f(a))},bind=function(f){return f(a)},me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always$1,isNone:never$1,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,or:self,orThunk:self,map:map,ap:function(optfab){return optfab.fold(none,function(fab){return some(fab(a))})},each:function(f){f(a)},bind:bind,flatten:constant_a,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never$1,function(b){return elementEq(a,b)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return me},from=function(value){return null===value||void 0===value?NONE:some(value)},Option={some:some,none:none,from:from},typeOf=function(x){if(null===x)return"null";var t=typeof x;return"object"===t&&Array.prototype.isPrototypeOf(x)?"array":"object"===t&&String.prototype.isPrototypeOf(x)?"string":t},isType=function(type){return function(value){return typeOf(value)===type}},$_fnb6mscjh8lz3g2={isString:isType("string"),isObject:isType("object"),isArray:isType("array"),isNull:isType("null"),isBoolean:isType("boolean"),isUndefined:isType("undefined"),isFunction:isType("function"),isNumber:isType("number")},rawIndexOf=function(){var pIndexOf=Array.prototype.indexOf,fastIndex=function(xs,x){return pIndexOf.call(xs,x)},slowIndex=function(xs,x){return slowIndexOf(xs,x)};return void 0===pIndexOf?slowIndex:fastIndex}(),indexOf=function(xs,x){var r=rawIndexOf(xs,x);return r===-1?Option.none():Option.some(r)},contains=function(xs,x){return rawIndexOf(xs,x)>-1},exists=function(xs,pred){return findIndex(xs,pred).isSome()},range=function(num,f){for(var r=[],i=0;i<num;i++)r.push(f(i));return r},chunk=function(array,size){for(var r=[],i=0;i<array.length;i+=size){var s=array.slice(i,i+size);r.push(s)}return r},map=function(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i,xs)}return r},each=function(xs,f){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];f(x,i,xs)}},eachr=function(xs,f){for(var i=xs.length-1;i>=0;i--){var x=xs[i];f(x,i,xs)}},partition=function(xs,pred){for(var pass=[],fail=[],i=0,len=xs.length;i<len;i++){var x=xs[i],arr=pred(x,i,xs)?pass:fail;arr.push(x)}return{pass:pass,fail:fail}},filter=function(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i,xs)&&r.push(x)}return r},groupBy=function(xs,f){if(0===xs.length)return[];for(var wasType=f(xs[0]),r=[],group=[],i=0,len=xs.length;i<len;i++){var x=xs[i],type=f(x);type!==wasType&&(r.push(group),group=[]),wasType=type,group.push(x)}return 0!==group.length&&r.push(group),r},foldr=function(xs,f,acc){return eachr(xs,function(x){acc=f(acc,x)}),acc},foldl=function(xs,f,acc){return each(xs,function(x){acc=f(acc,x)}),acc},find=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs))return Option.some(x)}return Option.none()},findIndex=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i,xs))return Option.some(i)}return Option.none()},slowIndexOf=function(xs,x){for(var i=0,len=xs.length;i<len;++i)if(xs[i]===x)return i;return-1},push=Array.prototype.push,flatten=function(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!Array.prototype.isPrototypeOf(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);push.apply(r,xs[i])}return r},bind=function(xs,f){var output=map(xs,f);return flatten(output)},forall=function(xs,pred){for(var i=0,len=xs.length;i<len;++i){var x=xs[i];if(pred(x,i,xs)!==!0)return!1}return!0},equal=function(a1,a2){return a1.length===a2.length&&forall(a1,function(x,i){return x===a2[i]})},slice=Array.prototype.slice,reverse=function(xs){var r=slice.call(xs,0);return r.reverse(),r},difference=function(a1,a2){return filter(a1,function(x){return!contains(a2,x)})},mapToObject=function(xs,f){for(var r={},i=0,len=xs.length;i<len;i++){var x=xs[i];r[String(x)]=f(x,i)}return r},pure=function(x){return[x]},sort=function(xs,comparator){var copy=slice.call(xs,0);return copy.sort(comparator),copy},head=function(xs){return 0===xs.length?Option.none():Option.some(xs[0])},last=function(xs){return 0===xs.length?Option.none():Option.some(xs[xs.length-1])},from$1=$_fnb6mscjh8lz3g2.isFunction(Array.from)?Array.from:function(x){return slice.call(x)},$_9i8hjds9jh8lz3fq={map:map,each:each,eachr:eachr,partition:partition,filter:filter,groupBy:groupBy,indexOf:indexOf,foldr:foldr,foldl:foldl,find:find,findIndex:findIndex,flatten:flatten,bind:bind,forall:forall,exists:exists,contains:contains,equal:equal,reverse:reverse,chunk:chunk,difference:difference,mapToObject:mapToObject,pure:pure,sort:sort,range:range,head:head,last:last,from:from$1},fromHtml=function(html,scope){var doc=scope||document,div=doc.createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||div.childNodes.length>1)throw console.error("HTML does not have a single root node",html),"HTML must have a single root node";return fromDom(div.childNodes[0])},fromTag=function(tag,scope){var doc=scope||document,node=doc.createElement(tag);return fromDom(node)},fromText=function(text,scope){var doc=scope||document,node=doc.createTextNode(text);return fromDom(node)},fromDom=function(node){if(null===node||void 0===node)throw new Error("Node cannot be null or undefined");return{dom:$_7oq9iksbjh8lz3g0.constant(node)}},fromPoint=function(doc,x,y){return Option.from(doc.dom().elementFromPoint(x,y)).map(fromDom)},$_ca7ezesdjh8lz3g4={fromHtml:fromHtml,fromTag:fromTag,fromText:fromText,fromDom:fromDom,
fromPoint:fromPoint},$_6wgyobsfjh8lz3gb={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12},name=function(element){var r=element.dom().nodeName;return r.toLowerCase()},type=function(element){return element.dom().nodeType},value=function(element){return element.dom().nodeValue},isType$1=function(t){return function(element){return type(element)===t}},isComment=function(element){return type(element)===$_6wgyobsfjh8lz3gb.COMMENT||"#comment"===name(element)},isElement=isType$1($_6wgyobsfjh8lz3gb.ELEMENT),isText=isType$1($_6wgyobsfjh8lz3gb.TEXT),isDocument=isType$1($_6wgyobsfjh8lz3gb.DOCUMENT),$_aa8ah0sejh8lz3g9={name:name,type:type,value:value,isElement:isElement,isText:isText,isDocument:isDocument,isComment:isComment},wrapCharWithSpan=function(value){return'<span data-mce-bogus="1" class="mce-'+$_4quw9ds7jh8lz3fg.charMap[value]+'">'+value+"</span>"},$_g64rhxsgjh8lz3gb={wrapCharWithSpan:wrapCharWithSpan},isMatch=function(n){return $_aa8ah0sejh8lz3g9.isText(n)&&void 0!==$_aa8ah0sejh8lz3g9.value(n)&&$_4quw9ds7jh8lz3fg.regExp.test($_aa8ah0sejh8lz3g9.value(n))},filterDescendants=function(scope,predicate){var result=[],dom=scope.dom(),children=$_9i8hjds9jh8lz3fq.map(dom.childNodes,$_ca7ezesdjh8lz3g4.fromDom);return $_9i8hjds9jh8lz3fq.each(children,function(x){predicate(x)&&(result=result.concat([x])),result=result.concat(filterDescendants(x,predicate))}),result},findParentElm=function(elm,rootElm){for(;elm.parentNode;){if(elm.parentNode===rootElm)return elm;elm=elm.parentNode}},replaceWithSpans=function(html){return html.replace($_4quw9ds7jh8lz3fg.regExpGlobal,$_g64rhxsgjh8lz3gb.wrapCharWithSpan)},$_5w2pzts8jh8lz3fi={isMatch:isMatch,filterDescendants:filterDescendants,findParentElm:findParentElm,replaceWithSpans:replaceWithSpans},show=function(editor,rootElm){var node,div,nodeList=$_5w2pzts8jh8lz3fi.filterDescendants($_ca7ezesdjh8lz3g4.fromDom(rootElm),$_5w2pzts8jh8lz3fi.isMatch);$_9i8hjds9jh8lz3fq.each(nodeList,function(n){var withSpans=$_5w2pzts8jh8lz3fi.replaceWithSpans($_aa8ah0sejh8lz3g9.value(n));for(div=editor.dom.create("div",null,withSpans);node=div.lastChild;)editor.dom.insertAfter(node,n.dom());editor.dom.remove(n.dom())})},hide=function(editor,body){var nodeList=editor.dom.select($_4quw9ds7jh8lz3fg.selector,body);$_9i8hjds9jh8lz3fq.each(nodeList,function(node){editor.dom.remove(node,1)})},toggle=function(editor){var body=editor.getBody(),bookmark=editor.selection.getBookmark(),parentNode=$_5w2pzts8jh8lz3fi.findParentElm(editor.selection.getNode(),body);parentNode=void 0!==parentNode?parentNode:body,hide(editor,parentNode),show(editor,parentNode),editor.selection.moveToBookmark(bookmark)},$_3w2dxys6jh8lz3f8={show:show,hide:hide,toggle:toggle},toggleVisualChars=function(editor,toggleState){var bookmark,body=editor.getBody(),selection=editor.selection;toggleState.set(!toggleState.get()),$_ca1g8as5jh8lz3f7.fireVisualChars(editor,toggleState.get()),bookmark=selection.getBookmark(),toggleState.get()===!0?$_3w2dxys6jh8lz3f8.show(editor,body):$_3w2dxys6jh8lz3f8.hide(editor,body),selection.moveToBookmark(bookmark)},$_8znikjs4jh8lz3f6={toggleVisualChars:toggleVisualChars},register=function(editor,toggleState){editor.addCommand("mceVisualChars",function(){$_8znikjs4jh8lz3f6.toggleVisualChars(editor,toggleState)})},$_fbutd9s3jh8lz3f5={register:register},global$1=tinymce.util.Tools.resolve("tinymce.util.Delay"),setup=function(editor,toggleState){var debouncedToggle=global$1.debounce(function(){$_3w2dxys6jh8lz3f8.toggle(editor)},300);editor.settings.forced_root_block!==!1&&editor.on("keydown",function(e){toggleState.get()===!0&&(13===e.keyCode?$_3w2dxys6jh8lz3f8.toggle(editor):debouncedToggle())})},$_353u01shjh8lz3gd={setup:setup},toggleActiveState=function(editor){return function(e){var ctrl=e.control;editor.on("VisualChars",function(e){ctrl.active(e.state)})}},register$1=function(editor){editor.addButton("visualchars",{active:!1,title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:toggleActiveState(editor)}),editor.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:toggleActiveState(editor),selectable:!0,context:"view",prependToContext:!0})};return global.add("visualchars",function(editor){var toggleState=Cell(!1);return $_fbutd9s3jh8lz3f5.register(editor,toggleState),register$1(editor),$_353u01shjh8lz3gd.setup(editor,toggleState),$_bmmym6s2jh8lz3f4.get(toggleState)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-wordcount",["tinymce"],function(){return function(){!function(){(function(){"use strict";function Plugin(){}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),regExps={aletter:"[A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-׳ؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆༀཀ-ཇཉ-ཬྈ-ྌႠ-Ⴥა-ჺჼᄀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᨀ-ᨖᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᯀ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⒶ-ⓩⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⴀ-ⴥⴰ-ⵥⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〻〼ㄅ-ㄭㄱ-ㆎㆠ-ㆺꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐꞑꞠ-ꞩꟺ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]",midnumlet:"[-'\\.‘’․﹒＇．]",midletter:"[:··״‧︓﹕：]",midnum:"[±+*/,;;։،؍٬߸⁄︐︔﹐﹔，；]",numeric:"[0-9٠-٩٫۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꩐-꩙꯰-꯹]",cr:"\\r",lf:"\\n",newline:"[\x0B\f\u2028\u2029]",extend:"[̀-ͯ҃-҉֑-ׇֽֿׁׂׅׄؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ऀ-ःऺ-़ा-ॏ॑-ॗॢॣঁ-ঃ়া-ৄেৈো-্ৗৢৣਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑੰੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣஂா-ூெ-ைொ-்ௗఁ-ఃా-ౄె-ైొ-్ౕౖౢౣಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣംഃാ-ൄെ-ൈൊ-്ൗൢൣංඃ්ා-ුූෘ-ෟෲෳัิ-ฺ็-๎ັິ-ູົຼ່-ໍ༹༘༙༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏႚ-ႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳា-៓៝᠋-᠍ᢩᤠ-ᤫᤰ-᤻ᦰ-ᧀᧈᧉᨗ-ᨛᩕ-ᩞ᩠-᩿᩼ᬀ-ᬄ᬴-᭄᭫-᭳ᮀ-ᮂᮡ-᯦᮪-᯳ᰤ-᰷᳐-᳔᳒-᳨᳭ᳲ᷀-ᷦ᷼-᷿‌‍⃐-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꙯-꙲꙼꙽꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-꣄꣠-꣱ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀ꨩ-ꨶꩃꩌꩍꩻꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꯣ-ꯪ꯬꯭ﬞ︀-️︠-︦ﾞﾟ]",format:"[­؀-؃۝܏឴឵‎‏‪-‮⁠-⁤⁪-⁯\ufeff￹-￻]",katakana:"[〱-〵゛゜゠-ヺー-ヿㇰ-ㇿ㋐-㋾㌀-㍗ｦ-ﾝ]",extendnumlet:"[=_‿⁀⁔︳︴﹍-﹏＿∀-⋿<>]",punctuation:"[!-#%-*,-\\/:;?@\\[-\\]_{}¡«·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]"},characterIndices={ALETTER:0,MIDNUMLET:1,MIDLETTER:2,MIDNUM:3,NUMERIC:4,CR:5,LF:6,NEWLINE:7,EXTEND:8,FORMAT:9,KATAKANA:10,EXTENDNUMLET:11,AT:12,OTHER:13},SETS=[new RegExp(regExps.aletter),new RegExp(regExps.midnumlet),new RegExp(regExps.midletter),new RegExp(regExps.midnum),new RegExp(regExps.numeric),new RegExp(regExps.cr),new RegExp(regExps.lf),new RegExp(regExps.newline),new RegExp(regExps.extend),new RegExp(regExps.format),new RegExp(regExps.katakana),new RegExp(regExps.extendnumlet),new RegExp("@")],EMPTY_STRING="",PUNCTUATION=new RegExp("^"+regExps.punctuation+"$"),WHITESPACE=/^\s+$/,$_7u8uzzspjh8lz3i4={characterIndices:characterIndices,SETS:SETS,EMPTY_STRING:EMPTY_STRING,PUNCTUATION:PUNCTUATION,WHITESPACE:WHITESPACE},each=function(o,cb,s){var n,l;if(!o)return 0;if(s=s||o,void 0!==o.length){for(n=0,l=o.length;n<l;n++)if(cb.call(s,o[n],n,o)===!1)return 0}else for(n in o)if(o.hasOwnProperty(n)&&cb.call(s,o[n],n,o)===!1)return 0;return 1},map=function(array,callback){var out=[];return each(array,function(item,index){out.push(callback(item,index,array))}),out},$_4dn8xisrjh8lz3i9={each:each,map:map},SETS$1=$_7u8uzzspjh8lz3i4.SETS,OTHER=$_7u8uzzspjh8lz3i4.characterIndices.OTHER,getType=function(char){var j,set,type=OTHER,setsLength=SETS$1.length;for(j=0;j<setsLength;++j)if(set=SETS$1[j],set&&set.test(char)){type=j;break}return type},memoize=function(func){var cache={};return function(char){if(cache[char])return cache[char];var result=func(char);return cache[char]=result,result}},classify=function(string){var memoized=memoize(getType);return $_4dn8xisrjh8lz3i9.map(string.split(""),memoized)},$_7jetzwsqjh8lz3i8={classify:classify},ci=$_7u8uzzspjh8lz3i4.characterIndices,isWordBoundary=function(map,index){var prevType,nextNextType,type=map[index],nextType=map[index+1];return!(index<0||index>map.length-1&&0!==index)&&((type!==ci.ALETTER||nextType!==ci.ALETTER)&&(nextNextType=map[index+2],(type!==ci.ALETTER||nextType!==ci.MIDLETTER&&nextType!==ci.MIDNUMLET&&nextType!==ci.AT||nextNextType!==ci.ALETTER)&&(prevType=map[index-1],(type!==ci.MIDLETTER&&type!==ci.MIDNUMLET&&nextType!==ci.AT||nextType!==ci.ALETTER||prevType!==ci.ALETTER)&&((type!==ci.NUMERIC&&type!==ci.ALETTER||nextType!==ci.NUMERIC&&nextType!==ci.ALETTER)&&((type!==ci.MIDNUM&&type!==ci.MIDNUMLET||nextType!==ci.NUMERIC||prevType!==ci.NUMERIC)&&((type!==ci.NUMERIC||nextType!==ci.MIDNUM&&nextType!==ci.MIDNUMLET||nextNextType!==ci.NUMERIC)&&(type!==ci.EXTEND&&type!==ci.FORMAT&&prevType!==ci.EXTEND&&prevType!==ci.FORMAT&&nextType!==ci.EXTEND&&nextType!==ci.FORMAT&&((type!==ci.CR||nextType!==ci.LF)&&(type===ci.NEWLINE||type===ci.CR||type===ci.LF||(nextType===ci.NEWLINE||nextType===ci.CR||nextType===ci.LF||(type!==ci.KATAKANA||nextType!==ci.KATAKANA)&&((nextType!==ci.EXTENDNUMLET||type!==ci.ALETTER&&type!==ci.NUMERIC&&type!==ci.KATAKANA&&type!==ci.EXTENDNUMLET)&&((type!==ci.EXTENDNUMLET||nextType!==ci.ALETTER&&nextType!==ci.NUMERIC&&nextType!==ci.KATAKANA)&&type!==ci.AT))))))))))))},$_b8cfs8ssjh8lz3ib={isWordBoundary:isWordBoundary},EMPTY_STRING$1=$_7u8uzzspjh8lz3i4.EMPTY_STRING,WHITESPACE$1=$_7u8uzzspjh8lz3i4.WHITESPACE,PUNCTUATION$1=$_7u8uzzspjh8lz3i4.PUNCTUATION,isProtocol=function(word){return"http"===word||"https"===word},findWordEnd=function(str,index){var i;for(i=index;i<str.length;++i){var chr=str.charAt(i);if(WHITESPACE$1.test(chr))break}return i},extractUrl=function(word,str,index){var endIndex=findWordEnd(str,index+1),peakedWord=str.substring(index+1,endIndex);return"://"===peakedWord.substr(0,3)?{word:word+peakedWord,index:endIndex}:{word:word,index:index}},doGetWords=function(str,options){var chr,includePunctuation,includeWhitespace,i=0,map=$_7jetzwsqjh8lz3i8.classify(str),len=map.length,word=[],words=[];for(options||(options={}),options.ignoreCase&&(str=str.toLowerCase()),includePunctuation=options.includePunctuation,includeWhitespace=options.includeWhitespace;i<len;++i)if(chr=str.charAt(i),word.push(chr),$_b8cfs8ssjh8lz3ib.isWordBoundary(map,i)){if(word=word.join(EMPTY_STRING$1),word&&(includeWhitespace||!WHITESPACE$1.test(word))&&(includePunctuation||!PUNCTUATION$1.test(word)))if(isProtocol(word)){var obj=extractUrl(word,str,i);words.push(obj.word),i=obj.index}else words.push(word);word=[]}return words},getWords=function(str,options){return doGetWords(str.replace(/\ufeff/g,""),options)},$_70byijsojh8lz3i1={getWords:getWords},getTextContent=function(editor){return editor.removed?"":editor.getBody().innerText},getCount=function(editor){return $_70byijsojh8lz3i1.getWords(getTextContent(editor)).length},$_e2zt0csnjh8lz3i0={getCount:getCount},get=function(editor){var getCount=function(){return $_e2zt0csnjh8lz3i0.getCount(editor)};return{getCount:getCount}},$_c37nf7smjh8lz3hz={get:get},global$1=tinymce.util.Tools.resolve("tinymce.util.Delay"),global$2=tinymce.util.Tools.resolve("tinymce.util.I18n"),setup=function(editor){var wordsToText=function(editor){return global$2.translate(["{0} words",$_e2zt0csnjh8lz3i0.getCount(editor)])},update=function(){editor.theme.panel.find("#wordcount").text(wordsToText(editor))};editor.on("init",function(){var statusbar=editor.theme.panel&&editor.theme.panel.find("#statusbar")[0],debouncedUpdate=global$1.debounce(update,300);statusbar&&global$1.setEditorTimeout(editor,function(){statusbar.insert({type:"label",name:"wordcount",text:wordsToText(editor),classes:"wordcount",disabled:editor.settings.readonly},0),editor.on("setcontent beforeaddundo undo redo keyup",debouncedUpdate)},0)})},$_30dxcostjh8lz3ie={setup:setup};return global.add("wordcount",function(editor){return $_30dxcostjh8lz3ie.setup(editor),$_c37nf7smjh8lz3hz.get(editor)}),Plugin})()}()}.apply(root,arguments)})}(this),function(root){define("tinymce-compat3x",["tinymce"],function(){return function(){!function(tinymce){function noop(){}function log(apiCall){!reported&&window&&window.console&&(reported=!0,console.log("Deprecated TinyMCE API call: "+apiCall))}function Dispatcher(target,newEventName,argsMap,defaultScope){target=target||this;var cbs=[];return newEventName?(this.add=function(callback,scope,prepend){function patchedEventCallback(e){var callbackArgs=[];if("string"==typeof argsMap&&(argsMap=argsMap.split(" ")),argsMap&&"function"!=typeof argsMap)for(var i=0;i<argsMap.length;i++)callbackArgs.push(e[argsMap[i]]);("function"!=typeof argsMap||(callbackArgs=argsMap(newEventName,e,target)))&&(argsMap||(callbackArgs=[e]),callbackArgs.unshift(defaultScope||target),callback.apply(scope||defaultScope||target,callbackArgs)===!1&&e.stopImmediatePropagation())}log("<target>.on"+newEventName+".add(..)"),target.on(newEventName,patchedEventCallback,prepend);var handlers={original:callback,patched:patchedEventCallback};return cbs.push(handlers),patchedEventCallback},this.addToTop=function(callback,scope){this.add(callback,scope,!0)},this.remove=function(callback){return cbs.forEach(function(item,i){if(item.original===callback)return cbs.splice(i,1),target.off(newEventName,item.patched)}),target.off(newEventName,callback)},void(this.dispatch=function(){return target.fire(newEventName),!0})):void(this.add=this.addToTop=this.remove=this.dispatch=noop)}function patchEditor(editor){function translate(str){var prefix=editor.settings.language||"en",prefixedStr=[prefix,str].join("."),translatedStr=tinymce.i18n.translate(prefixedStr);return prefixedStr!==translatedStr?translatedStr:tinymce.i18n.translate(str)}function patchEditorEvents(oldEventNames,argsMap){tinymce.each(oldEventNames.split(" "),function(oldName){editor["on"+oldName]=new Dispatcher(editor,oldName,argsMap)})}function convertUndoEventArgs(type,event,target){return[event.level,target]}function filterSelectionEvents(needsSelection){return function(type,e){if(!e.selection&&!needsSelection||e.selection==needsSelection)return[e]}}function cmNoop(){function _noop(){return cmNoop()}var obj={},methods="add addMenu addSeparator collapse createMenu destroy displayColor expand focus getLength hasMenus hideMenu isActive isCollapsed isDisabled isRendered isSelected mark postRender remove removeAll renderHTML renderMenu renderNode renderTo select selectByIndex setActive setAriaProperty setColor setDisabled setSelected setState showMenu update";return log("editor.controlManager.*"),tinymce.each(methods.split(" "),function(method){obj[method]=_noop}),obj}if(!editor.controlManager){editor.controlManager={buttons:{},setDisabled:function(name,state){log("controlManager.setDisabled(..)"),this.buttons[name]&&this.buttons[name].disabled(state)},setActive:function(name,state){log("controlManager.setActive(..)"),this.buttons[name]&&this.buttons[name].active(state)},onAdd:new Dispatcher,onPostRender:new Dispatcher,add:function(obj){return obj},createButton:cmNoop,createColorSplitButton:cmNoop,createControl:cmNoop,createDropMenu:cmNoop,createListBox:cmNoop,createMenuButton:cmNoop,createSeparator:cmNoop,createSplitButton:cmNoop,createToolbar:cmNoop,createToolbarGroup:cmNoop,destroy:noop,get:noop,setControlType:cmNoop},patchEditorEvents("PreInit BeforeRenderUI PostRender Load Init Remove Activate Deactivate","editor"),patchEditorEvents("Click MouseUp MouseDown DblClick KeyDown KeyUp KeyPress ContextMenu Paste Submit Reset"),patchEditorEvents("BeforeExecCommand ExecCommand","command ui value args"),patchEditorEvents("PreProcess PostProcess LoadContent SaveContent Change"),patchEditorEvents("BeforeSetContent BeforeGetContent SetContent GetContent",filterSelectionEvents(!1)),patchEditorEvents("SetProgressState","state time"),patchEditorEvents("VisualAid","element hasVisual"),patchEditorEvents("Undo Redo",convertUndoEventArgs),patchEditorEvents("NodeChange",function(type,e){return[editor.controlManager,e.element,editor.selection.isCollapsed(),e]});var originalAddButton=editor.addButton;editor.addButton=function(name,settings){function patchedPostRender(){if(editor.controlManager.buttons[name]=this,originalOnPostRender)return originalOnPostRender.apply(this,arguments)}var originalOnPostRender;for(var key in settings)"onpostrender"===key.toLowerCase()&&(originalOnPostRender=settings[key],settings.onPostRender=patchedPostRender);return originalOnPostRender||(settings.onPostRender=patchedPostRender),settings.title&&(settings.title=translate(settings.title)),originalAddButton.call(this,name,settings)},editor.on("init",function(){var undoManager=editor.undoManager,selection=editor.selection;undoManager.onUndo=new Dispatcher(editor,"Undo",convertUndoEventArgs,null,undoManager),undoManager.onRedo=new Dispatcher(editor,"Redo",convertUndoEventArgs,null,undoManager),undoManager.onBeforeAdd=new Dispatcher(editor,"BeforeAddUndo",null,undoManager),undoManager.onAdd=new Dispatcher(editor,"AddUndo",null,undoManager),selection.onBeforeGetContent=new Dispatcher(editor,"BeforeGetContent",filterSelectionEvents(!0),selection),selection.onGetContent=new Dispatcher(editor,"GetContent",filterSelectionEvents(!0),selection),selection.onBeforeSetContent=new Dispatcher(editor,"BeforeSetContent",filterSelectionEvents(!0),selection),selection.onSetContent=new Dispatcher(editor,"SetContent",filterSelectionEvents(!0),selection)}),editor.on("BeforeRenderUI",function(){var windowManager=editor.windowManager;windowManager.onOpen=new Dispatcher,windowManager.onClose=new Dispatcher,windowManager.createInstance=function(className,a,b,c,d,e){log("windowManager.createInstance(..)");var constr=tinymce.resolve(className);return new constr(a,b,c,d,e)}})}}var reported;tinymce.util.Dispatcher=Dispatcher,tinymce.onBeforeUnload=new Dispatcher(tinymce,"BeforeUnload"),tinymce.onAddEditor=new Dispatcher(tinymce,"AddEditor","editor"),tinymce.onRemoveEditor=new Dispatcher(tinymce,"RemoveEditor","editor"),tinymce.util.Cookie={get:noop,getHash:noop,remove:noop,set:noop,setHash:noop},tinymce.on("SetupEditor",function(e){patchEditor(e.editor)}),tinymce.PluginManager.add("compat3x",patchEditor),tinymce.addI18n=function(prefix,o){var I18n=tinymce.util.I18n,each=tinymce.each;return"string"==typeof prefix&&prefix.indexOf(".")===-1?void I18n.add(prefix,o):void(tinymce.is(prefix,"string")?each(o,function(o,k){I18n.data[prefix+"."+k]=o}):each(prefix,function(o,lc){each(o,function(o,g){each(o,function(o,k){"common"===g?I18n.data[lc+"."+k]=o:I18n.data[lc+"."+g+"."+k]=o})})}))}}(tinymce)}.apply(root,arguments)})}(this),define("mockup-patterns-tinymce",["jquery","underscore","pat-base","tinymce","mockup-utils","mockup-patterns-tinymce-url/js/links","mockup-i18n","translate","tinymce-modern-theme","tinymce-advlist","tinymce-anchor","tinymce-autolink","tinymce-autoresize","tinymce-autosave","tinymce-bbcode","tinymce-charmap","tinymce-code","tinymce-colorpicker","tinymce-contextmenu","tinymce-directionality","tinymce-emoticons","tinymce-fullpage","tinymce-fullscreen","tinymce-hr","tinymce-image","tinymce-importcss","tinymce-insertdatetime","tinymce-legacyoutput","tinymce-link","tinymce-lists","tinymce-media","tinymce-nonbreaking","tinymce-noneditable","tinymce-pagebreak","tinymce-paste","tinymce-preview","tinymce-print","tinymce-save","tinymce-searchreplace","tinymce-spellchecker","tinymce-tabfocus","tinymce-table","tinymce-template","tinymce-textcolor","tinymce-textpattern","tinymce-visualblocks","tinymce-visualchars","tinymce-wordcount","tinymce-compat3x"],function($,_,Base,tinymce,utils,LinkModal,I18n,_t){"use strict";var TinyMCE=Base.extend({name:"tinymce",trigger:".pat-tinymce",parser:"mockup",defaults:{upload:{uploadMultiple:!1,maxFiles:1,showTitle:!1},relatedItems:{attributes:["UID","Title","portal_type","path","getURL","getIcon","is_folderish","review_state"],batchSize:20,basePath:"/",vocabularyUrl:null,width:500,maximumSelectionSize:1,placeholder:_t("Search for item on site...")},text:{insertBtn:_t("Insert"),cancelBtn:_t("Cancel"),insertHeading:_t("Insert link"),title:_t("Title"),internal:_t("Internal"),external:_t("External URL (can be relative within this site or absolute if it starts with http:// or https://)"),email:_t("Email Address"),anchor:_t("Anchor"),subject:_t("Email Subject (optional)"),image:_t("Image"),imageAlign:_t("Align"),scale:_t("Size"),alt:_t("Alternative Text"),caption:_t("Caption"),externalImage:_t("External Image URL (can be relative within this site or absolute if it starts with http:// or https://)")},loadingBaseUrl:"../../../bower_components/tinymce-builded/js/tinymce/",prependToUrl:"",appendToUrl:"",linkAttribute:"path",prependToScalePart:"/imagescale/",appendToScalePart:"",appendToOriginalScalePart:"",defaultScale:"large",imageScales:[{title:"Mini",value:"mini"},{title:"Thumb",value:"thumb"},{title:"Listing",value:"listing"},{title:"Preview",value:"preview"},{title:"Tile",value:"tile"},{title:"Icon",value:"icon"},{title:"Large",value:"large"}],targetList:[{text:_t("Open in this window / frame"),value:""},{text:_t("Open in new window"),value:"_blank"},{text:_t("Open in parent window / frame"),value:"_parent"},{text:_t("Open in top frame (replaces all frames)"),value:"_top"}],imageTypes:["Image"],folderTypes:["Folder","Plone Site"],tiny:{content_css:"++resource++plone.app.widgets-tinymce-content.min.css",theme:"modern",plugins:["advlist","autolink","lists","charmap","print","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","contextmenu","paste","plonelink","ploneimage"],menubar:"edit table format tools view insert",toolbar:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | unlink plonelink ploneimage",height:400},inline:!1},addLinkClicked:function(){var self=this;if(null===self.linkModal){var $el=$("<div/>").insertAfter(self.$el),linkTypes=["internal","upload","external","email","anchor"];self.options.upload||linkTypes.splice(1,1),self.linkModal=new LinkModal($el,$.extend(!0,{},self.options,{tinypattern:self,linkTypes:linkTypes})),self.linkModal.show()}else self.linkModal.reinitialize(),self.linkModal.show()},addImageClicked:function(){var self=this;if(null===self.imageModal){var linkTypes=["image","uploadImage","externalImage"];self.options.upload||linkTypes.splice(1,1);var options=$.extend(!0,{},self.options,{tinypattern:self,linkTypes:linkTypes,initialLinkType:"image",text:{insertHeading:_t("Insert Image")},relatedItems:{baseCriteria:[{i:"portal_type",o:"plone.app.querystring.operation.list.contains",v:self.options.imageTypes.concat(self.options.folderTypes)}],selectableTypes:self.options.imageTypes}}),$el=$("<div/>").insertAfter(self.$el);self.imageModal=new LinkModal($el,options),self.imageModal.show()}else self.imageModal.reinitialize(),self.imageModal.show()},generateUrl:function(data){var self=this,part=data[self.options.linkAttribute];return self.options.prependToUrl+part+self.options.appendToUrl},generateImageUrl:function(data,scale_name){var self=this,url=self.generateUrl(data);return scale_name?url=url+self.options.prependToScalePart+scale_name+self.options.appendToScalePart:url+=self.options.appendToOriginalScalePart,url},stripGeneratedUrl:function(url){var self=this;if(url=url.split(self.options.prependToScalePart,2)[0],self.options.prependToUrl){var parts=url.split(self.options.prependToUrl,2);2===parts.length&&(url=parts[1])}return self.options.appendToUrl&&(url=url.split(self.options.appendToUrl)[0]),url},getScaleFromUrl:function(url){var self=this,split=url.split(self.options.prependToScalePart);return 2!==split.length?null:(url=self.options.appendToScalePart?split[1].split(self.options.appendToScalePart)[0]:split[1],url.indexOf("/image_")!==-1&&(url=url.split("/image_")[1]),url)},initLanguage:function(call_back){var self=this,i18n=new I18n,lang=i18n.currentLanguage;"en-us"!==lang&&"en"!==self.options.tiny.language?(tinymce.baseURL=self.options.loadingBaseUrl,$.ajax({url:tinymce.baseURL+"/langs/"+lang+".js",method:"GET",cache:"true",success:function(){self.options.tiny.language=lang,call_back()},error:function(){lang=lang.split("_")>1?lang.split("_")[0]:lang.split("-")>1?lang.split("-")[0]:lang+"_"+lang.toUpperCase(),$.ajax({url:tinymce.baseURL+"/langs/"+lang+".js",method:"GET",cache:"true",success:function(){self.options.tiny.language=lang,call_back()},error:function(){call_back()}})}})):call_back()},init:function(){var self=this;self.linkModal=self.imageModal=self.uploadModal=self.pasteModal=null;var id=utils.setId(self.$el);self.options.imageScales&&"string"==typeof self.options.imageScales&&(self.options.imageScales=JSON.parse(self.options.imageScales));var tinyOptions=self.options.tiny;self.options.inline===!0&&(self.options.tiny.inline=!0),self.tinyId=self.options.inline?id+"-editable":id,tinyOptions.selector="#"+self.tinyId,tinyOptions.addLinkClicked=function(){self.addLinkClicked.apply(self,[])},tinyOptions.addImageClicked=function(file){self.addImageClicked.apply(self,[file])},tinyOptions.skin=!1,tinyOptions.init_instance_callback=function(editor){void 0!==self.tiny&&null!==self.tiny||(self.tiny=editor)},self.initLanguage(function(){if("string"==typeof self.options.folderTypes&&(self.options.folderTypes=self.options.folderTypes.split(",")),"string"==typeof self.options.imageTypes&&(self.options.imageTypes=self.options.imageTypes.split(",")),self.options.inline===!0&&(self.$el.after('<div id="'+self.tinyId+'">'+self.$el.val()+"</div>"),self.$el.hide()),tinyOptions.importcss_file_filter&&tinyOptions.importcss_file_filter.indexOf(",")!==-1){var files=tinyOptions.importcss_file_filter.split(",");tinyOptions.importcss_file_filter=function(value){for(var i=0;i<files.length;i++)if(value.indexOf(files[i])!==-1)return!0;return!1}}if(tinyOptions.importcss_selector_filter&&tinyOptions.importcss_selector_filter.length&&(tinyOptions.importcss_selector_filter=new RegExp(tinyOptions.importcss_selector_filter)),tinyOptions.importcss_groups&&tinyOptions.importcss_groups.length)for(var i=0;i<tinyOptions.importcss_groups.length;i++)tinyOptions.importcss_groups[i].filter&&tinyOptions.importcss_groups[i].filter.length&&(tinyOptions.importcss_groups[i].filter=new RegExp(tinyOptions.importcss_groups[i].filter));tinymce.init(tinyOptions),self.tiny=tinymce.get(self.tinyId);var $form=self.$el.parents("form");$form.on("submit",function(){self.options.inline===!0?self.$el.val(self.tiny.getContent()):self.tiny.save()})})},destroy:function(){this.tiny&&(this.options.inline===!0&&(this.$el.val(this.tiny.getContent()),$("#"+this.tinyId).remove(),this.$el.show()),this.tiny.destroy(),this.tiny=void 0)}});return TinyMCE}),define("mockup-patterns-textareamimetypeselector",["jquery","pat-base","pat-registry","mockup-patterns-tinymce"],function($,Base,registry){"use strict";var TextareaMimetypeSelector=Base.extend({name:"textareamimetypeselector",trigger:".pat-textareamimetypeselector",parser:"mockup",textarea:void 0,currentWidget:void 0,defaults:{textareaName:"",widgets:{"text/html":{pattern:"tinymce",patternOptions:{}}}},init:function(){var self=this,$el=self.$el;self.textarea=$('[name="'+self.options.textareaName+'"]'),$el.change(function(e){self.initTextarea(e.target.value)}),self.initTextarea($el.val())},initTextarea:function(mimetype){var pattern,self=this,patternConfig=self.options.widgets[mimetype];self.currentWidget&&self.currentWidget.destroy(),patternConfig&&(pattern=new registry.patterns[patternConfig.pattern](self.textarea,patternConfig.patternOptions||{}),self.currentWidget=pattern)}});return TextareaMimetypeSelector}),define("mockup-bundles-widgets",["jquery","pat-registry","pat-base","mockup-patterns-select2","mockup-patterns-passwordstrength","mockup-patterns-pickadate","mockup-patterns-recurrence","mockup-patterns-relateditems","mockup-patterns-querystring","mockup-patterns-textareamimetypeselector","mockup-patterns-tinymce"],function($,registry,Base){"use strict";var PloneWidgets=Base.extend({name:"plone-widgets",init:function(){}});return window.parent===window&&$(document).ready(function(){$("body").addClass("pat-plone-widgets"),registry.initialized||registry.init()}),PloneWidgets}),require(["mockup-bundles-widgets"]);
//# sourceMappingURL=++resource++plone.app.widgets.min.js.map